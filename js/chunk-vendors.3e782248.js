(self["webpackChunkno1ott_vujs"]=self["webpackChunkno1ott_vujs"]||[]).push([[504],{34:function(e,t,n){"use strict";var i=n(4901);e.exports=function(e){return"object"==typeof e?null!==e:i(e)}},81:function(e,t,n){"use strict";var i=n(9565),r=n(9306),s=n(8551),a=n(6823),o=n(851),u=TypeError;e.exports=function(e,t){var n=arguments.length<2?o(e):t;if(r(n))return s(i(n,e));throw new u(a(e)+" is not iterable")}},116:function(e,t,n){"use strict";var i=n(6518),r=n(9565),s=n(2652),a=n(9306),o=n(8551),u=n(1767),l=n(9539),c=n(4549),d=c("find",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:d},{find:function(e){o(this);try{a(e)}catch(i){l(this,"throw",i)}if(d)return r(d,this,e);var t=u(this),n=0;return s(t,function(t,i){if(e(t,n++))return i(t)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})},144:function(e,t,n){"use strict";n.d(t,{BA:function(){return Ne},C4:function(){return I},EW:function(){return je},Gc:function(){return be},IG:function(){return ke},IJ:function(){return Me},KR:function(){return De},Kh:function(){return ye},Pr:function(){return Fe},R1:function(){return Oe},Tm:function(){return we},X2:function(){return d},a1:function(){return Re},bl:function(){return k},fE:function(){return Ae},g8:function(){return Ee},hV:function(){return We},hZ:function(){return F},i9:function(){return Ce},jr:function(){return l},ju:function(){return xe},lJ:function(){return Le},o5:function(){return u},qA:function(){return j},u4:function(){return U},uY:function(){return o},ux:function(){return Ie},wB:function(){return Ke},yC:function(){return a}});n(4114),n(8111),n(2489),n(7588),n(1701),n(3579),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698);var i=n(4232);let r,s;class a{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=r,!e&&r&&(this.index=(r.scopes||(r.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){let e,t;if(this._isPaused=!0,this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){let e,t;if(this._isPaused=!1,this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=r;try{return r=this,e()}finally{r=t}}else 0}on(){1===++this._on&&(this.prevScope=r,r=this)}off(){this._on>0&&0===--this._on&&(r=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){let t,n;for(this._active=!1,t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0}}}function o(e){return new a(e)}function u(){return r}function l(e,t=!1){r&&r.cleanups.push(e)}const c=new WeakSet;class d{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,r&&r.active&&r.effects.push(this)}pause(){this.flags|=64}resume(){64&this.flags&&(this.flags&=-65,c.has(this)&&(c.delete(this),this.trigger()))}notify(){2&this.flags&&!(32&this.flags)||8&this.flags||g(this)}run(){if(!(1&this.flags))return this.fn();this.flags|=2,L(this),y(this);const e=s,t=A;s=this,A=!0;try{return this.fn()}finally{0,b(this),s=e,A=t,this.flags&=-3}}stop(){if(1&this.flags){for(let e=this.deps;e;e=e.nextDep)E(e);this.deps=this.depsTail=void 0,L(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){64&this.flags?c.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){T(this)&&this.run()}get dirty(){return T(this)}}let h,f,p=0;function g(e,t=!1){if(e.flags|=8,t)return e.next=f,void(f=e);e.next=h,h=e}function m(){p++}function v(){if(--p>0)return;if(f){let e=f;f=void 0;while(e){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let e;while(h){let n=h;h=void 0;while(n){const i=n.next;if(n.next=void 0,n.flags&=-9,1&n.flags)try{n.trigger()}catch(t){e||(e=t)}n=i}}if(e)throw e}function y(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function b(e){let t,n=e.depsTail,i=n;while(i){const e=i.prevDep;-1===i.version?(i===n&&(n=e),E(i),w(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=e}e.deps=t,e.depsTail=n}function T(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(S(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function S(e){if(4&e.flags&&!(16&e.flags))return;if(e.flags&=-17,e.globalVersion===R)return;if(e.globalVersion=R,!e.isSSR&&128&e.flags&&(!e.deps&&!e._dirty||!T(e)))return;e.flags|=2;const t=e.dep,n=s,r=A;s=e,A=!0;try{y(e);const n=e.fn(e._value);(0===t.version||(0,i.$H)(n,e._value))&&(e.flags|=128,e._value=n,t.version++)}catch(a){throw t.version++,a}finally{s=n,A=r,b(e),e.flags&=-3}}function E(e,t=!1){const{dep:n,prevSub:i,nextSub:r}=e;if(i&&(i.nextSub=r,e.prevSub=void 0),r&&(r.prevSub=i,e.nextSub=void 0),n.subs===e&&(n.subs=i,!i&&n.computed)){n.computed.flags&=-5;for(let e=n.computed.deps;e;e=e.nextDep)E(e,!0)}t||--n.sc||!n.map||n.map.delete(n.key)}function w(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let A=!0;const x=[];function I(){x.push(A),A=!1}function k(){const e=x.pop();A=void 0===e||e}function L(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const e=s;s=void 0;try{t()}finally{s=e}}}let R=0;class C{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class D{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!s||!A||s===this.computed)return;let t=this.activeLink;if(void 0===t||t.sub!==s)t=this.activeLink=new C(s,this),s.deps?(t.prevDep=s.depsTail,s.depsTail.nextDep=t,s.depsTail=t):s.deps=s.depsTail=t,M(t);else if(-1===t.version&&(t.version=this.version,t.nextDep)){const e=t.nextDep;e.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=e),t.prevDep=s.depsTail,t.nextDep=void 0,s.depsTail.nextDep=t,s.depsTail=t,s.deps===t&&(s.deps=e)}return t}trigger(e){this.version++,R++,this.notify(e)}notify(e){m();try{0;for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{v()}}}function M(e){if(e.dep.sc++,4&e.sub.flags){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let e=t.deps;e;e=e.nextDep)M(e)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const P=new WeakMap,_=Symbol(""),O=Symbol(""),N=Symbol("");function U(e,t,n){if(A&&s){let t=P.get(e);t||P.set(e,t=new Map);let i=t.get(n);i||(t.set(n,i=new D),i.map=t,i.key=n),i.track()}}function F(e,t,n,r,s,a){const o=P.get(e);if(!o)return void R++;const u=e=>{e&&e.trigger()};if(m(),"clear"===t)o.forEach(u);else{const s=(0,i.cy)(e),a=s&&(0,i.yI)(n);if(s&&"length"===n){const e=Number(r);o.forEach((t,n)=>{("length"===n||n===N||!(0,i.Bm)(n)&&n>=e)&&u(t)})}else switch((void 0!==n||o.has(void 0))&&u(o.get(n)),a&&u(o.get(N)),t){case"add":s?a&&u(o.get("length")):(u(o.get(_)),(0,i.CE)(e)&&u(o.get(O)));break;case"delete":s||(u(o.get(_)),(0,i.CE)(e)&&u(o.get(O)));break;case"set":(0,i.CE)(e)&&u(o.get(_));break}}v()}function B(e){const t=Ie(e);return t===e?t:(U(t,"iterate",N),Ae(e)?t:t.map(Le))}function j(e){return U(e=Ie(e),"iterate",N),e}const $={__proto__:null,[Symbol.iterator](){return G(this,Symbol.iterator,Le)},concat(...e){return B(this).concat(...e.map(e=>(0,i.cy)(e)?B(e):e))},entries(){return G(this,"entries",e=>(e[1]=Le(e[1]),e))},every(e,t){return H(this,"every",e,t,void 0,arguments)},filter(e,t){return H(this,"filter",e,t,e=>e.map(Le),arguments)},find(e,t){return H(this,"find",e,t,Le,arguments)},findIndex(e,t){return H(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return H(this,"findLast",e,t,Le,arguments)},findLastIndex(e,t){return H(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return H(this,"forEach",e,t,void 0,arguments)},includes(...e){return W(this,"includes",e)},indexOf(...e){return W(this,"indexOf",e)},join(e){return B(this).join(e)},lastIndexOf(...e){return W(this,"lastIndexOf",e)},map(e,t){return H(this,"map",e,t,void 0,arguments)},pop(){return q(this,"pop")},push(...e){return q(this,"push",e)},reduce(e,...t){return K(this,"reduce",e,t)},reduceRight(e,...t){return K(this,"reduceRight",e,t)},shift(){return q(this,"shift")},some(e,t){return H(this,"some",e,t,void 0,arguments)},splice(...e){return q(this,"splice",e)},toReversed(){return B(this).toReversed()},toSorted(e){return B(this).toSorted(e)},toSpliced(...e){return B(this).toSpliced(...e)},unshift(...e){return q(this,"unshift",e)},values(){return G(this,"values",Le)}};function G(e,t,n){const i=j(e),r=i[t]();return i===e||Ae(e)||(r._next=r.next,r.next=()=>{const e=r._next();return e.value&&(e.value=n(e.value)),e}),r}const V=Array.prototype;function H(e,t,n,i,r,s){const a=j(e),o=a!==e&&!Ae(e),u=a[t];if(u!==V[t]){const t=u.apply(e,s);return o?Le(t):t}let l=n;a!==e&&(o?l=function(t,i){return n.call(this,Le(t),i,e)}:n.length>2&&(l=function(t,i){return n.call(this,t,i,e)}));const c=u.call(a,l,i);return o&&r?r(c):c}function K(e,t,n,i){const r=j(e);let s=n;return r!==e&&(Ae(e)?n.length>3&&(s=function(t,i,r){return n.call(this,t,i,r,e)}):s=function(t,i,r){return n.call(this,t,Le(i),r,e)}),r[t](s,...i)}function W(e,t,n){const i=Ie(e);U(i,"iterate",N);const r=i[t](...n);return-1!==r&&!1!==r||!xe(n[0])?r:(n[0]=Ie(n[0]),i[t](...n))}function q(e,t,n=[]){I(),m();const i=Ie(e)[t].apply(e,n);return v(),k(),i}const Y=(0,i.pD)("__proto__,__v_isRef,__isVue"),z=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>"arguments"!==e&&"caller"!==e).map(e=>Symbol[e]).filter(i.Bm));function X(e){(0,i.Bm)(e)||(e=String(e));const t=Ie(this);return U(t,"has",e),t.hasOwnProperty(e)}class Q{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if("__v_skip"===t)return e["__v_skip"];const r=this._isReadonly,s=this._isShallow;if("__v_isReactive"===t)return!r;if("__v_isReadonly"===t)return r;if("__v_isShallow"===t)return s;if("__v_raw"===t)return n===(r?s?ge:pe:s?fe:he).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const a=(0,i.cy)(e);if(!r){let e;if(a&&(e=$[t]))return e;if("hasOwnProperty"===t)return X}const o=Reflect.get(e,t,Ce(e)?e:n);return((0,i.Bm)(t)?z.has(t):Y(t))?o:(r||U(e,"get",t),s?o:Ce(o)?a&&(0,i.yI)(t)?o:o.value:(0,i.Gv)(o)?r?Te(o):ye(o):o)}}class J extends Q{constructor(e=!1){super(!1,e)}set(e,t,n,r){let s=e[t];if(!this._isShallow){const t=we(s);if(Ae(n)||we(n)||(s=Ie(s),n=Ie(n)),!(0,i.cy)(e)&&Ce(s)&&!Ce(n))return!t&&(s.value=n,!0)}const a=(0,i.cy)(e)&&(0,i.yI)(t)?Number(t)<e.length:(0,i.$3)(e,t),o=Reflect.set(e,t,n,Ce(e)?e:r);return e===Ie(r)&&(a?(0,i.$H)(n,s)&&F(e,"set",t,n,s):F(e,"add",t,n)),o}deleteProperty(e,t){const n=(0,i.$3)(e,t),r=e[t],s=Reflect.deleteProperty(e,t);return s&&n&&F(e,"delete",t,void 0,r),s}has(e,t){const n=Reflect.has(e,t);return(0,i.Bm)(t)&&z.has(t)||U(e,"has",t),n}ownKeys(e){return U(e,"iterate",(0,i.cy)(e)?"length":_),Reflect.ownKeys(e)}}class Z extends Q{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const ee=new J,te=new Z,ne=new J(!0),ie=e=>e,re=e=>Reflect.getPrototypeOf(e);function se(e,t,n){return function(...r){const s=this["__v_raw"],a=Ie(s),o=(0,i.CE)(a),u="entries"===e||e===Symbol.iterator&&o,l="keys"===e&&o,c=s[e](...r),d=n?ie:t?Re:Le;return!t&&U(a,"iterate",l?O:_),{next(){const{value:e,done:t}=c.next();return t?{value:e,done:t}:{value:u?[d(e[0]),d(e[1])]:d(e),done:t}},[Symbol.iterator](){return this}}}}function ae(e){return function(...t){return"delete"!==e&&("clear"===e?void 0:this)}}function oe(e,t){const n={get(n){const r=this["__v_raw"],s=Ie(r),a=Ie(n);e||((0,i.$H)(n,a)&&U(s,"get",n),U(s,"get",a));const{has:o}=re(s),u=t?ie:e?Re:Le;return o.call(s,n)?u(r.get(n)):o.call(s,a)?u(r.get(a)):void(r!==s&&r.get(n))},get size(){const t=this["__v_raw"];return!e&&U(Ie(t),"iterate",_),Reflect.get(t,"size",t)},has(t){const n=this["__v_raw"],r=Ie(n),s=Ie(t);return e||((0,i.$H)(t,s)&&U(r,"has",t),U(r,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)},forEach(n,i){const r=this,s=r["__v_raw"],a=Ie(s),o=t?ie:e?Re:Le;return!e&&U(a,"iterate",_),s.forEach((e,t)=>n.call(i,o(e),o(t),r))}};(0,i.X$)(n,e?{add:ae("add"),set:ae("set"),delete:ae("delete"),clear:ae("clear")}:{add(e){t||Ae(e)||we(e)||(e=Ie(e));const n=Ie(this),i=re(n),r=i.has.call(n,e);return r||(n.add(e),F(n,"add",e,e)),this},set(e,n){t||Ae(n)||we(n)||(n=Ie(n));const r=Ie(this),{has:s,get:a}=re(r);let o=s.call(r,e);o||(e=Ie(e),o=s.call(r,e));const u=a.call(r,e);return r.set(e,n),o?(0,i.$H)(n,u)&&F(r,"set",e,n,u):F(r,"add",e,n),this},delete(e){const t=Ie(this),{has:n,get:i}=re(t);let r=n.call(t,e);r||(e=Ie(e),r=n.call(t,e));const s=i?i.call(t,e):void 0,a=t.delete(e);return r&&F(t,"delete",e,void 0,s),a},clear(){const e=Ie(this),t=0!==e.size,n=void 0,i=e.clear();return t&&F(e,"clear",void 0,void 0,n),i}});const r=["keys","values","entries",Symbol.iterator];return r.forEach(i=>{n[i]=se(i,e,t)}),n}function ue(e,t){const n=oe(e,t);return(t,r,s)=>"__v_isReactive"===r?!e:"__v_isReadonly"===r?e:"__v_raw"===r?t:Reflect.get((0,i.$3)(n,r)&&r in t?n:t,r,s)}const le={get:ue(!1,!1)},ce={get:ue(!1,!0)},de={get:ue(!0,!1)};const he=new WeakMap,fe=new WeakMap,pe=new WeakMap,ge=new WeakMap;function me(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ve(e){return e["__v_skip"]||!Object.isExtensible(e)?0:me((0,i.Zf)(e))}function ye(e){return we(e)?e:Se(e,!1,ee,le,he)}function be(e){return Se(e,!1,ne,ce,fe)}function Te(e){return Se(e,!0,te,de,pe)}function Se(e,t,n,r,s){if(!(0,i.Gv)(e))return e;if(e["__v_raw"]&&(!t||!e["__v_isReactive"]))return e;const a=ve(e);if(0===a)return e;const o=s.get(e);if(o)return o;const u=new Proxy(e,2===a?r:n);return s.set(e,u),u}function Ee(e){return we(e)?Ee(e["__v_raw"]):!(!e||!e["__v_isReactive"])}function we(e){return!(!e||!e["__v_isReadonly"])}function Ae(e){return!(!e||!e["__v_isShallow"])}function xe(e){return!!e&&!!e["__v_raw"]}function Ie(e){const t=e&&e["__v_raw"];return t?Ie(t):e}function ke(e){return!(0,i.$3)(e,"__v_skip")&&Object.isExtensible(e)&&(0,i.yQ)(e,"__v_skip",!0),e}const Le=e=>(0,i.Gv)(e)?ye(e):e,Re=e=>(0,i.Gv)(e)?Te(e):e;function Ce(e){return!!e&&!0===e["__v_isRef"]}function De(e){return Pe(e,!1)}function Me(e){return Pe(e,!0)}function Pe(e,t){return Ce(e)?e:new _e(e,t)}class _e{constructor(e,t){this.dep=new D,this["__v_isRef"]=!0,this["__v_isShallow"]=!1,this._rawValue=t?e:Ie(e),this._value=t?e:Le(e),this["__v_isShallow"]=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,n=this["__v_isShallow"]||Ae(e)||we(e);e=n?e:Ie(e),(0,i.$H)(e,t)&&(this._rawValue=e,this._value=n?e:Le(e),this.dep.trigger())}}function Oe(e){return Ce(e)?e.value:e}function Ne(e){return(0,i.Tn)(e)?e():Oe(e)}const Ue={get:(e,t,n)=>"__v_raw"===t?e:Oe(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const r=e[t];return Ce(r)&&!Ce(n)?(r.value=n,!0):Reflect.set(e,t,n,i)}};function Fe(e){return Ee(e)?e:new Proxy(e,Ue)}class Be{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new D(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=R-1,this.next=void 0,this.effect=this,this["__v_isReadonly"]=!t,this.isSSR=n}notify(){if(this.flags|=16,!(8&this.flags||s===this))return g(this,!0),!0}get value(){const e=this.dep.track();return S(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function je(e,t,n=!1){let r,s;(0,i.Tn)(e)?r=e:(r=e.get,s=e.set);const a=new Be(r,s,n);return a}const $e={},Ge=new WeakMap;let Ve;function He(e,t=!1,n=Ve){if(n){let t=Ge.get(n);t||Ge.set(n,t=[]),t.push(e)}else 0}function Ke(e,t,n=i.MZ){const{immediate:r,deep:s,once:a,scheduler:o,augmentJob:l,call:c}=n,h=e=>s?e:Ae(e)||!1===s||0===s?We(e,1):We(e);let f,p,g,m,v=!1,y=!1;if(Ce(e)?(p=()=>e.value,v=Ae(e)):Ee(e)?(p=()=>h(e),v=!0):(0,i.cy)(e)?(y=!0,v=e.some(e=>Ee(e)||Ae(e)),p=()=>e.map(e=>Ce(e)?e.value:Ee(e)?h(e):(0,i.Tn)(e)?c?c(e,2):e():void 0)):p=(0,i.Tn)(e)?t?c?()=>c(e,2):e:()=>{if(g){I();try{g()}finally{k()}}const t=Ve;Ve=f;try{return c?c(e,3,[m]):e(m)}finally{Ve=t}}:i.tE,t&&s){const e=p,t=!0===s?1/0:s;p=()=>We(e(),t)}const b=u(),T=()=>{f.stop(),b&&b.active&&(0,i.TF)(b.effects,f)};if(a&&t){const e=t;t=(...t)=>{e(...t),T()}}let S=y?new Array(e.length).fill($e):$e;const E=e=>{if(1&f.flags&&(f.dirty||e))if(t){const e=f.run();if(s||v||(y?e.some((e,t)=>(0,i.$H)(e,S[t])):(0,i.$H)(e,S))){g&&g();const n=Ve;Ve=f;try{const n=[e,S===$e?void 0:y&&S[0]===$e?[]:S,m];S=e,c?c(t,3,n):t(...n)}finally{Ve=n}}}else f.run()};return l&&l(E),f=new d(p),f.scheduler=o?()=>o(E,!1):E,m=e=>He(e,!1,f),g=f.onStop=()=>{const e=Ge.get(f);if(e){if(c)c(e,4);else for(const t of e)t();Ge.delete(f)}},t?r?E(!0):S=f.run():o?o(E.bind(null,!0),!0):f.run(),T.pause=f.pause.bind(f),T.resume=f.resume.bind(f),T.stop=T,T}function We(e,t=1/0,n){if(t<=0||!(0,i.Gv)(e)||e["__v_skip"])return e;if(n=n||new Set,n.has(e))return e;if(n.add(e),t--,Ce(e))We(e.value,t,n);else if((0,i.cy)(e))for(let i=0;i<e.length;i++)We(e[i],t,n);else if((0,i.vM)(e)||(0,i.CE)(e))e.forEach(e=>{We(e,t,n)});else if((0,i.Qd)(e)){for(const i in e)We(e[i],t,n);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&We(e[i],t,n)}return e}},283:function(e,t,n){"use strict";var i=n(9504),r=n(9039),s=n(4901),a=n(9297),o=n(3724),u=n(350).CONFIGURABLE,l=n(3706),c=n(1181),d=c.enforce,h=c.get,f=String,p=Object.defineProperty,g=i("".slice),m=i("".replace),v=i([].join),y=o&&!r(function(){return 8!==p(function(){},"length",{value:8}).length}),b=String(String).split("String"),T=e.exports=function(e,t,n){"Symbol("===g(f(t),0,7)&&(t="["+m(f(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!a(e,"name")||u&&e.name!==t)&&(o?p(e,"name",{value:t,configurable:!0}):e.name=t),y&&n&&a(n,"arity")&&e.length!==n.arity&&p(e,"length",{value:n.arity});try{n&&a(n,"constructor")&&n.constructor?o&&p(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(r){}var i=d(e);return a(i,"source")||(i.source=v(b,"string"==typeof t?t:"")),e};Function.prototype.toString=T(function(){return s(this)&&h(this).source||l(this)},"toString")},350:function(e,t,n){"use strict";var i=n(3724),r=n(9297),s=Function.prototype,a=i&&Object.getOwnPropertyDescriptor,o=r(s,"name"),u=o&&"something"===function(){}.name,l=o&&(!i||i&&a(s,"name").configurable);e.exports={EXISTS:o,PROPER:u,CONFIGURABLE:l}},397:function(e,t,n){"use strict";var i=n(7751);e.exports=i("document","documentElement")},421:function(e){"use strict";e.exports={}},507:function(e,t,n){"use strict";var i=n(9565);e.exports=function(e,t,n){var r,s,a=n?e:e.iterator,o=e.next;while(!(r=i(o,a)).done)if(s=t(r.value),void 0!==s)return s}},531:function(e,t,n){"use strict";var i=n(6518),r=n(9565),s=n(9306),a=n(8551),o=n(1767),u=n(8646),l=n(9462),c=n(9539),d=n(6395),h=n(684),f=n(4549),p=!d&&!h("flatMap",function(){}),g=!d&&!p&&f("flatMap",TypeError),m=d||p||g,v=l(function(){var e,t,n=this.iterator,i=this.mapper;while(1){if(t=this.inner)try{if(e=a(r(t.next,t.iterator)),!e.done)return e.value;this.inner=null}catch(s){c(n,"throw",s)}if(e=a(r(this.next,n)),this.done=!!e.done)return;try{this.inner=u(i(e.value,this.counter++),!1)}catch(s){c(n,"throw",s)}}});i({target:"Iterator",proto:!0,real:!0,forced:m},{flatMap:function(e){a(this);try{s(e)}catch(t){c(this,"throw",t)}return g?r(g,this,e):new v(o(this),{mapper:e,inner:null})}})},616:function(e,t,n){"use strict";var i=n(9039);e.exports=!i(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})},655:function(e,t,n){"use strict";var i=n(6955),r=String;e.exports=function(e){if("Symbol"===i(e))throw new TypeError("Cannot convert a Symbol value to a string");return r(e)}},679:function(e,t,n){"use strict";var i=n(1625),r=TypeError;e.exports=function(e,t){if(i(t,e))return e;throw new r("Incorrect invocation")}},684:function(e){"use strict";e.exports=function(e,t){var n="function"==typeof Iterator&&Iterator.prototype[e];if(n)try{n.call({next:null},t).next()}catch(i){return!0}}},741:function(e){"use strict";var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var i=+e;return(i>0?n:t)(i)}},757:function(e,t,n){"use strict";var i=n(7751),r=n(4901),s=n(1625),a=n(7040),o=Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return r(t)&&s(t.prototype,o(e))}},814:function(e,t,n){n(4114),n(8111),n(1148),n(2489),n(116),n(7588),n(1701),n(8237),n(3579),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698),n(9577),n(4979),
/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function(){var e="undefined"!=typeof window?window:n.g,i={};for(var r in function(e,t,n){var i;function s(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var a="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};function o(n){n=["object"==typeof globalThis&&globalThis,n,"object"==typeof e&&e,"object"==typeof self&&self,"object"==typeof t&&t];for(var i=0;i<n.length;++i){var r=n[i];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}var u=o(this);function l(e,t){if(t)e:{var n=u;e=e.split(".");for(var i=0;i<e.length-1;i++){var r=e[i];if(!(r in n))break e;n=n[r]}e=e[e.length-1],i=n[e],t=t(i),t!=i&&null!=t&&a(n,e,{configurable:!0,writable:!0,value:t})}}function c(e){return e={next:e},e[Symbol.iterator]=function(){return this},e}function d(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return{next:s(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}function h(e){if(!(e instanceof Array)){e=d(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}l("Symbol",function(e){function t(e){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new n(i+(e||"")+"_"+r++,e)}function n(e,t){this.g=e,a(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;n.prototype.toString=function(){return this.g};var i="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return t}),l("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=u[t[n]];"function"===typeof i&&"function"!=typeof i.prototype[e]&&a(i.prototype,e,{configurable:!0,writable:!0,value:function(){return c(s(this))}})}return e});var f,p="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)f=Object.setPrototypeOf;else{var g;e:{var m={a:!0},v={};try{v.__proto__=m,g=v.a;break e}catch(aR){}g=!1}f=g?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var y=f;function b(e,t){if(e.prototype=p(t.prototype),e.prototype.constructor=e,y)y(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var i=Object.getOwnPropertyDescriptor(t,n);i&&Object.defineProperty(e,n,i)}else e[n]=t[n];e.xm=t.prototype}function T(){this.o=!1,this.l=null,this.h=void 0,this.g=1,this.j=this.m=0,this.A=this.i=null}function S(e){if(e.o)throw new TypeError("Generator is already running");e.o=!0}function E(e,t){e.i={Ph:t,ai:!0},e.g=e.m||e.j}function w(e,t,n){return e.g=n,{value:t}}function A(e){e.g=0}function x(e,t,n){e.m=t,void 0!=n&&(e.j=n)}function I(e,t){e.m=0,e.j=t||0}function k(e,t,n){e.g=t,e.m=n||0}function L(e,t){return e.m=t||0,t=e.i.Ph,e.i=null,t}function R(e){e.A=[e.i],e.m=0,e.j=0}function C(e,t){var n=e.A.splice(0)[0];(n=e.i=e.i||n)?n.ai?e.g=e.m||e.j:void 0!=n.u&&e.j<n.u?(e.g=n.u,e.i=null):e.g=e.j:e.g=t}function D(e){this.g=new T,this.h=e}function M(e,t){S(e.g);var n=e.g.l;return n?P(e,"return"in n?n["return"]:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),_(e))}function P(e,t,n,i){try{var r=t.call(e.g.l,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return e.g.o=!1,r;var s=r.value}catch(a){return e.g.l=null,E(e.g,a),_(e)}return e.g.l=null,i.call(e.g,s),_(e)}function _(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.o=!1,{value:t.value,done:!1}}catch(n){e.g.h=void 0,E(e.g,n)}if(e.g.o=!1,e.g.i){if(t=e.g.i,e.g.i=null,t.ai)throw t.Ph;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function O(e){this.next=function(t){return S(e.g),e.g.l?t=P(e,e.g.l.next,t,e.g.s):(e.g.s(t),t=_(e)),t},this.throw=function(t){return S(e.g),e.g.l?t=P(e,e.g.l["throw"],t,e.g.s):(E(e.g,t),t=_(e)),t},this.return=function(t){return M(e,t)},this[Symbol.iterator]=function(){return this}}function N(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise(function(i,r){function s(e){e.done?i(e.value):Promise.resolve(e.value).then(t,n).then(s,r)}s(e.next())})}function U(e){return N(new O(new D(e)))}function F(){for(var e=Number(this),t=[],n=e;n<arguments.length;n++)t[n-e]=arguments[n];return t}function B(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function j(e,t){e instanceof String&&(e+="");var n=0,i=!1,r={next:function(){if(!i&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}function $(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}function G(e,t,n){e instanceof String&&(e=String(e));for(var i=e.length,r=0;r<i;r++){var s=e[r];if(t.call(n,s,r,e))return{Yh:r,v:s}}return{Yh:-1,v:void 0}}T.prototype.s=function(e){this.h=e},T.prototype.return=function(e){this.i={return:e},this.g=this.j},T.prototype.u=function(e){this.g=e},l("Promise",function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(r){t.reject(r)}}function n(){this.g=null}function i(e){return e instanceof t?e:new t(function(t){t(e)})}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i(function(){t.l()})}this.g.push(e)};var s=u.setTimeout;n.prototype.i=function(e){s(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(i){this.j(i)}}}this.g=null},n.prototype.j=function(e){this.i(function(){throw e})},t.prototype.j=function(){function e(e){return function(i){n||(n=!0,e.call(t,i))}}var t=this,n=!1;return{resolve:e(this.F),reject:e(this.l)}},t.prototype.F=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.H(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.C(e):this.m(e)}},t.prototype.C=function(e){var t=void 0;try{t=e.then}catch(r){return void this.l(r)}"function"==typeof t?this.I(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.G(),this.A()},t.prototype.G=function(){var e=this;s(function(){if(e.B()){var t=u.console;"undefined"!==typeof t&&t.error(e.i)}},1)},t.prototype.B=function(){if(this.o)return!1;var e=u.CustomEvent,t=u.Event,n=u.dispatchEvent;return"undefined"===typeof n||("function"===typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"===typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=u.document.createEvent("CustomEvent"),e.initCustomEvent("unhandledrejection",!1,!0,e)),e.promise=this,e.reason=this.i,n(e))},t.prototype.A=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)a.h(this.g[e]);this.g=null}};var a=new n;return t.prototype.H=function(e){var t=this.j();e.Je(t.resolve,t.reject)},t.prototype.I=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(i){n.reject(i)}},t.prototype.then=function(e,n){function i(e,t){return"function"==typeof e?function(t){try{r(e(t))}catch(n){s(n)}}:t}var r,s,a=new t(function(e,t){r=e,s=t});return this.Je(i(e,r),i(n,s)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.Je=function(e,t){function n(){switch(i.h){case 1:e(i.i);break;case 2:t(i.i);break;default:throw Error("Unexpected state: "+i.h)}}var i=this;null==this.g?a.h(n):this.g.push(n),this.o=!0},t.resolve=i,t.reject=function(e){return new t(function(t,n){n(e)})},t.race=function(e){return new t(function(t,n){for(var r=d(e),s=r.next();!s.done;s=r.next())i(s.value).Je(t,n)})},t.all=function(e){var n=d(e),r=n.next();return r.done?i([]):new t(function(e,t){function s(t){return function(n){a[t]=n,o--,0==o&&e(a)}}var a=[],o=0;do{a.push(void 0),o++,i(r.value).Je(s(a.length-1),t),r=n.next()}while(!r.done)})},t}),l("WeakMap",function(e){function t(e){if(this.g=(u+=Math.random()+1).toString(),e){e=d(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function i(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function r(e){if(!B(e,o)){var t=new n;a(e,o,{value:t})}}function s(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&r(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([[t,2],[n,3]]);return 2==i.get(t)&&3==i.get(n)&&(i.delete(t),i.set(n,4),!i.has(t)&&4==i.get(n))}catch(r){return!1}}())return e;var o="$jscomp_hidden_"+Math.random();s("freeze"),s("preventExtensions"),s("seal");var u=0;return t.prototype.set=function(e,t){if(!i(e))throw Error("Invalid WeakMap key");if(r(e),!B(e,o))throw Error("WeakMap key fail: "+e);return e[o][this.g]=t,this},t.prototype.get=function(e){return i(e)&&B(e,o)?e[o][this.g]:void 0},t.prototype.has=function(e){return i(e)&&B(e,o)&&B(e[o],this.g)},t.prototype.delete=function(e){return!!(i(e)&&B(e,o)&&B(e[o],this.g))&&delete e[o][this.g]},t}),l("Map",function(e){function t(){var e={};return e.rc=e.next=e.head=e}function n(e,t){var n=e[1];return c(function(){if(n){for(;n.head!=e[1];)n=n.rc;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}})}function i(e,t){var n=t&&typeof t;"object"==n||"function"==n?s.has(t)?n=s.get(t):(n=""+ ++a,s.set(t,n)):n="p_"+t;var i=e[0][n];if(i&&B(e[0],n))for(e=0;e<i.length;e++){var r=i[e];if(t!==t&&r.key!==r.key||t===r.key)return{id:n,list:i,index:e,entry:r}}return{id:n,list:i,index:-1,entry:void 0}}function r(e){if(this[0]={},this[1]=t(),this.size=0,e){e=d(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(d([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&"s"==r.value[1]&&(r=i.next(),!(r.done||4!=r.value[0].x||"t"!=r.value[1]||!i.next().done))}catch(s){return!1}}())return e;var s=new WeakMap;r.prototype.set=function(e,t){e=0===e?0:e;var n=i(this,e);return n.list||(n.list=this[0][n.id]=[]),n.entry?n.entry.value=t:(n.entry={next:this[1],rc:this[1].rc,head:this[1],key:e,value:t},n.list.push(n.entry),this[1].rc.next=n.entry,this[1].rc=n.entry,this.size++),this},r.prototype.delete=function(e){return e=i(this,e),!(!e.entry||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this[0][e.id],e.entry.rc.next=e.entry.next,e.entry.next.rc=e.entry.rc,e.entry.head=null,this.size--,!0)},r.prototype.clear=function(){this[0]={},this[1]=this[1].rc=t(),this.size=0},r.prototype.has=function(e){return!!i(this,e).entry},r.prototype.get=function(e){return(e=i(this,e).entry)&&e.value},r.prototype.entries=function(){return n(this,function(e){return[e.key,e.value]})},r.prototype.keys=function(){return n(this,function(e){return e.key})},r.prototype.values=function(){return n(this,function(e){return e.value})},r.prototype.forEach=function(e,t){for(var n,i=this.entries();!(n=i.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},r.prototype[Symbol.iterator]=r.prototype.entries;var a=0;return r}),l("Set",function(e){function t(e){if(this.g=new Map,e){e=d(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(d([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&r.value[1]==t&&(r=i.next(),!r.done&&r.value[0]!=t&&4==r.value[0].x&&r.value[1]==r.value[0]&&i.next().done)}catch(s){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.g.forEach(function(i){return e.call(t,i,i,n)})},t)}),l("Array.prototype.values",function(e){return e||function(){return j(this,function(e,t){return t})}}),l("Array.from",function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var i=[],r="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof r){e=r.call(e);for(var s=0;!(r=e.next()).done;)i.push(t.call(n,r.value,s++))}else for(r=e.length,s=0;s<r;s++)i.push(t.call(n,e[s],s));return i}}),l("Array.prototype.keys",function(e){return e||function(){return j(this,function(e){return e})}}),l("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}}),l("Array.prototype.includes",function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var i=n.length;for(t=t||0,0>t&&(t=Math.max(t+i,0));t<i;t++){var r=n[t];if(r===e||Object.is(r,e))return!0}return!1}}),l("String.prototype.includes",function(e){return e||function(e,t){return-1!==$(this,e,"includes").indexOf(e,t||0)}}),l("String.fromCodePoint",function(e){return e||function(e){for(var t="",n=0;n<arguments.length;n++){var i=Number(arguments[n]);if(0>i||1114111<i||i!==Math.floor(i))throw new RangeError("invalid_code_point "+i);65535>=i?t+=String.fromCharCode(i):(i-=65536,t+=String.fromCharCode(i>>>10&1023|55296),t+=String.fromCharCode(1023&i|56320))}return t}}),l("Array.prototype.findIndex",function(e){return e||function(e,t){return G(this,e,t).Yh}}),l("WeakSet",function(e){function t(e){if(this.g=new WeakMap,e){e=d(e);for(var t;!(t=e.next()).done;)this.add(t.value)}}return function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([t]);return!(!i.has(t)||i.has(n))&&(i.delete(t),i.add(n),!i.has(t)&&i.has(n))}catch(r){return!1}}()?e:(t.prototype.add=function(e){return this.g.set(e,!0),this},t.prototype.has=function(e){return this.g.has(e)},t.prototype.delete=function(e){return this.g.delete(e)},t)}),l("Array.prototype.find",function(e){return e||function(e,t){return G(this,e,t).v}}),l("String.prototype.startsWith",function(e){return e||function(e,t){var n=$(this,e,"startsWith"),i=n.length,r=e.length;t=Math.max(0,Math.min(0|t,n.length));for(var s=0;s<r&&t<i;)if(n[t++]!=e[s++])return!1;return s>=r}}),l("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)B(e,t)&&n.push([t,e[t]]);return n}});var V="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)B(i,r)&&(e[r]=i[r])}return e};l("Object.assign",function(e){return e||V}),l("Promise.prototype.finally",function(e){return e||function(e){return this.then(function(t){return Promise.resolve(e()).then(function(){return t})},function(t){return Promise.resolve(e()).then(function(){throw t})})}}),l("Array.prototype.entries",function(e){return e||function(){return j(this,function(e,t){return[e,t]})}}),l("Number.isNaN",function(e){return e||function(e){return"number"===typeof e&&isNaN(e)}}),l("String.prototype.repeat",function(e){return e||function(e){var t=$(this,null,"repeat");if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var n="";e;)1&e&&(n+=t),(e>>>=1)&&(t+=t);return n}}),l("Number.EPSILON",function(){return Math.pow(2,-52)}),l("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991}),l("Number.isFinite",function(e){return e||function(e){return"number"===typeof e&&(!isNaN(e)&&1/0!==e&&-1/0!==e)}}),l("Object.values",function(e){return e||function(e){var t,n=[];for(t in e)B(e,t)&&n.push(e[t]);return n}}),l("Math.log2",function(e){return e||function(e){return Math.log(e)/Math.LN2}}),l("String.prototype.endsWith",function(e){return e||function(e,t){var n=$(this,e,"endsWith");void 0===t&&(t=n.length),t=Math.max(0,Math.min(0|t,n.length));for(var i=e.length;0<i&&0<t;)if(n[--t]!=e[--i])return!1;return 0>=i}}),l("Math.trunc",function(e){return e||function(e){if(e=Number(e),isNaN(e)||1/0===e||-1/0===e||0===e)return e;var t=Math.floor(Math.abs(e));return 0>e?-t:t}});var H=this||self;function K(e,t){e=e.split(".");var n,i=H;e[0]in i||"undefined"==typeof i.execScript||i.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?i=i[n]&&i[n]!==Object.prototype[n]?i[n]:i[n]={}:i[n]=t}
/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function W(e){this.g=Math.exp(Math.log(.5)/e),this.i=this.h=0}function q(e){return e.h/(1-Math.pow(e.g,e.i))}function Y(){this.h=new W(2),this.j=new W(5),this.g=0,this.i=128e3,this.l=16e3}function z(){}function X(){}function Q(){}function J(e){var t=F.apply(1,arguments);ne.has(e)||(ne.add(e),Q.apply(z,h(t)))}function Z(){}function ee(){}function te(){}W.prototype.sample=function(e,t){var n=Math.pow(this.g,e);t=t*(1-n)+n*this.h,isNaN(t)||(this.h=t,this.i+=e)},Y.prototype.configure=function(e){this.i=e.minTotalBytes,this.l=e.minBytes,this.h.g=Math.exp(Math.log(.5)/e.fastHalfLife),this.j.g=Math.exp(Math.log(.5)/e.slowHalfLife)},Y.prototype.sample=function(e,t){if(!(t<this.l)){var n=8e3*t/e;e/=1e3,this.g+=t,this.h.sample(e,n),this.j.sample(e,n)}},Y.prototype.getBandwidthEstimate=function(e){return this.g<this.i?e:Math.min(q(this.h),q(this.j))};var ne=new Set;function ie(){this.g=new Map}function re(){this.g=new ie}function se(e,t,n,i){this.target=e,this.type=t,this.listener=n,this.g=ae(e,i),this.target.addEventListener(t,n,this.g)}function ae(e,t){if(void 0==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter(function(e){return!n.has(e)}),oe(e)?t:t.capture||!1}function oe(e){var t=ue;if(void 0==t){t=!1;try{var n={},i={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",i),Object.defineProperty(n,"capture",i),i=function(){},e.addEventListener("test",i,n),e.removeEventListener("test",i,n)}catch(r){t=!1}ue=t}return t||!1}e.console&&((new Map).set(1,function(){return console.error.apply(console,h(F.apply(0,arguments)))}).set(2,function(){return console.warn.apply(console,h(F.apply(0,arguments)))}).set(3,function(){return console.info.apply(console,h(F.apply(0,arguments)))}).set(4,function(){return console.log.apply(console,h(F.apply(0,arguments)))}).set(5,function(){return console.debug.apply(console,h(F.apply(0,arguments)))}).set(6,function(){return console.debug.apply(console,h(F.apply(0,arguments)))}),Q=function(){return console.warn.apply(console,h(F.apply(0,arguments)))},X=function(){console.error.apply(console,h(F.apply(0,arguments)))}),i=ie.prototype,i.push=function(e,t){this.g.has(e)?this.g.get(e).push(t):this.g.set(e,[t])},i.get=function(e){return this.g.has(e)?this.g.get(e).slice():null},i.remove=function(e,t){if(this.g.has(e)){var n=this.g.get(e).filter(function(e){return e!=t});this.g.set(e,n),n.length||this.g.delete(e)}},i.forEach=function(e){this.g.forEach(function(t,n){e(n,t)})},i.size=function(){return this.g.size},i.keys=function(){return Array.from(this.g.keys())},i=re.prototype,i.release=function(){this.Qa(),this.g=null},i.D=function(e,t,n,i){this.g&&(e=new se(e,t,n,i),this.g.push(t,e))},i.za=function(e,t,n,i){function r(i){s.Ja(e,t,r),n(i)}var s=this;this.D(e,t,r,i)},i.Ja=function(e,t,n){if(this.g){var i=this.g.get(t)||[];i=d(i);for(var r=i.next();!r.done;r=i.next())r=r.value,r.target!=e||n!=r.listener&&n||(r.Ja(),this.g.remove(t,r))}},i.Qa=function(){if(this.g){for(var e=[],t=d(this.g.g.values()),n=t.next();!n.done;n=t.next())e.push.apply(e,h(n.value));for(e=d(e),t=e.next();!t.done;t=e.next())t.value.Ja();this.g.g.clear()}},K("shaka.util.EventManager",re),re.prototype.removeAll=re.prototype.Qa,re.prototype.unlisten=re.prototype.Ja,re.prototype.listenOnce=re.prototype.za,re.prototype.listen=re.prototype.D,re.prototype.release=re.prototype.release,se.prototype.Ja=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1};var ue=void 0;function le(e){this.h=e,this.g=void 0}
/*
 @license
 Shaka Player
 Copyright 2025 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function ce(){return fe.value()}K("shaka.config.AutoShowText",{NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3}),le.prototype.value=function(){return void 0===this.g&&(this.g=this.h()),this.g};var de=null,he=null,fe=new le(function(){var e=void 0;return de&&(e=de()),!e&&he&&(e=he()),e});function pe(e,t){this.g=e,this.h=t}function ge(e,t){var n=new pe(5,0),i=ye,r=i.g,s=n.h-r.h;(0<(n.g-r.g||s)?i.i:i.h)(i.g,n,e,t)}function me(e,t,n,i){Q([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",i].join(" "))}function ve(e,t,n,i){X([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",i].join(" "))}pe.prototype.toString=function(){return"v"+this.g+"."+this.h};var ye=null,be=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");
/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
function Te(e){var t;e instanceof Te?(Se(this,e.ac),this.bd=e.bd,Ee(this,e.Cb),we(this,e.sd),this.mb=e.mb,Ae(this,e.g.clone()),this.Mc=e.Mc):e&&(t=String(e).match(be))?(Se(this,t[1]||"",!0),this.bd=xe(t[2]||""),Ee(this,t[3]||"",!0),we(this,t[4]),this.mb=xe(t[5]||"",!0),Ae(this,t[6]||"",!0),this.Mc=xe(t[7]||"")):this.g=new Pe(null)}function Se(e,t,n){e.ac=n?xe(t,!0):t,e.ac&&(e.ac=e.ac.replace(/:$/,""))}function Ee(e,t,n){e.Cb=n?xe(t,!0):t}function we(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.sd=t}else e.sd=null}function Ae(e,t,n){t instanceof Pe?e.g=t:(n||(t=Ie(t,De)),e.g=new Pe(t))}function xe(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function Ie(e,t,n){return null!=e?(e=encodeURI(e).replace(t,ke),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ke(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(15&e).toString(16)}i=Te.prototype,i.ac="",i.bd="",i.Cb="",i.sd=null,i.mb="",i.Mc="",i.toString=function(){var e=[],t=this.ac;if(t&&e.push(Ie(t,Le,!0),":"),t=this.Cb){e.push("//");var n=this.bd;n&&e.push(Ie(n,Le,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.sd,null!=t&&e.push(":",String(t))}return(t=this.mb)&&(this.Cb&&"/"!=t.charAt(0)&&e.push("/"),e.push(Ie(t,"/"==t.charAt(0)?Ce:Re,!0))),(t=this.g.toString())&&e.push("?",t),(t=this.Mc)&&e.push("#",Ie(t,Me)),e.join("")},i.resolve=function(e){var t=this.clone();"data"===t.ac&&(t=new Te);var n=!!e.ac;n?Se(t,e.ac):n=!!e.bd,n?t.bd=e.bd:n=!!e.Cb,n?Ee(t,e.Cb):n=null!=e.sd;var i=e.mb;if(n)we(t,e.sd);else if(n=!!e.mb){if("/"!=i.charAt(0))if(this.Cb&&!this.mb)i="/"+i;else{var r=t.mb.lastIndexOf("/");-1!=r&&(i=t.mb.substr(0,r+1)+i)}if(".."==i||"."==i)i="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var s=[],a=0;a<i.length;){var o=i[a++];"."==o?r&&a==i.length&&s.push(""):".."==o?((1<s.length||1==s.length&&""!=s[0])&&s.pop(),r&&a==i.length&&s.push("")):(s.push(o),r=!0)}i=s.join("/")}}return n?t.mb=i:n=""!==e.g.toString(),n?Ae(t,e.g.clone()):n=!!e.Mc,n&&(t.Mc=e.Mc),t},i.clone=function(){return new Te(this)};var Le=/[#\/\?@]/g,Re=/[#\?:]/g,Ce=/[#\?]/g,De=/[#\?@]/g,Me=/#/g;function Pe(e){this.g=e||null}function _e(e){if(!e.fb&&(e.fb=new Map,e.Id=0,e.g))for(var t=e.g.split("&"),n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];s=decodeURIComponent(s.replace(/\+/g," ")),r=r||"",e.add(s,decodeURIComponent(r.replace(/\+/g," ")))}}function Oe(e){return _e(e),e.Id}function Ne(){}function Ue(e,t){if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if((ArrayBuffer.isView(e)?e.buffer:e)==(ArrayBuffer.isView(t)?t.buffer:t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;var n=Be(e);t=Be(t);for(var i=0;i<e.byteLength;i++)if(n[i]!=t[i])return!1;return!0}function Fe(e){return ArrayBuffer.isView(e)?0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer:e}function Be(e,t,n){return n=void 0===n?1/0:n,Ge(e,void 0===t?0:t,n,Uint8Array)}function je(e,t,n){return n=void 0===n?1/0:n,Ge(e,void 0===t?0:t,n,Uint16Array)}function $e(e,t,n){return n=void 0===n?1/0:n,Ge(e,void 0===t?0:t,n,DataView)}function Ge(e,t,n,i){var r=ArrayBuffer.isView(e)?e.buffer:e,s=1;"BYTES_PER_ELEMENT"in i&&(s=i.BYTES_PER_ELEMENT);var a=((e.byteOffset||0)+e.byteLength)/s;return e=Math.floor(Math.max(0,Math.min(((e.byteOffset||0)+t)/s,a))),new i(r,e,Math.floor(Math.min(e+Math.max(n,0),a))-e)}function Ve(e,t,n){var i=F.apply(3,arguments);if(this.severity=e,this.category=t,this.code=n,this.data=i,this.handled=!1,this.message="Shaka Error "+this.code,He)try{throw Error(this.message||"Shaka Error")}catch(r){this.stack=r.stack}}i=Pe.prototype,i.fb=null,i.Id=null,i.add=function(e,t){_e(this),this.g=null;var n=this.fb.has(e)?this.fb.get(e):null;return n||this.fb.set(e,n=[]),n.push(t),this.Id++,this},i.set=function(e,t){return _e(this),this.g=null,this.fb.has(e)?this.fb.set(e,[t]):this.add(e,t),this},i.get=function(e){return _e(this),this.fb.get(e)||[]},i.toString=function(){if(this.g)return this.g;if(!this.fb||!this.fb.size)return"";for(var e=[],t=d(this.fb.keys()),n=t.next();!n.done;n=t.next()){var i=n.value;n=encodeURIComponent(i),i=this.fb.get(i);for(var r=0;r<i.length;r++){var s=n;""!==i[r]&&(s+="="+encodeURIComponent(i[r])),e.push(s)}}return this.g=e.join("&")},i.clone=function(){var e=new Pe;if(e.g=this.g,this.fb){for(var t=new Map,n=d(this.fb),i=n.next();!i.done;i=n.next()){var r=d(i.value);i=r.next().value,r=r.next().value,t.set(i,r.concat())}e.fb=t,e.Id=this.Id}return e},K("shaka.util.BufferUtils",Ne),Ne.toDataView=$e,Ne.toUint16=je,Ne.toUint8=Be,Ne.toArrayBuffer=Fe,Ne.equal=Ue,Ve.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},K("shaka.util.Error",Ve);var He=!0;function Ke(){}function We(t){if(!t)return"";if(t=Be(t),239==t[0]&&187==t[1]&&191==t[2]&&(t=t.subarray(3)),e.TextDecoder&&!ce().kh())return t=(new TextDecoder).decode(t),t.includes("�")&&X('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),t;for(var n="",i=0;i<t.length;++i){var r=65533;if(0==(128&t[i])?r=t[i]:t.length>=i+2&&192==(224&t[i])&&128==(192&t[i+1])?(r=(31&t[i])<<6|63&t[i+1],i+=1):t.length>=i+3&&224==(240&t[i])&&128==(192&t[i+1])&&128==(192&t[i+2])?(r=(15&t[i])<<12|(63&t[i+1])<<6|63&t[i+2],i+=2):t.length>=i+4&&240==(241&t[i])&&128==(192&t[i+1])&&128==(192&t[i+2])&&128==(192&t[i+3])&&(r=(7&t[i])<<18|(63&t[i+1])<<12|(63&t[i+2])<<6|63&t[i+3],i+=3),65535>=r)n+=String.fromCharCode(r);else{r-=65536;var s=1023&r;n+=String.fromCharCode(55296+(r>>10)),n+=String.fromCharCode(56320+s)}}return n}function qe(e,t,n){if(!e)return"";if(!n&&0!=e.byteLength%2)throw new Ve(2,2,2004);n=Math.floor(e.byteLength/2);var i=new Uint16Array(n);e=$e(e);for(var r=0;r<n;r++)i[r]=e.getUint16(2*r,t);return Qe(i)}function Ye(e){function t(e){return n.byteLength<=e||9<=n[e]&&126>=n[e]}if(!e)return"";var n=Be(e);if(239==n[0]&&187==n[1]&&191==n[2])return We(n);if(254==n[0]&&255==n[1])return qe(n.subarray(2),!1);if(255==n[0]&&254==n[1])return qe(n.subarray(2),!0);if(0==n[0]&&0==n[2])return qe(e,!1);if(0==n[1]&&0==n[3])return qe(e,!0);if(t(0)&&t(1)&&t(2)&&t(3))return We(e);throw new Ve(2,2,2003)}function ze(t){if(e.TextEncoder&&!ce().kh()){var n=new TextEncoder;return Fe(n.encode(t))}t=encodeURIComponent(t),t=unescape(t),n=new Uint8Array(t.length);for(var i=0;i<t.length;i++)n[i]=t[i].charCodeAt(0);return Fe(n)}function Xe(e,t){for(var n=new ArrayBuffer(2*e.length),i=new DataView(n),r=0;r<e.length;++r)i.setUint16(2*r,e.charCodeAt(r),t);return n}function Qe(e){return Ze.value()(e)}function Je(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&nbsp;":" ","&lrm;":"‎","&rlm;":"‏"},n=/&(?:amp|lt|gt|quot|apos|nbsp|lrm|rlm|#[xX]?[0-9a-fA-F]+);/g,i=RegExp(n.source);return e&&i.test(e)?e.replace(n,function(e){return"#"==e[1]?(e="x"==e[2]||"X"==e[2]?parseInt(e.substring(3),16):parseInt(e.substring(2),10),0<=e&&1114111>=e?String.fromCodePoint(e):""):t[e]||"'"}):e||""}Ve.Severity={RECOVERABLE:1,CRITICAL:2},Ve.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},Ve.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,MSS_MISSING_DATA_FOR_TRANSMUXING:3020,MSS_TRANSMUXING_FAILED:3022,TRANSMUXING_NO_VIDEO_DATA:3023,STREAMING_NOT_ALLOWED:3024,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,MSS_INVALID_XML:4046,MSS_LIVE_CONTENT_NOT_SUPPORTED:4047,AES_128_INVALID_IV_LENGTH:4048,AES_128_INVALID_KEY_LENGTH:4049,DASH_CONFLICTING_AES_128:4050,DASH_UNSUPPORTED_AES_128:4051,DASH_INVALID_PATCH:4052,HLS_EMPTY_MEDIA_PLAYLIST:4053,DASH_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4054,CANNOT_ADD_EXTERNAL_CHAPTERS_TO_LIVE_STREAM:4054,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,MIN_HDCP_VERSION_NOT_MATCH:6018,ERROR_CHECKING_HDCP_VERSION:6019,MISSING_EME_SUPPORT:6020,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,SRC_EQUALS_PRELOAD_NOT_SUPPORTED:7005,PRELOAD_DESTROYED:7006,QUEUE_INDEX_OUT_OF_BOUNDS:7007,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004,MT_AD_MANAGER_NOT_INITIALIZED:10005,INTERSTITIAL_AD_MANAGER_NOT_INITIALIZED:10006,VAST_INVALID_XML:10007},K("shaka.util.StringUtils",Ke),Ke.resetFromCharCode=function(){Ze.g=void 0},Ke.toUTF16=Xe,Ke.toUTF8=ze,Ke.fromBytesAutoDetect=Ye,Ke.fromUTF16=qe,Ke.fromUTF8=We;var Ze=new le(function(){function e(e){try{var t=new Uint8Array(e);return 0<String.fromCharCode.apply(null,t).length}catch(n){return!1}}for(var t={Gc:65536};0<t.Gc;t={Gc:t.Gc},t.Gc/=2)if(e(t.Gc))return function(e){return function(t){for(var n="",i=0;i<t.length;i+=e.Gc)n+=String.fromCharCode.apply(null,t.subarray(i,i+e.Gc));return n}}(t);return null});function et(){}function tt(e){return e=Qe(Be(e)),btoa(e)}function nt(e,t){return t=void 0==t||t,e=tt(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/[=]*$/,"")}function it(t){t=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));for(var n=new Uint8Array(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n}function rt(t){for(var n=t.length/2,i=new Uint8Array(n),r=0;r<n;r++)i[r]=e.parseInt(t.substr(2*r,2),16);return i}function st(e){var t=Be(e);e="",t=d(t);for(var n=t.next();!n.done;n=t.next())n=n.value,n=n.toString(16),1==n.length&&(n="0"+n),e+=n;return e}function at(){for(var e=F.apply(0,arguments),t=0,n=0;n<e.length;++n)t+=e[n].byteLength;t=new Uint8Array(t);for(var i=n=0;i<e.length;++i){var r=e[i];ArrayBuffer.isView(r)&&1===r.BYTES_PER_ELEMENT?t.set(r,n):t.set(Be(r),n),n+=r.byteLength}return t}function ot(e,t,n){if(n=void 0===n?"":n,0==t.length)return e;if(1==e.length&&1==t.length){var i=new Te(e[0]);return t=new Te(t[0]),t=i.resolve(t),n&&Ae(t,n),[t.toString()]}t=t.map(function(e){return new Te(e)}),i=[],e=d(e);for(var r=e.next();!r.done;r=e.next()){r=new Te(r.value);for(var s=d(t),a=s.next();!a.done;a=s.next())a=r.resolve(a.value),n&&Ae(a,n),i.push(a.toString())}return i}function ut(e,t,n,i){return e={keySystem:e,encryptionScheme:t,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:n||[],keyIds:new Set},i&&(e.keySystemUris=new Set([i])),e}function lt(t,n){n=void 0===n?"cenc":n;var i=[],r=[],s=[];t.forEach(function(e,t){var n=t;22!=n.length&&(n=nt(rt(t),!1));var a=e;22!=a.length&&(a=nt(rt(e),!1)),e={kty:"oct",kid:n,k:a},i.push(e),r.push(e.kid),s.push(t)}),t=JSON.stringify({keys:i});var a=JSON.stringify({kids:r});return a=[{initData:Be(ze(a)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",encryptionScheme:n,licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:a,keyIds:new Set(s)}}function ct(e,t){if(1==t.length)return t[0];if(e=dt(e,t),null!=e)return e;throw new Ve(2,4,4025,t)}function dt(e,t){var n=mt.get(e);n=d(n);for(var i=n.next();!i.done;i=n.next()){i=i.value;for(var r=d(t),s=r.next();!s.done;s=r.next())if(s=s.value,i.test(s.trim()))return s.trim()}return e==ft?"":null}function ht(e,t){var n=[];e=mt.get(e),e=d(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;for(var r=d(t),s=r.next();!s.done;s=r.next())s=s.value,i.test(s.trim())&&n.push(s.trim())}return n}K("shaka.util.Uint8ArrayUtils",et),et.concat=at,et.toHex=st,et.fromHex=rt,et.fromBase64=it,et.toBase64=nt,et.toStandardBase64=tt;var ft="text",pt={xa:"video",ea:"audio",Ya:ft,Of:"image",cl:"application"},gt=1/15,mt=(new Map).set("audio",[/^vorbis$/,/^Opus$/,/^opus$/,/^fLaC$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4/,/^dts[cex]$/,/^iamf/,/^mhm[12]/,/^ac3$/,/^eac3$/,/^apac$/]).set("video",[/^avc/,/^hev/,/^hvc/,/^vvc/,/^vvi/,/^vp0?[89]/,/^av01/,/^dvh/,/^dva/,/^dav/]).set("text",[/^vtt$/,/^wvtt/,/^stpp/]);function vt(e,t,n,i){this.g=null,this.l=e,this.i=t,this.m=n,this.o=i,this.j=!1;e:{if("undefined"===typeof libDPIModule&&Q("Could not find LCEVC Library dependencies on this page"),"undefined"!==typeof LCEVCdec)this.h=LCEVCdec;else{if("undefined"===typeof LcevcDil){Q("Could not find LCEVC Library on this page"),e=!1;break e}this.h=LcevcDil,this.j=!0,ge("LcevcDil","lcevc_dil.js is deprecated, please use lcevc_dec.js instead")}"undefined"===typeof this.h.SupportObject?(Q("Could not find LCEVC Library on this page"),e=!1):(this.h.SupportObject.SupportStatus||Q(this.h.SupportObject.SupportError),e="undefined"!==typeof this.h&&"undefined"!==typeof libDPIModule&&this.i instanceof HTMLCanvasElement&&this.h.SupportObject.SupportStatus)}e&&!this.g&&this.h.SupportObject.webGLSupport(this.i)&&(this.i.classList.remove("shaka-hidden"),this.g=this.j?new this.h.LcevcDil(this.l,this.i,this.m):new this.h.LCEVCdec(this.l,this.i,this.m))}function yt(e,t,n,i){"video"!==i.type||e.o&&!i.baseOriginalId||e.g&&e.g.appendBuffer(t,"video",i.id,-n,!e.o)}function bt(e){e.g&&e.i.classList.add("shaka-hidden")}function Tt(e){return!(!e||"undefined"===typeof LCEVCdec)&&"lvc1"==e.codecs}function St(t){if(At.has(t))return At.get(t);var n=e.ManagedMediaSource||e.MediaSource;return!!n&&(n=n.isTypeSupported(t),At.set(t,n),n)}function Et(){var t=e.ManagedSourceBuffer||e.SourceBuffer;return!!t&&!!t.prototype&&!!t.prototype.changeType}function wt(){var t=e.ManagedMediaSource||e.MediaSource;return!(!t||!t.prototype)&&(!!t.prototype.setLiveSeekableRange&&!!t.prototype.clearLiveSeekableRange)}vt.prototype.release=function(){this.g&&(this.g.close(),this.g=null)},K("shaka.lcevc.Dec",vt),vt.prototype.release=vt.prototype.release;var At=new Map;function xt(){}function It(){}function kt(){}function Lt(e){this.h=new Map,this.i=0,this.j=new It,(e=Ct(e.toLowerCase()))&&(this.j=e()),this.g=new xt,(e=Mt)&&(this.g=e(),this.h.set(this.i,this.g))}function Rt(e,t){Dt.set(e,t)}function Ct(e){return Dt.get(e)}xt.prototype.extract=function(){},xt.prototype.decode=function(){return[]},xt.prototype.clear=function(){},xt.prototype.getStreams=function(){return[]},It.prototype.init=function(){},It.prototype.parse=function(){return[]},i=kt.prototype,i.init=function(){},i.rf=function(){},i.Cd=function(){},i.remove=function(){},i.Pf=function(){},K("shaka.media.IClosedCaptionParser",kt),i=Lt.prototype,i.init=function(e,t,n){if(t=void 0!==t&&t,n=void 0===n?-1:n,-1!=n&&this.i!=n){t=n;var i=this.h.get(t);this.h.set(this.i,this.g),i?this.g=i:((i=Mt)&&(this.g=i()),this.h.set(t,this.g))}else t||this.Cd();this.j.init(e),-1!=n&&(this.i=n)},i.rf=function(e){e=this.j.parse(e),e=d(e);for(var t=e.next();!t.done;t=e.next()){t=t.value;var n=Be(t.packet);0<n.length&&this.g.extract(n,t.pts)}return this.g.decode()},i.Cd=function(){this.g.clear()},i.remove=function(e){e=void 0===e?[]:e,e=new Set(e);for(var t=d(this.h.keys()),n=t.next();!n.done;n=t.next())if(n=n.value,!e.has(n)){var i=this.h.get(n);i&&i.clear(),this.h.delete(n)}},i.Pf=function(){return this.g.getStreams()},K("shaka.media.ClosedCaptionParser",Lt),Lt.findDecoder=function(){return Mt},Lt.unregisterDecoder=function(){Mt=null},Lt.registerDecoder=function(e){Mt=e},Lt.findParser=Ct,Lt.unregisterParser=function(e){Dt.delete(e)},Lt.registerParser=Rt;var Dt=new Map,Mt=null;function Pt(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=_t,this.scroll=Ot}K("shaka.text.CueRegion",Pt);var _t=1;Pt.units={PX:0,PERCENTAGE:_t,LINES:2};var Ot="";function Nt(e,t){return!("number"!==typeof e||"number"!==typeof t||!isNaN(e)||!isNaN(t))||e===t}function Ut(e,t){t=e.indexOf(t),-1<t&&e.splice(t,1)}function Ft(e,t,n){if(n||(n=Nt),e.length!=t.length)return!1;t=t.slice(),e=d(e);for(var i=e.next(),r={};!i.done;r={ci:void 0},i=e.next()){if(r.ci=i.value,i=t.findIndex(function(e){return function(t){return n(e.ci,t)}}(r)),-1==i)return!1;t[i]=t[t.length-1],t.pop()}return 0==t.length}function Bt(e,t,n){if(e===t)return!0;if(!e||!t)return e==t;if(n||(n=Nt),e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1;return!0}function jt(e){this.h=e||"",this.g=0}function $t(e){Gt(e,/[ \t]+/gm)}function Gt(e,t){return t.lastIndex=e.g,t=t.exec(e.h),t=null==t?null:{position:t.index,length:t[0].length,results:t},e.g==e.h.length||null==t||t.position!=e.g?null:(e.g+=t.length,t.results)}function Vt(e){return e.g==e.h.length?null:(e=Gt(e,/[^ \t\n]*/gm))?e[0]:null}function Ht(e){if(e=Gt(e,Wt),null==e)return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:(Number(e[6])||0)/1e3+n+60*t+3600*(Number(e[1])||0)}function Kt(e){return e?Ht(new jt(e)):null}Pt.scrollMode={NONE:Ot,UP:"up"};var Wt=/(?:(\d{1,}):)?(\d{2}):(\d{2})((\.(\d{1,3})))?/g;function qt(e){function t(e){switch(typeof e){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return e;default:if(!e||ArrayBuffer.isView(e))return e;if(n.has(e))return null;var i=Array.isArray(e);if(e.constructor!=Object&&!i)return null;n.add(e);var r,s=i?[]:{};for(r in e)s[r]=t(e[r]);return i&&(s.length=e.length),s}}var n=new WeakSet;return t(e)}function Yt(e){var t,n={};for(t in e)n[t]=e[t];return n}function zt(e){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++){var i=n.toString(),r=e[n];void 0!==r&&(r=zt(r))&&t.push(i+":"+r)}e="["+t.join(",")+"]"}else if("function"==typeof e)e="";else if(e instanceof Object){for(n=Object.keys(e),n.sort(),t=[],n=d(n),i=n.next();!i.done;i=n.next())r=i.value,i=JSON.stringify(r),r=e[r],void 0!==r&&(r=zt(r))&&t.push(i+":"+r);e="{"+t.join(",")+"}"}else e=JSON.stringify(e);return e}
/*
 @license
 tXml
 Copyright 2015 Tobias Nickel
 SPDX-License-Identifier: MIT
*/
function Xt(e,t){var n=void 0!==n&&n;return e=Ye(e),Qt(e,t,n)}function Qt(e,t,n){return e=Zt(e,void 0!==n&&n),!t&&e.length?e[0]:(e=e.find(function(e){return t.split(",").includes(e.tagName)}))?e:null}function Jt(e){return Ln.has(e)?Ln.get(e):""}function Zt(e,t){function n(s,a){a=void 0!==a&&a;for(var o=[];e[r];)if(60==e.charCodeAt(r)){if(47===e.charCodeAt(r+1)){a=r+2,r=e.indexOf(">",r),a=e.substring(a,r);var u=a.indexOf(s);if(-1==u){var l=s.indexOf(".");0<l&&(u=a.indexOf(s.substring(0,l)))}if(-1==u)throw s=e.substring(0,r).split("\n"),Error("Unexpected close tag\nLine: "+(s.length-1)+"\nColumn: "+(s[s.length-1].length+1)+"\nChar: "+e[r]);r+1&&(r+=1);break}if(33===e.charCodeAt(r+1)){if(45==e.charCodeAt(r+2)){for(;-1!==r&&(62!==e.charCodeAt(r)||45!=e.charCodeAt(r-1)||45!=e.charCodeAt(r-2)||-1==r);)r=e.indexOf(">",r+1);-1===r&&(r=e.length)}else if(91===e.charCodeAt(r+2)&&91===e.charCodeAt(r+8)&&"cdata"===e.substr(r+3,5).toLowerCase()){u=e.indexOf("]]>",r),-1==u?(o.push(e.substr(r+9)),r=e.length):(o.push(e.substring(r+9,u)),r=u+3);continue}r++;continue}e:{l=a,r++;var c=i(),d={};for(u=[];62!==e.charCodeAt(r)&&e[r];){var f=e.charCodeAt(r);if(64<f&&91>f||96<f&&123>f){f=i();for(var p=e.charCodeAt(r);p&&39!==p&&34!==p&&!(64<p&&91>p||96<p&&123>p)&&62!==p;)r++,p=e.charCodeAt(r);var g=r+1;if(r=e.indexOf(e[r],g),g=e.slice(g,r),39===p||34===p){if(-1===r){if(l={tagName:c,attributes:d,children:u,parent:null},t)for(c=0;c<u.length;c++)"string"!==typeof u[c]&&(u[c].parent=l);u=l;break e}}else g=null,r--;if(f.startsWith("xmlns:")){p=g;var m=f.split(":")[1];Ln.set(p,m),Rn.set(m,p)}"tt"===c&&"xml:space"===f&&"preserve"===g&&(l=!0),d[f]=g}r++}for(47!==e.charCodeAt(r-1)?(r++,u=n(c,l)):r++,l={tagName:c,attributes:d,children:u,parent:null},c=u.length,d=0;d<c;d++)f=u[d],"string"!==typeof f?t&&(f.parent=l):d==c-1&&"\n"==f&&u.pop();u=l}if(o.push(u),"string"===typeof u)break;"?"===u.tagName[0]&&u.children&&(o.push.apply(o,h(u.children)),u.children=[])}else u=r,r=e.indexOf("<",r)-1,-2===r&&(r=e.length),u=e.slice(u,r+1),a?0<u.length&&o.push(u):(o.length&&1==u.length&&"\n"==u[0]||0<u.trim().length)&&o.push(u),r++;return o}function i(){for(var t=r;-1==="\r\n\t>/= ".indexOf(e[r])&&e[r];)r++;return e.slice(t,r)}var r=0;return n("")}function en(e){return"string"===typeof e}function tn(e){var t=[];if(!e.children)return[];e=d(e.children);for(var n=e.next();!n.done;n=e.next())n=n.value,"string"!==typeof n&&t.push(n);return t}function nn(e,t){var n=[];if(!e.children)return[];e=d(e.children);for(var i=e.next();!i.done;i=e.next())i=i.value,i.tagName===t&&n.push(i);return n}function rn(e){return"string"===typeof e?Je(e):(e=e.children.reduce(function(e,t){return"string"===typeof t?e+t:e},""),""===e?null:Je(e))}function sn(e){return Array.from(e.children).every(function(e){return"string"===typeof e})?((e=rn(e))&&(e=e.trim()),e):null}function an(e,t,n){if(n=void 0===n?[]:n,e.tagName===t&&n.push(e),e.children){e=d(e.children);for(var i=e.next();!i.done;i=e.next())an(i.value,t,n)}return n}function on(e,t){return e=nn(e,t),1!=e.length?null:e[0]}function un(e,t,n){return e=dn(e,t,n),1!=e.length?null:e[0]}function ln(e,t,n,i){i=void 0===i?null:i;var r=null;return e=e.attributes[t],null!=e&&(r=n(e)),null==r?i:r}function cn(e,t,n){return t=Jt(t),e.attributes[t+":"+n]||null}function dn(e,t,n){var i=Jt(t);if(t=[],e.children)for(n=i?i+":"+n:n,e=d(e.children),i=e.next();!i.done;i=e.next())(i=i.value)&&i.tagName===n&&t.push(i);return t}function hn(e,t,n){t=d(t);for(var i=t.next();!i.done;i=t.next())if(i=cn(e,i.value,n))return i;return null}function fn(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null}function pn(e){return e?(e=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$","i").exec(e),e?(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null):null):null}function gn(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null}function mn(e){return e=Number(e),0===e%1?e:null}function vn(e){return e=Number(e),0===e%1&&0<e?e:null}function yn(e){return e=Number(e),0===e%1&&0<=e?e:null}function bn(e){return e=Number(e),isNaN(e)?null:e}function Tn(e){return!!e&&"true"===e.toLowerCase()}function Sn(e){var t,n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(n)?null:n}function En(e){var t=[];e=Je(e).split(/\/+(?=(?:[^'"]*['"][^'"]*['"])*[^'"]*$)/),e=d(e);for(var n=e.next();!n.done;n=e.next()){n=n.value;var i=n.match(/^([\w]+)/);if(i){var r=n.match(/(@id='(.*?)')/),s=n.match(/(@t='(\d+)')/),a=n.match(/(@n='(\d+)')/),o=n.match(/\[(\d+)\]/);t.push({name:i[0],id:r?r[0].match(/'(.*?)'/)[0].replace(/'/gm,""):null,t:s?Number(s[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,n:a?Number(a[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,position:o?Number(o[1])-1:null,vc:n.split("/@")[1]||null})}else n.startsWith("@")&&t.length&&(t[t.length-1].vc=n.slice(1))}return t}function wn(e,t){var n=En(t.attributes.sel||"");if(n.length){var i=n[n.length-1],r=t.attributes.pos||null;n=i.position,null==n&&(null!==i.t&&(n=An(e,"t",i.t)),null!==i.n&&(n=An(e,"n",i.n))),null===n?n="prepend"===r?0:e.length:"prepend"===r?--n:"after"===r&&++n,r=t.tagName,(i=i.vc)&&e[n]?xn(e[n],r,i,sn(t)||""):("remove"!==r&&"replace"!==r||e.splice(n,1),"add"!==r&&"replace"!==r||e.splice.apply(e,[n,0].concat(h(t.children))))}}function An(e,t,n){var i=0;e=d(e);for(var r=e.next();!r.done;r=e.next()){if(Number(r.value.attributes[t])===n)return i;i++}return null}function xn(e,t,n,i){"remove"===t?delete e.attributes[n]:"add"!==t&&"replace"!==t||(e.attributes[n]=i)}function In(e){var t="",n=e.tagName.split(":");for(var i in 0<n.length&&(t=n[0],t=Rn.has(t)?Rn.get(t):""),t=document.createElementNS(t,e.tagName),e.attributes)t.setAttribute(i,e.attributes[i]);for(e=d(e.children),i=e.next();!i.done;i=e.next())i=i.value,n=void 0,n="string"==typeof i?new Text(i):In(i),t.appendChild(n);return t}function kn(e){if(!e)return null;var t={tagName:e.tagName,attributes:Yt(e.attributes),children:[],parent:null};e=d(e.children);for(var n=e.next();!n.done;n=e.next())n=n.value,"string"===typeof n||(n=kn(n),n.parent=t),t.children.push(n);return t}var Ln=new Map,Rn=new Map;function Cn(e,t,n){this.startTime=e,this.endTime=t,this.payload=n,this.region=new Pt,this.position=null,this.positionAlign=Fn,this.size=0,this.textAlign=Bn,this.direction=Vn,this.writingMode=Hn,this.lineInterpretation=Kn,this.line=null,this.lineHeight="",this.lineAlign=Wn,this.displayAlign=$n,this.fontSize=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=Xn,this.fontStyle=Jn,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textCombineUpright="",this.textDecoration=[],this.textStrokeWidth=this.textStrokeColor=this.textShadow="",this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.rubyTag=null,this.cellResolution={Kc:32,rows:15}}function Dn(e,t){return e=new Cn(e,t,""),e.lineBreak=!0,e}function Mn(e,t){if(e.payload!=t.payload||!(.001>Math.abs(e.startTime-t.startTime)&&.001>Math.abs(e.endTime-t.endTime)))return!1;for(var n in e)if("startTime"!=n&&"endTime"!=n&&"payload"!=n)if("nestedCues"==n){if(!Bt(e.nestedCues,t.nestedCues,Mn))return!1}else if("region"==n||"cellResolution"==n){for(var i in e[n])if(e[n][i]!=t[n][i])return!1}else if(Array.isArray(e[n])){if(!Bt(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}function Pn(e,t){t=void 0===t?new Map:t;var n=e.payload;if(n.includes("<")){0===t.size&&_n(t);var i=n;n=[];for(var r=-1,s=0;s<i.length;s++)"<"===i[s]?r=s+1:">"===i[s]&&0<r&&(r=i.substr(r,s-r),r.match(ni)&&n.push(r),r=-1);for(n=d(n),s=n.next();!s.done;s=n.next())s=s.value,i=i.replace("<"+s+">",'<div time="'+s+'">'),i+="</div>";e:{s=i,r=[];var a=-1;n="",i=!1;for(var o=0;o<s.length;o++)if("/"===s[o]){var u=s.indexOf(">",o);if(-1===u){n=s;break e}if((u=s.substring(o+1,u))&&"v"==u){i=!0;var l=null;if(r.length&&(l=r[r.length-1]),l){if(l===u)n+="/"+u+">";else{if(!l.startsWith("v")){n+=s[o];continue}n+="/"+l+">"}o+=u.length+1}else n+=s[o]}else n+=s[o]}else"<"===s[o]?(a=o+1,"v"!=s[a]&&(a=-1)):">"===s[o]&&0<a&&(r.push(s.substr(a,o-a)),a=-1),n+=s[o];for(s=d(r),r=s.next();!r.done;r=s.next())r=r.value,a=r.replace(" ",".voice-"),n=n.replace("<"+r+">","<"+a+">"),n=n.replace("</"+r+">","</"+a+">"),i||(n+="</"+a+">")}n=On(n),e.payload="";try{var c=Qt("<span>"+n+"</span>","span")}catch(h){}if(c)if(c=c.children,1!=c.length||c[0].tagName)for(c=d(c),n=c.next();!n.done;n=c.next())Nn(n.value,e,t);else e.payload=Je(n);else e.payload=Je(n)}else e.payload=Je(n)}function _n(e){for(var t=d(Object.entries(Yn)),n=t.next();!n.done;n=t.next()){var i=d(n.value);n=i.next().value,i=i.next().value;var r=new Cn(0,0,"");r.color=i,e.set("."+n,r)}for(t=d(Object.entries(zn)),n=t.next();!n.done;n=t.next())i=d(n.value),n=i.next().value,i=i.next().value,r=new Cn(0,0,""),r.backgroundColor=i,e.set("."+n,r)}function On(e){var t={"< ":""," >":" &gt;"},n=/(< +>|<\s|\s>)/g,i=RegExp(n.source);return e&&i.test(e)?e.replace(n,function(e){return t[e]||""}):e||""}function Nn(e,t,n){var i=t.clone();if(i.nestedCues=[],i.payload="",i.rubyTag="",i.line=null,i.region=new Pt,i.position=null,i.size=0,i.textAlign=Bn,e.tagName)for(var r=d(e.tagName.split(/(?=[ .])+/g)),s=r.next();!s.done;s=r.next()){var a=s=s.value;if(a.startsWith(".voice-")){var o=a.split("-").pop();a='v[voice="'+o+'"]',n.has(a)||(a="v[voice="+o+"]")}switch(n.has(a)&&(o=i,a=n.get(a))&&(o.backgroundColor=Un(a.backgroundColor,o.backgroundColor),o.color=Un(a.color,o.color),o.fontFamily=Un(a.fontFamily,o.fontFamily),o.fontSize=Un(a.fontSize,o.fontSize),o.textShadow=Un(a.textShadow,o.textShadow),o.fontWeight=a.fontWeight,o.fontStyle=a.fontStyle,o.opacity=a.opacity,o.rubyTag=a.rubyTag,o.textCombineUpright=a.textCombineUpright,o.wrapLine=a.wrapLine),s){case"br":return i=Dn(i.startTime,i.endTime),void t.nestedCues.push(i);case"b":i.fontWeight=Qn;break;case"i":i.fontStyle=Zn;break;case"u":i.textDecoration.push(ti);break;case"font":(s=e.attributes.color)&&(i.color=s);break;case"div":if(s=e.attributes.time,!s)break;(s=Kt(s))&&(i.startTime=s);break;case"ruby":case"rp":case"rt":i.rubyTag=s}}if(r=e.children,en(e)||1==r.length&&en(r[0]))for(n=rn(e).split("\n"),e=!0,n=d(n),r=n.next();!r.done;r=n.next())r=r.value,e||(e=Dn(i.startTime,i.endTime),t.nestedCues.push(e)),0<r.length&&(e=i.clone(),e.payload=Je(r),t.nestedCues.push(e)),e=!1;else for(t.nestedCues.push(i),t=d(r),e=t.next();!e.done;e=t.next())Nn(e.value,i,n)}function Un(e,t){return e&&0<e.length?e:t}Cn.prototype.clone=function(){var e,t=new Cn(0,0,"");for(e in this)t[e]=this[e],Array.isArray(t[e])&&(t[e]=t[e].slice());return t},K("shaka.text.Cue",Cn),Cn.parseCuePayload=Pn,Cn.equal=Mn,Cn.prototype.clone=Cn.prototype.clone;var Fn="auto";Cn.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Fn};var Bn="center",jn={LEFT:"left",RIGHT:"right",CENTER:Bn,START:"start",END:"end"};Cn.textAlign=jn;var $n="after",Gn={BEFORE:"before",CENTER:"center",AFTER:$n};Cn.displayAlign=Gn;var Vn="ltr";Cn.direction={HORIZONTAL_LEFT_TO_RIGHT:Vn,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var Hn="horizontal-tb";Cn.writingMode={HORIZONTAL_TOP_TO_BOTTOM:Hn,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var Kn=0;Cn.lineInterpretation={LINE_NUMBER:Kn,PERCENTAGE:1};var Wn="start",qn={CENTER:"center",START:Wn,END:"end"};Cn.lineAlign=qn;var Yn={white:"white",lime:"lime",cyan:"cyan",red:"red",yellow:"yellow",magenta:"magenta",blue:"blue",black:"black"};Cn.defaultTextColor=Yn;var zn={bg_white:"white",bg_lime:"lime",bg_cyan:"cyan",bg_red:"red",bg_yellow:"yellow",bg_magenta:"magenta",bg_blue:"blue",bg_black:"black"};Cn.defaultTextBackgroundColor=zn;var Xn=400,Qn=700;Cn.fontWeight={NORMAL:Xn,BOLD:Qn};var Jn="normal",Zn="italic",ei={NORMAL:Jn,ITALIC:Zn,OBLIQUE:"oblique"};Cn.fontStyle=ei;var ti="underline";Cn.textDecoration={UNDERLINE:ti,LINE_THROUGH:"lineThrough",OVERLINE:"overline"};var ni=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g;function ii(){}function ri(e,t,n){ai.set(e.toLowerCase().split(";")[0]+"-"+n,{priority:n,tf:t})}function si(e,t){for(var n=e.toLowerCase().split(";")[0],i=d([ci,li,ui,oi]),r=i.next();!r.done;r=i.next())if(r=ai.get(n+"-"+r.value)){var s=r.tf(),a=s.isSupported(e,t);if(s.destroy(),a)return r.tf}return null}ii.prototype.destroy=function(){},K("shaka.transmuxer.TransmuxerEngine",ii),ii.findTransmuxer=si,ii.unregisterTransmuxer=function(e,t){ai.delete(e.toLowerCase().split(";")[0]+"-"+t)},ii.registerTransmuxer=ri,ii.prototype.destroy=ii.prototype.destroy;var ai=new Map,oi=1,ui=2,li=3,ci=4;function di(){}function hi(e,t){var n=e;return t&&!Ei.includes(e)&&(n+='; codecs="'+t+'"'),n}function fi(e,t){return t&&(e+='; codecs="'+t+'"'),e}function pi(e,t,n){var i=hi(e,t);return t=fi(e,t),si(t)?(e=si(t))?(e=e(),n=e.convertCodecs(n,t),e.destroy()):n=t:n="video/mp2t"!=e&&"audio"==n?i.replace("video","audio"):i,n}function gi(e){return e.split(";")[0].split("/")[1]}function mi(e){var t=Si(e);switch(e=t[0].toLowerCase(),t=t[1].toLowerCase(),!0){case"mp4a"===e&&"69"===t:case"mp4a"===e&&"6b"===t:case"mp4a"===e&&"40.34"===t:return"mp3";case"mp4a"===e&&"66"===t:case"mp4a"===e&&"67"===t:case"mp4a"===e&&"68"===t:case"mp4a"===e&&"40.2"===t:case"mp4a"===e&&"40.02"===t:case"mp4a"===e&&"40.5"===t:case"mp4a"===e&&"40.05"===t:case"mp4a"===e&&"40.29"===t:case"mp4a"===e&&"40.42"===t:return"aac";case"mp4a"===e&&"a5"===t:case"ac3"===e:case"ac-3"===e:return"ac-3";case"mp4a"===e&&"a6"===t:case"eac3"===e:case"ec-3"===e:return"ec-3";case"ac-4"===e:return"ac-4";case"mp4a"===e&&"b2"===t:return"dtsx";case"mp4a"===e&&"a9"===t:return"dtsc";case"vp09"===e:case"vp9"===e:return"vp9";case"avc1"===e:case"avc3"===e:return"avc";case"hvc1"===e:case"hev1"===e:return"hevc";case"vvc1"===e:case"vvi1"===e:return"vvc";case"dvh1"===e:case"dvhe"===e:return t&&t.startsWith("05")?"dovi-p5":"dovi-hevc";case"dvav"===e:case"dva1"===e:return"dovi-avc";case"dav1"===e:return"dovi-av1";case"dvc1"===e:case"dvi1"===e:return"dovi-vvc"}return e}function vi(e){var t=[];e=d(e.split(","));for(var n=e.next();!n.done;n=e.next())n=Si(n.value),t.push(n[0]);return t.sort().join(",")}function yi(e){return e.split(";")[0]}function bi(e){return e=e.split(/ *; */),e.shift(),(e=e.find(function(e){return e.startsWith("codecs=")}))?e.split("=")[1].replace(/^"|"$/g,""):""}function Ti(e){return"application/x-mpegurl"===e||"application/vnd.apple.mpegurl"===e}function Si(e){e=e.split(".");var t=e[0];return e.shift(),[t,e.join(".")]}ii.PluginPriority={FALLBACK:oi,PREFERRED_SECONDARY:ui,PREFERRED:li,APPLICATION:ci},K("shaka.util.MimeUtils",di),di.getFullTypeWithAllCodecs=fi,di.getFullType=hi,(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");var Ei=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"];function wi(e){this.i=null,this.j=e,this.B=!1,this.l=this.s=0,this.m=1/0,this.h=this.g=null,this.C="",this.A=function(){},this.o=new Map}function Ai(e,t){Mi.set(e,t)}function xi(e){return Mi.get(e)}function Ii(e){return!!Mi.has(e)||("application/cea-608"==e||"application/cea-708"==e)&&!!Mt}function ki(e,t,n,i,r){var s,a,o,u,l,c,h;return U(function(f){if(1==f.g)return w(f,Promise.resolve(),2);if(!e.i||!e.j)return f.return();if(null==n||null==i)return e.i.parseInit(Be(t)),f.return();for(s=e.B?n:e.s,a={periodStart:e.s,segmentStart:n,segmentEnd:i,vttOffset:s},o=e.i.parseMedia(Be(t),a,r,[]),u=d(o),l=u.next();!l.done;l=u.next())c=l.value,e.A(c,r||null,a);h=o.filter(function(t){return t.startTime>=e.l&&t.startTime<e.m}),e.j.append(h),null==e.g&&(e.g=Math.max(n,e.l)),e.h=Math.min(i,e.m),A(f)})}function Li(e,t,n){e.l=t,e.m=n}function Ri(e,t,n){if(e.C=t,t=e.o.get(t))for(var i=d(t.keys()),r=i.next();!r.done;r=i.next())(r=t.get(r.value).filter(function(e){return e.endTime<=n}))&&e.j.append(r)}function Ci(e,t,n){t.startTime+=n,t.endTime+=n,t=d(t.nestedCues);for(var i=t.next();!i.done;i=t.next())Ci(e,i.value,n)}function Di(e,t,n,i,r){var s=n+" "+i,a=new Map;t=d(t);for(var o=t.next();!o.done;o=t.next()){var u=o.value;o=u.stream,u=u.cue,a.has(o)||a.set(o,new Map),a.get(o).has(s)||a.get(o).set(s,[]),Ci(e,u,r),u.startTime>=e.l&&u.startTime<e.m&&(a.get(o).get(s).push(u),o==e.C&&e.j.append([u]))}for(r=d(a.keys()),s=r.next();!s.done;s=r.next())for(s=s.value,e.o.has(s)||e.o.set(s,new Map),t=d(a.get(s).keys()),o=t.next();!o.done;o=t.next())o=o.value,u=a.get(s).get(o),e.o.get(s).set(o,u);e.g=null==e.g?Math.max(n,e.l):Math.min(e.g,Math.max(n,e.l)),e.h=Math.max(e.h,Math.min(i,e.m))}wi.prototype.destroy=function(){return this.j=this.i=null,this.o.clear(),Promise.resolve()},wi.prototype.remove=function(e,t){var n=this;return U(function(i){if(1==i.g)return w(i,Promise.resolve(),2);!n.j||!n.j.remove(e,t)||null==n.g||t<=n.g||e>=n.h||(e<=n.g&&t>=n.h?n.g=n.h=null:e<=n.g&&t<n.h?n.g=t:e>n.g&&t>=n.h&&(n.h=e)),A(i)})},K("shaka.text.TextEngine",wi),wi.prototype.destroy=wi.prototype.destroy,wi.findParser=xi,wi.unregisterParser=function(e){Mi.delete(e)},wi.registerParser=Ai;var Mi=new Map;function Pi(e){this.h=e,this.g=null}function _i(e){this.h=e,this.g=null}function Oi(e,t){return e.concat(t)}function Ni(){}function Ui(e){return null!=e}function Fi(e,t){return Promise.race([t,new Promise(function(t,n){new _i(n).ha(e)})])}function Bi(){}function ji(e,t){return e=Vi(e),t=Vi(t),e.split("-")[0]==t.split("-")[0]}function $i(e,t){return e=Vi(e),t=Vi(t),e=e.split("-"),t=t.split("-"),e[0]==t[0]&&1==e.length&&2==t.length}function Gi(e,t){return e=Vi(e),t=Vi(t),e=e.split("-"),t=t.split("-"),2==e.length&&2==t.length&&e[0]==t[0]}function Vi(e){e=d(e.split("-x-"));var t=e.next().value;t=void 0===t?"":t,e=e.next().value,e=void 0===e?"":e;var n=d(t.split("-"));return t=n.next().value,t=void 0===t?"":t,n=n.next().value,n=void 0===n?"":n,e=e?"x-"+e:"",t=t.toLowerCase(),t=Yi.get(t)||t,n=n.toUpperCase(),(n?t+"-"+n:t)+(e?"-"+e:"")}function Hi(e,t){return e=Vi(e),t=Vi(t),t==e?4:$i(t,e)?3:Gi(t,e)?2:$i(e,t)?1:0}function Ki(e){var t=e.indexOf("-");return e=0<=t?e.substring(0,t):e,e=e.toLowerCase(),Yi.get(e)||e}function Wi(e){return e.language?Vi(e.language):e.audio&&e.audio.language?Vi(e.audio.language):e.video&&e.video.language?Vi(e.video.language):"und"}function qi(e,t){e=Vi(e);var n=new Set;t=d(t);for(var i=t.next();!i.done;i=t.next())n.add(Vi(i.value));for(t=d(n),i=t.next();!i.done;i=t.next())if(i=i.value,i==e)return i;for(t=d(n),i=t.next();!i.done;i=t.next())if(i=i.value,$i(i,e))return i;for(t=d(n),i=t.next();!i.done;i=t.next())if(i=i.value,Gi(i,e))return i;for(n=d(n),t=n.next();!t.done;t=n.next())if(t=t.value,$i(e,t))return t;return null}Pi.prototype.ha=function(t){var n=this;this.stop();var i=!0,r=null;return this.g=function(){e.clearTimeout(r),i=!1},r=e.setTimeout(function(){i&&n.h()},1e3*t),this},Pi.prototype.stop=function(){this.g&&(this.g(),this.g=null)},_i.prototype.Hb=function(){return this.stop(),this.h(),this},_i.prototype.ha=function(e){var t=this;return this.stop(),this.g=new Pi(function(){t.h()}).ha(e),this},_i.prototype.Ga=function(e){var t=this;return this.stop(),this.g=new Pi(function(){t.g.ha(e),t.h()}).ha(e),this},_i.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},K("shaka.util.Timer",_i),_i.prototype.stop=_i.prototype.stop,_i.prototype.tickEvery=_i.prototype.Ga,_i.prototype.tickAfter=_i.prototype.ha,_i.prototype.tickNow=_i.prototype.Hb,K("shaka.util.LanguageUtils",Bi),Bi.findClosestLocale=qi,Bi.getLocaleForVariant=Wi,Bi.getLocaleForText=function(e){return Vi(e.language||"und")},Bi.getBase=Ki,Bi.relatedness=Hi,Bi.areSiblings=function(e,t){var n=Ki(e),i=Ki(t);return e!=n&&t!=i&&n==i},Bi.normalize=Vi,Bi.isSiblingOf=Gi,Bi.isParentOf=$i,Bi.areLanguageCompatible=ji,Bi.areLocaleCompatible=function(e,t){return e=Vi(e),t=Vi(t),e==t};var Yi=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function zi(){}function Xi(e,t,n,i,r){function s(e){var t=String(e.width||"")+String(e.height||"")+String(Math.round(e.frameRate||0))+(e.hdr||"")+e.fastSwitching;return e.dependencyStream&&(t+=e.dependencyStream.baseOriginalId||""),t}function a(e){var t=e.language+(e.channelsCount||0)+(e.audioSamplingRate||0)+e.roles.join(",")+e.label+e.groupId+e.fastSwitching;return e.dependencyStream&&(t+=e.dependencyStream.baseOriginalId||""),t}if(r.length){var o=e.textStreams;r=d(r);for(var u=r.next(),l={};!u.done;l={sh:void 0},u=r.next())if(l.sh=u.value,u=o.filter(function(e){return function(t){return!(!t.codecs.startsWith(e.sh)&&!t.mimeType.startsWith(e.sh))}}(l)),u.length){o=u;break}e.textStreams=o}if(o=e.variants,(t.length||n.length)&&(o=Qi(o,t,n)),i.length){for(t=new ie,n=d(o),o=n.next();!o.done;o=n.next())o=o.value,t.push(String(o.video.width||0),o);var c=[];t.forEach(function(e,t){e=0;var n=[];t=d(t);for(var r=t.next(),s={};!r.done;s={Mf:void 0},r=t.next())s.Mf=r.value,r=i.filter(function(e){return function(t){return e.Mf.decodingInfos[0][t]}}(s)).length,r>e?(e=r,n=[s.Mf]):r==e&&n.push(s.Mf);c.push.apply(c,h(n))}),o=c}for(n=new Set,t=new Set,o=d(o),r=o.next();!r.done;r=o.next())r=r.value,r.audio&&n.add(r.audio),r.video&&t.add(r.video);o=Array.from(n).sort(function(e,t){return e.bandwidth-t.bandwidth});var f=[];for(n=new Map,o=d(o),r=o.next();!r.done;r=o.next()){if(r=r.value,u=a(r),l=n.get(u)||[],l.length){var p=l[l.length-1],g=mi(p.codecs),m=mi(r.codecs);g!=m||r.bandwidth&&p.bandwidth&&!(r.bandwidth>p.bandwidth)||(l.push(r),f.push(r.id))}else l.push(r),f.push(r.id);n.set(u,l)}var v={vp8:1,avc:1,"dovi-avc":.95,vp9:.9,vp09:.9,hevc:.85,"dovi-hevc":.8,"dovi-p5":.75,av01:.7,"dovi-av1":.65,vvc:.6};o=Array.from(t).sort(function(e,t){if(!e.bandwidth||!t.bandwidth||e.bandwidth==t.bandwidth){if(e.codecs&&t.codecs&&e.codecs!=t.codecs&&e.width==t.width){var n=mi(e.codecs),i=mi(t.codecs);if(n!=i)return(v[n]||1)-(v[i]||1)}return e.width-t.width}return e.bandwidth-t.bandwidth}),t=Et();var y=[];for(n=new Map,o=d(o),r=o.next();!r.done;r=o.next()){if(r=r.value,u=s(r),l=n.get(u)||[],l.length){if(p=l[l.length-1],!t&&(g=mi(p.codecs),m=mi(r.codecs),g!==m))continue;g=mi(p.codecs),m=mi(r.codecs),g!=m||r.bandwidth&&p.bandwidth&&!(r.bandwidth>p.bandwidth)||(l.push(r),y.push(r.id))}else l.push(r),y.push(r.id);n.set(u,l)}e.variants=e.variants.filter(function(e){var t=e.audio;return e=e.video,!(t&&!f.includes(t.id)||e&&!y.includes(e.id))})}function Qi(e,t,n){t=d(t);for(var i=t.next(),r={};!i.done;r={videoCodec:void 0},i=t.next())if(r.videoCodec=i.value,i=e.filter(function(e){return function(t){return t.video&&t.video.codecs.startsWith(e.videoCodec)}}(r)),i.length){e=i;break}for(n=d(n),t=n.next(),i={};!t.done;i={audioCodec:void 0},t=n.next())if(i.audioCodec=t.value,t=e.filter(function(e){return function(t){return t.audio&&t.audio.codecs.startsWith(e.audioCodec)}}(i)),t.length){e=t;break}return e}function Ji(e,t,n){e.variants=e.variants.filter(function(e){return Zi(e,t,n)})}function Zi(e,t,n){function i(e,t,n){return e>=t&&e<=n}var r=e.video;if(r&&r.width&&r.height){var s=r.width,a=r.height;if(a>s&&(a=d([a,s]),s=a.next().value,a=a.next().value),!i(s,t.minWidth,Math.min(t.maxWidth,n.width))||!i(a,t.minHeight,Math.min(t.maxHeight,n.height))||!i(r.width*r.height,t.minPixels,t.maxPixels))return!1}return!(e&&e.video&&e.video.frameRate&&!i(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||e&&e.audio&&e.audio.channelsCount&&!i(e.audio.channelsCount,t.minChannelsCount,t.maxChannelsCount)||!i(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function er(e,t,n,i){return n=void 0===n?[]:n,i=void 0===i?{}:i,U(function(r){return 1==r.g?w(r,tr(e,t,0<t.offlineSessionIds.length,n,i),2):(cr(t),w(r,dr(t),0))})}function tr(e,t,n,i,r){var s,a;return U(function(o){if(1==o.g)return ce().Ni()&&nr(t.variants),w(o,ar(t.variants,n,!1,i),2);s=null,e&&(a=e.g)&&(s=a.keySystem),t.variants=t.variants.filter(function(e){var t=ir(e,s,r);if(!t){var n=[];e.audio&&n.push(Ar(e.audio)),e.video&&n.push(Ar(e.video))}return t}),A(o)})}function nr(e){var t=(new Map).set("dvav","avc3").set("dva1","avc1").set("dvhe","hev1").set("dvh1","hvc1").set("dvc1","vvc1").set("dvi1","vvi1"),n=new Set;e=d(e);for(var i=e.next();!i.done;i=e.next())i=i.value,i.video&&n.add(i.video);for(n=d(n),e=n.next();!e.done;e=n.next()){e=e.value,i=d(t);for(var r=i.next();!r.done;r=i.next()){var s=d(r.value);if(r=s.next().value,s=s.next().value,e.codecs.includes(r)){e.codecs=e.codecs.replace(r,s);break}}}}function ir(e,t,n){if(!e.decodingInfos.some(function(e){return!(!e.supported||t&&(e=e.keySystemAccess)&&(n[e.keySystem]||e.keySystem)!=t)}))return!1;var i=ce(),r="Xbox"===i.Mb();i="MOBILE"===i.La()&&"GECKO"===i.Da();var s=e.video,a=s&&s.width||0,o=s&&s.height||0;return!(r&&s&&(1920<a||1080<o)&&(s.codecs.includes("avc1.")||s.codecs.includes("avc3."))||(r=s&&s.dependencyStream)&&!Tt(r))&&(e=e.audio,!(i&&e&&e.encrypted&&e.codecs.toLowerCase().includes("opus")||e&&e.dependencyStream))}function rr(e,t){var n,i,r,s,a,o,u;return U(function(l){if(1==l.g){for(n=function(e,t){if(e){var n=Yt(e);return n.supported=e.supported&&t.supported,n.powerEfficient=e.powerEfficient&&t.powerEfficient,n.smooth=e.smooth&&t.smooth,t.keySystemAccess&&!n.keySystemAccess&&(n.keySystemAccess=t.keySystemAccess),n}return t},i=null,r=[],s=d(t),a=s.next(),o={};!a.done;o={cache:void 0,Ie:void 0},a=s.next())u=a.value,o.Ie=zt(u),o.cache=Ir,o.cache.has(o.Ie)?i=n(i,o.cache.get(o.Ie)):r.push(sr(u).then(function(e){return function(t){var r=null;t=d(t||[]);for(var s=t.next();!s.done;s=t.next())r=n(r,s.value);r&&(e.cache.set(e.Ie,r),i=n(i,r))}}(o)));return w(l,Promise.all(r),2)}i&&e.decodingInfos.push(i),A(l)})}function sr(e){var t=[""];e.video&&(t=bi(e.video.contentType).split(","));var n=[""];e.audio&&(n=bi(e.audio.contentType).split(","));var i=[];t=d(t);for(var r=t.next();!r.done;r=t.next()){r=r.value;for(var s=d(n),a=s.next(),o={};!a.done;o={Lc:void 0},a=s.next())a=a.value,o.Lc=qt(e),e.video&&(o.Lc.video.contentType=hi(yi(o.Lc.video.contentType),r)),e.audio&&(o.Lc.audio.contentType=hi(yi(o.Lc.audio.contentType),a)),i.push(new Promise(function(e){return function(t,n){("MOBILE"==ce().La()?Fi(5,navigator.mediaCapabilities.decodingInfo(e.Lc)):navigator.mediaCapabilities.decodingInfo(e.Lc)).then(function(e){t(e)}).catch(n)}}(o)))}return Promise.all(i).catch(function(){return JSON.stringify(e),null})}function ar(e,t,n,i){var r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E;return U(function(A){switch(A.g){case 1:if(e.some(function(e){return e.decodingInfos.length}))return A.return();r=d(i),s=r.next(),a={};case 2:if(s.done){A.u(4);break}a.si=s.value,o=!1,u=d(e),l=u.next();case 5:if(l.done){A.u(7);break}c=l.value,h=or(c,t,n).filter(function(e){return function(t){return t=t[0],(t.keySystemConfiguration&&t.keySystemConfiguration.keySystem)===e.si}}(a)),f=d(h),p=f.next();case 8:if(p.done){A.u(10);break}return g=p.value,w(A,rr(c,g),9);case 9:p=f.next(),A.u(8);break;case 10:c.decodingInfos.length&&(o=!0),l=u.next(),A.u(5);break;case 7:if(o)return A.return();a={si:void 0},s=r.next(),A.u(2);break;case 4:m=d(e),v=m.next();case 12:if(v.done){A.u(0);break}y=v.value,b=or(y,t,n).filter(function(e){return e=e[0],e=e.keySystemConfiguration&&e.keySystemConfiguration.keySystem,!e||!i.includes(e)}),T=d(b),S=T.next();case 15:if(S.done){v=m.next(),A.u(12);break}return E=S.value,w(A,rr(y,E),16);case 16:S=T.next(),A.u(15)}})}function or(e,t,n){var i=e.audio,r=e.video,s=[],a=[];if(r)for(var o=d(r.fullMimeTypes),u=o.next();!u.done;u=o.next()){u=u.value;var l=bi(u);if(l.includes(",")&&!i){var c=l.split(","),h=yi(u);l=ct("video",c),c=ct("audio",c),c=ur(c,h),h=pi(h,c,"audio"),a.push({contentType:h,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1})}if(l=lr(l),u={contentType:pi(yi(u),l,"video"),width:r.width||64,height:r.height||64,bitrate:r.bandwidth||e.bandwidth||1,framerate:r.frameRate||1},r.hdr)switch(r.hdr){case"SDR":u.transferFunction="srgb";break;case"PQ":u.transferFunction="pq";break;case"HLG":u.transferFunction="hlg"}r.colorGamut&&(u.colorGamut=r.colorGamut),s.push(u)}if(i)for(o=d(i.fullMimeTypes),u=o.next();!u.done;u=o.next())l=u.value,u=yi(l),l=ur(bi(l),u),u=pi(u,l,"audio"),a.push({contentType:u,channels:i.channelsCount||2,bitrate:i.bandwidth||e.bandwidth||1,samplerate:i.audioSamplingRate||1,spatialRendering:i.spatialAudio});for(o=[],0==s.length&&s.push(null),0==a.length&&a.push(null),s=d(s),u=s.next();!u.done;u=s.next())for(u=u.value,l=d(a),h=l.next();!h.done;h=l.next())h=h.value,c={type:n?"file":"media-source"},u&&(c.video=u),h&&(c.audio=h),o.push(c);if(a=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]),!a.length)return[o];for(e=[],n=new Map,a=d(a),s=a.next();!s.done;s=a.next())s=s.value,n.get(s.keySystem)||n.set(s.keySystem,[]),n.get(s.keySystem).push(s);for(a=t?"required":"optional",t=t?["persistent-license"]:["temporary"],s=d(n.keys()),u=s.next();!u.done;u=s.next()){for(u=u.value,h=n.get(u),l=new Map,h=d(h),c=h.next();!c.done;c=h.next()){c=c.value;var f=c.videoRobustness+","+c.audioRobustness;l.get(f)||l.set(f,[]),l.get(f).push(c)}for(l=d(l.values()),h=l.next();!h.done;h=l.next()){h=h.value,c=[],f=d(o);for(var p=f.next();!p.done;p=f.next()){p=Object.assign({},p.value);for(var g={keySystem:u,initDataType:"cenc",persistentState:a,distinctiveIdentifier:"optional",sessionTypes:t},m=d(h),v=m.next();!v.done;v=m.next()){if(v=v.value,v.initData&&v.initData.length){for(var y=new Set,b=d(v.initData),T=b.next();!T.done;T=b.next())y.add(T.value.initDataType);g.initDataType=v.initData[0].initDataType}v.distinctiveIdentifierRequired&&(g.distinctiveIdentifier="required"),v.persistentStateRequired&&(g.persistentState="required"),v.sessionType&&(g.sessionTypes=[v.sessionType]),i&&(g.audio?(v.encryptionScheme&&(g.audio.encryptionScheme=g.audio.encryptionScheme||v.encryptionScheme),g.audio.robustness=g.audio.robustness||v.audioRobustness):(g.audio={robustness:v.audioRobustness},v.encryptionScheme&&(g.audio.encryptionScheme=v.encryptionScheme)),""==g.audio.robustness&&delete g.audio.robustness),r&&(g.video?(v.encryptionScheme&&(g.video.encryptionScheme=g.video.encryptionScheme||v.encryptionScheme),g.video.robustness=g.video.robustness||v.videoRobustness):(g.video={robustness:v.videoRobustness},v.encryptionScheme&&(g.video.encryptionScheme=v.encryptionScheme)),""==g.video.robustness&&delete g.video.robustness)}p.keySystemConfiguration=g,c.push(p)}e.push(c)}}return e}function ur(e,t){var n=ce();return"flac"==e.toLowerCase()?"WEBKIT"!=n.Da()?"flac":"fLaC":"opus"===e.toLowerCase()?"WEBKIT"!=n.Da()?"opus":"mp4"==gi(t)?"Opus":"opus":"ac-3"==e.toLowerCase()&&n.be()?"ec-3":e}function lr(e){if(e.includes("avc1")){var t=e.split(".");if(3==t.length)return e=t.shift()+".",e+=parseInt(t.shift(),10).toString(16),e+("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}else if("vp9"==e)return"vp09.00.41.08";return e}function cr(e){e.textStreams=e.textStreams.filter(function(e){return e=hi(e.mimeType,e.codecs),Ii(e)})}function dr(e){var t,n,i,r,s,a,o;return U(function(u){switch(u.g){case 1:t=[],n=d(e.imageStreams),i=n.next();case 2:if(i.done){u.u(4);break}if(r=i.value,s=r.mimeType,"application/mp4"==s&&"mjpg"==r.codecs&&(s="image/jpg"),Lr.has(s)){u.u(5);break}if(a=Rr.get(s),!a){Lr.set(s,!1),u.u(5);break}return w(u,hr(a),7);case 7:o=u.h,Lr.set(s,o);case 5:Lr.get(s)&&t.push(r),i=n.next(),u.u(2);break;case 4:e.imageStreams=t,A(u)}})}function hr(e){return new Promise(function(t){var n=new Image;n.src=e,"decode"in n?n.decode().then(function(){t(!0)}).catch(function(){t(!1)}):n.onload=n.onerror=function(){t(2===n.height)}})}function fr(e){var t=e.audio,n=e.video,i=t?t.mimeType:null,r=n?n.mimeType:null,s=t?t.codecs:null,a=n?n.codecs:null,o=t?t.groupId:null,u=[];n&&u.push(n.mimeType),t&&u.push(t.mimeType),u=u[0]||null;var l=[];t&&l.push(t.kind),n&&l.push(n.kind),l=l[0]||null;var c=new Set;if(t)for(var h=d(t.roles),f=h.next();!f.done;f=h.next())c.add(f.value);if(n)for(h=d(n.roles),f=h.next();!f.done;f=h.next())c.add(f.value);if(e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:l,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:u,audioMimeType:i,videoMimeType:r,codecs:"",audioCodec:s,videoCodec:a,primary:e.primary,roles:Array.from(c),audioRoles:null,forced:!1,videoId:null,audioId:null,audioGroupId:o,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null,e.hdr=n.hdr||null,e.colorGamut=n.colorGamut||null,e.videoLayout=n.videoLayout||null,(i=n.dependencyStream)&&(e.width=i.width||e.width,e.height=i.height||e.height,e.videoCodec=i.codecs||e.videoCodec),a.includes(","))){e.channelsCount=n.channelsCount,e.audioSamplingRate=n.audioSamplingRate,e.spatialAudio=n.spatialAudio,e.originalLanguage=n.originalLanguage,e.audioMimeType=r,n=a.split(",");try{e.videoCodec=ct("video",n),e.audioCodec=ct("audio",n)}catch(p){}}return t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.spatialAudio=t.spatialAudio,e.label=t.label,e.audioRoles=t.roles,e.accessibilityPurpose=t.accessibilityPurpose,e.originalLanguage=t.originalLanguage,t=t.dependencyStream)&&(e.audioCodec=t.codecs||e.audioCodec),t=[],e.videoCodec&&t.push(e.videoCodec),e.audioCodec&&t.push(e.audioCodec),e.codecs=t.join(", "),e}function pr(e){return{id:e.id,active:!1,type:ft,bandwidth:e.bandwidth||0,language:e.language,label:e.label,kind:e.kind||null,mimeType:e.mimeType,codecs:e.codecs||null,primary:e.primary,roles:e.roles,accessibilityPurpose:e.accessibilityPurpose,forced:e.forced,originalTextId:e.originalId,originalLanguage:e.originalLanguage}}function gr(e){var t=e.width||null,n=e.height||null,i=null;e.segmentIndex&&(i=Wl(e.segmentIndex));var r=e.tilesLayout;return i&&(r=i.tilesLayout||r),r&&null!=t&&(t/=Number(r.split("x")[0])),r&&null!=n&&(n/=Number(r.split("x")[1])),{id:e.id,type:"image",bandwidth:e.bandwidth||0,width:t,height:n,mimeType:e.mimeType,codecs:e.codecs||null,tilesLayout:r||null,originalImageId:e.originalId}}function mr(e){return e.__shaka_id||(e.__shaka_id=kr++),e.__shaka_id}function vr(e){var t={id:mr(e),active:"disabled"!=e.mode,type:ft,bandwidth:0,language:Vi(e.language||"und"),label:e.label,kind:e.kind,mimeType:null,codecs:null,primary:!1,roles:[],accessibilityPurpose:null,forced:"forced"==e.kind,originalTextId:e.id,originalLanguage:e.language};return"captions"==e.kind&&(t.mimeType="unknown"),"subtitles"==e.kind&&(t.mimeType="text/vtt"),e.kind&&(t.roles=[e.kind]),t}function yr(e,t){var n=e?e.language:null;if(n={id:mr(e||t),active:e?e.enabled:t.selected,type:"variant",bandwidth:0,language:Vi(n||"und"),label:e?e.label:null,kind:e?e.kind:null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!!e&&"main"==e.kind,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,audioGroupId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:t?t.id:null,originalAudioId:e?e.id:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:n},e&&e.kind&&(n.roles=[e.kind],n.audioRoles=[e.kind]),e&&e.configuration&&(e.configuration.codec&&(n.audioCodec=e.configuration.codec,n.codecs=n.audioCodec),e.configuration.bitrate&&(n.audioBandwidth=e.configuration.bitrate,n.bandwidth+=n.audioBandwidth),e.configuration.sampleRate&&(n.audioSamplingRate=e.configuration.sampleRate),e.configuration.numberOfChannels&&(n.channelsCount=e.configuration.numberOfChannels)),t&&t.configuration&&(t.configuration.codec&&(n.videoCodec=t.configuration.codec,n.codecs=n.codecs?n.codecs+","+n.videoCodec:n.videoCodec),t.configuration.bitrate&&(n.videoBandwidth=t.configuration.bitrate,n.bandwidth+=n.videoBandwidth),t.configuration.framerate&&(n.frameRate=t.configuration.framerate),t.configuration.width&&(n.width=t.configuration.width),t.configuration.height&&(n.height=t.configuration.height),t.configuration.colorSpace&&t.configuration.colorSpace.transfer))switch(t.configuration.colorSpace.transfer){case"pq":n.hdr="PQ";break;case"hlg":n.hdr="HLG";break;case"bt709":n.hdr="SDR"}return n}function br(e){return e.allowedByApplication&&e.allowedByKeySystem&&0==e.disabledUntilTime}function Tr(e){return e.filter(function(e){return br(e)})}function Sr(e,t,n,i){var r=e,s=e.filter(function(e){return e.primary});s.length&&(r=s);var a=r.length?r[0].language:"";if(r=r.filter(function(e){return e.language==a}),t){var o=qi(Vi(t),e.map(function(e){return e.language}));o&&(r=e.filter(function(e){return Vi(e.language)==o}))}if(r=r.filter(function(e){return e.forced==i}),n){if(e=Er(r,n),e.length)return e}else if(e=r.filter(function(e){return 0==e.roles.length}),e.length)return e;return e=r.map(function(e){return e.roles}).reduce(Oi,[]),e.length?Er(r,e[0]):r}function Er(e,t){return e.filter(function(e){return e.roles.includes(t)})}function wr(e,t){t.length&&(t=t.filter(function(t){return mi(e.codecs)==mi(t.codecs)}).sort(function(e,t){return e.bandwidth&&t.bandwidth&&e.bandwidth!=t.bandwidth?e.bandwidth-t.bandwidth:(e.width||0)-(t.width||0)}),e.trickModeVideo=t[0],1<t.length&&(t=t.find(function(t){return e.width==t.width&&e.height==t.height})))&&(e.trickModeVideo=t)}function Ar(e){return"audio"==e.type?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:"video"==e.type?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}function xr(e,t,n){if(0==n.autoShowText)return!1;if(1==n.autoShowText)return!0;var i=Vi(n.preferredTextLanguage);return t=Vi(t.language),2==n.autoShowText?ji(t,i):3==n.autoShowText?!!e&&(e=Vi(e.language),ji(t,i)&&!ji(e,t)):(Q("Invalid autoShowText setting!"),!1)}K("shaka.util.StreamUtils",zi),zi.meetsRestrictions=Zi;var Ir=new Map,kr=0,Lr=(new Map).set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),Rr=(new Map).set("image/webp","data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA").set("image/avif","data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=");function Cr(){var t=this;this.G=null,this.o=!1,this.m=new Y,this.j=new re,navigator.connection&&navigator.connection.addEventListener&&this.j.D(navigator.connection,"change",function(){if(t.o&&t.g.useNetworkInformation){t.m=new Y,t.g&&t.m.configure(t.g.advanced);var e=t.chooseVariant();e&&navigator.onLine&&t.G(e,t.g.clearBufferSwitch,t.g.safeMarginSwitch)}}),this.F=[],this.H=1,this.I=!1,this.h=this.l=this.g=this.s=null,this.A=new _i(function(){if(t.o&&(t.g.restrictToElementSize||t.g.restrictToScreenSize)){var e=t.chooseVariant();e&&t.G(e,t.g.clearBufferSwitch,t.g.safeMarginSwitch)}}),this.B=e,"documentPictureInPicture"in e&&this.j.D(e.documentPictureInPicture,"enter",function(){t.B=e.documentPictureInPicture.window,t.A&&t.A.Hb(),t.j.za(t.B,"pagehide",function(){t.B=e,t.A&&t.A.Hb()})}),this.C=this.i=null}function Dr(e){if(!e.I){var t=e.m;if(!(t.g>=t.i))return;e.I=!0,e.s-=1e3*(e.g.switchInterval-e.g.minTimeToSwitch)}Date.now()-e.s<1e3*e.g.switchInterval||(t=e.chooseVariant(),e.getBandwidthEstimate(),t&&e.G(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch))}function Mr(e,t,n,i,r){if(e.C){var s=e.C.Vh();s&&(n=n.filter(function(e){return!e.bandwidth||!s||e.bandwidth<=s}))}return t&&(n=n.filter(function(e){return Zi(e,t,{width:r,height:i})})),n.sort(function(e,t){return e.bandwidth-t.bandwidth})}function Pr(e){var t=[];e=d(e);for(var n=e.next();!n.done;n=e.next())(n=n.value.video)&&n.height&&n.width&&t.push({height:n.height,width:n.width});return t.sort(function(e,t){return e.width-t.width})}i=Cr.prototype,i.stop=function(){this.G=null,this.o=!1,this.F=[],this.H=1,this.l=this.s=null,this.h&&(this.h.disconnect(),this.h=null),this.A.stop(),this.C=this.i=null},i.release=function(){this.j.release(),this.A=null},i.init=function(e){this.G=e},i.chooseVariant=function(){var e=1/0,t=1/0;if(this.g.restrictToScreenSize){var n=this.g.ignoreDevicePixelRatio?1:this.B.devicePixelRatio;e=this.B.screen.height*n,t=this.B.screen.width*n}if(this.h&&this.g.restrictToElementSize){n=this.g.ignoreDevicePixelRatio?1:this.B.devicePixelRatio;var i=this.l.clientHeight,r=this.l.clientWidth;this.i&&document.pictureInPictureElement&&document.pictureInPictureElement==this.l&&(i=this.i.height,r=this.i.width),e=Math.min(e,i*n),t=Math.min(t,r*n)}if(n=this.F.filter(function(e){return e&&!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)}),n.length||(n=this.F),i=n,n.length!=this.F.length&&(i=this.F.filter(function(e){return e&&!!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)})),n=Mr(this,this.g.restrictions,i,1/0,1/0),1/0!=e||1/0!=t){for(n=Pr(n),n=d(n),r=n.next();!r.done;r=n.next())if(r=r.value,r.height>=e&&r.width>=t){e=r.height,t=r.width;break}n=Mr(this,this.g.restrictions,i,e,t)}for(e=this.getBandwidthEstimate(),i.length&&!n.length&&(n=Mr(this,null,i,1/0,1/0),n=[n[0]]),t=n[0]||null,i=0;i<n.length;i++){r=n[i];for(var s=isNaN(this.H)?1:Math.abs(this.H),a=s*r.bandwidth/this.g.bandwidthDowngradeTarget,o={bandwidth:1/0},u=i+1;u<n.length;u++)if(r.bandwidth!=n[u].bandwidth){o=n[u];break}s=s*o.bandwidth/this.g.bandwidthUpgradeTarget,e>=a&&e<=s&&(t.bandwidth!=r.bandwidth||t.bandwidth==r.bandwidth&&t.video&&r.video&&(t.video.width<r.video.width||t.video.height<r.video.height))&&(t=r)}return this.s=Date.now(),t},i.enable=function(){this.o=!0},i.disable=function(){this.o=!1},i.segmentDownloaded=function(e,t,n,i){var r=e;this.g.removeLatencyFromFirstPacketTime&&i&&1===i.packetNumber&&i.timeToFirstByte&&(r=e-i.timeToFirstByte),r<this.g.cacheLoadThreshold||(this.m.sample(r,t),n&&null!=this.s&&this.o&&Dr(this))},i.trySuggestStreams=function(){null!=this.s&&this.o&&Dr(this)},i.getBandwidthEstimate=function(){var e=this.g.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&(e=1e6*navigator.connection.downlink),navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&this.g.preferNetworkInformationBandwidth?e:(e=this.m.getBandwidthEstimate(e),this.C?this.C.getBandwidthEstimate(e):e)},i.setVariants=function(e){this.F=e},i.playbackRateChanged=function(e){this.H=e},i.setMediaElement=function(t){function n(){i.A.ha(_r)}var i=this;this.l=t,this.h&&(this.h.disconnect(),this.h=null),this.l&&"ResizeObserver"in e&&(this.h=new ResizeObserver(n),this.h.observe(this.l)),this.j.D(t,"enterpictureinpicture",function(e){e.pictureInPictureWindow&&(i.i=e.pictureInPictureWindow,i.j.D(i.i,"resize",n))}),this.j.D(t,"leavepictureinpicture",function(){i.i&&i.j.Ja(i.i,"resize",n),i.i=null})},i.setCmsdManager=function(e){this.C=e},i.configure=function(e){this.g=e,this.m&&this.g&&this.m.configure(this.g.advanced)},K("shaka.abr.SimpleAbrManager",Cr),Cr.prototype.configure=Cr.prototype.configure,Cr.prototype.setCmsdManager=Cr.prototype.setCmsdManager,Cr.prototype.setMediaElement=Cr.prototype.setMediaElement,Cr.prototype.playbackRateChanged=Cr.prototype.playbackRateChanged,Cr.prototype.setVariants=Cr.prototype.setVariants,Cr.prototype.getBandwidthEstimate=Cr.prototype.getBandwidthEstimate,Cr.prototype.trySuggestStreams=Cr.prototype.trySuggestStreams,Cr.prototype.segmentDownloaded=Cr.prototype.segmentDownloaded,Cr.prototype.disable=Cr.prototype.disable,Cr.prototype.enable=Cr.prototype.enable,Cr.prototype.chooseVariant=Cr.prototype.chooseVariant,Cr.prototype.init=Cr.prototype.init,Cr.prototype.release=Cr.prototype.release,Cr.prototype.stop=Cr.prototype.stop;var _r=1;function Or(e,t){if(e===t||!e.length||!t.length)return!0;e=d(e);for(var n=e.next();!n.done;n=e.next()){if(n=n.value,Br(n))return!0;for(var i=d(t),r=i.next();!r.done;r=i.next())if(r=r.value,n.keySystem===r.keySystem||Br(r))return!0}return!1}function Nr(e,t){if(!e.length)return t;if(!t.length)return e;var n=[];e=d(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;for(var r=d(t),s=r.next();!s.done;s=r.next()){if(s=s.value,i.keySystem==s.keySystem){r=new Map;for(var a=d((i.initData||[]).concat(s.initData||[])),o=a.next();!o.done;o=a.next())o=o.value,r.set(o.keyId,o);r=Array.from(r.values()),a=i.keyIds&&s.keyIds?new Set([].concat(h(i.keyIds),h(s.keyIds))):i.keyIds||s.keyIds,n.push({keySystem:i.keySystem,licenseServerUri:i.licenseServerUri||s.licenseServerUri,distinctiveIdentifierRequired:i.distinctiveIdentifierRequired||s.distinctiveIdentifierRequired,persistentStateRequired:i.persistentStateRequired||s.persistentStateRequired,videoRobustness:i.videoRobustness||s.videoRobustness,audioRobustness:i.audioRobustness||s.audioRobustness,serverCertificate:i.serverCertificate||s.serverCertificate,serverCertificateUri:i.serverCertificateUri||s.serverCertificateUri,initData:r,keyIds:a});break}Br(i)?n.push(i):Br(s)&&n.push(s)}}return n}function Ur(e){return!!e&&!!e.match(/^com\.(microsoft|chromecast)\.playready/)}function Fr(e){return!!e&&!!e.match(/^com\.apple\.fps/)}function Br(e){return!!(e=e.licenseServerUri)&&e.startsWith("data:application/json;base64,")}K("shaka.config.CrossBoundaryStrategy",{KEEP:"keep",RESET:"reset",RESET_TO_ENCRYPTED:"reset_to_encrypted",RESET_ON_ENCRYPTION_CHANGE:"RESET_ON_ENCRYPTION_CHANGE"});var jr=new le(function(){return Fe(new Uint8Array([0]))}),$r=new Map;function Gr(e,t){var n=Hr();this.l=null==e.maxAttempts?n.maxAttempts:e.maxAttempts,this.j=null==e.baseDelay?n.baseDelay:e.baseDelay,this.o=null==e.fuzzFactor?n.fuzzFactor:e.fuzzFactor,this.m=null==e.backoffFactor?n.backoffFactor:e.backoffFactor,this.g=0,this.h=this.j,(this.i=void 0!==t&&t)&&(this.g=1)}function Vr(e){var t,n;return U(function(i){if(1==i.g){if(e.g>=e.l){if(!e.i)throw new Ve(2,7,1010);e.g=1,e.h=e.j}return t=e.g,e.g++,0==t?i.return():(n=e.h*(1+(2*Math.random()-1)*e.o),w(i,new Promise(function(e){new _i(e).ha(n/1e3)}),2))}e.h*=e.m,A(i)})}function Hr(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}}function Kr(){var e,t,n=new Promise(function(n,i){e=n,t=i});return n.resolve=e,n.reject=t,n}function Wr(e,t){this.promise=e,this.i=t,this.g=null}function qr(e){return new Wr(Promise.reject(e),function(){return Promise.resolve()})}function Yr(){var e=Promise.reject(new Ve(2,7,7001));return e.catch(function(){}),new Wr(e,function(){return Promise.resolve()})}function zr(e){return new Wr(Promise.resolve(e),function(){return Promise.resolve()})}function Xr(e){return new Wr(e,function(){return e.catch(function(){})})}function Qr(e){return new Wr(Promise.all(e.map(function(e){return e.promise})),function(){return Promise.all(e.map(function(e){return e.abort()}))})}function Jr(e,t,n){try{var i=e(t);return i&&i.promise&&i.abort?(n.resolve(i.promise),function(){return i.abort()}):(n.resolve(i),function(){return Promise.resolve(i).then(function(){},function(){})})}catch(r){return n.reject(r),function(){return Promise.resolve()}}}function Zr(t,n){if(n)if(n instanceof Map)for(var i=d(n.keys()),r=i.next();!r.done;r=i.next())r=r.value,Object.defineProperty(this,r,{value:n.get(r),writable:!0,enumerable:!0});else for(i in n)Object.defineProperty(this,i,{value:n[i],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function es(e){var t,n=new Zr(e.type);for(t in e)Object.defineProperty(n,t,{value:e[t],writable:!0,enumerable:!0});return n}Kr.prototype.resolve=function(){},Kr.prototype.reject=function(){},Wr.prototype.abort=function(){return this.g||(this.g=this.i()),this.g},Wr.prototype.finally=function(e){return this.promise.then(function(){return e(!0)},function(){return e(!1)}),this},Wr.prototype.Ua=function(e,t){function n(n){return function(o){if(r.g&&n)s.reject(a);else{var u=n?e:t;u?i=Jr(u,o,s):(n?s.resolve:s.reject)(o)}}}function i(){return s.reject(a),r.abort()}var r=this,s=new Kr;s.catch(function(){});var a=new Ve(2,7,7001);return this.promise.then(n(!0),n(!1)),new Wr(s,function(){return i()})},u.Object.defineProperties(Wr.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return null!==this.g}}}),K("shaka.util.AbortableOperation",Wr),Wr.prototype.chain=Wr.prototype.Ua,Wr.prototype["finally"]=Wr.prototype.finally,Wr.all=Qr,Wr.prototype.abort=Wr.prototype.abort,Wr.notAbortable=Xr,Wr.completed=zr,Wr.aborted=Yr,Wr.failed=qr,Zr.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Zr.prototype.stopImmediatePropagation=function(){this.g=!0},Zr.prototype.stopPropagation=function(){},K("shaka.util.FakeEvent",Zr);var ts={hl:"abrstatuschanged",il:"adaptation",jl:"audiotrackchanged",kl:"audiotrackschanged",ll:"boundarycrossed",ol:"buffering",ql:"canupdatestarttime",rl:"complete",ul:"currentitemchanged",vl:"downloadcompleted",wl:"downloadfailed",xl:"downloadheadersreceived",yl:"drmsessionupdate",Al:"emsg",Gl:"itemsinserted",Hl:"itemsremoved",Xl:"prft",Error:"error",Bl:"expirationupdated",Cl:"firstquartile",Dl:"gapjumped",Il:"keystatuschanged",Ml:"loaded",Nl:"loading",Pl:"manifestparsed",Ql:"manifestupdated",Rl:"mediaqualitychanged",Sl:"mediasourcerecovered",Tl:"metadataadded",Metadata:"metadata",Ul:"midpoint",Vl:"nospatialvideoinfo",Wl:"onstatechange",Yl:"ratechange",am:"segmentappended",bm:"sessiondata",cm:"spatialvideoinfo",dm:"stalldetected",em:"started",fm:"statechanged",gm:"streaming",hm:"textchanged",im:"texttrackvisibility",jm:"thirdquartile",lm:"timelineregionadded",mm:"timelineregionenter",nm:"timelineregionexit",om:"trackschanged",qm:"unloading",sm:"variantchanged"};function ns(){this.Xa=new ie,this.xe=this}function is(){this.g=[]}function rs(e,t){e.g.push(t.finally(function(){Ut(e.g,t)}))}function ss(e,t,n,i,r,s,a){ns.call(this),this.i=null,this.j=!1,this.s=new is,this.g=new Set,this.h=new Set,this.o=e||null,this.m=t||null,this.A=n||null,this.B=i||null,this.C=r||null,this.G=s||null,this.F=a||null,this.l=new Map}function as(e,t,n,i){i=void 0!==i&&i,n=n||ms;var r=vs.get(e);(!r||n>=r.priority)&&vs.set(e,{priority:n,tf:t,yk:i})}function os(e,t){for(var n=d(e.g),i=n.next();!i.done;i=n.next())t.g.add(i.value);for(e=d(e.h),n=e.next();!n.done;n=e.next())t.h.add(n.value)}function us(e,t,n){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:void 0===n?null:n}}function ls(e,t,n,i){function r(e){s=s.Ua(function(){return n.body&&(n.body=Fe(n.body)),e(t,n,i)})}var s=zr(void 0);e.C&&r(e.C),e=d(e.g);for(var a=e.next();!a.done;a=e.next())r(a.value);return s.Ua(void 0,function(e){if(e instanceof Ve&&7001==e.code)throw e;throw new Ve(2,1,1006,e)})}function cs(e,t,n,i,r,s,a,o){e.i.forceHTTP&&(n.uris[s]=n.uris[s].replace("https://","http://")),e.i.forceHTTPS&&(n.uris[s]=n.uris[s].replace("http://","https://")),0<s&&e.G&&e.G(t,i,n.uris[s],n.uris[s-1]);var u=new Te(n.uris[s]),l=u.ac,c=!1;l||(l=location.protocol,l=l.slice(0,-1),Se(u,l),n.uris[s]=u.toString()),l=l.toLowerCase();var d=(l=vs.get(l))?l.tf:null;if(!d)return qr(new Ve(2,1,1e3,u));var h=l.yk;(u=e.l.get(u.Cb))&&(n.headers["common-access-token"]=u);var f,p=null,g=null,m=!1,v=!1;return Xr(Vr(r)).Ua(function(){if(e.j)return Yr();f=Date.now();var r=0;n.requestStartTime=Date.now();var a=d(n.uris[s],n,t,function(s,a,u){p&&p.stop(),g&&g.ha(l/1e3),e.o&&t==gs&&(r++,n.packetNumber=r,e.o(s,a,hs(i),n,i),c=!0,o.g=u)},function(i){v=!0,n.timeToFirstByte=Date.now()-n.requestStartTime,e.m&&e.m(i,n,t)},{minBytesForProgressEvents:e.i.minBytesForProgressEvents});if(!h)return a;var u=n.retryParameters.connectionTimeout;u&&(p=new _i(function(){m=!0,a.abort()}),p.ha(u/1e3));var l=n.retryParameters.stallTimeout;return l&&(g=new _i(function(){m=!0,a.abort()})),a}).Ua(function(i){p&&p.stop(),g&&g.stop(),void 0==i.timeMs&&(i.timeMs=Date.now()-f);var r=i.headers["common-access-token"];if(r){var s=new Te(i.uri);e.l.set(s.Cb,r)}return r={response:i,Yj:c},!v&&e.m&&e.m(i.headers,n,t),e.A&&e.A(n,i),r},function(u){if(p&&p.stop(),g&&g.stop(),e.B){var l=null,c=0;u instanceof Ve&&(l=u,1001==u.code&&(c=u.data[1])),e.B(n,l,c,m)}if(e.j)return Yr();if(m&&(u=new Ve(1,1,1003,n.uris[s],t)),u instanceof Ve){if(7001==u.code)throw u;if(1010==u.code)throw a;if(1==u.severity){if(l=(new Map).set("error",u),l=new Zr("retry",l),l.cancelable=!0,e.dispatchEvent(l),l.defaultPrevented)throw u;return s=(s+1)%n.uris.length,cs(e,t,n,i,r,s,u,o)}}throw u})}function ds(e,t,n,i){var r=zr(void 0);e=d(e.h);for(var s=e.next(),a={};!s.done;a={Bi:void 0},s=e.next())a.Bi=s.value,r=r.Ua(function(e){return function(){var r=n.response;return r.data&&(r.data=Fe(r.data)),(0,e.Bi)(t,r,i)}}(a));return r.Ua(function(){return n},function(e){var t=2;if(e instanceof Ve){if(7001==e.code)throw e;t=e.severity}throw new Ve(t,1,1007,e)})}function hs(e){if(e){var t=e.segment;if(e=e.stream,t&&e&&e.fastSwitching&&t.o)return!1}return!0}function fs(){this.g=0}function ps(e,t,n){Wr.call(this,e,t),this.h=n}ns.prototype.addEventListener=function(e,t){this.Xa&&this.Xa.push(e,t)},ns.prototype.removeEventListener=function(e,t){this.Xa&&this.Xa.remove(e,t)},ns.prototype.dispatchEvent=function(e){if(!this.Xa)return!0;var t=this.Xa.get(e.type)||[],n=this.Xa.get("All");for(n&&(t=t.concat(n)),t=d(t),n=t.next();!n.done;n=t.next()){n=n.value,e.target=this.xe,e.currentTarget=this.xe;try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(i){}if(e.g)break}return e.defaultPrevented},ns.prototype.release=function(){this.Xa=null},is.prototype.destroy=function(){for(var e=[],t=d(this.g),n=t.next();!n.done;n=t.next())n=n.value,n.promise.catch(function(){}),e.push(n.abort());return this.g=[],Promise.all(e)},b(ss,ns),i=ss.prototype,i.configure=function(e){this.i=e},i.Bk=function(e){this.g.add(e)},i.Xk=function(e){this.g.delete(e)},i.ij=function(){this.g.clear()},i.Ck=function(e){this.h.add(e)},i.Yk=function(e){this.h.delete(e)},i.jj=function(){this.h.clear()},i.Jh=function(){this.l.clear()},i.destroy=function(){return this.j=!0,this.g.clear(),this.h.clear(),this.l.clear(),ns.prototype.release.call(this),this.s.destroy()},i.request=function(e,t,n){var i=this,r=new fs;if(this.j){var s=Promise.reject(new Ve(2,7,7001));return s.catch(function(){}),new ps(s,function(){return Promise.resolve()},r)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?qt(t.retryParameters):Hr(),t.uris=qt(t.uris),s=ls(this,e,t,n);var a=s.Ua(function(){return cs(i,e,t,n,new Gr(t.retryParameters,!1),0,null,r)}),o=a.Ua(function(t){return ds(i,e,t,n)}),u=Date.now(),l=0;s.promise.then(function(){l=Date.now()-u},function(){});var c=0;a.promise.then(function(){c=Date.now()},function(){});var d=o.Ua(function(r){var s=Date.now()-c,a=r.response;return a.timeMs+=l,a.timeMs+=s,r.Yj||!i.o||a.fromCache||"HEAD"==t.method||e!=gs||i.o(a.timeMs,a.data.byteLength,hs(n),t,n),i.F&&i.F(e,a,n),a},function(e){throw e&&(e.severity=2),e});return s=new ps(d.promise,function(){return d.abort()},r),rs(this.s,s),s},K("shaka.net.NetworkingEngine",ss),ss.prototype.request=ss.prototype.request,ss.prototype.destroy=ss.prototype.destroy,ss.makeRequest=us,ss.defaultRetryParameters=function(){return Hr()},ss.prototype.clearCommonAccessTokenMap=ss.prototype.Jh,ss.prototype.clearAllResponseFilters=ss.prototype.jj,ss.prototype.unregisterResponseFilter=ss.prototype.Yk,ss.prototype.registerResponseFilter=ss.prototype.Ck,ss.prototype.clearAllRequestFilters=ss.prototype.ij,ss.prototype.unregisterRequestFilter=ss.prototype.Xk,ss.prototype.registerRequestFilter=ss.prototype.Bk,ss.unregisterScheme=function(e){vs.delete(e)},ss.registerScheme=as,ss.prototype.configure=ss.prototype.configure,ss.NumBytesRemainingClass=fs,b(ps,Wr),ss.PendingRequest=ps;var gs=1;ss.RequestType={MANIFEST:0,SEGMENT:gs,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6,ADS:7,CONTENT_STEERING:8},ss.AdvancedRequestType={INIT_SEGMENT:0,MEDIA_SEGMENT:1,MEDIA_PLAYLIST:2,MASTER_PLAYLIST:3,MPD:4,MSS:5,MPD_PATCH:6,MEDIATAILOR_SESSION_INFO:7,MEDIATAILOR_TRACKING_INFO:8,MEDIATAILOR_STATIC_RESOURCE:9,MEDIATAILOR_TRACKING_EVENT:10,INTERSTITIAL_ASSET_LIST:11,INTERSTITIAL_AD_URL:12};var ms=3;ss.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:ms};var vs=new Map;function ys(e){this.g=!1,this.h=new Kr,this.i=e}function bs(e,t){if(e.g){if(t instanceof Ve&&7003==t.code)throw t;throw new Ve(2,7,7003,t)}}function Ts(e,t){var n=[];e=d(e);for(var i=e.next();!i.done;i=e.next())n.push(t(i.value));return n}function Ss(e,t){e=d(e);for(var n=e.next();!n.done;n=e.next())if(!t(n.value))return!1;return!0}function Es(e){for(var t=new Map,n=d(Object.keys(e)),i=n.next();!i.done;i=n.next())i=i.value,t.set(i,e[i]);return t}function ws(e){var t={};return e.forEach(function(e,n){t[n]=e}),t}function As(e,t){this.h=$e(e),this.i=t==Is,this.g=0}function xs(){return new Ve(2,3,3e3)}ys.prototype.destroy=function(){var e=this;return this.g?this.h:(this.g=!0,this.i().then(function(){e.h.resolve()},function(){e.h.resolve()}))},i=As.prototype,i.Fa=function(){return this.g<this.h.byteLength},i.Ma=function(){return this.g},i.getLength=function(){return this.h.byteLength},i.X=function(){try{var e=this.h.getUint8(this.g);return this.g+=1,e}catch(t){throw xs()}},i.Aa=function(){try{var e=this.h.getUint16(this.g,this.i);return this.g+=2,e}catch(t){throw xs()}},i.T=function(){try{var e=this.h.getUint32(this.g,this.i);return this.g+=4,e}catch(t){throw xs()}},i.Tg=function(){try{var e=this.h.getInt32(this.g,this.i);return this.g+=4,e}catch(t){throw xs()}},i.vd=function(){try{if(this.i)var e=this.h.getUint32(this.g,!0),t=this.h.getUint32(this.g+4,!0);else t=this.h.getUint32(this.g,!1),e=this.h.getUint32(this.g+4,!1)}catch(n){throw xs()}if(2097151<t)throw new Ve(2,3,3001);return this.g+=8,t*Math.pow(2,32)+e},i.Sb=function(e){if(this.g+e>this.h.byteLength)throw xs();var t=Be(this.h,this.g,e);return this.g+=e,t},i.skip=function(e){if(this.g+e>this.h.byteLength)throw xs();this.g+=e},i.Ci=function(e){if(this.g<e)throw xs();this.g-=e},i.seek=function(e){if(0>e||e>this.h.byteLength)throw xs();this.g=e},i.Uc=function(){for(var e=this.g;this.Fa()&&0!=this.h.getUint8(this.g);)this.g+=1;return e=Be(this.h,e,this.g-e),this.g+=1,We(e)},K("shaka.util.DataViewReader",As),As.prototype.readTerminatedString=As.prototype.Uc,As.prototype.seek=As.prototype.seek,As.prototype.rewind=As.prototype.Ci,As.prototype.skip=As.prototype.skip,As.prototype.readBytes=As.prototype.Sb,As.prototype.readUint64=As.prototype.vd,As.prototype.readInt32=As.prototype.Tg,As.prototype.readUint32=As.prototype.T,As.prototype.readUint16=As.prototype.Aa,As.prototype.readUint8=As.prototype.X,As.prototype.getLength=As.prototype.getLength,As.prototype.getPosition=As.prototype.Ma,As.prototype.hasMoreData=As.prototype.Fa;var Is=1;function ks(){this.i=new Map,this.h=new Map,this.g=!1}function Ls(e){for(var t=Os(e);e.reader.Fa()&&!e.parser.g;)e.parser.qd(e.start+t,e.reader,e.partialOkay)}function Rs(e){for(var t=Os(e),n=e.reader.T(),i=0;i<n&&(e.parser.qd(e.start+t,e.reader,e.partialOkay),!e.parser.g);i++);}function Cs(e){var t=Os(e);for(e.reader.skip(78);e.reader.Fa()&&!e.parser.g;)e.parser.qd(e.start+t,e.reader,e.partialOkay)}function Ds(e){var t=Os(e);e.reader.skip(8);var n=e.reader.Aa();for(e.reader.skip(6),2==n?e.reader.skip(48):e.reader.skip(12),1==n&&e.reader.skip(16);e.reader.Fa()&&!e.parser.g;)e.parser.qd(e.start+t,e.reader,e.partialOkay)}function Ms(e){return function(t){e(t.reader.Sb(t.reader.getLength()-t.reader.Ma()))}}function Ps(e){var t=0;e=d(e);for(var n=e.next();!n.done;n=e.next())t=t<<8|n.value.charCodeAt(0);return t}function _s(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function Os(e){return 8+(e.has64BitSize?8:0)+(null!=e.flags?4:0)}As.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:Is},i=ks.prototype,i.box=function(e,t){return e=Ps(e),this.i.set(e,Ns),this.h.set(e,t),this},i.R=function(e,t){return e=Ps(e),this.i.set(e,Us),this.h.set(e,t),this},i.stop=function(){this.g=!0},i.parse=function(e,t,n){for(e=new As(e,0),this.g=!1;e.Fa()&&!this.g;)this.qd(0,e,t,n)},i.qd=function(e,t,n,i){var r=t.Ma();if(i&&r+8>t.getLength())this.g=!0;else{var s=t.T(),a=t.T(),o=_s(a),u=!1;switch(s){case 0:s=t.getLength()-r;break;case 1:if(i&&t.Ma()+8>t.getLength())return void(this.g=!0);s=t.vd(),u=!0}var l=this.h.get(a);if(l){var c=null,d=null;if(this.i.get(a)==Us){if(i&&t.Ma()+4>t.getLength())return void(this.g=!0);d=t.T(),c=d>>>24,d&=16777215}a=r+s,n&&a>t.getLength()&&(a=t.getLength()),i&&a>t.getLength()?this.g=!0:(i=a-t.Ma(),t=0<i?t.Sb(i):new Uint8Array(0),t=new As(t,0),l({name:o,parser:this,partialOkay:n||!1,version:c,flags:d,reader:t,size:s,start:r+e,has64BitSize:u}))}else t.skip(Math.min(r+s-t.Ma(),t.getLength()-t.Ma()))}},K("shaka.util.Mp4Parser",ks),ks.headerSize=Os,ks.typeToString=_s,ks.allData=Ms,ks.audioSampleEntry=Ds,ks.visualSampleEntry=Cs,ks.sampleDescription=Rs,ks.children=Ls,ks.prototype.parseNext=ks.prototype.qd,ks.prototype.parse=ks.prototype.parse,ks.prototype.stop=ks.prototype.stop,ks.prototype.fullBox=ks.prototype.R,ks.prototype.box=ks.prototype.box;var Ns=0,Us=1;function Fs(e){var t=this;this.g=[],this.h=[],this.data=[],(new ks).box("moov",Ls).box("moof",Ls).R("pssh",function(e){if(!(1<e.version)){var n=Be(e.reader.h,-12,e.size);if(t.data.push(n),t.g.push(st(e.reader.Sb(16))),0<e.version){n=e.reader.T();for(var i=0;i<n;i++){var r=st(e.reader.Sb(16));t.h.push(r)}}}}).parse(e)}function Bs(e,t,n,i){var r=e.length,s=t.length+16+r;0<i&&(s+=4+16*n.size);var a=new Uint8Array(s),o=$e(a),u=0;if(o.setUint32(u,s),u+=4,o.setUint32(u,1886614376),u+=4,1>i?o.setUint32(u,0):o.setUint32(u,16777216),u+=4,a.set(t,u),u+=t.length,0<i)for(o.setUint32(u,n.size),u+=4,t=d(n),n=t.next();!n.done;n=t.next())n=rt(n.value),a.set(n,u),u+=n.length;return o.setUint32(u,r),a.set(e,u+4),a}function js(e){var t=this;this.C=e,this.j=this.A=null,this.oa=this.ia=!1,this.H=0,this.g=null,this.o=new re,this.i=new Map,this.S=[],this.B=new Map,this.K=!1,this.m=new Kr,this.h=null,this.s=function(n){2==n.severity&&t.m.reject(n),e.onError(n)},this.W=new Map,this.ka=new Map,this.L=new _i(function(){return ca(t)}),this.N=!1,this.M=[],this.U=!1,this.I=new _i(function(){ga(t)}),this.m.catch(function(){}),this.l=new ys(function(){return $s(t)}),this.$=!1,this.F=this.G=null,this.P=function(){return!1}}function $s(e){return U(function(t){switch(t.g){case 1:return e.o.release(),e.o=null,e.m.reject(),e.I.stop(),e.I=null,e.L.stop(),e.L=null,w(t,fa(e),2);case 2:if(!e.j){t.u(3);break}return x(t,4),w(t,e.j.setMediaKeys(null),6);case 6:k(t,5);break;case 4:L(t);case 5:e.j=null;case 3:e.g=null,e.A=null,e.B=new Map,e.h=null,e.s=function(){},e.C=null,e.$=!1,e.G=null,A(t)}})}function Gs(e,t,n){return e.oa=!0,e.B=new Map,e.N=n,Ks(e,t,!1)}function Vs(e,t,n,i){i=void 0===i||i,e.B=new Map,n=d(n);for(var r=n.next();!r.done;r=n.next())e.B.set(r.value,{initData:null,initDataType:null});for(n=d(e.h.persistentSessionsMetadata),r=n.next();!r.done;r=n.next())r=r.value,e.B.set(r.sessionId,{initData:r.initData,initDataType:r.initDataType});return e.N=0<e.B.size,Ks(e,t,i)}function Hs(e,t,n,i,r,s){var a=new Map;return r={audioCapabilities:r,videoCapabilities:s,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t},r.drmInfos=[{keySystem:t,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:i,serverCertificateUri:"",initData:null,keyIds:null}],a.set(t,r),ea(e,a,[])}function Ks(e,t,n){var i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S;return U(function(E){if(1==E.g){for(Sa(e.h.clearKeys,t),i=t.some(function(e){return!!(e.video&&e.video.drmInfos.length||e.audio&&e.audio.drmInfos.length)}),r=Es(e.h.servers),s=Es(e.h.advanced||{}),!i&&n&&ya(t,r),a=new WeakSet,o=d(t),u=o.next();!u.done;u=o.next())for(l=u.value,c=pa(l),h=d(c),f=h.next();!f.done;f=h.next())p=f.value,a.has(p)||(a.add(p),Ta(p,r,s,e.h.keySystemsMapping));for(g=function(t,n){var i=[];t=d(t);for(var r=t.next();!r.done;r=t.next()){r=r.value;var a,o=r[n]||s.has(r.keySystem)&&s.get(r.keySystem)[n]||"";if((a=""==o)&&(a=!!(a=r.keySystem)&&!!a.match(/^com\.widevine\.alpha/)),a&&("audioRobustness"==n?o=[e.h.defaultAudioRobustnessForWidevine]:"videoRobustness"==n&&(o=[e.h.defaultVideoRobustnessForWidevine])),"string"===typeof o)i.push(r);else if(Array.isArray(o))for(0===o.length&&(o=[""]),o=d(o),a=o.next();!a.done;a=o.next()){var u={};i.push(Object.assign({},r,(u[n]=a.value,u)))}}return i},m=new WeakSet,v=d(t),y=v.next();!y.done;y=v.next())b=y.value,b.video&&!m.has(b.video)&&(b.video.drmInfos=g(b.video.drmInfos,"videoRobustness"),b.video.drmInfos=g(b.video.drmInfos,"audioRobustness"),m.add(b.video)),b.audio&&!m.has(b.audio)&&(b.audio.drmInfos=g(b.audio.drmInfos,"videoRobustness"),b.audio.drmInfos=g(b.audio.drmInfos,"audioRobustness"),m.add(b.audio));return w(E,ar(t,e.N,e.$,e.h.preferredKeySystems),2)}return bs(e.l),T=i||0<r.size,T?(S=ea(e,void 0,t),E.return(i?S:S.catch(function(){}))):(e.ia=!0,E.return(Promise.resolve()))})}function Ws(e){var t;return U(function(n){switch(n.g){case 1:if(e.j.mediaKeys)return n.return();if(!e.G){n.u(2);break}return w(n,e.G,3);case 3:return bs(e.l),n.return();case 2:return x(n,4),e.G=e.j.setMediaKeys(e.A),w(n,e.G,6);case 6:k(n,5);break;case 4:t=L(n),e.s(new Ve(2,6,6003,t.message));case 5:bs(e.l),A(n)}})}function qs(e,t){return U(function(n){if(1==n.g)return w(n,Ws(e),2);Qs(e,t.initDataType,Be(t.initData)),A(n)})}function Ys(e){var t,n,i,r,s;return U(function(a){switch(a.g){case 1:if(!e.A||!e.g)return a.return();if(!e.g.serverCertificateUri||e.g.serverCertificate&&e.g.serverCertificate.length){a.u(2);break}return t=us([e.g.serverCertificateUri],e.h.retryParameters),x(a,3),n=e.C.pc.request(5,t,{isPreload:e.P()}),w(a,n.promise,5);case 5:i=a.h,e.g.serverCertificate=Be(i.data),k(a,4);break;case 3:throw r=L(a),new Ve(2,6,6017,r);case 4:if(e.l.g)return a.return();case 2:return e.g.serverCertificate&&e.g.serverCertificate.length?(x(a,6),w(a,e.A.setServerCertificate(e.g.serverCertificate),8)):a.return();case 8:k(a,0);break;case 6:throw s=L(a),new Ve(2,6,6004,s.message)}})}function zs(e,t){var n,i,r;return U(function(s){return 1==s.g?w(s,sa(e,t,{initData:null,initDataType:null}),2):3!=s.g?(n=s.h,n?(i=[],(r=e.i.get(n))&&(r.Ib=new Kr,i.push(r.Ib)),i.push(n.remove()),w(s,Promise.all(i),3)):s.return()):(e.i.delete(n),void A(s))})}function Xs(e){var t,n,i,r,s;return U(function(a){if(1==a.g)return e.B.size?(e.B.forEach(function(t,n){sa(e,n,t)}),w(a,e.m,3)):a.u(2);if(2!=a.g){if(t=e.g&&e.g.keyIds||new Set([]),0<t.size&&va(e))return a.return(e.m);e.K=!1,e.m=new Kr,e.m.catch(function(){})}for(n=(e.g?e.g.initData:[])||[],i=d(n),r=i.next();!r.done;r=i.next())s=r.value,Qs(e,s.initDataType,s.initData);return ma(e)&&e.m.resolve(),a.return(e.m)})}function Qs(e,t,n){if(n.length){if(e.h.ignoreDuplicateInitData){var i=e.i.values();i=d(i);for(var r=i.next();!r.done;r=i.next())if(Ue(n,r.value.initData))return;var s=!1;if(e.B.forEach(function(e){!s&&Ue(n,e.initData)&&(s=!0)}),s)return}e.K=!0,0<e.i.size&&ma(e)&&(e.m.resolve(),e.K=!1,e.m=new Kr,e.m.catch(function(){})),aa(e,t,n,e.g.sessionType)}}function Js(e){return e=e.i.keys(),e=Ts(e,function(e){return e.sessionId}),Array.from(e)}function Zs(e){return e.H?e.H:NaN}function ea(e,t,n){var i,r,s,a,o,u,l,c;return U(function(h){switch(h.g){case 1:if(i=new Map,n.length){r=ta(e,n,i),h.u(2);break}return w(h,na(e,t),3);case 3:r=h.h;case 2:if(s=r,!s){if(!navigator.requestMediaKeySystemAccess)throw new Ve(2,6,6020);throw new Ve(2,6,6001)}if(bs(e.l),x(h,4),s.getConfiguration(),a=e.h.keySystemsMapping[s.keySystem]||s.keySystem,n.length){var f=a,p=i.get(a),g=[],m=[],v=[],y=[],b=[],T=new Set,S=new Set;ba(p,g,m,y,v,b,T,S);var E=e.N?"persistent-license":"temporary";for(f={keySystem:f,encryptionScheme:g[0],licenseServerUri:m[0],distinctiveIdentifierRequired:p[0].distinctiveIdentifierRequired,persistentStateRequired:p[0].persistentStateRequired,sessionType:p[0].sessionType||E,audioRobustness:p[0].audioRobustness||"",videoRobustness:p[0].videoRobustness||"",serverCertificate:y[0],serverCertificateUri:v[0],initData:b,keyIds:T},0<S.size&&(f.keySystemUris=S),p=d(p),S=p.next();!S.done;S=p.next())S=S.value,S.distinctiveIdentifierRequired&&(f.distinctiveIdentifierRequired=S.distinctiveIdentifierRequired),S.persistentStateRequired&&(f.persistentStateRequired=S.persistentStateRequired);p=f}else p=a,S=t.get(a),f=[],g=[],m=[],v=[],y=[],b=new Set,ba(S.drmInfos,f,g,v,m,y,b),p={keySystem:p,encryptionScheme:f[0],licenseServerUri:g[0],distinctiveIdentifierRequired:"required"==S.distinctiveIdentifier,persistentStateRequired:"required"==S.persistentState,sessionType:S.sessionTypes[0]||"temporary",audioRobustness:(S.audioCapabilities?S.audioCapabilities[0].robustness:"")||"",videoRobustness:(S.videoCapabilities?S.videoCapabilities[0].robustness:"")||"",serverCertificate:v[0],serverCertificateUri:m[0],initData:y,keyIds:b};if(e.g=p,!e.g.licenseServerUri)throw new Ve(2,6,6012,e.g.keySystem);return w(h,s.createMediaKeys(),6);case 6:if(o=h.h,bs(e.l),e.A=o,""==e.h.minHdcpVersion||!("getStatusForPolicy"in e.A)){h.u(7);break}return x(h,8),w(h,e.A.getStatusForPolicy({minHdcpVersion:e.h.minHdcpVersion}),10);case 10:if(u=h.h,"usable"!=u)throw new Ve(2,6,6018);bs(e.l),k(h,7,4);break;case 8:if(l=L(h,4),l instanceof Ve)throw l;throw new Ve(2,6,6019,l.message);case 7:return e.ia=!0,w(h,Ys(e),11);case 11:bs(e.l),k(h,0);break;case 4:if(c=L(h),bs(e.l,c),e.g=null,c instanceof Ve)throw c;throw new Ve(2,6,6002,c.message)}})}function ta(e,t,n){for(var i=d(t),r=i.next();!r.done;r=i.next()){r=d(pa(r.value));for(var s=r.next();!s.done;s=r.next())s=s.value,n.has(s.keySystem)||n.set(s.keySystem,[]),n.get(s.keySystem).push(s)}if(1==n.size&&n.has(""))throw new Ve(2,6,6e3);i=e.h.preferredKeySystems,i.length||(r=Es(e.h.servers),1==r.size&&(i=Array.from(r.keys()))),r=d(i);var a=r.next();for(s={};!a.done;s={ti:void 0},a=r.next()){s.ti=a.value,a=d(t);for(var o=a.next();!o.done;o=a.next())if(o=o.value.decodingInfos.find(function(e){return function(t){return t.supported&&null!=t.keySystemAccess&&t.keySystemAccess.keySystem==e.ti}}(s)))return o.keySystemAccess}for(r=d([!0,!1]),s=r.next();!s.done;s=r.next())for(s=s.value,a=d(t),o=a.next();!o.done;o=a.next()){o=d(o.value.decodingInfos);for(var u=o.next();!u.done;u=o.next())if(u=u.value,u.supported&&u.keySystemAccess){var l=u.keySystemAccess.keySystem;if(!i.includes(l)){var c=n.get(l);for(!c&&e.h.keySystemsMapping[l]&&(c=n.get(e.h.keySystemsMapping[l])),l=d(c),c=l.next();!c.done;c=l.next())if(!!c.value.licenseServerUri==s)return u.keySystemAccess}}}return null}function na(e,t){var n,i,r,s,a,o,u,l,c,h,f,p,g,m,v,y;return U(function(b){switch(b.g){case 1:if(1==t.size&&t.has(""))throw new Ve(2,6,6e3);for(i=d(t.values()),r=i.next();!r.done;r=i.next())s=r.value,0==s.audioCapabilities.length&&delete s.audioCapabilities,0==s.videoCapabilities.length&&delete s.videoCapabilities;a=d(e.h.preferredKeySystems),o=a.next();case 2:if(o.done){b.u(4);break}if(u=o.value,!t.has(u)){b.u(3);break}return l=t.get(u),x(b,6),w(b,navigator.requestMediaKeySystemAccess(u,[l]),8);case 8:return n=b.h,b.return(n);case 6:L(b);case 7:bs(e.l);case 3:o=a.next(),b.u(2);break;case 4:c=d([!0,!1]),h=c.next();case 9:if(h.done){b.u(11);break}f=h.value,p=d(t.keys()),g=p.next();case 12:if(g.done){h=c.next(),b.u(9);break}if(m=g.value,v=t.get(m),y=v.drmInfos.some(function(e){return!!e.licenseServerUri}),y!=f){b.u(13);break}return x(b,15),w(b,navigator.requestMediaKeySystemAccess(m,[v]),17);case 17:return n=b.h,b.return(n);case 15:L(b);case 16:bs(e.l);case 13:g=p.next(),b.u(12);break;case 11:return b.return(n)}})}function ia(e){ma(e)&&e.m.resolve()}function ra(e,t){new _i(function(){t.loaded=!0,ia(e)}).ha(wa)}function sa(e,t,n){var i,r,s,a,o,u,l;return U(function(c){switch(c.g){case 1:try{i=e.A.createSession("persistent-license")}catch(d){return r=new Ve(2,6,6005,d.message),e.s(r),c.return(Promise.reject(r))}return e.o.D(i,"message",function(t){e.j&&e.h.delayLicenseRequestUntilPlayed&&e.j.paused&&!e.U?e.M.push(t):ua(e,t)}),e.o.D(i,"keystatuseschange",function(t){return la(e,t)}),s={initData:n.initData,initDataType:n.initDataType,loaded:!1,Og:1/0,Ib:null,type:"persistent-license"},e.i.set(i,s),x(c,2),w(c,i.load(t),4);case 4:return a=c.h,bs(e.l),a||(e.i.delete(i),o=e.h.persistentSessionOnlinePlayback?1:2,e.s(new Ve(o,6,6013)),s.loaded=!0),ra(e,s),ia(e),c.return(i);case 2:u=L(c),bs(e.l,u),e.i.delete(i),l=e.h.persistentSessionOnlinePlayback?1:2,e.s(new Ve(l,6,6005,u.message)),s.loaded=!0,ia(e);case 3:return c.return(Promise.resolve())}})}function aa(e,t,n,i){try{var r=e.A.createSession(i)}catch(s){return void e.s(new Ve(2,6,6005,s.message))}e.o.D(r,"message",function(t){e.j&&e.h.delayLicenseRequestUntilPlayed&&e.j.paused&&!e.U?e.M.push(t):ua(e,t)}),e.o.D(r,"keystatuseschange",function(t){return la(e,t)}),e.i.set(r,{initData:n,initDataType:t,loaded:!1,Og:1/0,Ib:null,type:i});try{n=e.h.initDataTransform(n,t,e.g)}catch(s){return t=s,s instanceof Ve||(t=new Ve(2,6,6016,s)),void e.s(t)}e.h.logLicenseExchange&&nt(n),r.generateRequest(t,n).catch(function(t){if(!e.l.g){e.i.delete(r);var n=t.errorCode;if(n&&n.systemCode){var i=n.systemCode;0>i&&(i+=Math.pow(2,32)),i="0x"+i.toString(16)}e.s(new Ve(2,6,6006,t.message,t,i))}})}function oa(e){return U(function(t){return 1==t.g?e.K?w(t,e.m,3):t.u(0):w(t,Promise.all(e.S.map(function(e){return e.promise})),0)})}function ua(e,t){var n,i,r,s,a,o,u,l,c,h,f,p,g,m;U(function(v){switch(v.g){case 1:if(n=t.target,e.h.logLicenseExchange&&nt(t.message),i=e.i.get(n),r=e.g.licenseServerUri,s=e.h.advanced[e.g.keySystem],"individualization-request"==t.messageType&&s&&s.individualizationServer&&(r=s.individualizationServer),a=us([r],e.h.retryParameters),a.body=t.message,a.method="POST",a.licenseRequestType=t.messageType,a.sessionId=n.sessionId,a.drmInfo=e.g,i&&(a.initData=i.initData,a.initDataType=i.initDataType),s&&s.headers)for(o in s.headers)a.headers[o]=s.headers[o];if("org.w3.clearkey"===e.g.keySystem){var y=a,b=e.g;try{var T=Ye(y.body);if(T){var S=JSON.parse(T);S.type||(S.type=b.sessionType,y.body=ze(JSON.stringify(S)))}}catch(E){}}if(Ur(e.g.keySystem))if(y=qe(a.body,!0,!0),y.includes("PlayReadyKeyMessage")){for(y=Qt(y,"PlayReadyKeyMessage"),b=an(y,"HttpHeader"),b=d(b),T=b.next();!T.done;T=b.next())S=T.value,T=an(S,"name")[0],S=an(S,"value")[0],a.headers[rn(T)]=rn(S);y=an(y,"Challenge")[0],a.body=it(rn(y))}else a.headers["Content-Type"]="text/xml; charset=utf-8";return u=Date.now(),x(v,2),c=e.C.pc.request(2,a,{isPreload:e.P()}),e.S.push(c),w(v,c.promise,4);case 4:l=v.h,Ut(e.S,c),k(v,3);break;case 2:return h=L(v),e.l.g?v.return():(f=new Ve(2,6,6007,h),1==e.i.size?(e.s(f),i&&i.Ib&&i.Ib.reject(f)):(i&&i.Ib&&i.Ib.reject(f),e.i.delete(n),ma(e)&&(e.m.resolve(),e.L.ha(.1))),v.return());case 3:return e.l.g?v.return():(e.H+=(Date.now()-u)/1e3,e.h.logLicenseExchange&&nt(l.data),x(v,5),w(v,n.update(l.data),7));case 7:k(v,6);break;case 5:return p=L(v),g=new Ve(2,6,6008,p.message),e.s(g),i&&i.Ib&&i.Ib.reject(g),v.return();case 6:if(e.l.g)return v.return();m=new Zr("drmsessionupdate"),e.C.onEvent(m),i&&(i.Ib&&i.Ib.resolve(),ra(e,i)),A(v)}})}function la(e,t){t=t.target;var n=e.i.get(t),i=!1;t.keyStatuses.forEach(function(t,r){if("string"==typeof r){var s=r;r=t,t=s}if(s=ce(),Ur(e.g.keySystem)&&16==r.byteLength&&s.$g()){s=$e(r);var a=s.getUint32(0,!0),o=s.getUint16(4,!0),u=s.getUint16(6,!0);s.setUint32(0,a,!1),s.setUint16(4,o,!1),s.setUint16(6,u,!1)}"status-pending"!=t&&(n.loaded=!0),"expired"==t&&(i=!0),r=st(r).slice(0,32),e.W.set(r,t)});var r=t.expiration-Date.now();(0>r||i&&1e3>r)&&n&&!n.Ib&&(e.i.delete(t),ha(t)),ma(e)&&(e.m.resolve(),e.L.ha(Aa))}function ca(e){var t=e.W,n=e.ka;n.clear(),t.forEach(function(e,t){return n.set(t,e)}),t=Array.from(n.values()),t.length&&t.every(function(e){return"expired"==e})&&e.s(new Ve(2,6,6014)),e.C.nf(ws(n))}function da(){var t,n,i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,I,R,C,D,M,P,_,O,N,F,B,j,$,G;return U(function(V){if(1==V.g){if(t="org.w3.clearkey com.widevine.alpha com.widevine.alpha.experiment com.microsoft.playready com.microsoft.playready.hardware com.microsoft.playready.recommendation com.microsoft.playready.recommendation.3000 com.microsoft.playready.recommendation.3000.clearlead com.chromecast.playready com.apple.fps.1_0 com.apple.fps com.huawei.wiseplay".split(" "),!(e.MediaKeys&&e.navigator&&e.navigator.requestMediaKeySystemAccess&&e.MediaKeySystemAccess&&e.MediaKeySystemAccess.prototype.getConfiguration)){for(n={},i=d(t),r=i.next();!r.done;r=i.next())s=r.value,n[s]=null;return V.return(n)}for(a="1.0 1.1 1.2 1.3 1.4 2.0 2.1 2.2 2.3".split(" "),o=["SW_SECURE_CRYPTO","SW_SECURE_DECODE","HW_SECURE_CRYPTO","HW_SECURE_DECODE","HW_SECURE_ALL"],u=["150","2000","3000"],l={"com.widevine.alpha":o,"com.widevine.alpha.experiment":o,"com.microsoft.playready.recommendation":u},c=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],h=[{contentType:'audio/mp4; codecs="mp4a.40.2"'},{contentType:'audio/webm; codecs="opus"'}],f={videoCapabilities:c,audioCapabilities:h,initDataTypes:["cenc","sinf","skd","keyids"]},p=[null,"cenc","cbcs","cbcs-1-9"],g=new Map,m=ce(),v=function(e,t){var n,i,r,s,o,u,l,c,h,f,p,v,y;return U(function(b){switch(b.g){case 1:return x(b,2),w(b,t.createMediaKeys(),5);case 5:n=b.h;case 4:k(b,3);break;case 2:return L(b),b.return();case 3:if(r=!!(i=t.getConfiguration().sessionTypes)&&i.includes("persistent-license"),m.ki()&&(r=!1),s=t.getConfiguration().videoCapabilities,o=t.getConfiguration().audioCapabilities,u={persistentState:r,encryptionSchemes:[],videoRobustnessLevels:[],audioRobustnessLevels:[],minHdcpVersions:[]},g.has(e)&&g.get(e)?u=g.get(e):g.set(e,u),(l=s[0].encryptionScheme)&&!u.encryptionSchemes.includes(l)&&u.encryptionSchemes.push(l),(c=s[0].robustness)&&!u.videoRobustnessLevels.includes(c)&&u.videoRobustnessLevels.push(c),(h=o[0].robustness)&&!u.audioRobustnessLevels.includes(h)&&u.audioRobustnessLevels.push(h),"getStatusForPolicy"in n){for(f=[],p=d(a),v=p.next(),y={};!v.done;y={Rd:void 0},v=p.next())y.Rd=v.value,u.minHdcpVersions.includes(y.Rd)||f.push(n.getStatusForPolicy({minHdcpVersion:y.Rd}).then(function(e){return function(t){"usable"!=t||u.minHdcpVersions.includes(e.Rd)||u.minHdcpVersions.push(e.Rd)}}(y)));return w(b,Promise.all(f),0)}b.u(0)}})},y=function(e,t,n,i){var r,s,a,o,u,l,c,h,p,g,m;return U(function(y){switch(y.g){case 1:for(x(y,2),r=qt(f),s=d(r.videoCapabilities),a=s.next();!a.done;a=s.next())o=a.value,o.encryptionScheme=t,o.robustness=n;for(u=d(r.audioCapabilities),l=u.next();!l.done;l=u.next())c=l.value,c.encryptionScheme=t,c.robustness=i;return h=qt(r),h.persistentState="required",h.sessionTypes=["persistent-license"],p=[h,r],m=ce(),"MOBILE"==m.La()?w(y,Fi(5,navigator.requestMediaKeySystemAccess(e,p)),7):w(y,navigator.requestMediaKeySystemAccess(e,p),6);case 6:g=y.h,y.u(5);break;case 7:g=y.h;case 5:return w(y,v(e,g),8);case 8:k(y,0);break;case 2:L(y),A(y)}})},b=function(e,t,n,i){var r,s,a,o;return U(function(u){switch(u.g){case 1:return x(u,2),r={type:"media-source",video:{contentType:c[0].contentType,width:640,height:480,bitrate:1,framerate:1},audio:{contentType:h[0].contentType,channels:2,bitrate:1,samplerate:1},keySystemConfiguration:{keySystem:e,video:{encryptionScheme:t,robustness:n},audio:{encryptionScheme:t,robustness:i}}},a=ce(),"MOBILE"==a.La()?w(u,Fi(5,navigator.mediaCapabilities.decodingInfo(r)),7):w(u,navigator.mediaCapabilities.decodingInfo(r),6);case 6:s=u.h,u.u(5);break;case 7:s=u.h;case 5:return o=s.keySystemAccess,w(u,v(e,o),8);case 8:k(u,0);break;case 2:L(u),A(u)}})},T=d(t),S=T.next();!S.done;S=T.next())E=S.value,g.set(E,null);for(I=function(e){return"WEBKIT"!==ce().Da()||"org.w3.clearkey"!==e},R=[],C=d(p),D=C.next();!D.done;D=C.next())for(M=D.value,P=d(t),_=P.next();!_.done;_=P.next())O=_.value,I(O)&&(R.push(y(O,M,"","")),R.push(b(O,M,"","")));for(N=d(t),F=N.next();!F.done;F=N.next())for(B=F.value,j=d(l[B]||[]),$=j.next();!$.done;$=j.next())G=$.value,I(B)&&(R.push(y(B,null,G,"")),R.push(y(B,null,"",G)),R.push(b(B,null,G,"")),R.push(b(B,null,"",G)));return w(V,Promise.all(R),2)}return V.return(ws(g))})}function ha(e){return U(function(t){return 1==t.g?(x(t,2),w(t,Fi(Ea,Promise.all([e.close().catch(function(){}),e.closed])),4)):2!=t.g?k(t,0):(L(t),void A(t))})}function fa(e){var t;return U(function(n){return t=Array.from(e.i.entries()),e.i.clear(),w(n,Promise.all(t.map(function(t){t=d(t);var n=t.next().value,i=t.next().value;return U(function(t){return 1==t.g?(x(t,2),e.oa||e.B.has(n.sessionId)||"persistent-license"!==i.type||e.h.persistentSessionOnlinePlayback?w(t,ha(n),5):w(t,n.remove(),5)):2!=t.g?k(t,0):(L(t),void A(t))})})),0)})}function pa(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])}function ga(e){e.i.forEach(function(t,n){var i=t.Og,r=n.expiration;isNaN(r)&&(r=1/0),r!=i&&(e.C.onExpirationUpdated(n.sessionId,r),t.Og=r)})}function ma(e){return e=e.i.values(),Ss(e,function(e){return e.loaded})}function va(e){for(var t=d(e.g&&e.g.keyIds||new Set([])),n=t.next();!n.done;n=t.next())if("usable"!==e.W.get(n.value))return!1;return!0}function ya(e,t){var n=[];for(t.forEach(function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})}),e=d(e),t=e.next();!t.done;t=e.next())t=t.value,t.video&&(t.video.drmInfos=n),t.audio&&(t.audio.drmInfos=n)}function ba(t,n,i,r,s,a,o,u){var l=[];t=d(t);for(var c=t.next(),f={};!c.done;f={Ha:void 0},c=t.next()){if(f.Ha=c.value,n.includes(f.Ha.encryptionScheme)||n.push(f.Ha.encryptionScheme),"org.w3.clearkey"==f.Ha.keySystem&&f.Ha.licenseServerUri.startsWith("data:application/json;base64,")?l.includes(f.Ha.licenseServerUri)||l.push(f.Ha.licenseServerUri):i.includes(f.Ha.licenseServerUri)||i.push(f.Ha.licenseServerUri),s.includes(f.Ha.serverCertificateUri)||s.push(f.Ha.serverCertificateUri),f.Ha.serverCertificate&&(r.some(function(e){return function(t){return Ue(t,e.Ha.serverCertificate)}}(f))||r.push(f.Ha.serverCertificate)),f.Ha.initData){c=d(f.Ha.initData);for(var p=c.next(),g={};!p.done;g={Fg:void 0},p=c.next())g.Fg=p.value,a.some(function(e){return function(t){var n=e.Fg;return!(!t.keyId||t.keyId!=n.keyId)||t.initDataType==n.initDataType&&Ue(t.initData,n.initData)}}(g))||a.push(g.Fg)}if(f.Ha.keyIds)for(c=d(f.Ha.keyIds),p=c.next();!p.done;p=c.next())o.add(p.value);if(f.Ha.keySystemUris&&u)for(f=d(f.Ha.keySystemUris),c=f.next();!c.done;c=f.next())u.add(c.value)}if(1==l.length)i.push(l[0]);else if(0<l.length){for(n=[],l=d(l),r=l.next();!r.done;r=l.next())r=e.atob(r.value.split("data:application/json;base64,").pop()),r=JSON.parse(r),n.push.apply(n,h(r.keys));l=JSON.stringify({keys:n}),i.push("data:application/json;base64,"+e.btoa(l))}}function Ta(t,n,i,r){var s=t.keySystem;!s||"org.w3.clearkey"==s&&t.licenseServerUri||(n.size&&n.get(s)&&(n=n.get(s),t.licenseServerUri=n),t.keyIds||(t.keyIds=new Set),(i=i.get(s))&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=i.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=i.persistentStateRequired),t.serverCertificate||(t.serverCertificate=i.serverCertificate),i.sessionType&&(t.sessionType=i.sessionType),t.serverCertificateUri||(t.serverCertificateUri=i.serverCertificateUri)),r[s]&&(t.keySystem=r[s]),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==s&&(t.keySystem="com.chromecast.playready"))}function Sa(e,t){if(e=Es(e),0!=e.size){e=lt(e),t=d(t);for(var n=t.next();!n.done;n=t.next())n=n.value,n.video&&(n.video.drmInfos=[e]),n.audio&&(n.audio.drmInfos=[e])}}i=js.prototype,i.destroy=function(){return this.l.destroy()},i.configure=function(e,t){this.h=e,t&&(this.P=t),this.I&&this.I.Ga(this.h.updateExpirationTime)},i.dc=function(e){var t,n,i,r=this;return U(function(s){if(1==s.g)return r.j===e?s.return():r.A?(r.j=e,r.o.za(r.j,"play",function(){for(var e=d(r.M),t=e.next();!t.done;t=e.next())ua(r,t.value);r.U=!0,r.M=[]}),r.j.remote?(r.o.D(r.j.remote,"connect",function(){return fa(r)}),r.o.D(r.j.remote,"connecting",function(){return fa(r)}),r.o.D(r.j.remote,"disconnect",function(){return fa(r)})):"webkitCurrentPlaybackTargetIsWireless"in r.j&&r.o.D(r.j,"webkitcurrentplaybacktargetiswirelesschanged",function(){return fa(r)}),r.F=r.g&&r.g.initData.find(function(e){return 0<e.initData.length})||null,t=r.g.keySystem,n="com.apple.fps"==t,i=ce().Da(),"GECKO"===i&&t.startsWith("com.microsoft.playready.recommendation")&&(n=!0),n||!(r.F||r.B.size||r.h.parseInbandPsshEnabled)?(r.o.D(r.j,"encrypted",function(e){return qs(r,e)}),s.u(2)):w(s,Ws(r),2)):(r.o.za(e,"encrypted",function(){r.s(new Ve(2,6,6010))}),s.return());Xs(r).catch(function(){}),A(s)})},i.zg=function(){var e=this,t=this.i.keys();return t=Ts(t,function(t){var n=e.i.get(t);return{sessionId:t.sessionId,sessionType:n.type,initData:n.initData,initDataType:n.initDataType}}),Array.from(t)},i.Nd=function(){var e=1/0,t=this.i.keys();t=d(t);for(var n=t.next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},i.Re=function(){return ws(this.ka)};var Ea=1,wa=5,Aa=.5;function xa(e,t,n){for(n=void 0===n||n,this.h=e,this.g=new Set([e]),t=t||[],e=d(t),t=e.next();!t.done;t=e.next())this.add(t.value,n)}function Ia(e,t){if(e.mimeType!=t.mimeType)return!1;if(e=e.codecs.split(",").map(function(e){return vi(e)}),t=t.codecs.split(",").map(function(e){return vi(e)}),e.length!=t.length)return!1;e.sort(),t.sort();for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function ka(e,t){if(e=new Set(e),t=new Set(t),e.delete("main"),t.delete("main"),e.size!=t.size)return!1;e=d(e);for(var n=e.next();!n.done;n=e.next())if(!t.has(n.value))return!1;return!0}function La(){}function Ra(){this.g=Da,this.i=(new Map).set(Da,2).set(Ca,1),this.h=0}xa.prototype.add=function(e,t){var n,i=this.h;if(t=void 0===t||t,!(n=!!i.audio!=!!e.audio||!!i.video!=!!e.video||i.language!=e.language)&&(n=i.audio&&e.audio)){n=i.audio;var r=e.audio;n=!(!((!n.channelsCount||!r.channelsCount||2<n.channelsCount||2<r.channelsCount)&&n.channelsCount!=r.channelsCount||n.spatialAudio!==r.spatialAudio||t&&!Ia(n,r))&&ka(n.roles,r.roles)&&n.groupId===r.groupId)}return!n&&(n=i.video&&e.video)&&(i=i.video,n=e.video,n=!((!t||Ia(i,n))&&ka(i.roles,n.roles))),!n&&(this.g.add(e),!0)},xa.prototype.values=function(){return this.g.values()},K("shaka.media.AdaptationSet",xa),K("shaka.config.CodecSwitchingStrategy",{RELOAD:"reload",SMOOTH:"smooth"}),La.prototype.create=function(){},La.prototype.configure=function(){},La.prototype.getConfiguration=function(){},K("shaka.media.AdaptationSetCriteria",La);var Ca=0,Da=1;
/*
 @license
 Shaka Player
 Copyright 2023 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function Ma(e,t,n){this.g=e,this.i=t,this.h=n}function Pa(e,t){return U(function(n){if(1==n.g)return w(n,er(e.h,t,e.g.drm.preferredKeySystems,e.g.drm.keySystemsMapping),2);if(e.g.streaming.dontChooseCodecs||Xi(t,e.g.preferredVideoCodecs,e.g.preferredAudioCodecs,e.g.preferredDecodingAttributes,e.g.preferredTextFormats),!t.variants.some(br))throw new Ve(2,4,4032);return n.return(Oa(e,t))})}function _a(e,t){var n=e.g.restrictions;e=e.i;var i=!1;t=d(t.variants);for(var r=t.next();!r.done;r=t.next()){r=r.value;var s=r.allowedByApplication;r.allowedByApplication=Zi(r,n,e),s!=r.allowedByApplication&&(i=!0)}return i}function Oa(e,t){var n=_a(e,t);if(t){var i=e.h?e.h.g:null;if(i&&e.h.A){for(var r=new Set,s=d(t.variants),a=s.next();!a.done;a=s.next())a=a.value,a.audio&&r.add(a.audio),a.video&&r.add(a.video);for(r=d(r),s=r.next();!s.done;s=r.next())Na(e,i.keySystem,s.value)}Ua(e,t)}return n}function Na(e,t,n){n=d(n.drmInfos);for(var i=n.next();!i.done;i=n.next())if(i=i.value,i.keySystem==t){i=d(i.initData||[]);for(var r=i.next();!r.done;r=i.next())r=r.value,Qs(e.h,r.initDataType,r.initData)}}function Ua(e,t){e=e.h?e.h.Re():{};var n=Object.keys(e);n=n.length&&"00"==n[0];var i=!1,r=!1,s=new Set,a=new Set,o=new Set;t=d(t.variants);for(var u=t.next();!u.done;u=t.next())u=u.value,u.audio&&o.add(u.audio),u.video&&o.add(u.video),u.allowedByApplication?u.allowedByKeySystem&&(i=!0):r=!0;for(o=d(o),t=o.next();!t.done;t=o.next())if(t=t.value,t.keyIds.size)for(t=d(t.keyIds),u=t.next();!u.done;u=t.next()){u=u.value;var l=e[n?"00":u];l?Fa.includes(l)&&a.add(l):s.add(u)}if(!i)throw e={hasAppRestrictions:r,missingKeys:Array.from(s),restrictedKeyStatuses:Array.from(a)},new Ve(2,4,4012,e)}var Fa=["output-restricted","internal-error"];function Ba(){}function ja(e,t){Va.set(e,t)}function $a(){var e={};if(ce(),KT())for(var t=d(Va.keys()),n=t.next();!n.done;n=t.next())e[n.value]=!0;for(t=d(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]),n=t.next();!n.done;n=t.next())n=n.value,e[n]=KT()?Va.has(n):""!=Xo().canPlayType(n);return e}function Ga(e,t){if(t){var n=Va.get(t.toLowerCase());if(n)return n}throw new Ve(2,4,4e3,e,t)}K("shaka.media.ManifestParser",Ba),Ba.unregisterParserByMime=function(e){Va.delete(e)},Ba.registerParserByMime=ja,Ba.registerParserByExtension=function(){ge("ManifestParser.registerParserByExtension","Please use an ManifestParser with registerParserByMime function.")},Ba.AccessibilityPurpose={rm:"visually impaired",El:"hard of hearing",$l:"spoken subtitles"};var Va=new Map;function Ha(e,t){var n=null,i=null,r=null,s=null,a=e.T();return 1&t&&(r=e.vd()),2&t&&(s=e.T()),8&t&&(n=e.T()),16&t&&(i=e.T()),{trackId:a,Jd:n,Kd:i,ej:r,Di:s}}function Ka(e,t){return 1==t?(t=e.T(),e=e.T(),{baseMediaDecodeTime:t*Math.pow(2,32)+e}):{baseMediaDecodeTime:e.T()}}function Wa(e,t){return 1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),t=e.T(),e.skip(4),e=e.Aa(),{timescale:t,language:String.fromCharCode(96+(e>>10))+String.fromCharCode(96+((960&e)>>5))+String.fromCharCode(96+(31&e))}}function qa(e,t,n){var i=e.T(),r=[],s=null;1&n&&(s=e.Tg()),4&n&&e.skip(4);for(var a=0;a<i;a++){var o={bh:null,sampleSize:null,yf:null};256&n&&(o.bh=e.T()),512&n&&(o.sampleSize=e.T()),1024&n&&e.skip(4),2048&n&&(o.yf=0==t?e.T():e.Tg()),r.push(o)}return{wm:i,ah:r,hg:s}}function Ya(e){e.skip(6),e.skip(2),e.skip(8);var t=e.Aa();return e.skip(2),e.skip(2),e.skip(2),e=e.Aa()+e.Aa()/65536,{channelCount:t,sampleRate:e}}function za(e){return e=e.T(),{codec:_s(e)}}function Xa(e){var t=null,n=null,i=e.Sb(4),r=String.fromCharCode(i[0]);if(r+=String.fromCharCode(i[1]),r+=String.fromCharCode(i[2]),r+=String.fromCharCode(i[3]),"nclx"===r){switch(e.Aa()){case 1:case 5:case 6:case 7:t="srgb";break;case 9:t="rec2020";break;case 11:case 12:t="p3"}switch(i=e.Aa(),e.Aa(),i){case 1:case 6:case 13:case 14:case 15:n="SDR";break;case 16:n="PQ";break;case 18:n="HLG"}}return{colorGamut:t,le:n}}function Qa(e,t){return t=void 0!==t&&t,e=e.toString(16).toUpperCase(),t?e:("0"+e).slice(-2)}function Ja(e){return(10>e?"0":"")+e}function Za(e){if(!ho){ho=!0;var t=new Uint8Array([105,115,111,109]),n=new Uint8Array([97,118,99,49]),i=new Uint8Array([0,0,0,1]);Ao=co("ftyp",t,i,t,n),t=co("dref",xo),Io=co("dinf",t)}this.g=e}function eo(e){for(var t=[],n=d(e.g),i=n.next();!i.done;i=n.next()){var r=t,s=r.push,a=i.value;i=co;var o=a.id+1,u=a.stream.width||0,l=a.stream.height||0;"audio"==a.type&&(l=u=0);var c=a.duration*a.timescale,f=Math.floor(c/(fo+1));switch(c=Math.floor(c%(fo+1)),o=new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(h(oo(o,4)),[0,0,0,0],h(oo(f,4)),h(oo(c,4)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0],h(oo(u,2)),[0,0],h(oo(l,2)),[0,0])),o=co("tkhd",o),u=co,f=a.duration*a.timescale,l=Math.floor(f/(fo+1)),f=Math.floor(f%(fo+1)),c=a.stream.language,c=c.charCodeAt(0)-96<<10|c.charCodeAt(1)-96<<5|c.charCodeAt(2)-96,l=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(h(oo(a.timescale,4)),h(oo(l,4)),h(oo(f,4)),h(oo(c,2)),[0,0])),l=co("mdhd",l),f=a,c=new Uint8Array([]),f.type){case"video":c=go;break;case"audio":c=mo}f=co("hdlr",c);e:{switch(a.type){case"video":a=co("minf",co("vmhd",So),Io,to(a));break e;case"audio":a=co("minf",co("smhd",Eo),Io,to(a));break e}a=new Uint8Array([])}a=u("mdia",l,f,a),i=i("trak",o,a),s.call(r,i)}for(t=at.apply(et,h(t)),s=e.g[0],n=co,i=s.duration*s.timescale,r=Math.floor(i/(fo+1)),i=Math.floor(i%(fo+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(h(oo(s.timescale,4)),h(oo(r,4)),h(oo(i,4)),[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255])),r=co("mvhd",r),i=[],e=d(e.g),u=e.next();!u.done;u=e.next())a=i,o=a.push,u=new Uint8Array([0,0,0,0].concat(h(oo(u.value.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),u=co("trex",u),o.call(a,u);if(e=at.apply(et,h(i)),e=co("mvex",e),i=[],s.encrypted){for(s=d(s.stream.drmInfos),a=s.next();!a.done;a=s.next())if(a=a.value,a.initData)for(a=d(a.initData),o=a.next();!o.done;o=a.next())i.push(o.value.initData);s=at.apply(et,h(i))}else s=new Uint8Array([]);return e=n("moov",r,t,e,s),t=new Uint8Array(Ao.byteLength+e.byteLength),t.set(Ao),t.set(e,Ao.byteLength),t}function to(e){var t=co,n="aac";e.codecs.includes("mp3")?n="mp3":e.codecs.includes("ac-3")?n=ce().be()?"ec-3":"ac-3":e.codecs.includes("ec-3")?n="ec-3":e.codecs.includes("opus")&&(n="opus");var i=new Uint8Array([]);switch(e.type){case"video":if(e.codecs.includes("avc1")){if(n=e.stream.width||0,i=e.stream.height||0,0<e.Na.byteLength)var r=co("avcC",e.Na);else{r=co;for(var s=7,a=[],o=[],u=0,l=0,c=0,d=0;d<e.Ab.length;d++){var f=uo(e.Ab[d]);switch(31&f[0]){case 7:a.push(f),s+=f.length+2;break;case 8:o.push(f),s+=f.length+2}}for(0<a.length&&(u=a[0][1],c=a[0][2],l=a[0][3]),s=new Uint8Array(s),d=0,s[d++]=1,s[d++]=u,s[d++]=c,s[d++]=l,s[d++]=255,s[d++]=224|a.length,u=0;u<a.length;u++)s[d++]=(65280&a[u].length)>>8,s[d++]=255&a[u].length,s.set(a[u],d),d+=a[u].length;for(s[d++]=o.length,a=0;a<o.length;a++)s[d++]=(65280&o[a].length)>>8,s[d++]=255&o[a].length,s.set(o[a],d),d+=o[a].length;r=r("avcC",s)}n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(h(oo(n,2)),h(oo(i,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),i="avc1",o=no(e),a=new Uint8Array([]),e.encrypted&&(a=ro(0,e.stream,e.codecs),i="encv"),i=co(i,n,r,o,a)}else e.codecs.includes("hvc1")&&(i=e.stream.width||0,r=e.stream.height||0,n=new Uint8Array([]),0<e.Na.byteLength&&(n=co("hvcC",e.Na)),i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(h(oo(i,2)),h(oo(r,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),r="hvc1",o=no(e),a=new Uint8Array([]),e.encrypted&&(a=ro(0,e.stream,e.codecs),r="encv"),i=co(r,i,n,o,a));break;case"audio":"mp3"==n?e=co(".mp3",io(e)):"ac-3"==n?(n=co("dac3",e.Ea),i="ac-3",r=new Uint8Array([]),e.encrypted&&(r=ro(0,e.stream,e.codecs),i="enca"),e=co(i,io(e),n,r)):"ec-3"==n?(n=co("dec3",e.Ea),i="ec-3",r=new Uint8Array([]),e.encrypted&&(r=ro(0,e.stream,e.codecs),i="enca"),e=co(i,io(e),n,r)):"opus"==n?(n=co("dOps",e.Ea),i="Opus",r=new Uint8Array([]),e.encrypted&&(r=ro(0,e.stream,e.codecs),i="enca"),e=co(i,io(e),n,r)):(0<e.Ea.byteLength?n=co("esds",e.Ea):(n=co,i=e.id+1,r=e.stream.channelsCount||2,a=e.stream.audioSamplingRate||44100,u=ct("audio",e.codecs.split(",")),l={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},o=l[a],"mp4a.40.5"!==u&&"mp4a.40.29"!==u||(o=l[2*a]),a=parseInt(u.split(".").pop(),10),i=new Uint8Array([0,0,0,0,3,25].concat(h(oo(i,2)),[0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,a<<3|o>>>1,o<<7|r<<3,6,1,2])),n=n("esds",i)),i="mp4a",r=new Uint8Array([]),e.encrypted&&(r=ro(0,e.stream,e.codecs),i="enca"),e=co(i,io(e),n,r)),i=e}return e=co("stsd",wo,i),t("stbl",e,co("stts",vo),co("stsc",yo),co("stsz",To),co("stco",bo))}function no(e){if(!e.Va&&!e.Wa)return new Uint8Array([]);var t=e.Wa;return e=new Uint8Array([].concat(h(oo(e.Va,4)),h(oo(t,4)))),co("pasp",e)}function io(e){return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.stream.channelsCount||2,0,16,0,0,0,0].concat(h(oo(e.stream.audioSamplingRate||44100,2)),[0,0]))}function ro(e,t,n){e=co,n=new Uint8Array([].concat(h(oo(lo(n.split(".")[0]),4)))),n=co("frma",n);var i="cenc",r=t.drmInfos[0];r&&r.encryptionScheme&&(i=r.encryptionScheme),i=new Uint8Array([0,0,0,0].concat(h(oo(lo(i),4)),[0,1,0,0])),i=co("schm",i),r=co;var s=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);t=d(t.drmInfos);for(var a=t.next();!a.done;a=t.next())if((a=a.value)&&a.keyIds&&a.keyIds.size){a=d(a.keyIds);for(var o=a.next();!o.done;o=a.next())s=uo(o.value)}return t=new Uint8Array([0,0,0,0,0,0,1,8]),t=co("tenc",t,s),e("sinf",n,i,r("schi",t))}function so(e){var t=[];e=d(e.g);for(var n=e.next();!n.done;n=e.next()){n=n.value;var i,r=t.push,s=r.apply,a=co,o=new Uint8Array([0,0,0,0].concat(h(oo(n.data?n.data.Tb:0,4))));o=co("mfhd",o);var u=n.data?n.data.yb:[],l=new Uint8Array(4+u.length);for(i=0;i<u.length;i++){var c=u[i].flags;l[i+4]=c.ib<<4|c.kb<<2|c.jb}u=co("sdtp",l);var f=u.length+92;l=co,i=new Uint8Array([0,0,0,58].concat(h(oo(n.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),i=co("tfhd",i),c=n.data?n.data.baseMediaDecodeTime:0;var p=Math.floor(c%(fo+1));c=new Uint8Array([1,0,0,0].concat(h(oo(Math.floor(c/(fo+1)),4)),h(oo(p,4)))),c=co("tfdt",c);var g=f;f=n.data?n.data.yb:[],p=f.length;var m=12+16*p,v=new Uint8Array(m);for(g+=8+m,v.set(["video"===n.type?1:0,0,15,1].concat(h(oo(p,4)),h(oo(g,4))),0),g=0;g<p;g++){var y=f[g];m=oo(y.duration,4);var b=oo(y.size,4),T=y.flags;y=oo(y.qb,4),v.set([].concat(h(m),h(b),[T.vb<<2|T.ib,T.kb<<6|T.jb<<4|T.wb,61440&T.hb,15&T.hb],h(y)),12+16*g)}f=co("trun",v),u=l("traf",i,c,f,u),a=a("moof",o,u),s.call(r,t,[a,ao(n)])}return at.apply(et,h(t))}function ao(e){return e=(e.data?e.data.yb:[]).map(function(e){return e.data}),e=at.apply(et,h(e)),co("mdat",e)}function oo(e,t){var n=[];for(--t;0<=t;t--)n.push(e>>8*t&255);return n}function uo(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length/2;n+=1)t[n]=parseInt(String(e[2*n]+e[2*n+1]),16);return t}function lo(e){for(var t=0,n=0;n<e.length;n+=1)t|=e.charCodeAt(n)<<8*(e.length-n-1);return t}function co(e){var t=F.apply(1,arguments),n=po.get(e);n||(n=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)],po.set(e,n));for(var i=8,r=t.length-1;0<=r;r--)i+=t[r].byteLength;for(r=new Uint8Array(i),r[0]=i>>24&255,r[1]=i>>16&255,r[2]=i>>8&255,r[3]=255&i,r.set(n,4),n=0,i=8;n<t.length;n++)r.set(t[n],i),i+=t[n].byteLength;return r}var ho=!1,fo=Math.pow(2,32)-1,po=new Map,go=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),mo=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),vo=new Uint8Array([0,0,0,0,0,0,0,0]),yo=new Uint8Array([0,0,0,0,0,0,0,0]),bo=new Uint8Array([0,0,0,0,0,0,0,0]),To=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),So=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Eo=new Uint8Array([0,0,0,0,0,0,0,0]),wo=new Uint8Array([0,0,0,0,0,0,0,1]),Ao=new Uint8Array([]),xo=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Io=new Uint8Array([]);function ko(e){e=Be(e);var t=null;return(new ks).box("moov",Ls).box("trak",Ls).box("mdia",Ls).box("minf",Ls).box("stbl",Ls).R("stsd",Rs).box("enca",function(e){return t=e.reader.h,Ds(e)}).box("sinf",Ls).box("frma",function(e){e.parser.stop(),"ec-3"===za(e.reader).codec&&t&&2!==t.getUint16(16)&&t.setUint16(16,2)}).parse(e),e}function Lo(e,t,n){function i(e){h.push({box:e,mi:1701733217})}function r(e){h.push({box:e,mi:1701733238})}function s(e){l=!0,e.parser.stop()}function a(e){c.push(e),Ls(e)}var o,u=t=Be(t),l=!1,c=[],h=[];if((new ks).box("moov",a).box("trak",a).box("mdia",a).box("minf",a).box("stbl",a).R("stsd",function(e){o=e,c.push(e),Rs(e)}).R("encv",s).R("enca",s).R("dvav",r).R("dva1",r).R("dvh1",r).R("dvhe",r).R("dvc1",r).R("dvi1",r).R("hev1",r).R("hvc1",r).R("avc1",r).R("avc3",r).R("ac-3",i).R("ec-3",i).R("ac-4",i).R("Opus",i).R("fLaC",i).R("mp4a",i).parse(t),l)return t;if(0==h.length||!o)throw te(st(t)),new Ve(2,3,3019,n);h.reverse(),n=d(h);for(var f=n.next();!f.done;f=n.next())f=f.value,u=Do(e,u,o,f.box,c,f.mi);return ce().xi()?(e=new Uint8Array(t.byteLength+u.byteLength),e.set(u),e.set(t,u.byteLength),e):u}function Ro(e){e=Be(e);var t=[];(new ks).box("mdat",function(e){t.push(e)}).parse(e);for(var n=[],i=0;i<t.length;i++){var r=t[i-1],s=t[i];n.push(Co(e.subarray(r?r.start+r.size:0,s.start+s.size)))}return at.apply(et,h(n))}function Co(e){function t(e){a.push(e),Ls(e)}var n,i,r,s,a=[];if((new ks).box("moof",t).box("traf",t).R("tfhd",function(e){n=e,r=Ha(e.reader,e.flags)}).R("trun",function(e){i=e,s=qa(e.reader,e.version,e.flags)}).parse(e),r&&2!==r.Di){var o=n.start+Os(n)+4+(null!==r.ej?8:0),u=$e(e);if(null!==r.Di)u.setUint32(o,2);else{Mo(e,n.start,n.size+4);var l=u.getUint32(n.start+8);u.setUint32(n.start+8,2|l),s&&null!==s.hg&&u.setInt32(i.start+Os(i)+4,s.hg+4),l=e.subarray(0,o),u=e.subarray(o),e=new Uint8Array(e.byteLength+4),e.set(l),l=[];for(var c=3;0<=c;c--)l.push(2>>8*c&255);for(e.set(new Uint8Array(l),o),e.set(u,o+4),o=d(a),u=o.next();!u.done;u=o.next())u=u.value,Mo(e,u.start,u.size+4)}}return e}function Do(e,t,n,i,r,s){var a=ro(new Za([]),e,i.name),o=t.subarray(i.start,i.start+i.size);for(e=new Uint8Array(i.size+a.byteLength),e.set(o,0),$e(e).setUint32(4,s),e.set(a,i.size),Mo(e,0,e.byteLength),s=new Uint8Array(t.byteLength+e.byteLength),i=ce().Ye()?i.start:i.start+i.size,a=t.subarray(i),s.set(t.subarray(0,i)),s.set(e,i),s.set(a,i+e.byteLength),t=d(r),r=t.next();!r.done;r=t.next())r=r.value,Mo(s,r.start,r.size+e.byteLength);return e=$e(s,n.start),n=Os(n),t=e.getUint32(n),e.setUint32(n,t+1),s}function Mo(e,t,n){e=$e(e,t),t=e.getUint32(0),0!=t&&(1==t?(e.setUint32(8,n>>32),e.setUint32(12,4294967295&n)):e.setUint32(0,n))}function Po(e){function t(e){i.push({start:e.start,size:e.size}),Ls(e)}var n=Be(e),i=[];return(new ks).box("moov",t).box("trak",t).box("mdia",t).box("minf",t).box("stbl",t).box("stsd",function(e){i.push({start:e.start,size:e.size});for(var t=$e(n,e.start),r=0;r<e.size-3;r++){var s=t.getUint32(r);1633889587==s?t.setUint32(r,1700998451):1684103987==s&&t.setUint32(r,1684366131)}}).parse(n),n}function _o(e,t,n,i,r,s,a,o){this.O=e,this.startByte=t,this.endByte=n,this.od=void 0===i?null:i,this.timescale=void 0===r?null:r,this.h=void 0===s?null:s,this.aesKey=void 0===a?null:a,this.g=this.mimeType=this.codecs=null,this.encrypted=void 0!==o&&o}function Oo(e,t){return e===t||(e&&t?e.zc()==t.zc()&&e.xc()==t.xc()&&Bt(e.O().sort(),t.O().sort())&&Ue(e.Wb(),t.Wb()):e==t)}function No(e,t,n,i,r,s,a,o,u,l,c,h,f,p,g,m){for(l=void 0===l?[]:l,p=void 0===p?Fo:p,this.startTime=e,this.j=this.endTime=t,this.C=n,this.startByte=i,this.endByte=r,this.Y=s,this.timestampOffset=a,this.appendWindowStart=o,this.appendWindowEnd=u,this.g=l,this.tilesLayout=void 0===c?"":c,this.B=void 0===h?null:h,this.h=void 0===f?null:f,this.status=p,this.preload=!1,this.l=!0,this.m=!1,this.aesKey=void 0===g?null:g,this.thumbnailSprite=null,this.i=-1,this.A=void 0!==m&&m,this.F=this.o=!1,e=d(this.g),t=e.next();!t.done;t=e.next())t.value.ii();this.A&&this.g.length&&this.g[this.g.length-1].gi(),this.s=this.bandwidth=this.mimeType=this.codecs=null,this.G=!1}function Uo(e,t){e.Y=t,e=d(e.g);for(var n=e.next();!n.done;n=e.next())Uo(n.value,t)}_o.prototype.zc=function(){return this.startByte},_o.prototype.xc=function(){return this.endByte},_o.prototype.ee=function(e){this.h=e},_o.prototype.Wb=function(){return this.h},K("shaka.media.InitSegmentReference",_o),_o.prototype.getEndByte=_o.prototype.xc,_o.prototype.getStartByte=_o.prototype.zc,i=No.prototype,i.O=function(){return this.C()},i.getStartTime=function(){return this.startTime},i.xj=function(){return this.endTime},i.zc=function(){return this.startByte},i.xc=function(){return this.endByte},i.Tj=function(){return this.tilesLayout},i.Sj=function(){return this.B},i.Ac=function(){return this.status},i.nk=function(){this.status=Bo},i.Lg=function(){this.preload=!0},i.isPreload=function(){return this.preload},i.nd=function(){this.l=!1},i.dk=function(){return this.l},i.ii=function(){this.o=!0},i.fk=function(){return this.o},i.gi=function(){this.F=!0},i.ek=function(){return this.F},i.ei=function(){this.m=!0},i.Zj=function(){return this.m},i.Df=function(e){this.thumbnailSprite=e},i.Qj=function(){return this.thumbnailSprite},i.offset=function(e){this.startTime+=e,this.endTime+=e,this.j+=e;for(var t=d(this.g),n=t.next();!n.done;n=t.next())n=n.value,n.startTime+=e,n.endTime+=e,n.j+=e},i.qh=function(e){null==this.h?X("Sync attempted without sync time!"):(e=this.h-e-this.startTime,.001<=Math.abs(e)&&this.offset(e))},i.ee=function(e,t){this.s=e,this.G=void 0!==t&&t},i.Wb=function(e){var t=this.s;return(void 0===e||e)&&this.G&&(this.s=null),t},K("shaka.media.SegmentReference",No),No.prototype.getSegmentData=No.prototype.Wb,No.prototype.setSegmentData=No.prototype.ee,No.prototype.syncAgainst=No.prototype.qh,No.prototype.offset=No.prototype.offset,No.prototype.getThumbnailSprite=No.prototype.Qj,No.prototype.setThumbnailSprite=No.prototype.Df,No.prototype.hasByterangeOptimization=No.prototype.Zj,No.prototype.markAsByterangeOptimization=No.prototype.ei,No.prototype.isLastPartial=No.prototype.ek,No.prototype.markAsLastPartial=No.prototype.gi,No.prototype.isPartial=No.prototype.fk,No.prototype.markAsPartial=No.prototype.ii,No.prototype.isIndependent=No.prototype.dk,No.prototype.markAsNonIndependent=No.prototype.nd,No.prototype.isPreload=No.prototype.isPreload,No.prototype.markAsPreload=No.prototype.Lg,No.prototype.markAsUnavailable=No.prototype.nk,No.prototype.getStatus=No.prototype.Ac,No.prototype.getTileDuration=No.prototype.Sj,No.prototype.getTilesLayout=No.prototype.Tj,No.prototype.getEndByte=No.prototype.xc,No.prototype.getStartByte=No.prototype.zc,No.prototype.getEndTime=No.prototype.xj,No.prototype.getStartTime=No.prototype.getStartTime,No.prototype.getUris=No.prototype.O;var Fo=0,Bo=1;function jo(e){return 1==e.length&&1e-4>e.end(0)-e.start(0)}function $o(e){return!e||jo(e)?null:e.length?e.end(e.length-1):null}function Go(e,t){return!(!e||!e.length||jo(e)||t>e.end(e.length-1))&&t>=e.start(0)}function Vo(e,t){if(!e||!e.length||jo(e))return 0;var n=0;e=d(Ko(e));for(var i=e.next();!i.done;i=e.next()){var r=i.value;i=r.start,r=r.end,r>t&&(n+=r-Math.max(i,t))}return n}function Ho(e,t,n){return e&&e.length&&!jo(e)?(e=Ko(e).findIndex(function(e,i,r){return e.start>t&&(0==i||r[i-1].end-t<=n)}),0<=e?e:null):null}function Ko(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function Wo(){}function qo(e,t){var n=document.createElement("source");return n.src=e,n.type=void 0===t?"":t,n}function Yo(e){for(var t=!1,n=e.getElementsByTagName("source"),i=n.length-1;0<=i;--i)e.removeChild(n[i]),t=!0;return e.src&&(e.removeAttribute("src"),t=!0),t}function zo(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function Xo(){return Zo||(Jo||(Jo=new _i(function(){Zo=null})),(Zo=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(Zo=document.createElement("video")),Jo.ha(1),Zo)}function Qo(t,n){var i,r,s,a,o;return U(function(u){if(1==u.g)return"fonts"in document&&"FontFace"in e?w(u,document.fonts.ready,2):u.return();if(!("entries"in document.fonts))return u.return();for(i=function(e){e=e.entries();for(var t=[],n=e.next();!1===n.done;)t.push(n.value),n=e.next();return t},r=d(i(document.fonts)),s=r.next();!s.done;s=r.next())if(a=s.value,a.family===t&&"swap"===a.display)return u.return();o=new FontFace(t,"url("+n+")",{display:"swap"}),document.fonts.add(o),A(u)})}No.Status={fl:Fo,pm:Bo,Ol:2},K("shaka.util.Dom",Wo),Wo.removeAllChildren=zo,Wo.clearSourceFromVideo=Yo;var Jo=null,Zo=null;
/*
 @license
 Shaka Player
 Copyright 2022 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function eu(){}function tu(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]}function nu(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]}function iu(e,t){var n=(127&e[t])<<21;return n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|127&e[t+3]}function ru(e){var t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if("APIC"===e.type){if(2>e.size||3!==e.data[0])return null;var n=e.data.subarray(1).indexOf(0);if(-1===n)return null;var i=We(Be(e.data,1,n)),r=e.data[2+n],s=e.data.subarray(3+n).indexOf(0);if(-1===s)return null;var a,o=We(Be(e.data,3+n,s));return a="--\x3e"===i?We(Be(e.data,4+n+s)):Fe(e.data.subarray(4+n+s)),t.mimeType=i,t.pictureType=r,t.description=o,t.data=a,t}return"TXXX"===e.type||"WXXX"===e.type?2>e.size||3!==e.data[0]?null:(i=e.data.subarray(1).indexOf(0),-1===i?null:(n=We(Be(e.data,1,i)),e=We(Be(e.data,2+i)).replace(/\0*$/,""),t.description=n,t.data=e,t)):"PRIV"===e.type?2>e.size?null:(n=e.data.indexOf(0),-1===n?null:(n=We(Be(e.data,0,n)),t.description=n,"com.apple.streaming.transportStreamTimestamp"==n?(n=e.data.subarray(n.length+1),e=1&n[3],n=(n[4]<<23)+(n[5]<<15)+(n[6]<<7)+n[7],n/=45,e&&(n+=47721858.84),t.data=n):(e=Fe(e.data.subarray(n.length+1)),t.data=e),t)):"T"===e.type[0]?2>e.size||3!==e.data[0]?null:(e=We(e.data.subarray(1)).replace(/\0*$/,""),t.data=e,t):"W"===e.type[0]?(e=We(e.data).replace(/\0*$/,""),t.data=e,t):e.data?(t.data=Fe(e.data),t):null}function su(e){for(var t=0,n=[];tu(e,t);){var i=iu(e,t+6);for(e[t+5]>>6&1&&(t+=10),t+=10,i=t+i;t+10<i;){var r=e.subarray(t),s=iu(r,4);r={type:String.fromCharCode(r[0],r[1],r[2],r[3]),size:s,data:r.subarray(10,10+s)},(s=ru(r))&&n.push(s),t+=r.size+10}nu(e,t)&&(t+=10)}return n}function au(e,t){for(var n=t=void 0===t?0:t,i=0;tu(e,t);)e[t+5]>>6&1&&(i+=10),i+=10,i+=iu(e,t+6),nu(e,t+10)&&(i+=10),t+=i;return 0<i?e.subarray(n,n+i):new Uint8Array([])}function ou(e){return new Date(Date.UTC(1900,0,1,0,0,0,0)+e).getTime()}function uu(e,t){if(this.j=e,void 0!==t&&t){t=new Uint8Array(e.byteLength);for(var n=0,i=0;i<e.byteLength;i++)2<=i&&3==e[i]&&0==e[i-1]&&0==e[i-2]||(t[n]=e[i],n++);this.j=Be(t,0,n)}this.i=this.j.byteLength,this.g=this.h=0}function lu(e){var t=e.j.byteLength-e.i,n=new Uint8Array(4),i=Math.min(4,e.i);0!==i&&(n.set(e.j.subarray(t,t+i)),e.h=new As(n,0).T(),e.g=8*i,e.i-=i)}function cu(e,t){if(e.g<=t){t-=e.g;var n=Math.floor(t/8);t-=8*n,e.g-=n,lu(e)}e.h<<=t,e.g-=t}function du(e,t){var n=Math.min(e.g,t),i=e.h>>>32-n;return e.g-=n,0<e.g?e.h<<=n:0<e.i&&lu(e),n=t-n,0<n?i<<n|du(e,n):i}function hu(e){var t;for(t=0;t<e.g;++t)if(0!==(e.h&2147483648>>>t))return e.h<<=t,e.g-=t,t;return lu(e),t+hu(e)}function fu(e){cu(e,1+hu(e))}function pu(e){var t=hu(e);return du(e,t+1)-1}function gu(e){return e=pu(e),1&e?1+e>>>1:-1*(e>>>1)}function mu(e){return 1===du(e,1)}function vu(e){return du(e,8)}function yu(e,t){for(var n=8,i=8,r=0;r<t;r++)0!==i&&(i=gu(e),i=(n+i+256)%256),n=0===i?n:i}function bu(e){return vu(e),pu(e),pu(e)}function Tu(){this.G=null,this.H=!1,this.m=this.I=null,this.j=[],this.g=[],this.A=this.B=null,this.i=[],this.h=[],this.C=null,this.l=[],this.F=this.o=this.s=null}function Su(e,t){if(1!==(t[0]<<16|t[1]<<8|t[2]))return null;var n={data:new Uint8Array(0),packetLength:t[4]<<8|t[5],pts:null,dts:null,nalus:[]};if(n.packetLength&&n.packetLength>t.byteLength-6)return null;var i=t[7];if(192&i){var r=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2;null==e.s&&(e.s=r),n.pts=xu(r,e.s),e.s=n.pts,n.dts=n.pts,64&i&&(i=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,null==e.o&&(e.o=i),n.dts=n.pts!=r?xu(i,e.o):i),e.o=n.dts}return e=t[8]+9,t.byteLength<=e?null:(n.data=t.subarray(e),n)}function Eu(e){var t=e.Qc();return 1<t.length&&(e=t[0].pts,t=t[1].pts,!isNaN(t-e))?String(1/(t-e)*9e4):null}function wu(e){var t={height:null,width:null,codec:null,frameRate:null},n=e.Ve();if(!n.length)return t;if(n=n.find(function(e){return 7==e.type}),!n)return t;n=new uu(n.data);var i=vu(n),r=vu(n),s=vu(n);if(fu(n),Lu.includes(i)){var a=pu(n);if(3===a&&cu(n,1),fu(n),fu(n),cu(n,1),mu(n)){a=3!==a?8:12;for(var o=0;o<a;o++)mu(n)&&yu(n,6>o?16:64)}}if(fu(n),a=pu(n),0===a)pu(n);else if(1===a)for(cu(n,1),fu(n),fu(n),a=pu(n),o=0;o<a;o++)fu(n);fu(n),cu(n,1),a=pu(n),o=pu(n);var u=du(n,1);0===u&&cu(n,1),cu(n,1);var l=0,c=0,d=0,h=0;return mu(n)&&(l=pu(n),c=pu(n),d=pu(n),h=pu(n)),t.height=String((2-u)*(o+1)*16-2*d-2*h),t.width=String(16*(a+1)-2*l-2*c),t.codec="avc1."+("0"+i.toString(16).toUpperCase()).slice(-2)+("0"+r.toString(16).toUpperCase()).slice(-2)+("0"+s.toString(16).toUpperCase()).slice(-2),t.frameRate=Eu(e),t}function Au(e){var t={height:null,width:null,codec:null,frameRate:null},n=e.Ve();if(!n.length)return t;if(n=n.find(function(e){return 33==e.type}),!n)return t;var i=new uu(n.fullData,!0);vu(i),vu(i),du(i,4);var r=du(i,3);mu(i);var s=du(i,2),a=du(i,1),o=du(i,5),u=du(i,32);n=vu(i);for(var l=vu(i),c=vu(i),d=vu(i),h=vu(i),f=vu(i),p=vu(i),g=[],m=[],v=0;v<r;v++)g.push(mu(i)),m.push(mu(i));if(0<r)for(v=r;8>v;v++)du(i,2);for(v=0;v<r;v++)g[v]&&du(i,88),m[v]&&vu(i);pu(i),r=pu(i),3==r&&du(i,1),g=pu(i),m=pu(i);var y=v=0,b=0,T=0;return mu(i)&&(v+=pu(i),y+=pu(i),b+=pu(i),T+=pu(i)),t.width=String(g-(v+y)*(1===r||2===r?2:1)),t.height=String(m-(b+T)*(1===r?2:1)),i=function(e){for(var t=0,n=0;32>n;n++)t|=(e>>n&1)<<31-n;return t>>>0}(u),a=1==a?"H":"L",s="hvc1."+["","A","B","C"][s]+o,s+="."+i.toString(16).toUpperCase(),s+="."+a+p,f&&(s+="."+f.toString(16).toUpperCase()),h&&(s+="."+h.toString(16).toUpperCase()),d&&(s+="."+d.toString(16).toUpperCase()),c&&(s+="."+c.toString(16).toUpperCase()),l&&(s+="."+l.toString(16).toUpperCase()),n&&(s+="."+n.toString(16).toUpperCase()),t.codec=s,t.frameRate=Eu(e),t}function xu(e,t){var n=1;for(e>t&&(n=-1);4294967296<Math.abs(t-e);)e+=8589934592*n;return e}function Iu(e){return!(0>ku(e))}function ku(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(71==e[n]&&71==e[n+188]&&71==e[n+376])return n;n++}return-1}K("shaka.util.Id3Utils",eu),eu.getID3Data=au,eu.getID3Frames=su,K("shaka.util.ExpGolomb",uu),i=Tu.prototype,i.clearData=function(){this.j=[],this.g=[],this.i=[],this.h=[],this.l=[]},i.parse=function(e){if(564>e.length)return this;for(var t=Math.max(0,ku(e)),n=e.length-(e.length+t)%188,i=!1,r=t;r<n;r+=188)if(71==e[r]){var s=!!(64&e[r+1]),a=((31&e[r+1])<<8)+e[r+2];if(1<(48&e[r+3])>>4){var o=r+5+e[r+4];if(o==r+188)continue}else o=r+4;switch(a){case 0:s&&(o+=e[o]+1),this.G=(31&e[o+10])<<8|e[o+11];break;case 17:case 8191:break;case this.G:s&&(o+=e[o]+1),s=e,a={audio:-1,video:-1,We:-1,audioCodec:"",videoCodec:""};var u=o+3+((15&s[o+1])<<8|s[o+2])-4;for(o+=12+((15&s[o+10])<<8|s[o+11]);o<u;){var l=(31&s[o+1])<<8|s[o+2],c=(15&s[o+3])<<8|s[o+4];switch(s[o]){case 6:if(0<c)for(var d=o+5,h=c;2<h;){var f=s[d+1]+2;switch(s[d]){case 5:var p=Qe(s.subarray(d+2,d+f));-1==a.audio&&"Opus"===p?(a.audio=l,a.audioCodec="opus"):-1==a.video&&"AV01"===p&&(a.video=l,a.videoCodec="av1");break;case 106:-1==a.audio&&(a.audio=l,a.audioCodec="ac3");break;case 122:-1==a.audio&&(a.audio=l,a.audioCodec="ec3");break;case 124:-1==a.audio&&(a.audio=l,a.audioCodec="aac");break;case 127:"opus"==a.audioCodec&&(p=null,128===s[d+2]&&(p=s[d+3]),null!=p&&(this.F={channelCount:0===(15&p)?2:15&p,hj:p,sampleRate:48e3}))}d+=f,h-=f}break;case 15:-1==a.audio&&(a.audio=l,a.audioCodec="aac");break;case 17:-1==a.audio&&(a.audio=l,a.audioCodec="aac-loas");break;case 21:-1==a.We&&(a.We=l);break;case 27:-1==a.video&&(a.video=l,a.videoCodec="avc");break;case 3:case 4:-1==a.audio&&(a.audio=l,a.audioCodec="mp3");break;case 36:-1==a.video&&(a.video=l,a.videoCodec="hvc");break;case 129:-1==a.audio&&(a.audio=l,a.audioCodec="ac3");break;case 132:case 135:-1==a.audio&&(a.audio=l,a.audioCodec="ec3")}o+=c+5}s=a,-1!=s.video&&(this.I=s.video,this.m=s.videoCodec),-1!=s.audio&&(this.B=s.audio,this.A=s.audioCodec),-1!=s.We&&(this.C=s.We),i&&!this.H&&(i=!1,r=t-188),this.H=!0;break;case this.I:o=e.subarray(o,r+188),s?this.j.push([o]):this.j.length&&this.j[this.j.length-1]&&this.j[this.j.length-1].push(o);break;case this.B:o=e.subarray(o,r+188),s?this.i.push([o]):this.i.length&&this.i[this.i.length-1]&&this.i[this.i.length-1].push(o);break;case this.C:o=e.subarray(o,r+188),s?this.l.push([o]):this.l.length&&this.l[this.l.length-1]&&this.l[this.l.length-1].push(o);break;default:i=!0}}return this},i.xk=function(e){return ge("TsParser.parseAvcNalus","Please use parseNalus function instead."),this.Qg(e,{Xd:null,state:null})},i.Qg=function(e,t){var n=e.pts?e.pts/9e4:null;e=e.data;var i=e.byteLength,r=1;"hvc"==this.m&&(r=2);var s=t.state||0,a=s,o=0,u=[],l=-1,c=0;for(-1==s&&(l=0,c="hvc"==this.m?e[0]>>1&63:31&e[0],s=0,o=1);o<i;){var d=e[o++];s?1===s?s=d?0:2:d?1==d?(d=o-s-1,0<=l?u.push({data:e.subarray(l+r,d),fullData:e.subarray(l,d),type:c,time:n,state:null}):(s=u.length?u[u.length-1]:t.Xd)&&(a&&o<=4-a&&s.state&&(s.data=s.data.subarray(0,s.data.byteLength-a),s.fullData=s.fullData.subarray(0,s.fullData.byteLength-a)),0<d&&(d=e.subarray(0,d),s.data=at(s.data,d),s.fullData=at(s.fullData,d),s.state=0)),o<i?(c="hvc"==this.m?e[o]>>1&63:31&e[o],l=o,s=0):s=-1):s=0:s=3:s=d?0:1}return 0<=l&&0<=s&&u.push({data:e.subarray(l+r,i),fullData:e.subarray(l,i),type:c,time:n,state:s}),!u.length&&t.Xd&&(n=u.length?u[u.length-1]:t.Xd)&&(n.data=at(n.data,e),n.fullData=at(n.fullData,e)),t.state=s,u},i.getMetadata=function(){for(var e=[],t=d(this.l),n=t.next();!n.done;n=t.next())n=at.apply(et,h(n.value)),(n=Su(this,n))&&e.push({cueTime:n.pts?n.pts/9e4:null,data:n.data,frames:su(n.data),dts:n.dts,pts:n.pts});return e},i.rb=function(){if(this.i.length&&!this.h.length)for(var e=d(this.i),t=e.next();!t.done;t=e.next()){var n=at.apply(et,h(t.value)),i=Su(this,n);t=this.h.length?this.h[this.h.length-1]:null,i&&null!=i.pts&&null!=i.dts&&(!t||t.pts!=i.pts&&t.dts!=i.dts)?this.h.push(i):this.h.length&&(n=i?i.data:n)&&(t=this.h.pop(),t.data=at(t.data,n),this.h.push(t))}return this.h},i.Qc=function(e){if(e=void 0===e||e,this.j.length&&!this.g.length){for(var t=d(this.j),n=t.next();!n.done;n=t.next()){var i=at.apply(et,h(n.value)),r=Su(this,i);n=this.g.length?this.g[this.g.length-1]:null,r&&null!=r.pts&&null!=r.dts&&(!n||n.pts!=r.pts&&n.dts!=r.dts)?this.g.push(r):this.g.length&&(i=r?r.data:i)&&(n=this.g.pop(),n.data=at(n.data,i),this.g.push(n))}if(e){for(t={Xd:null,state:null},n=[],i=d(this.g),r=i.next();!r.done;r=i.next())r=r.value,r.nalus=this.Qg(r,t),r.nalus.length&&(n.push(r),t.Xd=r.nalus[r.nalus.length-1]);this.g=n}}return e?this.g:(e=this.g,this.g=[],e)},i.getStartTime=function(e){if("audio"==e){e=null;var t=this.rb();return t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e}return"video"==e?(e=null,t=this.Qc(!1),t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e):null},i.Md=function(){return{audio:this.A,video:this.m}},i.Ve=function(){for(var e=[],t=d(this.Qc()),n=t.next();!n.done;n=t.next())e.push.apply(e,h(n.value.nalus));return e},i.Wj=function(){ge("TsParser.getVideoResolution","Please use getVideoInfo function instead.");var e=this.Dg();return{height:e.height,width:e.width}},i.Dg=function(){return"hvc"==this.m?Au(this):wu(this)},K("shaka.util.TsParser",Tu),Tu.syncOffset=ku,Tu.probe=Iu,Tu.prototype.getVideoInfo=Tu.prototype.Dg,Tu.prototype.getVideoResolution=Tu.prototype.Wj,Tu.prototype.getVideoNalus=Tu.prototype.Ve,Tu.prototype.getCodecs=Tu.prototype.Md,Tu.prototype.getStartTime=Tu.prototype.getStartTime,Tu.prototype.getVideoData=Tu.prototype.Qc,Tu.prototype.getAudioData=Tu.prototype.rb,Tu.prototype.getMetadata=Tu.prototype.getMetadata,Tu.prototype.parseNalus=Tu.prototype.Qg,Tu.prototype.parseAvcNalus=Tu.prototype.xk,Tu.prototype.parse=Tu.prototype.parse,Tu.prototype.clearData=Tu.prototype.clearData,Tu.Timescale=9e4;var Lu=[100,110,122,244,44,83,86,118,128,138,139,134];function Ru(e,t,n,i,r){var s=this;this.g=e,this.N=n,this.A=i,this.ia=t,this.l=new Map,this.C=new Map,this.Xa=new Map,this.h=null,this.Ka=!1,this.M=r||null,this.o=new Map,this.s=new re,this.j=new Map,this.I=null,this.K=new Kr,this.Ba="",this.eb=!1,this.ya=!0,this.L=!1,this.B=this.P=null,this.i=Cu(this,this.K),this.Oa=this.F=!1,this.H=new ys(function(){return Pu(s)}),this.G=!1,this.S="UNKNOWN",this.Za=this.ab=!1,this.Ta=new Kr,this.m=!1,this.wa=null,this.$=new Map,this.oa=this.U=this.va=this.W=null,this.ka=new Kr,this.g.remote&&(this.L="disconnected"!=this.g.remote.state,this.s.D(this.g.remote,"connect",function(){s.L="disconnected"!=s.g.remote.state}),this.s.D(this.g.remote,"connecting",function(){s.L="disconnected"!=s.g.remote.state}),this.s.D(this.g.remote,"disconnect",function(){s.L="disconnected"!=s.g.remote.state}))}function Cu(t,n){if(t.ya=!0,e.ManagedMediaSource){t.B||(t.g.disableRemotePlayback=!0);var i=new ManagedMediaSource;t.s.D(i,"startstreaming",function(){t.ya=!0}),t.s.D(i,"endstreaming",function(){t.ya=!1})}else i=new MediaSource;return t.s.za(i,"sourceopen",function(){URL.revokeObjectURL(t.Ba),n.resolve()}),t.s.za(t.g,"playing",function(){t.eb=!0}),t.Ba=ml(i),t.A.useSourceElements?(t.g.removeAttribute("src"),t.P&&t.g.removeChild(t.P),t.B&&t.g.removeChild(t.B),t.P=qo(t.Ba),t.g.appendChild(t.P),t.B&&t.g.appendChild(t.B),t.g.load()):t.g.src=t.Ba,i}function Du(t,n,i){t.g&&e.ManagedMediaSource&&t.i&&t.A.useSourceElements&&(t.B&&t.g.removeChild(t.B),t.B=qo(n,i),t.g.appendChild(t.B),t.g.disableRemotePlayback=!1)}function Mu(){var e='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",video/mp4; codecs="dvh1.05.01",video/mp4; codecs="dvh1.20.01",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="ac-4.02.01.01",audio/mp4; codecs="opus",audio/mp4; codecs="flac",audio/mp4; codecs="dtsc",audio/mp4; codecs="dtse",audio/mp4; codecs="dtsx",audio/mp4; codecs="apac.31.00",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat(h(Ei)),t={};ce(),e=d(e);for(var n=e.next();!n.done;n=e.next()){n=n.value,Ii(n)?t[n]=!0:t[n]=KT()?St(n)||!!si(n):""!=Xo().canPlayType(n);var i=n.split(";")[0];t[i]=t[i]||t[n]}return t}function Pu(e){var t,n,i,r,s,a,o,u,l,c,h,f,p,g,m;return U(function(v){if(1==v.g){for(t=[],n=d(e.o),i=n.next();!i.done;i=n.next())for(r=i.value,s=d(r),a=s.next().value,o=s.next().value,u=o[0],l=a,e.o.set(l,o.slice(0,1)),u&&t.push(u.p.catch(Ni)),c=d(o.slice(1)),h=c.next();!h.done;h=c.next())f=h.value,f.p.reject(new Ve(2,7,7003,void 0));return e.h&&t.push(e.h.destroy()),w(v,Promise.all(t),2)}for(p=d(e.j.values()),g=p.next();!g.done;g=p.next())m=g.value,m.destroy();e.s&&(e.s.release(),e.s=null),e.g&&e.B&&e.g.removeChild(e.B),e.g&&e.P&&(e.g.removeChild(e.P),e.g.load(),e.g.disableRemotePlayback=!1),e.g=null,e.P=null,e.B=null,e.A=null,e.i=null,e.h=null,e.ia=null,e.l.clear(),e.Xa.clear(),e.j.clear(),e.I=null,e.o.clear(),e.M=null,e.$.clear(),e.N=null,A(v)})}function _u(e,t,n,i){"audio"==t&&i&&(i=ur(i,n.mimeType));var s=hi(n.mimeType,i);if(t==ft)Nu(e,s,e.G,n.external);else{var a=e.A.forceTransmux;(!St(s)||!e.G&&Ei.includes(s))&&(a=!0);var o=fi(n.mimeType,i);if(a){if(a=dt("audio",(i||"").split(",")),i=dt("video",(i||"").split(",")),a&&i)return e.m=!0,_u(e,"audio",n,a),void _u(e,"video",n,i);(i=si(o))&&(s=i(),e.j.set(t,s),s=s.convertCodecs(t,o))}o=s+e.A.addExtraFeaturesToSourceBuffer(s),bs(e.H);try{var u=e.i.addSourceBuffer(o)}catch(r){throw new Ve(2,3,3015,r,"The mediaSource_ status was "+e.i.readyState+" expected 'open'",null)}e.G&&(u.mode=vl),e.s.D(u,"error",function(){var n=e.o.get(t)[0];n.p.reject(new Ve(2,3,3014,e.g.error?e.g.error.code:0,n.uri))}),e.s.D(u,"updateend",function(){return nl(e,t)}),e.l.set(t,u),e.C.set(t,s),e.Xa.set(t,!!n.drmInfos.length)}}function Ou(e){return e.ya&&!e.L&&!e.F}function Nu(e,t,n,i){e.h||(e.h=new wi(e.ia),e.h&&(e.h.A=e.A.modifyCueCallback));var r=e.h;i=i||e.Ka,e=e.S,"application/cea-608"==t||"application/cea-708"==t?r.i=null:(r.i=Mi.get(t)(),r.i.setSequenceMode?r.i.setSequenceMode(n):ge("Text parsers w/ setSequenceMode",'Text parsers should have a "setSequenceMode" method!'),r.i.setManifestType?r.i.setManifestType(e):ge("Text parsers w/ setManifestType",'Text parsers should have a "setManifestType" method!'),r.B=i)}function Uu(e){return!e.F&&(!e.i||"ended"==e.i.readyState)}function Fu(e){return!e.F&&(!e.i||"closed"==e.i.readyState)}function Bu(e,t){return e.l.size?t==ft?e=e.h.g:(e=Gu(e,t),e=!e||jo(e)?null:1==e.length&&0>e.start(0)?0:e.length?e.start(0):null):e=null,e}function ju(e,t){return e.l.size?t==ft?e.h.h:$o(Gu(e,t)):null}function $u(e,t,n){return t==ft?(e=e.h,null==e.h||e.h<n?0:e.h-Math.max(n,e.g)):(e=Gu(e,t),Vo(e,n))}function Gu(e,t){if(e.F||e.L)return null;try{return e.l.get(t).buffered}catch(n){return e.l.has(t),null}}function Vu(e,t,n,i,r,s){var a=null,o=[],u=Be(n);if(Ei.includes(s))t=su(u),t.length&&i&&((n=t.find(function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description}))&&"number"==typeof n.data&&(a=Math.round(n.data)/1e3),e.N.onMetadata([{cueTime:i.startTime,data:u,frames:t,dts:i.startTime,pts:i.startTime}],0,i.endTime));else if(s.includes("/mp4")&&i&&i.Y&&i.Y.timescale){var l=i.Y.timescale;if(!isNaN(l)){var c=null!=r.emsgSchemeIdUris&&0<r.emsgSchemeIdUris.length||e.A.dispatchAllEmsgBoxes,d=0,h=!1;u=new ks,c&&u.R("emsg",function(t){var n=r.emsgSchemeIdUris;if(0===t.version)var s=t.reader.Uc(),a=t.reader.Uc(),o=t.reader.T(),u=t.reader.T(),l=t.reader.T(),c=t.reader.T(),d=i.startTime+u/o;else o=t.reader.T(),d=t.reader.vd()/o+i.timestampOffset,u=d-i.startTime,l=t.reader.T(),c=t.reader.T(),s=t.reader.Uc(),a=t.reader.Uc();t=t.reader.Sb(t.reader.getLength()-t.reader.Ma()),(n&&n.includes(s)||e.A.dispatchAllEmsgBoxes)&&("urn:mpeg:dash:event:2012"==s?e.N.wk():(n=d+l/o,o={startTime:d,endTime:n,schemeIdUri:s,value:a,timescale:o,presentationTimeDelta:u,eventDuration:l,id:c,messageData:t},c=(new Map).set("detail",o),new Zr("emsg",c).cancelable=!0,e.N.tk(o),("https://aomedia.org/emsg/ID3"==s||"https://developer.apple.com/streaming/emsg-id3"==s)&&(s=su(t),s.length&&e.N.onMetadata([{cueTime:d,data:t,frames:s,dts:d,pts:d}],0,n))))}),u.R("prft",function(t){var n=t.reader,i=t.version;n.T(),t=n.T();var r=n.T();t=1e3*t+r/Math.pow(2,32)*1e3,0===i?n=n.T():(i=n.T(),n=n.T(),n=i*Math.pow(2,32)+n),t=ou(t),n=(new Map).set("detail",{wallClockTime:t,programStartDate:new Date(t-n/l*1e3)}),n=new Zr("prft",n),e.N.onEvent(n)}).box("moof",Ls).box("traf",Ls).R("tfdt",function(e){h||(d=Ka(e.reader,e.version).baseMediaDecodeTime/l,h=!0,c||e.parser.stop())}).parse(n,!0),h&&0==i.timestampOffset&&(a=d)}}else s.includes("/mp4")||s.includes("/webm")||!Iu(u)||(e.$.has(t)?e.$.get(t).clearData():e.$.set(t,new Tu),o=e.$.get(t).parse(u),u=o.getStartTime(t),null!=u&&(a=u),o=o.getMetadata());return{timestamp:a,metadata:o}}function Hu(e,t,n,i,r,s,a,o,u,l,c){var d,h,f,p,g,m,v,y,b,T,S,E,x,I,k,L,R;return a=void 0!==a&&a,o=void 0!==o&&o,u=void 0!==u&&u,l=void 0!==l&&l,U(function(C){switch(C.g){case 1:if(d=pt,t!=d.Ya){C.u(2);break}if("HLS"!=e.S){C.u(3);break}return w(C,e.Ta,4);case 4:h=C.h,e.h.s=h;case 3:return w(C,ki(e.h,n,i?i.startTime:null,i?i.endTime:null,i?i.O()[0]:null),5);case 5:return C.return();case 2:if(l||!e.m){C.u(6);break}return w(C,Hu(e,d.ea,n,i,r,s,a,o,u,!0),7);case 7:return w(C,Hu(e,d.xa,n,i,r,s,a,o,u,!0),8);case 8:return C.return();case 6:if(!e.l.has(t))return C.return();if(f=e.l.get(t).timestampOffset,p=e.C.get(t),e.j.has(t)&&(p=e.j.get(t).getOriginalMimeType()),i&&(g=Vu(e,t,n,i,r,p),m=g.timestamp,v=g.metadata,null!=m&&(null==e.W&&t==d.xa&&(e.W=m,e.va=i.startTime,null!=e.U&&(y=0,e.va==e.oa&&(y=e.W-e.U),e.ka.resolve(y))),null==e.U&&t==d.ea&&(e.U=m,e.oa=i.startTime,null!=e.W&&(b=0,e.va==e.oa&&(b=e.W-e.U),e.ka.resolve(b))),T=m,S=Ei,!e.G&&S.includes(e.C.get(t))&&(T=0),E=i.startTime-T,x=Math.abs(f-E),(.001<=x||a||o)&&(!u||0<E||!f)&&(f=E,e.Za&&(il(e,t,function(){return Zu(e,t)},null),il(e,t,function(){return el(e,t,f)},null))),(t==d.xa||!e.l.has(d.xa))&&e.Ta.resolve(f)),v.length)&&e.N.onMetadata(v,f,i?i.endTime:null),s&&t==d.xa&&(e.h||Nu(e,"application/cea-608",e.G,!1),e.I||(I=p.split(";",1)[0],e.I=new Lt(I)),i?(k=e.I.rf(n),k.length&&Di(e.h,k,i.startTime,i.endTime,f)):e.I.init(n,o,c)),!e.j.has(t)){C.u(9);break}return w(C,e.j.get(t).transmux(n,r,i,e.i.duration,t),10);case 10:n=C.h;case 9:if(n=ul(e,r,n,i,t),!i||!e.G||t==d.Ya){C.u(11);break}if(!a&&!o){C.u(11);break}if(L=i.startTime,"HLS"!=e.S||e.m||t!=d.ea||!e.l.has(d.xa)){C.u(13);break}return w(C,e.ka,14);case 14:R=C.h,.15<Math.abs(R)&&(L-=R);case 13:il(e,t,function(){return Zu(e,t)},null),il(e,t,function(){return el(e,t,L)},null);case 11:return w(C,il(e,t,function(){var i=n;e.M&&yt(e.M,i,f,r),e.l.get(t).appendBuffer(i)},i?i.O()[0]:null),15);case 15:A(C)}})}function Ku(e,t){var n=ju(e,"video")||0;Ri(e.h,t,n)}function Wu(e){e.h&&Ri(e.h,"",0)}function qu(e,t){var n;return U(function(i){return 1==i.g?(n=pt,t==n.Ya?e.h?w(i,e.h.remove(0,1/0),0):i.return():w(i,il(e,t,function(){return Ju(e,t,0,e.i.duration)},null),4)):e.m?w(i,il(e,n.ea,function(){return Ju(e,n.ea,0,e.i.duration)},null),0):i.u(0)})}function Yu(e,t,n,i,r,s,a,o,u){var l,c,d;return U(function(h){return 1==h.g?(l=pt,t==l.Ya?(s||(e.h.s=n),Li(e.h,i,r),h.return()):(c=[],w(h,pl(e,t,a,o,u),2))):(d=h.h,d||(c.push(il(e,t,function(){return Zu(e,t)},null)),e.m&&c.push(il(e,l.ea,function(){return Zu(e,l.ea)},null))),s||(c.push(il(e,t,function(){return el(e,t,n)},null)),e.m&&c.push(il(e,l.ea,function(){return el(e,l.ea,n)},null))),0==i&&1/0==r||(c.push(il(e,t,function(){return tl(e,t,i,r)},null)),e.m&&c.push(il(e,l.ea,function(){return tl(e,l.ea,i,r)},null))),c.length?w(h,Promise.all(c),0):h.u(0))})}function zu(e,t,n){var i,r;return U(function(s){return 1==s.g?(i=pt,t==i.Ya?s.return():(t==i.xa&&(e.Ta=new Kr),!e.G||(r=ju(e,t))&&.1>Math.abs(r-n)?s.return():(il(e,t,function(){return Zu(e,t)},null),e.m&&il(e,i.ea,function(){return Zu(e,i.ea)},null),w(s,il(e,t,function(){return el(e,t,n)},null),2)))):e.m?w(s,il(e,i.ea,function(){return el(e,i.ea,n)},null),0):s.u(0)})}function Xu(e,t,n){U(function(i){return e.H.g||e.g.error||e.L||e.F||Uu(e)||Fu(e)?i.return():w(i,rl(e,function(){Uu(e)||Fu(e)||e.i.setLiveSeekableRange(t,n)}),0)})}function Qu(e){U(function(t){return e.H.g||e.g.error||e.L||e.F||Uu(e)||Fu(e)?t.return():w(t,rl(e,function(){Uu(e)||Fu(e)||e.i.clearLiveSeekableRange()}),0)})}function Ju(e,t,n,i){i<=n?nl(e,t):e.l.get(t).remove(n,i)}function Zu(e,t){var n=e.l.get(t),i=n.appendWindowStart,r=n.appendWindowEnd;n.abort(),n.appendWindowStart=i,n.appendWindowEnd=r,nl(e,t)}function el(e,t,n){0>n&&(n+=.001);var i=!0;"HLS"==e.S&&(i=ju(e,t),i=!i||.15<Math.abs(i-n)),i&&(e.l.get(t).timestampOffset=n),nl(e,t)}function tl(e,t,n,i){var r=e.l.get(t);r.appendWindowEnd===i&&r.appendWindowStart===n||(r.appendWindowStart=0,r.appendWindowEnd=i,r.appendWindowStart=n),nl(e,t)}function nl(e,t){if(e.F||e.H.g){var n=e.o.get(t);n&&n.length&&((n=n[0])&&n.p&&n.p.resolve(),e.o.set(t,[]))}else(n=e.o.get(t)[0])&&(n.p.resolve(),sl(e,t))}function il(e,t,n,i){return bs(e.H),n={start:n,p:new Kr,uri:i},e.o.get(t).push(n),1==e.o.get(t).length&&al(e,t),n.p}function rl(e,t){var n,i,r,s,a,o,u,l,c,h,f,p,g;return U(function(m){switch(m.g){case 1:for(bs(e.H),n=[],i=Array.from(e.l.keys()),r=d(i),s=r.next(),a={};!s.done;a={ready:void 0},s=r.next())o=s.value,a.ready=new Kr,u={start:function(e){return function(){return e.ready.resolve()}}(a),p:a.ready,uri:null},l=e.o.get(o),l.push(u),n.push(a.ready),1==l.length&&u.start();return x(m,2),w(m,Promise.all(n),4);case 4:k(m,3);break;case 2:throw c=L(m),c;case 3:return x(m,5,6),w(m,t(),6);case 6:for(R(m),h=d(i),f=h.next();!f.done;f=h.next())p=f.value,sl(e,p);C(m,0);break;case 5:throw g=L(m),new Ve(2,3,3015,g,e.g.error||"No error in the media element",null)}})}function sl(e,t){e.o.get(t).shift(),al(e,t)}function al(e,t){var n=e.o.get(t)[0];if(n)try{n.start()}catch(i){"QuotaExceededError"==i.name?n.p.reject(new Ve(2,3,3017,t)):Ou(e)?n.p.reject(new Ve(2,3,3015,i,e.g.error||"No error in the media element",n.uri)):n.p.reject(new Ve(2,3,3024,t)),sl(e,t)}}function ol(e,t){e.ia=t,e.h&&(e.h.j=t)}function ul(e,t,n,i,r){if("mp4"!=gi(e.C.get(r)))return n;var s=null===i,a=e.Xa.get(r),o=e.N.Cj(),u=!1;i&&i.Y&&(u=i.Y.encrypted),i=i?i.O()[0]:null;var l=ce();return e.A.correctEc3Enca&&s&&"audio"===r&&(n=ko(n)),e.A.insertFakeEncryptionInInit&&a&&l.ce(o,r)&&(s?n=Lo(t,n,i):!u&&l.zi(r)&&(n=Ro(n))),s&&l.be()&&(n=Po(n)),n}function ll(e,t,n,i){return il(e,t,function(){if(t!==ft){if(e.C.get(t),Et()){e.j.has(t)&&(e.j.get(t).destroy(),e.j.delete(t)),i&&e.j.set(t,i);var r=n+e.A.addExtraFeaturesToSourceBuffer(n);e.l.get(t).changeType(r),e.C.set(t,n)}nl(e,t)}},null)}function cl(e,t){var n,i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E;return U(function(A){if(1==A.g){if(e.F||e.L)return A.return();for(n=pt,e.F=!0,e.m=!1,i=e.g.currentTime,r=e.g.autoplay,e.g.paused||(e.Oa=!0),e.eb&&(e.g.autoplay=!1),I(A,2),e.s.Qa(),s=d(e.j.values()),a=s.next();!a.done;a=s.next())o=a.value,o.destroy();for(u=d(e.l.values()),l=u.next();!l.done;l=u.next()){c=l.value;try{e.i.removeSourceBuffer(c)}catch(x){}}return e.j.clear(),e.l.clear(),h=e.i.duration,e.K=new Kr,e.i=Cu(e,e.K),w(A,e.K,4)}if(2!=A.g){for(!isNaN(h)&&h?e.i.duration=h:!isNaN(e.wa)&&e.wa&&(e.i.duration=e.wa),f=new Kr,p=e.i.sourceBuffers,g=t.size,m=0,v=function(){m++,m===g&&(f.resolve(),e.s.Ja(p,"addsourcebuffer",v))},e.s.D(p,"addsourcebuffer",v),y=d(t.keys()),b=y.next();!b.done;b=y.next())T=b.value,S=t.get(T),_u(e,T,S,S.codecs);return(E=t.get(n.ea))&&E.isAudioMuxedInVideo&&(e.m=!0),e.m&&!e.o.has(n.ea)&&e.o.set(n.ea,[]),e.g.currentTime=i,w(A,f,2)}return R(A),e.F=!1,bs(e.H),e.s.za(e.g,"canplaythrough",function(){e.H.g||(e.g.autoplay=r,e.Oa&&(e.Oa=!1,e.g.play()))}),C(A,0)})}function dl(e,t){return rl(e,function(){return cl(e,t)})}function hl(e,t,n,i){var r=!1,s=dt("audio",(i||"").split(",")),a=dt("video",(i||"").split(",")),o=a;"audio"==t&&(o=s),o||(o=i),i=hi(n,o);var u=yi(e.C.get(t)),l=e.A.forceTransmux;if(!St(i)||!e.G&&Ei.includes(i)?l=!0:l||n==u||(l="WEBKIT"===ce().Da()&&Ei.includes(n)),l&&(e=fi(n,o),n=si(e))){var c=n();s&&a&&(r=!0),i=c.convertCodecs(t,e)}return t=mi(bi(i)),{cc:c,Vk:r,Gh:yi(i),codec:t,mimeType:i}}function fl(e,t,n,i,r){if(t==ft)return{type:yl,kf:n,cc:null};var s=mi(bi(e.C.get(t))),a=yi(e.C.get(t)),o=hl(e,t,n,i),u=o.cc,l=o.Vk,c=o.Gh,d=o.codec;o=o.mimeType;var h=!0;return l&&e.C.has("audio")&&(n=hl(e,"audio",n,i),i=mi(bi(e.C.get("audio"))),h=yi(e.C.get("audio")),h=i==n.codec&&h==n.Gh,n.cc&&n.cc.destroy()),s===d&&a===c&&h?{type:yl,kf:o,cc:u}:(s=!0,(e.m&&!r.has("audio")||l&&u&&!e.j.has(t))&&(s=!1),s&&"smooth"===e.A.codecSwitchingStrategy&&Et()?{type:Tl,kf:o,cc:u}:(u&&u.destroy(),{type:bl,kf:o,cc:null}))}function pl(e,t,n,i,r){var s,a,o,u,l,c;return U(function(d){return 1==d.g?(s=pt,a=fl(e,t,n,i,r),o=a.type,u=a.cc,l=a.kf,(c=r.get(s.ea))&&(e.m=c.isAudioMuxedInVideo),o==yl?(e.j.has(t)&&!u?(e.j.get(t).destroy(),e.j.delete(t)):!e.j.has(t)&&u?e.j.set(t,u):u&&(e.j.has(t)&&e.j.get(t).transmux!==u.transmux?(e.j.get(t).destroy(),e.j.set(t,u)):u.destroy()),d.return(!1)):o==Tl?w(d,ll(e,t,l,u),3):o!=bl?d.u(3):(u&&u.destroy(),w(d,dl(e,r),3))):d.return(!0)})}function gl(e,t,n,i,r){return e=fl(e,t,n,i,r),e.cc&&e.cc.destroy(),e.type==bl}i=Ru.prototype,i.destroy=function(){return this.H.destroy()},i.init=function(e,t,n,i){t=void 0!==t&&t,n=void 0===n?"UNKNOWN":n,i=void 0!==i&&i;var r,s,a,o,u,l,c=this;return U(function(h){if(1==h.g)return r=pt,w(h,c.K,2);if(3!=h.g)return Uu(c)||Fu(c)?(X("Expected MediaSource to be open during init(); reopening the media source."),c.K=new Kr,c.i=Cu(c,c.K),w(h,c.K,3)):h.u(3);for(c.G=t,c.S=n,c.ab=i,c.Za=!c.G&&"HLS"==c.S&&!c.ab,c.$.clear(),c.W=null,c.va=null,c.U=null,c.oa=null,c.ka=new Kr,s=d(e.keys()),a=s.next();!a.done;a=s.next())o=a.value,u=e.get(o),_u(c,o,u,u.codecs),c.m?(c.o.set(r.ea,[]),c.o.set(r.xa,[])):c.o.set(o,[]);(l=e.get(r.ea))&&l.isAudioMuxedInVideo&&(c.m=!0),A(h)})},i.configure=function(e){this.A=e,this.h&&(this.h.A=e.modifyCueCallback)},i.Lb=function(){var e={total:this.F?[]:Ko(this.g.buffered),audio:Ko(Gu(this,"audio")),video:Ko(Gu(this,"video")),text:[]};if(this.h){var t=this.h.g,n=this.h.h;null!=t&&null!=n&&e.text.push({start:t,end:n})}return e},i.remove=function(e,t,n,i){var r,s=this;return U(function(a){return 1==a.g?(r=pt,e==r.xa&&s.I&&s.I.remove(i),e==r.Ya?w(a,s.h.remove(t,n),0):n>t?w(a,il(s,e,function(){return Ju(s,e,t,n)},null),5):a.u(0)):s.m?w(a,il(s,r.ea,function(){return Ju(s,r.ea,t,n)},null),0):a.u(0)})},i.flush=function(e){var t,n=this;return U(function(i){return 1==i.g?(t=pt,e==t.Ya?i.return():w(i,il(n,e,function(){n.g.currentTime-=.001,nl(n,e)},null),2)):n.m?w(i,il(n,t.ea,function(){var e=t.ea;n.g.currentTime-=.001,nl(n,e)},null),0):i.u(0)})},i.endOfStream=function(e){var t=this;return U(function(n){return w(n,rl(t,function(){Uu(t)||Fu(t)||(e?t.i.endOfStream(e):t.i.endOfStream())}),0)})},i.ob=function(e){var t=this;return U(function(n){return w(n,rl(t,function(){if(t.A.durationReductionEmitsUpdateEnd&&e<t.i.duration)for(var n=d(t.l.keys()),i=n.next();!i.done;i=n.next()){i=i.value;var r={start:function(){},p:new Kr,uri:null};t.o.get(i).unshift(r)}t.i.duration=e,t.wa=e}),0)})},i.getDuration=function(){return this.i.duration};var ml=e.URL.createObjectURL,vl="sequence",yl="none",bl="reset",Tl="changeType";function Sl(e,t,n){this.i=e,this.C=t,this.s=this.l=1/0,this.h=1,this.g=this.j=null,this.A=0,this.B=!0,this.I=!1,this.H=0,this.F=void 0===n||n,this.G=0,this.o=!1,this.m=e}function El(e,t,n,i){var r=this;this.s=i,this.g=e,this.B=t,this.h=n,this.o=new re,this.l=!1,this.F=e.readyState,this.G=this.C=this.j=0,this.m=Al(this),this.A=!1,this.o.D(e,"waiting",function(){return wl(r)}),this.i=new _i(function(){wl(r)}).Ga(this.h.gapJumpTimerTime)}function wl(e){if(0!=e.g.readyState){if(e.g.seeking){if(!e.l)return}else e.l=!1;if(!e.g.paused||e.g.currentTime==e.j&&(e.g.autoplay||e.g.currentTime!=e.j)){var t;if(e.g.readyState!=e.F&&(e.F=e.g.readyState),!(t=!e.m)){t=e.m;var n=t.h,i=kl(n),r=n.g.currentTime,s=Date.now()/1e3;t.g==r&&t.m==i||(t.l=s,t.g=r,t.m=i,t.i=!1),r=s-t.l,(i=r>=t.o&&i&&!t.i)&&(t.j&&t.j(t.g,r),t.i=!0,t.g=n.g.currentTime),t=!i}t&&(t=e.g.currentTime,n=e.g.buffered,i=Ho(n,t,e.h.gapDetectionThreshold),null==i||0==i&&!e.A||(r=n.start(i),(s=e.h.gapPadding)&&(r=Math.ceil(100*(r+s))/100),r>=e.B.Eb()||.001>r-t||(0!=i&&n.end(i-1),e.g.currentTime=r,t==e.j&&(e.j=r),e.C++,e.s(new Zr("gapjumped")))))}}}function Al(e){if(!e.h.stallEnabled)return null;var t=e.h.stallThreshold,n=e.h.stallSkip;return new xl(new Il(e.g),t,function(){var t;return U(function(i){if(1==i.g)return t=Ko(e.g.buffered),t.length?n?(e.g.currentTime+=n,i.u(2)):w(i,e.g.play(),3):i.return();if(2!=i.g){if(!e.g)return i.return();e.g.pause(),e.g.play()}e.G++,e.s(new Zr("stalldetected")),A(i)})})}function xl(e,t,n){this.h=e,this.m=kl(e),this.g=e.g.currentTime,this.l=Date.now()/1e3,this.i=!1,this.o=t,this.j=n}function Il(e){var t=this;this.g=e,this.h=new re,this.i=!1,this.h.D(this.g,"audiofocuspaused",function(){t.i=!0}),this.h.D(this.g,"audiofocusgranted",function(){t.i=!1}),this.h.D(this.g,"audiofocuslost",function(){t.i=!0})}function kl(e){if(e.g.paused||0==e.g.playbackRate||e.i||0==e.g.buffered.length)var t=!1;else e:{t=e.g.currentTime,e=d(Ko(e.g.buffered));for(var n=e.next();!n.done;n=e.next())if(n=n.value,!(t<n.start-.1||t>n.end-.5)){t=!0;break e}t=!1}return t}function Ll(e,t,n,i){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?i():(t=Rl.value().get(t),n.za(e,t,i))}i=Sl.prototype,i.getDuration=function(){return this.l},i.Fj=function(){return this.h},i.Ji=function(e){this.i=e},i.ob=function(e){this.l=e},i.Lj=function(){return this.i},i.Ii=function(e){this.A=e},i.Yc=function(e){e&&!this.B&&(this.I=!0),this.B=e},i.Cf=function(e){this.s=e},i.Ue=function(){return this.s},i.gh=function(e){this.C=e},i.wj=function(){return this.C},i.pi=function(e,t){if(0!=e.length){var n=(Date.now()+this.A)/1e3;if(e=e.filter(function(e){return e.start+t<n}),0!=e.length){var i=e[e.length-1].end+t;this.lf(e[0].start+t),this.h=e.reduce(function(e,t){return Math.max(e,t.end-t.start)},this.h),this.g=Math.max(this.g,i),null!=this.i&&this.F&&!this.o&&(this.i=n-this.g-this.h)}}},i.Yd=function(e){if(0!=e.length){var t=e[0].startTime,n=e[0].endTime,i=(Date.now()+this.A)/1e3;e=d(e);for(var r=e.next();!r.done;r=e.next())r=r.value,i<r.startTime||(t=Math.min(t,r.startTime),n=Math.max(n,r.endTime),this.h=Math.max(this.h,r.endTime-r.startTime));this.lf(t),this.g=Math.max(this.g,n),null!=this.i&&this.F&&!this.o&&(this.i=i-this.g-this.h)}},i.oi=function(e,t){this.lf(e),1/0==t||this.V()||(this.g=Math.max(this.g,t))},i.Gj=function(){return this.g},i.df=function(){this.o=!0},i.gk=function(){return this.o},i.hh=function(e){this.m=e},i.Bj=function(){return this.m},i.lf=function(e){null==this.j?this.j=e:this.I||(this.j=Math.min(this.j,e))},i.Mg=function(e){this.h=Math.max(this.h,e)},i.offset=function(e){null!=this.j&&(this.j+=e),null!=this.g&&(this.g+=e)},i.V=function(){return 1/0==this.l&&!this.B},i.Sc=function(){return 1/0!=this.l&&!this.B},i.Fb=function(){return Math.max(this.H,this.yc()-this.s)},i.Li=function(e){this.H=e},i.yc=function(){return this.V()||this.Sc()?Math.min(Math.max(0,(Date.now()+this.A)/1e3-this.h-this.i)+this.G,this.l):this.g?Math.min(this.g,this.l):this.l},i.Od=function(e){var t=Math.max(this.j,this.H);return 1/0==this.s?Math.ceil(1e3*t)/1e3:Math.max(t,Math.min(this.yc()-this.s+e,this.Eb()))},i.Vb=function(){return this.Od(0)},i.Eb=function(){return Math.max(0,this.yc()-(this.V()||this.Sc()?this.C:0))},i.Xi=function(){return!(null==this.i||null!=this.g&&this.F)},i.Hi=function(e){this.G=e},i.rj=function(){return this.G},K("shaka.media.PresentationTimeline",Sl),Sl.prototype.getAvailabilityTimeOffset=Sl.prototype.rj,Sl.prototype.setAvailabilityTimeOffset=Sl.prototype.Hi,Sl.prototype.usingPresentationStartTime=Sl.prototype.Xi,Sl.prototype.getSeekRangeEnd=Sl.prototype.Eb,Sl.prototype.getSeekRangeStart=Sl.prototype.Vb,Sl.prototype.getSafeSeekRangeStart=Sl.prototype.Od,Sl.prototype.getSegmentAvailabilityEnd=Sl.prototype.yc,Sl.prototype.setUserSeekStart=Sl.prototype.Li,Sl.prototype.getSegmentAvailabilityStart=Sl.prototype.Fb,Sl.prototype.isInProgress=Sl.prototype.Sc,Sl.prototype.isLive=Sl.prototype.V,Sl.prototype.offset=Sl.prototype.offset,Sl.prototype.notifyMaxSegmentDuration=Sl.prototype.Mg,Sl.prototype.notifyMinSegmentStartTime=Sl.prototype.lf,Sl.prototype.getInitialProgramDateTime=Sl.prototype.Bj,Sl.prototype.setInitialProgramDateTime=Sl.prototype.hh,Sl.prototype.isStartTimeLocked=Sl.prototype.gk,Sl.prototype.lockStartTime=Sl.prototype.df,Sl.prototype.getMaxSegmentEndTime=Sl.prototype.Gj,Sl.prototype.notifyPeriodDuration=Sl.prototype.oi,Sl.prototype.notifySegments=Sl.prototype.Yd,Sl.prototype.notifyTimeRange=Sl.prototype.pi,Sl.prototype.getDelay=Sl.prototype.wj,Sl.prototype.setDelay=Sl.prototype.gh,Sl.prototype.getSegmentAvailabilityDuration=Sl.prototype.Ue,Sl.prototype.setSegmentAvailabilityDuration=Sl.prototype.Cf,Sl.prototype.setStatic=Sl.prototype.Yc,Sl.prototype.setClockOffset=Sl.prototype.Ii,Sl.prototype.getPresentationStartTime=Sl.prototype.Lj,Sl.prototype.setDuration=Sl.prototype.ob,Sl.prototype.setPresentationStartTime=Sl.prototype.Ji,Sl.prototype.getMaxSegmentDuration=Sl.prototype.Fj,Sl.prototype.getDuration=Sl.prototype.getDuration,El.prototype.release=function(){this.o&&(this.o.release(),this.o=null),null!=this.i&&(this.i.stop(),this.i=null),this.m&&(this.m.release(),this.m=null),this.g=this.B=this.s=null},El.prototype.pf=function(){this.A=!0,this.i&&this.i.Ga(this.h.gapJumpTimerTime),wl(this)},xl.prototype.release=function(){this.h&&this.h.release(),this.j=this.h=null},Il.prototype.release=function(){this.h&&this.h.release(),this.h=null};var Rl=new le(function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])});function Cl(e,t,n,i){var r=this;this.g=e,this.m=t,this.s=n,this.l=null,this.j=function(){return null==r.l&&(r.l=i()),r.l},this.o=!1,this.h=new re,this.i=new Ol(e),Ll(this.g,HTMLMediaElement.HAVE_METADATA,this.h,function(){Pl(r,r.j())})}function Dl(e){return e.o?e.g.currentTime:e.j()}function Ml(e,t){0<e.g.readyState?Nl(e.i,t):Ll(e.g,HTMLMediaElement.HAVE_METADATA,e.h,function(){Pl(e,e.j())})}function Pl(e,t){.001>Math.abs(e.g.currentTime-t)?_l(e):(e.h.za(e.g,"seeking",function(){_l(e)}),Nl(e.i,e.g.currentTime&&0!=e.g.currentTime?e.g.currentTime:t))}function _l(e){e.o=!0,e.h.D(e.g,"seeking",function(){return e.m()}),e.s(e.g.currentTime)}function Ol(e){var t=this;this.g=e,this.m=10,this.j=this.l=this.i=0,this.h=new _i(function(){0>=t.i||t.g.currentTime!=t.l||t.g.currentTime===t.j?t.h.stop():(t.g.currentTime=t.j,t.i--)})}function Nl(e,t){e.l=e.g.currentTime,e.j=t,e.i=e.m,e.g.currentTime=t,e.h.Ga(.1)}function Ul(e){this.g=e,this.i=!1,this.h=null,this.j=new re}function Fl(e){return e.g.getStartDate&&(e=e.g.getStartDate().getTime(),!isNaN(e))?e/1e3:null}function Bl(e,t){return e=e.g.seekable,0<e.length&&(t=Math.max(e.start(0),t),t=Math.min(e.end(e.length-1),t)),t}function jl(e,t,n,i,r,s){var a=this;this.h=e,this.g=t.presentationTimeline,this.l=n,this.s=r,this.o=null,this.j=new El(e,t.presentationTimeline,n,s),this.i=new Cl(e,function(){e:{var e=a.j;e.l=!0,e.A=!1,e.i&&e.i.Ga(e.h.gapJumpTimerTime),wl(e);var t=Dl(a.i);if(e=Vl(a,t),!wt()&&.001<Math.abs(e-t)){t=!1;var n=ce().Ei();if(n){var i=Date.now()/1e3;(!a.o||a.o<i-n)&&(a.o=i,t=!0)}else t=!0;if(t){Ml(a.i,e),e=void 0;break e}}a.s(),e=void 0}return e},function(e){var t=a.j;t.g.seeking&&!t.l&&(t.l=!0,t.j=e),t.i&&t.i.Ga(t.h.gapJumpTimerTime),wl(t)},function(){return $l(a,i)}),this.m=new _i(function(){if(0!=a.h.readyState&&!a.h.paused){var e=Dl(a.i),t=a.g.Vb(),n=a.g.Eb();3>n-t&&(t=n-3),e<t&&(e=Vl(a,e),a.h.currentTime=e)}})}function $l(e,t){return null==t?t=1/0>e.g.getDuration()?e.g.Vb():e.g.Eb():t instanceof Date?t=t.getTime()/1e3-(e.g.m||e.g.i):0>t&&(t=e.g.Eb()+t),Gl(e,Hl(e,t))}function Gl(e,t){var n=e.g.getDuration();return t>=n?n-e.l.durationBackoff:t}function Vl(e,t){var n=e.l.rebufferingGoal,i=e.l.safeSeekOffset,r=e.g.Vb(),s=e.g.Eb(),a=e.g.getDuration();3>s-r&&(r=s-3);var o=e.g.Od(n),u=e.g.Od(i);return n=e.g.Od(n+i),t>=a?Gl(e,t):t>s?s-e.l.safeSeekEndOffset:t<r?e.g.V()&&e.l.returnToEndOfLiveWindowWhenOutside?s-e.l.safeSeekEndOffset:Go(e.h.buffered,u)?u:n:t>=o||Go(e.h.buffered,t)?t:n}function Hl(e,t){var n=e.g.Vb();return t<n?n:(e=e.g.Eb(),t>e?e:t)}function Kl(e){this.g=e,this.m=null,this.i=0,this.o=!1}function Wl(e){return e.g[0]||null}function ql(e,t,n){return e=new No(e,e+t,function(){return n},0,null,null,e,e,e+t),new Kl([e])}function Yl(e,t,n,i){this.i=e,this.h=t,this.g=n,this.reverse=i}function zl(){Kl.call(this,[]),this.h=[]}function Xl(e,t){e=d(e.h);for(var n=e.next();!n.done;n=e.next())t(n.value)}function Ql(e,t){e=d(e.h);for(var n=e.next();!n.done;n=e.next())if(n=n.value,null!=n.find(t))return n.Ne();return-1}function Jl(e){var t=this;this.g=e,this.j=!1,this.i=this.g.Te(),this.h=new _i(function(){t.g.li(.25*t.i)})}function Zl(e){e.h.stop();var t=e.j?0:e.i;if(0<=t)try{return void(e.g.Te()!=t&&e.g.ih(t))}catch(n){}e.h.Ga(.25),0!=e.g.Te()&&e.g.ih(0)}function ec(e){var t=this;this.j=e,this.h=new re,this.g=new Set,this.i=new _i(function(){tc(t,!1)}).Hb(),e.paused||this.i.Ga(.25),this.h.D(e,"playing",function(){t.i.Hb().Ga(.25)}),this.h.D(e,"pause",function(){t.i.stop()})}function tc(e,t){var n=e.j.currentTime;e=d(e.g);for(var i=e.next();!i.done;i=e.next())i.value.j(n,t)}function nc(e){ns.call(this),this.g=new Map,this.h=e}function ic(e,t){var n=e.g.get(t);return n||(n={ae:[],gg:null,contentType:t},e.g.set(t,n)),n}function rc(e,t,n){var i=ic(e,t.contentType);ac(e,i),e={od:t,position:n},i=i.ae,t=i.findIndex(function(e){return e.position>=n}),0<=t?i.splice(t,i[t].position==n?1:0,e):i.push(e)}function sc(e,t,n){return!!((e=e.h()[n])&&0<e.length&&(n=e[e.length-1].end,t>=e[0].start&&t<n))}function ac(e,t){if((e=e.h()[t.contentType])&&0<e.length){var n=e[0].start,i=e[e.length-1].end,r=t.ae;t.ae=r.filter(function(e,t){return!(e.position<=n&&t+1<r.length&&r[t+1].position<=n||e.position>=i)})}else t.ae=[]}function oc(e){var t={bandwidth:e.bandwidth||0,audioSamplingRate:null,codecs:e.codecs,contentType:e.type,frameRate:null,height:null,mimeType:e.mimeType,channelsCount:null,pixelAspectRatio:null,width:null,label:null,roles:e.roles,language:null};return"video"==e.type&&(t.frameRate=e.frameRate||null,t.height=e.height||null,t.pixelAspectRatio=e.pixelAspectRatio||null,t.width=e.width||null),"audio"==e.type&&(t.audioSamplingRate=e.audioSamplingRate,t.channelsCount=e.channelsCount,t.label=e.label||null,t.language=e.language),t}function uc(e){ns.call(this),this.h=new Map,this.i=e,this.g=null}function lc(e,t){var n=t.schemeIdUri+"_"+t.id+"_"+t.startTime.toFixed(1)+"_"+t.endTime.toFixed(1);e.h.has(n)||(e.h.set(n,t),t=new Zr("regionadd",new Map([["region",t]])),e.dispatchEvent(t),cc(e))}function cc(e){e.g||(e.g=new _i(function(){for(var t=e.i(),n=d(e.h),i=n.next();!i.done;i=n.next()){var r=d(i.value);i=r.next().value,r=r.next().value,r.endTime<t.start&&(e.h.delete(i),i=new Zr("regionremove",new Map([["region",r]])),e.dispatchEvent(i))}!e.h.size&&e.g&&(e.g.stop(),e.g=null)}).Ga(2))}function dc(e,t,n,i){this.m=e,this.i=t,this.l=n,this.h=new Map,this.j=new Map,this.g=null,this.o=i}function hc(e,t){e.l=t,e=d(e.h.values());for(var n=e.next();!n.done;n=e.next())n.value.g=t}function fc(e,t,n){if(n=void 0!==n&&n,!e.i.segmentIndex)return Promise.resolve();if(e.g||(e.g=e.i.segmentIndex.Ub(t,!0,e.o)),!e.g)return Promise.resolve();for(n&&e.g.next(),t=[];e.h.size<e.m;){if(n=e.g.next().value,!n)break;var i=!0;n.isPreload()&&null!=n.endByte&&(i=!1),2==n.Ac()&&(i=!1),n.Wb(!1)&&(i=!1),i&&n.Y&&t.push(pc(e,n.Y)),i&&!e.h.has(n)&&(i=new Sc(e.l),t.push(Ec(i,n,e.i)),e.h.set(n,i))}return vc(e),Promise.all(t)}function pc(e,t){if(!e.i.segmentIndex||t.Wb()||Array.from(e.j.keys()).some(function(e){return Oo(e,t)}))return Promise.resolve();var n=new Sc(e.l),i=Ec(n,t,e.i);return e.j.set(t,n),i}function gc(e,t){t=d(t.keys());for(var n=t.next();!n.done;n=t.next())(n=n.value)&&Tc(e,n)}function mc(e){gc(e,e.h),gc(e,e.j),e.g=null}function vc(e){for(var t=Array.from(e.h.keys()),n=d(e.j.keys()),i=n.next(),r={};!i.done;r={Gg:void 0},i=n.next())r.Gg=i.value,t.some(function(e){return function(t){return Oo(t.Y,e.Gg)}}(r))||Tc(e,r.Gg)}function yc(e,t){e.m=t;for(var n=Array.from(e.h.keys());n.length>t;){var i=n.pop();i&&Tc(e,i)}vc(e)}function bc(e,t){t&&t!==e.i&&(mc(e),e.i=t)}function Tc(e,t){var n=e.h;t instanceof _o&&(n=e.j),e=n.get(t),n.delete(t),e&&e.abort()}function Sc(e){this.g=e,this.Zd=this.nh=null}function Ec(e,t,n){var i=new Uint8Array(0);return e.Zd=e.g(t,n,function(t){return U(function(n){if(1==n.g)return i=0<i.byteLength?at(i,t):t,e.nh?w(n,e.nh(i),3):n.u(0);i=new Uint8Array(0),A(n)})}),e.Zd.promise.catch(function(e){return e instanceof Ve&&7001==e.code?Promise.resolve():Promise.reject(e)})}function wc(e){var t=yi(e),n=t.split("/")[0];return e=bi(e),{type:n,mimeType:t,codecs:e,language:null,height:null,width:null,channelCount:null,sampleRate:null,closedCaptions:new Map,le:null,colorGamut:null,frameRate:null}}function Ac(e,t,n){function i(e){a=e.name;var t=e.reader;t.skip(24);var n=t.Aa(),i=t.Aa();t.skip(50),p=String(n),f=String(i),e.reader.Fa()&&Ls(e)}function r(e){var t=Ya(e.reader);g=t.channelCount,m=t.sampleRate,s(e.name)}function s(e){switch(e=e.toLowerCase(),e){case"avc1":case"avc3":u.push(e+".42E01E"),c=!0;break;case"hev1":case"hvc1":u.push(e+".1.6.L93.90"),c=!0;break;case"dvh1":case"dvhe":u.push(e+".05.04"),c=!0;break;case"vp09":u.push(e+".00.10.08"),c=!0;break;case"av01":u.push(e+".0.01M.08"),c=!0;break;case"mp4a":o.push("mp4a.40.2"),l=!0;break;case"ac-3":case"ec-3":case"ac-4":case"opus":case"flac":o.push(e),l=!0;break;case"apac":o.push("apac.31.00"),l=!0}}var a,o=[],u=[],l=!1,c=!1,h=null,f=null,p=null,g=null,m=null,v=null,y=null;if((new ks).box("moov",Ls).box("trak",Ls).box("mdia",Ls).R("mdhd",function(e){h=Wa(e.reader,e.version).language}).box("minf",Ls).box("stbl",Ls).R("stsd",Rs).box("mp4a",function(e){var t=Ya(e.reader);g=t.channelCount,m=t.sampleRate,e.reader.Fa()?Ls(e):s(e.name)}).box("esds",function(e){e=e.reader;for(var t,n,i="mp4a";e.Fa();){t=e.X();for(var r=e.X();128&r;)r=e.X();if(3==t)e.Aa(),r=e.X(),128&r&&e.Aa(),64&r&&e.skip(e.X()),32&r&&e.Aa();else if(4==t)n=e.X(),e.skip(12);else if(5==t)break}n&&(i+="."+Qa(n),5==t&&e.Fa()&&(t=e.X(),n=(248&t)>>3,31===n&&e.Fa()&&(n=32+((7&t)<<3)+((224&e.X())>>5)),i+="."+n)),o.push(i),l=!0}).box("ac-3",r).box("ec-3",r).box("ac-4",r).box("Opus",r).box("fLaC",r).box("apac",r).box("avc1",i).box("avc3",i).box("hev1",i).box("hvc1",i).box("dva1",i).box("dvav",i).box("dvh1",i).box("dvhe",i).box("vp09",i).box("av01",i).box("avcC",function(e){var t=a||"";switch(a){case"dvav":t="avc3";break;case"dva1":t="avc1"}e=e.reader,e.skip(1),e=t+"."+Qa(e.X())+Qa(e.X())+Qa(e.X()),u.push(e),c=!0}).box("hvcC",function(e){var t=a||"";switch(a){case"dvh1":t="hvc1";break;case"dvhe":t="hev1"}var n=e.reader;n.skip(1),e=n.X();var i=["","A","B","C"][e>>6],r=31&e,s=n.T(),o=(32&e)>>5?"H":"L";e=[n.X(),n.X(),n.X(),n.X(),n.X(),n.X()],n=n.X();for(var l=0,d=0;32>d;d++){if(l|=1&s,31==d)break;l<<=1,s>>=1}for(t=t+"."+i+r+"."+Qa(l,!0),t+="."+o+n,i="",r=e.length;r--;)((o=e[r])||i)&&(i="."+o.toString(16).toUpperCase()+i);t+=i,u.push(t),c=!0}).box("dvcC",function(e){var t=a||"";switch(a){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav";break;case"av01":t="dav1"}var n=e.reader;n.skip(2),e=n.X(),n=n.X(),u.push(t+"."+Ja(e>>1&127)+"."+Ja(e<<5&32|n>>3&31)),c=!0}).box("dvvC",function(e){var t=a||"";switch(a){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav";break;case"av01":t="dav1"}var n=e.reader;n.skip(2),e=n.X(),n=n.X(),u.push(t+"."+Ja(e>>1&127)+"."+Ja(e<<5&32|n>>3&31)),c=!0}).R("vpcC",function(e){var t=a||"",n=e.reader;e=n.X();var i=n.X();n=n.X()>>4&15,u.push(t+"."+Ja(e)+"."+Ja(i)+"."+Ja(n)),c=!0}).box("av1C",function(e){var t=a||"";switch(a){case"dav1":t="av01"}var n=e.reader;n.skip(1),e=n.X(),n=n.X();var i=e>>>5,r=(64&n)>>6;u.push(t+"."+i+"."+Ja(31&e)+(n>>>7?"H":"M")+"."+Ja(2===i&&r?(32&n)>>5?12:10:r?10:8)+"."+((16&n)>>4)+"."+((8&n)>>3)+((4&n)>>2)+(3&n)+"."+Ja(1)+"."+Ja(1)+"."+Ja(1)+".0"),c=!0}).box("enca",Ds).box("encv",Cs).box("sinf",Ls).box("frma",function(e){e=za(e.reader).codec,s(e)}).box("colr",function(e){u=u.map(function(t){if(t.startsWith("av01.")){var n=e.reader,i=n.Ma(),r=n.Sb(4),s=String.fromCharCode(r[0]);if(s+=String.fromCharCode(r[1]),s+=String.fromCharCode(r[2]),s+=String.fromCharCode(r[3]),"nclx"===s){r=n.Aa(),s=n.Aa();var a=n.Aa(),o=n.X()>>7,u=t.split(".");10==u.length&&(u[6]=Ja(r),u[7]=Ja(s),u[8]=Ja(a),u[9]=String(o),t=u.join("."))}n.seek(i)}return t});var t=Xa(e.reader),n=t.colorGamut;v=t.le,y=n}).parse(e||t,!0),!o.length&&!u.length)return null;var b=l&&!c,T=new Map;if(c&&!n){n=new Lt("video/mp4"),e&&n.init(e);try{n.rf(t);for(var S=d(n.Pf()),E=S.next();!E.done;E=S.next()){var w=E.value;T.set(w,w)}}catch(A){}n.Cd()}return{type:b?"audio":"video",mimeType:b?"audio/mp4":"video/mp4",codecs:xc(o.concat(u)).join(", "),language:h,height:f,width:p,channelCount:g,sampleRate:m,closedCaptions:T,le:v,colorGamut:y,frameRate:null}}function xc(e){var t=new Set,n=[];e=d(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;var r=vi(i);t.has(r)||(n.push(i),t.add(r))}return t=ht("audio",n),i=ht("video",n),e=ht(ft,n),i=Ic(i),t=t.concat(i).concat(e),n.length&&!t.length?n:t}function Ic(e){if(1>=e.length)return e;var t=e.find(function(e){return e.startsWith("dvav.")||e.startsWith("dva1.")||e.startsWith("dvh1.")||e.startsWith("dvhe.")||e.startsWith("dav1.")||e.startsWith("dvc1.")||e.startsWith("dvi1.")});return t?St('video/mp4; codecs="'+t+'"')?[t]:e.filter(function(e){return e!=t}):e}function kc(e){var t=null;return(new ks).box("moov",Ls).box("trak",Ls).box("mdia",Ls).box("minf",Ls).box("stbl",Ls).R("stsd",Rs).box("encv",Cs).box("enca",Ds).box("sinf",Ls).box("schi",Ls).R("tenc",function(e){e=e.reader,e.X(),e.X(),e.X(),e.X(),t=st(e.Sb(16))}).parse(e,!0),t}function Lc(t,n,i){var r,s,a,o,u;return U(function(l){if(1==l.g)return r=n,r.cryptoKey?l.u(2):w(l,r.fetchKey(),3);if(s=r.iv,!s)for(s=Be(new ArrayBuffer(16)),a=r.firstMediaSequenceNumber+i,o=s.byteLength-1;0<=o;o--)s[o]=255&a,a>>=8;return u="CBC"==n.blockCipherMode?{name:"AES-CBC",iv:s}:{name:"AES-CTR",counter:s,length:64},l.return(e.crypto.subtle.decrypt(u,r.cryptoKey,t))})}function Rc(e,t,n,i,r){return e=us(e,i,r),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function Cc(e,t){var n=this;this.g=t,this.j=e,this.i=null,this.K=new Map,this.C=1,this.A=this.o=null,this.P=0,this.h=new Map,this.I=!1,this.S=null,this.B=!1,this.l=new ys(function(){return Dc(n)}),this.M=Date.now()/1e3,this.m=new Map,this.N={projection:null,hfov:null},this.W=0,this.U=1/0,this.F=null,this.L=[],this.s=new _i(function(){if(n.j&&n.g)if(n.j.presentationTimeline.V()){var e=n.j.presentationTimeline.Vb(),t=n.j.presentationTimeline.Eb();1<t-e?Xu(n.g.Z,e,t):Qu(n.g.Z)}else Qu(n.g.Z),n.s&&n.s.stop();else n.s&&n.s.stop()}),this.G=null,this.H=new _i(function(){var e=n.g.video;!e.ended&&n.G&&(e.currentTime=n.G,n.G=null)})}function Dc(e){var t,n,i,r,s,a,o;return U(function(u){if(1==u.g){for(e.s&&e.s.stop(),e.s=null,e.H&&e.H.stop(),e.H=null,t=[],n=d(e.h.values()),i=n.next();!i.done;i=n.next())r=i.value,ud(r),t.push(ld(r)),r.aa&&(mc(r.aa),r.aa=null);for(s=d(e.m.values()),a=s.next();!a.done;a=s.next())o=a.value,mc(o);return w(u,Promise.all(t),2)}e.h.clear(),e.m.clear(),e.g=null,e.j=null,e.i=null,e.G=null,A(u)})}function Mc(e,t,n){e.j.presentationTimeline.V()||(e.W=t,e.U=n)}function Pc(e,t){var n,i,r,s,a,o;U(function(u){switch(u.g){case 1:return n=pt,e.P++,i=e.P,x(u,2),w(u,qu(e.g.Z,n.Ya),4);case 4:k(u,3);break;case 2:r=L(u),e.g&&e.g.onError(r);case 3:s=hi(t.mimeType,t.codecs),Nu(e.g.Z,s,e.j.sequenceMode,t.external),a=e.g.Z.ia,(a.isTextVisible()||e.i.alwaysStreamText)&&e.P==i&&(o=Hc(e,t),e.h.set(n.Ya,o),od(e,o,0)),A(u)}})}function _c(e){var t=e.h.get(ft);t&&(ud(t),ld(t).catch(function(){}),e.F=e.h.get(ft),e.h.delete(ft)),e.A=null}function Oc(e,t){for(var n=0>e.g.sb(),i=d(e.h.values()),r=i.next();!r.done;r=i.next())r=r.value,r.sa&&r.sa.zd(n),r.aa&&r.aa.zd(n);for(i=d(e.m.values()),r=i.next();!r.done;r=i.next())r.value.zd(n);(n=e.h.get("video"))&&(i=n.stream)&&(t?(t=i.trickModeVideo)&&!n.Ec&&(jc(e,t,!1,0,!1),n.Ec=i):(t=n.Ec)&&(n.Ec=null,jc(e,t,!0,0,!1)))}function Nc(e,t,n,i,r,s){n=void 0!==n&&n,i=void 0===i?0:i,r=void 0!==r&&r,s=void 0!==s&&s,e.o=t,e.I&&(t.video&&jc(e,t.video,n,i,r,s),t.audio&&jc(e,t.audio,n,i,r,s))}function Uc(e,t){U(function(n){if(1==n.g)return e.F=null,e.A=t,e.I?t.segmentIndex?n.u(2):w(n,t.createSegmentIndex(),2):n.return();jc(e,t,!0,0,!1),A(n)})}function Fc(e){var t=e.h.get(ft);t&&jc(e,t.stream,!0,0,!0)}function Bc(e,t){for(var n=d(e.K.entries()),i=n.next();!i.done;i=n.next()){var r=d(i.value);i=r.next().value,r=r.next().value,i.includes(t.type)&&(r(),e.K.delete(i))}}function jc(e,t,n,i,r,s){var a=e.h.get(t.type);a||t.type!=ft?a&&(a.Ec&&(t.trickModeVideo?(a.Ec=t,t=t.trickModeVideo):a.Ec=null),a.stream!=t||r)&&(e.m.has(t)?a.aa=e.m.get(t):a.aa&&bc(a.aa,t),t.type==ft&&(r=hi(t.mimeType,t.codecs),Nu(e.g.Z,r,e.j.sequenceMode,t.external)),!e.m.has(a.stream)&&a.stream.closeSegmentIndex&&(a.Pa?(r="("+a.type+":"+a.stream.id+")",e.K.has(r)||e.K.set(r,a.stream.closeSegmentIndex)):a.stream.closeSegmentIndex()),r=a.stream.isAudioMuxedInVideo!=t.isAudioMuxedInVideo,a.stream=t,a.sa=null,a.Wf=!!s,t.dependencyStream?a.Ld=Hc(e,t.dependencyStream):a.Ld=null,r&&(a.xb=null,a.kc=null,a.jc=null,t.isAudioMuxedInVideo&&(t=null,"video"===a.type?t=e.h.get("audio"):"audio"===a.type&&(t=e.h.get("video")),t&&(ld(t).catch(function(){}),t.xb=null,t.kc=null,t.jc=null,Gc(e,t),$c(e,t).catch(function(t){e.g&&e.g.onError(t)})))),n?a.Jc?a.Nf=!0:a.Pa?(a.Hc=!0,a.Me=i,a.Nf=!0):(ud(a),ad(e,a,!0,i).catch(function(t){e.g&&e.g.onError(t)})):a.Pa||a.zb||od(e,a,0),$c(e,a).catch(function(t){e.g&&e.g.onError(t)})):Pc(e,t)}function $c(e,t){var n,i;return U(function(r){if(1==r.g)return t.Gb?(n=t.stream,i=t.Gb,n.segmentIndex?r.u(2):w(r,n.createSegmentIndex(),2)):r.return();if(t.Gb!=i||t.stream!=n)return r.return();var s=e.g.Pc(),a=ju(e.g.Z,t.type),o=t.stream.segmentIndex.find(t.Ia?t.Ia.endTime:s),u=null==o?null:t.stream.segmentIndex.get(o);o=u&&u.endByte?u.endByte-u.startByte:null,u&&!o&&(o=(u.endTime-u.getStartTime())*(t.stream.bandwidth||0)/8),o?((u=u.Y)&&(o+=(u.endByte?u.endByte-u.startByte:null)||0),u=e.g.getBandwidthEstimate(),s=8*o/u<(a||0)-s-e.i.rebufferingGoal||t.Gb.h.g>o):s=!1,s&&t.Gb.abort(),A(r)})}function Gc(e,t){t.Jc||t.Hc||(t.Pa?(t.Hc=!0,t.Me=0):null==Bu(e.g.Z,t.type)?null==t.zb&&od(e,t,0):(ud(t),ad(e,t,!1,0).catch(function(t){e.g&&e.g.onError(t)})))}function Vc(e,t){var n,i,r,s,a,o,u,l;return U(function(c){if(1==c.g){if(!e.o)throw new Ve(2,5,5006);return n=gd(e,!0),i=e.g.Z,w(c,i.init(n,e.j.sequenceMode,e.j.type,e.j.ignoreManifestTimestampsInSegmentsMode),2)}for(bs(e.l),e.updateDuration(),r=d(n.keys()),s=r.next();!s.done;s=r.next())a=s.value,o=n.get(a),e.h.has(a)||(u=Hc(e,o),t.has(o.id)&&(l=t.get(o.id),hc(l,function(t,n,i){return sd(t,n,i||null,e.i.retryParameters,e.g.pc)}),u.aa=l),e.h.set(a,u),od(e,u,0));A(c)})}function Hc(e,t){var n={stream:t,type:t.type,sa:null,aa:Kc(e,t),Ia:null,xb:null,cf:null,kc:null,jc:null,$e:null,bf:null,Ec:null,endOfStream:!1,Pa:!1,zb:null,Hc:!1,Me:0,Nf:!1,Jc:!1,Xc:!0,Wf:!1,Vg:!1,Qd:!1,Gb:null,Ld:null};return t.dependencyStream&&(n.Ld=Hc(e,t.dependencyStream)),n}function Kc(e,t){if("video"===t.type&&e.i.disableVideoPrefetch||"audio"===t.type&&e.i.disableAudioPrefetch||t.type===ft&&("application/cea-608"==t.mimeType||"application/cea-708"==t.mimeType)||t.type===ft&&e.i.disableTextPrefetch)return null;if(e.m.has(t))return e.m.get(t);var n=e.h.get(t.type);return(n=n&&n.aa)&&t===n.i?n:0<e.i.segmentPrefetchLimit?new dc(e.i.segmentPrefetchLimit,t,function(t,n,i){return sd(t,n,i||null,e.i.retryParameters,e.g.pc)},0>e.g.sb()):null}function Wc(e){for(var t=e.i.segmentPrefetchLimit,n=e.i.prefetchAudioLanguages,i=d(e.j.variants),r=i.next(),s={};!r.done;s={Kb:void 0},r=i.next())if(s.Kb=r.value,s.Kb.audio)if(e.m.has(s.Kb.audio)){if(r=e.m.get(s.Kb.audio),yc(r,t),!(0<t&&n.some(function(e){return function(t){return ji(e.Kb.audio.language,t)}}(s)))){var a=e.h.get(s.Kb.audio.type);r!==(a&&a.aa)&&mc(r),e.m.delete(s.Kb.audio)}}else 0>=t||!n.some(function(e){return function(t){return ji(e.Kb.audio.language,t)}}(s))||!(r=Kc(e,s.Kb.audio))||(s.Kb.audio.segmentIndex||s.Kb.audio.createSegmentIndex(),e.m.set(s.Kb.audio,r))}function qc(e,t){var n,i,r,s,a,o;return U(function(u){switch(u.g){case 1:if(bs(e.l),t.Pa||null==t.zb||t.Jc)return u.return();if(t.zb=null,!t.Hc){u.u(2);break}return w(u,ad(e,t,t.Nf,t.Me),3);case 3:return u.return();case 2:if(Bc(e,t),t.stream.segmentIndex){u.u(4);break}return n=t.stream,x(u,5),w(u,t.stream.createSegmentIndex(),7);case 7:k(u,6);break;case 5:return i=L(u),w(u,cd(e,t,i),8);case 8:return u.return();case 6:if(n!=t.stream)return n.closeSegmentIndex&&n.closeSegmentIndex(),t.Pa||t.zb||od(e,t,0),u.return();case 4:x(u,9),r=Yc(e,t),null!=r&&(od(e,t,r),t.Qd=!1),k(u,10);break;case 9:return s=L(u),w(u,cd(e,t,s),11);case 11:return u.return();case 10:if(a=Array.from(e.h.values()),!e.I||!a.every(function(e){return e.endOfStream})){u.u(0);break}return w(u,e.g.Z.endOfStream(),13);case 13:bs(e.l),o=e.g.Z.getDuration(),0!=o&&o<e.j.presentationTimeline.getDuration()&&e.j.presentationTimeline.ob(o),A(u)}})}function Yc(e,t){if(id(t))return Ku(e.g.Z,t.stream.originalId||""),null;if(t.type==ft&&Wu(e.g.Z),t.stream.isAudioMuxedInVideo)return null;var n=e.i.updateIntervalSeconds/Math.max(1,Math.abs(e.g.sb()));if(!Ou(e.g.Z)&&t.type!=ft)return n/2;var i=e.g.Pc();if("audio"===t.type)for(var r=d(e.m.keys()),s=r.next();!s.done;s=r.next())s=e.m.get(s.value),s.$a(i,!0),fc(s,i);r=t.Ia?t.Ia.endTime:i;var a=$u(e.g.Z,t.type,i);s=Math.max(1,Math.max(e.i.rebufferingGoal,e.i.bufferingGoal)*e.C);var o=e.j.presentationTimeline.getDuration()-r,u=ju(e.g.Z,t.type);if(1e-6>o&&u)return t.endOfStream=!0,"video"==t.type&&(e=e.h.get(ft))&&id(e)&&(e.endOfStream=!0),null;if(t.endOfStream=!1,a>=s)return n/2;if(o=!t.sa,u=zc(e,t,i,u),!u)return n;a=!1,o&&t.Wf&&(a=!0,t.Wf=!1),o=1/0;var l=Array.from(e.h.values());l=d(l);for(var c=l.next();!c.done;c=l.next())c=c.value,id(c)||c.sa&&!c.sa.current()||(o=Math.min(o,c.Ia?c.Ia.endTime:i));return r>=o+e.j.presentationTimeline.h?n:("keep"!==e.i.crossBoundaryStrategy&&pd(e,t,u)||(t.aa&&t.sa&&!e.m.has(t.stream)&&(t.aa.$a(u.startTime+.001),fc(t.aa,u.startTime).catch(function(){})),Xc(e,t,i,u,a).catch(function(){}),t.Ld&&Qc(e,t.Ld,i,s)),null)}function zc(e,t,n,i){if(t.sa)return(n=t.sa.current())&&t.Ia&&.001>Math.abs(t.Ia.startTime-n.startTime)&&(n=t.sa.next().value),n;if(t.Ia||i)return n=t.Ia?t.Ia.endTime:i,e=0>e.g.sb(),t.stream.segmentIndex&&(t.sa=t.stream.segmentIndex.Ub(n,!1,e)),t.sa&&t.sa.next().value;i=e.j.sequenceMode?0:e.i.inaccurateManifestTolerance;var r=Math.max(n-i,0);e=0>e.g.sb();var s=null;return i&&(t.stream.segmentIndex&&(t.sa=t.stream.segmentIndex.Ub(r,!1,e)),s=t.sa&&t.sa.next().value),s||(t.stream.segmentIndex&&(t.sa=t.stream.segmentIndex.Ub(n,!1,e)),s=t.sa&&t.sa.next().value),s}function Xc(t,n,i,r,s){var a,o,u,l,c,d,h,f,p,g,m,v,y,b,T,S,E;return U(function(I){switch(I.g){case 1:if(a=pt,o=n.stream,u=n.sa,n.Pa=!0,x(I,2),2==r.Ac())throw new Ve(1,1,1011);return w(I,Zc(t,n,r,s),4);case 4:return bs(t.l),t.B?I.return():(l="video/mp4"==o.mimeType||"audio/mp4"==o.mimeType,c=e.ReadableStream,t.i.lowLatencyMode&&t.j.isLowLatency&&c&&l&&("HLS"!=t.j.type||r.m)?(f=new Uint8Array(0),g=p=!1,v=function(e){var a,u,l;return U(function(c){switch(c.g){case 1:if(p)return c.return();if(g=!0,bs(t.l),t.B)return c.return();if(x(c,2),f=at(f,e),a=!1,u=0,(new ks).box("mdat",function(e){u=e.size+e.start,a=!0}).parse(f,!1,!0),!a){c.u(4);break}return l=f.subarray(0,u),f=f.subarray(u),w(c,td(t,n,i,o,r,l,!0,s),5);case 5:n.aa&&n.sa&&fc(n.aa,r.startTime,!0);case 4:k(c,0);break;case 2:m=L(c),A(c)}})},w(I,rd(t,n,r,v),9)):(d=rd(t,n,r),w(I,d,7)));case 7:return h=I.h,bs(t.l),t.B?I.return():(bs(t.l),n.Hc?(n.Pa=!1,od(t,n,0),I.return()):w(I,td(t,n,i,o,r,h,!1,s),6));case 9:if(y=I.h,m)throw m;if(g){I.u(10);break}return p=!0,bs(t.l),t.B?I.return():n.Hc?(n.Pa=!1,od(t,n,0),I.return()):w(I,td(t,n,i,o,r,y,!1,s),10);case 10:n.aa&&n.sa&&fc(n.aa,r.startTime,!0);case 6:if(bs(t.l),t.B)return I.return();n.Ia=r,u.next(),n.Pa=!1,n.Vg=!1,b=t.g.Z.Lb(),T=b[n.type],ee(JSON.stringify(T)),n.Hc||(S=null,n.type===a.xa?S=t.h.get(a.ea):n.type===a.ea&&(S=t.h.get(a.xa)),S&&S.type==a.ea?t.g.pf(r,n.stream,S.stream.isAudioMuxedInVideo):t.g.pf(r,n.stream,n.stream.codecs.includes(","))),od(t,n,0),k(I,0);break;case 2:if(E=L(I),bs(t.l,E),t.B)return I.return();if(n.Pa=!1,7001==E.code)n.Pa=!1,ud(n),od(t,n,0),I.u(0);else{if(n.type!=a.Ya||!t.i.ignoreTextStreamFailures)return 3017==E.code?w(I,Jc(t,n,E),0):(n.Qd=!0,1==E.category&&n.aa&&Tc(n.aa,r),E.severity=2,w(I,cd(t,n,E),0));t.h.delete(a.Ya),I.u(0)}}})}function Qc(e,t,n,i){var r,s,a,o,u,l,c,d,f,p,g;return U(function(m){switch(m.g){case 1:for(r=t.stream,o=(a=(s=r.segmentIndex)&&s.Ub(n))&&a.next().value;o&&e.L.includes(o.startTime);)o=a&&a.next().value;if(!o){m.u(0);break}if(u=o.Y,!u||Oo(u,t.xb)){m.u(3);break}return t.xb=u,x(m,4),w(m,rd(e,t,u),6);case 6:l=m.h;var v=e.g.Z;v.M&&yt(v.M,l,0,r),e.L=[],k(m,3);break;case 4:throw c=L(m),t.xb=null,c;case 3:if(t.Ia&&t.Ia==o){m.u(0);break}return t.Ia=o,x(m,8),w(m,rd(e,t,o),10);case 10:d=m.h,v=e.g.Z,v.M&&yt(v.M,d,0,r),e.L.push(o.startTime),k(m,9);break;case 8:throw f=L(m),t.Ia=null,f;case 9:if(p=Math.max.apply(Math,[0].concat(h(e.L))),g=e.g.Pc(),g+i>p)return w(m,Qc(e,t,o.startTime,i),0);m.u(0)}})}function Jc(e,t,n){var i,r,s,a;return U(function(o){if(1==o.g){if(i=Array.from(e.h.values()),i.some(function(e){return e!=t&&e.Vg}))return o.u(2);if(r=0===e.i.maxDisabledTime&&1011==n.code?1:e.i.maxDisabledTime,e.g.disableStream(t.stream,r))return o.return();if(e.i.avoidEvictionOnQuotaExceededError)return od(e,t,4),o.return();if(s=Math.round(100*e.C),20<s)e.C-=.2;else{if(!(4<s))return t.Qd=!0,e.B=!0,e.g.onError(n),o.return();e.C-=.04}return t.Vg=!0,a=e.g.Pc(),w(o,nd(e,t,a),2)}od(e,t,4),A(o)})}function Zc(e,t,n,i){var r,s,a,o,u,l,c,d,h,f,p,g,m,v,y,b;return U(function(T){switch(T.g){case 1:if(r=pt,s=null==t.Ia,a=[],o=Math.max(0,Math.max(n.appendWindowStart,e.W)-.1),u=Math.min(n.appendWindowEnd,e.U)+.1,l=n.codecs||t.stream.codecs,c=vi(l),d=yi(n.mimeType||t.stream.mimeType),h=n.timestampOffset,h==t.cf&&o==t.kc&&u==t.jc&&c==t.$e&&d==t.bf){T.u(2);break}if(f=t.$e&&t.bf&&gl(e.g.Z,t.type,d,l,gd(e)),!f){T.u(3);break}if(p=null,t.type===r.xa?p=e.h.get(r.ea):t.type===r.ea&&(p=e.h.get(r.xa)),!p){T.u(3);break}return w(T,ld(p).catch(function(){}),5);case 5:p.xb=null,p.kc=null,p.jc=null,Gc(e,p);case 3:return w(T,ed(e,t,h,o,u,n,c,d),2);case 2:return Oo(n.Y,t.xb)||(t.xb=n.Y,n.l&&n.Y&&(g=rd(e,t,n.Y),m=function(){var s,a,o,u,l,c,d,h,f;return U(function(p){switch(p.g){case 1:return x(p,2),w(p,g,4);case 4:return s=p.h,bs(e.l),a=null,o=new Map,u={projection:null,hfov:null},l=new ks,l.box("moov",Ls).box("trak",Ls).box("mdia",Ls).R("mdhd",function(e){a=Wa(e.reader,e.version).timescale}).box("hdlr",function(e){switch(e=e.reader,e.skip(8),e.Uc()){case"soun":o.set(r.ea,a);break;case"vide":o.set(r.xa,a)}a=null}),t.type===r.xa&&l.box("minf",Ls).box("stbl",Ls).R("stsd",Rs).box("encv",Cs).box("avc1",Cs).box("avc3",Cs).box("hev1",Cs).box("hvc1",Cs).box("dvav",Cs).box("dva1",Cs).box("dvh1",Cs).box("dvhe",Cs).box("dvc1",Cs).box("dvi1",Cs).box("vexu",Ls).box("proj",Ls).R("prji",function(e){e=e.reader.Uc(),u.projection=e}).box("hfov",function(e){e=e.reader.T()/1e3,u.hfov=e}),l.parse(s),t.type===r.xa&&hd(e,u),o.has(t.type)?n.Y.timescale=o.get(t.type):null!=a&&(n.Y.timescale=a),c=t.stream.segmentIndex,c instanceof zl&&(d=Ql(c,n.startTime)),h=t.stream.closedCaptions&&0<t.stream.closedCaptions.size,w(p,e.g.Hh(t.type,s),5);case 5:return w(p,Hu(e.g.Z,t.type,s,null,t.stream,h,t.Xc,i,!1,!1,d),6);case 6:k(p,0);break;case 2:throw f=L(p),t.xb=null,f}})},v=n.startTime,s&&(y=ju(e.g.Z,t.type),null!=y&&(v=y)),e.g.vk(v,n.Y),a.push(m()))),b=t.Ia?t.Ia.i:-1,n.i!=b&&a.push(zu(e.g.Z,t.type,n.startTime)),w(T,Promise.all(a),0)}})}function ed(e,t,n,i,r,s,a,o){var u,l,c,d,h;return U(function(f){switch(f.g){case 1:if(u=pt,l=gd(e),x(f,2),t.kc=i,t.jc=r,a&&(t.$e=a),o&&(t.bf=o),t.cf=n,c=e.j.sequenceMode||"HLS"==e.j.type,d=null,t.type===u.xa?d=e.h.get(u.ea):t.type===u.ea&&(d=e.h.get(u.xa)),!(d&&d.stream&&d.stream.isAudioMuxedInVideo)){f.u(4);break}return w(f,Yu(e.g.Z,d.type,n,i,r,c,d.stream.mimeType,d.stream.codecs,l),4);case 4:return w(f,Yu(e.g.Z,t.type,n,i,r,c,s.mimeType||t.stream.mimeType,s.codecs||t.stream.codecs,l),6);case 6:k(f,0);break;case 2:throw h=L(f),t.kc=null,t.jc=null,t.$e=null,t.bf=null,t.cf=null,h}})}function td(e,t,n,i,r,s,a,o){var u,l,c,d;return a=void 0!==a&&a,o=void 0!==o&&o,U(function(h){switch(h.g){case 1:return u=i.closedCaptions&&0<i.closedCaptions.size,e.i.shouldFixTimestampOffset&&(l="video/mp4"==i.mimeType||"audio/mp4"==i.mimeType,c=null,r.Y&&(c=r.Y.timescale),l&&c&&"video"===i.type&&"DASH"==e.j.type&&(new ks).box("moof",Ls).box("traf",Ls).R("tfdt",function(n){var i,s,a,o,u,l;return U(function(d){return i=Ka(n.reader,n.version),s=i.baseMediaDecodeTime,s?(a=-s/c,o=Number(t.cf)||0,o<a?(u=t.kc,l=t.jc,w(d,ed(e,t,a,u,l,r),0)):d.u(0)):d.return()})}).parse(s,!1,a)),w(h,nd(e,t,n),2);case 2:return bs(e.l),d=t.Xc,t.Xc=!1,w(h,e.g.Hh(t.type,s),3);case 3:return w(h,Hu(e.g.Z,t.type,s,r,i,u,d,o,a),4);case 4:bs(e.l),A(h)}})}function nd(e,t,n){var i,r,s,a,o,u,l,c,d;return U(function(h){return 1==h.g?(i=t.stream.segmentIndex,i instanceof zl&&(i.$a(e.j.presentationTimeline.Fb()),r=[],Xl(i,function(e){r.push(e.Ne())})),s=Math.max(e.i.bufferBehind*e.C,e.j.presentationTimeline.h),a=Bu(e.g.Z,t.type),null==a?(e.F==t&&(e.F=null),h.return()):(o=n-a,u=e.i.evictionGoal,l=e.j.presentationTimeline.Vb(),c=e.j.presentationTimeline.Eb(),d=o-s,c-l>u&&(d=Math.max(o-s,l-u-a)),d<=u?h.return():w(h,e.g.Z.remove(t.type,a,a+d,r),2))):4!=h.g?(bs(e.l),e.F?w(h,nd(e,e.F,n),4):h.u(0)):(bs(e.l),void A(h))})}function id(e){return e&&e.type==ft&&("application/cea-608"==e.stream.mimeType||"application/cea-708"==e.stream.mimeType)}function rd(e,t,n,i){var r,s,a,o,u;return U(function(l){switch(l.g){case 1:if(r=n.Wb())return l.return(r);if(s=null,t.aa){var c=t.aa,d=c.h;n instanceof _o&&(d=c.j),d.has(n)?(c=d.get(n),i&&(c.nh=i),s=c.Zd):s=null}return s||(s=sd(n,t.stream,i||null,e.i.retryParameters,e.g.pc)),a=0,t.sa&&(a=t.sa.h),t.Gb=s,w(l,s.promise,2);case 2:if(o=l.h,t.Gb=null,u=o.data,!n.aesKey){l.u(3);break}return w(l,Lc(u,n.aesKey,a),4);case 4:u=l.h;case 3:return l.return(u)}})}function sd(e,t,n,i,r,s){s=void 0!==s&&s;var a=e instanceof No?e:void 0,o=a?1:0;return e=Rc(e.O(),e.startByte,e.endByte,i,n),e.contentType=t.type,r.request(gs,e,{type:o,stream:t,segment:a,isPreload:s})}function ad(e,t,n,i){var r,s;return U(function(a){return 1==a.g?(t.Hc=!1,t.Nf=!1,t.Me=0,t.Jc=!0,t.Ia=null,t.sa=null,t.aa&&!e.m.has(t.stream)&&mc(t.aa),i?(r=e.g.Pc(),s=e.g.Z.getDuration(),w(a,e.g.Z.remove(t.type,r+i,s),3)):w(a,qu(e.g.Z,t.type),4)):3!=a.g?(bs(e.l),n?w(a,e.g.Z.flush(t.type),3):a.u(3)):(bs(e.l),t.Jc=!1,t.endOfStream=!1,t.Pa||t.zb||od(e,t,0),void A(a))})}function od(e,t,n){var i=t.type;(i!=ft||e.h.has(i))&&(t.zb=new Pi(function(){var n;return U(function(i){return 1==i.g?(x(i,2),w(i,qc(e,t),4)):2!=i.g?k(i,0):(n=L(i),e.g&&e.g.onError(n),void A(i))})}).ha(n))}function ud(e){null!=e.zb&&(e.zb.stop(),e.zb=null)}function ld(e){return U(function(t){return e.Gb?w(t,e.Gb.abort(),0):t.u(0)})}function cd(e,t,n){var i;return U(function(r){if(1==r.g)return 3024==n.code?(t.Pa=!1,ud(t),od(e,t,0),r.return()):w(r,Vr(e.S),2);if(bs(e.l),1===n.category&&1003!=n.code){if(t.Ec)return Oc(e,!1),r.return();i=0===e.i.maxDisabledTime&&1011==n.code?1:e.i.maxDisabledTime,n.handled=e.g.disableStream(t.stream,i),n.handled&&(n.severity=1)}n.handled&&1011==n.code||e.g.onError(n),n.handled||e.i.failureCallback(n),A(r)})}function dd(e,t){t=void 0!==t&&t;var n,i,r,s,a,o=void 0===o||o;return U(function(u){if(1==u.g){if(n=Date.now()/1e3,i=e.i.minTimeBetweenRecoveries,!t){if(!e.i.allowMediaSourceRecoveries||n-e.M<i)return u.return(!1);e.M=n}return r=pt,(s=e.h.get(r.ea))&&(s.xb=null,s.kc=null,s.jc=null,o&&Gc(e,s),ld(s).catch(function(){}),s.sa&&s.sa.Yg(),ud(s)),(a=e.h.get(r.xa))&&(a.xb=null,a.kc=null,a.jc=null,o&&Gc(e,a),ld(a).catch(function(){}),a.sa&&a.sa.Yg(),ud(a)),w(u,dl(e.g.Z,gd(e)),2)}return!a||a.Jc||a.Pa||a.zb||od(e,a,0),!s||s.Jc||s.Pa||s.zb||od(e,s,0),u.return(!0)})}function hd(e,t){if(e.N.projection!=t.projection||e.N.hfov!=t.hfov){if(null!=t.projection||null!=t.hfov){var n=(new Map).set("detail",t);n=new Zr("spatialvideoinfo",n)}else n=new Zr("nospatialvideoinfo");n.cancelable=!0,e.g.onEvent(n),e.N=t}}function fd(e){if("keep"!==e.i.crossBoundaryStrategy){e.H.stop();var t=e.g.Pc(),n=e.h.get("video")||e.h.get("audio");n&&(n=n.xb)&&null!==n.g&&(t=n.g-t,0>t||1<t||(e.G=n.g+.1,e.H.ha(t)))}}function pd(e,t,n){if(t.type===ft)return!1;var i=t.xb;if(!i)return!1;var r=n.Y;if(n=i.g!==r.g,"reset_to_encrypted"===e.i.crossBoundaryStrategy&&(i.encrypted||r.encrypted||(n=!1),i.encrypted&&(e.i.crossBoundaryStrategy="keep")),"RESET_ON_ENCRYPTION_CHANGE"===e.i.crossBoundaryStrategy&&i.encrypted==r.encrypted&&(n=!1),n&&t.Xc){var s=e.g.video,a=s.paused;dd(e,!0).then(function(){var t=(new Map).set("oldEncrypted",i.encrypted).set("newEncrypted",r.encrypted);e.g.onEvent(new Zr("boundarycrossed",t)),a||s.play()})}return n}function gd(e,t){t=void 0!==t&&t;var n=new Map;return e.o.audio&&n.set("audio",e.o.audio),e.o.video&&n.set("video",e.o.video),t&&e.A&&n.set(ft,e.A),n}function md(){}function vd(e,t,n,i,r){var s,a=r in i,o=a?n.constructor==Object&&0==Object.keys(i).length:n.constructor==Object&&0==Object.keys(n).length,u=a||o,l=!0;for(s in t){var c=r+"."+s,d=a?i[r]:n[s];u||s in n?void 0===t[s]?void 0===d||u?delete e[s]:e[s]=qt(d):o?e[s]=t[s]:d.constructor==Object&&t[s]&&t[s].constructor==Object?(e[s]||(e[s]=qt(d)),c=vd(e[s],t[s],d,i,c),l=l&&c):typeof t[s]!=typeof d||null==t[s]||"function"!=typeof t[s]&&t[s].constructor!=d.constructor?(X("Invalid config, wrong type for "+c),l=!1):"function"==typeof n[s]&&n[s].length!=t[s].length?(Q("Unexpected number of arguments for "+c),e[s]=t[s]):e[s]=Array.isArray(e[s])?t[s].slice():t[s]:(X("Invalid config, unrecognized key "+c),l=!1)}return l}function yd(e,t){for(var n={},i=n,r=0,s=0;;){if(r=e.indexOf(".",r),0>r)break;0!=r&&"\\"==e[r-1]||(s=e.substring(s,r).replace(/\\\./g,"."),i[s]={},i=i[s],s=r+1),r+=1}return i[e.substring(s).replace(/\\\./g,".")]=t,n}function bd(e,t){return e&&t}function Td(e,t){function n(e){for(var t=d(Object.keys(e)),i=t.next();!i.done;i=t.next())if(i=i.value,!(e[i]instanceof HTMLElement))if(r(e[i])&&0===Object.keys(e[i]).length)delete e[i];else{var s=e[i];Array.isArray(s)&&0===s.length||"function"==typeof e[i]?delete e[i]:r(e[i])&&(n(e[i]),0===Object.keys(e[i]).length&&delete e[i])}}function i(e,t){return Object.keys(e).reduce(function(n,s){var a=e[s];return t.hasOwnProperty(s)?a instanceof HTMLElement&&t[s]instanceof HTMLElement?a.isEqualNode(t[s])||(n[s]=a):r(a)&&r(t[s])?(a=i(a,t[s]),(0<Object.keys(a).length||!r(a))&&(n[s]=a)):Array.isArray(a)&&Array.isArray(t[s])?Ft(a,t[s])||(n[s]=a):Number.isNaN(a)&&Number.isNaN(t[s])||a!==t[s]&&(n[s]=a):n[s]=a,n},{})}function r(e){return e&&"object"===typeof e&&!Array.isArray(e)}return e=i(e,t),n(e),e}function Sd(){}function Ed(e){return e=Ye(e),new Te(e).Cb}function wd(e,t,n){function i(e){$e(s).setUint32(a,e.byteLength,!0),a+=4,s.set(Be(e),a),a+=e.byteLength}if(!n||!n.byteLength)throw new Ve(2,6,6015);var r;r="string"==typeof t?Xe(t,!0):t,e=Ye(e),e=Xe(e,!0);var s=new Uint8Array(12+e.byteLength+r.byteLength+n.byteLength),a=0;return i(e),i(r),i(n),s}function Ad(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,n=Ye(e).split("skd://").pop(),wd(e,n,t))}function xd(e,t){2===e&&(e=t.drmInfo)&&Fr(e.keySystem)&&(t.headers["Content-Type"]="application/octet-stream")}function Id(){this.g=null}function kd(e,t){t=Vi(t);var n=qi(t,e.map(function(e){return Wi(e)}));return n?e.filter(function(e){return n==Wi(e)}):[]}function Ld(e,t){return e.filter(function(e){return!!e.audio&&(t?e.audio.roles.includes(t):0==e.audio.roles.length)})}function Rd(e,t){return e.filter(function(e){return!(!e.audio||!e.audio.label)&&e.audio.label.toLowerCase()==t.toLowerCase()})}function Cd(e,t){return e.filter(function(e){return!(!e.video||!e.video.label)&&e.video.label.toLowerCase()==t.toLowerCase()})}function Dd(e,t){return e.filter(function(e){return!(e.audio&&e.audio.channelsCount&&e.audio.channelsCount>t)}).sort(function(e,t){return e.audio||t.audio?e.audio?t.audio?(t.audio.channelsCount||0)-(e.audio.channelsCount||0):1:-1:0})}function Md(e,t){if("AUTO"==t){var n=e.some(function(e){return!(!e.video||!e.video.hdr||"HLG"!=e.video.hdr)});t=WT(n)}return e.filter(function(e){return!e.video||!e.video.hdr||e.video.hdr==t})}function Pd(e,t){return e.filter(function(e){return!e.video||!e.video.videoLayout||e.video.videoLayout==t})}function _d(e,t){return e.filter(function(e){return!e.audio||e.audio.spatialAudio==t})}function Od(e,t){return e.filter(function(e){return!e.audio||e.audio.codecs==t})}function Nd(){}function Ud(){var t=1/0,n=ce();navigator.connection&&navigator.connection.saveData&&(t=360);var i={retryParameters:Hr(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,persistentSessionOnlinePlayback:!1,persistentSessionsMetadata:[],initDataTransform:function(t,n,i){return"apple"===e.shakaMediaKeysPolyfill&&"skd"==n&&(n=i.serverCertificate,i=Ed(t),t=wd(t,i,n)),t},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:!1,minHdcpVersion:"",ignoreDuplicateInitData:!0,defaultAudioRobustnessForWidevine:"SW_SECURE_CRYPTO",defaultVideoRobustnessForWidevine:"SW_SECURE_DECODE"},r="reload",s=!1;Et()&&n.$c()&&(r="smooth",s=!0),s={retryParameters:Hr(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,disableIFrames:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,raiseFatalErrorOnManifestUpdateRequestFailure:!1,continueLoadingWhenPaused:!0,ignoreSupplementalCodecs:!1,updatePeriod:-1,ignoreDrmInfo:!1,dash:{clockSyncUri:"",disableXlinkProcessing:!0,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:94ce86fb-07ff-4f43-adb8-93d2fa968ca2":"com.apple.fps","urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c":"com.huawei.wiseplay"},manifestPreprocessor:$d,manifestPreprocessorTXml:Gd,sequenceMode:!1,multiTypeVariantsAllowed:s,useStreamOnceInPeriodFlattening:!1,enableFastSwitching:!0},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,ignoreManifestProgramDateTimeForTypes:[],mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',liveSegmentsDelay:3,sequenceMode:n.Zc(),ignoreManifestTimestampsInSegmentsMode:!1,disableCodecGuessing:!1,disableClosedCaptionsDetection:!1,allowLowLatencyByteRangeOptimization:!0,allowRangeRequestsToGuessMimeType:!1},mss:{manifestPreprocessor:$d,manifestPreprocessorTXml:Gd,sequenceMode:!1,keySystemsBySystemId:{"9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"}}};var a={trackSelectionCallback:function(e){return U(function(t){return t.return(e)})},downloadSizeCallback:function(e){var t;return U(function(n){return 1==n.g?navigator.storage&&navigator.storage.estimate?w(n,navigator.storage.estimate(),3):n.return(!0):(t=n.h,n.return(t.usage+e<.95*t.quota))})},progressCallback:function(e,t){return bd([e,t])},usePersistentLicense:!0,numberOfParallelDownloads:5},o={drm:i,manifest:s,streaming:{retryParameters:Hr(),failureCallback:function(e){return bd([e])},rebufferingGoal:0,bufferingGoal:10,bufferBehind:30,evictionGoal:1,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,gapPadding:0,gapJumpTimerTime:.25,durationBackoff:1,safeSeekOffset:5,safeSeekEndOffset:0,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsForFairPlay:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,preferNativeDash:!1,preferNativeHls:!1,updateIntervalSeconds:1,observeQualityChanges:!1,maxDisabledTime:30,segmentPrefetchLimit:1,prefetchAudioLanguages:[],disableAudioPrefetch:!1,disableTextPrefetch:!1,disableVideoPrefetch:!1,liveSync:{enabled:!1,targetLatency:.5,targetLatencyTolerance:.5,maxPlaybackRate:1.1,minPlaybackRate:.95,panicMode:!1,panicThreshold:60,dynamicTargetLatency:{enabled:!1,stabilityThreshold:60,rebufferIncrement:.5,maxAttempts:10,maxLatency:4,minLatency:1}},allowMediaSourceRecoveries:!0,minTimeBetweenRecoveries:5,vodDynamicPlaybackRate:!1,vodDynamicPlaybackRateLowBufferRate:.95,vodDynamicPlaybackRateBufferRatio:.5,preloadNextUrlWindow:30,loadTimeout:30,clearDecodingCache:!1,dontChooseCodecs:!1,shouldFixTimestampOffset:!1,avoidEvictionOnQuotaExceededError:!1,crossBoundaryStrategy:"keep",returnToEndOfLiveWindowWhenOutside:!1},networking:{forceHTTP:!1,forceHTTPS:!1,minBytesForProgressEvents:16e3},mediaSource:{codecSwitchingStrategy:r,addExtraFeaturesToSourceBuffer:function(e){return bd([e],"")},forceTransmux:!1,insertFakeEncryptionInInit:!0,correctEc3Enca:!1,modifyCueCallback:function(e,t){return bd([e,t])},dispatchAllEmsgBoxes:!1,useSourceElements:!0,durationReductionEmitsUpdateEnd:!0},offline:a,abrFactory:function(){return new Cr},adaptationSetCriteriaFactory:function(){return new(Function.prototype.bind.apply(Id,[null].concat(h(F.apply(0,arguments)))))},abr:{enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1,clearBufferSwitch:!1,safeMarginSwitch:0,cacheLoadThreshold:20,minTimeToSwitch:0,preferNetworkInformationBandwidth:!1,removeLatencyFromFirstPacketTime:!0},autoShowText:3,preferredAudioLanguage:"",preferredAudioLabel:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoHdrLevel:"AUTO",preferredVideoLayout:"",preferredVideoLabel:"",preferredVideoCodecs:[],preferredAudioCodecs:[],preferredTextFormats:[],preferForcedSubs:!1,preferSpatialAudio:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayer:{captionsUpdatePeriod:.25,fontScaleFactor:1},textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",rtpSafetyFactor:5,useHeaders:!1,includeKeys:[],version:1},cmsd:{enabled:!0,applyMaximumSuggestedBitrate:!0,estimatedThroughputWeightRatio:.5},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1,poster:!0},ads:{customPlayheadTracker:!1,skipPlayDetection:!1,supportsMultipleMediaElements:!0,disableHLSInterstitial:!1,disableDASHInterstitial:!1,allowPreloadOnDomElements:!0,allowStartInMiddleOfInterstitial:!0},ignoreHardwareResolution:!1,queue:{preloadNextUrlWindow:30,repeatMode:0}};return a.trackSelectionCallback=function(e){return U(function(t){return t.return(jd(e,o.preferredAudioLanguage,o.preferredVideoHdrLevel))})},n.Sa(o)}function Fd(){return{streaming:{inaccurateManifestTolerance:0,segmentPrefetchLimit:2,updateIntervalSeconds:.1,maxDisabledTime:1,retryParameters:{baseDelay:100}},manifest:{dash:{autoCorrectDrift:!1},retryParameters:{baseDelay:100}},drm:{retryParameters:{baseDelay:100}}}}function Bd(e,t,n){var i={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:[],audioRobustness:[],sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:"",headers:{}}};return vd(e,t,n||Ud(),i,"")}function jd(e,t,n){var i=n;"AUTO"==i&&(n=e.some(function(e){return!(!e.hdr||"HLG"!=e.hdr)}),i=WT(n));var r=e.filter(function(e){return!("variant"!=e.type||e.hdr&&e.hdr!=i)});n=[];var s=qi(t,r.map(function(e){return e.language}));s&&(n=r.filter(function(e){return Vi(e.language)==s})),0==n.length&&(n=r.filter(function(e){return e.primary})),0==n.length&&(r.map(function(e){return e.language}),n=r);var a=n.filter(function(e){return e.height&&480>=e.height});for(a.length&&(a.sort(function(e,t){return t.height-e.height}),n=a.filter(function(e){return e.height==a[0].height})),t=[],n.length&&(r=Math.floor(n.length/2),n.sort(function(e,t){return e.bandwidth-t.bandwidth}),t.push(n[r])),e=d(e),n=e.next();!n.done;n=e.next())n=n.value,n.type!=ft&&"image"!=n.type||t.push(n);return t}function $d(e){return bd([e],e)}function Gd(e){return bd([e],e)}function Vd(){this.g=null,this.h=[]}function Hd(e,t){var n=0;e.g&&e.g.state==t&&(n+=e.g.duration),e=d(e.h);for(var i=e.next();!i.done;i=e.next())i=i.value,n+=i.state==t?i.duration:0;return n}function Kd(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],i=d(e.h),r=i.next();!r.done;r=i.next())n.push(t(r.value));return e.g&&n.push(t(e.g)),n}function Wd(){this.i=this.h=null,this.g=[]}function qd(e,t,n){e.i!=t&&(e.i=t,e.g.push({timestamp:Date.now()/1e3,id:t.id,type:"text",fromAdaptation:n,bandwidth:null}))}function Yd(){this.B=this.W=NaN,this.l="",this.j=this.di=this.s=this.A=this.K=this.C=this.o=this.m=this.I=this.F=this.i=this.S=this.U=this.M=this.N=this.P=NaN,this.L=0,this.G=this.H=NaN,this.g=new Vd,this.h=new Wd}function zd(e,t,n){e.P=t,e.N=n}function Xd(e,t,n){e.W=t,e.B=n}function Qd(e,t){e.i=isNaN(e.i)?t:Math.max(e.i,t)}function Jd(e,t){e.j=isNaN(e.j)?t:e.j+t}function Zd(e){var t=e.W,n=e.B,i=e.l,r=e.A,s=e.N,a=e.P,o=e.M,u=e.U,l=e.S,c=e.s,h=e.i,f=e.F,p=e.I,g=e.m,m=Hd(e.g,"playing"),v=Hd(e.g,"paused"),y=Hd(e.g,"buffering"),b=e.o,T=e.C,S=e.K,E=e.di,w=e.j,A=e.L,x=e.H,I=e.G,k=Kd(e.g),L=[];e=d(e.h.g);for(var R=e.next();!R.done;R=e.next())R=R.value,L.push({timestamp:R.timestamp,id:R.id,type:R.type,fromAdaptation:R.fromAdaptation,bandwidth:R.bandwidth});return{width:t,height:n,currentCodecs:i,streamBandwidth:r,decodedFrames:s,droppedFrames:a,corruptedFrames:o,stallsDetected:u,gapsJumped:l,estimatedBandwidth:c,completionPercent:h,loadLatency:f,manifestTimeSeconds:p,drmTimeSeconds:g,playTime:m,pauseTime:v,bufferingTime:y,licenseTime:b,liveLatency:T,maxSegmentDuration:S,manifestSizeBytes:E,bytesDownloaded:w,nonFatalErrorCount:A,manifestPeriodCount:x,manifestGapCount:I,stateHistory:k,switchHistory:L}}function eh(e,t,n,i){ns.call(this),this.N=e,this.W=t,this.Oa=i.networkingEngine,this.m=n,this.A=null,this.Ka=0,this.ab=i.ed,this.F=i.kk,this.eb=i.lk,this.g=i.config,this.l=this.G=this.h=null,this.wa=!1,this.H=i.Ak,this.ya=!1,this.i=null,this.oa=!1,this.j=this.C=null,this.ia=!1,this.M=new Map,this.Ba=!1,this.Ta=i.zk,this.$=new Yd,this.va=new Kr,this.s=new Kr,this.P=null,this.o=!1,this.ka=i.cj,this.U=this.K=null,this.Za=i.bj,this.S=!1,this.L=[],this.I=[],this.B=!0}function th(e,t,n){(e=t?e.I:e.L)?e.push(n):n()}function nh(e){if(e.I)for(var t=d(e.I),n=t.next();!n.done;n=t.next())n=n.value,n();e.I=null}function ih(e,t){if(e.P=t,e.S=!0,e.L){t=d(e.L);for(var n=t.next();!n.done;n=t.next())n=n.value,n()}e.L=null}function rh(e){return e.ia=!0,e.j}function sh(e){return e.ya=!0,e.H}function ah(e){return e.oa=!0,e.i}function oh(e){return e.Ba=!0,e.M}function uh(e){if(e.o)throw new Ve(2,7,7003)}function lh(e,t){e.dispatchEvent(new Zr("onstatechange",(new Map).set("state",t)))}function ch(e){var t,n,i,r,s,a,o,u,l;return U(function(c){switch(c.g){case 1:if(lh(e,"manifest-parser"),e.l||(e.G=Ga(e.N,e.W),e.l=e.G(),e.l.configure(e.g.manifest,function(){return e.B})),t=Date.now()/1e3,lh(e,"manifest"),e.h){c.u(2);break}return w(c,e.l.start(e.N,e.eb),3);case 3:if(e.h=c.h,1!=e.h.variants.length){c.u(2);break}for(n=[],i=e.h.variants[0],r=d([i.video,i.audio]),s=r.next();!s.done;s=r.next())(a=s.value)&&!a.segmentIndex&&n.push(a.createSegmentIndex());if(!(0<n.length)){c.u(2);break}return w(c,Promise.all(n),2);case 2:return e.va.resolve(),o=new Zr("manifestparsed",void 0),w(c,Promise.resolve(),7);case 7:if(e.dispatchEvent(o),0==e.h.variants.length)throw new Ve(2,4,4036);ph(e.h),u=Date.now()/1e3,l=u-t,e.$.I=l,A(c)}})}function dh(e,t){var n,i,r,s,a,o;return U(function(u){switch(u.g){case 1:if(!e.h||e.i)return u.return();if(lh(e,"drm-engine"),e.Ka=Date.now()/1e3,e.i=e.ab(),e.F.h=e.i,e.i.configure(e.g.drm,function(){return e.B}),n=_a(e.F,e.h),!n){u.u(2);break}return i=new Zr("trackschanged",void 0),w(u,Promise.resolve(),3);case 3:uh(e),e.dispatchEvent(i);case 2:return r=Tr(e.h.variants),s=!0,e.h&&e.h.presentationTimeline&&"HLS"!=e.h.type&&(s=e.h.presentationTimeline.V()),w(u,Vs(e.i,r,e.h.offlineSessionIds,s),4);case 4:if(uh(e),!t){u.u(5);break}return w(u,e.i.dc(t),6);case 6:uh(e);case 5:return w(u,Pa(e.F,e.h),7);case 7:if(a=u.h,!a){u.u(0);break}return o=new Zr("trackschanged",void 0),w(u,Promise.resolve(),9);case 9:e.dispatchEvent(o),A(u)}})}function hh(e){var t,n,i,r,s,a,o;return U(function(u){return e.A||(e.A=e.g.adaptationSetCriteriaFactory(),e.A.configure({language:e.g.preferredAudioLanguage,role:e.g.preferredVariantRole,channelCount:e.g.preferredAudioChannelCount,Cc:e.g.preferredVideoHdrLevel,spatialAudio:e.g.preferSpatialAudio,videoLayout:e.g.preferredVideoLayout,Ic:e.g.preferredAudioLabel,Bd:e.g.preferredVideoLabel,codecSwitchingStrategy:e.g.mediaSource.codecSwitchingStrategy,audioCodec:"",Dd:"",De:0,preferredAudioCodecs:e.g.preferredAudioCodecs,preferredAudioChannelCount:e.g.preferredAudioChannelCount})),e.Za&&(t=e.g.abrFactory,e.C=t,e.j=t(),e.j.configure(e.g.abr)),e.ka?(n=e.h.presentationTimeline.V(),i=Tr(e.h.variants),r=e.A.create(i),e.j.configure(e.g.abr),e.j.setVariants(Array.from(r.values())),s=e.j.chooseVariant(),s?(a=[],e.K=s,s.video&&a.push(fh(e,s.video,n)),s.audio&&a.push(fh(e,s.audio,n)),(o=Sr(e.h.textStreams,e.g.preferredTextLanguage,e.g.preferredTextRole,e.g.preferForcedSubs)[0]||null)&&xr(s.audio,o,e.g)&&(a.push(fh(e,o,n)),e.U=o),w(u,Promise.all(a),0)):u.u(0)):u.u(0)})}function fh(e,t,n){var i,r,s,a,o;return U(function(u){return 1==u.g?(i=e.g.streaming.segmentPrefetchLimit||2,r=new dc(i,t,function(t,n,i){return sd(t,n,i||null,e.g.streaming.retryParameters,e.Oa,e.B)},!1),e.M.set(t.id,r),t.segmentIndex?u.u(2):w(u,t.createSegmentIndex(),2)):(s="number"===typeof e.m?e.m:0,a=t.segmentIndex.Ub(s),o=null,a&&(o=a.current(),o||(o=a.next().value)),o||(o=Wl(t.segmentIndex)),o?n?o.Y?w(u,pc(r,o.Y),0):u.u(0):w(u,fc(r,o.startTime),0):u.u(0))})}function ph(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.variants.some(t)&&(e.variants=e.variants.filter(t))}function gh(e,t){ns.call(this);var n=this;this.i=e,this.l=t,this.g=new Map,this.m=[{dd:null,cd:yh,Rc:function(e,t){return mh(n,"enter",e,t)}},{dd:vh,cd:yh,Rc:function(e,t){return mh(n,"enter",e,t)}},{dd:bh,cd:yh,Rc:function(e,t){return mh(n,"enter",e,t)}},{dd:yh,cd:vh,Rc:function(e,t){return mh(n,"exit",e,t)}},{dd:yh,cd:bh,Rc:function(e,t){return mh(n,"exit",e,t)}},{dd:vh,cd:bh,Rc:function(e,t){t?mh(n,"skip",e,t):(mh(n,"enter",e,t),mh(n,"exit",e,t))}},{dd:bh,cd:vh,Rc:function(e,t){return mh(n,"skip",e,t)}}],this.h=new re,this.h.D(this.i,"regionremove",function(e){n.g.delete(e.region)})}function mh(e,t,n,i){t=new Zr(t,new Map([["region",n],["seeking",i]])),e.dispatchEvent(t)}Cl.prototype.release=function(){this.h&&(this.h.release(),this.h=null),null!=this.i&&(this.i.release(),this.i=null),this.m=function(){},this.g=null},Ol.prototype.release=function(){this.h&&(this.h.stop(),this.h=null),this.g=null},i=Ul.prototype,i.ready=function(){function e(){if(null==t.h||0==t.h&&1/0!=t.g.duration)t.i=!0;else{var e=t.g.currentTime,n=null;if("number"===typeof t.h)n=t.h;else if(t.h instanceof Date){var i=Fl(t);null!==i&&(n=t.h.getTime()/1e3-i,n=Bl(t,n))}null==n?t.i=!0:(0>n&&(n=Math.max(0,e+n)),e!=n?(t.j.za(t.g,"seeking",function(){t.i=!0}),t.g.currentTime=n):t.i=!0)}}var t=this;Ll(this.g,HTMLMediaElement.HAVE_FUTURE_DATA,this.j,function(){e()})},i.release=function(){this.j&&(this.j.release(),this.j=null),this.g=null},i.Qf=function(e){this.h=this.i?this.h:e},i.Be=function(){var e=this.i?this.g.currentTime:this.h;return e instanceof Date&&(e=e.getTime()/1e3-(Fl(this)||0),e=Bl(this,e)),e||0},i.Bh=function(){return 0},i.Ah=function(){return 0},i.ni=function(){},i.$h=function(){var e=$o(this.g.buffered);return null!=e&&e>=this.g.duration-1},i=jl.prototype,i.ready=function(){this.m.Ga(.25)},i.release=function(){this.i&&(this.i.release(),this.i=null),this.j&&(this.j.release(),this.j=null),this.m&&(this.m.stop(),this.m=null),this.h=this.i=this.g=this.l=null,this.s=function(){}},i.Qf=function(e){Ml(this.i,$l(this,e))},i.Be=function(){var e=Dl(this.i);return 0<this.h.readyState&&!this.h.paused?Hl(this,e):e},i.Bh=function(){return this.j.G},i.Ah=function(){return this.j.C},i.ni=function(){this.j.pf()},i.$h=function(){if(this.g.V()){var e=this.g.yc(),t=$o(this.h.buffered);if(null!=t&&t>=e)return!0}return!1},i=Kl.prototype,i.getNumReferences=function(){return this.g.length},i.getNumEvicted=function(){return this.i},i.release=function(){this.o||(this.g=[],this.m&&this.m.stop(),this.m=null)},i.pk=function(){this.o=!0},i.Db=function(e){for(var t=d(this.g),n=t.next();!n.done;n=t.next())e(n.value)},i.find=function(e){for(var t=this.g.length-1,n=t;0<=n;--n){var i=this.g[n],r=n<t?this.g[n+1].startTime:i.endTime;if(e>=i.startTime&&e<r)return n+this.i}return this.g.length&&e<this.g[0].startTime?this.i:null},i.get=function(e){return 0==this.g.length?null:(e-=this.i,0>e||e>=this.g.length?null:this.g[e])},i.offset=function(e){if(!this.o)for(var t=d(this.g),n=t.next();!n.done;n=t.next())n.value.offset(e)},i.gf=function(e){if(!this.o&&e.length){var t=Math.round(1e3*e[0].startTime)/1e3;this.g=this.g.filter(function(e){return Math.round(1e3*e.startTime)/1e3<t}),this.g.push.apply(this.g,h(e))}},i.Wd=function(e,t){var n=this;e=e.filter(function(e){return e.endTime>t&&(0==n.g.length||e.endTime>n.g[0].startTime)}),this.gf(e),this.$a(t)},i.$a=function(e){if(!this.o){var t=this.g.length;this.g=this.g.filter(function(t){return t.endTime>e}),this.i+=t-this.g.length}},i.hd=function(e,t,n){if(n=void 0!==n&&n,!this.o){for(;this.g.length;){if(!(this.g[this.g.length-1].startTime>=t))break;this.g.pop()}for(;this.g.length;){if(!(this.g[0].endTime<=e))break;this.g.shift(),n||this.i++}0!=this.g.length&&(e=this.g[this.g.length-1],t=new No(e.startTime,t,e.C,e.startByte,e.endByte,e.Y,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.g,e.tilesLayout,e.B,e.h,e.status,e.aesKey),t.mimeType=e.mimeType,t.codecs=e.codecs,t.i=e.i,this.g[this.g.length-1]=t)}},i.Gf=function(e,t){var n=this;this.o||(this.m&&this.m.stop(),this.m=new _i(function(){var e=t();e?n.g.push.apply(n.g,h(e)):(n.m.stop(),n.m=null)}),this.m.Ga(e))},Kl.prototype[Symbol.iterator]=function(){return this.Ub(0)},Kl.prototype.Ub=function(e,t,n){t=void 0!==t&&t,n=void 0!==n&&n;var i=this.find(e);if(null==i)return null;var r=this.get(i);n?i++:i--;var s=-1;if(r&&0<r.g.length)for(var a=r.g.length-1;0<=a;--a){var o=r.g[a];if(e>=o.startTime&&e<o.endTime){if(!t){for(;a&&!o.l;)a--,o=r.g[a];if(!o.l)return X("No independent partial segment found!"),null}n?i--:i++,s=a-1;break}}return new Yl(this,i,s,n)},Kl.prototype.Ne=function(){return-1},K("shaka.media.SegmentIndex",Kl),Kl.forSingleSegment=ql,Kl.prototype.getIteratorForTime=Kl.prototype.Ub,Kl.prototype.updateEvery=Kl.prototype.Gf,Kl.prototype.fit=Kl.prototype.hd,Kl.prototype.evict=Kl.prototype.$a,Kl.prototype.mergeAndEvict=Kl.prototype.Wd,Kl.prototype.offset=Kl.prototype.offset,Kl.prototype.get=Kl.prototype.get,Kl.prototype.find=Kl.prototype.find,Kl.prototype.markImmutable=Kl.prototype.pk,Kl.prototype.release=Kl.prototype.release,Kl.prototype.getNumEvicted=Kl.prototype.getNumEvicted,Kl.prototype.getNumReferences=Kl.prototype.getNumReferences,i=Yl.prototype,i.zd=function(e){this.reverse=e},i.mj=function(){return this.h},i.current=function(){var e=this.i.get(this.h);return e&&0<e.g.length&&e.A&&this.g>=e.g.length&&(this.h++,this.g=0,e=this.i.get(this.h)),e&&0<e.g.length?e.g[this.g]:e},i.next=function(){var e=this.i.get(this.h);return this.reverse?e&&0<e.g.length?(this.g--,0>this.g&&(this.h--,this.g=(e=this.i.get(this.h))&&0<e.g.length?e.g.length-1:0)):(this.h--,this.g=0):e&&0<e.g.length?(this.g++,e.A&&this.g==e.g.length&&(this.h++,this.g=0)):(this.h++,this.g=0),e=this.current(),{value:e,done:!e}},i.Yg=function(){var e=this.current();if(e.o&&!e.l&&(e=this.i.get(this.h))&&0<e.g.length)for(var t=e.g[this.g];t.l&&!(0>=this.g);)this.g--,t=e.g[this.g]},K("shaka.media.SegmentIterator",Yl),Yl.prototype.resetToLastIndependent=Yl.prototype.Yg,Yl.prototype.next=Yl.prototype.next,Yl.prototype.current=Yl.prototype.current,Yl.prototype.currentPosition=Yl.prototype.mj,Yl.prototype.setReverse=Yl.prototype.zd,b(zl,Kl),i=zl.prototype,i.clone=function(){var e=new zl;return e.h=this.h.slice(),e.i=this.i,e},i.release=function(){for(var e=d(this.h),t=e.next();!t.done;t=e.next())t.value.release();this.h=[]},i.Db=function(e){for(var t=d(this.h),n=t.next();!n.done;n=t.next())n.value.Db(e)},i.find=function(e){for(var t=this.i,n=d(this.h),i=n.next();!i.done;i=n.next()){i=i.value;var r=i.find(e);if(null!=r)return r+t;t+=i.getNumEvicted()+i.getNumReferences()}return null},i.get=function(e){for(var t=this.i,n=d(this.h),i=n.next();!i.done;i=n.next()){i=i.value;var r=i.get(e-t);if(r)return r;r=i.getNumReferences(),t+=i.getNumEvicted()+r}return null},i.offset=function(){},i.gf=function(){},i.$a=function(e){for(var t=d(this.h),n=t.next();!n.done;n=t.next())n.value.$a(e);for(;1<this.h.length&&0==this.h[0].getNumReferences();)e=this.h.shift(),this.i+=e.getNumEvicted(),e.release()},i.Wd=function(){},i.hd=function(){},i.Gf=function(){},K("shaka.media.MetaSegmentIndex",zl),zl.prototype.updateEvery=zl.prototype.Gf,zl.prototype.fit=zl.prototype.hd,zl.prototype.mergeAndEvict=zl.prototype.Wd,zl.prototype.evict=zl.prototype.$a,zl.prototype.merge=zl.prototype.gf,zl.prototype.offset=zl.prototype.offset,zl.prototype.get=zl.prototype.get,zl.prototype.find=zl.prototype.find,zl.prototype.forEachTopLevelReference=zl.prototype.Db,zl.prototype.release=zl.prototype.release,Jl.prototype.release=function(){this.set(this.Oc()),this.h&&(this.h.stop(),this.h=null),this.g=null},Jl.prototype.set=function(e){this.i=e,Zl(this)},Jl.prototype.Oc=function(){return this.g.Oc()},ec.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.i.stop();for(var e=d(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g.clear()},b(nc,ns),nc.prototype.release=function(){this.g.clear(),ns.prototype.release.call(this)},nc.prototype.j=function(e){for(var t=d(this.g.values()),n=t.next();!n.done;n=t.next()){n=n.value;var i=n.gg;e:{for(var r=n.ae,s=r.length-1;0<=s;s--){var a=r[s];if(a.position<=e){r=a.od;break e}}r=null}s=r&&!(i===r||i&&r&&i.bandwidth==r.bandwidth&&i.audioSamplingRate==r.audioSamplingRate&&i.codecs==r.codecs&&i.contentType==r.contentType&&i.frameRate==r.frameRate&&i.height==r.height&&i.mimeType==r.mimeType&&i.channelsCount==r.channelsCount&&i.pixelAspectRatio==r.pixelAspectRatio&&i.width==r.width),a=r&&i&&r.label&&i.label&&i.label!==r.label;var o=r&&i&&r.language&&i.language&&i.language!==r.language;i=r&&i&&r.roles&&i.roles&&!Bt(i.roles,r.roles),(a||o||i)&&sc(this,e,r.contentType)&&(n.gg=r,i=new Zr("audiotrackchange",new Map([["quality",r],["position",e]])),this.dispatchEvent(i)),s&&sc(this,e,r.contentType)&&(n.gg=r,JSON.stringify(r),n=new Zr("qualitychange",new Map([["quality",r],["position",e]])),this.dispatchEvent(n))}},b(uc,ns),uc.prototype.release=function(){this.h.clear(),this.g&&(this.g.stop(),this.g=null),ns.prototype.release.call(this)},dc.prototype.$a=function(e,t){t=void 0!==t&&t;for(var n=d(this.h.keys()),i=n.next();!i.done;i=n.next())i=i.value,e>i.endTime&&Tc(this,i);t&&vc(this)},dc.prototype.zd=function(e){this.o=e,this.g&&this.g.zd(e)},Sc.prototype.abort=function(){this.Zd&&this.Zd.abort()},i=Cc.prototype,i.destroy=function(){return this.l.destroy()},i.configure=function(e){if(this.i=e,this.S=new Gr({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0),e.disableAudioPrefetch){var t=this.h.get("audio");t&&t.aa&&(mc(t.aa),t.aa=null),t=d(this.m.keys());for(var n=t.next();!n.done;n=t.next())n=n.value,mc(this.m.get(n)),this.m.delete(n)}for(e.disableTextPrefetch&&(t=this.h.get(ft))&&t.aa&&(mc(t.aa),t.aa=null),e.disableVideoPrefetch&&(t=this.h.get("video"))&&t.aa&&(mc(t.aa),t.aa=null),t=d(this.h.keys()),n=t.next();!n.done;n=t.next())n=this.h.get(n.value),n.aa?(yc(n.aa,e.segmentPrefetchLimit),0<e.segmentPrefetchLimit||(mc(n.aa),n.aa=null)):0<e.segmentPrefetchLimit&&(n.aa=Kc(this,n.stream));e.disableAudioPrefetch||Wc(this)},i.start=function(e){var t=this;return U(function(n){if(1==n.g)return w(n,Vc(t,e||new Map),2);bs(t.l),t.I=!0,A(n)})},i.Xc=function(){if(this.g){for(var e=this.g.Pc(),t=d(this.h.keys()),n=t.next();!n.done;n=t.next()){var i=n.value;n=this.h.get(i);var r=this.g.Z;if(i==ft?(r=r.h,r=null!=r.g&&null!=r.h&&(e>=r.g&&e<r.h)):(r=Gu(r,i),r=Go(r,e)),!r){if(this.M=0,n.aa&&(n.aa.g=null),"audio"===n.type){r=d(this.m.values());for(var s=r.next();!s.done;s=r.next())s.value.g=null}n.sa=null,(null!=ju(this.g.Z,i)||n.Pa)&&Gc(this,n),n.Gb&&(n.Gb.abort(),n.Gb=null),i===ft&&(i=this.g.Z,i.I&&i.I.Cd()),n.Xc=!0}}"keep"!==this.i.crossBoundaryStrategy&&fd(this)}},i.updateDuration=function(){var e=wt(),t=this.j.presentationTimeline.getDuration();1/0>t?(e&&(this.s&&this.s.stop(),Qu(this.g.Z)),this.g.Z.ob(t)):e?(this.s&&this.s.Ga(.5),this.g.Z.ob(1/0)):this.g.Z.ob(Math.pow(2,32))},K("shaka.util.ConfigUtils",md),md.getDifferenceFromConfigObjects=Td,md.convertToConfigObject=yd,md.mergeConfigObjects=vd,K("shaka.config.RepeatMode",{OFF:0,ALL:1,SINGLE:2}),K("shaka.drm.FairPlay",Sd),Sd.commonFairPlayResponse=function(e,t){if(2===e&&(e=t.originalRequest.drmInfo)&&Fr(e.keySystem)){try{var n=We(t.data)}catch(r){return}if(e=!1,n=n.trim(),"<ckc>"===n.substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6),e=!0),!e)try{var i=JSON.parse(n);i.ckc&&(n=i.ckc,e=!0),i.CkcMessage&&(n=i.CkcMessage,e=!0),i.License&&(n=i.License,e=!0)}catch(r){}e&&(t.data=Fe(it(n)))}},Sd.muxFairPlayRequest=function(e,t){xd(e,t)},Sd.expressplayFairPlayRequest=function(e,t){if(2===e){var n=t.drmInfo;n&&Fr(n.keySystem)&&xd(e,t)}},Sd.conaxFairPlayRequest=function(e,t){xd(e,t)},Sd.ezdrmFairPlayRequest=function(e,t){xd(e,t)},Sd.verimatrixFairPlayRequest=function(e,t){2===e&&(e=t.drmInfo)&&Fr(e.keySystem)&&(e=Be(t.body),e=nt(e),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=ze("spc="+e))},Sd.muxInitDataTransform=function(e,t,n){return Ad(e,t,n)},Sd.expressplayInitDataTransform=function(e,t,n){return Ad(e,t,n)},Sd.conaxInitDataTransform=function(t,n,i){if("skd"!==n)return t;n=i.serverCertificate,i=Ye(t).split("skd://").pop().split("?").shift(),i=e.atob(i);var r=new ArrayBuffer(2*i.length);r=je(r);for(var s=0,a=i.length;s<a;s++)r[s]=i.charCodeAt(s);return wd(t,r,n)},Sd.ezdrmInitDataTransform=function(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,n=Ye(e).split(";").pop(),wd(e,n,t))},Sd.verimatrixInitDataTransform=function(e,t,n){return Ad(e,t,n)},Sd.initDataTransform=wd,Sd.defaultGetContentId=Ed,Sd.isFairPlaySupported=function(){var e;return U(function(t){return 1==t.g?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},x(t,2),w(t,navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):2!=t.g?t.return(!0):(L(t),t.return(!1))})},Id.prototype.configure=function(e){this.g=e},Id.prototype.getConfiguration=function(){return this.g},Id.prototype.create=function(e){var t;if(this.g.language){var n=kd(e,this.g.language);n.length&&(t=n)}t||(t=e.filter(function(e){return e.primary}),t=t.length?t:e),e=Ld(t,this.g.role),e.length&&(t=e),this.g.videoLayout&&(e=Pd(t,this.g.videoLayout),e.length&&(t=e)),this.g.Cc&&(e=Md(t,this.g.Cc),e.length&&(t=e));var i=[this.g.channelCount,this.g.preferredAudioChannelCount];if(e=i.filter(function(e,t){return e&&i.indexOf(e)===t}),e.length)for(e=d(e),n=e.next();!n.done;n=e.next())if(n=Dd(t,n.value),n.length){t=n;break}this.g.Ic&&(e=Rd(t,this.g.Ic),e.length&&(t=e)),this.g.Bd&&(e=Cd(t,this.g.Bd),e.length&&(t=e)),e=_d(t,this.g.spatialAudio),e.length&&(t=e);var r=[this.g.audioCodec,this.g.Dd].concat(h(this.g.preferredAudioCodecs));if(e=r.filter(function(e,t){return e&&r.indexOf(e)===t}),e.length)for(e=d(e),n=e.next();!n.done;n=e.next())if(n=Od(t,n.value),n.length){t=n;break}return new xa(t[0],t,!("smooth"==this.g.codecSwitchingStrategy&&Et()))},K("shaka.util.PlayerConfiguration",Nd),Nd.mergeConfigObjects=Bd,Nd.createDefaultForLL=Fd,Nd.createDefault=Ud,b(eh,ns),i=eh.prototype,i.getStartTime=function(){return this.m},i.kd=function(){return this.N},i.Ag=function(){return this.h},i.getStats=function(){return this.$},i.Kj=function(){return this.K?fr(this.K):null},i.Jj=function(){return this.U?pr(this.U):null},i.start=function(){var t=this;(function(){var n;U(function(i){switch(i.g){case 1:return w(i,Promise.resolve(),2);case 2:return x(i,3),w(i,ch(t),5);case 5:if(uh(t),"webkit"===e.shakaMediaKeysPolyfill){i.u(6);break}return w(i,dh(t),7);case 7:uh(t);case 6:return w(i,hh(t),8);case 8:if(uh(t),!t.ka||!t.i){i.u(9);break}return w(i,oa(t.i),10);case 10:uh(t);case 9:t.s.resolve(),k(i,0);break;case 3:n=L(i),n instanceof Ve&&(7001==n.code||7003==n.code)||t.s.reject(n),A(i)}})})()},i.dispatchEvent=function(e){return this.P?this.P.dispatchEvent(e):ns.prototype.dispatchEvent.call(this,e)},i.onError=function(e){2===e.severity&&(this.s.reject(e),this.destroy());var t=(new Map).set("detail",e);t=new Zr("error",t),this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)},i.configure=function(e,t){e=yd(e,t),Bd(this.g,e)},i.getConfiguration=function(){return qt(this.g)},i.al=function(){return this.s},i.destroy=function(){var e,t,n,i=this;return U(function(r){switch(r.g){case 1:if(i.o=!0,!i.l||i.wa){r.u(2);break}return w(r,i.l.stop(),2);case 2:if(!i.j||i.ia){r.u(4);break}return w(r,i.j.stop(),4);case 4:if(i.H&&!i.ya&&i.H.release(),!i.i||i.oa){r.u(6);break}return w(r,i.i.destroy(),6);case 6:if(0<i.M.size&&!i.Ba)for(e=d(i.M.values()),t=e.next();!t.done;t=e.next())n=t.value,mc(n);A(r)}})},K("shaka.media.PreloadManager",eh),eh.prototype.destroy=eh.prototype.destroy,eh.prototype.waitForFinish=eh.prototype.al,eh.prototype.getPrefetchedTextTrack=eh.prototype.Jj,eh.prototype.getPrefetchedVariantTrack=eh.prototype.Kj,b(gh,ns),gh.prototype.release=function(){this.i=null,this.g.clear(),this.h.release(),this.h=null,ns.prototype.release.call(this)},gh.prototype.j=function(e,t){if(!this.l||0!=e){this.l=!1;for(var n=d(this.i.h.values()),i=n.next();!i.done;i=n.next()){i=i.value;var r=this.g.get(i),s=e<i.startTime?vh:e>i.endTime?bh:yh;this.g.set(i,s);for(var a=d(this.m),o=a.next();!o.done;o=a.next())o=o.value,o.dd==r&&o.cd==s&&o.Rc(i,t)}}};var vh=1,yh=2,bh=3;function Th(e,t,n){var i,r,s,a,o,u,l;return U(function(c){switch(c.g){case 1:var d=new Te(e).mb.split("/").pop().split(".");return i=1==d.length?"":d.pop().toLowerCase(),(r=Sh.get(i))?c.return(r):(s=0,a=us([e],n),x(c,2),a.method="HEAD",w(c,t.request(s,a).promise,4));case 4:o=c.h,r=o.headers["content-type"],k(c,3);break;case 2:if(u=L(c),!u||1002!=u.code&&1001!=u.code){c.u(3);break}return a.method="GET",w(c,t.request(s,a).promise,6);case 6:l=c.h,r=l.headers["content-type"];case 3:return c.return(r?r.toLowerCase().split(";").shift():"")}})}
/*
 @license
 Copyright 2013 Ali Al Dallal

 Licensed under the MIT license.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.
*/
for(var Sh=(new Map).set("mp4","video/mp4").set("m4v","video/mp4").set("m4a","audio/mp4").set("webm","video/webm").set("weba","audio/webm").set("mkv","video/webm").set("ts","video/mp2t").set("ogv","video/ogg").set("ogg","audio/ogg").set("mpg","video/mpeg").set("mpeg","video/mpeg").set("mov","video/quicktime").set("m3u8","application/x-mpegurl").set("mpd","application/dash+xml").set("ism","application/vnd.ms-sstr+xml").set("mp3","audio/mpeg").set("aac","audio/aac").set("flac","audio/flac").set("wav","audio/wav").set("sbv","text/x-subviewer").set("srt","text/srt").set("vtt","text/vtt").set("webvtt","text/vtt").set("ttml","application/ttml+xml").set("lrc","application/x-subtitle-lrc").set("ssa","text/x-ssa").set("ass","text/x-ssa").set("jpeg","image/jpeg").set("jpg","image/jpeg").set("png","image/png").set("svg","image/svg+xml").set("webp","image/webp").set("avif","image/avif").set("html","text/html").set("htm","text/html"),Eh={ach:"Lwo",ady:"Адыгэбзэ",af:"Afrikaans","af-NA":"Afrikaans (Namibia)","af-ZA":"Afrikaans (South Africa)",ak:"Tɕɥi",ar:"العربية","ar-AR":"العربية","ar-MA":"العربية","ar-SA":"العربية (السعودية)","ay-BO":"Aymar aru",az:"Azərbaycan dili","az-AZ":"Azərbaycan dili","be-BY":"Беларуская",bg:"Български","bg-BG":"Български",bn:"বাংলা","bn-IN":"বাংলা (ভারত)","bn-BD":"বাংলা(বাংলাদেশ)","bs-BA":"Bosanski",ca:"Català","ca-ES":"Català",cak:"Maya Kaqchikel","ck-US":"ᏣᎳᎩ (tsalagi)",cs:"Čeština","cs-CZ":"Čeština",cy:"Cymraeg","cy-GB":"Cymraeg",da:"Dansk","da-DK":"Dansk",de:"Deutsch","de-AT":"Deutsch (Österreich)","de-DE":"Deutsch (Deutschland)","de-CH":"Deutsch (Schweiz)",dsb:"Dolnoserbšćina",el:"Ελληνικά","el-GR":"Ελληνικά",en:"English","en-GB":"English (UK)","en-AU":"English (Australia)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-IN":"English (India)","en-PI":"English (Pirate)","en-UD":"English (Upside Down)","en-US":"English (US)","en-ZA":"English (South Africa)","en@pirate":"English (Pirate)",eo:"Esperanto","eo-EO":"Esperanto",es:"Español","es-AR":"Español (Argentine)","es-419":"Español (Latinoamérica)","es-CL":"Español (Chile)","es-CO":"Español (Colombia)","es-EC":"Español (Ecuador)","es-ES":"Español (España)","es-LA":"Español (Latinoamérica)","es-NI":"Español (Nicaragua)","es-MX":"Español (México)","es-US":"Español (Estados Unidos)","es-VE":"Español (Venezuela)",et:"eesti keel","et-EE":"Eesti (Estonia)",eu:"Euskara","eu-ES":"Euskara",fa:"فارسی","fa-IR":"فارسی","fb-LT":"Leet Speak",ff:"Fulah",fi:"Suomi","fi-FI":"Suomi","fo-FO":"Føroyskt",fr:"Français","fr-CA":"Français (Canada)","fr-FR":"Français (France)","fr-BE":"Français (Belgique)","fr-CH":"Français (Suisse)","fy-NL":"Frysk",ga:"Gaeilge","ga-IE":"Gaeilge (Gaelic)",gl:"Galego","gl-ES":"Galego","gn-PY":"Avañe'ẽ","gu-IN":"ગુજરાતી","gx-GR":"Ἑλληνική ἀρχαία",he:"עברית‏","he-IL":"עברית‏",hi:"हिन्दी","hi-IN":"हिन्दी",hr:"Hrvatski","hr-HR":"Hrvatski",hsb:"Hornjoserbšćina",ht:"Kreyòl",hu:"Magyar","hu-HU":"Magyar","hy-AM":"Հայերեն",id:"Bahasa Indonesia","id-ID":"Bahasa Indonesia",is:"Íslenska","is-IS":"Íslenska (Iceland)",it:"Italiano","it-IT":"Italiano",ja:"日本語","ja-JP":"日本語","jv-ID":"Basa Jawa","ka-GE":"ქართული","kk-KZ":"Қазақша",km:"ភាសាខ្មែរ","km-KH":"ភាសាខ្មែរ",kab:"Taqbaylit",kn:"ಕನ್ನಡ","kn-IN":"ಕನ್ನಡ (India)",ko:"한국어","ko-KR":"한국어 (韩国)",ku:"Kurdî","ku-TR":"Kurdî",la:"Latin","la-VA":"Latin",lb:"Lëtzebuergesch","li-NL":"Lèmbörgs",lt:"Lietuvių","lt-LT":"Lietuvių",lv:"Latviešu","lv-LV":"Latviešu",mai:"मैथिली, মৈথিলী","mg-MG":"Malagasy",mk:"Македонски","mk-MK":"Македонски (Македонски)",ml:"മലയാളം","ml-IN":"മലയാളം","mn-MN":"Монгол",mr:"मराठी","mr-IN":"मराठी",ms:"Bahasa Melayu","ms-MY":"Bahasa Melayu",mt:"Malti","mt-MT":"Malti",my:"ဗမာစကာ",nb:"Norsk (bokmål)","nb-NO":"Norsk (bokmål)",ne:"नेपाली","ne-NP":"नेपाली",nl:"Nederlands","nl-BE":"Nederlands (België)","nl-NL":"Nederlands (Nederland)","nn-NO":"Norsk (nynorsk)",no:"Norsk",oc:"Occitan","or-IN":"ଓଡ଼ିଆ",pa:"ਪੰਜਾਬੀ","pa-IN":"ਪੰਜਾਬੀ (ਭਾਰਤ ਨੂੰ)",pl:"Polski","pl-PL":"Polski","ps-AF":"پښتو",pt:"Português","pt-BR":"Português (Brasil)","pt-PT":"Português (Portugal)","qu-PE":"Qhichwa","rm-CH":"Rumantsch",ro:"Română","ro-RO":"Română",ru:"Русский","ru-RU":"Русский","sa-IN":"संस्कृतम्","se-NO":"Davvisámegiella","si-LK":"පළාත",sk:"Slovenčina","sk-SK":"Slovenčina (Slovakia)",sl:"Slovenščina","sl-SI":"Slovenščina","so-SO":"Soomaaliga",sq:"Shqip","sq-AL":"Shqip",sr:"Српски","sr-RS":"Српски (Serbia)",su:"Basa Sunda",sv:"Svenska","sv-SE":"Svenska",sw:"Kiswahili","sw-KE":"Kiswahili",ta:"தமிழ்","ta-IN":"தமிழ்",te:"తెలుగు","te-IN":"తెలుగు",tg:"забо́ни тоҷикӣ́","tg-TJ":"тоҷикӣ",th:"ภาษาไทย","th-TH":"ภาษาไทย (ประเทศไทย)",tl:"Filipino","tl-PH":"Filipino",tlh:"tlhIngan-Hol",tr:"Türkçe","tr-TR":"Türkçe","tt-RU":"татарча",uk:"Українська","uk-UA":"Українська",ur:"اردو","ur-PK":"اردو",uz:"O'zbek","uz-UZ":"O'zbek",vi:"Tiếng Việt","vi-VN":"Tiếng Việt","xh-ZA":"isiXhosa",yi:"ייִדיש","yi-DE":"ייִדיש (German)",zh:"中文","zh-HANS":"中文简体","zh-HANT":"中文繁體","zh-CN":"中文（中国）","zh-HK":"中文（香港）","zh-SG":"中文（新加坡）","zh-TW":"中文（台灣）","zu-ZA":"isiZulu"},wh=d(Object.keys(Eh)),Ah=wh.next();!Ah.done;Ah=wh.next()){var xh=Ah.value;Eh[xh.toLowerCase()]=Eh[xh]}function Ih(e,t){if(e.lineBreak)return"\n";if(e.nestedCues.length)return e.nestedCues.map(function(t){return Ih(t,e)}).join("");if(!e.payload)return e.payload;var n=[],i=e.fontWeight>=Qn,r=e.fontStyle==Zn,s=e.textDecoration.includes(ti);return i&&n.push(["b"]),r&&n.push(["i"]),s&&n.push(["u"]),r=e.color,""==r&&t&&(r=t.color),i="",(r=kh(r))&&(i+="."+r),r=e.backgroundColor,""==r&&t&&(r=t.backgroundColor),(t=kh(r))&&(i+=".bg_"+t),i&&n.push(["c",i]),n.reduceRight(function(e,t){var n=d(t);return t=n.next().value,n=n.next().value,"<"+t+(void 0===n?"":n)+">"+e+"</"+t+">"},e.payload)}function kh(e){e=e.toLowerCase();var t=e.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i);switch(t?e="#"+(256|parseInt(t[1],10)).toString(16).slice(1)+(256|parseInt(t[2],10)).toString(16).slice(1)+(256|parseInt(t[3],10)).toString(16).slice(1):e.startsWith("#")&&7<e.length&&(e=e.slice(0,7)),e){case"white":case"#fff":case"#ffffff":return"white";case"lime":case"#0f0":case"#00ff00":return"lime";case"cyan":case"#0ff":case"#00ffff":return"cyan";case"red":case"#f00":case"#ff0000":return"red";case"yellow":case"#ff0":case"#ffff00":return"yellow";case"magenta":case"#f0f":case"#ff00ff":return"magenta";case"blue":case"#00f":case"#0000ff":return"blue";case"black":case"#000":case"#000000":return"black"}return null}function Lh(e,t){var n=[];e=d(Rh(e));for(var i=e.next();!i.done;i=e.next())if(i=i.value,i.isContainer)n.push.apply(n,h(Lh(i.nestedCues,i)));else{var r=i.clone();r.nestedCues=[],r.payload=Ih(i,t),n.push(r)}return n}function Rh(e){var t=[];e=d(e);for(var n=e.next(),i={};!n.done;i={dg:void 0},n=e.next())i.dg=n.value,t.some(function(e){return function(t){return Mn(e.dg,t)}}(i))||t.push(i.dg);return t}function Ch(e){function t(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()}if(e.startTime>=e.endTime)return null;var n=new VTTCue(e.startTime,e.endTime,e.payload);n.id=t(e.startTime.toString())+t(e.endTime.toString())+t(e.payload),n.lineAlign=e.lineAlign,n.positionAlign=e.positionAlign,e.size&&(n.size=e.size);try{n.align=e.textAlign}catch(i){}return"center"==e.textAlign&&"center"!=n.align&&(n.align="middle"),"vertical-lr"==e.writingMode?n.vertical="lr":"vertical-rl"==e.writingMode&&(n.vertical="rl"),1==e.lineInterpretation&&(n.snapToLines=!1),null!=e.line&&(n.line=e.line),null!=e.position&&(n.position=e.position),n}function Dh(e,t){var n=Lh(t),i=[];t=e.cues?Array.from(e.cues):[],n=d(n);for(var r=n.next(),s={};!r.done;s={md:void 0},r=n.next())s.md=r.value,!t.some(function(e){return function(t){return t.startTime==e.md.startTime&&t.endTime==e.md.endTime&&t.text==e.md.payload}}(s))&&s.md.payload&&(r=Ch(s.md))&&i.push(r);for(t=i.slice().sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?i.indexOf(t)-i.indexOf(e):i.indexOf(e)-i.indexOf(t)}),t=d(t),n=t.next();!n.done;n=t.next())e.addCue(n.value)}function Mh(e,t){var n=!1;"disabled"===e.mode&&(n=!0,e.mode="hidden");for(var i=0;i<e.cues.length;){var r=e.cues[i];t(r)?e.removeCue(r):i++}n&&(e.mode="disabled")}function Ph(e){var t=this;this.i=e,this.l=new re,this.j=null,this.h=new Map,this.g=-1,this.s=!1,this.o=null,this.B=function(){t.l.Ja(t.i,"textchanged",t.m),t.l.Ja(t.j.textTracks,"change",t.A);for(var e=d(t.h.values()),n=e.next();!n.done;n=e.next())n.value.remove();t.h.clear(),t.g=-1,t.j=null},this.m=function(){var e=new Map,n=t.i.Bc();n=d(n);for(var i=n.next();!i.done;i=n.next()){if(i=i.value,t.h.has(i.id)){var r=t.h.get(i.id);i.active||"disabled"===r.track.mode||(r.track.mode="disabled"),t.h.delete(i.id)}else{r=t.j.ownerDocument.createElement("track"),r.kind=_h(i);var s=r,a=void 0;if(i.label)a=i.label;else if(i.language)if(i.language in Eh)a=Eh[i.language];else{var o=Ki(i.language);o in Eh&&(a=Eh[o]+" ("+i.language+")")}a||(a=i.originalTextId,i.language&&i.language!==i.originalTextId&&(a+=" ("+i.language+")")),s.label=a,i.language in Eh&&(r.srclang=i.language),"CHROMIUM"===ce().Da()&&(r.src="data:,WEBVTT"),r.track.mode="disabled",t.j.appendChild(r)}e.set(i.id,r),i.active&&(t.g=i.id)}for(n=d(t.h.values()),i=n.next();!i.done;i=n.next())i.value.remove();-1<t.g&&(e.has(t.g)?(n=e.get(t.g).track,"disabled"===n.mode&&(n.mode=t.s?"showing":"hidden")):t.g=-1),t.h=e},this.A=function(){if(!t.o){var e=t.j;t.o=new _i(function(){if(t.o=null,t.j===e){var n=-1,i=!1;if(t.h.has(t.g)){var r=t.h.get(t.g);"showing"===r.track.mode?(n=t.g,i=!0):"hidden"===r.track.mode&&(n=t.g)}if(!i)for(i=d(t.h),r=i.next();!r.done;r=i.next()){var s=d(r.value);if(r=s.next().value,s=s.next().value,"showing"===s.track.mode){n=r;break}0>n&&"hidden"===s.track.mode&&(n=r)}for(i=d(t.h),r=i.next();!r.done;r=i.next())s=d(r.value),r=s.next().value,s=s.next().value,r!==n&&"disabled"!==s.track.mode&&(s.track.mode="disabled");t.g!==n&&(t.g=n,-1<n&&t.i.eh({id:n})),t.i.jh(-1<n&&"showing"===t.h.get(n).track.mode)}}).ha(0)}},this.l.D(e,"loaded",function(){return t.enableTextDisplayer()}),this.enableTextDisplayer()}function _h(e){var t=ce();return e.forced&&"WEBKIT"===t.Da()?"forced":"caption"===e.kind||e.roles&&e.roles.some(function(e){return e.includes("transcribes-spoken-dialog")})&&e.roles.some(function(e){return e.includes("describes-music-and-sound")})?"captions":"subtitles"}function Oh(e,t){for(ge("SimpleTextDisplayer","Please migrate to NativeTextDisplayer"),this.h=e,this.i=t,this.g=null,e=d(Array.from(this.h.textTracks)),t=e.next();!t.done;t=e.next())t=t.value,"metadata"!==t.kind&&"chapters"!==t.kind&&(t.mode="disabled",t.label==this.i&&(this.g=t));this.g&&(this.g.mode="hidden")}function Nh(e){e.h&&!e.g&&(e.g=e.h.addTextTrack("subtitles",e.i),e.g.mode="hidden")}function Uh(){}function Fh(t,n){var i=this;this.m=!1,this.h=[],this.j=t,this.o=n,this.B=this.s=null,this.g=document.createElement("div"),this.g.classList.add("shaka-text-container"),this.g.style.textAlign="center",this.g.style.display="flex",this.g.style.flexDirection="column",this.g.style.alignItems="center",this.g.style.justifyContent="flex-end",this.A=new _i(function(){i.j.paused||Gh(i)}),Bh(this),this.l=new Map,this.i=new re,this.i.D(document,"fullscreenchange",function(){Gh(i,!0)}),this.i.D(this.j,"seeking",function(){Gh(i,!0)}),this.i.D(this.j,"ratechange",function(){Bh(i)}),this.i.D(this.j,"resize",function(){var e=i.j,t=e.videoWidth;e=e.videoHeight,i.s=t&&e?t/e:null}),this.C=null,"ResizeObserver"in e&&(this.C=new ResizeObserver(function(){Gh(i,!0)}),this.C.observe(this.g)),this.F=new Map}function Bh(e){e.A&&(e.h.length?e.A.Ga((e.B?e.B.captionsUpdatePeriod:.25)/Math.max(1,Math.abs(e.j.playbackRate))):e.A.stop())}function jh(e,t){for(;null!=t;){if(t==e.g)return!0;t=t.parentElement}return!1}function $h(e,t,n,i,r){var s=!1,a=[],o=[];t=d(t);for(var u=t.next();!u.done;u=t.next()){u=u.value,r.push(u);var l=e.l.get(u),c=u.startTime<=i&&u.endTime>i,h=l?l.Zi:null;l&&(a.push(l.fg),l.Wc&&a.push(l.Wc),c||(s=!0,e.l.delete(u),l=null)),c&&(o.push(u),l?jh(e,h)||(s=!0):(Vh(e,u,r),l=e.l.get(u),h=l.Zi,s=!0)),0<u.nestedCues.length&&h&&$h(e,u.nestedCues,h,i,r),r.pop()}if(s){for(i=d(a),r=i.next();!r.done;r=i.next())r=r.value,r.parentElement&&r.parentElement.removeChild(r);for(o.sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime}),o=d(o),i=o.next();!i.done;i=o.next())i=e.l.get(i.value),i.Wc?(i.Wc.contains(n)&&i.Wc.removeChild(n),n.appendChild(i.Wc),i.Wc.appendChild(i.fg)):n.appendChild(i.fg)}}function Gh(e,t){if(e.g){var n=e.j.currentTime;if(!e.m||void 0!==t&&t){t=d(e.F.values());for(var i=t.next();!i.done;i=t.next())zo(i.value);zo(e.g),e.l.clear(),e.F.clear()}e.m&&$h(e,e.h,e.g,n,[])}}function Vh(e,t,n){var i=1<n.length,r=i?"span":"div";t.lineBreak&&(r="br"),t.rubyTag&&(r=t.rubyTag),i=!i&&0<t.nestedCues.length;var s=document.createElement(r);if("br"!=r&&Kh(e,s,t,n,i),n=null,t.region&&t.region.id){var a=t.region,o=e.s===4/3?2.5:1.9;if(n=a.id+"_"+a.width+"x"+a.height+(a.heightUnits==_t?"%":"px")+"-"+a.viewportAnchorX+"x"+a.viewportAnchorY+(a.viewportAnchorUnits==_t?"%":"px"),e.F.has(n))n=e.F.get(n);else{r=document.createElement("span");var u=a.heightUnits==_t?"%":"px",l=a.widthUnits==_t?"%":"px",c=a.viewportAnchorUnits==_t?"%":"px";r.id="shaka-text-region---"+n,r.classList.add("shaka-text-region"),r.style.position="absolute";var d=a.height,h=a.width;2===a.heightUnits&&(d=5.33*a.height,u="%"),2===a.widthUnits&&(h=a.width*o,l="%"),r.style.height=d+u,r.style.width=h+l,2===a.viewportAnchorUnits?(o=a.viewportAnchorY/75*100,u=a.viewportAnchorX/(e.s===4/3?160:210)*100,o-=a.regionAnchorY*d/100,u-=a.regionAnchorX*h/100,r.style.top=o+"%",r.style.left=u+"%"):(r.style.top=a.viewportAnchorY-a.regionAnchorY*d/100+c,r.style.left=a.viewportAnchorX-a.regionAnchorX*h/100+c),0!==a.heightUnits&&0!==a.widthUnits&&0!==a.viewportAnchorUnits&&(a=Math.max(0,Math.min(100-(parseInt(r.style.width.slice(0,-1),10)||0),parseInt(r.style.left.slice(0,-1),10)||0)),r.style.top=Math.max(0,Math.min(100-(parseInt(r.style.height.slice(0,-1),10)||0),parseInt(r.style.top.slice(0,-1),10)||0))+"%",r.style.left=a+"%"),r.style.display="flex",r.style.flexDirection="column",r.style.alignItems="center",r.style.justifyContent="before"==t.displayAlign?"flex-start":"center"==t.displayAlign?"center":"flex-end",e.F.set(n,r),n=r}}r=s,i&&(r=document.createElement("span"),r.classList.add("shaka-text-wrapper"),r.style.backgroundColor=t.backgroundColor,r.style.lineHeight="normal",s.appendChild(r)),e.l.set(t,{fg:s,Zi:r,Wc:n})}function Hh(e){var t=e.direction,n=e.positionAlign;return e=e.textAlign,n!==Fn?n:"left"===e||"start"===e&&t===Vn||"end"===e&&"rtl"===t?"line-left":"right"===e||"start"===e&&"rtl"===t||"end"===e&&t===Vn?"line-right":"center"}function Kh(e,t,n,i,r){var s=t.style,a=0==n.nestedCues.length,o=1<i.length;s.whiteSpace="pre-wrap";var u=n.payload.replace(/\s+$/g,function(e){return" ".repeat(e.length)});if(s.webkitTextStrokeColor=n.textStrokeColor,s.webkitTextStrokeWidth=n.textStrokeWidth,s.color=n.color,s.direction=n.direction,s.opacity=n.opacity,s.paddingLeft=Wh(n.linePadding,n,e.o),s.paddingRight=Wh(n.linePadding,n,e.o),s.textCombineUpright=n.textCombineUpright,s.textShadow=n.textShadow,n.backgroundImage)s.backgroundImage="url('"+n.backgroundImage+"')",s.backgroundRepeat="no-repeat",s.backgroundSize="contain",s.backgroundPosition="center",n.backgroundColor&&(s.backgroundColor=n.backgroundColor),s.width="100%",s.height="100%";else{if(n.nestedCues.length)var l=t;else l=document.createElement("span"),t.appendChild(l);n.border&&(l.style.border=n.border),r||((t=qh(i,function(e){return e.backgroundColor}))?l.style.backgroundColor=t:u&&(l.style.backgroundColor="rgba(0, 0, 0, 0.8)")),u&&(l.setAttribute("translate","no"),l.textContent=u)}o&&!i[i.length-1].isContainer?s.display="inline":(s.display="flex",s.flexDirection="column",s.alignItems="center","left"==n.textAlign||"start"==n.textAlign?(s.width="100%",s.alignItems="start"):"right"!=n.textAlign&&"end"!=n.textAlign||(s.width="100%",s.alignItems="end"),s.justifyContent="before"==n.displayAlign?"flex-start":"center"==n.displayAlign?"center":"flex-end"),a||(s.margin="0"),s.fontFamily=n.fontFamily,s.fontWeight=n.fontWeight.toString(),s.fontStyle=n.fontStyle,s.letterSpacing=n.letterSpacing,s.fontSize=Wh(n.fontSize,n,e.o,e.B?e.B.fontScaleFactor:1),i=n.line,null!=i&&(a=n.lineInterpretation,a==Kn&&(a=1,o=16,e.s&&1>e.s&&(o=32),i=0>i?100+i/o*100:i/o*100),1==a&&(s.position="absolute",n.writingMode==Hn?(s.width="100%",n.lineAlign==Wn?s.top=i+"%":"end"==n.lineAlign&&(s.bottom=100-i+"%")):"vertical-lr"==n.writingMode?(s.height="100%",n.lineAlign==Wn?s.left=i+"%":"end"==n.lineAlign&&(s.right=100-i+"%")):(s.height="100%",n.lineAlign==Wn?s.right=i+"%":"end"==n.lineAlign&&(s.left=100-i+"%")))),s.lineHeight=n.lineHeight,e=Hh(n),"line-left"==e?(s.cssFloat="left",null!==n.position&&(s.position="absolute",n.writingMode==Hn?(s.left=n.position+"%",s.width="auto"):s.top=n.position+"%")):"line-right"==e?(s.cssFloat="right",null!==n.position&&(s.position="absolute",n.writingMode==Hn?(s.right=100-n.position+"%",s.width="auto"):s.bottom=n.position+"%")):null!==n.position&&50!=n.position&&(s.position="absolute",n.writingMode==Hn?(s.left=n.position+"%",s.width="auto"):s.top=n.position+"%"),s.textAlign=n.textAlign,s.textDecoration=n.textDecoration.join(" "),s.writingMode=n.writingMode,"writingMode"in document.documentElement.style&&s.writingMode==n.writingMode||(s.webkitWritingMode=n.writingMode),n.size&&(n.writingMode==Hn?s.width=n.size+"%":s.height=n.size+"%")}function Wh(e,t,n,i){i=void 0===i?1:i;var r=(r=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(r[1]),unit:r[2]}:null;if(!r)return e;switch(e=r.unit,i*=r.value,e){case"%":return i/100*n.clientHeight/t.cellResolution.rows+"px";case"c":return n.clientHeight*i/t.cellResolution.rows+"px";default:return i+e}}function qh(e,t){for(var n=e.length-1;0<=n;n--){var i=t(e[n]);if(i||0===i)return i}return null}function Yh(e,t){function n(e){for(var n=e,i=d(t),r=i.next();!r.done;r=i.next())r=r.value,r.end&&r.start<e&&(n+=r.end-r.start);return e=Math.floor(n/3600),i=Math.floor(n/60%60),r=Math.floor(n%60),n=Math.floor(1e3*n%1e3),(10>e?"0":"")+e+":"+(10>i?"0":"")+i+":"+(10>r?"0":"")+r+"."+(100>n?10>n?"00":"0":"")+n}var i=Lh(e);e="WEBVTT\n\n",i=d(i);for(var r=i.next();!r.done;r=i.next())r=r.value,e+=n(r.startTime)+" --\x3e "+n(r.endTime)+function(e){var t=[];switch(e.textAlign){case"left":t.push("align:left");break;case"right":t.push("align:right");break;case Bn:t.push("align:middle");break;case"start":t.push("align:start");break;case"end":t.push("align:end")}switch(e.writingMode){case"vertical-lr":t.push("vertical:lr");break;case"vertical-rl":t.push("vertical:rl")}return t.length?" "+t.join(" "):""}(r)+"\n",e+=r.payload+"\n\n";return e}function zh(e,t){this.h=e,this.g=t,this.i=void 0,this.s=!1,this.F=!0,this.l=this.B=!1,this.o=this.m=void 0,this.A=0,this.G=!1,this.C=new re,this.j=null}function Xh(e){e.s=!1,e.F=!0,e.B=!1,e.l=!1,e.m=0,e.o=0,e.A=0,e.G=!1,e.j=null,e.C.Qa()}function Qh(e,t){e.l=t,e.l?e.i==Sf?e.i=Ef:e.i==wf&&(e.i=Af):e.i==Ef?e.i=Sf:e.i==Af&&(e.i=wf)}function Jh(e,t){if(e.g&&e.g.enabled&&e.g.version==Tf&&e.j&&e.j.autoplay){var n=e.j.play();n&&n.then(function(){e.A=t}).catch(function(){e.A=0})}}function Zh(e,t,n){try{if(!e.g.enabled)return t;var i=tf(e);e:{switch(n.toLowerCase()){case"audio/mp4":case"audio/webm":case"audio/ogg":case"audio/mpeg":case"audio/aac":case"audio/flac":case"audio/wav":var r=pf;break e;case"video/webm":case"video/mp4":case"video/mpeg":case"video/mp2t":r=mf;break e;case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"application/dash+xml":case"video/vnd.mpeg.dash.mpd":case"application/vnd.ms-sstr+xml":r=ff;break e}r=void 0}i.ot=r,i.su=!0;var s=cf(i);return hf(t,s)}catch(a){return J("CMCD_SRC_ERROR","Could not generate src CMCD data.",a),t}}function ef(e){e.C.za(e.j,"play",function(){e.m||(e.m=Date.now())}),e.C.za(e.j,"playing",function(){e.o||(e.o=Date.now())})}function tf(t){return t.g.sessionId||(t.g.sessionId=e.crypto.randomUUID()),{v:t.g.version,sf:t.i,sid:t.g.sessionId,cid:t.g.contentId,mtp:t.h.getBandwidthEstimate()/1e3}}function nf(e,t,n){n=void 0===n?{}:n;var i=void 0===i?e.g.useHeaders:i;if(e.g.enabled)if(e=lf(e,n),i)i=df(e),Object.keys(i).length&&Object.assign(t.headers,i);else{var r=cf(e);r&&(t.uris=t.uris.map(function(e){return hf(e,r)}))}}function rf(e,t){var n=e.g.includeKeys;return n.length?Object.keys(t).reduce(function(e,i){return n.includes(i)&&(e[i]=t[i]),e},{}):t}function sf(e){if(0===e.type)return vf;if(e=e.stream){var t=e.type;if("video"==t)return e.codecs&&e.codecs.includes(",")?mf:gf;if("audio"==t)return pf;if("text"==t)return"application/mp4"===e.mimeType?bf:yf}}function af(e,t){if(t=e.h.Lb()[t],!t.length)return NaN;var n=e.h.getCurrentTime();return(e=t.find(function(e){return e.start<=n&&e.end>=n}))?1e3*(e.end-n):NaN}function of(e,t){if(t=e.h.Lb()[t],!t.length)return 0;var n=e.h.getCurrentTime();return(e=t.find(function(e){return e.start<=n&&e.end>=n}))?1e3*(e.end-n):0}function uf(e,t){var n=e.h.Ob();if(!n.length)return NaN;e=n[0],n=d(n);for(var i=n.next();!i.done;i=n.next())i=i.value,"variant"===i.type&&i.bandwidth>e.bandwidth&&(e=i);switch(t){case gf:return e.videoBandwidth||NaN;case pf:return e.audioBandwidth||NaN;default:return e.bandwidth}}function lf(e,t){t=void 0===t?{}:t,Object.assign(t,tf(e)),t.pr=e.h.sb();var n=t.ot===gf||t.ot===mf;return e.B&&n&&(t.bs=!0,t.su=!0,e.B=!1),null==t.su&&(t.su=e.F),t.v===Tf&&(e.h.V()&&(t.ltc=e.h.Se()),n=!e.G&&e.o&&e.m?e.o-(e.A||e.m):void 0,void 0!=n&&(t.msd=n,e.G=!0)),rf(e,t)}function cf(e){function t(e){return 100*n(e/100)}function n(e){return Math.round(e)}function i(e){return!Number.isNaN(e)&&null!=e&&""!==e&&!1!==e}var r=[],s={br:n,d:n,bl:t,dl:t,mtp:t,nor:function(e){return encodeURIComponent(e)},rtp:t,tb:n},a=Object.keys(e||{}).sort();a=d(a);for(var o=a.next();!o.done;o=a.next()){o=o.value;var u=e[o];if(i(u)&&("v"!==o||1!==u)&&("pr"!=o||1!==u)){var l=s[o];l&&(u=l(u)),l=typeof u;var c=void 0;c="string"===l&&"ot"!==o&&"sf"!==o&&"st"!==o?o+"="+JSON.stringify(u):"boolean"===l?o:"symbol"===l?o+"="+u.description:o+"="+u,r.push(c)}}return r.join(",")}function df(e){var t=Object.keys(e),n={},i=["Object","Request","Session","Status"],r=[{},{},{},{}],s={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,ltc:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,msd:2,bs:3,rtp:3};t=d(t);for(var a=t.next();!a.done;a=t.next())a=a.value,r[null!=s[a]?s[a]:1][a]=e[a];for(e=0;e<r.length;e++)(s=cf(r[e]))&&(n["CMCD-"+i[e]]=s);return n}function hf(e,t){return!t||e.includes("offline:")?e:(e=new Te(e),e.g.set("CMCD",t),e.toString())}i=Ph.prototype,i.configure=function(){},i.remove=function(e,t){return!!this.i&&(this.h.has(this.g)&&Mh(this.h.get(this.g).track,function(n){return n.startTime<t&&n.endTime>e}),!0)},i.append=function(e){this.h.has(this.g)&&Dh(this.h.get(this.g).track,e)},i.destroy=function(){return this.i&&(this.j&&this.B(),this.i=null),this.l&&(this.l.release(),this.l=null),Promise.resolve()},i.isTextVisible=function(){return this.s},i.setTextVisibility=function(e){if(this.s=e,this.h.has(this.g)){var t=this.h.get(this.g).track;"disabled"!==t.mode&&(e=e?"showing":"hidden",t.mode!==e&&(t.mode=e))}else if(this.i&&3===this.i.m)if(t=Array.from(this.i.h.textTracks).filter(function(e){return["captions","subtitles","forced"].includes(e.kind)}),e){e=null,t=d(t);for(var n=t.next();!n.done;n=t.next()){if(n=n.value,"showing"===n.mode){e=null;break}e||"hidden"!==n.mode||(e=n)}e&&(e.mode="showing")}else for(e=d(t),t=e.next();!t.done;t=e.next())t=t.value,"showing"===t.mode&&(t.mode="hidden")},i.setTextLanguage=function(){},i.enableTextDisplayer=function(){!this.j&&this.i&&2===this.i.m&&(this.j=this.i.h,this.l.za(this.i,"unloading",this.B),this.l.D(this.i,"textchanged",this.m),this.l.D(this.j.textTracks,"change",this.A),this.m())},K("shaka.text.NativeTextDisplayer",Ph),Ph.prototype.enableTextDisplayer=Ph.prototype.enableTextDisplayer,Ph.prototype.setTextLanguage=Ph.prototype.setTextLanguage,Ph.prototype.setTextVisibility=Ph.prototype.setTextVisibility,Ph.prototype.isTextVisible=Ph.prototype.isTextVisible,Ph.prototype.destroy=Ph.prototype.destroy,Ph.prototype.append=Ph.prototype.append,Ph.prototype.remove=Ph.prototype.remove,Ph.prototype.configure=Ph.prototype.configure,i=Oh.prototype,i.configure=function(){},i.remove=function(e,t){return!!this.g&&(Mh(this.g,function(n){return n.startTime<t&&n.endTime>e}),!0)},i.append=function(e){this.g&&Dh(this.g,e)},i.destroy=function(){return this.g&&(Mh(this.g,function(){return!0}),this.g.mode="disabled"),this.g=this.h=null,Promise.resolve()},i.isTextVisible=function(){return!!this.g&&"showing"==this.g.mode},i.setTextVisibility=function(e){e&&!this.g&&Nh(this),this.g&&(this.g.mode=e?"showing":"hidden")},i.setTextLanguage=function(){},i.enableTextDisplayer=function(){Nh(this)},K("shaka.text.SimpleTextDisplayer",Oh),Oh.prototype.enableTextDisplayer=Oh.prototype.enableTextDisplayer,Oh.prototype.setTextLanguage=Oh.prototype.setTextLanguage,Oh.prototype.setTextVisibility=Oh.prototype.setTextVisibility,Oh.prototype.isTextVisible=Oh.prototype.isTextVisible,Oh.prototype.destroy=Oh.prototype.destroy,Oh.prototype.append=Oh.prototype.append,Oh.prototype.remove=Oh.prototype.remove,Oh.prototype.configure=Oh.prototype.configure,i=Uh.prototype,i.configure=function(){},i.remove=function(){},i.append=function(){},i.destroy=function(){},i.isTextVisible=function(){return!1},i.setTextVisibility=function(){},i.setTextLanguage=function(){},i.enableTextDisplayer=function(){},K("shaka.text.StubTextDisplayer",Uh),Uh.prototype.enableTextDisplayer=Uh.prototype.enableTextDisplayer,Uh.prototype.setTextLanguage=Uh.prototype.setTextLanguage,Uh.prototype.setTextVisibility=Uh.prototype.setTextVisibility,Uh.prototype.isTextVisible=Uh.prototype.isTextVisible,Uh.prototype.destroy=Uh.prototype.destroy,Uh.prototype.append=Uh.prototype.append,Uh.prototype.remove=Uh.prototype.remove,Uh.prototype.configure=Uh.prototype.configure,i=Fh.prototype,i.configure=function(e){this.B=e,Bh(this),Gh(this,!0)},i.append=function(e){var t=[].concat(h(this.h));e=d(Rh(e));for(var n=e.next(),i={};!n.done;i={eg:void 0},n=e.next())i.eg=n.value,t.some(function(e){return function(t){return Mn(t,e.eg)}}(i))||this.h.push(i.eg);this.h.length&&Bh(this),Gh(this)},i.destroy=function(){return this.g?(this.g.parentElement&&this.o.removeChild(this.g),this.g=null,this.m=!1,this.h=[],this.A&&(this.A.stop(),this.A=null),this.l.clear(),this.i&&(this.i.release(),this.i=null),this.C&&(this.C.disconnect(),this.C=null),Promise.resolve()):Promise.resolve()},i.remove=function(e,t){if(!this.g)return!1;var n=this.h.length;return this.h=this.h.filter(function(n){return n.startTime<e||n.endTime>=t}),Gh(this,n>this.h.length),this.h.length||Bh(this),!0},i.isTextVisible=function(){return this.m},i.setTextVisibility=function(e){(this.m=e)?(this.g.parentElement||this.o.appendChild(this.g),Gh(this,!0)):this.g.parentElement&&this.o.removeChild(this.g)},i.setTextLanguage=function(e){e&&"und"!=e?this.g.setAttribute("lang",e):this.g.setAttribute("lang","")},i.enableTextDisplayer=function(){},K("shaka.text.UITextDisplayer",Fh),Fh.prototype.enableTextDisplayer=Fh.prototype.enableTextDisplayer,Fh.prototype.setTextLanguage=Fh.prototype.setTextLanguage,Fh.prototype.setTextVisibility=Fh.prototype.setTextVisibility,Fh.prototype.isTextVisible=Fh.prototype.isTextVisible,Fh.prototype.remove=Fh.prototype.remove,Fh.prototype.destroy=Fh.prototype.destroy,Fh.prototype.append=Fh.prototype.append,Fh.prototype.configure=Fh.prototype.configure,K("shaka.text.WebVttGenerator",function(){}),zh.prototype.setMediaElement=function(e){this.j=e,ef(this)},zh.prototype.configure=function(e){this.g=e};var ff="m",pf="a",gf="v",mf="av",vf="i",yf="c",bf="tt",Tf=2,Sf="d",Ef="ld",wf="h",Af="lh";function xf(e){this.h=e,this.g=null}function If(e){return!e||"false"!==e.toLowerCase()&&(/^[-0-9]/.test(e)?parseInt(e,10):e.replace(/["]+/g,""))}K("shaka.util.CmcdManager.StreamingFormat",{DASH:Sf,Kl:Ef,HLS:wf,Ll:Af,Zl:"s",OTHER:"o"}),i=xf.prototype,i.configure=function(e){this.h=e},i.Vh=function(){return this.h.enabled&&this.h.applyMaximumSuggestedBitrate&&this.g&&this.g.has(Lf)?1e3*this.g.get(Lf):null},i.Th=function(){return this.h.enabled&&this.g&&this.g.has(kf)?1e3*this.g.get(kf):null},i.Mj=function(){return this.h.enabled&&this.g&&this.g.has(Rf)?this.g.get(Rf):null},i.Nj=function(){return this.h.enabled&&this.g&&this.g.has(Cf)?this.g.get(Cf):null},i.getBandwidthEstimate=function(e){var t=this.Th();if(!t)return e;var n=this.h.estimatedThroughputWeightRatio;return 0<n&&1>=n?e*(1-n)+t*n:e},K("shaka.util.CmsdManager",xf),xf.prototype.getBandwidthEstimate=xf.prototype.getBandwidthEstimate,xf.prototype.getRoundTripTime=xf.prototype.Nj,xf.prototype.getResponseDelay=xf.prototype.Mj,xf.prototype.getEstimatedThroughput=xf.prototype.Th,xf.prototype.getMaxBitrate=xf.prototype.Vh;var kf="etp",Lf="mb",Rf="rd",Cf="rtt";function Df(){this.g=null,this.h=[]}function Mf(e,t){return U(function(n){if(1==n.g)return e.g?w(n,new Promise(function(t){return e.h.push(t)}),2):n.u(2);e.g=t,A(n)})}function Pf(t,n,i){n=void 0===n?null:n,ns.call(this);var r=this;this.m=ig,this.h=null,this.ue=n,this.oa=!1,this.ze=new re,this.me=new re,this.j=new re,this.Yb=new re,this.td=new re,this.F=this.I=this.C=this.H=null,this.Ae=0,this.$=new Df,this.N=this.nc=this.W=this.i=this.qc=this.G=this.l=this.je=this.S=this.Dh=this.ka=this.L=this.Za=this.wa=this.ke=this.P=this.Ba=this.K=this.eb=null,this.Ka=!1,this.Ta=this.s=null,this.se=1e9,this.ye=[],this.ab=[],this.Rf=-1,this.g=Ip(this),this.Tf=Fd(),this.U=null,this.Ce=-1,this.Xb=null,this.va={width:1/0,height:1/0},this.re=new Ma(this.g,this.va,null),this.we=[],this.A=null,this.M=this.g.adaptationSetCriteriaFactory(),this.M.configure({language:this.g.preferredAudioLanguage,role:this.g.preferredVariantRole,channelCount:0,Cc:this.g.preferredVideoHdrLevel,spatialAudio:this.g.preferSpatialAudio,videoLayout:this.g.preferredVideoLayout,Ic:this.g.preferredAudioLabel,Bd:this.g.preferredVideoLabel,codecSwitchingStrategy:this.g.mediaSource.codecSwitchingStrategy,audioCodec:"",Dd:"",De:0,preferredAudioCodecs:this.g.preferredAudioCodecs,preferredAudioChannelCount:this.g.preferredAudioChannelCount}),this.ud=this.g.preferredTextLanguage,this.qe=this.g.preferredTextRole,this.pe=this.g.preferForcedSubs,this.oe=[],i&&i(this),this.L=hp(this),this.ka=new xf(this.g.cmsd),this.H=rp(this),this.wd=this.ia=this.ya=this.B=null,this.Vf=!1,this.Sf=[],this.Uf=new _i(function(){return U(function(e){return 1==e.g?r.ia?w(e,r.dc(r.wd,!0),3):e.u(0):4!=e.g?w(e,r.load(r.ia),4):(r.Vf?r.wd.pause():r.wd.play(),r.ia=null,r.Vf=!1,void A(e))})}),ug&&(this.B=ug(),this.B.configure(this.g.ads),this.td.D(this.B,"ad-content-pause-requested",function(e){var t;return U(function(n){if(1==n.g)return r.Uf.stop(),r.ia?n.u(0):(r.wd=r.h,r.Vf=r.Ud(),t=e.saveLivePosition||!1,w(n,r.Nh(!0,t),3));r.ia=n.h,A(n)})}),this.td.D(this.B,"ad-content-resume-requested",function(e){if(e=e.offset||0,r.ia){var t=r.ia;t.m&&e&&("number"===typeof t.m?t.m+=e:t.m.setTime(t.m.getTime()+1e3*e))}r.Uf.ha(.1)}),this.td.D(this.B,"ad-content-attach-requested",function(){return U(function(e){return r.h||!r.wd?e.u(0):w(e,r.dc(r.wd,!0),0)})})),lg&&(this.ya=lg(this),this.ya.configure(this.g.queue)),this.ze.D(e,"online",function(){qp(r),r.Zg()}),this.ve=new _i(function(){for(var e=Date.now()/1e3,t=!1,n=!0,i=d(r.i.variants),s=i.next();!s.done;s=i.next())s=s.value,0<s.disabledUntilTime&&s.disabledUntilTime<=e&&(s.disabledUntilTime=0,t=!0),0<s.disabledUntilTime&&(n=!1);n&&r.ve.stop(),t&&Op(r,!1,void 0,!1,!1)}),this.Oa=null,t&&(ge("Player w/ mediaElement","Please migrate from initializing Player with a mediaElement; use the attach method instead."),this.dc(t,!0)),this.o=null}function _f(e){null!=e.S&&(bt(e.S),e.S.release(),e.S=null)}function Of(e,t,n){n||t.lcevc.enabled?(_f(e),null==e.S&&(e.S=new vt(e.h,e.Dh,t.lcevc,n),e.I&&(e.I.M=e.S))):_f(e)}function Nf(e,t){return new Zr(e,t)}function Uf(e,t){og.set(e,t)}function Ff(e,t){e.dispatchEvent(Nf("onstatechange",(new Map).set("state",t)))}function Bf(e,t){var n;return U(function(i){return 1==i.g?(n=++e.Ae,w(i,Mf(e.$,t),2)):n!=e.Ae?(e.$.release(),i.return(!0)):i.return(!1)})}function jf(e){for(var t=d(e.i.variants),n=t.next();!n.done;n=t.next())n=n.value,n.video&&(n.video.closeSegmentIndex(),n.video=null),n.bandwidth=n.audio&&n.audio.bandwidth?n.audio.bandwidth:0;e.i.variants=e.i.variants.filter(function(e){return e.audio})}function $f(e,t){var n,i;return t=void 0!==t&&t,U(function(r){if(1==r.g)return n=null,e.i&&e.G&&e.qc&&e.W&&e.g?(i=e.h.currentTime,e.V()&&!t&&(i=null),w(r,Vf(e,e.W,i,e.nc,e.g,!0,!1,!1),3)):r.u(2);if(2!=r.g){n=r.h,e.we.push(n),e.G&&e.G.setMediaElement&&e.G.setMediaElement(null);var s=n,a=e.G,o=e.qc;s.h=e.i,s.l=a,s.G=o,s=n,a=e.Ta,s.j=e.s,s.C=a,n.A=e.M,n.start(),e.i=null,e.G=null,e.qc=null,e.s=null,e.Ta=null}return r.return(n)})}function Gf(e,t,n,i,r,s){var a,o,u,l;return r=void 0!==r&&r,U(function(c){return 1==c.g?i?c.u(2):w(c,Hf(e,t),3):(2!=c.g&&(i=c.h),Kf(e,i)?c.return(null):(a=s||e.g,o=!1,u=!0,r&&(e.s&&e.Ta==a.abrFactory&&(u=!1),e.h&&"AUDIO"===e.h.nodeName&&(o=!0)),l=Vf(e,t,n,i||null,a,!r,o,u),l=r?l.then(function(e){return e.B=!1,e}):l.then(function(t){return e.we.push(t),t}),c.return(l)))})}function Vf(e,t,n,i,r,s,a,o){var u,l,c,h,f,p,g,m,v,y,b,T,S,E,x;return s=void 0===s||s,a=void 0!==a&&a,o=void 0===o||o,U(function(I){return 1==I.g?(u=null,l=qt(r),a&&(l.manifest.disableVideo=!0),c=function(){return u.S&&u.o?null:u},h=function(){return c()?c().getConfiguration():e.g},1/0!=e.va.width||1/0!=e.va.height||e.g.ignoreHardwareResolution?I.u(2):(f=ce(),w(I,f.fc(),3))):(2!=I.g&&(p=I.h,e.va.width=p.width,e.va.height=p.height),g=new Ma(l,e.va,null),m={networkingEngine:e.H,filter:function(e){var t,n;return U(function(i){return 1==i.g?w(i,Pa(g,e),2):4!=i.g?(t=i.h,t?(n=Nf("trackschanged"),w(i,Promise.resolve(),4)):i.u(0)):(u.dispatchEvent(n),void A(i))})},makeTextStreamsForClosedCaptions:function(t){return kp(e,t)},onTimelineRegionAdded:function(e){lc(u.H,e)},onEvent:function(e){return u.dispatchEvent(e)},onError:function(e){return u.onError(e)},isLowLatencyMode:function(){return h().streaming.lowLatencyMode},updateDuration:function(){e.l&&u.S&&e.l.updateDuration()},newDrmInfo:function(e){var t=u.i,n=t?t.g:null;n&&t.A&&Na(g,n.keySystem,e)},onManifestUpdated:function(){var t=(new Map).set("isLive",e.V());u.dispatchEvent(Nf("manifestupdated",t)),th(u,!1,function(){e.B&&e.B.onManifestUpdated(e.V())})},getBandwidthEstimate:function(){return e.s.getBandwidthEstimate()},onMetadata:function(t,n,i,r){var s=t;"com.apple.hls.interstitial"==t&&(s="com.apple.quicktime.HLS",t={startTime:n,endTime:i,values:r},e.B)&&e.B.onHLSInterstitialMetadata(e,e.h,t),r=d(r),t=r.next();for(var a={};!t.done;a={Sg:void 0},t=r.next())a.Sg=t.value,"ID"!=a.Sg.name&&th(u,!1,function(t){return function(){np(e,n,i,s,t.Sg)}}(a))},disableStream:function(t){return e.disableStream(t,e.g.streaming.maxDisabledTime)},addFont:function(t,n){return e.addFont(t,n)}},v=new uc(function(){return e.Ra()}),v.addEventListener("regionadd",function(t){var n=t.region;zp(e,"timelineregionadded",n,u),th(u,!1,function(){e.B&&(e.B.onDashTimedMetadata(n),e.B.onDASHInterstitialMetadata(e,e.h,n))})}),y=null,l.streaming.observeQualityChanges&&(y=new nc(function(){return e.Lb()}),y.addEventListener("qualitychange",function(t){Xp(e,t.quality,t.position)}),y.addEventListener("audiotrackchange",function(t){Xp(e,t.quality,t.position,!0)})),b=!0,T={pc:e.H,onError:function(e){return u.onError(e)},nf:function(t){th(u,!0,function(){if(e.C){var n=t,i=Nf("keystatuschanged");e.dispatchEvent(i);var r=Object.keys(n);1==r.length&&""==r[0]&&(r=["00"],n={"00":n[""]}),i=1==r.length&&"00"==r[0];var s=!1;if(r.length){r=e.keySystem();for(var a=Es(e.g.drm.clearKeys),o=d(e.i.variants),u=o.next();!u.done;u=o.next()){u=u.value;var l=[];u.audio&&l.push(u.audio),u.video&&l.push(u.video),l=d(l);for(var c=l.next();!c.done;c=l.next()){var h=c.value;if(c=u.allowedByKeySystem,h.keyIds.size)if(h.drmInfos.length&&!a.size){h=d(h.drmInfos);for(var f=h.next();!f.done;f=h.next())if(f=f.value,f.keyIds.size&&f.keySystem==r){u.allowedByKeySystem=!0,f=d(f.keyIds);for(var p=f.next();!p.done;p=f.next())p=p.value,((p=n[i?"00":p])||e.C.F)&&(u.allowedByKeySystem=u.allowedByKeySystem&&!!p&&!Fa.includes(p))}}else for(u.allowedByKeySystem=!0,h=d(h.keyIds),f=h.next();!f.done;f=h.next())f=f.value,((f=n[i?"00":f])||e.C.F)&&(u.allowedByKeySystem=u.allowedByKeySystem&&!!f&&!Fa.includes(f));c!=u.allowedByKeySystem&&(s=!0)}}}s&&(Bp(e),!_p(e))||(n=e.l.o)&&!n.allowedByKeySystem&&Op(e)}})},onExpirationUpdated:function(e,t){var n=Nf("expirationupdated");u.dispatchEvent(n),(n=u.l)&&n.onExpirationUpdated&&n.onExpirationUpdated(e,t)},onEvent:function(t){u.dispatchEvent(t),"drmsessionupdate"==t.type&&b&&(b=!1,t=Date.now()/1e3-u.Ka,(e.A||u.getStats()).m=t,e.S&&bt(e.S))}},S=rp(e,c),os(e.H,S),E=function(){return e.ed(T)},x={config:l,lk:m,Ak:v,zk:y,ed:E,kk:g,networkingEngine:S,cj:s,bj:o},u=new eh(t,i,n,x),I.return(u))})}function Hf(e,t){var n,i,r;return U(function(s){return 1==s.g?(n=e.g.manifest.retryParameters,w(s,Th(t,e.H,n),2)):(i=s.h,"application/x-mpegurl"==i&&(r=ce(),"WEBKIT"===r.Da()&&(i="application/vnd.apple.mpegurl")),s.return(i))})}function Kf(e,t){if(!KT(ce()))return!0;if(t){if(""==(e.h||Xo()).canPlayType(t))return!1;if(!KT(ce())||!Va.has(t))return!0;if(Ti(t))return"WEBKIT"===ce().Da()&&(e.g.drm.servers["com.apple.fps"]||e.g.drm.servers["com.apple.fps.1_0"])?e.g.streaming.useNativeHlsForFairPlay:e.g.streaming.preferNativeHls;if("application/dash+xml"===t||"video/vnd.mpeg.dash.mpd"===t)return e.g.streaming.preferNativeDash}return!1}function Wf(e){var t=e.g.textDisplayFactory;if(e.Ch!==t){var n=e.o;e.o=t(),e.o.configure?e.o.configure(e.g.textDisplayer):ge("Text displayer w/ configure",'Text displayer should have a "configure" method!'),e.o.setTextLanguage||ge("Text displayer w/ setTextLanguage",'Text displayer should have a "setTextLanguage" method!'),n?(e.o.setTextVisibility(n.isTextVisible()),n.destroy().catch(function(){})):e.o.setTextVisibility(e.oa),e.I&&ol(e.I,e.o),e.Ch=t,e.l&&Fc(e.l)}else e.o&&e.o.configure&&e.o.configure(e.g.textDisplayer)}function qf(e){var t,n,i;return U(function(r){if(1==r.g)return ce(),Ff(e,"media-source"),e.g.mediaSource.useSourceElements&&Yo(e.h),Wf(e),t=dp(e.h,e.o,{Cj:function(){return e.keySystem()},onMetadata:function(t,n,i){t=d(t);for(var r=t.next();!r.done;r=t.next())if(r=r.value,r.data&&"number"==typeof r.cueTime&&r.frames){var s=r.cueTime+n,a=i;a&&s>a&&(a=s);for(var o=d(r.frames),u=o.next();!u.done;u=o.next())np(e,s,a,"org.id3",u.value);e.B&&e.B.onHlsTimedMetadata(r,s)}},tk:function(t){e.Za&&lc(e.Za,{schemeIdUri:t.schemeIdUri,startTime:t.startTime,endTime:t.endTime,id:String(t.id),emsg:t})},onEvent:function(t){return e.dispatchEvent(t)},wk:function(){e.G&&e.G.update&&e.G.update()}},e.S,e.g.mediaSource),n=e.g.manifest,i=n.segmentRelativeVttTiming,t.Ka=i,w(r,t.K,2);e.I=t,A(r)})}function Yf(e,t,n){function i(){return Dp(e)}if(e.j.D(t,"playing",i),e.j.D(t,"pause",i),e.j.D(t,"ended",i),e.j.D(t,"ratechange",function(){var t=e.h.playbackRate;0!=t&&(e.K&&(e.K.set(t),e.m==rg&&e.s.playbackRateChanged(t),Cp(e,t)),t=Nf("ratechange"),e.dispatchEvent(t))}),t.remote&&(e.j.D(t.remote,"connect",function(){e.l&&"connected"==t.remote.state&&Vp(e),Bp(e)}),e.j.D(t.remote,"connecting",function(){return Bp(e)}),e.j.D(t.remote,"disconnect",function(){return U(function(n){if(1==n.g)return e.l&&"disconnected"==t.remote.state?w(n,dd(e.l),3):n.u(2);2!=n.g&&Vp(e),Bp(e),A(n)})})),t.audioTracks&&(e.j.D(t.audioTracks,"addtrack",function(){return Bp(e)}),e.j.D(t.audioTracks,"removetrack",function(){return Bp(e)}),e.j.D(t.audioTracks,"change",function(){return Bp(e)})),t.videoTracks&&(e.j.D(t.videoTracks,"addtrack",function(){return Bp(e)}),e.j.D(t.videoTracks,"removetrack",function(){return Bp(e)}),e.j.D(t.videoTracks,"change",function(){return Bp(e)})),t.textTracks){var r=function(){e.m===sg&&e.o instanceof Ph&&Vp(e),Bp(e)};e.j.D(t.textTracks,"addtrack",function(t){if(t.track)switch(t=t.track,t.kind){case"metadata":ep(e,t);break;case"chapters":ip(e,t);break;default:r()}}),e.j.D(t.textTracks,"removetrack",r),e.j.D(t.textTracks,"change",r),"keep"!==e.g.streaming.crossBoundaryStrategy&&(e.j.D(t,"waiting",function(){e.l&&fd(e.l)}),e.j.D(t,"timeupdate",function(){e.l&&fd(e.l)}))}"none"!=t.preload&&e.j.za(t,"loadedmetadata",function(){e.A.F=Date.now()/1e3-n})}function zf(t,n,i,r){var s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,x,I,k,L,R,C,D,M,P,_,O;return U(function(N){switch(N.g){case 1:Ff(t,"load"),s=t.h,t.K=new Jl({Te:function(){return s.playbackRate},Oc:function(){return s.defaultPlaybackRate},ih:function(e){s.playbackRate=e},li:function(e){s.currentTime+=e}}),Yf(t,s,n),"onchange"in e.screen&&t.j.D(e.screen,"change",function(){if(t.M.getConfiguration){var e=t.M.getConfiguration();"AUTO"==e.Cc?_p(t):"AUTO"==t.g.preferredVideoHdrLevel&&t.g.abr.enabled&&(e.Cc="AUTO",t.M.configure(e),_p(t))}}),a=!1,o=d(t.i.variants);for(u=o.next();!u.done;u=o.next())l=u.value,(c=l.video&&l.video.dependencyStream)&&(a=Tt(c));Of(t,t.g,a),t.ud=t.g.preferredTextLanguage,t.qe=t.g.preferredTextRole,t.pe=t.g.preferForcedSubs,Jp(t.i.presentationTimeline,t.g.playRangeStart,t.g.playRangeEnd),t.s.init(function(e,n,i){t.i&&t.l&&e!=t.l.o&&Np(t,e,!0,void 0!==n&&n,void 0===i?0:i)}),t.s.setMediaElement(s),t.s.setCmsdManager(t.ka),t.l=fp(t),t.l.configure(t.g.streaming),t.m=rg,t.dispatchEvent(Nf("streaming")),h=i;case 2:for((p=t.l.o)||h||(h=_p(t)?t.s.chooseVariant():null),g=[],f=p||h,m=d([f.video,f.audio]),v=m.next();!v.done;v=m.next())(y=v.value)&&!y.segmentIndex&&(g.push(y.createSegmentIndex()),y.dependencyStream&&g.push(y.dependencyStream.createSegmentIndex()));if(!(0<g.length)){N.u(4);break}return w(N,Promise.all(g),4);case 4:if(!f||0!=f.disabledUntilTime){N.u(2);break}if(t.G&&t.G.onInitialVariantChosen&&t.G.onInitialVariantChosen(f),t.i.isLowLatency&&(t.g.streaming.lowLatencyMode?t.configure(t.Tf):Q("Low-latency live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.")),t.L&&(Qh(t.L,t.i.isLowLatency&&t.g.streaming.lowLatencyMode),Jh(t.L,1e3*n)),Jp(t.i.presentationTimeline,t.g.playRangeStart,t.g.playRangeEnd),Mc(t.l,t.g.playRangeStart,t.g.playRangeEnd),t.Ka=!0,t.dispatchEvent(Nf("canupdatestarttime")),b=function(e){t.F=sp(t,e),t.eb=ap(t,e),up(t,s,!1)},t.g.streaming.startAtSegmentBoundary||(T=t.N,null==T&&t.i.startTime&&(T=t.i.startTime),b(T)),p){N.u(7);break}if(!t.g.streaming.startAtSegmentBoundary){N.u(8);break}return S=t.i.presentationTimeline,t.N instanceof Date&&(x=S.m||S.i,I=t.N.getTime()/1e3-x,null!=I&&(E=I)),null==E&&(E="number"===typeof t.N?t.N:t.h.currentTime),null==t.N&&t.i.startTime&&(E=t.i.startTime),k=S.Vb(),L=S.Eb(),E<k?E=k:E>L&&(E=L),w(N,Lp(h,E),9);case 9:R=N.h,b(R);case 8:Np(t,h,!0,!1,0);case 7:return t.F.ready(),C=t.Bc().find(function(e){return e.active}),C||((D=Sr(t.i.textStreams,t.ud,t.qe,t.pe)[0]||null)&&qd(t.A.h,D,!0),h&&(D?(xr(h.audio,D,t.g)&&(t.oa=!0),t.oa&&t.o.setTextVisibility(!0)):(t.oa=!1,t.o.setTextVisibility(!1)),Hp(t)),D&&(t.g.streaming.alwaysStreamText||t.Ig())&&(Uc(t.l,D),Wp(t))),w(N,t.l.start(r),10);case 10:t.g.abr.enabled&&(t.s.enable(),Kp(t)),Bp(t),_p(t),t.i.variants.some(function(e){return e.primary}),((M=t.V())&&(t.g.streaming.liveSync&&t.g.streaming.liveSync.enabled||t.i.serviceDescription||t.g.streaming.liveSync.panicMode)||t.g.streaming.vodDynamicPlaybackRate)&&(P=function(){return Mp(t)},t.j.D(s,"timeupdate",P)),M||(_=function(){return Pp(t)},t.j.D(s,"timeupdate",_),Pp(t),t.i.nextUrl&&(0<t.g.streaming.preloadNextUrlWindow&&(O=function(){var e;return U(function(n){if(1==n.g)return e=t.Ra().end-t.h.currentTime,!isNaN(e)&&e<=t.g.streaming.preloadNextUrlWindow?(t.j.Ja(s,"timeupdate",O),w(n,t.preload(t.i.nextUrl),4)):n.u(0);t.Oa=n.h,A(n)})},t.j.D(s,"timeupdate",O)),t.j.D(s,"ended",function(){t.load(t.Oa||t.i.nextUrl)}))),t.B&&t.B.onManifestUpdated(M),A(N)}})}function Xf(e,t){var n,i,r,s,a;return U(function(o){return 1==o.g?(n=pt,i=Date.now()/1e3,r=!0,e.C=e.ed({pc:e.H,onError:function(t){Yp(e,t)},nf:function(){},onExpirationUpdated:function(){var t=Nf("expirationupdated");e.dispatchEvent(t)},onEvent:function(t){e.dispatchEvent(t),"drmsessionupdate"==t.type&&r&&(r=!1,e.A.m=Date.now()/1e3-i)}}),e.C.configure(e.g.drm),s={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},a={id:0,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:t?yi(t):"",codecs:t?bi(t):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:n.xa,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null},a.fullMimeTypes.add(hi(a.mimeType,a.codecs)),t.startsWith("audio/")?(a.type=n.ea,s.audio=a):s.video=a,e.C.$=!0,w(o,Vs(e.C,[s],[]),2)):w(o,e.C.dc(e.h),0)})}function Qf(e,t,n){var i,r,s,a,o,u,l,c,h,f,p,g;return U(function(m){switch(m.g){case 1:if(Ff(e,"src-equals"),i=e.h,e.F=new Ul(i),r=!1,e.oe.push(function(){r=!0}),e.dispatchEvent(Nf("canupdatestarttime")),null!=e.N&&e.F.Qf(e.N),e.eb=op(e,e.N||0),e.K=new Jl({Te:function(){return i.playbackRate},Oc:function(){return i.defaultPlaybackRate},ih:function(e){i.playbackRate=e},li:function(e){i.currentTime+=e}}),up(e,i,!0),i.textTracks&&(Wf(e),s=function(t){if(!(e.o instanceof Ph)){var n=bp(e).find(function(e){return"disabled"!==e.mode});n&&(n.mode=t?"showing":"hidden"),e.o instanceof Oh&&(n=Tp(e))&&(n.mode=!t&&e.o.isTextVisible()?"showing":"hidden")}},e.j.D(i,"enterpictureinpicture",function(){return s(!0)}),e.j.D(i,"leavepictureinpicture",function(){return s(!1)}),i.remote?(e.j.D(i.remote,"connect",function(){return s(!1)}),e.j.D(i.remote,"connecting",function(){return s(!1)}),e.j.D(i.remote,"disconnect",function(){return s(!1)})):"webkitCurrentPlaybackTargetIsWireless"in i&&e.j.D(i,"webkitcurrentplaybacktargetiswirelesschanged",function(){return s(!1)}),a=i,a.webkitSupportsFullscreen&&e.j.D(a,"webkitpresentationmodechanged",function(){return s("inline"!==a.webkitPresentationMode)})),Yf(e,i,t),o=Zh(e.L,e.W,n),!o.includes("#t=")&&(0<e.g.playRangeStart||isFinite(e.g.playRangeEnd))&&(o+="#t=",0<e.g.playRangeStart&&(o+=e.g.playRangeStart),isFinite(e.g.playRangeEnd)&&(o+=","+e.g.playRangeEnd)),!e.I){m.u(2);break}return w(m,e.I.destroy(),3);case 3:e.I=null;case 2:return Yo(i),i.src=o,u=ce(),"TV"==u.La()&&i.load(),"none"!=i.preload&&!i.autoplay&&Ti(n)&&"WEBKIT"===u.Da()&&i.load(),e.m=sg,e.dispatchEvent(Nf("streaming")),l=new Kr,Ll(i,HTMLMediaElement.HAVE_METADATA,e.j,function(){e.F.ready(),l.resolve()}),c=function(){return new Promise(function(t){var n=new _i(t);e.j.D(i.textTracks,"change",function(){return n.ha(.5)}),n.ha(.5)})},Ll(i,HTMLMediaElement.HAVE_CURRENT_DATA,e.j,function(){var t,n,i,s,a;return U(function(o){if(1==o.g)return w(o,c(),2);if(r)return o.return();if(Jf(e),t=bp(e),t.some(function(e){return"showing"===e.mode})&&(e.oa=!0,e.o.setTextVisibility(!0)),!(e.o instanceof Ph))for(t.length&&(e.o.enableTextDisplayer?e.o.enableTextDisplayer():ge("Text displayer w/ enableTextDisplayer",'Text displayer should have a "enableTextDisplayer" method')),n=!1,i=d(t),s=i.next();!s.done;s=i.next())a=s.value,"disabled"!==a.mode&&(n?(a.mode="disabled",Q("Found more than one enabled text track, disabling it",a)):(yp(e,a),n=!0));Zf(e),A(o)})}),i.error?l.reject(Qp(e)):"none"==i.preload&&(Q('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),l.resolve()),e.j.za(i,"error",function(){l.reject(Qp(e))}),w(m,Fi(e.g.streaming.loadTimeout,l),4);case 4:((h=e.V())&&(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled||e.g.streaming.liveSync.panicMode)||e.g.streaming.vodDynamicPlaybackRate)&&(f=function(){return Mp(e)},e.j.D(i,"timeupdate",f)),h||(p=function(){return Pp(e)},e.j.D(i,"timeupdate",p),Pp(e)),e.B&&(e.B.onManifestUpdated(h),h&&(g=e.Ra().end,e.j.D(i,"progress",function(){var t=e.Ra().end;g!=t&&(e.B.onManifestUpdated(e.V()),g=t)}))),e.Ka=!0,A(m)}})}function Jf(e){var t=e.g.preferredAudioLanguage;""!=t&&e.Fi(t,e.g.preferredVariantRole)}function Zf(e){var t=e.g.preferredTextLanguage;""!=t&&e.dh(t,e.g.preferredTextRole,e.g.preferForcedSubs)}function ep(e,t){if("metadata"==t.kind){t.mode="hidden",e.j.D(t,"cuechange",function(){if(t.activeCues)for(var n=d(t.activeCues),i=n.next();!i.done;i=n.next())i=i.value,np(e,i.startTime,i.endTime,i.type,i.value),e.B&&e.B.onCueMetadataChange(i.value);if(t.cues){n=[],i=d(t.cues);for(var r=i.next(),s={};!r.done;s={wc:void 0},r=i.next())s.wc=r.value,"com.apple.quicktime.HLS"==s.wc.type&&null!=s.wc.startTime&&(r=n.find(function(e){return function(t){return t.startTime==e.wc.startTime&&t.endTime==e.wc.endTime}}(s)),r||(r={startTime:s.wc.startTime,endTime:s.wc.endTime,values:[]},n.push(r)),r.values.push(s.wc.value));for(n=d(n),i=n.next();!i.done;i=n.next())i=i.value,i.values.some(function(e){return"X-ASSET-URI"==e.key||"X-ASSET-LIST"==e.key})&&e.B&&(i.values.push({key:"CUE",description:"",data:0!=i.startTime||e.V()?"ONCE":"ONCE,PRE",mimeType:null,pictureType:null}),e.B.onHLSInterstitialMetadata(e,e.h,i))}});var n=new _i(function(){var t=Sp(e);t=d(t);for(var n=t.next();!n.done;n=t.next())n.value.mode="hidden"}).Hb().ha(.5);e.oe.push(function(){n.stop()})}}function tp(e,t,n){t=(new Map).set("startTime",t.startTime).set("endTime",t.endTime).set("metadataType",t.schemeIdUri).set("payload",t.payload),e.dispatchEvent(Nf(n,t))}function np(e,t,n,i,r){e.wa&&(t={schemeIdUri:i,startTime:t,endTime:n||1/0,id:"",payload:r},t.id=JSON.stringify(t),lc(e.wa,t))}function ip(e,t){if(t&&"chapters"==t.kind){t.mode="hidden";var n=new _i(function(){t.mode="hidden"}).Hb().ha(.5);e.oe.push(function(){n.stop()})}}function rp(e,t){function n(n){t()?t().dispatchEvent(n):e.dispatchEvent(n)}function i(e){t()?th(t(),!0,e):e()}t||(t=function(){return null});var r=new ss(function(n,i,r,s,a){var o=t()?t().j:e.s;o&&o.segmentDownloaded(n,i,r,s,a)},function(t,r,s){r=(new Map).set("headers",t).set("request",r).set("requestType",s),n(Nf("downloadheadersreceived",r)),i(function(){if(e.ka){var n=e.ka;if(n.h.enabled){var i=t["cmsd-static"];if(i)try{var r=new Map,s=i.split(",");for(i=0;i<s.length;i++){var a=s[i].split("=");r.set(a[0],If(a[1]))}}catch(d){}if(r=t["cmsd-dynamic"]){try{var o=new Map,u=r.split(";");for(r=1;r<u.length;r++){var l=u[r].split("=");o.set(l[0],If(l[1]))}var c=o}catch(d){c=null}c&&(n.g=c)}}}})},function(e,t){e=(new Map).set("request",e).set("response",t),n(Nf("downloadcompleted",e))},function(e,t,i,r){e=(new Map).set("request",e).set("error",t).set("httpResponseCode",i).set("aborted",r),n(Nf("downloadfailed",e))},function(t,n,r){i(function(){var i=e.L,s=r;if(s=void 0===s?{}:s,i.g.enabled)if("HEAD"===n.method)nf(i,n);else switch(t){case 0:try{if(i.g.enabled){if(s.type){e:{switch(s.type){case 4:var a=i.l?Ef:Sf;break e;case 3:case 2:a=i.l?Af:wf;break e;case 5:a="s";break e}a=void 0}i.i=a}nf(i,n,{ot:ff,su:!i.s})}}catch(k){J("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",k)}break;case gs:try{if(i.g.enabled){var o=n.uris[0],u=s.segment;a=0,u&&(a=u.endTime-u.startTime);var l={d:1e3*a,st:i.h.V()?"l":"v"};l.ot=sf(s);var c=l.ot===gf||l.ot===pf||l.ot===mf||l.ot===bf,d=s.stream;if(d){var h=i.h.sb();if(c&&(l.bl=af(i,d.type),l.ot!==bf)){var f=of(i,d.type);l.dl=h?f/Math.abs(h):f}if(d.bandwidth&&(l.br=d.bandwidth/1e3),d.segmentIndex&&u){var p=d.segmentIndex.Ub(u.endTime,!0,0>h);if(p){var g=p.next().value;if(g&&g!=u){if(o&&!Bt(u.O(),g.O())){var m=g.O()[0],v=new URL(m),y=new URL(o);if(v.origin!==y.origin)var b=m;else{for(var T=v.pathname.split("/").slice(1),S=y.pathname.split("/").slice(1,-1);T[0]===S[0];)T.shift(),S.shift();for(;S.length;)S.shift(),T.unshift("..");b=T.join("/")}l.nor=b}if((g.startByte||g.endByte)&&(u.startByte!=g.startByte||u.endByte!=g.endByte)){var E=g.startByte+"-";g.endByte&&(E+=g.endByte),l.nrr=E}}}var w=i.h.sb()||1,A=of(i,d.type)||500,x=d.bandwidth,I=x?x*(u.endTime-u.startTime)/1e3/(A/w/1e3)*i.g.rtpSafetyFactor:NaN;isNaN(I)||(l.rtp=I)}}c&&l.ot!==bf&&(l.tb=uf(i,l.ot)/1e3),nf(i,n,l)}}catch(k){J("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",k)}break;case 2:case 5:case 6:nf(i,n,{ot:"k"});break;case 4:nf(i,n,{ot:"o"})}})},function(n,i,r,s){(n=t()?t().l:e.G)&&n.banLocation&&n.banLocation(s)},function(n,i){if(i.data){i=i.data.byteLength;var r=t()?t().getStats():e.A;r&&(Jd(r,i),0===n&&(r.di=i))}});return r.configure(e.g.networking),r}function sp(e,t){return new jl(e.h,e.i,e.g.streaming,t,function(){e.eb&&tc(e.eb,!0),e.l&&e.l.Xc(),e.P&&cp(e)},function(t){return e.dispatchEvent(t)})}function ap(e,t){var n=e.V()||"number"===typeof t&&0<t;t=new gh(e.ke,n),t.addEventListener("enter",function(t){zp(e,"timelineregionenter",t.region)}),t.addEventListener("exit",function(t){zp(e,"timelineregionexit",t.region)}),t.addEventListener("skip",function(t){var n=t.region;t.seeking||(zp(e,"timelineregionenter",n),zp(e,"timelineregionexit",n))});var i=new gh(e.wa,n);i.addEventListener("enter",function(t){tp(e,t.region,"metadata")}),n=new gh(e.Za,n),n.addEventListener("enter",function(t){t=(new Map).set("detail",t.region.emsg),e.dispatchEvent(Nf("emsg",t))});var r=new ec(e.h);return r.g.add(t),r.g.add(i),r.g.add(n),e.je&&r.g.add(e.je),r}function op(e,t){t=new gh(e.wa,t instanceof Date||0<t),t.addEventListener("enter",function(t){tp(e,t.region,"metadata")});var n=new ec(e.h);return n.g.add(t),n}function up(e,t,n){e.P=new Ra,e.P.g=Ca,lp(e),Rp(e),e.Ba=new _i(function(){cp(e)}),e.g.streaming.rebufferingGoal&&e.Ba.Ga(.25),e.j.D(t,"waiting",function(){return cp(e)}),e.j.D(t,"canplaythrough",function(){return cp(e)}),e.j.D(t,"playing",function(){return cp(e)}),e.j.D(t,"seeked",function(){return cp(e)}),n&&(e.j.D(t,"stalled",function(){return cp(e)}),e.j.D(t,"progress",function(){return cp(e)}),e.j.D(t,"timeupdate",function(){return cp(e)}))}function lp(e){var t=e.g.streaming.rebufferingGoal;e.P.i.set(Da,Math.min(.5,t/2)).set(Ca,t)}function cp(e){var t=e.Ud()||e.F.$h(),n=Vo(e.h.buffered,e.h.currentTime),i=e.P,r=i.i.get(i.g),s=i.g;t=t||n>=r&&0<n?Da:Ca,i.g=t,(s=s!=t)&&t===Da&&(i.h=Date.now()),s&&Rp(e)}function dp(e,t,n,i,r){return new Ru(e,t,n,r,i)}function hp(e){return new zh({getBandwidthEstimate:function(){return e.s?e.s.getBandwidthEstimate():NaN},Lb:function(){return e.Lb()},getCurrentTime:function(){return e.h?e.h.currentTime:0},sb:function(){return e.sb()},Nb:function(){return e.Nb()},Ob:function(){return e.Ob()},V:function(){return e.V()},Se:function(){return e.Se()}},e.g.cmcd)}function fp(e){return new Cc(e.i,{Pc:function(){return e.F?e.F.Be():0},getBandwidthEstimate:function(){return e.s.getBandwidthEstimate()},sb:function(){return e.sb()},video:e.h,Z:e.I,pc:e.H,onError:function(t){return Yp(e,t)},onEvent:function(t){return e.dispatchEvent(t)},pf:function(t,n,i){var r=t.startTime;if(t=t.endTime,n=n.type,n!=ft){if(e.F){e.F.ni();var s=Bu(e.I,n);!e.V()&&e.h.paused&&!e.h.seeking&&null!=s&&0<s&&e.F.Be()<s&&e.F.Qf(s)}cp(e)}i=(new Map).set("start",r).set("end",t).set("contentType",n).set("isMuxed",i),e.dispatchEvent(Nf("segmentappended",i))},vk:function(t,n){(n=n.od)&&e.je&&rc(e.je,n,t)},Hh:function(t,n){var i=e.C;if(i.h.parseInbandPsshEnabled&&!i.F&&["audio","video"].includes(t)){t=new Fs(Be(n)),n=0;for(var r=d(t.data),s=r.next();!s.done;s=r.next())n+=s.value.length;if(0==n)i=Promise.resolve();else{for(n=new Uint8Array(n),r=0,t=d(t.data),s=t.next();!s.done;s=t.next())s=s.value,n.set(s,r),r+=s.length;Qs(i,"cenc",n),i=i.m}}else i=Promise.resolve();return i},disableStream:function(t,n){return e.disableStream(t,n)}})}function pp(e){if(e.re=new Ma(e.g,e.va,e.C),e.G){var t=qt(e.g.manifest);e.h&&"AUDIO"===e.h.nodeName&&(t.disableVideo=!0),e.G.configure(t)}if(e.C&&e.C.configure(e.g.drm),e.l){e.l.configure(e.g.streaming);try{e.m!=ng&&Oa(e.re,e.i)&&Bp(e)}catch(n){Yp(e,n)}e.s&&_p(e),t=e.l.o,!t||t.allowedByApplication&&t.allowedByKeySystem||Op(e)}e.H&&e.H.configure(e.g.networking),e.I&&(e.I.configure(e.g.mediaSource),e.I.Ka=e.g.manifest.segmentRelativeVttTiming),e.o&&Wf(e),e.s&&(e.s.configure(e.g.abr),e.g.abr.enabled?e.s.enable():e.s.disable(),Kp(e)),e.P&&lp(e),e.Ba&&(e.g.streaming.rebufferingGoal?e.Ba.Ga(.25):e.Ba.stop()),e.i&&Jp(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.B&&e.B.configure(e.g.ads),e.L&&e.L.configure(e.g.cmcd),e.ka&&e.ka.configure(e.g.cmsd),e.ya&&e.ya.configure(e.g.queue)}function gp(e){return e&&(e=/(\d+)x(\d+)/.exec(e))?{Kc:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}function mp(e,t){var n,i;return U(function(r){return 1==r.g?e.m!=rg&&e.m!=sg?r.return(null):(n=e.ye,e.i&&(n=e.i.imageStreams),i=n[0],i?(null!=t&&(i=n.find(function(e){return e.id==t})),i?i.segmentIndex?r.u(2):w(r,i.createSegmentIndex(),2):r.return(null)):r.return(null)):r.return(i)})}function vp(e,t,n,i){var r=t.width||0,s=t.height||0,a=r/i.Kc,o=s/i.rows,u=i.Kc*i.rows,l=e.j-e.startTime;l=e.B||l/u;var c=e.startTime,d=0,h=0;return 1<u&&(h=Math.floor((n-e.startTime)/l),c=e.startTime+h*l,d=h%i.Kc*a,h=Math.floor(h/i.Kc)*o),i=!1,(n=e.thumbnailSprite)&&(i=!0,o=n.height,d=n.positionX,h=n.positionY,a=n.width),{segment:e,imageHeight:s,imageWidth:r,height:o,positionX:d,positionY:h,startTime:c,duration:l,uris:e.O(),startByte:e.zc(),endByte:e.xc(),width:a,sprite:i,mimeType:e.mimeType||t.mimeType,codecs:e.codecs||t.codecs}}function yp(e,t){e.j.D(t,"cuechange",function(){e.o.remove(0,Math.max(0,e.h.currentTime-e.g.streaming.bufferBehind));var n={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},i=[],r=Array.from(t.activeCues||[]);r=d(r);for(var s=r.next();!s.done;s=r.next()){if(s=s.value,1/0===s.endTime||s.endTime<s.startTime)s=null;else{var a=new Cn(s.startTime,s.endTime,s.text);a.line="number"===typeof s.line?s.line:null,s.lineAlign&&(a.lineAlign=s.lineAlign),a.lineInterpretation=s.snapToLines?Kn:1,a.position="number"===typeof s.position?s.position:null,s.positionAlign&&(a.positionAlign=s.positionAlign),a.size=s.size,a.textAlign=s.align,"lr"===s.vertical?a.writingMode="vertical-lr":"rl"===s.vertical&&(a.writingMode="vertical-rl"),s.region&&(a.region.id=s.region.id,a.region.height=s.region.lines,a.region.heightUnits=2,a.region.regionAnchorX=s.region.regionAnchorX,a.region.regionAnchorY=s.region.regionAnchorY,a.region.scroll=s.region.scroll,a.region.viewportAnchorX=s.region.viewportAnchorX,a.region.viewportAnchorY=s.region.viewportAnchorY,a.region.viewportAnchorUnits=_t,a.region.width=s.region.width,a.region.widthUnits=_t),Pn(a),s=a}s&&((a=e.g.mediaSource.modifyCueCallback)&&a(s,null,n),i.push(s))}e.o.append(i)}),t.mode=document.pictureInPictureElement?"showing":"hidden"}function bp(e){return Array.from(e.h.textTracks).filter(function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&"Shaka Player TextTrack"!=e.label})}function Tp(e){return Array.from(e.h.textTracks).find(function(e){return"Shaka Player TextTrack"==e.label})}function Sp(e){return Array.from(e.h.textTracks).filter(function(e){return"metadata"==e.kind})}function Ep(e,t){var n;return U(function(i){switch(i.g){case 1:return x(i,2),w(i,Th(t,e.H,e.g.streaming.retryParameters),4);case 4:n=i.h,k(i,3);break;case 2:L(i);case 3:if(n)return i.return(n);throw new Ve(1,2,2011,t)}})}function wp(e,t,n,i,r,s,a){var o,u,l,c;return U(function(d){if(1==d.g)return"text/vtt"!=r||a.length?w(d,Ap(e,t,e.H,e.g.streaming.retryParameters),3):d.u(2);2!=d.g&&(o=d.h,u=xp(e,o,r,a),l=new Blob([u],{type:"text/vtt"}),t=ml(l),r="text/vtt"),c=document.createElement("track");var h=e.L,f=t;try{if(h.g.enabled){var p=tf(h);p.ot=yf,p.su=!0;var g=cf(p),m=hf(f,g)}else m=f}catch(v){J("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",v),m=f}return c.src=m,c.label=s,c.kind=i,c.srclang=n,e.h.getAttribute("crossorigin")||e.h.setAttribute("crossorigin","anonymous"),e.h.appendChild(c),e.Sf.push(c),d.return(c)})}function Ap(e,t,n,i){var r,s,a;return U(function(o){if(1==o.g){r=gs,s=us([t],i),s.method="GET";var u=e.L;try{u.g.enabled&&nf(u,s,{ot:yf,su:!0})}catch(l){J("CMCD_TEXT_ERROR","Could not generate text CMCD data.",l)}return w(o,n.request(r,s).promise,2)}return a=o.h,o.return(a.data)})}function xp(e,t,n,i){var r=xi(n);if(r)return n=r(),e={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},t=Be(t),t=n.parseMedia(t,e,null,[]),Yh(t,i);throw new Ve(2,2,2014,n)}function Ip(e){var t=Ud();return t.streaming.failureCallback=function(t){if(e.V()){var n=null;1001==t.code||1002==t.code?(n=1,e.g.streaming.lowLatencyMode&&(n=.1)):1003==t.code&&(n=.1),null!=n&&(t.severity=1,e.Zg(n))}},t.textDisplayFactory=function(){var t=ce();return e.ue&&(document.fullscreenEnabled||"WEBKIT"!==t.Da())?new Fh(e.h,e.ue):"track"in document.createElement("track")?new Ph(e):new Uh},t}function kp(e,t){for(var n=new Set,i=d(t.textStreams),r=i.next();!r.done;r=i.next())r=r.value,"application/cea-608"!=r.mimeType&&"application/cea-708"!=r.mimeType||n.add(r.originalId);for(i=d(t.variants),r=i.next();!r.done;r=i.next())if((r=r.value.video)&&r.closedCaptions)for(var s=d(r.closedCaptions.keys()),a=s.next();!a.done;a=s.next())if(a=a.value,!n.has(a)){var o=a.startsWith("CC")?"application/cea-608":"application/cea-708",u=new zl,l=r.closedCaptions.get(a);o={id:e.se++,originalId:a,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:u,mimeType:o,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:l,originalLanguage:l,label:null,type:ft,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:r.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set([hi(o,"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},t.textStreams.push(o),n.add(a)}}function Lp(e,t){var n,i,r,s,a;return U(function(o){return 1==o.g?(n=e.audio,i=e.video,r=function(e,t){var n,i,r;return U(function(s){return 1==s.g?e?e.segmentIndex?s.u(2):w(s,e.createSegmentIndex(),2):s.return(null):(i=(n=e.segmentIndex.Ub(t))?n.next().value:null,i?(r=i.startTime,s.return(r)):s.return(null))})},w(o,r(n,t),2)):3!=o.g?(s=o.h,w(o,r(i,t),3)):(a=o.h,null!=a&&null!=s?o.return(Math.max(a,s)):null!=a?o.return(a):null!=s?o.return(s):o.return(t))})}function Rp(e){var t=e.Hg();if(e.A&&e.P&&e.F){if(0==e.g.streaming.rebufferingGoal){var n=e.K;n.j=!1,Zl(n)}else n=e.K,n.j=t,Zl(n);if(e.L&&(n=e.L,t||n.s||(n.s=!0),n.s&&t&&(n.B=!0),n.F=t),Dp(e),n=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts,e.g.streaming.liveSync.dynamicTargetLatency.enabled&&t&&e.Ce<n){n=e.g.streaming.liveSync.dynamicTargetLatency.maxLatency;var i=e.g.streaming.liveSync.targetLatencyTolerance,r=e.g.streaming.liveSync.dynamicTargetLatency.rebufferIncrement;e.U&&(e.U=Math.min(e.U+ ++e.Ce*r,n-i))}}t=(new Map).set("buffering",t),e.dispatchEvent(Nf("buffering",t))}function Cp(e,t){e.Yb.Qa(),e.Yb.D(e.h,"timeupdate",function(){var n=e.h.currentTime,i=e.Ra(),r=e.V()?e.g.streaming.safeSeekOffset:0;0<t?Math.floor(n)>=Math.floor(i.end)&&e.Fd():Math.floor(n)<=Math.floor(i.start+r)&&e.Fd()})}function Dp(e){if(e.A&&e.P){var t=e.A.g,n="playing";e.P.g==Ca?n="buffering":e.Ud()?n="ended":e.h.paused&&(n="paused");var i=n;if(null==t.g)t.g={timestamp:Date.now()/1e3,state:i,duration:0},t=!0;else{var r=Date.now()/1e3;t.g.duration=r-t.g.timestamp,t.g.state==i?t=!1:(t.h.push(t.g),t.g={timestamp:r,state:i,duration:0},t=!0)}t&&(n=(new Map).set("newstate",n),e.dispatchEvent(Nf("statechanged",n)))}}function Mp(e){var t=e.h.playbackRate,n=e.V();if(e.g.streaming.vodDynamicPlaybackRate&&!n){var i=e.g.streaming.vodDynamicPlaybackRateLowBufferRate,r=e.Sh();r<=e.g.streaming.vodDynamicPlaybackRateBufferRatio?t!=i&&e.ie(i,!1):1==r&&t!==e.K.Oc()&&e.Fd()}if(n&&(n=e.Ra(),Number.isFinite(n.end)&&!(e.h.currentTime<n.start||e.h.paused))){i=e.g.streaming.liveSync.targetLatencyTolerance,r=e.g.streaming.liveSync.dynamicTargetLatency.enabled;var s=e.g.streaming.liveSync.dynamicTargetLatency.stabilityThreshold;if(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled)var a=e.g.streaming.liveSync.targetLatency,o=a+i,u=Math.max(0,a-i),l=e.g.streaming.liveSync.maxPlaybackRate,c=e.g.streaming.liveSync.minPlaybackRate;else e.i&&e.i.serviceDescription&&(a=e.i.serviceDescription.targetLatency,null!=e.i.serviceDescription.targetLatency?o=e.i.serviceDescription.targetLatency+i:null!=e.i.serviceDescription.maxLatency&&(o=e.i.serviceDescription.maxLatency),null!=e.i.serviceDescription.targetLatency?u=Math.max(0,e.i.serviceDescription.targetLatency-i):null!=e.i.serviceDescription.minLatency&&(u=e.i.serviceDescription.minLatency),l=e.i.serviceDescription.maxPlaybackRate||e.g.streaming.liveSync.maxPlaybackRate,c=e.i.serviceDescription.minPlaybackRate||e.g.streaming.liveSync.minPlaybackRate);e.U||"number"!==typeof a||(e.U=a);var d=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts;r&&e.Xb&&null!==e.U&&"number"===typeof a&&e.Ce<d&&Date.now()-e.Xb>1e3*s&&(s=e.g.streaming.liveSync.dynamicTargetLatency.minLatency,e.U=Math.max(e.U-(a-s)/2,s+i),e.Xb=Date.now()),r&&null!==e.U&&(o=e.U+i,u=e.U-i),a=n.end-e.h.currentTime,i=0,e.m==sg&&(r=e.h.buffered,0<r.length&&(i=r.end(r.length-1),i=Math.max(l,i-n.end))),n=e.g.streaming.liveSync.panicMode,r=1e3*e.g.streaming.liveSync.panicThreshold,s=Date.now()-e.P.h,n&&!c&&(c=e.g.streaming.liveSync.minPlaybackRate),n&&c&&s<=r?t!=c&&e.ie(c,!1):void 0!=o&&l&&a-i>o?(t!=l&&e.ie(l,!1),e.Xb=null):void 0!=u&&c&&a-i<u?(t!=c&&e.ie(c,!1),e.Xb=null):t!==e.K.Oc()&&(e.Fd(),e.Xb=Date.now())}}function Pp(e){if(e.h){var t=function(t,n){var i=void 0===i?Number.EPSILON:i;if(t===n)i=!0;else{var r=Math.abs(t-n);i=r<=i||i!==Number.EPSILON&&Math.abs(r-i)<=Number.EPSILON}return!!((i||n>t)&&e.Rf<t)&&(e.Rf=t,!0)},n=e.Ra();if(n=n.end-n.start,n=0<n?e.h.currentTime/n:0,!isNaN(n)){if(n*=100,t(0,n))var i=Nf("started");else t(25,n)?i=Nf("firstquartile"):t(50,n)?i=Nf("midpoint"):t(75,n)?i=Nf("thirdquartile"):((t(100,n)||100<n)&&(i=Nf("complete")),e.g&&1/0!=e.g.playRangeEnd&&e.Ud()&&e.h.pause());i&&e.dispatchEvent(i)}}}function _p(e){try{Ua(e.re,e.i)}catch(n){return Yp(e,n),!1}var t=Tr(e.i.variants);return t=e.M.create(t),e.s.setVariants(Array.from(t.values())),!0}function Op(e,t,n,i,r){var s;t=void 0===t||t,n=void 0===n?0:n,i=void 0!==i&&i,r=void 0===r||r,(s=_p(e)?e.s.chooseVariant():null)&&Np(e,s,r,t,n,i)}function Np(e,t,n,i,r,s){s=void 0!==s&&s;var a=e.l.o;if(t==a)i&&Nc(e.l,t,i,r,!0);else{var o=e.A.h;if(o.h!=t&&(o.h=t,o.g.push({timestamp:Date.now()/1e3,id:t.id,type:"variant",fromAdaptation:n,bandwidth:t.bandwidth})),Nc(e.l,t,i,r,s,n),i=null,a&&(i=fr(a)),a=fr(t),a.active=!0,e.S&&(r=e.S,t=t.video)){switch(t.dependencyStream&&(t=t.dependencyStream),s=0,o=-1,t.mimeType){case"video/webm":s=1;break;case"video/mp4":s=2}switch(e.Uh()){case"DASH":o=1;break;case"HLS":o=0}r.g&&(r.g.setLevelSwitching(t.id,!0),r.g.setContainerFormat(s),r.j||r.g.setStreamingFormat(o))}n?(n=(new Map).set("oldTrack",i).set("newTrack",a),n=Nf("adaptation",n),Zp(e,n)):jp(e,i,a),$p(e,i,a)}}function Up(e,t){var n=Array.from(e.h.audioTracks).find(function(e){return e.enabled});if(t.enabled=!0,n){t.id!==n.id&&(n.enabled=!1);var i=Fp(e);n=yr(n,i),t=yr(t,i),jp(e,n,t),$p(e,n,t)}}function Fp(e){return e.h&&e.h.videoTracks?Array.from(e.h.videoTracks).find(function(e){return e.selected}):null}function Bp(e){var t=Nf("trackschanged");Zp(e,t),Gp(e)}function jp(e,t,n){t=(new Map).set("oldTrack",t).set("newTrack",n),t=Nf("variantchanged",t),Zp(e,t)}function $p(e,t,n){var i=!1;t&&t.audioId==n.audioId&&t.audioGroupId==n.audioGroupId||(i=!0),i&&Gp(e)}function Gp(e){var t=Nf("audiotrackschanged");Zp(e,t)}function Vp(e){var t=Nf("textchanged");Zp(e,t)}function Hp(e){var t=Nf("texttrackvisibility");Zp(e,t)}function Kp(e){e.g.abr.enabled||qp(e);var t=(new Map).set("newStatus",e.g.abr.enabled);Zp(e,Nf("abrstatuschanged",t))}function Wp(e){var t=e.Bc().find(function(e){return e.active});t&&e.o&&e.o.setTextLanguage&&e.o.setTextLanguage(t.language)}function qp(e,t){if(t=void 0===t||t,e.m==rg){e.ve.stop();for(var n=d(e.i.variants),i=n.next();!i.done;i=n.next())i.value.disabledUntilTime=0;t&&_p(e)}}function Yp(e,t){var n,i,r,s,a;return U(function(o){switch(o.g){case 1:if(e.m==ng)return o.return();if(1===t.severity&&e.A.L++,n=!0,!(e.Ka&&e.i&&e.l)||3016!=t.code&&3014!=t.code&&3015!=t.code&&3024!=t.code&&3018!=t.code){o.u(2);break}return i=ce(),"WEBKIT"===i.Da()&&3016==t.code?o.return():(x(o,3),w(o,dd(e.l),5));case 5:r=o.h,n=!r,r&&(s=Nf("mediasourcerecovered"),e.dispatchEvent(s)),k(o,2);break;case 3:L(o),n=!0;case 2:if(!n)return o.return();2===t.severity&&qp(e,!1),a=Nf("error",(new Map).set("detail",t)),e.dispatchEvent(a),a.defaultPrevented&&(t.handled=!0),A(o)}})}function zp(e,t,n,i){i=void 0===i?e:i,e=(new Map).set("detail",{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,timescale:n.timescale,eventElement:n.eventElement,eventNode:n.eventNode}),i.dispatchEvent(Nf(t,e))}function Xp(e,t,n,i){i=void 0!==i&&i,t=(new Map).set("mediaQuality",{bandwidth:t.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate,height:t.height,mimeType:t.mimeType,channelsCount:t.channelsCount,pixelAspectRatio:t.pixelAspectRatio,width:t.width,label:t.label,roles:t.roles,language:t.language}).set("position",n),e.dispatchEvent(Nf(i?"audiotrackchanged":"mediaqualitychanged",t))}function Qp(e,t){if(t=void 0===t||t,!e.h.error)return t?new Ve(2,3,3016):null;var n=e.h.error.code;return t||1!=n?((t=e.h.error.msExtendedCode)&&(0>t&&(t+=Math.pow(2,32)),t=t.toString(16)),new Ve(2,3,3016,n,t,e.h.error.message)):null}function Jp(e,t,n){0<t&&(e.V()||e.Li(t)),t=e.getDuration(),n<t&&(e.V()||e.ob(n))}function Zp(e,t){U(function(n){if(1==n.g)return w(n,Promise.resolve(),2);e.m!=ng&&e.dispatchEvent(t),A(n)})}function eg(e){var t=new Set;e=d(e);for(var n=e.next();!n.done;n=e.next())n=n.value,n.language?t.add(Vi(n.language)):t.add("und");return t}function tg(e){for(var t=new Map,n=new Map,i=0;i<e.length;i++){var r=e[i],s="und",a=[];r.language&&(s=Vi(r.language)),a="variant"==r.type?r.audioRoles:r.roles,a&&a.length||(a=[""]),t.has(s)||t.set(s,new Set),a=d(a);for(var o=a.next();!o.done;o=a.next())o=o.value,t.get(s).add(o),r.label&&(n.has(s)||n.set(s,new Map),n.get(s).set(o,r.label))}var u=[];return t.forEach(function(e,t){e=d(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;var r=null;n.has(t)&&n.get(t).has(i)&&(r=n.get(t).get(i)),u.push({language:t,role:i,label:r})}}),u}Df.prototype.release=function(){0<this.h.length?this.h.shift()():this.g=null},b(Pf,ns),i=Pf.prototype,i.destroy=function(){var e,t=this;return U(function(n){switch(n.g){case 1:return t.m==ng?n.return():(_f(t),e=t.detach(),t.m=ng,w(n,e,2));case 2:return w(n,t.ig(),3);case 3:if(t.ze&&(t.ze.release(),t.ze=null),t.me&&(t.me.release(),t.me=null),t.j&&(t.j.release(),t.j=null),t.Yb&&(t.Yb.release(),t.Yb=null),t.td&&(t.td.release(),t.td=null),t.Ta=null,t.g=null,t.A=null,t.ue=null,t.L=null,t.ka=null,!t.H){n.u(4);break}return w(n,t.H.destroy(),5);case 5:t.H=null;case 4:t.s&&(t.s.release(),t.s=null),t.ya&&(t.ya.destroy(),t.ya=null),ns.prototype.release.call(t),A(n)}})},i.dc=function(e,t){t=void 0===t||t;var n,i,r,s=this;return U(function(a){switch(a.g){case 1:if(s.m==ng)throw new Ve(2,7,7e3);if(n=s.h&&s.h==e,!s.h||s.h==e){a.u(2);break}return w(a,s.detach(),2);case 2:return w(a,Bf(s,"attach"),4);case 4:if(a.h)return a.return();if(x(a,5,6),n||(Ff(s,"attach"),i=function(){var e=Qp(s,!1);e&&Yp(s,e)},s.me.D(e,"error",i),s.h=e,s.L&&s.L.setMediaElement(e)),ce(),!t||!KT()||s.I){a.u(6);break}return w(a,qf(s),6);case 6:R(a),s.$.release(),C(a,0);break;case 5:return r=L(a),w(a,s.detach(),10);case 10:throw r}})},i.dj=function(e){this.Dh=e},i.detach=function(e){e=void 0!==e&&e;var t=this;return U(function(n){if(1==n.g){if(t.m==ng)throw new Ve(2,7,7e3);return w(n,t.uc(!1,e),2)}if(3!=n.g)return w(n,Bf(t,"detach"),3);if(n.h)return n.return();try{t.h&&(t.me.Qa(),t.h=null),Ff(t,"detach"),t.B&&!e&&t.B.release()}finally{t.$.release()}A(n)})},i.uc=function(t,n){t=void 0===t||t,n=void 0!==n&&n;var i,r,s,a,o,u,l,c,h,f,p,g,m,v=this;return U(function(y){switch(y.g){case 1:return v.m!=ng&&(v.m=ig),w(y,Bf(v,"unload"),2);case 2:return y.h?y.return():(I(y,3),v.Ka=!1,Ff(v,"unload"),_f(v),i=v.oe.map(function(e){return e()}),v.oe=[],w(y,Promise.all(i),5));case 5:if(v.dispatchEvent(Nf("unloading")),v.ke&&(v.ke.release(),v.ke=null),v.wa&&(v.wa.release(),v.wa=null),v.Za&&(v.Za.release(),v.Za=null),v.h&&(v.j.Qa(),v.Yb.Qa()),v.ve.stop(),v.eb&&(v.eb.release(),v.eb=null),v.Ba&&(v.Ba.stop(),v.Ba=null),!v.G){y.u(6);break}return w(y,v.G.stop(),7);case 7:v.G=null,v.qc=null;case 6:if(!v.s){y.u(8);break}return w(y,v.s.stop(),8);case 8:if(!v.l){y.u(10);break}return w(y,v.l.destroy(),11);case 11:v.l=null;case 10:if(v.K&&(v.K.release(),v.K=null),v.F&&(v.F.release(),v.F=null),"webkit"!==e.shakaMediaKeysPolyfill||!v.C){y.u(12);break}return w(y,v.C.destroy(),13);case 13:v.C=null;case 12:if(!v.I){y.u(14);break}return w(y,v.I.destroy(),15);case 15:v.I=null;case 14:if(v.B&&!n&&v.B.onAssetUnload(),v.ia&&!n&&(v.ia.destroy(),v.ia=null),n||v.Uf.stop(),v.L&&Xh(v.L),v.ka&&(v.ka.g=null),!v.o){y.u(16);break}return w(y,v.o.destroy(),17);case 17:v.o=null;case 16:if(v.h){for(r=d(v.Sf),s=r.next();!s.done;s=r.next())a=s.value,a.src.startsWith("blob:")&&URL.revokeObjectURL(a.src),a.remove();v.Sf=[],Yo(v.h)&&v.h.load()}if(!v.C){y.u(18);break}return w(y,v.C.destroy(),19);case 19:v.C=null;case 18:if(v.Oa&&v.W!=v.Oa.kd()&&(v.Oa.o||v.Oa.destroy(),v.Oa=null),v.W=null,v.nc=null,v.P=null,v.i){for(o=d(v.i.variants),u=o.next();!u.done;u=o.next())for(l=u.value,c=d([l.audio,l.video]),h=c.next();!h.done;h=c.next())(f=h.value)&&f.segmentIndex&&f.segmentIndex.release();for(p=d(v.i.textStreams),g=p.next();!g.done;g=p.next())m=g.value,m.segmentIndex&&m.segmentIndex.release()}v.g&&v.g.streaming.clearDecodingCache&&(Ir.clear(),$r.clear()),v.i=null,v.A=new Yd,v.Ch=null,v.Xb=null,v.U=null,v.Ce=-1,v.ye=[],v.ab=[],v.Rf=-1,v.H&&v.H.Jh(),Rp(v);case 3:R(y),v.$.release(),C(y,4);break;case 4:if(ce(),t&&KT()&&!v.I&&v.h)return w(y,qf(v),0);y.u(0)}})},i.$k=function(e){this.N=e},i.load=function(e,t,n){t=void 0===t?null:t;var i,r,s,a,o,u,l,c,h,f,p,g,m,v,y=this;return U(function(b){switch(b.g){case 1:if(y.m==ng)throw new Ve(2,7,7e3);if(i=null,r="",e instanceof eh){if(e.o)throw new Ve(2,7,7006);i=e,r=i.kd()||""}else r=e||"";return w(b,Mf(y.$,"load"),2);case 2:if(y.$.release(),!y.h)throw new Ve(2,7,7002);if(!y.W){b.u(3);break}return y.W=r,w(b,y.uc(!1),3);case 3:if(s=++y.Ae,a=function(){return U(function(e){if(1==e.g)return y.Ae==s?e.u(0):i?w(e,i.destroy(),3):e.u(3);throw new Ve(2,7,7e3)})},o=function(e,t){return U(function(n){switch(n.g){case 1:return I(n,2),w(n,Mf(y.$,t),4);case 4:return w(n,a(),5);case 5:return w(n,e(),6);case 6:return w(n,a(),7);case 7:i&&y.g&&(i.g=y.g);case 2:R(n),y.$.release(),C(n,0)}})},x(b,5,6),null==t&&i&&(t=i.getStartTime()),y.N=t,y.Ka=!1,y.dispatchEvent(Nf("loading")),i){n=i.W,b.u(8);break}if(n){b.u(8);break}return w(b,o(function(){return U(function(e){if(1==e.g)return w(e,Hf(y,r),2);n=e.h,A(e)})},"guessMimeType_"),8);case 8:if(u=!!i,i){ih(i,y),y.A=i.getStats(),b.u(11);break}return w(b,Gf(y,r,t,n,!0,y.g),12);case 12:(i=b.h)?(i.B=!1,ih(i,y),y.A=i.getStats(),i.start(),i.s.catch(function(){})):y.A=new Yd;case 11:return l=!i,c=Date.now()/1e3,y.A=i?i.getStats():new Yd,y.W=r,y.nc=n||null,Rp(y),h=function(){var e=y.Lb(),t={start:0,end:0};if(e.total.length){t.start=1/0,e=d(e.total);for(var n=e.next();!n.done;n=e.next())n=n.value,n.start<t.start&&(t.start=n.start),n.end>t.end&&(t.end=n.end)}return t},y.wa=new uc(h),y.wa.addEventListener("regionadd",function(e){tp(y,e.region,"metadataadded")}),l?w(b,o(function(){return U(function(e){return w(e,Xf(y,n),0)})},"initializeSrcEqualsDrmInner_"),23):(y.Za=new uc(h),w(b,o(function(){return U(function(e){if(1==e.g)return w(e,Promise.race([i.va,i.s]),2);y.qc=i.G;var t=i;t.wa=!0,y.G=t.l,y.i=i.Ag(),A(e)})},"waitForFinish"),15));case 15:if(y.I){b.u(16);break}return w(b,o(function(){return U(function(e){return w(e,qf(y),0)})},"initializeMediaSourceEngineInner_"),16);case 16:return y.i&&y.i.textStreams.length&&(y.o.enableTextDisplayer?y.o.enableTextDisplayer():ge("Text displayer w/ enableTextDisplayer",'Text displayer should have a "enableTextDisplayer" method!')),w(b,o(function(){return U(function(e){return w(e,i.s,0)})},"waitForFinish"),18);case 18:if(y.g=i.getConfiguration(),y.re=i.F,y.G&&y.G.setMediaElement&&y.h&&y.G.setMediaElement(y.h),y.ke=sh(i),y.je=i.Ta,(f=i.A)&&(y.M=f),u&&y.h&&"AUDIO"===y.h.nodeName&&(jf(y),y.configure("manifest.disableVideo",!0)),i.i){b.u(19);break}return w(b,o(function(){return U(function(e){return w(e,dh(i,y.h),0)})},"drmEngine_.init"),19);case 19:return y.C=ah(i),w(b,o(function(){return U(function(e){return w(e,y.C.dc(y.h),0)})},"drmEngine_.attach"),21);case 21:return!(p=i.C)||y.Ta&&y.Ta==p||(y.s=rh(i),y.Ta=i.C,"function"!=typeof y.s.setMediaElement&&(ge("AbrManager w/o setMediaElement","Please use an AbrManager with setMediaElement function."),y.s.setMediaElement=function(){}),"function"!=typeof y.s.setCmsdManager&&(ge("AbrManager w/o setCmsdManager","Please use an AbrManager with setCmsdManager function."),y.s.setCmsdManager=function(){}),"function"!=typeof y.s.trySuggestStreams&&(ge("AbrManager w/o trySuggestStreams","Please use an AbrManager with trySuggestStreams function."),y.s.trySuggestStreams=function(){})),g=oh(i),m=i.K,w(b,o(function(){return U(function(e){return w(e,zf(y,c,m,g),0)})},"loadInner_"),22);case 22:nh(i),y.nc&&ce().Ui()&&Ti(y.nc)&&Du(y.I,y.W,y.nc),b.u(14);break;case 23:return w(b,o(function(){return U(function(e){return w(e,Qf(y,c,n),0)})},"srcEqualsInner_"),14);case 14:y.dispatchEvent(Nf("loaded"));case 6:if(R(b),!i){b.u(25);break}return w(b,i.destroy(),25);case 25:y.Oa=null,C(b,0);break;case 5:if(v=L(b),!v||7e3==v.code){b.u(27);break}return w(b,y.uc(!1),27);case 27:throw v}})},i.Wk=function(e,t){e=void 0===e||e,t=void 0!==t&&t;var n,i=this;return U(function(r){return 1==r.g?w(r,$f(i),2):3!=r.g?(n=r.h,w(r,i.uc(e,t),3)):r.return(n)})},i.Nh=function(e,t){e=void 0!==e&&e,t=void 0!==t&&t;var n,i=this;return U(function(r){return 1==r.g?w(r,$f(i,t),2):3!=r.g?(n=r.h,w(r,i.detach(e),3)):r.return(n)})},i.preload=function(e,t,n,i){t=void 0===t?null:t;var r,s,a=this;return U(function(o){return 1==o.g?(r=Ip(a),Bd(r,i||a.g,Ip(a)),w(o,Gf(a,e,t,n,!1,r),2)):((s=o.h)?s.start():Yp(a,new Ve(2,7,7005)),o.return(s))})},i.ig=function(){var e,t,n,i,r=this;return U(function(s){for(e=[],t=d(r.we),n=t.next();!n.done;n=t.next())i=n.value,i.o||e.push(i.destroy());return r.we=[],w(s,Promise.all(e),0)})},i.Ek=function(){for(var e=this.$;e.g;)e.release()},i.ed=function(e){return new js(e)},i.configure=function(e,t){if(2==arguments.length&&"string"==typeof e&&(e=yd(e,t)),e.streaming&&"forceTransmuxTS"in e.streaming&&(ge("streaming.forceTransmuxTS configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource=e.mediaSource||{},e.mediaSource.mediaSource=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&"forceTransmux"in e.streaming&&(ge("streaming.forceTransmux configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource=e.mediaSource||{},e.mediaSource.mediaSource=e.streaming.forceTransmux,delete e.streaming.forceTransmux),e.streaming&&"useNativeHlsOnSafari"in e.streaming){ge("streaming.useNativeHlsOnSafari configuration","Please Use streaming.useNativeHlsForFairPlay or streaming.preferNativeHls instead.");var n=ce();e.streaming.preferNativeHls=e.streaming.useNativeHlsOnSafari&&"WEBKIT"===n.Da(),delete e.streaming.useNativeHlsOnSafari}if(e.streaming&&"boolean"==typeof e.streaming.liveSync&&(ge("streaming.liveSync","Please Use streaming.liveSync.enabled instead."),n=e.streaming.liveSync,e.streaming.liveSync={},e.streaming.liveSync.enabled=n),e.streaming&&(!e.streaming.liveSync||!("targetLatency"in e.streaming.liveSync))&&("liveSyncMinLatency"in e.streaming||"liveSyncMaxLatency"in e.streaming)){n=e.streaming.liveSyncMinLatency||0;var i=Math.abs((e.streaming.liveSyncMaxLatency||1)-n)/2;e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=n+i,e.streaming.liveSync.targetLatencyTolerance=i}if(e.streaming&&"liveSyncMaxLatency"in e.streaming&&(ge("streaming.liveSyncMaxLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMaxLatency),e.streaming&&"liveSyncMinLatency"in e.streaming&&(ge("streaming.liveSyncMinLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMinLatency),e.streaming&&"liveSyncTargetLatency"in e.streaming&&(ge("streaming.liveSyncTargetLatency","Please Use streaming.liveSync.targetLatency instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=e.streaming.liveSyncTargetLatency,delete e.streaming.liveSyncTargetLatency),e.streaming&&"liveSyncTargetLatencyTolerance"in e.streaming&&(ge("streaming.liveSyncTargetLatencyTolerance","Please Use streaming.liveSync.targetLatencyTolerance instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatencyTolerance=e.streaming.liveSyncTargetLatencyTolerance,delete e.streaming.liveSyncTargetLatencyTolerance),e.streaming&&"liveSyncPlaybackRate"in e.streaming&&(ge("streaming.liveSyncPlaybackRate","Please Use streaming.liveSync.maxPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.maxPlaybackRate=e.streaming.liveSyncPlaybackRate,delete e.streaming.liveSyncPlaybackRate),e.streaming&&"liveSyncMinPlaybackRate"in e.streaming&&(ge("streaming.liveSyncMinPlaybackRate","Please Use streaming.liveSync.minPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.minPlaybackRate=e.streaming.liveSyncMinPlaybackRate,delete e.streaming.liveSyncMinPlaybackRate),e.streaming&&"liveSyncPanicMode"in e.streaming&&(ge("streaming.liveSyncPanicMode","Please Use streaming.liveSync.panicMode instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicMode=e.streaming.liveSyncPanicMode,delete e.streaming.liveSyncPanicMode),e.streaming&&"liveSyncPanicThreshold"in e.streaming&&(ge("streaming.liveSyncPanicThreshold","Please Use streaming.liveSync.panicThreshold instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicThreshold=e.streaming.liveSyncPanicThreshold,delete e.streaming.liveSyncPanicThreshold),e.mediaSource&&"sourceBufferExtraFeatures"in e.mediaSource){ge("mediaSource.sourceBufferExtraFeatures configuration","Please Use mediaSource.addExtraFeaturesToSourceBuffer() instead.");var r=e.mediaSource.sourceBufferExtraFeatures;e.mediaSource.addExtraFeaturesToSourceBuffer=function(){return r},delete e.mediaSource.sourceBufferExtraFeatures}if(e.manifest&&e.manifest.hls&&"useSafariBehaviorForLive"in e.manifest.hls&&(ge("manifest.hls.useSafariBehaviorForLive configuration","Please Use liveSync config to keep on live Edge instead."),delete e.manifest.hls.useSafariBehaviorForLive),e.streaming&&"parsePrftBox"in e.streaming&&(ge("streaming.parsePrftBox configuration","Now fired without needing a configuration."),delete e.streaming.parsePrftBox),e.manifest&&e.manifest.dash&&"enableAudioGroups"in e.manifest.dash&&(ge("manifest.dash.enableAudioGroups configuration","It is now enabled by default and cannot be disabled."),delete e.manifest.dash.enableAudioGroups),e.streaming&&"dispatchAllEmsgBoxes"in e.streaming&&(ge("streaming.dispatchAllEmsgBoxes configuration","Please Use mediaSource.dispatchAllEmsgBoxes instead."),e.mediaSource=e.mediaSource||{},e.mediaSource.dispatchAllEmsgBoxes=e.streaming.dispatchAllEmsgBoxes,delete e.streaming.dispatchAllEmsgBoxes),e.streaming&&"autoLowLatencyMode"in e.streaming&&(ge("streaming.autoLowLatencyMode configuration","Please Use streaming.lowLatencyMode instead."),e.streaming.lowLatencyMode=e.streaming.autoLowLatencyMode,delete e.streaming.autoLowLatencyMode),e.manifest&&e.manifest.dash&&"ignoreSupplementalCodecs"in e.manifest.dash&&(ge("manifest.dash.ignoreSupplementalCodecs configuration","Please Use manifest.ignoreSupplementalCodecs instead."),e.manifest.ignoreSupplementalCodecs=e.manifest.dash.ignoreSupplementalCodecs,delete e.manifest.dash.ignoreSupplementalCodecs),e.manifest&&e.manifest.hls&&"ignoreSupplementalCodecs"in e.manifest.hls&&(ge("manifest.hls.ignoreSupplementalCodecs configuration","Please Use manifest.ignoreSupplementalCodecs instead."),e.manifest.ignoreSupplementalCodecs=e.manifest.hls.ignoreSupplementalCodecs,delete e.manifest.hls.ignoreSupplementalCodecs),e.manifest&&e.manifest.dash&&"updatePeriod"in e.manifest.dash&&(ge("manifest.dash.updatePeriod configuration","Please Use manifest.updatePeriod instead."),e.manifest.updatePeriod=e.manifest.dash.updatePeriod,delete e.manifest.dash.updatePeriod),e.manifest&&e.manifest.hls&&"updatePeriod"in e.manifest.hls&&(ge("manifest.hls.updatePeriod configuration","Please Use manifest.updatePeriod instead."),e.manifest.updatePeriod=e.manifest.hls.updatePeriod,delete e.manifest.hls.updatePeriod),e.manifest&&e.manifest.dash&&"ignoreDrmInfo"in e.manifest.dash&&(ge("manifest.dash.ignoreDrmInfo configuration","Please Use manifest.ignoreDrmInfo instead."),e.manifest.ignoreDrmInfo=e.manifest.dash.ignoreDrmInfo,delete e.manifest.dash.ignoreDrmInfo),e.drm&&e.drm.advanced){for(var s in n=!1,e.drm.advanced){var a=e.drm.advanced[s];i=a.videoRobustness,a=a.audioRobustness,"videoRobustness"in e.drm.advanced[s]&&!Array.isArray(e.drm.advanced[s].videoRobustness)&&(e.drm.advanced[s].videoRobustness=[i],n=!0),"audioRobustness"in e.drm.advanced[s]&&!Array.isArray(e.drm.advanced[s].audioRobustness)&&(e.drm.advanced[s].audioRobustness=[a],n=!0)}n&&ge("AdvancedDrmConfiguration's videoRobustness and audioRobustness","These properties are no longer strings but array of strings, please update your usage of these properties.")}return e.streaming&&"forceHTTP"in e.streaming&&(ge("streaming.forceHTTP configuration","Please Use networking.forceHTTP instead."),e.networking=e.networking||{},e.networking.forceHTTP=e.streaming.forceHTTP,delete e.streaming.forceHTTP),e.streaming&&"forceHTTPS"in e.streaming&&(ge("streaming.forceHTTPS configuration","Please Use networking.forceHTTP instead."),e.networking=e.networking||{},e.networking.forceHTTPS=e.streaming.forceHTTPS,delete e.streaming.forceHTTPS),e.streaming&&"minBytesForProgressEvents"in e.streaming&&(ge("streaming.minBytesForProgressEvents configuration","Please Use networking.minBytesForProgressEvents instead."),e.networking=e.networking||{},e.networking.minBytesForProgressEvents=e.streaming.minBytesForProgressEvents,delete e.streaming.minBytesForProgressEvents),e.streaming&&"crossBoundaryStrategy"in e.streaming&&"keep"!=e.streaming.crossBoundaryStrategy&&(e.streaming.inaccurateManifestTolerance=0),s=Bd(this.g,e,Ip(this)),pp(this),s},i.lj=function(e){this.Tf=e},i.getConfiguration=function(){var e=Ip(this);return Bd(e,this.g,Ip(this)),e},i.vj=function(){return this.Tf},i.Wh=function(){var e=Ip(this);return Bd(e,this.g,Ip(this)),Td(this.g,Ip(this))},i.Sh=function(){if(this.h){var e=this.h.buffered.length;e=e?this.h.buffered.end(e-1):0;var t=this.getConfiguration().streaming.bufferingGoal;if(t=Math.min(this.h.currentTime+t,this.Ra().end),e>=t)return 1;if(!(e<=this.h.currentTime)&&e<t)return(e-this.h.currentTime)/(t-this.h.currentTime)}return 0},i.Ai=function(){for(var e in this.g)delete this.g[e];Bd(this.g,Ip(this),Ip(this)),pp(this)},i.Dj=function(){return this.m},i.Uh=function(){return this.i?this.i.type:null},i.Hj=function(){return this.h},i.Nb=function(){return this.H},i.kd=function(){return this.W},i.Rh=function(){return this.B?this.B:null},i.Xh=function(){return this.ya?this.ya:null},i.V=function(){return this.i&&!this.ua()?this.i.presentationTimeline.V():!(!this.h||!this.h.src&&!this.ua())&&1/0==this.h.duration},i.Sc=function(){return!!this.i&&this.i.presentationTimeline.Sc()},i.$j=function(){if(this.i&&!this.ua()){var e=this.i.variants;return!!e.length&&!e[0].video}return!(!this.h||!this.h.src&&!this.ua())&&(this.h.videoTracks?0==this.h.videoTracks.length:0==this.h.videoHeight)},i.hk=function(){if(this.i&&!this.ua()){var e=this.i.variants;return!!e.length&&(e=e[0],!(e.audio||!e.video)&&!e.video.codecs.includes(","))}return!(!this.h||!this.h.src&&!this.ua()||!this.h.audioTracks)&&0==this.h.audioTracks.length},i.Ra=function(){if(this.i&&!this.ua()){if(!this.Ka&&"HLS"==this.i.type)return{start:0,end:0};var e=this.i.presentationTimeline;return{start:e.Vb(),end:e.Eb()}}if(this.h&&(this.h.src||this.ua())&&(e=this.h.seekable)&&e.length){var t=this.g?this.g.playRangeStart:0;t=Math.max(e.start(0),t);var n=this.g?this.g.playRangeEnd:1/0;return e=Math.min(e.end(e.length-1),n),{start:t,end:e}}return{start:0,end:0}},i.Xj=function(){this.V()&&(this.h.currentTime=this.Ra().end)},i.bk=function(){return this.Ka},i.keySystem=function(){var e=this.drmInfo();return e?e.keySystem:""},i.drmInfo=function(){return this.C?this.C.g:null},i.Nd=function(){return this.C?this.C.Nd():1/0},i.zg=function(){return this.C?this.C.zg():[]},i.Re=function(){return this.C?this.C.Re():{}},i.Hg=function(){return this.P?this.P.g==Ca:!!this.W},i.sb=function(){return this.h?this.K?this.K.i:1:0},i.yh=function(e){this.m==rg&&this.l&&Oc(this.l,e)},i.ie=function(e,t){t=void 0===t||t,0==e?Q("A trick play rate of 0 is unsupported!"):(this.K.set(e),this.m==rg&&(this.s.playbackRateChanged(e),this.yh(t&&1!=e)),Cp(this,e))},i.Fd=function(){var e=this.K.Oc();this.m==sg&&this.K.set(e),this.m==rg&&(this.K.set(e),this.s.playbackRateChanged(e),this.yh(!1)),this.Yb.Qa()},i.Ob=function(){if(this.i&&!this.ua()){for(var e=this.l?this.l.o:null,t=[],n=0,i=d(this.i.variants),r=i.next();!r.done;r=i.next())if(r=r.value,br(r)){var s=fr(r);s.active=r==e,s.active||1==n||null==e||r.video!=e.video||r.audio!=e.audio||(s.active=!0),s.active&&n++,t.push(s)}return t}if(this.h&&this.h.audioTracks){var a=Fp(this);return e=Array.from(this.h.audioTracks),e.length?e.map(function(e){return yr(e,a)}):a?[yr(null,a)]:[]}return[]},i.Bc=function(){if(this.i){if(this.ua())return[];for(var e=this.l?this.l.A:null,t=[],n=d(this.i.textStreams),i=n.next();!i.done;i=n.next()){i=i.value;var r=pr(i);r.active=i==e,t.push(r)}return t}return this.h&&this.h.src&&this.h.textTracks?bp(this).map(function(e){return vr(e)}):[]},i.Aj=function(){var e=this.ye;return this.i&&(e=this.i.imageStreams),e.map(function(e){return gr(e)})},i.oj=function(e){var t,n,i=this;return U(function(r){return 1==r.g?w(r,mp(i,e),2):(t=r.h,t?(n=[],t.segmentIndex.Db(function(e){var i=gp(e.tilesLayout||t.tilesLayout);if(i)for(var r=i.rows*i.Kc,s=e.j-e.startTime,a=0;a<r;a++){var o=vp(e,t,e.startTime+s*a/r,i);n.push(o)}}),t.closeSegmentIndex&&t.closeSegmentIndex(),r.return(n)):r.return(null))})},i.Rj=function(e,t){var n,i,r,s,a=this;return U(function(o){return 1==o.g?w(o,mp(a,e),2):(n=o.h,n?(i=n.segmentIndex.find(t),null==i?o.return(null):(r=n.segmentIndex.get(i),(s=gp(r.tilesLayout||n.tilesLayout))?o.return(vp(r,n,t,s)):o.return(null))):o.return(null))})},i.eh=function(e){function t(){var t=n.i.textStreams.find(function(t){return t.id==e.id});t&&t!=n.l.A&&(qd(n.A.h,t,!1),Uc(n.l,t),Vp(n),Wp(n),n.ud=t.language)}var n=this;this.i&&this.F&&(t(),!this.ua())||function(){if(n.h&&n.h.textTracks){var t=bp(n),i=t.find(function(t){return mr(t)===e.id});if(i){if(n.o instanceof Ph){t=d(t);for(var r=t.next();!r.done;r=t.next()){r=r.value;var s=r===i?n.oa?"showing":"hidden":"disabled";r.mode!==s&&(r.mode=s)}}else t=t.find(function(e){return"disabled"!==e.mode}),t!==i&&(t&&(t.mode="disabled",n.j.Ja(t,"cuechange"),n.o.remove(0,1/0)),i&&yp(n,i));Vp(n),Wp(n)}}}()},i.Bf=function(e,t,n){function i(){var i=r.i.variants.find(function(t){return t.id==e.id});if(i&&br(i)){var s=r.l.o;r.g.abr.enabled&&(s.video!=i.video||s.audio&&i.audio&&s.audio.language==i.audio.language&&s.audio.channelsCount==i.audio.channelsCount&&s.audio.label==i.audio.label)&&Q("Changing tracks while abr manager is enabled will likely result in the selected track being overridden. Consider disabling abr before calling selectVariantTrack()."),r.ua()?Np(r,i,!1,!1,0):Np(r,i,!1,t||!1,n||0),r.M.configure({language:i.language,role:i.audio&&i.audio.roles&&i.audio.roles[0]||"",channelCount:i.audio&&i.audio.channelsCount?i.audio.channelsCount:0,Cc:i.video&&i.video.hdr?i.video.hdr:"",spatialAudio:!(!i.audio||!i.audio.spatialAudio)&&i.audio.spatialAudio,videoLayout:i.video&&i.video.videoLayout?i.video.videoLayout:"",Ic:i.audio&&i.audio.label?i.audio.label:"",Bd:"",codecSwitchingStrategy:r.g.mediaSource.codecSwitchingStrategy,audioCodec:i.audio&&i.audio.codecs?i.audio.codecs:"",Dd:s.audio&&s.audio.codecs?s.audio.codecs:"",De:s.audio&&s.audio.channelsCount?s.audio.channelsCount:0,preferredAudioCodecs:r.g.preferredAudioCodecs,preferredAudioChannelCount:r.g.preferredAudioChannelCount}),_p(r)}}var r=this;t=void 0!==t&&t,n=void 0===n?0:n,this.i&&this.F&&(i(),!this.ua())||function(){if(e.originalAudioId&&r.h&&r.h.audioTracks){var t=Array.from(r.h.audioTracks);t=d(t);for(var n=t.next();!n.done;n=t.next())if(n=n.value,mr(n)==e.id){Up(r,n);break}}}()},i.Mk=function(e,t){function n(){var n=i.M.getConfiguration();n.audioCodec=e.codecs||"",n.Ic=e.label||"",n.channelCount=e.channelsCount||0,n.language=e.language,n.role=e.roles[0]||"",n.spatialAudio=e.spatialAudio,i.M.configure(n),Op(i,!0,t,!1,!1)}var i=this;t=void 0===t?0:t,this.i&&this.F&&(n(),!this.ua())||function(){if(i.h&&i.h.audioTracks){var t=Array.from(i.h.audioTracks),n=null;t=d(t);for(var r=t.next();!r.done;r=t.next())if(r=r.value,r.label==e.label&&r.language==e.language&&r.kind==e.roles[0]){n=r;break}n&&Up(i,n)}}()},i.getAudioTracks=function(){if(this.i&&!this.ua()){var e=this.Ob();if(!e.length)return[];var t=e.find(function(e){return e.active});if(!t)return[];var n=e;if(this.m!=rg||this.ua()||(n=e.filter(function(e){return e.originalVideoId===t.originalVideoId&&e.audioCodec})),!n.length)return[];e=new Map,n=d(n);for(var i=n.next();!i.done;i=n.next()){i=i.value;var r=i.originalAudioId;r||null==i.audioId||(r=String(i.audioId)),r&&e.set(r,{active:i.active,language:i.language,label:i.label,mimeType:i.audioMimeType,codecs:i.audioCodec,primary:i.primary,roles:i.audioRoles||[],accessibilityPurpose:i.accessibilityPurpose,channelsCount:i.channelsCount,audioSamplingRate:i.audioSamplingRate,spatialAudio:i.spatialAudio,originalLanguage:i.originalLanguage})}return Array.from(e.values())}return this.h&&this.h.audioTracks?Array.from(this.h.audioTracks).map(function(e){var t=e.language;return t={active:e.enabled,language:Vi(t||"und"),label:e.label,mimeType:null,codecs:null,primary:"main"==e.kind,roles:[],accessibilityPurpose:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,originalLanguage:t},e.kind&&t.roles.push(e.kind),e.configuration&&(e.configuration.codec&&(t.codecs=e.configuration.codec),e.configuration.sampleRate&&(t.audioSamplingRate=e.configuration.sampleRate),e.configuration.numberOfChannels&&(t.channelsCount=e.configuration.numberOfChannels)),t}):[]},i.Ok=function(e,t,n){t=void 0!==t&&t,n=void 0===n?0:n;var i=this.Ob();if(i.length){var r=i.find(function(e){return e.active});r&&(i=i.find(function(t){return t.audioId===r.audioId&&(t.videoBandwidth||t.bandwidth)==e.bandwidth&&t.width==e.width&&t.height==e.height&&t.frameRate==e.frameRate&&t.pixelAspectRatio==e.pixelAspectRatio&&t.hdr==e.hdr&&t.colorGamut==e.colorGamut&&t.videoLayout==e.videoLayout&&t.videoMimeType==e.mimeType&&t.videoCodec==e.codecs}))&&!i.active&&this.Bf(i,t,n)}},i.getVideoTracks=function(){if(this.m==sg||this.ua())return[];var e=this.Ob();if(!e.length)return[];var t=e.find(function(e){return e.active});if(!t)return[];var n=e.filter(function(e){return e.originalAudioId===t.originalAudioId&&e.audioId===t.audioId&&e.audioGroupId===t.audioGroupId&&e.videoCodec});if(!n.length)return[];e=new Map,n=d(n);for(var i=n.next();!i.done;i=n.next()){i=i.value;var r=i.originalVideoId;r||null==i.videoId||(r=String(i.videoId)),r&&e.set(r,{active:i.active,bandwidth:i.videoBandwidth||i.bandwidth,width:i.width,height:i.height,frameRate:i.frameRate,pixelAspectRatio:i.pixelAspectRatio,hdr:i.hdr,colorGamut:i.colorGamut,videoLayout:i.videoLayout,mimeType:i.videoMimeType,codecs:i.videoCodec})}return Array.from(e.values())},i.qj=function(){return tg(this.Ob())},i.Pj=function(){return tg(this.Bc())},i.pj=function(){return Array.from(eg(this.Ob()))},i.Oj=function(){return Array.from(eg(this.Bc()))},i.Fi=function(e,t,n,i,r,s,a){function o(){function o(e,t){return e.video||t.video?e.video&&t.video?Math.abs((e.video.height||0)-(t.video.height||0))+Math.abs((e.video.width||0)-(t.video.width||0)):1/0:0}var l=u.l.o;u.M=u.g.adaptationSetCriteriaFactory(),u.M.configure({language:e,role:t||"",channelCount:n||0,Cc:"",spatialAudio:s||!1,videoLayout:"",Ic:a||"",Bd:"",codecSwitchingStrategy:u.g.mediaSource.codecSwitchingStrategy,audioCodec:r||"",Dd:l.audio&&l.audio.codecs?l.audio.codecs:"",De:l.audio&&l.audio.channelsCount?l.audio.channelsCount:0,preferredAudioCodecs:u.g.preferredAudioCodecs,preferredAudioChannelCount:u.g.preferredAudioChannelCount});var c=u.M.create(u.i.variants),h=null;c=d(c.values());for(var f=c.next();!f.done;f=c.next())f=f.value,br(f)&&(!h||o(h,l)>o(f,l))&&(h=f);h!=l&&(h?(l=fr(h),u.Bf(l,!0,i||0)):Op(u))}var u=this;n=void 0===n?0:n,i=void 0===i?0:i,r=void 0===r?"":r,s=void 0!==s&&s,a=void 0===a?"":a,this.i&&this.F&&(o(),!this.ua())||function(){if(u.h&&u.h.audioTracks){var n=Sr(u.Ob(),e,t||"",!1)[0];n&&u.Bf(n)}}()},i.dh=function(e,t,n){function i(){r.ud=e,r.qe=t||"",r.pe=n||!1;var i=Sr(r.i.textStreams,r.ud,r.qe,r.pe)[0]||null;i&&i!=r.l.A&&(qd(r.A.h,i,!1),r.g.streaming.alwaysStreamText||r.Ig())&&(Uc(r.l,i),Vp(r),Wp(r))}var r=this;n=void 0!==n&&n,this.i&&this.F&&(i(),!this.ua())||function(){var i=Sr(r.Bc(),e,t||"",n||!1)[0];i&&r.eh(i)}()},i.Nk=function(e,t,n){function i(){for(var i=null,s=d(r.i.variants),a=s.next();!a.done;a=s.next())if(a=a.value,a.audio.label==e){i=a;break}null!=i&&(r.M=r.g.adaptationSetCriteriaFactory(),r.M.configure({language:i.language,role:"",channelCount:0,Cc:"",spatialAudio:!1,videoLayout:"",Bd:"",Ic:e,codecSwitchingStrategy:r.g.mediaSource.codecSwitchingStrategy,audioCodec:"",Dd:"",De:0,preferredAudioCodecs:r.g.preferredAudioCodecs,preferredAudioChannelCount:r.g.preferredAudioChannelCount}),Op(r,t,n))}var r=this;t=void 0===t||t,n=void 0===n?0:n,this.i&&this.F&&(i(),!this.ua())||function(){if(r.h&&r.h.audioTracks){var t=Array.from(r.h.audioTracks),n=null;t=d(t);for(var i=t.next();!i.done;i=t.next())i=i.value,i.label==e&&(n=i);n&&Up(r,n)}}()},i.Ig=function(){var e=this.oa;return this.o?this.o.isTextVisible():e},i.uj=function(){return this.ab.map(function(e){return pr(e)})},i.sj=function(e){if(ge("getChapters","Please use an getChaptersAsync."),!this.ab.length)return[];var t=Vi(e);if(e=this.ab.filter(function(e){return Vi(e.language)==t}),!e.length)return[];var n=[],i=new Set;e=d(e);for(var r=e.next();!r.done;r=e.next())r=r.value,r.segmentIndex&&r.segmentIndex.Db(function(e){var t=e.O()[0],r=e.startTime+"-"+e.endTime+"-"+t;e={id:r,title:t,startTime:e.startTime,endTime:e.endTime},i.has(r)||(n.push(e),i.add(r))});return n},i.tj=function(e){var t,n,i,r,s,a,o,u=this;return U(function(l){switch(l.g){case 1:if(!u.ab.length)return l.return([]);if(t=Vi(e),n=u.ab.filter(function(e){return Vi(e.language)==t}),!n.length)return l.return([]);i=[],r=new Set,s=d(n),a=s.next();case 2:if(a.done){l.u(4);break}if(o=a.value,o.segmentIndex){l.u(5);break}return w(l,o.createSegmentIndex(),5);case 5:o.segmentIndex.Db(function(e){var t=e.O()[0],n=e.startTime+"-"+e.endTime+"-"+t;e={id:n,title:t,startTime:e.startTime,endTime:e.endTime},r.has(n)||(i.push(e),r.add(n))}),a=s.next(),l.u(2);break;case 4:return l.return(i)}})},i.jh=function(e){e=!!e,this.oa!=e&&(this.oa=e,this.m==rg?(this.o.setTextVisibility(e),this.g.streaming.alwaysStreamText||(e?this.l.A||(e=Sr(this.i.textStreams,this.ud,this.qe,this.pe),0<e.length&&(Uc(this.l,e[0]),Vp(this),Wp(this))):_c(this.l))):this.h&&this.h.src&&this.h.textTracks&&this.o.setTextVisibility(e),Hp(this))},i.Ij=function(){if(this.F)var e=this.F.Be();else{if(null==this.N)return new Date;if(this.N instanceof Date)return this.N;e=this.N}if(this.i&&!this.ua()){var t=this.i.presentationTimeline;return new Date(1e3*((t.m||t.i)+e))}return this.h&&this.h.getStartDate?(t=this.h.getStartDate(),isNaN(t.getTime())?null:new Date(t.getTime()+1e3*e)):null},i.Bg=function(){if(this.i&&!this.ua()){var e=this.i.presentationTimeline;return new Date(1e3*(e.m||e.i))}return this.h&&this.h.getStartDate?(e=this.h.getStartDate(),isNaN(e.getTime())?null:e):null},i.Ue=function(){return this.V()&&this.i?this.i.presentationTimeline.Ue():null},i.Lb=function(){if(this.m==rg)return this.I.Lb();var e={total:[],audio:[],video:[],text:[]};return this.m==sg&&(e.total=Ko(this.h.buffered)),e},i.Se=function(){if(!this.h||!this.h.currentTime)return null;var e=this.Bg().getTime()+1e3*this.h.currentTime;return Math.floor(Date.now()-e)},i.getStats=function(){if(this.m!=rg&&this.m!=sg)return{width:NaN,height:NaN,currentCodecs:"",streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,manifestSizeBytes:NaN,bytesDownloaded:NaN,nonFatalErrorCount:NaN,manifestPeriodCount:NaN,manifestGapCount:NaN,switchHistory:[],stateHistory:[]};Dp(this);var e=this.h,t=e.currentTime/e.duration;if(isNaN(t)||this.V()||Qd(this.A,Math.round(100*t)),this.F&&(this.A.S=this.F.Ah(),this.A.U=this.F.Bh()),e.getVideoPlaybackQuality&&(t=e.getVideoPlaybackQuality(),zd(this.A,Number(t.droppedVideoFrames),Number(t.totalVideoFrames)),this.A.M=Number(t.corruptedVideoFrames)),this.A.o=this.C?Zs(this.C):NaN,Xd(this.A,e.videoWidth||NaN,e.videoHeight||NaN),this.A.l="",this.V()&&null!=this.Bg()&&(e=this.Se()||0,this.A.C=e/1e3),t=this.Ob().find(function(e){return e.active}),e=this.Bc().find(function(e){return e.active}),t){if(t.bandwidth){var n=this.K?this.K.i:1,i=n*t.bandwidth;e&&e.bandwidth&&(i+=n*e.bandwidth),this.A.A=i}t.width&&t.height&&Xd(this.A,t.width||NaN,t.height||NaN),t=t.codecs,e&&(t+=","+(e.codecs||e.mimeType)),t&&(this.A.l=t)}return this.m!=rg||this.ua()||(this.i&&(this.A.H=this.i.periodCount,this.A.G=this.i.gapCount,this.i.presentationTimeline&&(this.A.K=this.i.presentationTimeline.h)),e=this.s.getBandwidthEstimate(),this.A.s=e),this.m==sg&&Jd(this.A,NaN),Zd(this.A)},i.Ed=function(e,t,n,i,r,s,a){a=void 0!==a&&a;var o,u,l,c,d,h,f,p,g,m,v,y,b=this;return U(function(T){switch(T.g){case 1:if(b.m!=rg&&b.m!=sg)throw new Ve(1,7,7004);if("subtitles"!=n&&"captions"!=n&&Q("Using a kind value different of `subtitles` or `captions` can cause unwanted issues."),i){T.u(2);break}return w(T,Ep(b,e),3);case 3:i=T.h;case 2:if(o=[],b.B&&(o=b.B.getCuePoints()),b.m!=sg){T.u(4);break}return u=ce(),a&&"WEBKIT"===u.Da()&&(n="forced"),w(T,wp(b,e,t,n,i,s||"",o),5);case 5:if(l=T.h,l.track)return Bp(b),T.return(vr(l.track));throw new Ve(1,2,2012);case 4:if(c=pt,d=b.Ra(),h=d.end-d.start,b.i&&(h=b.i.presentationTimeline.getDuration()),1/0==h)throw new Ve(1,4,4033);if(!o.length){T.u(6);break}return w(T,Ap(b,e,b.H,b.g.streaming.retryParameters),7);case 7:f=T.h,p=xp(b,f,i,o),g=new Blob([p],{type:"text/vtt"}),e=ml(g),i="text/vtt";case 6:if(m={id:b.se++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:ql(0,h,[e]),mimeType:i||"",codecs:r||"",kind:n,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:s||null,type:c.Ya,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!!a,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([hi(i||"",r||"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},v=hi(m.mimeType,m.codecs),y=Ii(v),!y)throw new Ve(2,2,2014,i);return b.i.textStreams.push(m),Bp(b),T.return(pr(m))}})},i.Fe=function(e,t){var n,i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S=this;return U(function(E){switch(E.g){case 1:if(S.m!=rg&&S.m!=sg)throw new Ve(1,7,7004);if(t){E.u(2);break}return w(E,Ep(S,e),3);case 3:t=E.h;case 2:if("text/vtt"!=t)throw new Ve(1,2,2017,e);if(n=pt,i=S.Ra(),r=i.end-i.start,S.i&&(r=S.i.presentationTimeline.getDuration()),1/0==r)throw new Ve(1,4,4045);return w(E,Ap(S,e,S.H,S.g.streaming.retryParameters),4);case 4:if(s=E.h,a=xi(t),!a)throw new Ve(2,2,2014,t);for(o=a(),u={periodStart:0,segmentStart:0,segmentEnd:r,vttOffset:0},l=Be(s),c=o.parseMedia(l,u,e,[]),h=[],f=d(c),p=f.next(),g={};!p.done;g={Lf:void 0,fd:void 0},p=f.next())g.fd=p.value,g.Lf=null,m=function(t){return function(){return null==t.Lf&&(t.Lf=ot([e],[t.fd.payload])),t.Lf||[]}}(g),v=new No(g.fd.startTime,g.fd.endTime,m,0,null,null,0,0,1/0),g.fd.payload.includes("#xywh")&&(y=g.fd.payload.split("#xywh=")[1].split(","),4===y.length&&v.Df({height:parseInt(y[3],10),positionX:parseInt(y[0],10),positionY:parseInt(y[1],10),width:parseInt(y[2],10)})),h.push(v);if(b=t,!h.length){E.u(5);break}return w(E,Th(h[0].O()[0],S.H,S.g.manifest.retryParameters),6);case 6:b=E.h;case 5:return T={id:S.se++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Kl(h),mimeType:b||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:n.Of,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([hi(b||"","")]),isAudioMuxedInVideo:!1,baseOriginalId:null},S.m==sg?S.ye.push(T):S.i.imageStreams.push(T),Bp(S),E.return(gr(T))}})},i.Ee=function(e,t,n){var i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b=this;return U(function(T){switch(T.g){case 1:if(b.m!=rg&&b.m!=sg)throw new Ve(1,7,7004);if(n){T.u(2);break}return w(T,Ep(b,e),3);case 3:n=T.h;case 2:if(i=pt,r=b.Ra(),s=r.end-r.start,b.i&&(s=b.i.presentationTimeline.getDuration()),1/0==s)throw new Ve(1,4,4054);return w(T,Ap(b,e,b.H,b.g.streaming.retryParameters),4);case 4:if(a=T.h,o=xi(n),!o)throw new Ve(2,2,2014,n);for(u=o(),l={periodStart:0,segmentStart:0,segmentEnd:s,vttOffset:0},c=Be(a),h=u.parseMedia(c,l,e,[]),f=[],p=d(h),g=p.next(),m={};!g.done;m={Oe:void 0},g=p.next())m.Oe=g.value,v=new No(m.Oe.startTime,m.Oe.endTime,function(e){return function(){return[e.Oe.payload]}}(m),0,null,null,0,0,1/0),f.push(v);return y={id:b.se++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Kl(f),mimeType:"text/plain",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:null,type:i.Ya,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([hi("text/plain","")]),isAudioMuxedInVideo:!1,baseOriginalId:null},b.ab.push(y),Bp(b),T.return(pr(y))}})},i.Tk=function(e,t){this.va.width=e,this.va.height=t},i.Zg=function(e){if(this.m==rg){var t=this.l;if(e=void 0===e?.1:e,t.l.g)t=!1;else if(t.B)t=!1;else{for(var n=d(t.h.values()),i=n.next();!i.done;i=n.next())i=i.value,!i.Qd||i.Pa||i.zb||(i.Qd=!1,od(t,i,e));t=!0}}else t=!1;return t},i.Ag=function(){return Q("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.i},i.Ej=function(){return this.qc},i.yj=function(){var e={video:null,audio:null,text:null};if(this.m!=rg)return e;var t=this.l.o,n=this.h.currentTime;t=d([t.video,t.audio,this.l.A]);for(var i=t.next();!i.done;i=t.next())if((i=i.value)&&i.segmentIndex){var r=i.segmentIndex.find(n);r=i.segmentIndex.get(r),r={codecs:r.codecs||i.codecs,mimeType:r.mimeType||i.mimeType,bandwidth:r.bandwidth||i.bandwidth},"video"==i.type?(r.width=i.width,r.height=i.height,e.video=r):"audio"==i.type?e.audio=r:i.type==ft&&(e.text=r)}return e},i.Mi=function(e){this.ue=e},i.disableStream=function(e,t){if(!this.g.abr.enabled||this.m===ng||!navigator.onLine||0==t||!this.i)return!1;if(this.i.variants.some(function(t){var n=t[e.type];return!(!n||n.id===e.id||t.disabledUntilTime)&&("audio"!=e.type||e.language===n.language)})){for(var n=!1,i=!1,r=d(this.i.variants),s=r.next();!s.done;s=r.next()){s=s.value;var a=s[e.type];a&&(a.id===e.id?(s.disabledUntilTime=Date.now()/1e3+t,n=!0):a.trickModeVideo&&a.trickModeVideo.id==e.id&&(i=!0))}return!(!n&&i)&&(this.ve.Ga(1),t=this.Lb().video.reduce(function(e,t){return e+t.end-t.start},0),Op(this,!1,t,!0,!1),!0)}return!1},i.addFont=function(e,t){return Qo(e,t)},i.ua=function(){return!(!this.h||!this.h.remote)&&"disconnected"!=this.h.remote.state},i.Ud=function(){return!(this.h&&!this.h.ended)||this.Ka&&!this.V()&&this.h.currentTime>=this.Ra().end},K("shaka.Player",Pf),Pf.prototype.isEnded=Pf.prototype.Ud,Pf.prototype.isRemotePlayback=Pf.prototype.ua,Pf.prototype.addFont=Pf.prototype.addFont,Pf.prototype.setVideoContainer=Pf.prototype.Mi,Pf.prototype.getFetchedPlaybackInfo=Pf.prototype.yj,Pf.prototype.getManifestParserFactory=Pf.prototype.Ej,Pf.prototype.getManifest=Pf.prototype.Ag,Pf.prototype.retryStreaming=Pf.prototype.Zg,Pf.prototype.setMaxHardwareResolution=Pf.prototype.Tk,Pf.prototype.addChaptersTrack=Pf.prototype.Ee,Pf.prototype.addThumbnailsTrack=Pf.prototype.Fe,Pf.prototype.addTextTrackAsync=Pf.prototype.Ed,Pf.prototype.getStats=Pf.prototype.getStats,Pf.prototype.getBufferedInfo=Pf.prototype.Lb,Pf.prototype.getSegmentAvailabilityDuration=Pf.prototype.Ue,Pf.prototype.getPresentationStartTimeAsDate=Pf.prototype.Bg,Pf.prototype.getPlayheadTimeAsDate=Pf.prototype.Ij,Pf.prototype.setTextTrackVisibility=Pf.prototype.jh,Pf.prototype.getChaptersAsync=Pf.prototype.tj,Pf.prototype.getChapters=Pf.prototype.sj,Pf.prototype.getChaptersTracks=Pf.prototype.uj,Pf.prototype.isTextTrackVisible=Pf.prototype.Ig,Pf.prototype.selectVariantsByLabel=Pf.prototype.Nk,Pf.prototype.selectTextLanguage=Pf.prototype.dh,Pf.prototype.selectAudioLanguage=Pf.prototype.Fi,Pf.prototype.getTextLanguages=Pf.prototype.Oj,Pf.prototype.getAudioLanguages=Pf.prototype.pj,Pf.prototype.getTextLanguagesAndRoles=Pf.prototype.Pj,Pf.prototype.getAudioLanguagesAndRoles=Pf.prototype.qj,Pf.prototype.getVideoTracks=Pf.prototype.getVideoTracks,Pf.prototype.selectVideoTrack=Pf.prototype.Ok,Pf.prototype.getAudioTracks=Pf.prototype.getAudioTracks,Pf.prototype.selectAudioTrack=Pf.prototype.Mk,Pf.prototype.selectVariantTrack=Pf.prototype.Bf,Pf.prototype.selectTextTrack=Pf.prototype.eh,Pf.prototype.getThumbnails=Pf.prototype.Rj,Pf.prototype.getAllThumbnails=Pf.prototype.oj,Pf.prototype.getImageTracks=Pf.prototype.Aj,Pf.prototype.getTextTracks=Pf.prototype.Bc,Pf.prototype.getVariantTracks=Pf.prototype.Ob,Pf.prototype.cancelTrickPlay=Pf.prototype.Fd,Pf.prototype.trickPlay=Pf.prototype.ie,Pf.prototype.useTrickPlayTrackIfAvailable=Pf.prototype.yh,Pf.prototype.getPlaybackRate=Pf.prototype.sb,Pf.prototype.isBuffering=Pf.prototype.Hg,Pf.prototype.getKeyStatuses=Pf.prototype.Re,Pf.prototype.getActiveSessionsMetadata=Pf.prototype.zg,Pf.prototype.getExpiration=Pf.prototype.Nd,Pf.prototype.drmInfo=Pf.prototype.drmInfo,Pf.prototype.keySystem=Pf.prototype.keySystem,Pf.prototype.isFullyLoaded=Pf.prototype.bk,Pf.prototype.goToLive=Pf.prototype.Xj,Pf.prototype.seekRange=Pf.prototype.Ra,Pf.prototype.isVideoOnly=Pf.prototype.hk,Pf.prototype.isAudioOnly=Pf.prototype.$j,Pf.prototype.isInProgress=Pf.prototype.Sc,Pf.prototype.isLive=Pf.prototype.V,Pf.prototype.getQueueManager=Pf.prototype.Xh,Pf.prototype.getAdManager=Pf.prototype.Rh,Pf.prototype.getAssetUri=Pf.prototype.kd,Pf.prototype.getNetworkingEngine=Pf.prototype.Nb,Pf.prototype.getMediaElement=Pf.prototype.Hj,Pf.prototype.getManifestType=Pf.prototype.Uh,Pf.prototype.getLoadMode=Pf.prototype.Dj,Pf.prototype.resetConfiguration=Pf.prototype.Ai,Pf.prototype.getBufferFullness=Pf.prototype.Sh,Pf.prototype.getNonDefaultConfiguration=Pf.prototype.Wh,Pf.prototype.getConfigurationForLowLatency=Pf.prototype.vj,Pf.prototype.getConfiguration=Pf.prototype.getConfiguration,Pf.prototype.configurationForLowLatency=Pf.prototype.lj,Pf.prototype.configure=Pf.prototype.configure,Pf.prototype.releaseAllMutexes=Pf.prototype.Ek,Pf.prototype.destroyAllPreloads=Pf.prototype.ig,Pf.prototype.preload=Pf.prototype.preload,Pf.prototype.detachAndSavePreload=Pf.prototype.Nh,Pf.prototype.unloadAndSavePreload=Pf.prototype.Wk,Pf.prototype.load=Pf.prototype.load,Pf.prototype.updateStartTime=Pf.prototype.$k,Pf.prototype.unload=Pf.prototype.uc,Pf.prototype.detach=Pf.prototype.detach,Pf.prototype.attachCanvas=Pf.prototype.dj,Pf.prototype.attach=Pf.prototype.dc,Pf.probeSupport=function(e){var t,n,i,r,s,a,o;return e=void 0===e||e,U(function(u){switch(u.g){case 1:if(t={},!e){u.u(2);break}return w(u,da(),3);case 3:t=u.h;case 2:return n=$a(),i=Mu(),r=ce(),w(u,r.fc(),4);case 4:return s=u.h,a={manifest:n,media:i,drm:t,hardwareResolution:s},o=og,o.forEach(function(e,t){a[t]=e()}),u.return(a)}})},Pf.isBrowserSupported=function(){return e.Promise||Q("A Promise implementation or polyfill is required"),!(!(e.Promise&&e.Uint8Array&&Array.prototype.forEach)||(navigator.userAgent||"").includes("Trident/"))&&(ce(),!!KT()||""!=Xo().canPlayType("application/x-mpegurl"))},Pf.setQueueManagerFactory=function(e){lg=e},Pf.setAdManagerFactory=function(e){ug=e},Pf.registerSupportPlugin=Uf,Pf.prototype.destroy=Pf.prototype.destroy;var ng=0,ig=1,rg=2,sg=3;Pf.LoadMode={DESTROYED:ng,NOT_LOADED:ig,MEDIA_SOURCE:rg,SRC_EQUALS:sg},Pf.version="v4.15.3";var ag=["4","15"];ye=new function(e){this.g=e,this.i=me,this.h=ve}(new pe(Number(ag[0]),Number(ag[1])));var og=new Map,ug=null,lg=null;function cg(){this.g=[],this.i=this.m=this.l=this.j=this.h=0}function dg(e){return e.g.length?e.g.reduce(function(e,t){return e+t},0)/e.g.length:0}function hg(e,t,n){var i=this;this.g=e,this.h=t,this.m=n,this.i=!1,this.j=this.h.getVolume(),this.l=new re,this.l.D(this.h,google.ima.AdEvent.Type.PAUSED,function(){i.i=!0}),this.l.D(this.h,google.ima.AdEvent.Type.RESUMED,function(){i.i=!1})}function fg(){}function pg(e,t){var n=[];e=d(nn(e,"Ad"));for(var i=e.next();!i.done;i=e.next())if((i=on(i.value,"InLine"))&&(i=on(i,"Creatives"))){i=d(nn(i,"Creative"));for(var r=i.next();!r.done;r=i.next()){r=r.value;var s=on(r,"Linear");if(s&&gg(n,t,s),r=on(r,"NonLinearAds")){r=nn(r,"NonLinear"),r=d(r);for(var a=r.next();!a.done;a=r.next())e:{s=n;var o=t,u=a.value,l=on(u,"StaticResource");if(l)a=l.attributes.creativeType;else{if(l=on(u,"HTMLResource"),!l)break e;a="text/html"}if(l=sn(l)){"text/html"===a&&(l="data:text/html;charset=UTF-8,"+encodeURIComponent(l));var c=ln(u,"width",mn)||ln(u,"expandedWidth",mn),h=ln(u,"height",mn)||ln(u,"expandedHeight",mn);if(c||h){var f=null;(u=u.attributes.minSuggestedDuration)&&(f=Kt(u)),u=0,null!=o&&(u=o),s.push({id:null,groupId:null,startTime:u,endTime:null,uri:l,mimeType:a,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!1,resumeOffset:0,playoutLimit:f,once:!0,pre:null==o,post:1/0==o,timelineRange:!1,loop:!1,overlay:{viewport:{x:0,y:0},topLeft:{x:0,y:0},size:{x:c||0,y:h||0}},displayOnBackground:!1,currentVideo:null,background:null})}}}}}}return n}function gg(e,t,n){var i=0;null!=t&&(i=t);var r=null;if(n.attributes.skipoffset&&(r=Kt(n.attributes.skipoffset),isNaN(r)&&(r=null)),n=on(n,"MediaFiles")){var s=nn(n,"MediaFile");for(n=s,s=s.filter(function(e){return"streaming"==e.attributes.delivery}),s.length&&(n=s),n=n.sort(function(e,t){return(parseInt(t.attributes.height,10)||0)-(parseInt(e.attributes.height,10)||0)}),n=d(n),s=n.next();!s.done;s=n.next())if(s=s.value,!s.attributes.apiFramework){var a=sn(s);if(a){e.push({id:null,groupId:null,startTime:i,endTime:null,uri:a,mimeType:s.attributes.type||null,isSkippable:null!=r,skipOffset:r,skipFor:null,canJump:!1,resumeOffset:0,playoutLimit:null,once:!0,pre:null==t,post:1/0==t,timelineRange:!1,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null});break}}}}function mg(e,t,n,i,r){var s=this;this.s=e,this.i=t,this.F=!1,this.A=this.o=null,this.G=NaN,this.l=r,this.j=null,this.h=new re,google.ima.settings.setLocale(n),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this.C=new google.ima.AdDisplayContainer(this.s,this.i),this.C.initialize(),this.m=new google.ima.AdsLoader(this.C),this.m.getSettings().setPlayerType("shaka-player"),this.m.getSettings().setPlayerVersion("v4.15.3"),this.g=null,this.B=i||new google.ima.AdsRenderingSettings,this.h.D(this.m,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(e){yg(s,e)}),this.h.D(this.m,google.ima.AdErrorEvent.Type.AD_ERROR,function(e){vg(s,e)}),this.h.D(this.i,"ended",function(){s.m.contentComplete()}),this.h.za(this.i,"play",function(){s.F=!0})}function vg(e,t){t.getError(),t=(new Map).set("originalEvent",t),e.l(new Zr("ad-error",t)),Sg(e,null),e.l(new Zr("ad-cue-points-changed",(new Map).set("cuepoints",[])))}function yg(t,n){if(t.l(new Zr("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-t.G))),t.o.customPlayheadTracker){var i={currentTime:t.i.currentTime};t.g=n.getAdsManager(i,t.B),t.i.muted?t.g.setVolume(0):t.g.setVolume(t.i.volume),t.h.D(t.i,"timeupdate",function(){t.i.duration&&(i.currentTime=t.i.currentTime)}),t.h.D(t.i,"volumechange",function(){t.j&&(t.j.setVolume(t.i.volume),t.i.muted&&t.j.setMuted(!0))})}else t.g=n.getAdsManager(t.i,t.B);t.l(new Zr("ima-ad-manager-loaded",(new Map).set("imaAdManager",t.g)));var r=t.g.getCuePoints();if(r.length){n=[],r=d(r);for(var s=r.next();!s.done;s=r.next())n.push({start:s.value,end:null});t.l(new Zr("ad-cue-points-changed",(new Map).set("cuepoints",n)))}bg(t);try{t.g.init(t.i.offsetWidth,t.i.offsetHeight),t.h.D(t.i,"loadeddata",function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight)}),"ResizeObserver"in e?(t.A=new ResizeObserver(function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight)}),t.A.observe(t.i)):t.h.D(document,"fullscreenchange",function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight)}),t.F||t.o.skipPlayDetection?t.g.start():t.h.za(t.i,"play",function(){t.F=!0,t.g.start()})}catch(a){Sg(t,null)}}function bg(e){function t(t,n){t=(new Map).set("originalEvent",t),e.l(new Zr(n,t))}e.h.D(e.g,google.ima.AdErrorEvent.Type.AD_ERROR,function(t){vg(e,t)}),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,function(t){Tg(e,t)}),e.h.D(e.g,google.ima.AdEvent.Type.STARTED,function(t){Tg(e,t)}),e.h.D(e.g,google.ima.AdEvent.Type.FIRST_QUARTILE,function(e){t(e,"ad-first-quartile")}),e.h.D(e.g,google.ima.AdEvent.Type.MIDPOINT,function(e){t(e,"ad-midpoint")}),e.h.D(e.g,google.ima.AdEvent.Type.THIRD_QUARTILE,function(e){t(e,"ad-third-quartile")}),e.h.D(e.g,google.ima.AdEvent.Type.COMPLETE,function(e){t(e,"ad-complete")}),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(t){Sg(e,t)}),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(t){Sg(e,t)}),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPED,function(e){t(e,"ad-skipped")}),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_CHANGED,function(e){t(e,"ad-volume-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_MUTED,function(e){t(e,"ad-muted")}),e.h.D(e.g,google.ima.AdEvent.Type.PAUSED,function(n){e.j&&(e.j.i=!0,t(n,"ad-paused"))}),e.h.D(e.g,google.ima.AdEvent.Type.RESUMED,function(n){e.j&&(e.j.i=!1,t(n,"ad-resumed"))}),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,function(n){e.j&&t(n,"ad-skip-state-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.CLICK,function(e){t(e,"ad-clicked")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_PROGRESS,function(e){t(e,"ad-progress")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_BUFFERING,function(e){t(e,"ad-buffering")}),e.h.D(e.g,google.ima.AdEvent.Type.IMPRESSION,function(e){t(e,"ad-impression")}),e.h.D(e.g,google.ima.AdEvent.Type.DURATION_CHANGE,function(e){t(e,"ad-duration-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.USER_CLOSE,function(e){t(e,"ad-closed")}),e.h.D(e.g,google.ima.AdEvent.Type.LOADED,function(e){t(e,"ad-loaded")}),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(e){t(e,"all-ads-completed")}),e.h.D(e.g,google.ima.AdEvent.Type.LINEAR_CHANGED,function(e){t(e,"ad-linear-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_METADATA,function(e){t(e,"ad-metadata")}),e.h.D(e.g,google.ima.AdEvent.Type.LOG,function(e){t(e,"ad-recoverable-error")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_BREAK_READY,function(e){t(e,"ad-break-ready")}),e.h.D(e.g,google.ima.AdEvent.Type.INTERACTION,function(e){t(e,"ad-interaction")})}function Tg(e,t){var n=t.getAd();n?(e.j=new hg(n,e.g,e.i),t.type!=google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED||e.o.supportsMultipleMediaElements||e.l(new Zr("ad-content-pause-requested")),t=(new Map).set("ad",e.j).set("sdkAdObject",n).set("originalEvent",t),e.l(new Zr("ad-started",t)),e.j.isLinear()&&(e.s.setAttribute("ad-active","true"),e.o.customPlayheadTracker||e.i.pause(),e.i.muted?(t=e.j,t.j=e.i.volume,t.h.setVolume(0)):e.j.setVolume(e.i.volume))):Q("The IMA SDK fired a "+t.type+" event with no associated ad. Unable to play ad!")}function Sg(e,t){t&&t.type==google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED&&!e.o.supportsMultipleMediaElements&&e.l(new Zr("ad-content-resume-requested")),e.l(new Zr("ad-stopped",(new Map).set("originalEvent",t))),e.j&&e.j.isLinear()&&(e.s.removeAttribute("ad-active"),e.o.customPlayheadTracker||e.i.ended||e.i.play())}function Eg(e,t,n,i,r,s){this.g=e,this.i=t,this.j=(this.h=t.isSkippable)?t.skipOffset||0:t.skipOffset,this.l=t.skipFor,this.A=n,this.o=i,this.m=r,this.s=s,this.B=t.overlay}function wg(e,t,n){this.g=e,this.j=t,this.h=n,this.i=null==e.overlay}function Ag(e,t,n,i){var r=this;this.M=null,this.B=e,this.C=t,this.g=n,this.G=null,this.A=!0,this.h=this.g,this.i=i,this.U=new Set,this.H=new Set,this.F=new Map,this.L=new Map,this.j=new Pf,Bg(this),this.I=new re,this.l=new re,this.K=!1,this.ia=this.o=this.s=this.m=null,this.ka=!1,this.P=-1,this.$=function(){if(!r.K&&r.m&&!r.C.ua()){r.m=r.g.currentTime;var e=Dg(r);e&&Mg(r,e,1,1,Date.now())}},this.W=function(){if(!(r.K||r.m||r.C.ua())){r.m=r.g.currentTime;var e=Dg(r,!0);e&&Mg(r,e,1,1,Date.now())}},this.oa=function(){if(!r.K&&r.m&&!r.C.ua()){var e=r.g.currentTime;r.s&&!r.s.pre&&!r.s.post&&e<(r.s.endTime||r.s.startTime)&&(r.s=null)}},this.S=new _i(this.$),this.N=new _i(function(){var e,t,n,i,s,a,o,u,l,c,h;return U(function(f){switch(f.g){case 1:if(!r.H.size||null==r.m){f.u(0);break}if(e=r.C.m,e==ng||e==ig)return f.return();t=!1,n=Array.from(r.H),i=r.C.Ra(),s=d(n),a=s.next();case 3:if(a.done){f.u(5);break}if(o=a.value,o==r.s){f.u(4);break}if(u=o.endTime||o.startTime,!(1<=i.start-u)){l=o.startTime-r.m,0<l&&10>=l&&(!r.F.has(o)&&$g(o)&&r.F.set(o,r.j.preload(o.uri,null,o.mimeType||void 0)),Vg(r,o)),f.u(4);break}if(!r.F.has(o)){f.u(7);break}return w(f,r.F.get(o),8);case 8:(c=f.h)&&c.destroy(),r.F.delete(o);case 7:Hg(r,o),h=JSON.stringify(o),r.U.has(h)&&r.U.delete(h),r.H.delete(o),Ig(r),o.overlay||(t=!0);case 4:a=s.next(),f.u(3);break;case 5:t&&Fg(r),A(f)}})}),this.configure(this.C.getConfiguration().ads)}function xg(e){if(!e.ka&&e.H.size){if(e.I.D(e.g,"playing",e.W),e.I.D(e.g,"timeupdate",e.W),e.I.D(e.g,"seeked",e.oa),e.I.D(e.g,"ended",e.$),"requestVideoFrameCallback"in e.g&&!Gg()){var t=e.g,n=function(){-1!=e.P&&(e.$(),-1!=e.P&&(e.P=t.requestVideoFrameCallback(n)))};e.P=t.requestVideoFrameCallback(n)}else e.S.Ga(.025);e.N&&e.N.Ga(1),e.ka=!0}}function Ig(e){e.ka&&!e.H.size&&(e.I.Ja(e.g,"playing",e.W),e.I.Ja(e.g,"timeupdate",e.W),e.I.Ja(e.g,"seeked",e.oa),e.I.Ja(e.g,"ended",e.$),-1!=e.P&&(e.g.cancelVideoFrameCallback(e.P),e.P=-1),e.S&&e.S.stop(),e.N&&e.N.stop(),e.ka=!1)}function kg(e){if(e.B&&e.M&&!e.K){var t=e.M.supportsMultipleMediaElements,n=e.g;n.webkitSupportsFullscreen&&n.webkitDisplayingFullscreen&&(t=!1),e.A==t&&(e.A=!t,e.A?(e.h=e.g,e.G&&(e.G.parentElement&&e.B.removeChild(e.G),e.G=null)):(e.G||(t=document.createElement(e.g.tagName),t.autoplay=!0,t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.display="none",t.setAttribute("playsinline",""),e.G=t),e.h=e.G))}else e.A=!0}function Lg(e,t){var n;U(function(i){if(1==i.g)return Bg(e),w(i,Ug(e,t),2);n=i.h,n.length?Cg(e,n):Q("Unsupported HLS interstitial",t),A(i)})}function Rg(e,t){var n=on(t.eventNode,"OverlayEvent"),i=n.attributes.uri,r=n.attributes.mimeType,s="true"==n.attributes.loop,a=ln(n,"z",mn);if(i&&0!=a){var o=null,u=on(n,"Background");if(u){var l=u.attributes.uri;o=l?"center / contain no-repeat url('"+l+"')":sn(u)}u=1920,l=1080;var c=on(n,"Viewport");if(c){if(u=ln(c,"x",mn),null==u)return;if(l=ln(c,"y",mn),null==l)return}var d={viewport:{x:u,y:l},topLeft:{x:0,y:0},size:{x:u,y:l}},h=on(n,"Overlay");if(c&&h){var f=on(h,"TopLeft"),p=on(h,"Size");if(f&&p){if(h=ln(f,"x",mn),null==h)return;if(f=ln(f,"y",mn),null==f)return;var g=ln(p,"x",mn);if(null==g)return;if(p=ln(p,"y",mn),null==p)return;d.topLeft.x=h,d.topLeft.y=f,d.size.x=g,d.size.y=p}}if(h=null,n=on(n,"Squeeze"),c&&n&&(p=on(n,"TopLeft"),n=on(n,"Size"),p&&n)){if(c=ln(p,"x",mn),null==c)return;if(h=ln(p,"y",mn),null==h)return;if(p=ln(n,"x",mn),null==p)return;if(n=ln(n,"y",mn),null==n)return;h={viewport:{x:u,y:l},topLeft:{x:c,y:h},size:{x:p,y:n}}}Cg(e,[{id:t.id,groupId:null,startTime:t.startTime,endTime:t.endTime,uri:i,mimeType:r,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:null,playoutLimit:null,once:!1,pre:!1,post:!1,timelineRange:!0,loop:s,overlay:d,displayOnBackground:-1==a,currentVideo:h,background:o}])}}function Cg(e,t){var n,i,r,s,a,o,u,l;U(function(c){switch(c.g){case 1:n=!1,i=d(t),r=i.next();case 2:if(r.done){c.u(4);break}if(s=r.value,!s.uri){Q("Missing URL in interstitial",s),c.u(3);break}if(s.mimeType){c.u(5);break}return x(c,6),a=e.j.Nb(),w(c,Th(s.uri,a,e.C.getConfiguration().streaming.retryParameters),8);case 8:s.mimeType=c.h,k(c,5);break;case 6:L(c);case 5:if(o=s.id||JSON.stringify(s),e.U.has(o)){c.u(3);break}s.loop&&!s.overlay&&Q("Loop is only supported in overlay interstitials",s),s.overlay||(n=!0),e.U.add(o),e.H.add(s),u=!1,s.pre&&null==e.m?u=!0:0!=s.startTime||s.canJump?null!=e.m&&(l=s.startTime-e.m,0<l&&10>=l&&(u=!0)):u=!0,u&&(!e.F.has(s)&&$g(s)&&e.F.set(s,e.j.preload(s.uri,null,s.mimeType||void 0)),Vg(e,s));case 3:r=i.next(),c.u(2);break;case 4:n&&Fg(e),xg(e),A(c)}})}function Dg(e,t,n){t=void 0!==t&&t,n=void 0===n?null:n;var i=0,r=null;if(e.H.size&&null!=e.m){var s=e.g.ended,a=Array.from(e.H).sort(function(e,t){return t.startTime-e.startTime}),o=a;for(o=t?a.filter(function(e){return e.pre}):s?a.filter(function(e){return e.post}):a.filter(function(e){return!e.pre&&!e.post}),a=d(o),o=a.next();!o.done;o=a.next()){o=o.value;var u=!1;if(t)u=o.pre;else if(s)u=o.post;else if(!o.pre&&!o.post){var l=e.m-Math.round(1e3*o.startTime)/1e3,c=1;e.M.allowStartInMiddleOfInterstitial&&o.endTime&&1/0!=o.endTime&&(c=o.endTime-o.startTime),0<l&&(l<=c||!o.canJump)&&(u=!(null==n&&e.s&&!e.s.pre&&!e.s.post&&e.s.startTime>=o.startTime))}u&&(!e.s||o.startTime>=e.s.startTime)&&(i==(n||0)?r=o:r&&!o.canJump&&.001<Math.round(1e3*o.startTime)/1e3-Math.round(1e3*r.startTime)/1e3&&(r=o,i=0),i++)}}return r}function Mg(e,t,n,i,r,s){s=void 0===s?0:s,e.s=t,kg(e),e.A||!e.B||e.h.parentElement||e.B.appendChild(e.h),1==i&&1==n&&(n=Array.from(e.H).filter(function(e){return t.pre?e.pre==t.pre:t.post?e.post==t.post:.001>Math.abs(e.startTime-t.startTime)}).length),t.once&&(s++,e.H.delete(t),Ig(e),t.overlay||Fg(e)),t.mimeType&&(t.mimeType.startsWith("image/")||"text/html"===t.mimeType)?t.overlay?Pg(e,t,n,i,s):Q("Unsupported interstitial",t):e.A&&t.overlay?Q("Unsupported interstitial",t):_g(e,t,n,i,r,s)}function Pg(e,t,n,i,r){function s(){e.o&&(e.o.stop(),e.o=null),e.B.removeChild(u),Ng(e,t),e.i(new Zr("ad-stopped")),e.l.Qa();var s=Dg(e,t.pre,i-r);s?Mg(e,s,n,++i,Date.now(),r):e.K=!1}e.K=!0;var a=t.overlay,o="text/html"==t.mimeType?"iframe":"img",u=document.createElement(o);u.style.objectFit="contain",u.style.position="absolute",u.style.border="none",Og(e,t),e.i(new Zr("ad-started",(new Map).set("ad",new wg(t,n,i)))),"iframe"==o?u.src=t.uri:(u.src=t.uri,u.onerror=function(t){e.i(new Zr("ad-error",(new Map).set("originalEvent",t))),s()});var l=a.viewport,c=a.topLeft;a=a.size,0==l.x&&0==l.y?(u.width=t.overlay.size.x,u.height=t.overlay.size.y,u.style.bottom="10%",u.style.left="0",u.style.right="0",u.style.width="100%",t.overlay.size.y||"iframe"!=o||(u.style.height="auto")):(u.style.height=a.y/l.y*100+"%",u.style.left=c.x/l.x*100+"%",u.style.top=c.y/l.y*100+"%",u.style.width=a.x/l.x*100+"%"),e.B.appendChild(u);var d=Date.now();e.o&&e.o.stop(),e.o=new _i(function(){t.playoutLimit&&(Date.now()-d)/1e3>t.playoutLimit||t.endTime&&e.g.currentTime>t.endTime?(e.i(new Zr("ad-complete")),s()):e.g.currentTime<t.startTime&&(e.i(new Zr("ad-skipped")),s())}),t.playoutLimit&&!t.endTime?e.o.ha(t.playoutLimit):t.endTime&&e.o.Ga(.025),e.l.D(e.g,"seeked",function(){var n=e.g.currentTime;(n<t.startTime||t.endTime&&n>t.endTime)&&(e.o&&e.o.stop(),e.i(new Zr("ad-skipped")),s())})}function _g(e,t,n,i,r,s){var a,o,u,l,c,d,h,f,p,g,m,v,y,b,T,S,E,I,R,C;U(function(D){switch(D.g){case 1:if(a=Date.now(),e.K=!0,!e.A||1!=i){D.u(2);break}return e.i(new Zr("ad-content-pause-requested",(new Map).set("saveLivePosition",!0))),o=new Kr,u=function(t){return U(function(n){if(1==n.g)return"detach"!=t.state?n.u(0):Gg()?w(n,new Promise(function(e){return new _i(e).ha(.1)}),3):n.u(3);o.resolve(),e.l.Ja(e.C,"onstatechange",u),A(n)})},e.l.D(e.C,"onstatechange",u),w(D,o,2);case 2:return Og(e,t),e.A||(e.h.style.display="",t.overlay?(e.h.loop=t.loop,l=t.overlay.viewport,c=t.overlay.topLeft,d=t.overlay.size,e.h.style.height=d.y/l.y*100+"%",e.h.style.left=c.x/l.x*100+"%",e.h.style.top=c.y/l.y*100+"%",e.h.style.width=d.x/l.x*100+"%"):(e.g.pause(),null!=t.resumeOffset&&0!=t.resumeOffset&&(e.g.currentTime+=t.resumeOffset),e.h.loop=!1,e.h.style.height="100%",e.h.style.left="0",e.h.style.top="0",e.h.style.width="100%")),h=!1,f=function(){if(!e.A&&!t.overlay&&null==t.resumeOffset)if(t.timelineRange&&t.endTime&&1/0!=t.endTime)e.g.currentTime!=t.endTime&&(e.g.currentTime=t.endTime);else{var n=Date.now();e.g.currentTime+=(n-r)/1e3,r=n}},p=function(a){var o,u;return U(function(l){if(1==l.g){if(f(),o=Dg(e,t.pre,i-s),a&&t.groupId)for(;o&&o.groupId==t.groupId;)i++,o=Dg(e,t.pre,i-s);return e.o&&(!t.groupId||o&&o.groupId!=t.groupId)&&(e.o.stop(),e.o=null),Ng(e,t),o&&!o.overlay?l.u(2):(t.post&&(e.m=null,e.s=null),e.A?w(l,e.j.detach(),4):w(l,e.j.uc(),4))}2!=l.g&&(e.A&&(u=t.resumeOffset,null==u&&(u=t.timelineRange&&t.endTime&&1/0!=t.endTime?t.endTime-(e.m||0):(Date.now()-r)/1e3),e.i(new Zr("ad-content-resume-requested",(new Map).set("offset",u)))),e.i(new Zr("ad-stopped")),e.l.Qa(),e.K=!1,e.A?Fg(e):(e.h.style.display="none",f(),e.g.ended||e.g.play())),kg(e),o&&(e.i(new Zr("ad-stopped")),e.l.Qa(),Mg(e,o,n,++i,r,s)),A(l)})},g=function(t){return U(function(n){return h?n.return():(h=!0,e.i(new Zr("ad-error",(new Map).set("originalEvent",t))),w(n,p(!1),0))})},m=function(){return U(function(t){if(1==t.g)return h?t.return():(h=!0,w(t,p(!1),2));e.i(new Zr("ad-complete")),A(t)})},e.ia=function(){return U(function(t){return h?t.return():(h=!0,e.i(new Zr("ad-skipped")),w(t,p(!0),0))})},v=new Eg(e.h,t,e.ia,n,i,!e.A),e.A||(v.setMuted(e.g.muted),v.setVolume(e.g.volume)),e.i(new Zr("ad-started",(new Map).set("ad",v))),(y=v.canSkipNow())&&e.i(new Zr("ad-skip-state-changed")),e.l.za(e.j,"error",g),e.l.D(e.h,"timeupdate",function(){if(e.h.duration){var t=v.canSkipNow();y!=t&&0<v.getRemainingTime()&&0<v.getDuration()&&e.i(new Zr("ad-skip-state-changed")),y=t}}),e.l.za(e.j,"firstquartile",function(){f(),e.i(new Zr("ad-first-quartile"))}),e.l.za(e.j,"midpoint",function(){f(),e.i(new Zr("ad-midpoint"))}),e.l.za(e.j,"thirdquartile",function(){f(),e.i(new Zr("ad-third-quartile"))}),e.l.za(e.j,"complete",m),e.l.D(e.h,"play",function(){e.i(new Zr("ad-resumed"))}),e.l.D(e.h,"pause",function(){var t=e.j.getConfiguration();e.h.currentTime>=t.playRangeEnd?m():e.i(new Zr("ad-paused"))}),e.l.D(e.h,"volumechange",function(){e.h.muted?e.i(new Zr("ad-muted")):e.i(new Zr("ad-volume-changed"))}),x(D,4),Bg(e),t.startTime&&t.endTime&&1/0!=t.endTime&&t.startTime!=t.endTime&&(b=t.endTime-t.startTime,0<b&&e.j.configure("playRangeEnd",b)),t.playoutLimit&&!e.o&&(e.o=new _i(function(){e.ia()}).ha(t.playoutLimit),e.j.configure("playRangeEnd",t.playoutLimit)),w(D,e.j.dc(e.h),6);case 6:return T=null,e.M.allowStartInMiddleOfInterstitial&&null!=e.m&&(S=e.m-t.startTime,.25<Math.abs(S)&&(T=S)),e.F.has(t)?w(D,e.F.get(t),10):w(D,e.j.load(t.uri,T,t.mimeType||void 0),8);case 10:return E=D.h,e.F.delete(t),w(D,E?e.j.load(E):e.j.load(t.uri,T,t.mimeType||void 0),8);case 8:e.h.play(),I=(Date.now()-a)/1e3,e.i(new Zr("ads-loaded",(new Map).set("loadTime",I))),e.A&&e.g.play(),t.overlay&&(R=function(){var n=e.g.currentTime-t.startTime;.1<Math.abs(n-e.h.currentTime)&&(e.h.currentTime=n)},e.l.za(e.h,"playing",R),e.l.D(e.g,"seeking",R),e.l.D(e.g,"seeked",function(){var n=e.g.currentTime;(n<t.startTime||t.endTime&&n>t.endTime)&&e.ia()})),k(D,0);break;case 4:if(C=L(D),!e.K)return D.return();g(C),A(D)}})}function Og(e,t){if(t.displayOnBackground&&(e.g.style.zIndex="1"),null!=t.currentVideo){var n=t.currentVideo;e.g.style.transformOrigin="top left";var i=!0,r=[],s=n.topLeft.x/n.viewport.x*100;0<s&&100>=s&&(r.push("translateX("+s+"%)"),i=!1),s=n.topLeft.y/n.viewport.y*100,0<s&&100>=s&&(r.push("translateY("+s+"%)"),i=!1),s=n.size.x/n.viewport.x,1>s&&r.push("scaleX("+s+")"),n=n.size.y/n.viewport.y,1>s&&r.push("scaleY("+n+")"),r.length&&(e.g.style.transform=r.join(" ")),i&&(e.g.style.transition="transform 250ms")}e.B&&(e.B.style.pointerEvents="none",t.background&&(e.B.style.background=t.background)),e.G&&(e.G.style.background=t.overlay?"":"rgb(0, 0, 0)")}function Ng(e,t){t&&!t.displayOnBackground||(e.g.style.zIndex=""),t&&null==t.currentVideo||(e.g.style.transformOrigin="",e.g.style.transition="",e.g.style.transform=""),e.B&&(e.B.style.pointerEvents="",!t||t.background)&&(e.B.style.background=""),e.G&&(e.G.style.background="")}function Ug(e,t){var n,i,r,s,a,o,u,l,c,d,h,f,p,g,m,v,y,b,T,S,E,A,I,R,C,D,M,P,_,O,N,F,B,j,$,G,V,H,K,W,q,Y;return U(function(U){switch(U.g){case 1:if(n=[],!t)return U.return(n);if(i=t.values.find(function(e){return"X-ASSET-URI"==e.key}),r=t.values.find(function(e){return"X-ASSET-LIST"==e.key}),!i&&!r)return U.return(n);if(s=null,(a=t.values.find(function(e){return"ID"==e.key}))&&(s=a.data),o=null==s?Math.floor(10*t.startTime)/10:t.startTime,(u=t.endTime)&&1/0!=t.endTime&&"number"==typeof t.endTime&&(u=null==s?Math.floor(10*t.endTime)/10:t.endTime),l=t.values.find(function(e){return"X-RESTRICT"==e.key}),d=c=!0,l&&l.data&&(h=l.data,c=!h.includes("SKIP"),d=!h.includes("JUMP")),f=c?0:null,(p=t.values.find(function(e){return"X-ENABLE-SKIP-AFTER"==e.key}))&&(g=p.data,f=parseFloat(g),isNaN(f)&&(f=c?0:null)),m=null,(v=t.values.find(function(e){return"X-ENABLE-SKIP-FOR"==e.key}))&&(y=v.data,m=parseFloat(y),isNaN(f)&&(m=null)),b=null,(T=t.values.find(function(e){return"X-RESUME-OFFSET"==e.key}))&&(S=T.data,b=parseFloat(S),isNaN(b)&&(b=null)),E=null,(A=t.values.find(function(e){return"X-PLAYOUT-LIMIT"==e.key}))&&(I=A.data,E=parseFloat(I),isNaN(E)&&(E=null)),D=C=R=!1,(M=t.values.find(function(e){return"CUE"==e.key}))&&(P=M.data,R=P.includes("ONCE"),C=P.includes("PRE"),D=P.includes("POST")),_=!1,(O=t.values.find(function(e){return"X-TIMELINE-OCCUPIES"==e.key}))?(N=O.data,_=N.includes("RANGE")):!T&&e.C.V()&&(_=!C&&!D),i){if(F=i.data,!F)return U.return(n);n.push({id:s,groupId:null,startTime:o,endTime:u,uri:F,mimeType:null,isSkippable:c,skipOffset:f,skipFor:m,canJump:d,resumeOffset:b,playoutLimit:E,once:R,pre:C,post:D,timelineRange:_,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null}),U.u(2);break}if(!r){U.u(2);break}return B=r.data,B?(x(U,4),j={type:11},w(U,jg(e,B,j),6)):U.return(n);case 6:for($=U.h,G=We($),V=JSON.parse(G),(H=V["SKIP-CONTROL"])&&(K=H["ENABLE-SKIP-AFTER"],"number"==typeof K&&(f=parseFloat(K),isNaN(K)&&(f=c?0:null)),W=H["ENABLE-SKIP-FOR"],"number"==typeof W&&(m=parseFloat(W),isNaN(W)&&(m=null))),q=0;q<V.ASSETS.length;q++)Y=V.ASSETS[q],Y.URI&&n.push({id:s+"_shaka_asset_"+q,groupId:s,startTime:o,endTime:u,uri:Y.URI,mimeType:null,isSkippable:c,skipOffset:f,skipFor:m,canJump:d,resumeOffset:b,playoutLimit:E,once:R,pre:C,post:D,timelineRange:_,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null});k(U,2);break;case 4:L(U);case 2:return U.return(n)}})}function Fg(e){for(var t=[],n=d(e.H),i=n.next(),r={};!i.done;r={tc:void 0},i=n.next())i=i.value,i.overlay||(r.tc={start:i.startTime,end:null},i.pre?(r.tc.start=0,r.tc.end=null):i.post?(r.tc.start=-1,r.tc.end=null):i.timelineRange&&(r.tc.end=i.endTime),t.find(function(e){return function(t){return e.tc.start==t.start&&e.tc.end==t.end}}(r))||t.push(r.tc));e.i(new Zr("ad-cue-points-changed",(new Map).set("cuepoints",t)))}function Bg(e){e.j.configure(e.C.Wh()),e.j.configure("ads.disableHLSInterstitial",!0),e.j.configure("ads.disableDASHInterstitial",!0),e.j.configure("playRangeEnd",1/0),os(e.C.Nb(),e.j.Nb())}function jg(e,t,n){var i,r,s;return U(function(a){return 1==a.g?(i=us([t],Hr()),r=e.C.Nb().request(7,i,n),w(a,r.promise,2)):(s=a.h,a.return(s.data))})}function $g(e){return!(e=e.mimeType)||!e.startsWith("image/")&&"text/html"!==e}function Gg(){var e=ce().La();return"TV"==e||"CONSOLE"==e||"CAST"==e}function Vg(e,t){if(!(e.L.has(t)||e.M&&!e.M.allowPreloadOnDomElements)){var n=function(e){var t=document.createElement("link");return t.rel="preload",t.href=e,t.as="image",document.head.appendChild(t),t},i=[];if(t.background){var r=t.background.match(/url\(('|")?([^'"()]+)('|")\)?/);r&&i.push(n(r[2]))}t.mimeType.startsWith("image/")&&i.push(n(t.uri)),e.L.set(t,i)}}function Hg(e,t){if(e.L.has(t)){var n=e.L.get(t);n=d(n);for(var i=n.next();!i.done;i=n.next())i=i.value,i.parentNode.removeChild(i);e.L.delete(t)}}function Kg(e,t,n,i,r){this.h=e,this.j=Kt(this.h.skipOffset),this.g=r,this.i=t,this.l=n,this.o=i,this.m=!1}function Wg(e,t,n,i){this.B=e,this.K=t,this.h=n,this.l=null,this.P=NaN,this.i=i,this.I=!1,this.A=null,this.j=[],this.M=[],this.L=this.C=this.g=null,this.F=new Map,this.m=[],this.s=[],this.G="",this.N=!0,this.H="",this.o=new re}function qg(e,t,n){var i,r,s,a,o,u,l,c,d,h,f,p;U(function(g){if(1==g.g)return i={type:7},r=us([t],Hr()),r.method="POST",n&&(s=JSON.stringify(n),r.body=ze(s)),a=e.K.request(7,r,i),x(g,2),w(g,a.promise,4);if(2!=g.g){if(o=g.h,u=We(o.data),l=JSON.parse(u),!l.manifestUrl||!l.trackingUrl)throw Error("Insufficient data from MediaTailor.");return c=new Te(t),d=new Te(l.trackingUrl),e.G=c.resolve(d).toString(),h=Date.now()/1e3,f=h-e.P,e.i(new Zr("ads-loaded",(new Map).set("loadTime",f))),p=new Te(l.manifestUrl),e.l.resolve(c.resolve(p).toString()),e.l=null,k(g,0)}if(L(g),!e.H.length)return e.l.reject("MediaTailor request returned an error and there was no backup asset uri provided."),e.l=null,g.return();e.l.resolve(e.H),e.l=null,A(g)})}function Yg(e,t,n){var i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b;U(function(T){if(1==T.g)return i={type:8},r=us([t],Hr()),s=e.K.request(7,r,i),x(T,2),w(T,s.promise,4);if(2!=T.g){if(a=T.h,o=[],u=We(a.data),l=JSON.parse(u),0<l.avails.length){if(JSON.stringify(e.j)!=JSON.stringify(l.avails)){for(e.j=l.avails,c=d(e.j),h=c.next();!h.done;h=c.next())for(f=h.value,p=d(f.nonLinearAdsList),g=p.next();!g.done;g=p.next())for(m=g.value,v=d(m.nonLinearAdList),y=v.next();!y.done;y=v.next())b=y.value,zg(e,b);o=e.getCuePoints(),e.i(new Zr("ad-cue-points-changed",(new Map).set("cuepoints",o)))}}else e.j.length&&e.i(new Zr("ad-cue-points-changed",(new Map).set("cuepoints",o))),em(e),e.j=[];return n&&(e.I||0<o.length)&&Qg(e),k(T,0)}L(T),A(T)})}function zg(e,t){var n,i,r,s,a,o,u,l;U(function(c){return 1==c.g?t.staticResource?(n=Xg(t),e.F.get(n)?c.return():(i={type:9},r=us([t.staticResource],Hr()),s=e.K.request(7,r,i),x(c,2),e.F.set(n,[]),w(c,s.promise,4))):c.return():2!=c.g?(a=c.h,o=We(a.data),u=JSON.parse(o),l=u.apps,e.F.set(n,l),k(c,0)):(L(c),e.F.delete(n),void A(c))})}function Xg(e){return[e.adId,e.adParameters,e.adSystem,e.adTitle,e.creativeAdId,e.creativeId,e.creativeSequence,e.height,e.width,e.staticResource].join("")}function Qg(e){Zg(e),e.I||(Jg(e),e.o.D(e.h,"seeked",function(){Jg(e)}),e.o.D(e.h,"ended",function(){em(e)})),e.o.D(e.h,"timeupdate",function(){Zg(e)})}function Jg(e){var t=e.h.currentTime;if(0!=t&&null==e.A){for(var n,i,r=d(e.j),s=r.next();!s.done;s=r.next()){s=s.value;for(var a=d(s.ads),o=a.next();!o.done;o=a.next())if(o=o.value,i){if(o.startTimeInSeconds<t&&o.startTimeInSeconds>i.startTimeInSeconds+i.durationInSeconds){i=o,n=s;break}}else o.startTimeInSeconds<t&&(i=o,n=s)}n&&i&&!e.M.includes(i.adId)&&(e.A=t,e.h.currentTime=n.startTimeInSeconds)}}function Zg(e){if(e.h.duration&&(e.g||e.j.length)){var t=e.h.currentTime,n=!1;if(e.g){n=!0;var i=e.C,r=i.startTimeInSeconds+.5*i.durationInSeconds,s=i.startTimeInSeconds+.75*i.durationInSeconds;t>=i.startTimeInSeconds+.25*i.durationInSeconds&&!e.s.includes("firstQuartile")?(e.s.push("firstQuartile"),nm(e,"firstQuartile")):t>=r&&!e.s.includes("midpoint")?(e.s.push("midpoint"),nm(e,"midpoint")):t>=s&&!e.s.includes("thirdQuartile")&&(e.s.push("thirdQuartile"),nm(e,"thirdQuartile")),i=e.g.getRemainingTime(),r=e.g.getDuration(),e.g.canSkipNow()&&0<i&&0<r&&nm(e,"skipStateChanged"),0<r&&(0>=i||i>r)&&em(e)}if(!e.g||!e.g.isLinear()){e:for(i=d(e.j),r=i.next();!r.done;r=i.next()){if(r=r.value,e.g&&e.g.isLinear())break;for(s=0;s<r.ads.length;s++){var a=r.ads[s],o=a.startTimeInSeconds+a.durationInSeconds;if(a.startTimeInSeconds<=t&&o>t){if(e.M.includes(a.adId)){if(e.h.ended)continue;e.h.currentTime=o;break e}em(e),e.L=r,e.g=new Kg(a,s+1,r.ads.length,!0,e.h),e.C=a,0===s&&nm(e,"breakStart"),tm(e);break}}}if(!e.g)for(i=d(e.j),r=i.next();!r.done;r=i.next()){if(r=r.value,e.g)break;for(s=0;s<r.nonLinearAdsList.length;s++)if(a=r.nonLinearAdsList[s],a.nonLinearAdList.length){o=r.startTimeInSeconds;var u=e.F.get(Xg(a.nonLinearAdList[0]));if(o<=t&&u&&u.length){em(e),o=e,u=d(u);for(var l=u.next();!l.done;l=u.next())if(l=l.value,l.data.source.length){var c=document.createElement("img");c.src=l.data.source[0].url,c.style.top=(l.placeholder.top||0)+"%",c.style.height=100-(l.placeholder.top||0)+"%",c.style.left=(l.placeholder.left||0)+"%",c.style.maxWidth=100-(l.placeholder.left||0)+"%",c.style.objectFit="contain",c.style.position="absolute",o.B.appendChild(c)}e.L=r,e.g=new Kg(a,s+1,r.ads.length,!1,e.h),e.C=a,0===s&&nm(e,"breakStart"),tm(e);break}}}n&&!e.g&&(t=e.h.currentTime,e.A&&e.A>t&&(e.h.currentTime=e.A),e.A=null)}}}function em(e){if(e.g){for(;e.B.lastChild;)e.B.removeChild(e.B.firstChild);e.I||e.M.push(e.C.adId);var t=e.g.m;nm(e,void 0!==t&&t?"skip":"complete"),t=d(e.m);for(var n=t.next();!n.done;n=t.next())n=n.value,e.o.Ja(n.target,n.type,n.listener);e.m=[],e.s=[],t=e.g.getPositionInSequence(),n=e.g.getSequenceLength(),t===n&&nm(e,"breakEnd"),e.g=null,e.C=null,e.L=null}}function tm(e){var t=!1;e.h.paused?t=!0:(nm(e,"impression"),nm(e,"start")),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted&&nm(e,"mute")}}),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted||nm(e,"unmute")}}),e.m.push({target:e.h,type:"play",listener:function(){t?(nm(e,"impression"),nm(e,"start"),t=!1):nm(e,"resume")}}),e.m.push({target:e.h,type:"pause",listener:function(){nm(e,"pause")}});for(var n=d(e.m),i=n.next();!i.done;i=n.next())i=i.value,e.o.D(i.target,i.type,i.listener)}function nm(e,t){var n=e.C.trackingEvents.find(function(e){return e.eventType==t});if(n||(n=e.L.adBreakTrackingEvents.find(function(e){return e.eventType==t})),n){var i={type:10};n=d(n.beaconUrls);for(var r=n.next();!r.done;r=n.next())(r=r.value)&&""!=r&&(r=us([r],Hr()),r.method="POST",e.K.request(7,r,i))}switch(t){case"impression":e.i(new Zr("ad-impression"));break;case"start":e.i(new Zr("ad-started",(new Map).set("ad",e.g)));break;case"mute":e.i(new Zr("ad-muted"));break;case"unmute":e.i(new Zr("ad-volume-changed"));break;case"resume":e.i(new Zr("ad-resumed"));break;case"pause":e.i(new Zr("ad-paused"));break;case"firstQuartile":e.i(new Zr("ad-first-quartile"));break;case"midpoint":e.i(new Zr("ad-midpoint"));break;case"thirdQuartile":e.i(new Zr("ad-third-quartile"));break;case"complete":e.i(new Zr("ad-complete")),e.i(new Zr("ad-stopped"));break;case"skip":e.i(new Zr("ad-skipped")),e.i(new Zr("ad-stopped"));break;case"breakStart":e.B.setAttribute("ad-active","true");break;case"breakEnd":e.B.removeAttribute("ad-active");break;case"skipStateChanged":e.i(new Zr("ad-skip-state-changed"))}}function im(e,t){this.g=e,this.i=null,this.h=t}function rm(e,t,n,i){var r=this;this.s=e,this.l=t,this.j=null,this.F=NaN,this.i=i,this.G=!1,this.A=this.m=this.o=null,this.B="",this.C=[],this.h=new re,e=new google.ima.dai.api.UiSettings,e.setLocale(n),this.g=new google.ima.dai.api.StreamManager(this.l,this.s,e),this.i(new Zr("ima-stream-manager-loaded",(new Map).set("imaStreamManager",this.g))),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.LOADED,function(e){sm(r,e)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.ERROR,function(){r.B.length?r.j.resolve(r.B):r.j.reject("IMA Stream request returned an error and there was no backup asset uri provided."),r.j=null}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,function(){}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.STARTED,function(e){e=e.getAd(),r.m=new im(e,r.l),r.A&&(r.m.i=r.A),r.i(new Zr("ad-started",(new Map).set("ad",r.m))),r.s.setAttribute("ad-active","true")}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,function(){r.s.removeAttribute("ad-active");var e=r.l.currentTime;r.o&&r.o>e&&(r.l.currentTime=r.o,r.o=null)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,function(e){r.A=e.getStreamData().adProgressData,r.m&&(r.m.i=r.A)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,function(){r.i(new Zr("ad-first-quartile"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.MIDPOINT,function(){r.i(new Zr("ad-midpoint"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,function(){r.i(new Zr("ad-third-quartile"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.COMPLETE,function(){r.i(new Zr("ad-complete")),r.i(new Zr("ad-stopped")),r.s.removeAttribute("ad-active"),r.m=null}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.SKIPPED,function(){r.i(new Zr("ad-skipped")),r.i(new Zr("ad-stopped"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,function(e){var t=e.getStreamData();e=[],t=d(t.cuepoints);for(var n=t.next();!n.done;n=t.next())n=n.value,e.push({start:n.start,end:n.end});r.C=e,r.i(new Zr("ad-cue-points-changed",(new Map).set("cuepoints",e)))})}function sm(e,t){e.i(new Zr("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-e.F))),t=t.getStreamData().url,e.j.resolve(t),e.j=null,e.G||e.h.D(e.l,"seeked",function(){var t=e.l.currentTime;if(0!=t){e.g.streamTimeForContentTime(t);var n=e.g.previousCuePointForStreamTime(t);n&&!n.played&&(e.o=t,e.l.currentTime=n.start)}})}function am(){ns.call(this),this.h=this.i=this.j=this.g=null,this.m=new cg,this.o=navigator.language,this.l=null}function om(e,t){if(t&&t.type)switch(t.type){case"ads-loaded":e.m.g.push(t.loadTime);break;case"ad-started":e.m.h++;var n=t.ad;n&&!n.isLinear()&&e.m.j++;break;case"ad-complete":e.m.l++;break;case"ad-skipped":e.m.m++;break;case"ad-error":e.m.i++}e.dispatchEvent(t)}function um(e){return JSON.stringify(e,function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Zr){var n={};for(i in t)(e=t[i])&&"object"==typeof e?"detail"==i&&(n[i]=e):i in Event||(n[i]=e);return n}if(t instanceof Error){var i=new Set(["name","message","stack"]);for(n in t)i.add(n);for(n=d(Object.getOwnPropertyNames(t)),e=n.next();!e.done;e=n.next())i.add(e.value);for(n={},i=d(i),e=i.next();!e.done;e=i.next())e=e.value,n[e]=t[e];t={__type__:"Error",contents:n}}else if(t instanceof TimeRanges){for(i={__type__:"TimeRanges",length:t.length,start:[],end:[]},t=d(Ko(t)),n=t.next();!n.done;n=t.next())n=n.value,e=n.end,i.start.push(n.start),i.end.push(e);t=i}else t=ArrayBuffer.isView(t)&&1===t.BYTES_PER_ELEMENT?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t;return t}})}function lm(e){return JSON.parse(e,function(e,t){if("NaN"==t)var n=NaN;else if("-Infinity"==t)n=-1/0;else if("Infinity"==t)n=1/0;else if(t&&"object"==typeof t&&"TimeRanges"==t.__type__)n=cm(t);else if(t&&"object"==typeof t&&"Uint8Array"==t.__type__)n=new Uint8Array(t.entries);else if(t&&"object"==typeof t&&"Error"==t.__type__){for(n in e=t.contents,t=Error(e.message),e)t[n]=e[n];n=t}else n=t;return n})}function cm(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}i=hg.prototype,i.needsSkipUI=function(){return!1},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return!0},i.isUsingAnotherMediaElement=function(){return!0},i.getDuration=function(){return this.g.getDuration()},i.getMinSuggestedDuration=function(){return this.g.getMinSuggestedDuration()},i.getRemainingTime=function(){return this.h.getRemainingTime()},i.isPaused=function(){return this.i},i.isSkippable=function(){return 0<=this.g.getSkipTimeOffset()},i.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},i.canSkipNow=function(){return this.h.getAdSkippableState()},i.skip=function(){return this.h.skip()},i.pause=function(){return this.h.pause()},i.play=function(){return this.h.resume()},i.getVolume=function(){return this.h.getVolume()},i.setVolume=function(e){return this.m.volume=e,this.h.setVolume(e)},i.isMuted=function(){return 0==this.h.getVolume()},i.isLinear=function(){return this.g.isLinear()},i.resize=function(e,t){this.h.resize(e,t)},i.setMuted=function(e){(this.m.muted=e)?(this.j=this.getVolume(),this.h.setVolume(0)):this.h.setVolume(this.j)},i.getSequenceLength=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getTotalAds()},i.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getAdPosition()},i.getTitle=function(){return this.g.getTitle()},i.getDescription=function(){return this.g.getDescription()},i.getVastMediaBitrate=function(){return this.g.getVastMediaBitrate()},i.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},i.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},i.getVastAdId=function(){return""},i.getAdId=function(){return this.g.getAdId()},i.getCreativeAdId=function(){return this.g.getCreativeAdId()},i.getAdvertiserName=function(){return this.g.getAdvertiserName()},i.getMediaUrl=function(){return this.g.getMediaUrl()},i.getTimeOffset=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getTimeOffset()},i.getPodIndex=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getPodIndex()},i.release=function(){this.h=this.g=null},K("shaka.ads.ClientSideAd",hg),hg.prototype.release=hg.prototype.release,hg.prototype.getPodIndex=hg.prototype.getPodIndex,hg.prototype.getTimeOffset=hg.prototype.getTimeOffset,hg.prototype.getMediaUrl=hg.prototype.getMediaUrl,hg.prototype.getAdvertiserName=hg.prototype.getAdvertiserName,hg.prototype.getCreativeAdId=hg.prototype.getCreativeAdId,hg.prototype.getAdId=hg.prototype.getAdId,hg.prototype.getVastAdId=hg.prototype.getVastAdId,hg.prototype.getVastMediaWidth=hg.prototype.getVastMediaWidth,hg.prototype.getVastMediaHeight=hg.prototype.getVastMediaHeight,hg.prototype.getVastMediaBitrate=hg.prototype.getVastMediaBitrate,hg.prototype.getDescription=hg.prototype.getDescription,hg.prototype.getTitle=hg.prototype.getTitle,hg.prototype.getPositionInSequence=hg.prototype.getPositionInSequence,hg.prototype.getSequenceLength=hg.prototype.getSequenceLength,hg.prototype.setMuted=hg.prototype.setMuted,hg.prototype.resize=hg.prototype.resize,hg.prototype.isLinear=hg.prototype.isLinear,hg.prototype.isMuted=hg.prototype.isMuted,hg.prototype.setVolume=hg.prototype.setVolume,hg.prototype.getVolume=hg.prototype.getVolume,hg.prototype.play=hg.prototype.play,hg.prototype.pause=hg.prototype.pause,hg.prototype.skip=hg.prototype.skip,hg.prototype.canSkipNow=hg.prototype.canSkipNow,hg.prototype.getTimeUntilSkippable=hg.prototype.getTimeUntilSkippable,hg.prototype.isSkippable=hg.prototype.isSkippable,hg.prototype.isPaused=hg.prototype.isPaused,hg.prototype.getRemainingTime=hg.prototype.getRemainingTime,hg.prototype.getMinSuggestedDuration=hg.prototype.getMinSuggestedDuration,hg.prototype.getDuration=hg.prototype.getDuration,hg.prototype.isUsingAnotherMediaElement=hg.prototype.isUsingAnotherMediaElement,hg.prototype.hasCustomClick=hg.prototype.hasCustomClick,hg.prototype.isClientRendering=hg.prototype.isClientRendering,hg.prototype.needsSkipUI=hg.prototype.needsSkipUI,K("shaka.ads.Utils",fg),fg.ADS_LOADED="ads-loaded",fg.AD_STARTED="ad-started",fg.AD_FIRST_QUARTILE="ad-first-quartile",fg.AD_MIDPOINT="ad-midpoint",fg.AD_THIRD_QUARTILE="ad-third-quartile",fg.AD_COMPLETE="ad-complete",fg.AD_STOPPED="ad-stopped",fg.AD_SKIPPED="ad-skipped",fg.AD_VOLUME_CHANGED="ad-volume-changed",fg.AD_MUTED="ad-muted",fg.AD_PAUSED="ad-paused",fg.AD_RESUMED="ad-resumed",fg.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",fg.CUEPOINTS_CHANGED="ad-cue-points-changed",fg.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",fg.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",fg.AD_CLICKED="ad-clicked",fg.AD_PROGRESS="ad-progress",fg.AD_BUFFERING="ad-buffering",fg.AD_IMPRESSION="ad-impression",fg.AD_DURATION_CHANGED="ad-duration-changed",fg.AD_CLOSED="ad-closed",fg.AD_LOADED="ad-loaded",fg.ALL_ADS_COMPLETED="all-ads-completed",fg.AD_LINEAR_CHANGED="ad-linear-changed",fg.AD_METADATA="ad-metadata",fg.AD_RECOVERABLE_ERROR="ad-recoverable-error",fg.AD_ERROR="ad-error",fg.AD_BREAK_READY="ad-break-ready",fg.AD_INTERACTION="ad-interaction",fg.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",fg.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",fg.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",mg.prototype.configure=function(e){this.o=e},mg.prototype.stop=function(){this.g&&this.g.stop(),this.s&&zo(this.s)},mg.prototype.release=function(){this.stop(),this.A&&this.A.disconnect(),this.h&&this.h.release(),this.g&&this.g.destroy(),this.m.destroy(),this.C.destroy()},i=Eg.prototype,i.needsSkipUI=function(){return!0},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return!1},i.isUsingAnotherMediaElement=function(){return this.s},i.getDuration=function(){var e=this.g.duration;return isNaN(e)?-1:e},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){var e=this.g.duration;return isNaN(e)?-1:e-this.g.currentTime},i.isPaused=function(){return this.g.paused},i.isSkippable=function(){return this.h&&null!=this.l?this.getDuration()-this.getRemainingTime()<this.j+this.l:this.h},i.getTimeUntilSkippable=function(){if(this.isSkippable()){var e=this.getRemainingTime()+this.j-this.getDuration();return Math.max(e,0)}return Math.max(this.getRemainingTime(),0)},i.canSkipNow=function(){return this.h&&0==this.getTimeUntilSkippable()},i.skip=function(){this.canSkipNow()&&this.A()},i.pause=function(){return this.g.pause()},i.play=function(){return this.g.play()},i.getVolume=function(){return this.g.volume},i.setVolume=function(e){this.g.volume=e},i.isMuted=function(){return this.g.muted},i.isLinear=function(){return null==this.B},i.resize=function(){},i.setMuted=function(e){this.g.muted=e},i.getSequenceLength=function(){return this.o},i.getPositionInSequence=function(){return this.m},i.getTitle=function(){return""},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getVastAdId=function(){return""},i.getAdId=function(){return this.i.id||""},i.getCreativeAdId=function(){return""},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return this.i.uri},i.getTimeOffset=function(){return 0},i.getPodIndex=function(){return 0},i.release=function(){this.g=null},K("shaka.ads.InterstitialAd",Eg),Eg.prototype.release=Eg.prototype.release,Eg.prototype.getPodIndex=Eg.prototype.getPodIndex,Eg.prototype.getTimeOffset=Eg.prototype.getTimeOffset,Eg.prototype.getMediaUrl=Eg.prototype.getMediaUrl,Eg.prototype.getAdvertiserName=Eg.prototype.getAdvertiserName,Eg.prototype.getCreativeAdId=Eg.prototype.getCreativeAdId,Eg.prototype.getAdId=Eg.prototype.getAdId,Eg.prototype.getVastAdId=Eg.prototype.getVastAdId,Eg.prototype.getVastMediaWidth=Eg.prototype.getVastMediaWidth,Eg.prototype.getVastMediaHeight=Eg.prototype.getVastMediaHeight,Eg.prototype.getVastMediaBitrate=Eg.prototype.getVastMediaBitrate,Eg.prototype.getDescription=Eg.prototype.getDescription,Eg.prototype.getTitle=Eg.prototype.getTitle,Eg.prototype.getPositionInSequence=Eg.prototype.getPositionInSequence,Eg.prototype.getSequenceLength=Eg.prototype.getSequenceLength,Eg.prototype.setMuted=Eg.prototype.setMuted,Eg.prototype.resize=Eg.prototype.resize,Eg.prototype.isLinear=Eg.prototype.isLinear,Eg.prototype.isMuted=Eg.prototype.isMuted,Eg.prototype.setVolume=Eg.prototype.setVolume,Eg.prototype.getVolume=Eg.prototype.getVolume,Eg.prototype.play=Eg.prototype.play,Eg.prototype.pause=Eg.prototype.pause,Eg.prototype.skip=Eg.prototype.skip,Eg.prototype.canSkipNow=Eg.prototype.canSkipNow,Eg.prototype.getTimeUntilSkippable=Eg.prototype.getTimeUntilSkippable,Eg.prototype.isSkippable=Eg.prototype.isSkippable,Eg.prototype.isPaused=Eg.prototype.isPaused,Eg.prototype.getRemainingTime=Eg.prototype.getRemainingTime,Eg.prototype.getMinSuggestedDuration=Eg.prototype.getMinSuggestedDuration,Eg.prototype.getDuration=Eg.prototype.getDuration,Eg.prototype.isUsingAnotherMediaElement=Eg.prototype.isUsingAnotherMediaElement,Eg.prototype.hasCustomClick=Eg.prototype.hasCustomClick,Eg.prototype.isClientRendering=Eg.prototype.isClientRendering,Eg.prototype.needsSkipUI=Eg.prototype.needsSkipUI,i=wg.prototype,i.needsSkipUI=function(){return!0},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return!1},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return-1},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return-1},i.isPaused=function(){return!1},i.isSkippable=function(){return!1},i.getTimeUntilSkippable=function(){return 0},i.canSkipNow=function(){return!1},i.skip=function(){},i.pause=function(){},i.play=function(){},i.getVolume=function(){return 1},i.setVolume=function(){},i.isMuted=function(){return!1},i.isLinear=function(){return this.i},i.resize=function(){},i.setMuted=function(){},i.getSequenceLength=function(){return this.j},i.getPositionInSequence=function(){return this.h},i.getTitle=function(){return""},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getVastAdId=function(){return""},i.getAdId=function(){return this.g.id||""},i.getCreativeAdId=function(){return""},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return this.g.uri},i.getTimeOffset=function(){return 0},i.getPodIndex=function(){return 0},i.release=function(){},K("shaka.ads.InterstitialStaticAd",wg),wg.prototype.release=wg.prototype.release,wg.prototype.getPodIndex=wg.prototype.getPodIndex,wg.prototype.getTimeOffset=wg.prototype.getTimeOffset,wg.prototype.getMediaUrl=wg.prototype.getMediaUrl,wg.prototype.getAdvertiserName=wg.prototype.getAdvertiserName,wg.prototype.getCreativeAdId=wg.prototype.getCreativeAdId,wg.prototype.getAdId=wg.prototype.getAdId,wg.prototype.getVastAdId=wg.prototype.getVastAdId,wg.prototype.getVastMediaWidth=wg.prototype.getVastMediaWidth,wg.prototype.getVastMediaHeight=wg.prototype.getVastMediaHeight,wg.prototype.getVastMediaBitrate=wg.prototype.getVastMediaBitrate,wg.prototype.getDescription=wg.prototype.getDescription,wg.prototype.getTitle=wg.prototype.getTitle,wg.prototype.getPositionInSequence=wg.prototype.getPositionInSequence,wg.prototype.getSequenceLength=wg.prototype.getSequenceLength,wg.prototype.setMuted=wg.prototype.setMuted,wg.prototype.resize=wg.prototype.resize,wg.prototype.isLinear=wg.prototype.isLinear,wg.prototype.isMuted=wg.prototype.isMuted,wg.prototype.setVolume=wg.prototype.setVolume,wg.prototype.getVolume=wg.prototype.getVolume,wg.prototype.play=wg.prototype.play,wg.prototype.pause=wg.prototype.pause,wg.prototype.skip=wg.prototype.skip,wg.prototype.canSkipNow=wg.prototype.canSkipNow,wg.prototype.getTimeUntilSkippable=wg.prototype.getTimeUntilSkippable,wg.prototype.isSkippable=wg.prototype.isSkippable,wg.prototype.isPaused=wg.prototype.isPaused,wg.prototype.getRemainingTime=wg.prototype.getRemainingTime,wg.prototype.getMinSuggestedDuration=wg.prototype.getMinSuggestedDuration,wg.prototype.getDuration=wg.prototype.getDuration,wg.prototype.isUsingAnotherMediaElement=wg.prototype.isUsingAnotherMediaElement,wg.prototype.hasCustomClick=wg.prototype.hasCustomClick,wg.prototype.isClientRendering=wg.prototype.isClientRendering,wg.prototype.needsSkipUI=wg.prototype.needsSkipUI,i=Ag.prototype,i.configure=function(e){this.M=e,kg(this)},i.stop=function(){if(this.l&&this.l.Qa(),this.U.clear(),this.H.clear(),this.j.ig(),this.F.size){var e=Array.from(this.F.values());e=d(e);for(var t=e.next();!t.done;t=e.next())(t=t.value)&&t.then(function(e){e&&e.destroy()})}if(this.F.clear(),this.L.size)for(e=Array.from(this.L.keys()),e=d(e),t=e.next();!t.done;t=e.next())Hg(this,t.value);this.L.clear(),this.j.detach(),this.K=!1,this.s=this.m=null,this.A=!0,this.h=this.g,this.G=null,Ng(this),Ig(this),this.B&&zo(this.B),this.o&&(this.o.stop(),this.o=null)},i.release=function(){this.stop(),this.I&&this.I.release(),this.l&&this.l.release(),this.S&&(this.S.stop(),this.S=null),this.N&&(this.N.stop(),this.N=null),this.j.destroy()},i.ld=function(){return this.j},i.addAdUrlInterstitial=function(e){var t,n,i,r,s,a,o,u,l,c=this;return U(function(f){switch(f.g){case 1:return t={type:12},w(f,jg(c,e,t),2);case 2:if(n=f.h,i=Xt(n,"VAST,vmap:VMAP"),!i)throw new Ve(2,10,10007);if(r=[],"VAST"==i.tagName){r=pg(i,c.m),f.u(3);break}if("vmap:VMAP"!=i.tagName){f.u(3);break}for(var p=[],g=d(nn(i,"vmap:AdBreak")),m=g.next();!m.done;m=g.next()){var v=m.value,y=v.attributes.timeOffset;y&&(m=null,m="start"==y?0:"end"==y?1/0:Kt(y),(v=on(v,"vmap:AdSource"))&&(v=on(v,"vmap:AdTagURI"))&&(v=rn(v))&&p.push({time:m,uri:v}))}s=d(p),a=s.next();case 5:if(a.done){f.u(3);break}return o=a.value,w(f,jg(c,o.uri,t),8);case 8:if(u=f.h,l=Xt(u,"VAST"),!l)throw new Ve(2,10,10007);r.push.apply(r,h(pg(l,o.time))),a=s.next(),f.u(5);break;case 3:Cg(c,r),A(f)}})},i=Kg.prototype,i.needsSkipUI=function(){return!0},i.isClientRendering=function(){return!1},i.hasCustomClick=function(){return!1},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return this.h.durationInSeconds},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return this.h.startTimeInSeconds+this.h.durationInSeconds-this.g.currentTime},i.isPaused=function(){return this.g.paused},i.isSkippable=function(){return"number"==typeof this.j},i.getTimeUntilSkippable=function(){if("number"!=typeof this.j)return this.getRemainingTime();var e=this.getRemainingTime()+this.j-this.getDuration();return Math.max(e,0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.m=!0,this.g.currentTime+=this.getRemainingTime()},i.pause=function(){return this.g.pause()},i.play=function(){return this.g.play()},i.getVolume=function(){return this.g.volume},i.setVolume=function(e){this.g.volume=e},i.isMuted=function(){return this.g.muted},i.isLinear=function(){return this.o},i.resize=function(){},i.setMuted=function(e){this.g.muted=e},i.getSequenceLength=function(){return this.l?this.l:1},i.getPositionInSequence=function(){return this.i?this.i:1},i.getTitle=function(){return this.h.adTitle},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getVastAdId=function(){return this.h.vastAdId||""},i.getAdId=function(){return this.h.adId},i.getCreativeAdId=function(){return this.h.creativeId},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){return 0},i.getPodIndex=function(){return 0},i.release=function(){this.l=this.i=this.g=this.h=null},K("shaka.ads.MediaTailorAd",Kg),Kg.prototype.release=Kg.prototype.release,Kg.prototype.getPodIndex=Kg.prototype.getPodIndex,Kg.prototype.getTimeOffset=Kg.prototype.getTimeOffset,Kg.prototype.getMediaUrl=Kg.prototype.getMediaUrl,Kg.prototype.getAdvertiserName=Kg.prototype.getAdvertiserName,Kg.prototype.getCreativeAdId=Kg.prototype.getCreativeAdId,Kg.prototype.getAdId=Kg.prototype.getAdId,Kg.prototype.getVastAdId=Kg.prototype.getVastAdId,Kg.prototype.getVastMediaWidth=Kg.prototype.getVastMediaWidth,Kg.prototype.getVastMediaHeight=Kg.prototype.getVastMediaHeight,Kg.prototype.getVastMediaBitrate=Kg.prototype.getVastMediaBitrate,Kg.prototype.getDescription=Kg.prototype.getDescription,Kg.prototype.getTitle=Kg.prototype.getTitle,Kg.prototype.getPositionInSequence=Kg.prototype.getPositionInSequence,Kg.prototype.getSequenceLength=Kg.prototype.getSequenceLength,Kg.prototype.setMuted=Kg.prototype.setMuted,Kg.prototype.resize=Kg.prototype.resize,Kg.prototype.isLinear=Kg.prototype.isLinear,Kg.prototype.isMuted=Kg.prototype.isMuted,Kg.prototype.setVolume=Kg.prototype.setVolume,Kg.prototype.getVolume=Kg.prototype.getVolume,Kg.prototype.play=Kg.prototype.play,Kg.prototype.pause=Kg.prototype.pause,Kg.prototype.skip=Kg.prototype.skip,Kg.prototype.canSkipNow=Kg.prototype.canSkipNow,Kg.prototype.getTimeUntilSkippable=Kg.prototype.getTimeUntilSkippable,Kg.prototype.isSkippable=Kg.prototype.isSkippable,Kg.prototype.isPaused=Kg.prototype.isPaused,Kg.prototype.getRemainingTime=Kg.prototype.getRemainingTime,Kg.prototype.getMinSuggestedDuration=Kg.prototype.getMinSuggestedDuration,Kg.prototype.getDuration=Kg.prototype.getDuration,Kg.prototype.isUsingAnotherMediaElement=Kg.prototype.isUsingAnotherMediaElement,Kg.prototype.hasCustomClick=Kg.prototype.hasCustomClick,Kg.prototype.isClientRendering=Kg.prototype.isClientRendering,Kg.prototype.needsSkipUI=Kg.prototype.needsSkipUI,Wg.prototype.stop=function(){for(var e=d(this.m),t=e.next();!t.done;t=e.next())t=t.value,this.o.Ja(t.target,t.type,t.listener);em(this),this.m=[],this.s=[],this.G="",this.N=!0,this.H="",this.A=null,this.j=[],this.M=[],this.F.clear()},Wg.prototype.release=function(){this.stop(),this.o&&this.o.release()},Wg.prototype.onManifestUpdated=function(e){this.I=e,""!=this.G&&(Yg(this,this.G,this.N),this.N=!1)},Wg.prototype.getCuePoints=function(){for(var e=[],t=d(this.j),n=t.next();!n.done;n=t.next()){n=d(n.value.ads);for(var i=n.next();!i.done;i=n.next())i=i.value,e.push({start:i.startTimeInSeconds,end:i.startTimeInSeconds+i.durationInSeconds})}return e},i=im.prototype,i.needsSkipUI=function(){return!0},i.isClientRendering=function(){return!1},i.hasCustomClick=function(){return!0},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return this.i?this.i.duration:-1},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return this.i?this.i.duration-this.i.currentTime:-1},i.isPaused=function(){return this.h.paused},i.isSkippable=function(){return this.g.isSkippable()},i.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.h.currentTime+=this.getRemainingTime()},i.pause=function(){return this.h.pause()},i.play=function(){return this.h.play()},i.getVolume=function(){return this.h.volume},i.setVolume=function(e){this.h.volume=e},i.isMuted=function(){return this.h.muted},i.isLinear=function(){return!0},i.resize=function(){},i.setMuted=function(e){this.h.muted=e},i.getSequenceLength=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getTotalAds()},i.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getAdPosition()},i.getTitle=function(){return this.g.getTitle()},i.getDescription=function(){return this.g.getDescription()},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},i.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},i.getVastAdId=function(){return""},i.getAdId=function(){return this.g.getAdId()},i.getCreativeAdId=function(){return this.g.getCreativeAdId()},i.getAdvertiserName=function(){return this.g.getAdvertiserName()},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getTimeOffset()},i.getPodIndex=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getPodIndex()},i.release=function(){this.h=this.i=this.g=null},K("shaka.ads.ServerSideAd",im),im.prototype.release=im.prototype.release,im.prototype.getPodIndex=im.prototype.getPodIndex,im.prototype.getTimeOffset=im.prototype.getTimeOffset,im.prototype.getMediaUrl=im.prototype.getMediaUrl,im.prototype.getAdvertiserName=im.prototype.getAdvertiserName,im.prototype.getCreativeAdId=im.prototype.getCreativeAdId,im.prototype.getAdId=im.prototype.getAdId,im.prototype.getVastAdId=im.prototype.getVastAdId,im.prototype.getVastMediaWidth=im.prototype.getVastMediaWidth,im.prototype.getVastMediaHeight=im.prototype.getVastMediaHeight,im.prototype.getVastMediaBitrate=im.prototype.getVastMediaBitrate,im.prototype.getDescription=im.prototype.getDescription,im.prototype.getTitle=im.prototype.getTitle,im.prototype.getPositionInSequence=im.prototype.getPositionInSequence,im.prototype.getSequenceLength=im.prototype.getSequenceLength,im.prototype.setMuted=im.prototype.setMuted,im.prototype.resize=im.prototype.resize,im.prototype.isLinear=im.prototype.isLinear,im.prototype.isMuted=im.prototype.isMuted,im.prototype.setVolume=im.prototype.setVolume,im.prototype.getVolume=im.prototype.getVolume,im.prototype.play=im.prototype.play,im.prototype.pause=im.prototype.pause,im.prototype.skip=im.prototype.skip,im.prototype.canSkipNow=im.prototype.canSkipNow,im.prototype.getTimeUntilSkippable=im.prototype.getTimeUntilSkippable,im.prototype.isSkippable=im.prototype.isSkippable,im.prototype.isPaused=im.prototype.isPaused,im.prototype.getRemainingTime=im.prototype.getRemainingTime,im.prototype.getMinSuggestedDuration=im.prototype.getMinSuggestedDuration,im.prototype.getDuration=im.prototype.getDuration,im.prototype.isUsingAnotherMediaElement=im.prototype.isUsingAnotherMediaElement,im.prototype.hasCustomClick=im.prototype.hasCustomClick,im.prototype.isClientRendering=im.prototype.isClientRendering,im.prototype.needsSkipUI=im.prototype.needsSkipUI,i=rm.prototype,i.configure=function(){},i.stop=function(){this.B="",this.o=null,this.C=[]},i.release=function(){this.stop(),this.h&&this.h.release()},i.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.g.onTimedMetadata(t)}},i.getCuePoints=function(){return this.C},b(am,ns),i=am.prototype,i.setLocale=function(e){this.o=e},i.configure=function(e){this.l=e,this.g&&this.g.configure(this.l),this.j&&this.j.configure(this.l),this.h&&this.h.configure(this.l)},i.initInterstitial=function(e,t,n){var i=this;this.g&&this.g.release(),this.g=new Ag(e,t,n,function(e){return om(i,e)}),this.g.configure(this.l)},i.initClientSide=function(t,n,i){var r=this;if(!e.google||!google.ima||!google.ima.AdsLoader)throw new Ve(2,10,1e4);this.j&&this.j.release(),this.j=new mg(t,n,this.o,i,function(e){return om(r,e)}),this.j.configure(this.l)},i.release=function(){this.g&&(this.g.release(),this.g=null),this.j&&(this.j.release(),this.j=null),this.i&&(this.i.release(),this.i=null),this.h&&(this.h.release(),this.h=null),ns.prototype.release.call(this)},i.onAssetUnload=function(){this.g&&this.g.stop(),this.j&&this.j.stop(),this.i&&this.i.stop(),this.h&&this.h.stop(),this.dispatchEvent(new Zr("ad-stopped")),this.dispatchEvent(new Zr("ad-content-attach-requested")),this.m=new cg},i.requestClientSideAds=function(e){if(!this.j)throw new Ve(1,10,10001);var t=this.j;t.g&&t.g.destroy(),t.m&&t.m.contentComplete(),t.G=Date.now()/1e3,t.m.requestAds(e)},i.updateClientSideAdsRenderingSettings=function(e){if(!this.j)throw new Ve(1,10,10001);var t=this.j;t.B=e,t.g&&t.g.updateAdsRenderingSettings(t.B)},i.initMediaTailor=function(e,t,n){var i=this;this.i&&this.i.release(),this.i=new Wg(e,t,n,function(e){return om(i,e)})},i.requestMediaTailorStream=function(e,t,n){if(!this.i)throw new Ve(1,10,10005);var i=this.i;return n=void 0===n?"":n,i.l?e=Promise.reject(new Ve(1,10,10004)):(i.l=new Kr,qg(i,e,t),i.H=n||"",i.P=Date.now()/1e3,e=i.l),e},i.addMediaTailorTrackingUrl=function(e){if(!this.i)throw new Ve(1,10,10005);var t=this.i;t.G=e,t.i(new Zr("ads-loaded",(new Map).set("loadTime",0)))},i.initServerSide=function(t,n){var i=this;if(!e.google||!google.ima||!google.ima.dai)throw new Ve(2,10,10002);this.h&&this.h.release(),this.h=new rm(t,n,this.o,function(e){return om(i,e)}),this.h.configure(this.l)},i.requestServerSideStream=function(e,t){if(t=void 0===t?"":t,!this.h)throw new Ve(1,10,10003);e.adTagParameters||(e.adTagParameters={});var n=e.adTagParameters;return(n.mpt||n.mpv)&&Q('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv="v4.15.3",n=this.h,n.j?e=Promise.reject(new Ve(1,10,10004)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(n.G=!0),n.j=new Kr,n.g.requestStream(e),n.B=t||"",n.F=Date.now()/1e3,e=n.j),e},i.replaceServerSideAdTagParameters=function(e){if(!this.h)throw new Ve(1,10,10003);(e.mpt||e.mpv)&&Q('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.'),e.mpt="Shaka Player",e.mpv="v4.15.3",this.h.g.replaceAdTagParameters(e)},i.getServerSideCuePoints=function(){return ge("AdManager.getServerSideCuePoints","Please use getCuePoints function."),this.getCuePoints()},i.getCuePoints=function(){var e=[];return this.h&&(e=e.concat(this.h.getCuePoints())),this.i&&(e=e.concat(this.i.getCuePoints())),e},i.getStats=function(){var e=this.m;return{loadTimes:e.g,averageLoadTime:dg(e),started:e.h,overlayAds:e.j,playedCompletely:e.l,skipped:e.m,errors:e.i}},i.onManifestUpdated=function(e){this.i&&this.i.onManifestUpdated(e)},i.onDashTimedMetadata=function(e){this.h&&"urn:google:dai:2018"==e.schemeIdUri&&this.h.g.processMetadata(e.schemeIdUri,e.eventNode?e.eventNode.attributes.messageData:null,e.startTime)},i.onHlsTimedMetadata=function(e,t){this.h&&this.h.g.processMetadata("ID3",e.data,t)},i.onCueMetadataChange=function(e){this.h&&this.h.onCueMetadataChange(e)},i.onHLSInterstitialMetadata=function(e,t,n){this.l&&this.l.disableHLSInterstitial||(this.g||this.initInterstitial(null,e,t),this.g&&Lg(this.g,n))},i.onDASHInterstitialMetadata=function(e,t,n){if(!this.l||!this.l.disableDASHInterstitial){var i=n.schemeIdUri;if("urn:mpeg:dash:event:alternativeMPD:insert:2025"==i||"urn:mpeg:dash:event:alternativeMPD:replace:2025"==i){if(this.g||this.initInterstitial(null,e,t),this.g&&(e=this.g,t="urn:mpeg:dash:event:alternativeMPD:replace:2025"==n.schemeIdUri,i="urn:mpeg:dash:event:alternativeMPD:insert:2025"==n.schemeIdUri,t||i)){for(var r,s=n.startTime,a=n.endTime,o=null,u=0,l=d(n.eventNode.children),c=l.next();!c.done;c=l.next())if(c=c.value,"AlternativeMPD"==c.tagName){if(c=c.attributes.uri){r=c;break}}else if("InsertPresentation"==c.tagName||"ReplacePresentation"==c.tagName){var h=c.attributes.url;if(h){r=h,(l=ln(c,"maxDuration",mn))&&(o=l/n.timescale),(l=ln(c,"returnOffset",mn))&&(u=l/n.timescale),t&&u&&(a=s+u);break}}r&&Cg(e,[{id:n.id,groupId:null,startTime:s,endTime:a,uri:r,mimeType:null,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:i?u:null,playoutLimit:o,once:!1,pre:!1,post:!1,timelineRange:t&&!i,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null}])}}else("urn:mpeg:dash:event:2012"==i||"urn:scte:dash:scte214-events"==i)&&n.eventNode&&on(n.eventNode,"OverlayEvent")&&(this.g||this.initInterstitial(null,e,t),this.g&&Rg(this.g,n))}},i.addCustomInterstitial=function(e){if(!this.g)throw new Ve(1,10,10006);Cg(this.g,[e])},i.addAdUrlInterstitial=function(e){if(!this.g)throw new Ve(1,10,10006);return this.g.addAdUrlInterstitial(e)},i.getInterstitialPlayer=function(){if(!this.g)throw new Ve(1,10,10006);return this.g.ld()},K("shaka.ads.AdManager",am),am.prototype.getInterstitialPlayer=am.prototype.getInterstitialPlayer,am.prototype.addAdUrlInterstitial=am.prototype.addAdUrlInterstitial,am.prototype.addCustomInterstitial=am.prototype.addCustomInterstitial,am.prototype.onDASHInterstitialMetadata=am.prototype.onDASHInterstitialMetadata,am.prototype.onHLSInterstitialMetadata=am.prototype.onHLSInterstitialMetadata,am.prototype.onCueMetadataChange=am.prototype.onCueMetadataChange,am.prototype.onHlsTimedMetadata=am.prototype.onHlsTimedMetadata,am.prototype.onDashTimedMetadata=am.prototype.onDashTimedMetadata,am.prototype.onManifestUpdated=am.prototype.onManifestUpdated,am.prototype.getStats=am.prototype.getStats,am.prototype.getCuePoints=am.prototype.getCuePoints,am.prototype.getServerSideCuePoints=am.prototype.getServerSideCuePoints,am.prototype.replaceServerSideAdTagParameters=am.prototype.replaceServerSideAdTagParameters,am.prototype.requestServerSideStream=am.prototype.requestServerSideStream,am.prototype.initServerSide=am.prototype.initServerSide,am.prototype.addMediaTailorTrackingUrl=am.prototype.addMediaTailorTrackingUrl,am.prototype.requestMediaTailorStream=am.prototype.requestMediaTailorStream,am.prototype.initMediaTailor=am.prototype.initMediaTailor,am.prototype.updateClientSideAdsRenderingSettings=am.prototype.updateClientSideAdsRenderingSettings,am.prototype.requestClientSideAds=am.prototype.requestClientSideAds,am.prototype.onAssetUnload=am.prototype.onAssetUnload,am.prototype.release=am.prototype.release,am.prototype.initClientSide=am.prototype.initClientSide,am.prototype.initInterstitial=am.prototype.initInterstitial,am.prototype.configure=am.prototype.configure,am.prototype.setLocale=am.prototype.setLocale,am.ADS_LOADED="ads-loaded",am.AD_STARTED="ad-started",am.AD_FIRST_QUARTILE="ad-first-quartile",am.AD_MIDPOINT="ad-midpoint",am.AD_THIRD_QUARTILE="ad-third-quartile",am.AD_COMPLETE="ad-complete",am.AD_STOPPED="ad-stopped",am.AD_SKIPPED="ad-skipped",am.AD_VOLUME_CHANGED="ad-volume-changed",am.AD_MUTED="ad-muted",am.AD_PAUSED="ad-paused",am.AD_RESUMED="ad-resumed",am.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",am.CUEPOINTS_CHANGED="ad-cue-points-changed",am.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",am.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",am.AD_CLICKED="ad-clicked",am.AD_PROGRESS="ad-progress",am.AD_BUFFERING="ad-buffering",am.AD_IMPRESSION="ad-impression",am.AD_DURATION_CHANGED="ad-duration-changed",am.AD_CLOSED="ad-closed",am.AD_LOADED="ad-loaded",am.ALL_ADS_COMPLETED="all-ads-completed",am.AD_LINEAR_CHANGED="ad-linear-changed",am.AD_METADATA="ad-metadata",am.AD_RECOVERABLE_ERROR="ad-recoverable-error",am.AD_ERROR="ad-error",am.AD_BREAK_READY="ad-break-ready",am.AD_INTERACTION="ad-interaction",am.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",am.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",am.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",ug=function(){return new am};var dm="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),hm="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),fm=["loop","playbackRate"],pm=["pause","play"],gm=(new Map).set("getAssetUri",2).set("getAudioLanguages",4).set("getAudioLanguagesAndRoles",4).set("getBufferFullness",1).set("getBufferedInfo",2).set("getExpiration",2).set("getKeyStatuses",2).set("getPlaybackRate",2).set("getTextLanguages",4).set("getTextLanguagesAndRoles",4).set("isAudioOnly",10).set("isBuffering",1).set("isInProgress",1).set("isLive",10).set("isTextTrackVisible",1).set("isVideoOnly",10).set("keySystem",10).set("seekRange",1).set("getLoadMode",10).set("getManifestType",10).set("isFullyLoaded",1).set("isEnded",1),mm=(new Map).set("getConfiguration",4).set("getConfigurationForLowLatency",4).set("getStats",5).set("getAudioTracks",2).set("getChaptersTracks",2).set("getImageTracks",2).set("getVideoTracks",2).set("getTextTracks",2).set("getVariantTracks",2),vm=(new Map).set("getPlayheadTimeAsDate",1).set("getPresentationStartTimeAsDate",20).set("getSegmentAvailabilityDuration",20),ym=[["getConfiguration","configure","getConfigurationForLowLatency","configurationForLowLatency"]],bm=[["isTextTrackVisible","setTextTrackVisibility"]],Tm="cancelTrickPlay configure configurationForLowLatency getChapters resetConfiguration retryStreaming selectAudioLanguage selectAudioTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel selectVideoTrack setTextTrackVisibility trickPlay updateStartTime goToLive useTrickPlayTrackIfAvailable".split(" "),Sm="addChaptersTrack addTextTrackAsync addThumbnailsTrack getAllThumbnails getChaptersAsync getThumbnails attach attachCanvas detach load unload".split(" ");function Em(e,t,n,i,r,s,a){var o=this;this.G=e,this.K=a,this.l=new _i(t),this.L=n,this.s=!1,this.A=i,this.F=r,this.M=s,this.i=this.m=!1,this.I="",this.o=null,this.B=function(){return km(o)},this.C=function(e,t){switch(e=lm(t),e.type){case"event":var n=e.targetName,i=es(e.event);o.A(n,i);break;case"update":for(i in n=e.update,n)for(var r in e=o.g[i]||{},n[i])e[r]=n[i][r];o.s&&(o.L(),o.s=!1);break;case"asyncComplete":if(r=e.id,i=e.error,t=e.res,e=o.h.get(r),o.h.delete(r),e)if(i){for(n in r=new Ve(i.severity,i.category,i.code),i)r[n]=i[n];e.reject(r)}else e.resolve(t)}},this.g={video:{},player:{}},this.H=0,this.h=new Map,this.j=null,_m.add(this)}function wm(e){e.i&&chrome.cast.requestSession(function(t){return Am(e,t)},function(t){return xm(e,t)})}function Am(e,t){var n=e.M();Mm=t,t.addUpdateListener(e.B),t.addMessageListener("urn:x-cast:com.google.shaka.v2",e.C),km(e),Rm(e,{type:"init",initState:n,appData:e.o}),e.j.resolve()}function xm(e,t){var n=8003;switch(t.code){case"cancel":n=8004;break;case"timeout":n=8005;break;case"receiver_unavailable":n=8006}e.j.reject(new Ve(2,8,n,t))}function Im(e){var t=Mm;t.removeUpdateListener(e.B),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.C)}function km(e){var t=!!Mm&&"connected"==Mm.status;if(e.i&&!t){for(var n in e.F(),e.g)e.g[n]={};Lm(e)}e.i=t,e.I=t?Mm.receiver.friendlyName:"",e.l.Hb()}function Lm(e){if(e.h)for(var t=d(e.h.keys()),n=t.next();!n.done;n=t.next()){n=n.value;var i=e.h.get(n);e.h.delete(n),i.reject(new Ve(1,7,7e3))}}function Rm(e,t){t=um(t);var n=Mm;try{n.sendMessage("urn:x-cast:com.google.shaka.v2",t,function(){},Z)}catch(i){throw t=new Ve(2,8,8005,i),n=new Zr("error",(new Map).set("detail",t)),e.A("player",n),e.jd(),t}}i=Em.prototype,i.destroy=function(){return _m.delete(this),Lm(this),Mm&&Im(this),this.l&&(this.l.stop(),this.l=null),this.F=this.A=null,this.i=this.m=!1,this.C=this.B=this.j=this.h=this.g=this.o=null,Promise.resolve()},i.ub=function(){return this.i},i.Ug=function(){return this.I},i.init=function(){if(this.G.length)if(e.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.l.Hb();var t=new chrome.cast.SessionRequest(this.G,[],null,this.K,null);t=new chrome.cast.ApiConfig(t,function(e){for(var t=d(_m),n=t.next();!n.done;n=t.next()){n=n.value;var i=e;n.j=new Kr,n.s=!0,Am(n,i)}},function(e){for(var t=d(_m),n=t.next();!n.done;n=t.next())n=n.value,Dm="available"==e,n.l.Hb()},"origin_scoped"),chrome.cast.initialize(t,function(){},function(){}),Dm&&this.l.ha(Cm),(t=Mm)&&t.status!=chrome.cast.SessionStatus.STOPPED?(this.j=new Kr,this.s=!0,Am(this,t)):Mm=null}else e.__onGCastApiAvailable!==Om&&(Pm=e.__onGCastApiAvailable||null,e.__onGCastApiAvailable=Om)},i.fh=function(e){this.o=e,this.i&&Rm(this,{type:"appData",appData:this.o})},i.cast=function(){var e=this;return U(function(t){if(!e.m)throw new Ve(1,8,8e3);if(!Dm)throw new Ve(1,8,8001);if(e.i)throw new Ve(1,8,8002);return e.j=new Kr,chrome.cast.requestSession(function(t){return Am(e,t)},function(t){return xm(e,t)}),w(t,e.j,0)})},i.jd=function(){if(this.i){if(Lm(this),Mm){Im(this);try{Mm.stop(function(){},function(){})}catch(aR){}Mm=null}km(this)}},i.get=function(e,t){var n=this;if("video"==e){if(pm.includes(t))return function(){return n.wi.apply(n,[e,t].concat(h(F.apply(0,arguments))))}}else if("player"==e){if(vm.has(t)&&!this.get("player","isLive")())return function(){};if(Tm.includes(t))return function(){return n.wi.apply(n,[e,t].concat(h(F.apply(0,arguments))))};if(Sm.includes(t))return function(){return n.Fk.apply(n,[e,t].concat(h(F.apply(0,arguments))))};if(gm.has(t)||mm.has(t))return function(){return n.g[e][t]}}return this.g[e][t]},i.set=function(e,t,n){this.g[e][t]=n,Rm(this,{type:"set",targetName:e,property:t,value:n})},i.wi=function(e,t){Rm(this,{type:"call",targetName:e,methodName:t,args:F.apply(2,arguments)})},i.Fk=function(e,t){var n=F.apply(2,arguments),i=new Kr,r=this.H.toString();this.H++,this.h.set(r,i);try{Rm(this,{type:"asyncCall",targetName:e,methodName:t,args:n,id:r})}catch(s){i.reject(s)}return i};var Cm=.02,Dm=!1,Mm=null,Pm=null,_m=new Set;function Om(t){if(Pm?e.__onGCastApiAvailable=Pm:delete e.__onGCastApiAvailable,Pm=null,t)for(var n=d(_m),i=n.next();!i.done;i=n.next())i.value.init();"function"===typeof e.__onGCastApiAvailable&&e.__onGCastApiAvailable(t)}function Nm(t,n,i,r){r=void 0!==r&&r,ns.call(this);var s=this;this.i=t,this.h=n,this.l=this.o=this.m=this.s=this.j=null,this.H=i,this.G=r,this.C=[],this.B=[],this.A=[],this.F=new Map,this.g=null,e.chrome?(this.g=new Em(i,function(){return $m(s)},function(){return Gm(s)},function(e,t){return Wm(s,e,t)},function(){return Vm(s)},function(){return jm(s)},r),Um(this)):(this.j=this.i,this.s=this.h)}function Um(e){e.g.init(),e.l=new re;for(var t=d(dm),n=t.next();!n.done;n=t.next())e.l.D(e.i,n.value,function(t){e.g.ub()||(t=es(t),e.m.dispatchEvent(t))});for(var i in ts)e.l.D(e.h,ts[i],function(t){e.g.ub()||e.o.dispatchEvent(t)});for(var r in e.j={},t={},e.i)t={Vd:t.Vd},t.Vd=r,Object.defineProperty(e.j,t.Vd,{configurable:!1,enumerable:!0,get:function(t){return function(){return Hm(e,t.Vd)}}(t),set:function(t){return function(n){var i=t.Vd;e.g.ub()?e.g.set("video",i,n):e.i[i]=n}}(t)});e.s={},Bm(e,function(t){Object.defineProperty(e.s,t,{configurable:!1,enumerable:!0,get:function(){return Km(e,t)}})}),Fm(e),e.m=new ns,e.m.xe=e.j,e.o=new ns,e.o.xe=e.s,e.l.D(e.h,"unloading",function(){e.g&&e.g.ub()||qm(e)})}function Fm(e){var t=new Map;Bm(e,function(n,i){t.has(i)?(i=t.get(i),n.length<i.length?e.F.set(n,i):e.F.set(i,n)):t.set(i,n)})}function Bm(e,t){function n(e){return"constructor"!=e&&"function"==typeof r[e]&&!s.has(e)}var i,r=e.h,s=new Set;for(i in r)n(i)&&(s.add(i),t(i,r[i]));for(e=Object.getPrototypeOf(r),i=Object.getPrototypeOf({});e&&e!=i;){for(var a=d(Object.getOwnPropertyNames(e)),o=a.next();!o.done;o=a.next())o=o.value,n(o)&&(s.add(o),t(o,r[o]));e=Object.getPrototypeOf(e)}}function jm(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.h.kd(),startTime:null,addThumbnailsTrackCalls:e.C,addTextTrackAsyncCalls:e.B,addChaptersTrackCalls:e.A};e.i.pause();for(var n=d(fm),i=n.next();!i.done;i=n.next())i=i.value,t.video[i]=e.i[i];for(e.i.ended||(t.startTime=e.i.currentTime),n=d(ym),i=n.next();!i.done;i=n.next()){var r=i.value;i=r[1],r=e.h[r[0]](),t.player[i]=r}for(n=d(bm),i=n.next();!i.done;i=n.next())r=i.value,i=r[1],r=e.h[r[0]](),t.playerAfterLoad[i]=r;return t}function $m(e){var t=new Zr("caststatuschanged");e.dispatchEvent(t)}function Gm(e){var t=new Zr(e.j.paused?"pause":"play");e.m.dispatchEvent(t)}function Vm(e){for(var t=d(ym),n=t.next();!n.done;n=t.next()){var i=n.value;n=i[1],i=e.g.get("player",i[0])(),e.h[n](i)}var r=e.C,s=e.B,a=e.A;qm(e);var o=e.g.get("player","getAssetUri")();i=e.g.get("video","ended"),t=Promise.resolve();var u,l=e.i.autoplay;n=null,i||(n=e.g.get("video","currentTime")),(i=e.g.get("player","getTextTracks")())&&i.length&&(u=i.find(function(e){return e.active}));var c=e.g.get("player","isTextTrackVisible")();o&&(e.i.autoplay=!1,t=e.h.load(o,n));var f={};for(n=d(fm),i=n.next();!i.done;i=n.next())i=i.value,f[i]=e.g.get("video",i);t.then(function(){if(e.i){for(var t=d(r),n=t.next();!n.done;n=t.next()){var i;n=n.value,(i=e.ld()).Fe.apply(i,h(n))}for(t=d(s),i=t.next();!i.done;i=t.next()){var p;i=i.value,(p=e.ld()).Ed.apply(p,h(i))}for(p=d(a),t=p.next();!t.done;t=p.next()){var g;t=t.value,(g=e.ld()).Ee.apply(g,h(t))}for(g=d(fm),p=g.next();!p.done;p=g.next())p=p.value,e.i[p]=f[p];for(g=d(bm),p=g.next();!p.done;p=g.next())t=p.value,p=t[1],t=e.g.get("player",t[0])(),e.h[p](t);e.h.jh(c),u&&e.h.dh(u.language,u.roles,u.forced),e.i.autoplay=l,o&&e.i.play()}},function(t){t=(new Map).set("detail",t),t=new Zr("error",t),e.h.dispatchEvent(t)})}function Hm(e,t){if("addEventListener"==t)return function(t,n,i){return e.m.addEventListener(t,n,i)};if("removeEventListener"==t)return function(t,n,i){return e.m.removeEventListener(t,n,i)};if(e.g.ub()&&0==Object.keys(e.g.g.video).length){var n=e.i[t];if("function"!=typeof n)return n}return e.g.ub()?e.g.get("video",t):(t=e.i[t],"function"==typeof t&&(t=t.bind(e.i)),t)}function Km(e,t,n){if(n=void 0!==n&&n,e.F.has(t)&&(t=e.F.get(t)),"addEventListener"==t)return function(t,n,i){return e.o.addEventListener(t,n,i)};if("removeEventListener"==t)return function(t,n,i){return e.o.removeEventListener(t,n,i)};if("getMediaElement"==t)return function(){return e.j};if("getSharedConfiguration"==t)return e.g.get("player","getConfiguration");if("getNetworkingEngine"==t)return function(){return e.h.Nb()};if("getDrmEngine"==t)return function(){return e.h.C};if("getAdManager"==t)return function(){return e.h.Rh()};if("getQueueManager"==t)return function(){return e.h.Xh()};if("setVideoContainer"==t)return function(t){return e.h.Mi(t)};if(!n){if("addThumbnailsTrack"==t)return function(){var n=F.apply(0,arguments);return e.C.push(n),Km(e,t,!0).apply(null,h(n))};if("addTextTrackAsync"==t)return function(){var n=F.apply(0,arguments);return e.B.push(n),Km(e,t,!0).apply(null,h(n))};if("addChaptersTrack"==t)return function(){var n=F.apply(0,arguments);return e.A.push(n),Km(e,t,!0).apply(null,h(n))}}if(e.g.ub()){if("getManifest"==t||"drmInfo"==t)return function(){return Q(t+"() does not work while casting!"),null};if("attach"==t||"detach"==t)return function(){return Q(t+"() does not work while casting!"),Promise.resolve()};if("getChapters"==t)return function(){return Q(t+"() does not work while casting!"),[]}}return e.g.ub()&&0==Object.keys(e.g.g.video).length&&(gm.has(t)||mm.has(t))||!e.g.ub()?e.h[t].bind(e.h):e.g.get("player",t)}function Wm(e,t,n){e.g.ub()&&("video"==t?e.m.dispatchEvent(n):"player"==t&&("unloading"==n.type&&qm(e),e.o.dispatchEvent(n)))}function qm(e){e.C=[],e.B=[],e.A=[]}function Ym(e,t,n,i){ns.call(this);var r=this;this.h=e,this.g=t,this.j=new re,this.H={video:e,player:t},this.F=n||function(){},this.I=i||function(e){return e},this.i=null,this.G=!1,this.o=!0,this.m=0,this.B=!1,this.A=!0,this.s=this.l=null,this.C=new _i(function(){ev(r)}),zm(this)}function zm(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return Xm(e)},t.onSenderDisconnected=function(){return Xm(e)},t.onSystemVolumeChanged=function(){var t=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();t&&av(e,{type:"update",update:{video:{volume:t.level,muted:t.muted}}},e.l),av(e,{type:"event",targetName:"video",event:{type:"volumechange"}},e.l)},e.s=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.s.onMessage=function(t){return rv(e,t)},e.l=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.l.onMessage=function(t){return iv(e,t)},t.start(),t=d(dm);for(var n=t.next();!n.done;n=t.next())e.j.D(e.h,n.value,function(t){return Zm(e,"video",t)});for(var i in ts)e.j.D(e.g,ts[i],function(t){return Zm(e,"player",t)});e.j.D(e.h,"loadeddata",function(){e.B=!0}),e.j.D(e.g,"loading",function(){e.o=!1,Qm(e)}),e.j.D(e.h,"playing",function(){e.o=!1,Qm(e)}),e.j.D(e.h,"pause",function(){Qm(e)}),e.j.D(e.g,"unloading",function(){e.o=!0,Qm(e)}),e.j.D(e.h,"ended",function(){new _i(function(){e.h&&e.h.ended&&(e.o=!0,Qm(e))}).ha(lv)})}function Xm(e){e.m=0,e.A=!0,e.G=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,Qm(e)}function Qm(e){var t;U(function(n){return 1==n.g?w(n,Promise.resolve(),2):e.g?(t=new Zr("caststatuschanged"),e.dispatchEvent(t),tv(e)||ov(e),void A(n)):n.return()})}function Jm(e,t,n){var i,r,s,a,o,u,l,c,f,p,g,m,v,y,b,T,S,E,I;U(function(R){switch(R.g){case 1:for(i in t.player)r=t.player[i],e.g[i](r);return e.F(n),s=e.h.autoplay,t.manifest?(e.h.autoplay=!1,x(R,5),w(R,e.g.load(t.manifest,t.startTime),7)):w(R,Promise.resolve(),3);case 7:if(t.addThumbnailsTrackCalls)for(a=d(t.addThumbnailsTrackCalls),o=a.next();!o.done;o=a.next())u=o.value,e.g.Fe.apply(e.g,h(u));if(t.addTextTrackAsyncCalls)for(l=d(t.addTextTrackAsyncCalls),c=l.next();!c.done;c=l.next())f=c.value,e.g.Ed.apply(e.g,h(f));if(t.addChaptersTrackCalls)for(p=d(t.addChaptersTrackCalls),g=p.next();!g.done;g=p.next())m=g.value,e.g.Ee.apply(e.g,h(m));k(R,3);break;case 5:return v=L(R),y=(new Map).set("detail",v),b=new Zr("error",y),e.g&&e.g.dispatchEvent(b),R.return();case 3:if(!e.g)return R.return();for(T in t.video)S=t.video[T],e.h[T]=S;for(E in t.playerAfterLoad)I=t.playerAfterLoad[E],e.g[E](I);e.h.autoplay=s,t.manifest&&(e.h.play(),ov(e)),A(R)}})}function Zm(e,t,n){e.g&&(ev(e),av(e,{type:"event",targetName:t,event:n},e.l))}function ev(e){e.C.ha(uv);for(var t={video:{},player:{}},n=d(hm),i=n.next();!i.done;i=n.next())i=i.value,t.video[i]=e.h[i];e.g.V()&&vm.forEach(function(n,i){0==e.m%n&&(t.player[i]=e.g[i]())}),gm.forEach(function(n,i){0==e.m%n&&(t.player[i]=e.g[i]())}),(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),av(e,{type:"update",update:t},e.l),mm.forEach(function(t,n){0==e.m%t&&(t={player:{}},t.player[n]=e.g[n](),av(e,{type:"update",update:t},e.l))}),e.B&&(e.m+=1),tv(e)}function tv(e){return!(!e.A||!e.h.duration&&!e.g.V())&&(nv(e),e.A=!1,!0)}function nv(e,t){var n={contentId:e.g.kd(),streamType:e.g.V()?"LIVE":"BUFFERED",contentType:""};e.g.V()||(n.duration=e.h.duration),e.i&&(n.metadata=e.i),ov(e,void 0===t?0:t,n)}function iv(e,t){var n=lm(t.data);switch(n.type){case"init":e.m=0,e.B=!1,e.A=!0,Jm(e,n.initState,n.appData),ev(e);break;case"appData":e.F(n.appData);break;case"set":var i=n.targetName,r=n.property;if(n=n.value,"video"==i){if(t=cast.receiver.CastReceiverManager.getInstance(),"volume"==r){t.setSystemVolumeLevel(n);break}if("muted"==r){t.setSystemVolumeMuted(n);break}}e.H[i][r]=n;break;case"call":i=e.H[n.targetName],i[n.methodName].apply(i,n.args);break;case"asyncCall":i=n.targetName,r=n.methodName,"player"==i&&"load"==r&&(e.m=0,e.B=!1);var s=n.id,a=t.senderId;t=e.H[i],n=t[r].apply(t,n.args),"player"==i&&"load"==r&&(n=n.then(function(){e.A=!0})),n.then(function(t){return sv(e,a,s,null,t)},function(t){return sv(e,a,s,t,null)})}}function rv(e,t){var n=lm(t.data);switch(n.type){case"PLAY":e.h.play(),ov(e);break;case"PAUSE":e.h.pause(),ov(e);break;case"SEEK":t=n.currentTime;var i=n.resumeState;null!=t&&(e.h.currentTime=Number(t)),i&&"PLAYBACK_START"==i?(e.h.play(),ov(e)):i&&"PLAYBACK_PAUSE"==i&&(e.h.pause(),ov(e));break;case"STOP":e.g.uc().then(function(){e.g&&ov(e)});break;case"GET_STATUS":nv(e,Number(n.requestId));break;case"VOLUME":i=n.volume,t=i.level,i=i.muted;var r=e.h.volume,s=e.h.muted;null!=t&&(e.h.volume=Number(t)),null!=i&&(e.h.muted=i),r==e.h.volume&&s==e.h.muted||ov(e);break;case"LOAD":e.m=0,e.B=!1,e.A=!1,t=n.media,i=n.currentTime,r=e.I(t.contentId),s=n.autoplay||!0,e.F(t.customData),s&&(e.h.autoplay=!0),e.g.load(r,i).then(function(){e.g&&nv(e)}).catch(function(t){var i="LOAD_FAILED";7==t.category&&7e3==t.code&&(i="LOAD_CANCELLED"),av(e,{requestId:Number(n.requestId),type:i},e.s)});break;default:av(e,{requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},e.s)}}function sv(e,t,n,i,r){e.g&&av(e,{type:"asyncComplete",id:n,error:i,res:r},e.l,t)}function av(e,t,n,i){e.G&&(e=um(t),i?n.getCastChannel(i).send(e):n.broadcast(e))}function ov(e,t,n){n=void 0===n?null:n;var i={mediaSessionId:0,playbackRate:e.h.playbackRate,playerState:e.o?cv:e.g.Hg()?hv:e.h.paused?fv:dv,currentTime:e.h.currentTime,supportedMediaCommands:63,volume:{level:e.h.volume,muted:e.h.muted}};n&&(i.media=n),av(e,{requestId:void 0===t?0:t,type:"MEDIA_STATUS",status:[i]},e.s)}b(Nm,ns),i=Nm.prototype,i.destroy=function(e){return this.g&&void 0!==e&&e&&this.g.jd(),this.l&&(this.l.release(),this.l=null),e=[],this.h&&(e.push(this.h.destroy()),this.h=null),this.g&&(e.push(this.g.destroy()),this.g=null),this.s=this.j=this.i=null,ns.prototype.release.call(this),Promise.all(e)},i.Vj=function(){return this.j},i.ld=function(){return this.s},i.fj=function(){return!!this.g&&(this.g.m&&Dm)},i.ub=function(){return!!this.g&&this.g.ub()},i.Ug=function(){return this.g?this.g.Ug():""},i.cast=function(){var e=this;return U(function(t){return 1==t.g?e.g?w(t,e.g.cast(),2):t.return():e.h?w(t,e.h.uc(),0):t.return()})},i.fh=function(e){this.g&&this.g.fh(e)},i.Uk=function(){this.g&&wm(this.g)},i.jd=function(){this.g&&this.g.jd()},i.gj=function(e,t){t=void 0!==t&&t;var n=this;return U(function(i){if(1==i.g)return e==n.H&&t==n.G?i.return():(n.H=e,n.G=t,n.g?(n.g.jd(),w(i,n.g.destroy(),2)):i.return());n.g=null,n.g=new Em(e,function(){return $m(n)},function(){return Gm(n)},function(e,t){return Wm(n,e,t)},function(){return Vm(n)},function(){return jm(n)},t),n.g.init(),A(i)})},K("shaka.cast.CastProxy",Nm),Nm.prototype.changeReceiverId=Nm.prototype.gj,Nm.prototype.forceDisconnect=Nm.prototype.jd,Nm.prototype.suggestDisconnect=Nm.prototype.Uk,Nm.prototype.setAppData=Nm.prototype.fh,Nm.prototype.cast=Nm.prototype.cast,Nm.prototype.receiverName=Nm.prototype.Ug,Nm.prototype.isCasting=Nm.prototype.ub,Nm.prototype.canCast=Nm.prototype.fj,Nm.prototype.getPlayer=Nm.prototype.ld,Nm.prototype.getVideo=Nm.prototype.Vj,Nm.prototype.destroy=Nm.prototype.destroy,b(Ym,ns),i=Ym.prototype,i.isConnected=function(){return this.G},i.ck=function(){return this.o},i.Rk=function(e){this.i=e},i.kj=function(){this.i=null},i.Sk=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.title=e},i.Qk=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.images=[{url:e}]},i.Pk=function(e){this.i||(this.i={}),this.i.artist=e,this.i.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},i.destroy=function(){var e,t,n=this;return U(function(i){if(1==i.g)return n.j&&(n.j.release(),n.j=null),e=[],n.g&&(e.push(n.g.destroy()),n.g=null),n.C&&(n.C.stop(),n.C=null),n.h=null,n.H=null,n.F=null,n.G=!1,n.o=!0,n.l=null,n.s=null,ns.prototype.release.call(n),w(i,Promise.all(e),2);t=cast.receiver.CastReceiverManager.getInstance(),t.stop(),A(i)})},K("shaka.cast.CastReceiver",Ym),Ym.prototype.destroy=Ym.prototype.destroy,Ym.prototype.setContentArtist=Ym.prototype.Pk,Ym.prototype.setContentImage=Ym.prototype.Qk,Ym.prototype.setContentTitle=Ym.prototype.Sk,Ym.prototype.clearContentMetadata=Ym.prototype.kj,Ym.prototype.setContentMetadata=Ym.prototype.Rk,Ym.prototype.isIdle=Ym.prototype.ck,Ym.prototype.isConnected=Ym.prototype.isConnected;var uv=.5,lv=5,cv="IDLE",dv="PLAYING",hv="BUFFERING",fv="PAUSED";function pv(e,t,n,i,r){if(i>=r)return null;for(var s=-1,a=-1,o=0;o<n.length;o++)if(n[o].some(function(e){return null!=e&&""!=e.g.trim()})){s=o;break}for(o=n.length-1;0<=o;o--)if(n[o].some(function(e){return null!=e&&""!=e.g.trim()})){a=o;break}if(-1===s||-1===a)return null;for(var u=o=!1,l="white",c="black",d=gv(i,r,o,u,l,c);s<=a;s++){for(var h=n[s],f=-1,p=-1,g=0;g<h.length;g++)if(null!=h[g]&&""!==h[g].g.trim()){f=g;break}for(g=h.length-1;0<=g;g--)if(null!=h[g]&&""!==h[g].g.trim()){p=g;break}if(-1===f||-1===p)h=mv(i,r),e.nestedCues.push(h);else{for(;f<=p;f++)if(g=h[f]){var m=g.l,v=g.i,y=g.j,b=g.h;m==o&&v==u&&y==l&&b==c||(d.payload&&e.nestedCues.push(d),d=gv(i,r,m,v,y,b),o=m,u=v,l=y,c=b),d.payload+=g.g}else d.payload+=" ";d.payload&&e.nestedCues.push(d),s!==a&&(d=mv(i,r),e.nestedCues.push(d)),d=gv(i,r,o,u,l,c)}}return e.nestedCues.length?{cue:e,stream:t}:null}function gv(e,t,n,i,r,s){return e=new Cn(e,t,""),n&&e.textDecoration.push(ti),i&&(e.fontStyle=Zn),e.color=r,e.backgroundColor=s,e}function mv(e,t){return e=new Cn(e,t,""),e.lineBreak=!0,e}function vv(e,t,n,i,r){this.g=e,this.l=t,this.i=n,this.h=i,this.j=r}function yv(e,t){this.i=[],this.g=1,this.h=0,this.C=e,this.B=t,this.j=this.m=!1,this.l="white",this.o="black",this.s=this.A=null,Tv(this)}function bv(e,t,n){var i="CC"+(1+(e.C<<1|e.B)),r=new Cn(t,n,"");r.lineInterpretation=1;var s=Lv.get(e.g);return s&&(r.line=s),null!=e.s&&null!=e.A&&(r.position=10+Math.min(70,10*e.s)+2.5*e.A),(t=pv(r,i,e.i,t,n))&&15<e.g+t.cue.nestedCues.length-3&&(s=Lv.get(e.g+3-t.cue.nestedCues.length))&&(r.line=s),t}function Tv(e){wv(e,0,15),e.g=1}function Sv(e,t,n){if(!(32>n||127<n)){var i="";switch(t){case 0:i=Av.has(n)?Av.get(n):String.fromCharCode(n);break;case 1:i=xv.get(n);break;case 2:e.i[e.g].pop(),i=Iv.get(n);break;case 3:e.i[e.g].pop(),i=kv.get(n)}i&&e.i[e.g].push(new vv(i,e.m,e.j,e.o,e.l))}}function Ev(e,t,n,i){if(!(0>n||0>t))if(t>=n)for(--i;0<=i;i--)e.i[t+i]=e.i[n+i].map(function(e){return e});else for(var r=0;r<i;r++)e.i[t+r]=e.i[n+r].map(function(e){return e})}function wv(e,t,n){for(var i=0;i<=n;i++)e.i[t+i]=[]}var Av=new Map([[39,"’"],[42,"á"],[92,"é"],[92,"é"],[94,"í"],[95,"ó"],[96,"ú"],[123,"ç"],[124,"÷"],[125,"Ñ"],[126,"ñ"],[127,"█"]]),xv=new Map([[48,"®"],[49,"°"],[50,"½"],[51,"¿"],[52,"™"],[53,"¢"],[54,"£"],[55,"♪"],[56,"à"],[57," "],[58,"è"],[59,"â"],[60,"ê"],[61,"î"],[62,"ô"],[63,"û"]]),Iv=new Map([[32,"Á"],[33,"É"],[34,"Ó"],[35,"Ú"],[36,"Ü"],[37,"ü"],[38,"‘"],[39,"¡"],[40,"*"],[41,"'"],[42,"─"],[43,"©"],[44,"℠"],[45,"·"],[46,"“"],[47,"”"],[48,"À"],[49,"Â"],[50,"Ç"],[51,"È"],[52,"Ê"],[53,"Ë"],[54,"ë"],[55,"Î"],[56,"Ï"],[57,"ï"],[58,"Ô"],[59,"Ù"],[60,"ù"],[61,"Û"],[62,"«"],[63,"»"]]),kv=new Map([[32,"Ã"],[33,"ã"],[34,"Í"],[35,"Ì"],[36,"ì"],[37,"Ò"],[38,"ò"],[39,"Õ"],[40,"õ"],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,"Ä"],[49,"ä"],[50,"Ö"],[51,"ö"],[52,"ß"],[53,"¥"],[54,"¤"],[55,"│"],[56,"Å"],[57,"å"],[58,"Ø"],[59,"ø"],[60,"┌"],[61,"┐"],[62,"└"],[63,"┘"]]),Lv=new Map([[1,10],[2,15.33],[3,20.66],[4,26],[5,31.33],[6,36.66],[7,42],[8,47.33],[9,52.66],[10,58],[11,63.33],[12,68.66],[13,74],[14,79.33],[15,84.66]]);function Rv(e,t){this.h=0,this.o=new yv(e,t),this.i=new yv(e,t),this.g=this.j=new yv(e,t),this.l=0,this.m=null}function Cv(e,t,n){e.g=e.i;var i=e.g,r=null;return 3!==e.h&&4!==e.h&&(r=bv(i,e.l,n),n=e.i,n.g=0<n.h?n.h:0,wv(n,0,15),n=e.j,n.g=0<n.h?n.h:0,wv(n,0,15),i.g=15),e.h=3,i.h=t,r}function Dv(e){e.h=1,e.g=e.j,e.g.h=0}function Mv(e){J("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),e.g=e.o,e.h=4}var Pv="black green blue cyan red yellow magenta black".split(" "),_v="white green blue cyan red yellow magenta white_italics".split(" ");function Ov(e,t){this.I=t,this.M=e,this.K=this.l=!1,this.m=this.o=this.G=this.L=this.H=0,this.F=2,this.i=[],this.g=this.h=this.j=0,this.C=this.A=!1,this.B="white",this.s="black",Nv(this)}function Nv(e){e.i=[];for(var t=0;16>t;t++)e.i.push(Uv())}function Uv(){for(var e=[],t=0;42>t;t++)e.push(null);return e}function Fv(e,t){Bv(e)&&(e.i[e.h][e.g]=new vv(t,e.C,e.A,e.s,e.B),e.g++)}function Bv(e){var t=e.g<e.m&&0<=e.g;return e.h<e.o&&0<=e.h&&t}function jv(e){for(var t=0,n=1;16>n;n++,t++)e.i[t]=e.i[n];for(n=0;1>n;n++,t++)e.i[t]=Uv()}function $v(e,t,n){var i=new Cn(e.j,t,"");i.textAlign=0===e.F?"left":1===e.F?"right":Bn;var r=i.region;switch(e.I&&(r.id+="svc"+e.I),r.id+="win"+e.M,r.height=e.o,r.width=e.m,r.heightUnits=2,r.widthUnits=2,r.viewportAnchorX=e.H,r.viewportAnchorY=e.L,r.viewportAnchorUnits=e.K?_t:2,e.G){case 0:r.regionAnchorX=0,r.regionAnchorY=0;break;case 1:r.regionAnchorX=50,r.regionAnchorY=0;break;case 2:r.regionAnchorX=100,r.regionAnchorY=0;break;case 3:r.regionAnchorX=0,r.regionAnchorY=50;break;case 4:r.regionAnchorX=50,r.regionAnchorY=50;break;case 5:r.regionAnchorX=100,r.regionAnchorY=50;break;case 6:r.regionAnchorX=0,r.regionAnchorY=100;break;case 7:r.regionAnchorX=50,r.regionAnchorY=100;break;case 8:r.regionAnchorX=100,r.regionAnchorY=100}return(n=pv(i,"svc"+n,e.i,e.j,t))&&(e.j=t),n}function Gv(){this.i=[],this.h=null,this.g=0}function Vv(e,t){3===t.type?(e.g=2*(63&t.value)-1,e.h=[]):e.h&&(0<e.g&&(e.h.push(t),e.g--),0===e.g&&(e.i.push(new Hv(e.h)),e.h=null,e.g=0))}function Hv(e){this.g=0,this.h=e}function Kv(e){if(!e.Fa())throw new Ve(2,2,3e3);return e.h[e.g++]}function Wv(e){this.i=e,this.h=[null,null,null,null,null,null,null,null],this.g=null}function qv(e,t,n,i){if(!e.g)return[];if(24==n)return n=Kv(t).value,i=Kv(t).value,n=function(e){return e.map(function(e){return("0"+(255&e).toString(16)).slice(-2)}).join("")}([n,i]),Fv(e.g,String.fromCharCode(parseInt(n,16))),[];t=e.g;var r=null;switch(n){case 8:!Bv(t)||0>=t.g&&0>=t.h||(0>=t.g?(t.g=t.m-1,t.h--):t.g--,t.i[t.h][t.g]=null);break;case 13:t.isVisible()&&(r=$v(t,i,e.i)),t.h+1>=t.o?jv(t):t.h++,t.g=0;break;case 14:t.isVisible()&&(r=$v(t,i,e.i)),t.i[t.h]=Uv(),t.g=0;break;case 12:t.isVisible()&&(r=$v(t,i,e.i)),Nv(t),t.h=0,t.g=0}return r?[r]:[]}function Yv(e,t,n,i){if(128<=n&&135>=n)i=7&n,e.h[i]&&(e.g=e.h[i]);else{if(136===n){n=Kv(t).value,t=[],n=d(zv(e,n));for(var r=n.next();!r.done;r=n.next()){if(r=e.h[r.value],r.isVisible()){var s=$v(r,i,e.i);s&&t.push(s)}Nv(r)}return t}if(137===n)for(t=Kv(t).value,t=d(zv(e,t)),n=t.next();!n.done;n=t.next())n=e.h[n.value],n.isVisible()||(n.j=i),n.display();else{if(138===n){for(n=Kv(t).value,t=null,n=d(zv(e,n)),r=n.next();!r.done;r=n.next())r=e.h[r.value],r.isVisible()&&(t=$v(r,i,e.i)),r.l=!1;return t?[t]:[]}if(139===n){for(n=Kv(t).value,t=null,n=d(zv(e,n)),r=n.next();!r.done;r=n.next())r=e.h[r.value],r.isVisible()?t=$v(r,i,e.i):r.j=i,r.l=!r.l;return t?[t]:[]}if(140===n)return t=Kv(t).value,Xv(e,t,i);if(143===n)return i=Xv(e,255,i),Qv(e),i;if(144===n)t.skip(1),i=Kv(t).value,e.g&&(e.g.A=0<(128&i),e.g.C=0<(64&i));else if(145===n)i=Kv(t).value,n=Kv(t).value,t.skip(1),e.g&&(t=Jv((48&n)>>4,(12&n)>>2,3&n),e.g.B=Jv((48&i)>>4,(12&i)>>2,3&i),e.g.s=t);else if(146===n)i=Kv(t).value,t=Kv(t).value,e.g&&(e=e.g,e.h=15&i,e.g=63&t);else if(151===n)t.skip(1),t.skip(1),i=Kv(t).value,t.skip(1),e.g&&(e.g.F=3&i);else if(152<=n&&159>=n){n=(15&n)-8,r=null!==e.h[n],r||(s=new Ov(n,e.i),s.j=i,e.h[n]=s),i=Kv(t).value,s=Kv(t).value;var a=Kv(t).value,o=Kv(t).value,u=Kv(t).value;t=Kv(t).value,r&&0===(7&t)||(t=e.h[n],t.h=0,t.g=0,t.C=!1,t.A=!1,t.B="white",t.s="black"),t=e.h[n],t.l=0<(32&i),t.L=127&s,t.H=a,t.G=(240&o)>>4,t.K=0<(128&s),t.o=1+(15&o),t.m=1+(63&u),e.g=e.h[n]}}}return[]}function zv(e,t){for(var n=[],i=0;8>i;i++)1===(1&t)&&e.h[i]&&n.push(i),t>>=1;return n}function Xv(e,t,n){var i=[];t=d(zv(e,t));for(var r=t.next();!r.done;r=t.next()){r=r.value;var s=e.h[r];s.isVisible()&&(s=$v(s,n,e.i))&&i.push(s),e.h[r]=null}return i}function Qv(e){e.g=null,e.h=[null,null,null,null,null,null,null,null]}function Jv(e,t,n){var i={0:0,1:0,2:1,3:1};return e=i[e],t=i[t],n=i[n],ey[e<<2|t<<1|n]}Ov.prototype.isVisible=function(){return this.l},Ov.prototype.display=function(){this.l=!0},Hv.prototype.Fa=function(){return this.g<this.h.length},Hv.prototype.Ma=function(){return this.g},Hv.prototype.skip=function(e){if(this.g+e>this.h.length)throw new Ve(2,2,3e3);this.g+=e},Hv.prototype.Ci=function(e){if(0>this.g-e)throw new Ve(2,2,3e3);this.g-=e};var Zv=new Map([[32," "],[33," "],[37,"…"],[42,"Š"],[44,"Œ"],[48,"█"],[49,"‘"],[50,"’"],[51,"“"],[52,"”"],[53,"•"],[57,"™"],[58,"š"],[60,"œ"],[61,"℠"],[63,"Ÿ"],[118,"⅛"],[119,"⅜"],[120,"⅝"],[121,"⅞"],[122,"│"],[123,"┐"],[124,"└"],[125,"─"],[126,"┘"],[127,"┌"]]),ey="black blue green cyan red magenta yellow white".split(" ");function ty(){this.h=[],this.g=[],this.i=new Gv,this.l=0,this.m=new Map([["CC1",new Rv(0,0)],["CC2",new Rv(0,1)],["CC3",new Rv(1,0)],["CC4",new Rv(1,1)]]),this.s=this.o=0,this.j=new Map,this.B=!0,this.A=new Set,ny(this)}function ny(e){e.o=0,e.s=0;for(var t=d(e.m.values()),n=t.next();!n.done;n=t.next())n=n.value,n.h=0,n.g=n.j,n.m=null,Tv(n.i),Tv(n.j),Tv(n.o);e.B=!0}function iy(e,t){var n=t.type;if(16===(112&t.Bb)){var i=t.Bb>>3&1;0===n?e.o=i:e.s=i}if(i="CC"+(1+(n<<1|(n?e.s:e.o))),n=e.m.get(i),255===t.Bb&&255===t.ec||!t.Bb&&!t.ec||!sy(t.Bb)||!sy(t.ec))return 45<=++e.l&&ny(e),null;e.l=0,t.Bb&=127,t.ec&=127;var r=t.Bb;if(1<=r&&15>=r||!t.Bb&&!t.ec)return null;if(r=null,16===(112&t.Bb))e:{if(e.A.add(i),i=t.Bb,e=t.ec,n.m===(i<<8|e))n.m=null;else if(n.m=i<<8|e,16===(240&i)&&64===(192&e)){t=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(7&i)<<1|e>>5&1],i="white",r=!1;var s=null,a=95<e?e-96:e-64;13>=a?i=_v[Math.floor(a/2)]:15>=a?r=!0:s=Math.floor((a-16)/2),e=1===(1&e),4!==n.h&&(a=n.g,3===n.h&&t!==a.g&&(n=1+t-a.h,Ev(a,n,1+a.g-a.h,a.h),wv(a,0,n-1),wv(a,t+1,15-t)),a.g=t,a.m=e,a.j=r,a.l=i,a.s=s,a.o="black")}else if(17===(247&i)&&32===(240&e))n.g.m=!1,n.g.j=!1,n.g.l="white",Sv(n.g,0,32),i=!1,t=_v[(14&e)>>1],"white_italics"===t&&(t="white",i=!0),n.g.m=1===(1&e),n.g.j=i,n.g.l=t;else if(16===(247&i)&&32===(240&e)||23===(247&i)&&45===(255&e))t="black",0===(7&i)&&(t=Pv[(14&e)>>1]),n.g.o=t;else if(17===(247&i)&&48===(240&e))Sv(n.g,1,e);else if(18===(246&i)&&32===(224&e))Sv(n.g,1&i?3:2,e);else{if(20===(246&i)&&32===(240&e)){switch(e=t.pts,i=null,t.ec){case 32:Dv(n);break;case 33:n=n.g,n.i[n.g].pop();break;case 37:i=Cv(n,2,e);break;case 38:i=Cv(n,3,e);break;case 39:i=Cv(n,4,e);break;case 40:Sv(n.g,0,32);break;case 41:n.h=2,n.g=n.i,n.g.h=0,n.l=e;break;case 42:Tv(n.o),Mv(n);break;case 43:Mv(n);break;case 44:t=n.i,i=null,4!==n.h&&(i=bv(t,n.l,e)),wv(t,0,15);break;case 45:t=n.g,3!==n.h?i=null:(i=bv(t,n.l,e),r=t.g-t.h+1,Ev(t,r-1,r,t.h),wv(t,0,r-1),wv(t,t.g,15-t.g),n.l=e);break;case 46:wv(n.j,0,15);break;case 47:t=null,4!==n.h&&(t=bv(n.i,n.l,e)),i=n.j,n.j=n.i,n.i=i,Dv(n),n.l=e,i=t}r=i;break e}(23==i||31==i)&&33<=e&&35>=e&&(n.g.A=e-32)}r=null}else e=t.ec,Sv(n.g,0,t.Bb),Sv(n.g,0,e);return r}function ry(e,t){var n=[];try{for(;t.Fa();){var i=Kv(t).value,r=(224&i)>>5,s=31&i;if(7===r&&0!=s&&(r=63&Kv(t).value),0!=r){e.A.add("svc"+r),e.j.has(r)||e.j.set(r,new Wv(r));for(var a=e.j.get(r),o=t.Ma();t.Ma()-o<s;){r=a;var u=t,l=Kv(u),c=l.value,d=l.pts;if(16===c){var f=Kv(u);c=c<<16|f.value}if(0<=c&&31>=c)var p=qv(r,u,c,d);else if(128<=c&&159>=c)p=Yv(r,u,c,d);else{if(4096<=c&&4127>=c)r=u,u=255&c,8<=u&&15>=u?r.skip(1):16<=u&&23>=u?r.skip(2):24<=u&&31>=u&&r.skip(3);else if(4224<=c&&4255>=c)r=u,u=255&c,128<=u&&135>=u?r.skip(4):136<=u&&143>=u&&r.skip(5);else if(32<=c&&127>=c)u=c,r.g&&Fv(r.g,127===u?"♪":String.fromCharCode(u));else if(160<=c&&255>=c)r.g&&Fv(r.g,String.fromCharCode(c));else if(4128<=c&&4223>=c){if(u=255&c,r.g)if(Zv.has(u)){var g=Zv.get(u);Fv(r.g,g)}else Fv(r.g,"_")}else 4256<=c&&4351>=c&&r.g&&Fv(r.g,160!=(255&c)?"_":"[CC]");p=[]}n.push.apply(n,h(p))}}}}catch(m){if(!(m instanceof Ve&&3e3===m.code))throw m;J("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.")}return n}function sy(e){for(var t=0;e;)t^=1&e,e>>=1;return 1===t}function ay(e){for(var t=[],n=e,i=e=0;i<n.length;)2==e&&3==n[i]?(e=0,n=[].concat(h(n)),n.splice(i,1),n=new Uint8Array(n)):0==n[i]?e++:e=0,i++;for(e=n,i=0;i<e.length;){for(n=0;255==e[i];)n+=255,i++;n+=e[i++];for(var r=0;255==e[i];)r+=255,i++;r+=e[i++],4==n&&t.push(e.subarray(i,i+r)),i+=r}return t}function oy(){this.j=new Map,this.i=this.h=0,this.g=ly}function uy(e,t,n,i,r,s,a,o,u){var l=0,c=s,f=o.map(function(e){return e.ah});for(f=[].concat.apply([],h(f)),f.length&&(c=f[0].sampleSize||s),t.skip(a+o[0].hg);t.Fa();){a=t.T();var p=t.X(),g=null;switch(g=!1,o=1,e.g){case cy:g=31&p,g=6==g;break;case dy:o=2,t.skip(1),g=p>>1&63,g=39==g||40==g;break;case hy:o=2,t.skip(1),g=p>>1&63,g=23==g||24==g;break;default:return}if(g)for(p=0,l<f.length&&(p=f[l].yf||0),p=(n+p)/i,o=d(ay(t.Sb(a-o))),g=o.next();!g.done;g=o.next())u.push({packet:g.value,pts:p});else try{t.skip(a-o)}catch(m){break}c-=a+4,0==c&&(n=l<f.length?n+(f[l].bh||r):n+r,l++,c=l<f.length&&f[l].sampleSize||s)}}ty.prototype.clear=function(){this.l=0,this.h=[],this.g=[];var e=this.i;e.i=[],e.h=[],e.g=0,ny(this),e=d(this.j.values());for(var t=e.next();!t.done;t=e.next())Qv(t.value)},ty.prototype.extract=function(e,t){if(this.B){for(var n=d(this.m.values()),i=n.next();!i.done;i=n.next())i.value.l=t;this.B=!1}if(e=new As(e,0),!(8>e.getLength())&&181===e.X()&&49===e.Aa()&&1195456820===e.T()&&3===e.X()&&(n=e.X(),0!==(64&n)))for(n&=31,e.skip(1),i=0;i<n;i++){var r=e.X(),s=(4&r)>>2,a=e.X(),o=e.X();s&&(r&=3,0===r||1===r?this.h.push({pts:t,type:r,Bb:a,ec:o,order:this.h.length}):(this.g.push({pts:t,type:r,value:a,order:this.g.length}),this.g.push({pts:t,type:2,value:o,order:this.g.length})))}},ty.prototype.decode=function(){function e(e,t){return e.pts-t.pts||e.order-t.order}var t=[];this.h.sort(e),this.g.sort(e);for(var n=d(this.h),i=n.next();!i.done;i=n.next())(i=iy(this,i.value))&&t.push(i);for(n=d(this.g),i=n.next();!i.done;i=n.next())Vv(this.i,i.value);for(n=d(this.i.i),i=n.next();!i.done;i=n.next())i=ry(this,i.value),t.push.apply(t,h(i));return this.i.i=[],this.h=[],this.g=[],t},ty.prototype.getStreams=function(){return Array.from(this.A)},K("shaka.cea.CeaDecoder",ty),Mt=function(){return new ty},oy.prototype.init=function(e){function t(e){e=e.name,fy.has(e)&&(n.g=fy.get(e))}var n=this,i=[],r=[];if((new ks).box("moov",Ls).box("mvex",Ls).R("trex",function(e){var t=e.reader;t.skip(4),t.skip(4),e=t.T(),t=t.T(),n.h=e,n.i=t}).box("trak",Ls).R("tkhd",function(e){var t=e.reader;e=e.version,1==e?(t.skip(8),t.skip(8)):(t.skip(4),t.skip(4));var n=t.T();1==e?t.skip(8):t.skip(4),t.skip(4),t.skip(8),t.skip(2),t.skip(2),t.skip(2),t.skip(2),t.skip(36),t.Aa(),t.Aa(),t.Aa(),t.Aa(),i.push(n)}).box("mdia",Ls).R("mdhd",function(e){e=Wa(e.reader,e.version),r.push(e.timescale)}).box("minf",Ls).box("stbl",Ls).R("stsd",Rs).box("avc1",t).box("avc3",t).box("dvav",t).box("dva1",t).box("hev1",t).box("hvc1",t).box("dvh1",t).box("dvhe",t).box("vvc1",t).box("vvi1",t).box("dvc1",t).box("dvi1",t).box("encv",Cs).box("sinf",Ls).box("frma",function(e){e=za(e.reader).codec,fy.has(e)&&(n.g=fy.get(e))}).parse(e,!0),!i.length||!r.length||i.length!=r.length)throw new Ve(2,2,2010);this.g==ly&&Q("Unable to determine bitstream format for CEA parsing!"),i.forEach(function(e,t){n.j.set(e,r[t])})},oy.prototype.parse=function(e){var t=this;if(this.g==ly)return[];var n=[],i=0,r=[];return(new ks).box("moof",function(e){i=e.start,r=[],Ls(e)}).box("traf",function(e){r.push({baseMediaDecodeTime:null,Jd:t.h,Kd:t.i,ri:[],timescale:9e4}),Ls(e)}).R("trun",function(e){var t=r[r.length-1];e=qa(e.reader,e.version,e.flags),t.ri.push(e)}).R("tfhd",function(e){var n=r[r.length-1];e=Ha(e.reader,e.flags),n.Jd=e.Jd||t.h,n.Kd=e.Kd||t.i,e=e.trackId,t.j.has(e)&&(n.timescale=t.j.get(e))}).R("tfdt",function(e){var t=r[r.length-1];e=Ka(e.reader,e.version),t.baseMediaDecodeTime=e.baseMediaDecodeTime}).box("mdat",function(e){for(var s=i-e.start-8,a=e.reader.Ma(),o=d(r),u=o.next();!u.done;u=o.next())u=u.value,null===u.baseMediaDecodeTime?Q("Unable to find base media decode time for CEA captions!"):(e.reader.seek(a),uy(t,e.reader,u.baseMediaDecodeTime,u.timescale,u.Jd,u.Kd,s,u.ri,n))}).parse(e,!1),n},K("shaka.cea.Mp4CeaParser",oy);var ly=0,cy=1,dy=2,hy=3,fy=(new Map).set("avc1",cy).set("avc3",cy).set("dvav",cy).set("dva1",cy).set("hev1",dy).set("hvc1",dy).set("dvh1",dy).set("dvhe",dy).set("vvc1",hy).set("vvi1",hy).set("dvc1",hy).set("dvi1",hy);function py(){this.g=null}function gy(e){var t=0,n=$e(e),i=n.getUint32(t,!0);if(i!=e.byteLength)return[];e:{for(e=t+6,t=[];e<n.byteLength-1;){i=n.getUint16(e,!0),e+=2;var r=n.getUint16(e,!0);if(e+=2,0!=(1&r)||r+e>n.byteLength){n=[];break e}var s=Be(n,e,r);t.push({type:i,value:s}),e+=r}n=t}return n}function my(e){return e=it(rn(e)),e=gy(e).filter(function(e){return e.type===yy})[0],e?(e=qe(e.value,!0),(e=Qt(e,"WRMHEADER"))?e:null):null}function vy(e){try{var t=my(e);if(t)e:{for(var n=d(an(t,"DATA")),i=n.next();!i.done;i=n.next()){var r=i.value;if(r.children)for(var s=d(r.children),a=s.next();!a.done;a=s.next()){var o=a.value;if("LA_URL"==o.tagName){var u=rn(o);break e}}}u=""}else u="";return u}catch(l){return""}}Rt("video/mp4",function(){return new oy}),py.prototype.init=function(){},py.prototype.parse=function(e){this.g?this.g.clearData():this.g=new Tu;var t=[];if(e=Be(e),!Iu(e))return t;e=this.g.parse(e);var n=e.Md(),i=e.Ve();switch(e=[],n.video){case"avc":e.push(6);break;case"hvc":e.push(39),e.push(40)}if(!e.length)return t;for(n=d(i),i=n.next();!i.done;i=n.next())if(i=i.value,e.includes(i.type)&&null!=i.time)for(var r=d(ay(i.data)),s=r.next();!s.done;s=r.next())t.push({packet:s.value,pts:i.time});return t},K("shaka.cea.TsCeaParser",py),Rt("video/mp2t",function(){return new py});var yy=1;function by(e,t,n){var i=wy(e),r=null;e=[];var s=[],a=null,o=new Set(i.map(function(e){return e.keyId}));o.delete(null);var u="cenc";if(1<o.size)throw new Ve(2,4,4010);if(!t){if(s=i.filter(function(e){return"urn:mpeg:dash:sea:2012"==e.xd}),1<s.length)throw new Ve(2,4,4050);s.length&&(a=xy(s[0])),(s=i.find(function(e){return"urn:mpeg:dash:mp4protection:2011"==e.xd}))&&s.encryptionScheme&&(u=s.encryptionScheme),s=i.filter(function(e){return"urn:mpeg:dash:mp4protection:2011"==e.xd?(r=e.init||r,!1):"urn:mpeg:dash:sea:2012"!=e.xd}),s.length&&(e=Ey(r,u,s,n,o),0==e.length&&(e=[ut("",u,r)]))}if(i.length&&!a&&(t||!s.length))for(e=[],t=d(Object.values(n)),n=t.next();!n.done;n=t.next())n=n.value,"org.w3.clearkey"!=n&&e.push(ut(n,u,r));if(o=Array.from(o)[0]||null)for(u=d(e),t=u.next();!t.done;t=u.next())for(t=d(t.value.initData),n=t.next();!n.done;n=t.next())n.value.keyId=o;return{Lh:o,tm:r,drmInfos:e,Xf:a,Qh:!0}}function Ty(e,t,n,i){var r=by(e,n,i);if(t.Qh)e=1==t.drmInfos.length&&!t.drmInfos[0].keySystem,n=0==r.drmInfos.length,(0==t.drmInfos.length||e&&!n)&&(t.drmInfos=r.drmInfos),t.Qh=!1;else if(0<r.drmInfos.length&&(t.drmInfos=t.drmInfos.filter(function(e){return r.drmInfos.some(function(t){return t.keySystem==e.keySystem})}),0==t.drmInfos.length))throw new Ve(2,4,4008);return r.Lh||t.Lh}function Sy(e){var t=un(e.node,"https://dashif.org/CPS","Laurl");if(t&&(t=rn(t)))return t;if((t=un(e.node,"urn:microsoft:playready","pro"))&&rn(t))return vy(t);if((e=un(e.node,"urn:mpeg:cenc:2013","pssh"))&&(e=rn(e))){t=it(e),e=8,t=$e(t);var n=t.getUint8(e);return e+=20,0<n&&(e+=4+16*t.getUint32(e)),e=Be(t,e+4),e=tt(e),e=Qt("<pro>"+e+"</pro>"),vy(e)}return""}function Ey(e,t,n,i,r){var s=[];n=d(n);for(var a=n.next();!a.done;a=n.next()){a=a.value;var o=i[a.xd];if(o){var u;if((u=un(a.node,"urn:microsoft:playready","pro"))&&rn(u)){u=rn(u),u=it(u);var l=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);u=[{initData:Bs(u,l,new Set,0),initDataType:"cenc",keyId:a.keyId}]}else u=null;if(l=null,"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e"===a.xd){l=a;var c=r;if(0==c.size)l=null;else{var h=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]),f=new Uint8Array([]);l=[{initData:Bs(f,h,c,1),initDataType:"cenc",keyId:l.keyId}]}}u=ut(o,t,a.init||e||u||l),(o=Iy.get(o))&&(u.licenseServerUri=o(a)),s.push(u)}}return s}function wy(e){var t=[];e=d(e);for(var n=e.next();!n.done;n=e.next())(n=Ay(n.value))&&t.push(n);return t}function Ay(e){var t=e.attributes.schemeIdUri,n=cn(e,"urn:mpeg:cenc:2013","default_KID"),i=dn(e,"urn:mpeg:cenc:2013","pssh").map(sn),r=e.attributes.value;if(!t)return null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase(),n.includes(" ")))throw new Ve(2,4,4009);var s=[];try{s=i.map(function(e){return{initDataType:"cenc",initData:it(e),keyId:null}})}catch(a){throw new Ve(2,4,4007)}return{node:e,xd:t,keyId:n,init:0<s.length?s:null,encryptionScheme:r}}function xy(t){if(!e.crypto||!e.crypto.subtle)throw Q("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new Ve(2,4,4042);var n=un(t.node,"urn:mpeg:dash:schema:sea:2012","SegmentEncryption");if(!n)throw new Ve(2,4,4051);if("urn:mpeg:dash:sea:aes128-cbc:2013"!=n.attributes.schemeIdUri)throw new Ve(2,4,4051);if(n=un(t.node,"urn:mpeg:dash:schema:sea:2012","CryptoPeriod"),!n)throw new Ve(2,4,4051);if(t=n.attributes.IV,n=Je(n.attributes.keyUriTemplate),!t||!n)throw new Ve(2,4,4051);if(t=rt(t.substr(2)),16!=t.byteLength)throw new Ve(2,4,4048);return{ik:n,iv:t}}var Iy=(new Map).set("com.apple.fps",function(t){if("apple"===e.shakaMediaKeysPolyfill)throw new Ve(2,4,4054);return(t=un(t.node,"https://dashif.org/CPS","Laurl"))&&(t=rn(t))?t:""}).set("com.widevine.alpha",function(e){var t=un(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=rn(t))?t:(e=un(e.node,"urn:microsoft","laurl"))&&Je(e.attributes.licenseUrl)||""}).set("com.microsoft.playready",Sy).set("com.microsoft.playready.recommendation",Sy).set("com.microsoft.playready.software",Sy).set("com.microsoft.playready.hardware",Sy).set("org.w3.clearkey",function(e){var t=un(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=rn(t))?t:(e=un(e.node,"http://dashif.org/guidelines/clearKey","Laurl"))&&"EME-1.0"===e.attributes.Lic_type&&e&&(e=rn(e))?e:""});function ky(t,n,i,r,s,a){var o=(new Map).set("RepresentationID",n).set("Number",i).set("SubNumber",r).set("Bandwidth",s).set("Time",a);return t.replace(/\$(RepresentationID|Number|SubNumber|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(t,n,i,r){if("$$"==t)return"$";var s=o.get(n);if(null==s)return t;switch("RepresentationID"==n&&i&&(i=void 0),"Time"==n&&"bigint"!=typeof s&&(.2<=Math.abs(s-Math.round(s))&&Q("Calculated $Time$ values must be close to integers"),s=Math.round(s)),r){case void 0:case"d":case"i":case"u":t=s.toString();break;case"o":t=s.toString(8);break;case"x":t=s.toString(16);break;case"X":t=s.toString(16).toUpperCase();break;default:t=s.toString()}return i=e.parseInt(i,10)||1,Array(Math.max(0,i-t.length)+1).join("0")+t})}function Ly(e,t){var n=Cy(e,t,"timescale"),i=1;n&&(i=vn(n)||1),n=Cy(e,t,"duration");var r=(n=vn(n||""))?n/i:null,s=Cy(e,t,"startNumber"),a=Number(Cy(e,t,"presentationTimeOffset"))||0,o=yn(s||"");if(null!=s&&null!=o||(o=1),s=null,t=Dy(e,t,"SegmentTimeline")){t=nn(t,"S"),s=i,e=e.na.duration||1/0;for(var u=o,l=[],c=-a,d=0;d<t.length;++d){var h=t[d],f=t[d+1],p=ln(h,"t",yn),g=ln(h,"d",yn),m=ln(h,"r",mn);if(h=ln(h,"k",mn)||0,null!=p&&(p-=a),g){if(p=null!=p?p:c,m=m||0,0>m)if(f){if(f=ln(f,"t",yn),null==f)break;if(p>=f)break;m=Math.ceil((f-p)/g)-1}else{if(1/0==e)break;if(p/s>=e)break;m=Math.ceil((e*s-p)/g)-1}for(0<l.length&&p!=c&&(l[l.length-1].end=p/s),f=0;f<=m;++f)c=p+g,l.push({start:p/s,end:c/s,xh:p,Zb:h,Lk:l.length+u}),p=c}}s=l}return{timescale:i,Ff:n,gb:r,fe:o,$b:a/i||0,wh:a,timeline:s}}function Ry(e,t){return[t(e.J),t(e.ma),t(e.ra)].filter(Ui)}function Cy(e,t,n){t=Ry(e,t),e=null,t=d(t);for(var i=t.next();!i.done&&!(e=i.value.attributes[n]);i=t.next());return e}function Dy(e,t,n){t=Ry(e,t),e=null,t=d(t);for(var i=t.next();!i.done&&!(e=on(i.value,n));i=t.next());return e}function My(e,t,n,i,r,s){for(var a=cn(e,"http://www.w3.org/1999/xlink","href"),o=cn(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",u=d(Object.keys(e.attributes)),l=u.next();!l.done;l=u.next()){l=l.value;var c=l.split(":"),h=Jt("http://www.w3.org/1999/xlink");c[0]==h&&delete e.attributes[l]}if(5<=s)return qr(new Ve(2,4,4028));if("onLoad"!=o)return qr(new Ve(2,4,4027));var f=ot([i],[a]);return r.request(0,us(f,t)).Ua(function(i){if(i=Xt(i.data,e.tagName),!i)return qr(new Ve(2,4,4001,a));for(e.children=[];i.children.length;){var o=i.children.shift();e.children.push(o)}o=d(Object.keys(i.attributes));for(var u=o.next();!u.done;u=o.next())u=u.value,e.attributes[u]=i.attributes[u];return Py(e,t,n,f[0],r,s+1)})}function Py(e,t,n,i,r,s){if(s=void 0===s?0:s,cn(e,"http://www.w3.org/1999/xlink","href")){var a=My(e,t,n,i,r,s);return n&&(a=a.Ua(void 0,function(){return Py(e,t,n,i,r,s)})),a}a=[];for(var o=d(tn(e)),u=o.next(),l={};!u.done;l={Gd:void 0},u=o.next())l.Gd=u.value,"urn:mpeg:dash:resolve-to-zero:2013"==cn(l.Gd,"http://www.w3.org/1999/xlink","href")?e.children=e.children.filter(function(e){return function(t){return t!==e.Gd}}(l)):"SegmentTimeline"!=l.Gd.tagName&&a.push(Py(l.Gd,t,n,i,r,s));return Qr(a).Ua(function(){return e})}function _y(e,t,n,i,r,s,a){var o,u=(new ks).R("sidx",function(e){o=Oy(t,i,r,s,a,n,e)});if(e&&u.parse(e),o)return o;throw new Ve(2,3,3004)}function Oy(e,t,n,i,r,s,a){var o=[];a.reader.skip(4);var u=a.reader.T();if(0==u)throw new Ve(2,3,3005);if(0==a.version)var l=a.reader.T(),c=a.reader.T();else l=a.reader.vd(),c=a.reader.vd();a.reader.skip(2);var d=a.reader.Aa();for(e=e+a.size+c,c=0;c<d;c++){var h=a.reader.T(),f=(2147483648&h)>>>31;h&=2147483647;var p=a.reader.T();if(a.reader.skip(4),1==f)throw new Ve(2,3,3006);o.push(new No(l/u+n,(l+p)/u+n,function(){return s},e,e+h-1,t,n,i,r)),l+=p,e+=h}return a.parser.stop(),o}function Ny(e){this.h=$e(e),this.g=new As(this.h,0)}function Uy(e){var t=Fy(e);if(7<t.length)throw new Ve(2,3,3002);var n=0;t=d(t);for(var i=t.next();!i.done;i=t.next())n=256*n+i.value;t=Fy(e);e:{i=d(By);for(var r=i.next();!r.done;r=i.next())if(Ue(t,new Uint8Array(r.value))){i=!0;break e}i=!1}if(i)t=e.h.byteLength-e.g.Ma();else{if(8==t.length&&224&t[1])throw new Ve(2,3,3001);for(r=i=0;r<t.length;r++){var s=t[r];i=0==r?s&(1<<8-t.length)-1:256*i+s}t=i}return t=e.g.Ma()+t<=e.h.byteLength?t:e.h.byteLength-e.g.Ma(),i=$e(e.h,e.g.Ma(),t),e.g.skip(t),new jy(n,i)}function Fy(e){var t=e.g.Ma(),n=e.g.X();if(0==n)throw new Ve(2,3,3002);return n=8-Math.floor(Math.log2(n)),e.g.skip(n-1),Be(e.h,t,n)}Ny.prototype.Fa=function(){return this.g.Fa()};var By=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function jy(e,t){this.id=e,this.g=t}function $y(e){if(8<e.g.byteLength)throw new Ve(2,3,3002);if(8==e.g.byteLength&&224&e.g.getUint8(0))throw new Ve(2,3,3001);for(var t=0,n=0;n<e.g.byteLength;n++){var i=e.g.getUint8(n);t=256*t+i}return t}function Gy(e,t,n,i,r,s,a,o,u){function l(){return r}var c=[];e=new Ny(e.g);for(var d=null,h=null;e.Fa();){var f=Uy(e);if(187==f.id){var p=Vy(f);p&&(f=n*p.Zk,p=t+p.Dk,null!=d&&c.push(new No(d+a,f+a,l,h,p-1,s,a,o,u)),d=f,h=p)}}return null!=d&&c.push(new No(d+a,i+a,l,h,null,s,a,o,u)),c}function Vy(e){var t=new Ny(e.g);if(e=Uy(t),179!=e.id)throw new Ve(2,3,3013);if(e=$y(e),t=Uy(t),183!=t.id)throw new Ve(2,3,3012);t=new Ny(t.g);for(var n=0;t.Fa();){var i=Uy(t);if(241==i.id){n=$y(i);break}}return{Zk:e,Dk:n}}function Hy(e,t,n){if(t=Dy(e,t,"Initialization"),!t)return null;var i=e.J.cb(),r=t.attributes.sourceURL;r&&(i=ot(i,[Je(r)],e.Jb())),r=0;var s=null;return(t=ln(t,"range",gn))&&(r=t.start,s=t.end),n=new _o(function(){return i},r,s,Qy(e),null,null,n,e.ma.encrypted),n.codecs=e.J.codecs,n.mimeType=e.J.mimeType,e.na&&(n.g=e.na.start+e.na.duration),n}function Ky(e,t,n){var i=Number(Cy(e,qy,"presentationTimeOffset"))||0,r=Cy(e,qy,"timescale"),s=1;r&&(s=vn(r)||1);var a=i/s||0,o=Hy(e,qy,n);zy(e,o);var u=Yt(e);return{endTime:-1,timeline:-1,Nc:function(){var e=Dy(u,qy,"RepresentationIndex"),n=u.J.cb();return e&&(e=Je(e.attributes.sourceURL))&&(n=ot(n,[e],u.Jb())),e=Yy(u),Wy(u,t,o,n,e.start,e.end,a)},timescale:s}}function Wy(e,t,n,i,r,s,a){var o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,A,x,I;return U(function(k){if(1==k.g)return o=e.presentationTimeline,u=!e.ic||!e.na.bi,l=e.na.start,c=e.na.duration,h=e.J.mimeType.split("/")[1],f=t,p=null,g=[f(i,r,s,!1),"webm"==h?f(n.O(),n.startByte,n.endByte,!0):null],f=null,w(k,Promise.all(g),2);if(m=k.h,v=m[0],y=m[1]||null,b=null,T=l-a,S=l,E=c?l+c:1/0,"mp4"==h)var L=_y(v,r,i,n,T,S,E);else{L=v;var R=new Ny(y);if(440786851!=Uy(R).id)throw new Ve(2,3,3008);var C=Uy(R);if(408125543!=C.id)throw new Ve(2,3,3009);R=C.g.byteOffset,C=new Ny(C.g);for(var D=null;C.Fa();){var M=Uy(C);if(357149030==M.id){D=M;break}}if(!D)throw new Ve(2,3,3010);for(D=new Ny(D.g),M=1e6,C=null;D.Fa();){var P=Uy(D);if(2807729==P.id)M=$y(P);else if(17545==P.id)if(4==P.g.byteLength)C=P.g.getFloat32(0);else{if(8!=P.g.byteLength)throw new Ve(2,3,3003);C=P.g.getFloat64(0)}}if(null==C)throw new Ve(2,3,3011);if(D=M/1e9,C*=D,L=Uy(new Ny(L)),475249515!=L.id)throw new Ve(2,3,3007);L=Gy(L,R,D,C,i,n,T,S,E)}for(b=L,A=d(b),x=A.next();!x.done;x=A.next())I=x.value,I.codecs=e.J.codecs,I.mimeType=e.J.mimeType,I.bandwidth=e.bandwidth;return o.Yd(b),p=new Kl(b),u&&p.hd(S,E,!0),k.return(p)})}function qy(e){return e.yd}function Yy(e){var t=Dy(e,qy,"RepresentationIndex");return e=Cy(e,qy,"indexRange"),e=gn(e||""),t&&(e=ln(t,"range",gn,e)),e}function zy(e,t){if(Xy(e,t),!Yy(e))throw new Ve(2,4,4002)}function Xy(e,t){var n=e.J.mimeType.split("/")[1];if(e.J.contentType!=ft&&"mp4"!=n&&"webm"!=n)throw new Ve(2,4,4006);if("webm"==n&&!t)throw new Ve(2,4,4005)}function Qy(e){var t=e.J;return{bandwidth:e.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate||null,height:t.height||null,mimeType:t.mimeType,channelsCount:t.mf,pixelAspectRatio:t.pixelAspectRatio||null,width:t.width||null,label:e.ma.label||null,roles:e.roles||null,language:e.ma.language||null}}function Jy(e,t,n){var i=Hy(e,Zy,n),r=eb(e);if(!r.gb&&!r.timeline&&1<r.pd.length)throw new Ve(2,4,4002);if(!r.gb&&!e.na.duration&&!r.timeline&&1==r.pd.length)throw new Ve(2,4,4002);if(r.timeline&&0==r.timeline.length)throw new Ve(2,4,4002);var s=null,a=null;e.ra.id&&e.J.id&&(a=t.get(e.ra.id+","+e.J.id))&&(s=a.segmentIndex);var o=tb(e.na.start,e.na.duration,e.J.cb,r,i,n,e.J.mimeType,e.J.codecs,e.bandwidth,e.Jb);return t=!s,s?s.Wd(o,e.presentationTimeline.Fb()):s=new Kl(o),e.presentationTimeline.Yd(o),e.ic&&e.na.bi||s.hd(e.na.start,e.na.duration?e.na.start+e.na.duration:1/0,t),a&&(a.segmentIndex=s),{endTime:-1,timeline:-1,Nc:function(){return s&&0!=s.getNumReferences()||s.gf(o),Promise.resolve(s)},timescale:r.timescale}}function Zy(e){return e.sc}function eb(e){var t=nb(e);e=Ly(e,Zy);var n=e.fe;0==n&&(n=1);var i=0;return e.gb?i=e.gb*(n-1):e.timeline&&0<e.timeline.length&&(i=e.timeline[0].start),{gb:e.gb,startTime:i,fe:n,$b:e.$b,timescale:e.timescale,timeline:e.timeline,pd:t}}function tb(e,t,n,i,r,s,a,o,u,l){var c=i.pd.length;i.timeline&&i.timeline.length!=i.pd.length&&(c=Math.min(i.timeline.length,i.pd.length));for(var d=e-i.$b,h=t?e+t:1/0,f=[],p=i.startTime,g={},m=0;m<c;g={Hf:void 0,zf:void 0},m++){g.zf=i.pd[m];var v=p;p=void 0,p=null!=i.gb?v+i.gb:i.timeline?i.timeline[m].end:v+t,g.Hf=null,g=new No(e+v,e+p,function(e){return function(){return null==e.Hf&&(e.Hf=ot(n(),[e.zf.qk],l())),e.Hf}}(g),g.zf.start,g.zf.end,r,d,e,h,[],"",null,null,Fo,s),g.codecs=o,g.mimeType=a,g.bandwidth=u,f.push(g)}return f}function nb(e){return[e.J.sc,e.ma.sc,e.ra.sc].filter(Ui).map(function(e){return nn(e,"SegmentURL")}).reduce(function(e,t){return 0<e.length?e:t}).map(function(t){t.attributes.indexRange&&!e.Eg&&(e.Eg=!0);var n=Je(t.attributes.media);return t=ln(t,"mediaRange",gn,{start:0,end:null}),{qk:n,start:t.start,end:t.end}})}function ib(e,t,n,i,r,s,a,o,u,l){u||e.J.Xe||(e.J.Xe=Cy(e,rb,"initialization"));var c=e.J.Xe?ub(e,a):null,h=sb(e);ab(h);var f=Yt(e);if(h.Td)return Xy(e,c),{endTime:-1,timeline:-1,Nc:function(){var e=ky(h.Td,f.J.originalId,null,null,f.bandwidth||null,null);return e=ot(f.J.cb(),[e]),Wy(f,t,c,e,0,null,h.$b)},timescale:h.timescale};if(h.gb)return i||"image"===e.ma.contentType||"text"===e.ma.contentType||(i=e.na.start,l=e.ra.id,n=e.na.duration,l=(l=null!=l&&s.get(l)||n)?i+l:1/0,e.presentationTimeline.Mg(h.gb),e.presentationTimeline.oi(i,l)),{endTime:-1,timeline:-1,Nc:function(){return ob(f,h,r,c,s,a,o,e.J.Af)},timescale:h.timescale};var p=null;i=i=null,e.ra.id&&e.J.id&&(i=e.ra.id+","+e.J.id,i=n.get(i))&&(p=i.segmentIndex);var g=e.na.start,m=e.na.duration?g+e.na.duration:1/0;if(p)l=p,cb(l,h,g,m,c),l.$a(e.presentationTimeline.Fb());else{if(n=0,u=-1,null!=e.ra.id&&null!=e.J.id){var v=l.get(e.ra.id);if(v)u=v.timeline;else for(l=d(l.values()),v=l.next();!v.done;v=l.next()){if(v=v.value,Math.abs(h.$b-v.endTime)<=gt&&v.Wg.includes(e.J.id)){u=v.timeline;break}v.timeline>=n&&(n=v.timeline+1)}}-1==u&&(u=n),p=new lb(h,e.J.originalId,e.bandwidth,e.J.cb,e.Jb,g,m,c,a,e.J.Af,u)}return h.timeline&&"image"!==e.ma.contentType&&"text"!==e.ma.contentType&&e.presentationTimeline.pi(p.h?p.h.timeline:[],g),i&&e.ic&&(i.segmentIndex=p),i=(i=(i=h.timeline)&&i[i.length-1])?i.end+h.$b:-1,l=-1,p instanceof lb&&(l=p.Ne()),{endTime:i,timeline:l,Nc:function(){return p instanceof lb&&0==p.getNumReferences()&&cb(p,h,g,m,c),Promise.resolve(p)},timescale:h.timescale}}function rb(e){return e.Fc}function sb(e){var t=Ly(e,rb),n=Cy(e,rb,"media"),i=Cy(e,rb,"index"),r=Cy(e,rb,"k"),s=0;return r&&(s=parseInt(r,10)),{Ff:t.Ff,gb:t.gb,timescale:t.timescale,fe:t.fe,$b:t.$b,wh:t.wh,timeline:t.timeline,Dc:n&&Je(n),Td:i,mimeType:e.J.mimeType,codecs:e.J.codecs,bandwidth:e.bandwidth,rk:s}}function ab(e){var t=e.Td?1:0;if(t+=e.timeline?1:0,t+=e.gb?1:0,0==t)throw new Ve(2,4,4002);if(1!=t&&(e.Td&&(e.timeline=null),e.Ff=null,e.gb=null),!e.Td&&!e.Dc)throw new Ve(2,4,4002)}function ob(t,n,i,r,s,a,o,u){function l(i){var s=i-y,o=s*v,l=n.Ff,c=s*l;"BigInt"in e&&c>Number.MAX_SAFE_INTEGER&&(c=BigInt(s)*BigInt(l)),o+=p,s=o+v,l=Math.min(s,h());var d=[],f=n.rk;if(f)for(var g=(l-o)/f,m={},x=0;x<f;m={Pi:void 0},x++){var I=o+g*x,k=I+g;m.Pi=x+1,m=new No(I,k,function(e){return function(){var t=ky(b,S,i,e.Pi,T,c);return ot(E(),[t],w())}}(m),0,null,r,A,p,h(),[],"",null,null,Fo,a),m.codecs=t.J.codecs,m.mimeType=t.J.mimeType,0==u?0<x&&m.nd():0!=x%u&&m.nd(),d.push(m)}return o=new No(o,l,function(){if(f)return[];var e=ky(b,S,i,null,T,c);return ot(E(),[e],w())},0,null,r,A,p,h(),d,"",null,null,Fo,a,0<d.length),o.codecs=t.J.codecs,o.mimeType=t.J.mimeType,o.bandwidth=t.bandwidth,o.j=s,o}function c(){var e=[Math.max(f.Fb(),p),Math.min(f.yc(),h())].map(function(e){return e-p});return e=[Math.ceil(e[0]/v),Math.ceil(e[1]/v)-1],t.J.pb&&e[1]++,e.map(function(e){return e+y})}function h(){var e=null!=g&&s.get(g)||m;return e?p+e:1/0}var f=t.presentationTimeline,p=t.na.start,g=t.ra.id,m=t.na.duration,v=n.gb,y=n.fe,b=n.Dc,T=t.bandwidth||null,S=t.J.id,E=t.J.cb,w=t.Jb,A=p-n.$b,x=c();i=t.ic?Math.max(x[0],x[1]-i+1):x[0],o=o||x[1],x=[];for(var I=i;I<=o;++I){var k=l(I);x.push(k)}var L=new Kl(x);if(x=f.yc()<h(),I=f.V(),x||I){var R=Math.max(i,o+1);i=v,t.J.pb&&(i=.1),L.Gf(i,function(){var e=f.Fb();L.$a(e);var t=d(c());t.next(),t=t.next().value;for(var n=[];R<=t;){var i=l(R);n.push(i),R++}return e>h()&&!n.length?null:n})}return Promise.resolve(L)}function ub(e,t){var n=e.J.Xe;if(n||(n=Cy(e,rb,"initialization")),!n)return null;n=Je(n);var i=e.J.originalId,r=e.bandwidth||null,s=e.J.cb,a=e.Jb;return t=new _o(function(){var e=ky(n,i,null,null,r,null);return ot(s(),[e],a())},0,null,Qy(e),null,null,t,e.ma.encrypted),t.codecs=e.J.codecs,t.mimeType=e.J.mimeType,e.na&&(t.g=e.na.start+e.na.duration),t}function lb(e,t,n,i,r,s,a,o,u,l,c){Kl.call(this,[]),this.h=e,this.F=t,this.B=n,this.C=i,this.H=r,this.j=s,this.l=a,this.s=o,this.A=u,this.G=l,this.I=c,hb(this)}function cb(e,t,n,i,r){if(db(e,r),e.h){if(n=e.h.timeline,e.h.Dc!==t.Dc&&(e.h.Dc=t.Dc),n.length){var s=n[n.length-1];t=t.timeline.filter(function(e){return e.end>s.end})}else t=t.timeline.slice();0<t.length&&e.h.timeline.push.apply(e.h.timeline,h(t)),e.l!==i&&(e.l=i)}else e.h=t,e.j=n,e.l=i;hb(e)}function db(e,t){if(e.s!==t){e.s=t,e=d(e.g);for(var n=e.next();!n.done;n=e.next())(n=n.value)&&Uo(n,t)}}function hb(e){if(e.h&&!e.o){for(var t=[],n=d(e.h.timeline),i=n.next();!i.done;i=n.next())i=i.value,i.start>=e.l||0>=i.end||t.push(i);e.h.timeline=t,e.$a(e.j)}}function fb(e,t,n,i,r,s,a,o){return e=ky(e,t,n,s,i||null,r),ot(a(),[e],o()).map(function(e){return e.toString()})}function pb(e){this.o=null,this.A=e,this.G=new is,this.i=[],this.h=null,this.m=[],this.B=null,this.F=[],this.C=300,this.l=new Map,this.j=new Map,this.g=null,this.s="UNKNOWN"}function gb(e,t){var n,i,r,s,a,o,u;return U(function(l){return 1==l.g?(n=ot(e.i,[mb(e,t)]),i=us(n,e.o.retryParameters),r=e.A.networkingEngine.request(8,i),rs(e.G,r),x(l,2),w(l,r.promise,4)):2!=l.g?(s=l.h,a=We(s.data),o=JSON.parse(a),1==o.VERSION&&vb(e,o,s.uri),k(l,0)):(u=L(l))&&7001==u.code?l.return():(null!=e.g&&(e.g.stop(),e.g=null),e.g=new _i(function(){gb(e,t)}),e.g.ha(e.C),void A(l))})}function mb(e,t){if(!e.m.length)return t;t=new Te(t);var n=e.B||e.m[0],i=Math.round(e.A.getBandwidthEstimate()),r=t.g;return"DASH"==e.s?(r.add("_DASH_pathway",n),r.add("_DASH_throughput",String(i))):"HLS"==e.s&&(r.add("_HLS_pathway",n),r.add("_HLS_throughput",String(i))),Oe(r)&&Ae(t,r),t.toString()}function vb(e,t,n){null!=e.g&&(e.g.stop(),e.g=null);var i=t["RELOAD-URI"]||n;e.g=new _i(function(){gb(e,i)}),(n=t.TTL)&&(e.C=n),e.g.ha(e.C),e.m=t["PATHWAY-PRIORITY"]||[],e.F=t["PATHWAY-CLONES"]||[]}function yb(e,t,n,i){var r=e.l.get(t);r||(r=new Map),r.set(n,i),e.l.set(t,r)}function bb(e,t,n){n=void 0!==n&&n,t=e.l.get(t)||new Map;for(var i=[],r=d(e.m),s=r.next(),a={};!s.done;a={rd:void 0},s=r.next())if(a.rd=s.value,s=t.get(a.rd))i.push({Rg:a.rd,location:s});else if(s=e.F.find(function(e){return function(t){return t.Fl==e.rd}}(a))){var o=t.get(s["BASE-ID"]);o&&(s["URI-REPLACEMENT"].$i?(o=new Te(o),Ee(o,s["URI-REPLACEMENT"].$i),i.push({Rg:a.rd,location:o.toString()})):i.push({Rg:a.rd,location:o}))}for(r=Date.now(),a=d(e.j.keys()),s=a.next();!s.done;s=a.next())s=s.value,o=e.j.get(s),r>o&&e.j.delete(s);if(i=i.filter(function(t){for(var n=d(e.j.keys()),i=n.next();!i.done;i=n.next())if(i.value.includes(new Te(t.location).Cb))return!1;return!0}),i.length&&(e.B=i[0].Rg),i=i.map(function(e){return e.location}),!i.length&&e.h)for(r=d(e.h.split(",")),a=r.next();!a.done;a=r.next())(a=t.get(a.value))&&(e.B=e.h,i.push(a));if(!i.length)for(t=d(t.values()),r=t.next();!r.done;r=t.next())i.push(r.value);return n?i:ot(e.i,i)}function Tb(){this.l=[],this.h=[],this.g=[],this.j=[],this.i=[],this.s=this.o=!1,this.m=new Set}function Sb(e,t){var n=[],i=[],r=[],s=[];e=d(e);for(var a=e.next();!a.done;a=e.next()){var o=a.value;a=new Map(o.audioStreams.map(function(e){return[Yb(e),e]}));var u=new Map(o.videoStreams.map(function(e){return[qb(e),e]})),l=new Map(o.textStreams.map(function(e){return[zb(e),e]}));if(o=new Map(o.imageStreams.map(function(e){return[Xb(e),e]})),t){var c=Vb(ft);l.set(zb(c),c),c=Vb("image"),o.set(Xb(c),c)}n.push(a),i.push(u),r.push(l),s.push(o)}return{Fh:n,Yi:i,Vi:r,Zh:s}}function Eb(e){var t,n,i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,A,x,I,k,L,R,C,D,M;return U(function(P){switch(P.g){case 1:if(t=pt,1==e.length)return P.return(e[0]);for(n=e.map(function(e){return new Map(e.filter(function(e){return e.type===t.ea}).map(function(e){return[Yb(e),e]}))}),i=e.map(function(e){return new Map(e.filter(function(e){return e.type===t.xa}).map(function(e){return[qb(e),e]}))}),r=e.map(function(e){return new Map(e.filter(function(e){return e.type===t.Ya}).map(function(e){return[zb(e),e]}))}),s=e.map(function(e){return new Map(e.filter(function(e){return e.type===t.Of}).map(function(e){return[Xb(e),e]}))}),a=d(r),o=a.next();!o.done;o=a.next())u=o.value,l=Gb(t.Ya),u.set(zb(l),l);for(c=d(s),h=c.next();!h.done;h=c.next())f=h.value,p=Gb(t.Of),f.set(Xb(p),p);return g=new Tb,w(P,wb(g,[],n,0,Rb,Db,0),2);case 2:return m=P.h,w(P,wb(g,[],i,0,Rb,Db,0),3);case 3:return v=P.h,w(P,wb(g,[],r,0,Rb,Db,0),4);case 4:return y=P.h,w(P,wb(g,[],s,0,Rb,Db,0),5);case 5:if(b=P.h,T=0,v.length&&m.length)for(I=d(m),k=I.next();!k.done;k=I.next())for(L=k.value,R=d(v),C=R.next();!C.done;C=R.next())D=C.value,M=T++,D.variantIds.push(M),L.variantIds.push(M);else for(S=v.concat(m),E=d(S),A=E.next();!A.done;A=E.next())x=A.value,x.variantIds=[T++];return P.return(v.concat(m).concat(y).concat(b))}})}function wb(e,t,n,i,r,s,a){var o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,A,x,I,k;return U(function(L){switch(L.g){case 1:for(o=[],u=0;u<n.length;u++)u>=i?o.push(new Set(n[u].values())):o.push(new Set);l=d(t),c=l.next();case 2:if(c.done){L.u(4);break}return h=c.value,w(L,Ab(e,h,n,i,s,o,a),5);case 5:if(f=L.h,!f)throw new Ve(2,4,4037);c=l.next(),L.u(2);break;case 4:for(p=d(o),g=p.next();!g.done;g=p.next())for(m=g.value,v=d(m),y=v.next();!y.done;y=v.next())b=y.value,(T=Ib(e,b,n,r,s,o))&&t.push(T);for(S=d(o),E=S.next();!E.done;E=S.next())for(A=E.value,x=d(A),I=x.next(),k={};!I.done;k={lh:void 0},I=x.next())if(k.lh=I.value,!Wb(k.lh)&&t.some(function(t){return function(n){return Ob(e,t.lh,n)}}(k)))throw new Ve(2,4,4037);return L.return(t)}})}function Ab(e,t,n,i,r,s,a){return U(function(o){return 1==o.g?(Mb(e,n,t,0<a),t.matchedStreams?t.segmentIndex?w(o,xb(t,i+a),2):o.u(2):o.return(!1)):(kb(t,i,r,s,a),o.return(!0))})}function xb(e,t){var n,i,r,s,a,o;return U(function(u){if(1==u.g){for(n=[],i=e.matchedStreams,r=t;r<i.length;r++)s=i[r],n.push(s.createSegmentIndex()),s.trickModeVideo&&!s.trickModeVideo.segmentIndex&&n.push(s.trickModeVideo.createSegmentIndex()),s.dependencyStream&&!s.dependencyStream.segmentIndex&&n.push(s.dependencyStream.createSegmentIndex());return w(u,Promise.all(n),2)}if(e.segmentIndex instanceof zl)for(a=t;a<i.length;a++)o=i[a],o.segmentIndex&&e.segmentIndex.h.push(o.segmentIndex);A(u)})}function Ib(e,t,n,i,r,s){if(Wb(t))return null;var a=i(t);return Mb(e,n,a),a.createSegmentIndex&&(a.createSegmentIndex=function(){return U(function(e){return a.segmentIndex?e.u(0):(a.segmentIndex=new zl,w(e,xb(a,0),0))})}),a.matchedStreams&&a.matchedStreams.length?(kb(a,0,r,s,0),a):null}function kb(e,t,n,i,r){var s=e.matchedStreams;for(t+=r;t<s.length;t++){var a=s[t];n(e,a);var o=!0;if("audio"==e.type&&0==Hi(e.language,a.language)&&(o=!1),o&&(i[t-r].delete(a),a.fullMimeTypes))for(a=d(a.fullMimeTypes.values()),o=a.next();!o.done;o=a.next())e.fullMimeTypes.add(o.value)}}function Lb(e){var t=Object.assign({},e);return t.originalId=null,t.createSegmentIndex=function(){return Promise.resolve()},t.closeSegmentIndex=function(){if(t.segmentIndex&&(t.segmentIndex.release(),t.segmentIndex=null),t.matchedStreams)for(var e=d(t.matchedStreams),n=e.next();!n.done;n=e.next())n=n.value,n.segmentIndex&&(n.segmentIndex.release(),n.segmentIndex=null)},t.roles=t.roles.slice(),t.segmentIndex=null,t.emsgSchemeIdUris=[],t.keyIds=new Set(e.keyIds),t.closedCaptions=e.closedCaptions?new Map(e.closedCaptions):null,t.trickModeVideo=null,t.dependencyStream=null,t}function Rb(e){var t=Object.assign({},e);return t.roles=t.roles.slice(),t.keyIds=new Set(e.keyIds),t.segments=[],t.variantIds=[],t.closedCaptions=e.closedCaptions?new Map(e.closedCaptions):null,t}function Cb(e,t){function n(e,t){e||(e=[]),t=d(t);for(var n=t.next();!n.done;n=t.next())n=n.value,e.includes(n)||e.push(n);return e}e.roles=n(e.roles,t.roles),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=n(e.emsgSchemeIdUris,t.emsgSchemeIdUris));for(var i=d(t.keyIds),r=i.next();!r.done;r=i.next())e.keyIds.add(r.value);if(null==e.originalId?e.originalId=t.originalId:(i=t.originalId||"")&&!e.originalId.endsWith(i)&&(e.originalId+=","+i),i=Nr(e.drmInfos,t.drmInfos),t.drmInfos.length&&e.drmInfos.length&&!i.length)throw new Ve(2,4,4038);if(e.drmInfos=i,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),i=d(t.closedCaptions),r=i.next();!r.done;r=i.next()){var s=d(r.value);r=s.next().value,s=s.next().value,e.closedCaptions.set(r,s)}e.bandwidth&&t.bandwidth&&(e.bandwidth=Math.max(e.bandwidth,t.bandwidth)),t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=Lb(t.trickModeVideo),e.trickModeVideo.matchedStreams=[],e.trickModeVideo.createSegmentIndex=function(){if(e.trickModeVideo.segmentIndex)return Promise.resolve();for(var t=new zl,n=d(e.trickModeVideo.matchedStreams),i=n.next();!i.done;i=n.next())t.h.push(i.value.segmentIndex);return e.trickModeVideo.segmentIndex=t,Promise.resolve()}),e.trickModeVideo.matchedStreams.push(t.trickModeVideo),Cb(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&(e.trickModeVideo.matchedStreams.push(t),Cb(e.trickModeVideo,t)),t.dependencyStream?(e.dependencyStream||(e.dependencyStream=Lb(t.dependencyStream),e.dependencyStream.matchedStreams=[],e.dependencyStream.createSegmentIndex=function(){if(e.dependencyStream.segmentIndex)return Promise.resolve();for(var t=new zl,n=d(e.dependencyStream.matchedStreams),i=n.next();!i.done;i=n.next())t.h.push(i.value.segmentIndex);return e.dependencyStream.segmentIndex=t,Promise.resolve()}),e.dependencyStream.matchedStreams.push(t.dependencyStream),Cb(e.dependencyStream,t.dependencyStream)):e.dependencyStream&&(e.dependencyStream.matchedStreams.push(t),Cb(e.dependencyStream,t))}function Db(e,t){var n=e.roles;n||(n=[]);for(var i=d(t.roles),r=i.next();!r.done;r=i.next())r=r.value,n.includes(r)||n.push(r);for(e.roles=n,n=d(t.keyIds),i=n.next();!i.done;i=n.next())e.keyIds.add(i.value);if(e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,h(t.segments)),t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),t=d(t.closedCaptions),n=t.next();!n.done;n=t.next())i=d(n.value),n=i.next().value,i=i.next().value,e.closedCaptions.set(n,i)}function Mb(e,t,n,i){i=void 0!==i&&i?n.matchedStreams:[],t=d(t);for(var r=t.next();!r.done;r=t.next()){if(r=Pb(e,r.value,n),!r)return;i.push(r)}n.matchedStreams=i}function Pb(e,t,n){var i={audio:Yb,video:qb,text:zb,image:Xb}[n.type],r=null,s=i(n);if(t.has(s))r=t.get(s);else{s={audio:function(t,n){return Ob(e,t,n)},video:function(t,n){return Ob(e,t,n)},text:Nb,image:Ub}[n.type];for(var a={audio:Fb,video:Bb,text:jb,image:$b}[n.type],o=d(t.values()),u=o.next();!u.done;u=o.next())u=u.value,!s(n,u)||n.fastSwitching!=u.fastSwitching||r&&!a(n,r,u)||(r=u)}return e.s&&!Wb(r)&&t.delete(i(r)),r}function _b(e,t){return e.mimeType==t.mimeType&&Qb(e.codecs)===Qb(t.codecs)}function Ob(e,t,n){return!(!_b(t,n)&&!e.o||t.drmInfos&&!Or(t.drmInfos,n.drmInfos))}function Nb(e,t){return!t.language||e.forced===t.forced&&0!=Hi(e.language,t.language)&&t.kind==e.kind}function Ub(){return!0}function Fb(e,t,n){var i=_b(e,t),r=_b(e,n);if(i&&!r)return!1;if(!i&&r)return!0;if(i=Hi(e.language,t.language),r=Hi(e.language,n.language),r>i)return!0;if(r<i)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(i=t.roles.filter(function(t){return e.roles.includes(t)}),r=n.roles.filter(function(t){return e.roles.includes(t)}),r.length>i.length)return!0;if(r.length<i.length)return!1;if(n.roles.length!==t.roles.length)return n.roles.length<t.roles.length}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return!(t.primary||!n.primary)||!(t.primary&&!n.primary)&&(i=Hb(e.channelsCount,t.channelsCount,n.channelsCount),i==Jb||i!=eT&&(i=Hb(e.audioSamplingRate,t.audioSamplingRate,n.audioSamplingRate),i==Jb||i!=eT&&!(!e.bandwidth||Kb(e.bandwidth,t.bandwidth,n.bandwidth)!=Jb)))}function Bb(e,t,n){var i=_b(e,t),r=_b(e,n);if(i&&!r)return!1;if(!i&&r)return!0;if(i=Hb(e.width*e.height,t.width*t.height,n.width*n.height),i==Jb)return!0;if(i==eT)return!1;if(e.frameRate){if(i=Hb(e.frameRate,t.frameRate,n.frameRate),i==Jb)return!0;if(i==eT)return!1}return!(!e.bandwidth||Kb(e.bandwidth,t.bandwidth,n.bandwidth)!=Jb)}function jb(e,t,n){var i=Hi(e.language,t.language),r=Hi(e.language,n.language);if(r>i)return!0;if(r<i)return!1;if(!t.primary&&n.primary)return!0;if(t.primary&&!n.primary)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(i=t.roles.filter(function(t){return e.roles.includes(t)}),r=n.roles.filter(function(t){return e.roles.includes(t)}),r.length>i.length)return!0;if(r.length<i.length)return!1}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return n.mimeType==e.mimeType&&n.codecs==e.codecs&&(t.mimeType!=e.mimeType||t.codecs!=e.codecs)}function $b(e,t,n){return Hb(e.width*e.height,t.width*t.height,n.width*n.height)==Jb}function Gb(e){return{id:0,originalId:"",groupId:null,primary:!1,type:e,mimeType:"",codecs:"",language:"",originalLanguage:null,label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1,baseOriginalId:null}}function Vb(e){return{id:0,originalId:"",groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Kl([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",originalLanguage:null,label:null,type:e,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null}}function Hb(e,t,n){if(t==e&&e!=n)return eT;if(n==e&&e!=t)return Jb;if(t>e){if(n<=e||n-e<t-e)return Jb;if(n-e>t-e)return eT}else{if(n>e)return eT;if(e-n<e-t)return Jb;if(e-n>e-t)return eT}return Zb}function Kb(e,t,n){return t=Math.abs(e-t),e=Math.abs(e-n),e<t?Jb:t<e?eT:Zb}function Wb(e){switch(e.type){case ft:return!e.language;case"image":return!e.tilesLayout;default:return!1}}function qb(e){return JSON.stringify([e.fastSwitching,e.width,e.frameRate,Qb(e.codecs),e.mimeType,e.label,e.roles,e.closedCaptions?Array.from(e.closedCaptions.entries()):null,e.bandwidth,e.dependencyStream?e.dependencyStream.baseOriginalId:null,Array.from(e.keyIds)])}function Yb(e){return JSON.stringify([e.fastSwitching,e.channelsCount,e.language,e.bandwidth,e.label,Qb(e.codecs),e.mimeType,e.roles,e.audioSamplingRate,e.primary,e.dependencyStream?e.dependencyStream.baseOriginalId:null,Array.from(e.keyIds)])}function zb(e){return JSON.stringify([e.language,e.label,e.codecs,e.mimeType,e.bandwidth,e.roles])}function Xb(e){return JSON.stringify([e.width,e.codecs,e.mimeType])}function Qb(e){if(!tT.has(e)){var t=mi(e);tT.set(e,t)}return tT.get(e)}b(lb,Kl),i=lb.prototype,i.getNumReferences=function(){return this.h?this.h.timeline.length:0},i.release=function(){Kl.prototype.release.call(this),this.h=null},i.$a=function(e){if(this.h){for(var t=0,n=this.h.timeline,i=0;i<n.length;i+=1){if(!(n[i].end+this.j<=e))break;t+=1}0<t&&(this.h.timeline=n.slice(t),this.g.length>=t&&(this.g=this.g.slice(t)),this.i+=t,0===this.getNumReferences()&&this.release())}},i.find=function(e){if(this.h&&this.h.timeline&&this.h.timeline.length&&e<this.h.timeline[0].start+this.j)return this.i;if(!this.h)return null;var t=this.h.timeline;if(e<this.j||e>=this.l)return null;for(var n=t.length-1,i=0;i<t.length;i++){var r=t[i],s=r.start+this.j;if(r=i<n?t[i+1].start+this.j:1/0===this.l?r.end+this.j:this.l,e>=s&&e<r)return i+this.i}return null},i.get=function(e){var t=this;if(e-=this.i,0>e||e>=this.getNumReferences()||!this.h)return null;var n=this.g[e];if(!n){var i=this.h.timeline[e],r=i.Lk,s=i.xh+this.h.wh;n=this.j-this.h.$b;var a=this.j+i.end,o=a;e===this.getNumReferences()-1&&1/0!==this.l&&(o=.1<Math.abs(o-this.l)?Math.min(o,this.l):this.l);for(var u=this.h.codecs,l=this.h.mimeType,c=this.h.bandwidth,d=[],h=(i.end-i.start)/i.Zb,f={},p=0;p<i.Zb;f={If:void 0,Qi:void 0},p++){var g=i.start+h*p,m=g+h;f.Qi=p+1,f.If=null,f=new No(this.j+g,this.j+m,function(e){return function(){return t.h?(null==e.If&&(e.If=fb(t.h.Dc,t.F,r,t.B,s,e.Qi,t.C,t.H)),e.If):[]}}(f),0,null,this.s,n,this.j,this.l,[],"",null,null,Fo,this.A),f.codecs=u,f.mimeType=l,f.bandwidth=c,0==this.G?0<p&&f.nd():0!=p%this.G&&f.nd(),d.push(f)}n=new No(this.j+i.start,o,function(){return 0<i.Zb||!t.h?[]:fb(t.h.Dc,t.F,r,t.B,s,null,t.C,t.H)},0,null,this.s,n,this.j,this.l,d,"",null,null,Fo,this.A,0<i.Zb),n.codecs=u,n.mimeType=l,n.j=a,n.bandwidth=c,this.g[e]=n}return n},i.Db=function(e){hb(this);for(var t=0;t<this.getNumReferences();t++){var n=this.get(t+this.i);n&&e(n)}},i.Ne=function(){return this.I},pb.prototype.configure=function(e){this.o=e},pb.prototype.destroy=function(){return this.A=this.o=null,this.i=[],this.h=null,this.m=[],this.F=[],this.l.clear(),null!=this.g&&(this.g.stop(),this.g=null),this.G.destroy()},pb.prototype.setManifestType=function(e){this.s=e},pb.prototype.banLocation=function(e){this.j.set(e,Date.now()+6e4)},i=Tb.prototype,i.release=function(){for(var e=d(this.h.concat(this.g,this.j,this.i)),t=e.next();!t.done;t=e.next())t=t.value,t.segmentIndex&&t.segmentIndex.release();this.h=[],this.g=[],this.j=[],this.i=[],this.l=[],this.s=this.o=!1,this.m.clear()},i.Uj=function(){return this.l},i.Cg=function(){return this.j.slice()},i.zj=function(){return this.i},i.Mh=function(e,t){if(e){if("audio"==e.type)for(var n=d(this.h),i=n.next();!i.done;i=n.next())i=i.value,i.matchedStreams=i.matchedStreams.filter(function(t){return t!==e});else if("video"==e.type)for(n=d(this.g),i=n.next();!i.done;i=n.next())i=i.value,i.matchedStreams=i.matchedStreams.filter(function(t){return t!==e}),i.trickModeVideo&&(i.trickModeVideo.matchedStreams=i.trickModeVideo.matchedStreams.filter(function(t){return t!==e})),i.dependencyStream&&(i.dependencyStream.matchedStreams=i.dependencyStream.matchedStreams.filter(function(t){return t!==e}));else if(e.type==ft)for(n=d(this.j),i=n.next();!i.done;i=n.next())i=i.value,i.matchedStreams=i.matchedStreams.filter(function(t){return t!==e});else if("image"==e.type)for(n=d(this.i),i=n.next();!i.done;i=n.next())i=i.value,i.matchedStreams=i.matchedStreams.filter(function(t){return t!==e});e.segmentIndex&&e.closeSegmentIndex(),this.m.delete(t)}},i.ag=function(e,t,n){n=void 0!==n&&n;var i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,x,I,k,L,R,C,D,M,P,_,O,N,F,B=this;return U(function(U){if(1==U.g){if(i=pt,!t&&1==e.length)return r=Sb(e,!1),s=r.Fh,a=r.Yi,o=r.Vi,u=r.Zh,B.h=Array.from(s[0].values()),B.g=Array.from(a[0].values()),B.j=Array.from(o[0].values()),B.i=Array.from(u[0].values()),U.u(2);for(l=n?B.m.size:0,c=-1,h=0;h<e.length;h++)f=e[h],B.m.has(f.id)||(B.m.add(f.id),-1==c&&(c=h));return-1==c?U.return():(p=Sb(e,!0),g=p.Fh,m=p.Yi,v=p.Vi,y=p.Zh,w(U,Promise.all([wb(B,B.h,g,c,Lb,Cb,l),wb(B,B.g,m,c,Lb,Cb,l),wb(B,B.j,v,c,Lb,Cb,l),wb(B,B.i,y,c,Lb,Cb,l)]),2))}if(b=0,T=[],B.g.length&&B.h.length)for(R=d(B.h),C=R.next();!C.done;C=R.next())for(D=C.value,M=d(B.g),P=M.next();!P.done;P=M.next())_=P.value,O=Nr(D.drmInfos,_.drmInfos),D.drmInfos.length&&_.drmInfos.length&&!O.length||(N=(D.bandwidth||0)+(_.bandwidth||0),D.dependencyStream&&(N+=D.dependencyStream.bandwidth||0),_.dependencyStream&&(N+=_.dependencyStream.bandwidth||0),F=b++,T.push({id:F,language:D.language,disabledUntilTime:0,primary:D.primary,audio:D,video:_,bandwidth:N,drmInfos:O,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(S=B.g.length?B.g:B.h,E=d(S),x=E.next();!x.done;x=E.next())I=x.value,k=b++,L=I.bandwidth||0,I.dependencyStream&&(L+=I.dependencyStream.bandwidth||0),T.push({id:k,language:I.language,disabledUntilTime:0,primary:I.primary,audio:I.type==i.ea?I:null,video:I.type==i.xa?I:null,bandwidth:L,drmInfos:I.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});B.l=T,A(U)})},i.Gi=function(e){this.o=e},i.Ki=function(e){this.s=e},K("shaka.util.PeriodCombiner",Tb),Tb.prototype.setUseStreamOnce=Tb.prototype.Ki,Tb.prototype.setAllowMultiTypeVariants=Tb.prototype.Gi,Tb.prototype.combinePeriods=Tb.prototype.ag,Tb.prototype.deleteStream=Tb.prototype.Mh,Tb.prototype.getImageStreams=Tb.prototype.zj,Tb.prototype.getTextStreams=Tb.prototype.Cg,Tb.prototype.getVariants=Tb.prototype.Uj;var Jb=1,Zb=0,eT=-1,tT=new Map;function nT(e,t){var n=new DOMParser,i=rT.value()(e);e=null;try{e=n.parseFromString(i,"text/xml")}catch(r){return null}if(n=e.documentElement,!n||n.getElementsByTagName("parsererror").length||n.tagName!=t)return null;if(!("createNodeIterator"in document))return n;for(t=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=t.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return null;return n}function iT(e,t){try{var n=Ye(e);return nT(n,t)}catch(i){return null}}var rT=new le(function(){if("undefined"!==typeof trustedTypes){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(e){return e}});return function(t){return e.createHTML(t)}}return function(e){return e}});function sT(){var e=this;this.j=this.g=null,this.A=[],this.i=null,this.Ba=1,this.G=[],this.l={jf:"",type:"",profiles:[],mc:null,pb:0,cb:null,$d:0},this.s=new Map,this.B=new Map,this.o=new Map,this.C=new Map,this.wa=new Map,this.m=new Tb,this.K=0,this.ya=new W(5),this.L=new _i(function(){e.I&&!e.g.continueLoadingWhenPaused&&(e.H.Ja(e.I,"timeupdate"),e.I.paused)?e.H.za(e.I,"timeupdate",function(){return kT(e)}):kT(e)}),this.P=new is,this.N=null,this.F=[],this.ia=1/0,this.va=!1,this.h=null,this.M=0,this.S=!1,this.H=new re,this.I=null,this.U=!1,this.$="",this.oa=function(){return!1},this.W=[],this.ka=new Set}function aT(e){var t,n,i,r,s,a,o,u,l,c,d;return U(function(h){return 1==h.g?(t=4,n="MPD",i=BT(e),r=e.A,i.length?(r=i,n="Patch",t=6):1<e.A.length&&e.h&&(s=bb(e.h,"Location",!0),s.length&&(r=s)),a=us(r,e.g.retryParameters),o=Date.now(),w(h,FT(e,a,0,{type:t}),2)):3!=h.g?(u=h.h,e.j?(u.uri&&u.uri!=u.originalUri&&!e.A.includes(u.uri)&&e.A.unshift(u.uri),l=new Te(u.uri),e.$=l.g.toString(),w(h,oT(e,u.data,u.uri,n),3)):h.return(0)):(c=Date.now(),d=(c-o)/1e3,e.ya.sample(1,d),e.ka.clear(),h.return(d))})}function oT(e,t,n,i){var r,s,a,o,u,l,c,d,h,f;return U(function(p){if(1==p.g){if(r=t,s=e.g.dash.manifestPreprocessor,a=$d,s!=a){if(ge("manifest.dash.manifestPreprocessor configuration","Please Use manifest.dash.manifestPreprocessorTXml instead."),o=iT(r,i),!o)throw new Ve(2,4,4001,n);s(o),r=ze(o.outerHTML)}if(u=Xt(r,i),!u)throw new Ve(2,4,4001,n);return l=e.g.dash.manifestPreprocessorTXml,c=Gd,l!=c&&l(u),"Patch"===i?p.return(cT(e,u)):e.g.dash.disableXlinkProcessing?p.return(uT(e,u,n)):(d=e.g.dash.xlinkFailGracefully,h=Py(u,e.g.retryParameters,d,n,e.j.networkingEngine),rs(e.P,h),w(p,h.promise,2))}return f=p.h,p.return(uT(e,f,n))})}function uT(e,t,n){var i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,x,I,k,L,R,C,D,M,P,_,O,N,F,B,j,$,G,V,H,K,W,q,Y,z,X,Q,J,Z,ee,te,ne,ie,re;return U(function(U){switch(U.g){case 1:for(e.h&&e.h.l.clear(),i=[n],r=[],s=new Map,a=nn(t,"Location"),o=d(a),u=o.next();!u.done;u=o.next())l=u.value,c=l.attributes.serviceLocation,(h=sn(l))&&(f=ot(i,[h])[0],c&&(e.h?yb(e.h,"Location",c,f):s.set(c,f)),r.push(f));if(e.h?(p=bb(e.h,"Location",!0),0<p.length&&(i=e.A=p)):r.length&&(i=e.A=r),e.l.jf=t.attributes.id||"",e.l.$d=ln(t,"publishTime",fn)||0,e.G=nn(t,"PatchLocation"),g=Promise.resolve(),(m=on(t,"ContentSteering"))&&e.j)for(v=m.attributes.defaultServiceLocation,e.h?(e.h.i=i,e.h.h=v):(e.h=new pb(e.j),e.h.configure(e.g),e.h.setManifestType("DASH"),e.h.i=i,e.h.h=v,(y=sn(m))&&(ln(m,"queryBeforeStart",Tn,!1)?g=gb(e.h,y):gb(e.h,y))),b=d(s.keys()),T=b.next();!T.done;T=b.next())S=T.value,E=s.get(S),yb(e.h,"Location",S,E);if(x=nn(t,"BaseURL"),I=!1,e.h)for(k=d(x),L=k.next();!L.done;L=k.next())R=L.value,C=R.attributes.serviceLocation,D=sn(R),C&&D&&(yb(e.h,"BaseURL",C,D),I=!0);if(e.W=null,I&&e.h||(M=x.map(sn),e.W=ot(i,M)),P=function(){return e.h&&I?bb(e.h,"BaseURL"):e.W?e.W:[]},e.l.cb=P,_=0,x&&x.length&&(_=ln(x[0],"availabilityTimeOffset",bn)||0),e.l.pb=_,e.K=ln(t,"minimumUpdatePeriod",pn,-1),O=ln(t,"availabilityStartTime",fn),N=ln(t,"timeShiftBufferDepth",pn),F=e.g.dash.ignoreSuggestedPresentationDelay,B=null,F||(B=ln(t,"suggestedPresentationDelay",pn)),j=e.g.dash.ignoreMaxSegmentDuration,$=null,j||($=ln(t,"maxSegmentDuration",pn)),G=t.attributes.type||"static",e.i&&e.i.presentationTimeline&&(e.U=e.i.presentationTimeline.V()&&"static"==G),e.l.type=G,e.i)for(V=e.i.presentationTimeline,H=V.Fb(),K=d(e.o.values()),W=K.next();!W.done;W=K.next())q=W.value,q.segmentIndex&&q.segmentIndex.$a(H);else Y=e.g.dash.ignoreMinBufferTime,z=0,Y||(z=ln(t,"minBufferTime",pn)||0),X=0,X=null!=B?Math.min(B,N||1/0):0<e.g.defaultPresentationDelay?e.g.defaultPresentationDelay:Math.min(1.5*z,N||1/0),V=new Sl(O,X,e.g.dash.autoCorrectDrift);return V.Yc("static"==G),V.V()&&!isNaN(e.g.availabilityWindowOverride)&&(N=e.g.availabilityWindowOverride),null==N&&(N=1/0),V.Cf(N),Q=t.attributes.profiles||"",e.l.profiles=Q.split(","),J={ic:"static"!=G,presentationTimeline:V,ra:null,na:null,ma:null,J:null,bandwidth:0,Eg:!1,pb:_,mc:null,profiles:Q.split(","),roles:null,Jb:function(){return""}},w(U,g,2);case 2:return e.M=0,Z=vT(e,J,P,t,!1),ee=Z.duration,te=Z.periods,("static"!=G||e.U)&&Z.Oh||V.ob(ee||1/0),e.S&&e.va&&V.Hi(e.ia),V.Mg($||1),e.S&&e.va&&(ne=null!=B?B:e.g.defaultPresentationDelay,V.gh(ne)),e.i?(e.i.periodCount=te.length,e.i.gapCount=e.M,w(U,lT(e,te,!1),4)):w(U,e.m.ag(te,J.ic),6);case 6:if(e.i={presentationTimeline:V,variants:e.m.l,textStreams:e.m.Cg(),imageStreams:e.m.i,offlineSessionIds:[],sequenceMode:e.g.dash.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"DASH",serviceDescription:gT(t),nextUrl:mT(t),periodCount:te.length,gapCount:e.M,isLowLatency:e.S,startTime:null},!V.Xi()){U.u(7);break}return ie=nn(t,"UTCTiming"),w(U,_T(e,P,ie),8);case 8:if(re=U.h,!e.j)return U.return();V.Ii(re);case 7:V.df(),e.m&&!e.i.presentationTimeline.V()&&e.m.release();case 4:e.j.makeTextStreamsForClosedCaptions(e.i),yT(e),bT(e,te),A(U)}})}function lT(e,t,n){var i;return U(function(r){if(1==r.g)return w(r,e.m.ag(t,!0,n),2);e.i.variants=e.m.l,i=e.m.Cg(),0<i.length&&(e.i.textStreams=i),e.i.imageStreams=e.m.i,e.j.filter(e.i),A(r)})}function cT(e,t){var n,i,r,s,a,o,u,l,c,f,p,g,m,v,y,b,T,S,E,x,I,k,L,R,C,D,M;return U(function(P){if(1==P.g){if(n=t.attributes.mpdId,i=ln(t,"originalPublishTime",fn),!n||n!==e.l.jf||i!==e.l.$d)throw e.G=[],new Ve(1,4,4052);for(r=[],s=[],a=new Set,o=d(tn(t)),u=o.next();!u.done;u=o.next())if(l=u.value,c=En(l.attributes.sel||""),f=c[c.length-1],p=sn(l)||"","MPD"===f.name)if("mediaPresentationDuration"===f.vc){g=sn(l)||"";var _=pn(g);if(null!=_){e.l.mc=_;for(var O=d(e.s.values()),N=O.next();!N.done;N=O.next())N.value.mc=_}}else if("type"===f.vc){for(e.i.presentationTimeline.Yc("static"==p),e.l.type=p,_=d(e.s.values()),O=_.next();!O.done;O=_.next())O.value.ic="dynamic"==p;"static"==p&&(e.K=-1)}else"publishTime"===f.vc?e.l.$d=fn(p)||0:null===f.vc&&"add"===l.tagName&&s.push(l);else if("PatchLocation"===f.name)wn(e.G,l);else if("Period"===f.name)"add"===l.tagName?s.push(l):"remove"===l.tagName&&f.id&&hT(e,f.id);else if("SegmentTemplate"===f.name){if(O=En(l.attributes.sel||""),_=O[O.length-1],_.vc){O=fT(e,O),N=sn(l)||"";for(var U=d(O),F=U.next();!F.done;F=U.next())F=e.s.get(F.value),xn(F.J.Fc,l.tagName,_.vc,N);_=O}else _=[];for(m=_,v=d(m),y=v.next();!y.done;y=v.next())b=y.value,a.add(b)}else if("SegmentTimeline"===f.name||"S"===f.name){for(_=En(l.attributes.sel||""),_=fT(e,_),O=d(_),N=O.next();!N.done;N=O.next())N=e.s.get(N.value),N=Dy(N,rb,"SegmentTimeline"),U=nn(N,"S"),wn(U,l),N.children=U;for(T=_,S=d(T),E=S.next();!E.done;E=S.next())x=E.value,a.add(x)}for(I=d(a),k=I.next();!k.done;k=I.next())L=k.value,pT(e,L);for(R=d(s),C=R.next();!C.done;C=R.next())D=C.value,r.push.apply(r,h(dT(e,D)));return r.length?(e.i.periodCount+=r.length,e.i.gapCount=e.M,w(P,lT(e,r,!0),2)):P.u(2)}"static"==e.l.type&&(M=e.l.mc,e.i.presentationTimeline.ob(M||1/0)),A(P)})}function dT(e,t){return vT(e,{ic:"dynamic"==e.l.type,presentationTimeline:e.i.presentationTimeline,ra:null,na:null,ma:null,J:null,bandwidth:0,Eg:!1,pb:e.l.pb,profiles:e.l.profiles,mc:e.l.mc,roles:null,Jb:function(){return""}},e.l.cb,t,!0).periods}function hT(e,t){e.i.periodCount--;for(var n=d(e.s.keys()),i=n.next();!i.done;i=n.next())if(i=i.value,i.startsWith(t)){var r=e.s.get(i);Dy(r,rb,"SegmentTimeline").children=[],pT(e,i),e.s.delete(i)}e.F=e.F.filter(function(e){return e!==t})}function fT(e,t){var n="",i="",r=-1,s="";t=d(t);for(var a=t.next();!a.done;a=t.next())a=a.value,"Period"===a.name?n=a.id:"AdaptationSet"===a.name?(i=a.id,null!==a.position&&(r=a.position)):"Representation"===a.name&&(s=a.id);if(t=[],s)t.push(n+","+s);else if(i)for(r=d(e.s.values()),e=r.next();!e.done;e=r.next())e=e.value,e.ra.id===n&&e.ma.id===i&&e.J.id&&t.push(n+","+e.J.id);else if(-1<r)for(i=d(e.s.values()),e=i.next();!e.done;e=i.next())e=e.value,e.ra.id===n&&e.ma.position===r&&e.J.id&&t.push(n+","+e.J.id);return t}function pT(e,t){var n=e.s.get(t),i=e.o.get(t);i.segmentIndex&&i.segmentIndex.$a(e.i.presentationTimeline.Fb());try{var r=ib(n,function(t,n,i,r){return NT(e,t,n,i,r)},e.o,!0,e.g.dash.initialSegmentLimit,e.wa,n.J.aesKey,null,!0,e.B);i.createSegmentIndex=function(){return U(function(e){if(1==e.g)return i.segmentIndex?e.u(0):w(e,r.Nc(),3);i.segmentIndex=e.h,A(e)})}}catch(s){if(t=n.J.contentType,t!=ft&&"application"!=t&&"image"!=t||4002!=s.code)throw s}}function gT(e){var t=on(e,"ServiceDescription");if(!t)return null;if(e=on(t,"Latency"),t=on(t,"PlaybackRate"),!e&&!t)return null;var n={};return e&&("target"in e.attributes&&(n.targetLatency=parseInt(e.attributes.target,10)/1e3),"max"in e.attributes&&(n.maxLatency=parseInt(e.attributes.max,10)/1e3),"min"in e.attributes&&(n.minLatency=parseInt(e.attributes.min,10)/1e3)),t&&("max"in t.attributes&&(n.maxPlaybackRate=parseFloat(t.attributes.max)),"min"in t.attributes&&(n.minPlaybackRate=parseFloat(t.attributes.min))),n}function mT(e){if(e=nn(e,"SupplementalProperty"),!e.length)return null;e=d(e);for(var t=e.next();!t.done;t=e.next())if(t=t.value,"urn:mpeg:dash:chaining:2016"==t.attributes.schemeIdUri)return t.attributes.value;return null}function vT(e,t,n,i,r){var s=t.mc;s||(s=ln(i,"mediaPresentationDuration",pn),e.l.mc=s);var a=0;e.i&&e.i.presentationTimeline&&e.U&&(a=e.i.presentationTimeline.Vb());var o=[],u=a;i=nn(i,"Period");for(var l=0;l<i.length;l++){var c=i[l],h=i[l+1],f=ln(c,"start",pn,u),p=c.attributes.id,g=ln(c,"duration",pn);f=0==l&&0==f&&e.U?a:f;var m=null;if(h){var v=ln(h,"start",pn);null!=v&&(m=v-f+a)}else null!=s&&(m=s-f+a);if(v=gt,m&&g&&Math.abs(m-g)>v&&m>g&&e.M++,null==m&&(m=g),!(null!==e.N&&null!==p&&null!==f&&f<e.N)||e.F.includes(p)||l+1==i.length){if(null!==f&&(null===e.N||f>e.N)&&(e.N=f),u=TT(e,t,n,{start:f,duration:m,node:c,bi:null==m||!h}),o.push(u),t.ra.id&&m&&e.wa.set(t.ra.id,m),null==m){u=null;break}u=f+m}}if(r)for(t=d(o),n=t.next();!n.done;n=t.next())n=n.value.id,e.F.includes(n)||e.F.push(n);else e.F=o.map(function(e){return e.id});return null!=s?{periods:o,duration:s+a,Oh:!1}:{periods:o,duration:u,Oh:!0}}function yT(e){var t=Array.from(e.C.keys()).filter(function(t){return!e.F.includes(t)});t=d(t);for(var n=t.next();!n.done;n=t.next()){n=n.value;for(var i=!0,r=d(e.C.get(n)),s=r.next();!s.done;s=r.next()){s=s.value;var a=e.o.get(s);a&&(a.segmentIndex&&0!=a.segmentIndex.getNumReferences()?i=!1:(e.m&&e.m.Mh(a,n),e.o.delete(s)))}i&&e.C.delete(n)}}function bT(e,t){t=new Set(t.map(function(e){return e.id}));for(var n=d(e.B.keys()),i=n.next();!i.done;i=n.next())i=i.value,t.has(i)||e.B.delete(i)}function TT(e,t,n,i){t.ra=RT(e,i.node,null,n),t.na=i,t.ra.pb=t.pb,t.ra.id||(t.ra.id="__shaka_period_"+i.start);var r=nn(i.node,"EventStream");n=t.presentationTimeline.Fb(),r=d(r);for(var s=r.next();!s.done;s=r.next())OT(e,i.start,i.duration,s.value,n);for(n=nn(i.node,"SupplementalProperty"),n=d(n),r=n.next();!r.done;r=n.next())r=r.value,"urn:mpeg:dash:urlparam:2014"==r.attributes.schemeIdUri&&(r=wT(e,r))&&(t.Jb=r);if(n=nn(i.node,"AdaptationSet").map(function(n,i){return ET(e,t,i,n)}).filter(Ui),t.ic){r=[],s=d(n);for(var a=s.next();!a.done;a=s.next()){a=d(a.value.Hk);for(var o=a.next();!o.done;o=a.next())r.push(o.value)}if(r.length!=new Set(r).size)throw new Ve(2,4,4018)}for(r=new Map,s=d(n),a=s.next();!a.done;a=s.next())for(a=d(a.value.nj),o=a.next();!o.done;o=a.next()){var u=d(o.value);o=u.next().value,u=u.next().value,r.set(o,u)}if(r.size)for(s=null,a=d(n),o=a.next();!o.done;o=a.next()){o=o.value,u=[];for(var l=d(o.streams),c=l.next(),f={};!c.done;f={mh:void 0},c=l.next())if(f.mh=c.value,r.has(f.mh.originalId)){s||(s=nn(i.node,"AdaptationSet").map(function(n,i){return ET(e,t,i,n)}).filter(Ui)),c=d(s);for(var p=c.next();!p.done;p=c.next())(p=p.value.streams.find(function(e){return function(t){return t.originalId==e.mh.originalId}}(f)))&&(p.dependencyStream=r.get(p.originalId),p.originalId+=p.dependencyStream.originalId,u.push(p))}u.length&&o.streams.push.apply(o.streams,h(u))}if(i=n.filter(function(e){return!e.vh}),n=n.filter(function(e){return e.vh}),!e.g.disableIFrames)for(n=d(n),r=n.next();!r.done;r=n.next())for(r=r.value,s=r.vh.split(" "),a=d(i),o=a.next();!o.done;o=a.next())if(o=o.value,s.includes(o.id))for(o=d(o.streams),u=o.next();!u.done;u=o.next())wr(u.value,r.streams);if(n=ST(e.g.disableAudio,i,"audio"),r=ST(e.g.disableVideo,i,"video"),s=ST(e.g.disableText,i,ft),i=ST(e.g.disableThumbnails,i,"image"),0===r.length&&0===n.length)throw new Ve(2,4,4004);return{id:t.ra.id,audioStreams:n,videoStreams:r,textStreams:s,imageStreams:i}}function ST(e,t,n){return e||!t.length?[]:t.reduce(function(e,t){return t.contentType!=n||e.push.apply(e,h(t.streams)),e},[])}function ET(e,t,n,i){function r(n){var i=n.attributes["dvb:fontFamily"];n=n.attributes["dvb:url"],i&&n&&(n=ot(t.ma.cb(),[n],t.Jb()),e.j.addFont(i,n[0]))}function s(e){switch(e){case 1:case 5:case 6:case 7:return"srgb";case 9:return"rec2020";case 11:case 12:return"p3"}}function a(e){switch(e){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}}t.ma=RT(e,i,t.ra,null),t.ma.position=n;var o=!1;n=nn(i,"Role");var u=n.map(function(e){return e.attributes.value}).filter(Ui),l=void 0,c=t.ma.contentType==ft;c&&(l="subtitle"),n=d(n);for(var f=n.next();!f.done;f=n.next()){f=f.value;var p=f.attributes.schemeIdUri;if(null==p||"urn:mpeg:dash:role:2011"==p)switch(f=f.attributes.value,f){case"main":o=!0;break;case"caption":case"subtitle":l=f}}var g=nn(i,"EssentialProperty");n=null;var m=!1;f=null,p=!1,g=d(g);for(var v=g.next();!v.done;v=g.next()){v=v.value;var y=v.attributes.schemeIdUri;if("http://dashif.org/guidelines/trickmode"==y)n=v.attributes.value;else if("urn:mpeg:mpegB:cicp:TransferCharacteristics"==y)var b=a(parseInt(v.attributes.value,10));else if("urn:mpeg:mpegB:cicp:ColourPrimaries"==y)var T=s(parseInt(v.attributes.value,10));else"urn:mpeg:mpegB:cicp:MatrixCoefficients"!=y&&("urn:mpeg:dash:ssr:2023"==y&&e.g.dash.enableFastSwitching?m=!0:"urn:dvb:dash:fontdownload:2014"==y?r(v):"urn:mpeg:dash:urlparam:2014"==y&&(f=wT(e,v))||(p=!0))}if(p)return null;var S=null;for(p=nn(i,"SupplementalProperty"),p=d(p),g=p.next();!g.done;g=p.next())g=g.value,v=g.attributes.schemeIdUri,"http://dashif.org/guidelines/last-segment-number"==v?S=parseInt(g.attributes.value,10)-1:"urn:mpeg:mpegB:cicp:TransferCharacteristics"==v?b=a(parseInt(g.attributes.value,10)):"urn:mpeg:mpegB:cicp:ColourPrimaries"==v?T=s(parseInt(g.attributes.value,10)):"urn:dvb:dash:fontdownload:2014"==v?r(g):"urn:mpeg:dash:urlparam:2014"==v&&(f=wT(e,g));f&&(t.Jb=f),f=nn(i,"Accessibility");var E,w=new Map;for(f=d(f),p=f.next();!p.done;p=f.next())if(g=p.value,p=g.attributes.schemeIdUri,g=g.attributes.value,"urn:scte:dash:cc:cea-608:2015"!=p||e.g.disableText)if("urn:scte:dash:cc:cea-708:2015"!=p||e.g.disableText)"urn:mpeg:dash:role:2011"==p?null!=g&&(u.push(g),"captions"==g&&(l="caption")):"urn:tva:metadata:cs:AudioPurposeCS:2007"==p&&("1"==g?E="visually impaired":"2"==g?E="hard of hearing":"9"==g&&(E="spoken subtitles"));else if(p=1,null!=g)for(g=d(g.split(";")),v=g.next();!v.done;v=g.next()){y=v.value;var A=v=void 0;y.includes("=")?(y=y.split("="),v="svc"+y[0],A=y[1].split(",")[0].split(":").pop()):(v="svc"+p,p++,A=y),w.set(v,Vi(A))}else w.set("svc1","und");else if(p=1,null!=g)for(g=g.split(";"),v=d(g),y=v.next();!y.done;y=v.next()){A=y.value;var x=y=void 0;A.includes("=")?(A=A.split("="),y=A[0].startsWith("CC")?A[0]:"CC"+A[0],x=A[1]||"und"):(y="CC"+p,2==g.length?p+=2:p++,x=A),w.set(y,Vi(x))}else w.set("CC1","und");f=nn(i,"ContentProtection");var I=by(f,e.g.ignoreDrmInfo,e.g.dash.keySystemsByURI);t.ma.encrypted=0<f.length;var k=Vi(t.ma.language||"und"),L=t.ma.label,R=new Map;if(i=nn(i,"Representation"),!e.g.ignoreSupplementalCodecs){for(f=[],p=d(i),g=p.next();!g.done;g=p.next())v=g.value,(g=cn(v,"urn:scte:dash:scte214-extensions","supplementalCodecs"))&&(v=qt(v),v.attributes.codecs=g.split(" ").join(","),v.attributes.id&&(v.attributes.supplementalId=v.attributes.id+"_supplementalCodecs"),f.push(v));i.push.apply(i,h(f))}if(f=i.map(function(n){var i=AT(e,t,I,l,k,L,o,u,w,n,E,S);return i&&(i.hdr=i.hdr||b,i.colorGamut=i.colorGamut||T,i.fastSwitching=m,n=n.attributes.dependencyId)?(i.baseOriginalId=n,R.set(n,i),null):i}).filter(function(e){return!!e}),0==f.length&&0==R.size){if(n="image"==t.ma.contentType,e.g.dash.ignoreEmptyAdaptationSet||c||n)return null;throw new Ve(2,4,4003)}if(!t.ma.contentType||"application"==t.ma.contentType)for(t.ma.contentType=UT(f[0].mimeType,f[0].codecs),c=d(f),p=c.next();!p.done;p=c.next())p.value.type=t.ma.contentType;for(c=t.ma.id||"__fake__"+e.Ba++,p=d(f),g=p.next();!g.done;g=p.next()){for(g=g.value,v=d(I.drmInfos),y=v.next();!y.done;y=v.next())y=y.value,y.keyIds=y.keyIds&&g.keyIds?new Set([].concat(h(y.keyIds),h(g.keyIds))):y.keyIds||g.keyIds;g.groupId=c}return i=i.map(function(e){return e.attributes.supplementalId||e.attributes.id}).filter(Ui),{id:c,contentType:t.ma.contentType,language:k,um:o,streams:f,drmInfos:I.drmInfos,vh:n,Hk:i,nj:R}}function wT(e,t){if((t=un(t,"urn:mpeg:dash:schema:urlparam:2014","UrlQueryInfo"))&&ln(t,"useMPDUrlQuery",Tn,!1)){var n=t.attributes.queryTemplate;if(n)return function(){return"$querypart$"==n?e.$:n.split("&").map(function(t){if("$querypart$"==t)return e.$;var n=/\$query:(.*?)\$/g.exec(t);if(n&&2==n.length){n=n[1];var i=new Pe(e.$).get(n);if(i.length)return n+"="+i[0]}return t}).join("&")}}return null}function AT(t,n,i,r,s,a,o,u,l,c,d,h){n.J=RT(t,c,n.ma,null);var f=n.J.id;if(t.ia=Math.min(t.ia,n.J.pb),t.S=0<t.ia,!MT(n.J))return null;var p=n.na.start;n.bandwidth=ln(c,"bandwidth",vn)||0,n.roles=u;var g=nn(c,"SupplementalProperty"),m=nn(c,"EssentialProperty"),v=nn(c,"ContentProtection");c=null;var y,b,T=m.find(function(e){return"urn:mpeg:dash:urlparam:2014"==e.attributes.schemeIdUri});(T||(T=g.find(function(e){return"urn:mpeg:dash:urlparam:2014"==e.attributes.schemeIdUri})))&&(c=wT(t,T)),c&&(n.Jb=c),T=n.J.contentType,c=T==ft||"application"==T,T="image"==T,v.length&&(n.ma.encrypted=!0);try{var S=void 0;if(i.Xf){var E=n.J.cb,x=n.Jb,I=ot(E(),[i.Xf.ik],x()),k=us(I,t.g.retryParameters);S={bitsKey:128,blockCipherMode:"CBC",iv:i.Xf.iv,firstMediaSequenceNumber:0,fetchKey:function(){var n,i,r;return U(function(s){if(1==s.g)return w(s,FT(t,k,6),2);if(3!=s.g){if(n=s.h,!n.data||16!=n.data.byteLength)throw new Ve(2,4,4049);return i={name:"AES-CBC"},r=S,w(s,e.crypto.subtle.importKey("raw",n.data,i,!0,["decrypt"]),3)}r.cryptoKey=s.h,S.fetchKey=void 0,A(s)})}}}if(n.J.aesKey=S,E=function(e,n,i,r){return NT(t,e,n,i,r)},n.J.yd)var L=Ky(n,E,S);else if(n.J.sc)L=Jy(n,t.o,S);else if(n.J.Fc)L=ib(n,E,t.o,!!t.i,t.g.dash.initialSegmentLimit,t.wa,S,h,!1,t.B);else{var R=n.na.duration||0,C=n.J.cb,D=n.J.mimeType,M=n.J.codecs;L={endTime:-1,timeline:-1,Nc:function(){var e=ql(p,R,C());return e.Db(function(e){e.mimeType=D,e.codecs=M}),Promise.resolve(e)},timescale:1}}}catch(_){if((c||T)&&4002==_.code)return null;throw _}if(h=Ty(v,i,t.g.ignoreDrmInfo,t.g.dash.keySystemsByURI),h=new Set(h?[h]:[]),v=!1,g.some(function(e){return"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"==e.attributes.schemeIdUri&&"JOC"==e.attributes.value})&&(v=!0),g=!1,c&&(g=u.includes("forced_subtitle")||u.includes("forced-subtitle")),T&&((m=m.find(function(e){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(e.attributes.schemeIdUri)}))&&(y=m.attributes.value),!y))return null;c=n.J.codecs,n.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(c.includes("hvc1.2.4.L153.B0")||c.includes("hev1.2.4.L153.B0"))&&(b="PQ"),m=n.J.id?n.ra.id+","+n.J.id:"",t.G.length&&f&&t.s.set(n.ra.id+","+f,IT(n)),n.J.vf&&xT(t,n.J.vf,L,n.presentationTimeline),-1!=L.endTime&&null!=n.ra.id&&null!=n.J.id&&((f=t.B.get(n.ra.id))?(f.endTime=L.endTime,f.Wg.includes(n.J.id)||f.Wg.push(n.J.id),t.B.set(n.ra.id,f)):t.B.set(n.ra.id,{endTime:L.endTime,timeline:L.timeline,Wg:[n.J.id]}));var P=m&&t.o.has(m)?t.o.get(m):{id:t.Ba++,originalId:n.J.id,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){P.segmentIndex&&(P.segmentIndex.release(),P.segmentIndex=null)},segmentIndex:null,mimeType:n.J.mimeType,codecs:c,frameRate:n.J.frameRate,pixelAspectRatio:n.J.pixelAspectRatio,bandwidth:n.bandwidth,width:n.J.width,height:n.J.height,kind:r,encrypted:0<i.drmInfos.length,drmInfos:i.drmInfos,keyIds:h,language:s,originalLanguage:n.ma.language,label:a,type:n.ma.contentType,primary:o,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:n.J.emsgSchemeIdUris,roles:u,forced:g,channelsCount:n.J.mf,audioSamplingRate:n.J.audioSamplingRate,spatialAudio:v,closedCaptions:l,hdr:b,colorGamut:void 0,videoLayout:void 0,tilesLayout:y,accessibilityPurpose:d,external:!1,fastSwitching:!1,fullMimeTypes:new Set([hi(n.J.mimeType,n.J.codecs)]),isAudioMuxedInVideo:!1,baseOriginalId:null};return P.createSegmentIndex=function(){var e;return U(function(t){if(1==t.g)return P.segmentIndex?t.u(0):(e=P,w(t,L.Nc(),3));e.segmentIndex=t.h,A(t)})},m&&n.ic&&!t.o.has(m)&&(n=n.ra.id||"",t.C.has(n)||t.C.set(n,[]),t.o.set(m,P),t.C.get(n).push(m)),P}function xT(e,t,n,i){if(!e.ka.has(t)){e.ka.add(t);var r,s=ln(t,"presentationTime",yn)||0,a=on(t,"UTCTiming");(r=a&&a.attributes.schemeIdUri)&&(a=a.attributes.schemeIdUri,r=!("urn:mpeg:dash:utc:http-ntp:2014"===a||"urn:mpeg:dash:utc:ntp:2014"===a||"urn:mpeg:dash:utc:sntp:2014"===a)),r?t=1e3*(ln(t,"wallClockTime",fn)||0):(t=ln(t,"wallClockTime",yn)||0,t=ou(t)),n=new Date(t-s/n.timescale*1e3),s=n.getTime()/1e3,isNaN(s)||(i.o||i.hh(s),i=(new Map).set("detail",{wallClockTime:t,programStartDate:n}),i=new Zr("prft",i),e.j.onEvent(i))}}function IT(e){function t(e){return e?(e=Yt(e),e.yd=null,e.sc=null,e.Fc=kn(e.Fc),e.vf=null,e):null}return e=Yt(e),e.ra=t(e.ra),e.ma=t(e.ma),e.J=t(e.J),e.na&&(e.na=Yt(e.na),e.na.node=null),e}function kT(e){var t,n;return U(function(i){switch(i.g){case 1:return t=0,x(i,2),w(i,aT(e),4);case 4:t=i.h,k(i,3);break;case 2:if(n=L(i),e.j){if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.j.onError(n),i.return();n.severity=1,e.j.onError(n)}case 3:if(!e.j)return i.return();e.j.onManifestUpdated(),LT(e,t),A(i)}})}function LT(e,t){if(!(0>e.K)){var n=e.K;0<=e.g.updatePeriod&&(n=e.g.updatePeriod),e.L.ha(Math.max(n-t,q(e.ya)))}}function RT(e,t,n,i){n=n||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,mf:null,audioSamplingRate:null,pb:0,Af:0,encrypted:!1},i=i||n.cb;var r,s=t.attributes.id,a=t.attributes.supplementalId,o=nn(t,"BaseURL"),u=!1;if(e.h)for(var l=d(o),c=l.next();!c.done;c=l.next()){var h=c.value;c=h.attributes.serviceLocation,h=sn(h),c&&h&&(yb(e.h,s,c,h),u=!0)}u&&e.h||(r=o.map(sn)),l=t.attributes.contentType||n.contentType,c=t.attributes.mimeType||n.mimeType,h=xc([t.attributes.codecs||n.codecs]).join(",");var f=ln(t,"frameRate",Sn)||n.frameRate,p=t.attributes.sar||n.pixelAspectRatio,g=CT(nn(t,"InbandEventStream"),n.emsgSchemeIdUris),m=nn(t,"AudioChannelConfiguration");m=DT(m)||n.mf;var v=ln(t,"audioSamplingRate",yn)||n.audioSamplingRate;l||(l=UT(c,h));var y=on(t,"SegmentBase"),b=on(t,"SegmentTemplate"),T=y&&ln(y,"availabilityTimeOffset",bn)||0,S=b&&ln(b,"availabilityTimeOffset",bn)||0,E=o&&o.length&&ln(o[0],"availabilityTimeOffset",bn)||0;T=n.pb+E+T+S,S=null,(E=on(t,"SegmentSequenceProperties"))&&(E=on(E,"SAP"))&&(S=ln(E,"cadence",mn)),E=t.attributes.label;var w=nn(t,"Label");return w&&w.length&&(w=w[0],rn(w)&&(E=rn(w))),{cb:function(){return ot(i(),o.length?e.h&&u?bb(e.h,s):r||[]:[])},yd:y||n.yd,sc:on(t,"SegmentList")||n.sc,Fc:b||n.Fc,vf:on(t,"ProducerReferenceTime")||n.vf,width:ln(t,"width",yn)||n.width,height:ln(t,"height",yn)||n.height,contentType:l,mimeType:c,codecs:h,frameRate:f,pixelAspectRatio:p,emsgSchemeIdUris:g,id:a||s,originalId:s,language:t.attributes.lang,mf:m,audioSamplingRate:v,pb:T,Xe:null,Af:S||n.Af,label:E||null,encrypted:!1}}function CT(e,t){t=t.slice(),e=d(e);for(var n=e.next();!n.done;n=e.next())n=n.value.attributes.schemeIdUri,t.includes(n)||t.push(n);return t}function DT(e){e=d(e);for(var t=e.next();!t.done;t=e.next()){t=t.value;var n=t.attributes.schemeIdUri;if(n&&(t=t.attributes.value))switch(n){case"urn:mpeg:dash:outputChannelPositionList:2012":return t.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(t=parseInt(t,10),!t)continue;return t;case"tag:dolby.com,2015:dash:audio_channel_configuration:2015":if(n=[2,1,2,2,2,2,1,2,2,1,1,1,1,2,1,1,2,2],t=parseInt(t,16),!t)continue;for(var i=0,r=0;r<n.length;r++)t&1<<r&&(i+=n[r]);if(i)return i;continue;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(n=[1,1,1,1,1,2,2,1,1,2,2,2,1,2,1,1].reverse(),t=parseInt(t,16),!t)continue;for(r=i=0;r<n.length;r++)t&1<<r&&(i+=n[r]);if(i)return i;continue;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(n=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(t=parseInt(t,10))&&0<t&&t<n.length)return n[t]}}return null}function MT(e){var t=e.yd?1:0;return t+=e.sc?1:0,t+=e.Fc?1:0,0==t?e.contentType==ft||"application"==e.contentType:(1!=t&&(e.yd&&(e.sc=null),e.Fc=null),!0)}function PT(e,t,n,i){var r,s,a,o,u,l,c;return U(function(d){if(1==d.g)return r=[Je(n)],s=ot(t(),r),a=us(s,e.g.retryParameters),a.method=i,o=e.j.networkingEngine.request(4,a,{isPreload:e.oa()}),rs(e.P,o),w(d,o.promise,2);if(u=d.h,"HEAD"==i){if(!u.headers||!u.headers.date)return d.return(0);l=u.headers.date}else l=We(u.data);return c=Date.parse(l),isNaN(c)?d.return(0):d.return(c-Date.now())})}function _T(e,t,n){var i,r,s,a,o,u,l,c;return U(function(h){switch(h.g){case 1:i=n.map(function(e){return{scheme:e.attributes.schemeIdUri,value:e.attributes.value}}),r=e.g.dash.clockSyncUri,!i.length&&r&&i.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:r}),s=d(i),a=s.next();case 2:if(a.done){h.u(4);break}switch(o=a.value,x(h,5),u=o.scheme,l=o.value,u){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return h.u(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return h.u(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return c=Date.parse(l),h.return(isNaN(c)?0:c-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":Q("NTP UTCTiming scheme is not supported");break;default:Q("Unrecognized scheme in UTCTiming element",u)}h.u(9);break;case 7:return w(h,PT(e,t,l,"HEAD"),10);case 10:return h.return(h.h);case 8:return w(h,PT(e,t,l,"GET"),11);case 11:return h.return(h.h);case 9:k(h,3);break;case 5:L(h);case 3:a=s.next(),h.u(2);break;case 4:return Q("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),h.return(0)}})}function OT(e,t,n,i,r){var s=i.attributes.schemeIdUri||"",a=i.attributes.value||"",o=ln(i,"timescale",yn)||1,u=ln(i,"presentationTimeOffset",yn)||0;i=d(nn(i,"Event"));for(var l=i.next();!l.done;l=i.next()){l=l.value;var c=ln(l,"presentationTime",yn)||0,h=ln(l,"duration",yn)||0;c=Math.max((c-u)/o+t,t),h=c+h/o,null!=n&&(c=Math.min(c,t+n),h=Math.min(h,t+n)),h<r||(l={schemeIdUri:s,value:a,startTime:c,endTime:h,id:l.attributes.id||"",timescale:o,eventElement:In(l),eventNode:kn(l)},e.j.onTimelineRegionAdded(l))}}function NT(e,t,n,i,r){var s,a,o,u;return U(function(l){return 1==l.g?(s=gs,a=r?0:1,o=Rc(t,n,i,e.g.retryParameters),w(l,FT(e,o,s,{type:a}),2)):(u=l.h,l.return(u.data))})}function UT(e,t){return t=hi(e,t),Ii(t)?ft:e.split("/")[0]}function FT(e,t,n,i){return i||(i={}),i.isPreload=e.oa(),t=e.j.networkingEngine.request(n,t,i),rs(e.P,t),t.promise}function BT(e){var t=e.l.$d;if(!e.l.jf||!t||!e.G.length)return[];var n=Date.now()/1e3,i=e.G.filter(function(e){return e=yn(e.attributes.ttl),!e||t+e>n}).map(sn).filter(Ui);return i.length?ot(e.A,i):[]}function jT(){}i=sT.prototype,i.configure=function(e,t){var n=this.j&&e.updatePeriod!=this.g.updatePeriod&&0<=e.updatePeriod;this.g=e,t&&(this.oa=t),n&&this.i&&this.i.presentationTimeline.V()&&this.L.Hb(),this.h&&this.h.configure(this.g),this.m&&(this.m.Gi(this.g.dash.multiTypeVariantsAllowed&&Et()),this.m.Ki(this.g.dash.useStreamOnceInPeriodFlattening))},i.start=function(e,t){var n,i=this;return U(function(r){if(1==r.g)return i.va=t.isLowLatencyMode(),i.A=[e],i.j=t,w(r,aT(i),2);if(n=r.h,i.j&&LT(i,n),!i.j)throw new Ve(2,7,7001);return r.return(i.i)})},i.stop=function(){for(var e=d(this.o.values()),t=e.next();!t.done;t=e.next())t=t.value,t.segmentIndex&&t.segmentIndex.release();return this.m&&this.m.release(),this.g=this.j=null,this.A=[],this.i=null,this.o.clear(),this.C.clear(),this.s.clear(),this.B.clear(),this.l={jf:"",type:"",profiles:[],mc:null,pb:0,cb:null,$d:0},this.m=null,null!=this.L&&(this.L.stop(),this.L=null),this.h&&this.h.destroy(),this.H&&(this.H.release(),this.H=null),this.ka.clear(),this.P.destroy()},i.update=function(){var e,t=this;return U(function(n){return 1==n.g?(x(n,2),w(n,aT(t),4)):2!=n.g?k(n,0):(e=L(n),t.j&&e?(t.j.onError(e),void A(n)):n.return())})},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(e){if(this.i&&this.i.presentationTimeline.V()){var t=e.video||e.audio;if(t&&t.segmentIndex){e=this.i.presentationTimeline.yc();var n=t.segmentIndex.find(e);null!=n&&(t=t.segmentIndex.get(n))&&(this.K=t.endTime-e,LT(this,0))}}},i.banLocation=function(e){this.h&&this.h.banLocation(e)},i.setMediaElement=function(e){this.I=e},K("shaka.dash.DashParser",sT),ja("application/dash+xml",function(){return new sT}),ja("video/vnd.mpeg.dash.mpd",function(){return new sT}),K("shaka.dependencies",jT),jT.has=function(e){return VT.has(e)},jT.add=function(e,t){if(!GT[e])throw Error(e+" is not supported");e==$T?ge("mux.js","mux.js is no longer used in Shaka Player."):VT.set(e,function(){return t})};var $T="muxjs",GT={vm:$T,ISOBoxer:"ISOBoxer"};jT.Allowed=GT;var VT=new Map([["ISOBoxer",function(){return e.ISOBoxer}]]);function HT(){this.j=new le(function(){return navigator.userAgent.match(/Smart( ?|_)TV/i)||navigator.userAgent.match(/Android ?TV/i)?"TV":navigator.userAgentData?navigator.userAgentData.mobile?"MOBILE":"DESKTOP":/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)?"MOBILE":navigator.userAgentData&&navigator.userAgentData.platform?"android"==navigator.userAgentData.platform.toLowerCase()?"MOBILE":"DESKTOP":navigator.userAgent.includes("Android")?"MOBILE":"DESKTOP"}),this.l=new le(function(){return navigator.vendor.includes("Apple")&&(navigator.userAgent.includes("Version/")||navigator.userAgent.includes("OS/"))?"WEBKIT":navigator.userAgent.includes("Edge/")?"EDGE":navigator.userAgent.includes("Chrome/")?"CHROMIUM":navigator.userAgent.includes("Firefox/")?"GECKO":"UNKNOWN"})}function KT(){var t=e.ManagedMediaSource||e.MediaSource;return!(!t||!t.isTypeSupported)}function WT(t){return ce(),void 0!==e.matchMedia&&e.matchMedia("(color-gamut: p3)").matches?t?"HLG":"PQ":"SDR"}function qT(){HT.call(this),this.g=new le(function(){var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}),this.h=new le(function(){return/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||1<navigator.maxTouchPoints?"xr"in navigator?"VR":"MOBILE":"xr"in navigator?"VR":"DESKTOP"})}function YT(){if(!zT())throw Error("Not a Chromecast device!");HT.call(this),this.h=new le(function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/);return e?parseInt(e[1],10):null}),this.g=new le(function(){var e=navigator.userAgentData&&navigator.userAgentData.platform||navigator.userAgent;return e=e.toLowerCase(),e.includes("android")?XT:e.includes("fuchsia")?QT:JT})}function zT(){return navigator.userAgent.includes("CrKey")&&!navigator.userAgent.includes("VIZIO SmartCast")}i=HT.prototype,i.bc=function(){return!!navigator.mediaCapabilities},i.La=function(){return this.j.value()},i.Da=function(){return this.l.value()},i.ce=function(){return!1},i.xi=function(){return!1},i.Ye=function(){return!1},i.zi=function(){return!1},i.be=function(){return!1},i.Zc=function(){return!0},i.$c=function(){return!0},i.ge=function(){return!0},i.Ei=function(){return 0},i.fc=function(){return Promise.resolve({width:1/0,height:1/0})},i.Ni=function(){return!1},i.kh=function(){return!1},i.Sa=function(e){var t=this.La();return"TV"!==t&&"CONSOLE"!==t&&"CAST"!==t||(e.ads.customPlayheadTracker=!0,e.ads.skipPlayDetection=!0,e.ads.supportsMultipleMediaElements=!1),e},i.ph=function(){return!!e.indexedDB},i.ui=function(){return[]},i.Ui=function(){return!1},i.ji=function(){return!1},i.$g=function(){return!1},i.oh=function(){return!0},i.ki=function(){return!1},i.Ti=function(){return!0},i.toString=function(){return"Device: "+this.Mb()+" v"+this.Ca()+"; Type: "+this.La()},b(qT,HT),i=qT.prototype,i.Ca=function(){return this.g.value()},i.Mb=function(){return"Apple Browser"},i.La=function(){return this.h.value()},i.Da=function(){return"WEBKIT"},i.bc=function(){return!1},i.ce=function(e,t){return"audio"===t},i.Ye=function(){return!0},i.zi=function(e){return"audio"===e},i.Sa=function(e){return HT.prototype.Sa.call(this,e),e.abr.minTimeToSwitch=.5,e},i.Ui=function(){return!0},(navigator.vendor||"").includes("Apple")&&(/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||1<navigator.maxTouchPoints||navigator.userAgentData&&navigator.userAgentData.platform&&"macos"==navigator.userAgentData.platform.toLowerCase()||navigator.platform&&navigator.platform.toLowerCase().includes("mac"))&&(de=function(){return new qT}),b(YT,HT),i=YT.prototype,i.Ca=function(){return this.h.value()},i.Mb=function(){return"Chromecast with "+this.g.value()},i.La=function(){return"CAST"},i.Da=function(){return"CHROMIUM"},i.bc=function(){return HT.prototype.bc.call(this)&&this.g.value()!==JT},i.$c=function(){return this.g.value()!==JT},i.Ei=function(){switch(this.g.value()){case XT:return 0;case QT:return 3;default:return 1}},i.fc=function(){var t,n,i,r,s;return U(function(a){switch(a.g){case 1:if(t=e.cast&&cast.__platform__&&cast.__platform__.canDisplayType,n={width:1280,height:720},x(a,2),!(i=t)){a.u(4);break}return w(a,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160'),5);case 5:i=a.h;case 4:if(i){n.width=3840,n.height=2160,a.u(6);break}if(!(r=t)){a.u(7);break}return w(a,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=1920; height=1080'),8);case 8:r=a.h;case 7:r&&(n.width=1920,n.height=1080);case 6:k(a,3);break;case 2:s=L(a),X("Failed to check canDisplayType:",s);case 3:return a.return(n)}})},i.Sa=function(e){return HT.prototype.Sa.call(this,e),e.streaming.stallSkip=0,e},i.ph=function(){return!1};var XT="Android",QT="Fuchsia",JT="Linux";function ZT(){HT.call(this);var e=this;this.i=new le(function(){var e=navigator.userAgent.match(/(Chrome|Firefox)\/(\d+)/);return e?parseInt(e[2],10):null}),this.g=new le(function(){return navigator.userAgent.match(/Edge?\//)?"Edge":navigator.userAgent.includes("Chrome")?"Chrome":navigator.userAgent.includes("Firefox")?"Firefox":"Unknown"}),this.h=new le(function(){return navigator.userAgentData&&navigator.userAgentData.platform?"windows"==navigator.userAgentData.platform.toLowerCase():!!navigator.platform&&navigator.platform.toLowerCase().includes("win32")}),this.o=new le(function(){return!navigator.userAgent.match(/Edge?\//)||!e.h.value()}),this.m=new le(function(){return navigator.userAgent.includes("sony.hbbtv.tv.G5")})}function eS(){HT.apply(this,arguments)}function tS(){HT.call(this),this.g=new le(function(){var e=navigator.userAgent.match(/PlayStation (\d+)/);return e?parseInt(e[1],10):null})}function nS(){HT.call(this);var e=navigator.userAgent.match(/Tizen (\d+).(\d+)/);this.g=e?parseInt(e[1],10):null,this.h=e?parseInt(e[2],10):null}function iS(){HT.apply(this,arguments)}function rS(){HT.call(this),this.h=new le(function(){return navigator.userAgent.includes("DT_STB_BCM")}),this.g=new le(function(){if(navigator.userAgent.includes("DT_STB_BCM"))return 11;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null})}function sS(){HT.call(this),this.g=aS()}function aS(){var e=null,t=navigator.userAgent.match(/Chrome\/(\d+)/);switch(t&&(e=parseInt(t[1],10)),e){case 38:return 3;case 53:return 4;case 68:return 5;case 79:return 6;case 87:return 22;case 94:return 23;case 108:return 24;case 120:return 25;default:return null}}function oS(){HT.call(this),this.g=navigator.userAgent.includes("Edge/");var e=navigator.userAgent.match(/Edge?\/(\d+)/);this.h=e?parseInt(e[1],10):null}function uS(){var e=null;try{e="undefined"!==typeof Windows?Windows:chrome.webview.hostObjects.sync.Windows}catch(t){}return e}function lS(e,t,n){this.type=e,this.ba=t,this.segments=n||null}function cS(e,t,n,i){this.id=e,this.name=t,this.attributes=n,this.value=void 0===i?null:i}function dS(e,t){return t?e.toString():(t=(new Set).add("AUDIO").add("VIDEO").add("SUBTITLES").add("PATHWAY-ID").add("GROUP-ID").add("URI"),e.toString(t))}function hS(e,t){return e=e.attributes.filter(function(e){return e.name==t}),e.length?e[0]:null}function fS(e,t,n){return(e=hS(e,t))?e.value:n||null}function pS(e,t){if(e=hS(e,t),!e)throw new Ve(2,4,4023,t);return e.value}function gS(e,t,n){n=void 0===n?[]:n,this.ba=t,this.g=e,this.Zb=n}function mS(e,t){this.name=e,this.value=t}function vS(e,t){return e.filter(function(e){return e.name==t})}function yS(e,t){return e.filter(function(e){return pS(e,"TYPE")==t})}function bS(e,t){e=d(e);for(var n=e.next();!n.done;n=e.next())if(n=n.value,n.name===t)return n;return null}function TS(e,t,n){return n=void 0===n?0:n,(e=bS(e,t))?Number(e.value):n}function SS(e,t,n){return t?ES(e,[t],n):[]}function ES(e,t,n){if(!t.length)return[];var i=t;return n&&n.size&&(i=t.map(function(e){return wS(e,n)})),ot(e,i)}function wS(e,t){if(!t||!t.size)return e;e=String(e).replace(/%7B/g,"{").replace(/%7D/g,"}");var n=e.match(/{\$\w*}/g);if(n){n=d(n);for(var i=n.next();!i.done;i=n.next()){i=i.value;var r=i.slice(2,i.length-1),s=t.get(r);if(!s)throw new Ve(2,4,4039,r);e=e.replace(i,s)}}return e}function AS(){this.g=0}function xS(e,t){t=We(t),t=t.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim();var n=t.split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(n[0]))throw new Ve(2,4,4015);t=0;for(var i=!0,r=d(n),s=r.next();!s.done;s=r.next())if(s=s.value,/^#(?!EXT)/m.test(s)||i)i=!1;else{if(s=IS(e,s),--e.g,kS.includes(s.name)){t=1;break}"EXT-X-STREAM-INF"==s.name&&(i=!0)}for(r=[],i=!0,s=0;s<n.length;s++){var a=n[s],o=n[s+1];if(/^#(?!EXT)/m.test(a)||i)i=!1;else{if(a=IS(e,a),LS.includes(a.name)){if(1!=t)throw new Ve(2,4,4017);a=n.splice(s,n.length-s),n=[],i=[],s=[],o=null,a=d(a);for(var u=a.next();!u.done;u=a.next())u=u.value,/^(#EXT)/.test(u)?(u=IS(e,u),kS.includes(u.name)?r.push(u):"EXT-X-MAP"==u.name?o=u:"EXT-X-PART"==u.name?s.push(u):"EXT-X-PRELOAD-HINT"==u.name?"PART"==fS(u,"TYPE")?s.push(u):"MAP"==fS(u,"TYPE")&&(u.name="EXT-X-MAP",o=u):i.push(u)):/^#(?!EXT)/m.test(u)||(u=u.trim(),o&&i.push(o),n.push(new gS(u,i,s)),i=[],s=[]);return s.length&&(o&&i.push(o),n.push(new gS("",i,s))),new lS(t,r,n)}r.push(a),"EXT-X-STREAM-INF"==a.name&&(a.attributes.push(new mS("URI",o)),i=!0)}}return new lS(t,r)}function IS(e,t){e=e.g++;var n=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!n)throw new Ve(2,4,4016,t);t=n[1];var i,r=n[2];if(n=[],r){var s;r=new jt(r),(s=Gt(r,/^([^,=]+)(?:,|$)/g))&&(i=s[1]);for(var a=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;s=Gt(r,a);)n.push(new mS(s[1],s[2]||s[3])),$t(r)}return new cS(e,t,n,i)}zT()&&(de=function(){return new YT}),b(ZT,HT),i=ZT.prototype,i.Ca=function(){return this.i.value()},i.Mb=function(){return this.g.value()},i.ce=function(e){return!!Ur(e)&&("Edge"===this.g.value()&&this.h.value())},i.xi=function(){return"Edge"===this.g.value()&&this.h.value()},i.Ye=function(){return"Edge"===this.g.value()&&this.h.value()},i.$c=function(){return this.o.value()},i.Sa=function(e){if(HT.prototype.Sa.call(this,e),this.h.value())switch(this.g.value()){case"Firefox":e.drm.keySystemsMapping={"com.microsoft.playready":"com.microsoft.playready.recommendation"};break;case"Chrome":e.drm.keySystemsMapping={"com.microsoft.playready":"com.microsoft.playready.recommendation.3000","com.microsoft.playready.recommendation":"com.microsoft.playready.recommendation.3000"}}return e},i.$g=function(){return"Edge"===this.g.value()||this.m.value()},he=function(){return new ZT},b(eS,HT),i=eS.prototype,i.Ca=function(){return null},i.Mb=function(){return"Hisense"},i.La=function(){return"TV"},i.bc=function(){return!1},i.fc=function(){var t={width:1920,height:1080},n=null;if(e.Hisense_Get4KSupportState)try{n=e.Hisense_Get4KSupportState()}catch(i){}return null==n&&(n=navigator.userAgent.includes("UHD")),n&&(t.width=3840,t.height=2160),Promise.resolve(t)},i.Sa=function(e){return HT.prototype.Sa.call(this,e),e.streaming.stallSkip=0,e},(navigator.userAgent.includes("Hisense")||navigator.userAgent.includes("VIDAA"))&&(de=function(){return new eS}),b(tS,HT),i=tS.prototype,i.Mb=function(){return"PlayStation"},i.La=function(){return"CONSOLE"},i.Da=function(){return"WEBKIT"},i.Ca=function(){return this.g.value()},i.bc=function(){return!1},i.Zc=function(){return!1},i.$c=function(){return!1},i.kh=function(){return 4===this.Ca()},i.fc=function(){var t,n,i,r,s;return U(function(a){switch(a.g){case 1:return t={width:1920,height:1080},n=!1,x(a,2),w(a,e.msdk.device.getDisplayInfo(),4);case 4:i=a.h,n="4K"===i.resolution,k(a,3);break;case 2:return L(a),x(a,5),w(a,e.msdk.device.getDisplayInfoImmediate(),7);case 7:r=a.h,n="4K"===r.resolution,k(a,3);break;case 5:s=L(a),Q("PlayStation: Failed to get the display info:",s);case 3:return n&&(t.width=3840,t.height=2160),a.return(t)}})},i.Sa=function(e){return HT.prototype.Sa.call(this,e),4===this.Ca()&&e.drm.preferredKeySystems.push("com.microsoft.playready"),e.streaming.clearDecodingCache=!0,e},i.$g=function(){return 4===this.Ca()},i.oh=function(){return 4!==this.Ca()},navigator.userAgent.includes("PlayStation")&&(de=function(){return new tS}),b(nS,HT),i=nS.prototype,i.Ca=function(){return this.g},i.Mb=function(){return"Tizen"},i.Da=function(){return"CHROMIUM"},i.La=function(){return"TV"},i.ce=function(){return!0},i.be=function(){return 3===this.Ca()},i.bc=function(){return!1},i.Zc=function(){var e=this.Ca();return null!==e?4<=e:HT.prototype.Zc.call(this)},i.$c=function(){return!1},i.ge=function(){return this.g&&this.h?5===this.g?5<=this.h:5<this.g:HT.prototype.ge.call(this)},i.fc=function(){var e={width:1920,height:1080};try{if(webapis.systeminfo&&webapis.systeminfo.getMaxVideoResolution){var t=webapis.systeminfo.getMaxVideoResolution();e.width=t.width,e.height=t.height}else webapis.productinfo.is8KPanelSupported&&webapis.productinfo.is8KPanelSupported()?(e.width=7680,e.height=4320):webapis.productinfo.isUdPanelSupported&&webapis.productinfo.isUdPanelSupported()&&(e.width=3840,e.height=2160)}catch(n){Q("Tizen: Error detecting screen size, default screen size 1920x1080.")}return Promise.resolve(e)},i.Sa=function(e){return HT.prototype.Sa.call(this,e),e.drm.ignoreDuplicateInitData=2!==this.Ca(),3===this.Ca()&&(e.streaming.crossBoundaryStrategy="reset"),e.streaming.shouldFixTimestampOffset=!0,e.streaming.stallSkip=0,e.streaming.gapPadding=2,e},i.ui=function(){var e=[];return null!==this.g&&5>this.g&&e.push("opus"),e},i.ji=function(){return!0},i.ki=function(){return 3===this.Ca()},navigator.userAgent.includes("Tizen")&&(de=function(){return new nS}),b(iS,HT),iS.prototype.Ca=function(){return null},iS.prototype.Mb=function(){return"Vizio"},iS.prototype.La=function(){return"TV"},iS.prototype.bc=function(){return!1},navigator.userAgent.includes("VIZIO SmartCast")&&(de=function(){return new iS}),b(rS,HT),i=rS.prototype,i.Ca=function(){return this.g.value()},i.Mb=function(){return"WebKit STB"},i.La=function(){return"TV"},i.Da=function(){return"WEBKIT"},i.bc=function(){return!1},i.Zc=function(){var e=this.g.value();return null===e||15<=e},i.fc=function(){return Promise.resolve({width:e.screen.width*e.devicePixelRatio,height:e.screen.height*e.devicePixelRatio})},i.oh=function(){return!this.h.value()},(navigator.userAgent.includes("DT_STB_BCM")||navigator.userAgent.includes("DT_STB_BCM")||!(!(navigator.vendor||"").includes("Apple")||/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||1<navigator.maxTouchPoints||navigator.userAgentData&&navigator.userAgentData.platform&&"macos"==navigator.userAgentData.platform.toLowerCase()||navigator.platform&&navigator.platform.toLowerCase().includes("mac")))&&(de=function(){return new rS}),b(sS,HT),i=sS.prototype,i.Ca=function(){return this.g},i.Mb=function(){return"WebOS"},i.La=function(){return"TV"},i.Da=function(){return"CHROMIUM"},i.bc=function(){return!1},i.Zc=function(){var e=this.Ca();return null!==e?3<e:HT.prototype.Zc.call(this)},i.$c=function(){var e=this.Ca();return null!==e?6<e:HT.prototype.$c.call(this)},i.ge=function(){var e=this.Ca();return null!==e?3<e:HT.prototype.ge.call(this)},i.fc=function(){var t={width:1920,height:1080};try{var n=JSON.parse(e.PalmSystem.deviceInfo);t.width=Math.max(1920,n.screenWidth),t.height=Math.max(1080,n.screenHeight)}catch(i){Q("WebOS: Error detecting screen size, default screen size 1920x1080.")}return Promise.resolve(t)},i.Sa=function(e){return HT.prototype.Sa.call(this,e),3===this.Ca()&&(e.streaming.crossBoundaryStrategy="reset"),e.streaming.shouldFixTimestampOffset=!0,e.streaming.stallSkip=0,e},i.Ti=function(){return!1},navigator.userAgent.includes("Web0S")&&(de=function(){return new sS}),b(oS,HT),i=oS.prototype,i.Ca=function(){return this.h},i.Mb=function(){return"Xbox"},i.La=function(){return"CONSOLE"},i.Da=function(){return this.g?"EDGE":"CHROMIUM"},i.ce=function(){return!0},i.Ye=function(){return!0},i.Ni=function(){return this.g},i.fc=function(){var e={width:1920,height:1080},t=uS();if(t)try{var n=new t.Media.Protection.ProtectionCapabilities,i=t.Media.Protection.ProtectionCapabilityResult;t=null;do{t=n.isTypeSupported('video/mp4;codecs="hvc1,mp4a";features="decode-res-x=3840,decode-res-y=2160,decode-bitrate=20000,decode-fps=30,decode-bpc=10,display-res-x=3840,display-res-y=2160,display-bpc=8"',"com.microsoft.playready.recommendation")}while(t===i.maybe);t===i.probably&&(e.width=3840,e.height=2160)}catch(r){Q("Xbox: Error detecting screen size, default screen size 1920x1080.")}return Promise.resolve(e)},i.Sa=function(e){return HT.prototype.Sa.call(this,e),e.drm.parseInbandPsshEnabled=this.g,e.drm.preferredKeySystems.push("com.microsoft.playready"),this.g&&(e.streaming.gapPadding=.01),e},i.ph=function(){return!1},(navigator.userAgent.includes("Xbox One")||null!==uS())&&(de=function(){return new oS}),cS.prototype.toString=function(e){function t(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)}var n="#"+this.name,i=this.attributes?this.attributes.filter(function(t){return!e||!e.has(t.name)}).map(t):[];return this.value&&i.unshift(this.value),0<i.length&&(n+=":"+i.join(",")),n};var kS="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP EXT-X-PART-INF EXT-X-DATERANGE".split(" "),LS="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP EXT-X-GAP EXT-X-TILES".split(" ");function RS(){}function CS(e,t){try{var n=DS(e);return zr({uri:e,originalUri:e,data:n.data,headers:{"content-type":n.contentType},originalRequest:t})}catch(i){return qr(i)}}function DS(t){var n=t.split(":");if(2>n.length||"data"!=n[0])throw new Ve(2,1,1004,t);if(n=n.slice(1).join(":").split(","),2>n.length)throw new Ve(2,1,1004,t);var i=n[0];t=e.decodeURIComponent(n.slice(1).join(",")),n=i.split(";"),i=n[0];var r,s=!1;return 1<n.length&&"base64"==n[n.length-1]&&(s=!0,n.pop()),r=s?it(t):ze(t),{data:r,contentType:i}}function MS(){var e=this;this.g=this.h=null,this.F=1,this.A=new Map,this.I=new Map,this.M=new Map,this.M.set("video",new Map),this.M.set("audio",new Map),this.M.set(ft,new Map),this.M.set("image",new Map),this.Yb=(new Map).set("com.apple.streamingkeydelivery",function(t,n,i){return BE(e,t,n,i)}).set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",function(e){var t=pS(e,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)){var n="cenc";"SAMPLE-AES"==t&&(n="cbcs"),t=pS(e,"URI"),t=DS(t.split("?")[0]),t=Be(t.data),n=ut("com.widevine.alpha",n,[{initDataType:"cenc",initData:t}]),(e=fS(e,"KEYID"))&&n.keyIds.add(e.toLowerCase().substr(2)),e=Promise.resolve(n)}else e=Promise.resolve(null);return e}).set("com.microsoft.playready",function(e){var t=pS(e,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)){var n="cenc";"SAMPLE-AES"==t&&(n="cbcs"),e=pS(e,"URI"),e=DS(e.split("?")[0]),e=Be(e.data),t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),t=Bs(e,t,new Set,0),n=ut("com.microsoft.playready",n,[{initDataType:"cenc",initData:t}]),(e=Qt(["<PLAYREADY>",nt(e),"</PLAYREADY>"].join("\n")))&&(n.licenseServerUri=vy(e)),n=Promise.resolve(n)}else n=Promise.resolve(null);return n}).set("urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c",function(e){var t=pS(e,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)){var n="cenc";"SAMPLE-AES"==t&&(n="cbcs"),t=pS(e,"URI"),t=DS(t.split("?")[0]),t=Be(t.data),n=ut("com.huawei.wiseplay",n,[{initDataType:"cenc",initData:t}]),(e=fS(e,"KEYID"))&&n.keyIds.add(e.toLowerCase().substr(2)),e=Promise.resolve(n)}else e=Promise.resolve(null);return e}),this.ab=new Set,this.i=new Map,this.l=null,this.C="",this.Oa=new AS,this.K=-1,this.ia=1/0,this.$=this.qc=this.Za=!1,this.B=new _i(function(){e.U&&!e.g.continueLoadingWhenPaused&&(e.S.Ja(e.U,"timeupdate"),e.U.paused)?e.S.za(e.U,"timeupdate",function(){return _E(e)}):_E(e)}),this.Ba=zE,this.m=null,this.Ta=0,this.o=1/0,this.Xa=this.Ka=this.P=0,this.W=new is,this.G=new Map,this.H=new Map,this.ya=new Map,this.oa=new Map,this.L=new Map,this.va=new Map,this.wa=new Map,this.nc=this.ka=!1,this.eb=new W(5),this.j=null,this.N=!0,this.S=new re,this.s=this.U=null,this.Xb=function(){return!1}}function PS(e,t){return OE(e)?e.M.get(t.type):t.ef}function _S(e,t){var n,i,r,s,a,o,u,l,c,f,p,g,m,v,y,b,T,S,E,I,R,C,D,M,P,_,O,N,F,B,j,$,G,V,H,K;return U(function(U){switch(U.g){case 1:if(t.stream.isAudioMuxedInVideo)return U.return();for(n=[],i=d(t.O()),r=i.next();!r.done;r=i.next())s=r.value,a=new Te(s),o=a.g,t.Ke&&(0<=t.Qb&&o.add("_HLS_msn",String(t.Qb)),0<=t.Rb&&o.add("_HLS_part",String(t.Rb))),t.Le&&o.add("_HLS_skip","YES"),Oe(o)&&Ae(a,xe(o.toString())),n.push(a.toString());return x(U,2),w(U,PE(e,n,!0).promise,4);case 4:u=U.h,k(U,3);break;case 2:throw l=L(U),e.h&&e.h.disableStream(t.stream),l;case 3:if(!t.stream.segmentIndex)return U.return();if(c=xS(e.Oa,u.data),1!=c.type)throw new Ve(2,4,4017);return f=u.uri,f==u.originalUri||t.O().includes(f)||t.wf.push(f),p=vS(c.ba,"EXT-X-DEFINE"),g=VS(e,p,f),m=t.stream,v=PS(e,t),w(U,mE(e,c,m.mimeType,t.O,g),5);case 5:for(y=U.h,b=y.keyIds,T=y.drmInfos,S=y.encrypted,E=y.Eh,m.encrypted||!S||E||(m.encrypted=!0),I=function(e,t){return e.size===t.size&&[].concat(h(e)).every(function(e){return t.has(e)})},I(m.keyIds,b)||(m.keyIds=b,m.drmInfos=T,e.h.newDrmInfo(m)),R=kE(e,c,v,g,t.O,t.type),C=R.segments,(D=R.bandwidth)&&(m.bandwidth=D),M=oc(m),P=d(C),_=P.next();!_.done;_=P.next())O=_.value,O.Y&&(O.Y.od=M);m.segmentIndex.Wd(C,e.l.Fb()),C.length&&(N=TS(c.ba,"EXT-X-MEDIA-SEQUENCE",0),B=(F=bS(c.ba,"EXT-X-SKIP"))?Number(fS(F,"SKIPPED-SEGMENTS")):0,j=pE(N,C),$=j.Qb,G=j.Rb,t.Qb=$+B,t.Rb=G,V=v.get(N),m.segmentIndex.$a(V)),(H=Wl(m.segmentIndex))&&(t.Tc=H.startTime,K=C[C.length-1],t.lc=K.endTime),bS(c.ba,"EXT-X-ENDLIST")&&(t.Pd=!0),TE(e,c),IE(e,c.ba,m.type,g,t.O),A(U)}})}function OS(e,t,n){n=void 0!==n&&n;for(var i=-1==e.K,r=d(t),s=r.next();!s.done;s=r.next()){s=s.value;var a=s.stream.segmentIndex,o=PS(e,s);if(a=Wl(a)){o=d(o);for(var u=o.next();!u.done;u=o.next()){u=d(u.value);var l=u.next().value;if(u.next().value==a.startTime){i&&(e.K=Math.max(e.K,l)),s.jg=l;break}}}}if(!(0>e.K))for(t=d(t),i=t.next();!i.done;i=t.next())i=i.value,(dE(e,i.type)||n)&&(r=i.stream.segmentIndex)&&(s=e.K-i.jg,0<s&&(r.g.splice(0,s),r=Wl(r))&&(r=-r.startTime,i.stream.segmentIndex.offset(r),US(e,i,r)))}function NS(e,t){if(1/0==e.ia){t=d(t);for(var n=t.next();!n.done;n=t.next())n=Wl(n.value.stream.segmentIndex),null!=n&&null!=n.h&&(e.ia=Math.min(e.ia,n.h))}if(t=e.ia,1/0!=t){n=d(e.i.values());for(var i=n.next();!i.done;i=n.next())if(i=i.value,!dE(e,i.type)){var r=i.stream.segmentIndex;if(null!=r){var s=Wl(r);if(s)if(null==s.h)X("Missing EXT-X-PROGRAM-DATE-TIME for stream",i.O(),"Expect AV sync issues!");else for(US(e,i,s.h-t-s.startTime),i=d(r),r=i.next();!r.done;r=i.next())r.value.qh(t)}}}}function US(e,t,n){if(!(.001>Math.abs(n))){t.Tc+=n,t.lc+=n,e=PS(e,t);for(var i=d(e),r=i.next();!r.done;r=i.next()){var s=d(r.value);r=s.next().value,s=s.next().value,e.set(r,s+n)}t.O()}}function FS(e,t){var n,i,r,s,a,o,u,l,c,f,p,g,m,v,y,b,T,S,E,x,I,k,L,R,C,D,M,P,_,O,N,F,B,j,$,G,V,H,K,W,q,Y,z;return U(function(U){switch(U.g){case 1:return n=pt,i=xS(e.Oa,t),r=vS(i.ba,"EXT-X-DEFINE"),s=[],a=[],o=[],e.l=new Sl(null,0),e.l.Yc(!0),u=function(){return[e.C]},l=null,c=new Map,1==i.type?(e.N=!1,F=vS(i.ba,"EXT-X-DEFINE"),c=VS(e,F,e.C),l=n.xa,B="",j=new Map,w(U,fE(e,e.F++,c,i,u,"",l,B,!0,"Media Playlist",null,j,null,!1,null,!1),7)):(GS(e,r),f=vS(i.ba,"EXT-X-MEDIA"),p=vS(i.ba,"EXT-X-STREAM-INF"),g=vS(i.ba,"EXT-X-IMAGE-STREAM-INF"),m=vS(i.ba,"EXT-X-I-FRAME-STREAM-INF"),v=vS(i.ba,"EXT-X-SESSION-KEY"),y=vS(i.ba,"EXT-X-SESSION-DATA"),b=vS(i.ba,"EXT-X-CONTENT-STEERING"),KS(e,y),w(U,WS(e,b),4));case 4:if(!e.g.ignoreSupplementalCodecs){for(T=[],S=d(p),E=S.next(),x={};!E.done;x={Ri:void 0},E=S.next())I=E.value,(k=fS(I,"SUPPLEMENTAL-CODECS"))&&(x.Ri=k.split(/\s*,\s*/).map(function(e){return e.split("/")[0]}),L=I.attributes.map(function(e){return function(t){var n=t.name,i=t.value;return"CODECS"==n&&(i=e.Ri.join(","),t=t.value.split(","),1<t.length&&(t=dt("audio",t))&&(i+=","+t)),new mS(n,i)}}(x)),T.push(new cS(I.id,I.name,L,null)));for(p.push.apply(p,h(T)),R=[],C=d(m),D=C.next(),M={};!D.done;M={Si:void 0},D=C.next())P=D.value,(_=fS(P,"SUPPLEMENTAL-CODECS"))&&(M.Si=_.split(/\s*,\s*/).map(function(e){return e.split("/")[0]}),O=P.attributes.map(function(e){return function(t){var n=t.name;return t=t.value,"CODECS"==n&&(t=e.Si.join(",")),new mS(n,t)}}(M)),R.push(new cS(P.id,P.name,O,null)));m.push.apply(m,h(R))}return HS(e,p),nE(e,f),N=QS(e,m),w(U,JS(e,p,v,f,u,e.A,N),5);case 5:return s=U.h,a=qS(e,f),w(U,zS(e,g,m),6);case 6:o=U.h,U.u(3);break;case 7:$=U.h,e.i.set(e.C,$),$.stream&&(G=oc($.stream),$.stream.segmentIndex.Db(function(e){e.Y&&(e.Y.od=G)})),l=$.stream.type,V=!0,(e.g.disableAudio&&"audio"==$.type||e.g.disableVideo&&"video"==$.type&&!$.stream.codecs.includes(","))&&(V=!1),V&&s.push({id:0,language:Vi(B||"und"),disabledUntilTime:0,primary:!0,audio:"audio"==$.type?$.stream:null,video:"video"==$.type?$.stream:null,bandwidth:$.stream.bandwidth||0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!e.h)throw new Ve(2,7,7001);if(yE(e,i),1==i.type&&(OE(e)&&(SE(e,i),H=e.o,e.B.ha(H)),K=Array.from(e.i.values()),cE(e,K),$S(e),IE(e,i.ba,l,c,u)),e.m={presentationTimeline:e.l,variants:s,textStreams:a,imageStreams:o,offlineSessionIds:[],sequenceMode:e.g.hls.sequenceMode,ignoreManifestTimestampsInSegmentsMode:e.g.hls.ignoreManifestTimestampsInSegmentsMode,type:"HLS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:e.s},e.$||!e.g.hls.disableCodecGuessing){U.u(8);break}for(W=[],q=d(e.m.variants),Y=q.next();!Y.done;Y=q.next())z=Y.value,z.audio&&""===z.audio.codecs&&W.push(z.audio.createSegmentIndex()),z.video&&""===z.video.codecs&&W.push(z.video.createSegmentIndex());return w(U,Promise.all(W),8);case 8:e.h.makeTextStreamsForClosedCaptions(e.m),A(U)}})}function BS(e,t){var n,i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T;return U(function(S){if(1==S.g)return n=wc(e.g.hls.mediaPlaylistFullMimeType),t.length?(i=CE(e,t),r=i.segment,s=i.segmentIndex,a=r.O(),o=a[0],u=new Te(o),l=u.mb.split(".").pop(),(c=GE.get(l))?S.return(wc(c)):w(S,Promise.all([jS(e,r.Y,0),jS(e,r,s)]),2)):S.return(n);if(h=S.h,f=h[1].mimeType,p=h[0].data,g=h[1].data,m="mp4 mp4a m4s m4i m4a m4f cmfa mp4v m4v cmfv fmp4".split(" "),v=["audio/mp4","video/mp4","video/iso.segment"],y=r.Y||v.includes(f),!y&&Iu(Be(g))){var E=g,A=e.g.disableAudio,x=e.g.disableVideo,I=e.g.disableText,k=Be(E),L=(new Tu).parse(k),R=L.Md();k=L.Dg();var C=[],D=!1,M=!1;if(!A)switch(R.audio){case"aac":case"aac-loas":L.rb().length&&(C.push("mp4a.40.2"),D=!0);break;case"mp3":L.rb().length&&(C.push("mp4a.40.34"),D=!0);break;case"ac3":L.rb().length&&(C.push("ac-3"),D=!0);break;case"ec3":L.rb().length&&(C.push("ec-3"),D=!0);break;case"opus":L.rb().length&&(C.push("opus"),D=!0)}if(!x)switch(R.video){case"avc":k.codec?C.push(k.codec):C.push("avc1.42E01E"),M=!0;break;case"hvc":k.codec?C.push(k.codec):C.push("hvc1.1.6.L93.90"),M=!0;break;case"av1":C.push("av01.0.01M.08"),M=!0}if(C.length){if(A=D&&!M,x=new Map,M&&!I){for(I=new Lt("video/mp2t"),I.rf(E),E=d(I.Pf()),M=E.next();!M.done;M=E.next())M=M.value,x.set(M,M);I.Cd()}k={type:A?"audio":"video",mimeType:"video/mp2t",codecs:C.join(", "),language:null,height:k.height,width:k.width,channelCount:null,sampleRate:null,closedCaptions:x,le:null,colorGamut:null,frameRate:k.frameRate}}else k=null;if(b=k)return S.return(b)}else if((y||m.includes(l))&&(T=Ac(p,g,e.g.disableText)))return S.return(T);return f?S.return(wc(f)):S.return(n)})}function jS(e,t,n){var i,r,s,a,o,u;return U(function(l){switch(l.g){case 1:return t?(i=gs,r=Rc(t.O(),t.zc(),t.xc(),e.g.retryParameters),s=t instanceof No?1:0,w(l,UE(e,r,i,{type:s}).promise,2)):l.return({mimeType:null,data:null});case 2:if(a=l.h,o=a.data,!t.aesKey){l.u(3);break}return w(l,Lc(o,t.aesKey,n),4);case 4:o=l.h;case 3:return t instanceof No?t.ee(o,!0):t.ee(o),(u=a.headers["content-type"])&&(u=u.split(";")[0].toLowerCase()),l.return({mimeType:u,data:o})}})}function $S(e){if(OE(e)){if(e.Ba==QE){for(var t=1/0,n=1/0,i=d(e.i.values()),r=i.next();!r.done;r=i.next())r=r.value,r.stream.segmentIndex&&"text"!=r.stream.type&&!r.stream.isAudioMuxedInVideo&&(t=Math.min(t,r.lc),n=Math.min(n,r.Tc));t=t-n||0,isNaN(e.g.availabilityWindowOverride)||(t=e.g.availabilityWindowOverride),e.l.Cf(t)}}else e.l.ob(uE(e));if(!e.l.o)for(t=d(e.i.values()),n=t.next();!n.done;n=t.next())n=n.value,!n.stream.segmentIndex||"audio"!=n.type&&"video"!=n.type||(n=Wl(n.stream.segmentIndex))&&n.h&&e.l.hh(n.h);e.l.df()}function GS(e,t){var n=new Te(e.C).g;t=d(t);for(var i=t.next();!i.done;i=t.next()){var r=i.value;i=fS(r,"NAME");var s=fS(r,"VALUE");r=fS(r,"QUERYPARAM"),i&&s&&(e.A.has(i)||e.A.set(i,s)),r&&(i=n.get(r)[0])&&!e.A.has(i)&&e.A.set(r,i)}}function VS(e,t,n){n=new Te(n).g;var i=new Map;t=d(t);for(var r=t.next();!r.done;r=t.next()){var s=r.value,a=fS(s,"NAME"),o=fS(s,"VALUE");r=fS(s,"QUERYPARAM"),s=fS(s,"IMPORT"),a&&o&&(i.has(a)||i.set(a,o)),r&&(a=n.get(r)[0])&&!i.has(a)&&i.set(r,a),s&&(r=e.A.get(s))&&i.set(s,r)}return i}function HS(e,t){t=d(t);for(var n=t.next();!n.done;n=t.next()){var i=n.value,r=fS(i,"AUDIO");n=fS(i,"VIDEO");var s=fS(i,"SUBTITLES");if(i=eE(e,i),s){var a=dt(ft,i);e.H.set(s,a),Ut(i,a)}r&&(s=dt("audio",i),s||(s=e.g.hls.defaultAudioCodec),e.H.set(r,s)),n&&(r=dt("video",i),r||(r=e.g.hls.defaultVideoCodec),e.H.set(n,r))}}function KS(e,t){t=d(t);for(var n=t.next();!n.done;n=t.next()){var i=n.value,r=fS(i,"DATA-ID");n=fS(i,"URI");var s=fS(i,"LANGUAGE");i=fS(i,"VALUE"),r=(new Map).set("id",r),n&&r.set("uri",SS([e.C],n,e.A)[0]),s&&r.set("language",s),i&&r.set("value",i),n=new Zr("sessiondata",r),e.h&&e.h.onEvent(n)}}function WS(e,t){var n,i,r,s,a,o;return U(function(u){if(!e.h||!e.g)return u.return();for(i=d(t),r=i.next();!r.done;r=i.next())if(s=r.value,a=fS(s,"PATHWAY-ID"),o=fS(s,"SERVER-URI"),a&&o){e.j=new pb(e.h),e.j.configure(e.g),e.j.i=[e.C],e.j.setManifestType("HLS"),e.j.h=a,n=gb(e.j,o);break}return w(u,n,0)})}function qS(e,t){var n=yS(t,"SUBTITLES");t=n.map(function(t){if(e.g.disableText)return null;try{return iE(e,[t],new Map).stream}catch(n){if(e.g.hls.ignoreTextStreamFailures)return null;throw n}}),n=d(n);for(var i=n.next();!i.done;i=n.next()){var r=pS(i.value,"GROUP-ID");if((i=e.H.get(r))&&(r=e.I.get(r))){r=d(r);for(var s=r.next();!s.done;s=r.next())s=s.value,s.stream.codecs=i,s.stream.mimeType=LE(ft,i)||RE(ft),YS(s.stream)}}return t.filter(function(e){return e})}function YS(e){var t=new Set([hi(e.mimeType,e.codecs)]);e.segmentIndex&&e.segmentIndex.Db(function(n){n.mimeType&&t.add(hi(n.mimeType,e.codecs))}),e.fullMimeTypes=t}function zS(e,t,n){var i,s;return U(function(a){return 1==a.g?(i=t.map(function(t){var n,i;return U(function(r){if(1==r.g)return e.g.disableThumbnails?r.return(null):(x(r,2),w(r,rE(e,t),4));if(2!=r.g)return n=r.h,r.return(n.stream);if(i=L(r),e.g.hls.ignoreImageStreamFailures)return r.return(null);throw i})}).concat(n.map(function(t){if(e.g.disableThumbnails)return null;try{var n=sE(e,t);return"image"!==n.stream.type?null:n.stream}catch(r){if(e.g.hls.ignoreImageStreamFailures)return null;throw r}})),w(a,Promise.all(i),2)):(s=a.h,a.return(s.filter(function(e){return e})))})}function XS(e,t,n){t=t.filter(function(e){var t=fS(e,"URI")||"";return e=fS(e,"TYPE"),"SUBTITLES"!=e&&(""!=t||"AUDIO"==e)});var i={};t=d(t);for(var r=t.next();!r.done;r=t.next()){r=r.value;var s=dS(r,!e.j);i[s]?i[s].push(r):i[s]=[r]}for(var a in i)iE(e,i[a],n,!1)}function QS(e,t){return t.map(function(t){return t=sE(e,t),"video"!==t.stream.type?null:t.stream}).filter(function(e){return e})}function JS(e,t,n,i,r,s,a){var o,u,l,c,f,p,g,m,v,y,b,T,S,E,A,x,I,k,L,R,C,D,M,P,_,O,N,F,B,j,$,G,V,H,K,W;return U(function(U){switch(U.g){case 1:if(o=[],u=new Set,e.g.ignoreDrmInfo||!(0<n.length)){U.u(2);break}l=d(n),c=l.next();case 3:if(c.done){U.u(2);break}if(f=c.value,p=pS(f,"METHOD"),g=fS(f,"KEYFORMAT")||"identity",m=null,"NONE"==p){U.u(4);break}if(FE(p)){v=SS(r(),pS(f,"URI"),s),y=v.sort().join(""),e.L.has(y)||(b=us(v,e.g.retryParameters),T=UE(e,b,6).promise,e.L.set(y,T)),U.u(4);break}if("identity"==g)return w(U,jE(e,f,"",r,null,s),12);if(S=e.Yb.get(g),!S){E=null,U.u(10);break}return w(U,S(f,"",null),11);case 11:E=U.h;case 10:m=E,U.u(6);break;case 12:m=U.h;case 6:if(m){if(m.keyIds)for(A=d(m.keyIds),x=A.next();!x.done;x=A.next())I=x.value,u.add(I);o.push(m)}case 4:c=l.next(),U.u(3);break;case 2:for(k={},L=d(t),R=L.next();!R.done;R=L.next())C=R.value,D=dS(C,!e.j),k[D]?k[D].push(C):k[D]=[C];for(P in M=[],k)_=k[P],O=_[0],N=fS(O,"FRAME-RATE"),F=Number(fS(O,"AVERAGE-BANDWIDTH"))||Number(pS(O,"BANDWIDTH")),B=fS(O,"RESOLUTION"),j=d(B?B.split("x"):[null,null]),$=j.next().value,G=j.next().value,V=fS(O,"VIDEO-RANGE"),(H=fS(O,"REQ-VIDEO-LAYOUT"))&&H.includes(",")&&(K=H.split(",").filter(function(e){return"CH-STEREO"==e||"CH-MONO"==e}),H=K[0]),H=H||"CH-MONO",W=ZS(e,_,i),M.push.apply(M,h(tE(e,W.audio,W.video,F,$,G,N,V,H,o,u,a)));return U.return(M.filter(function(e){return null!=e}))}})}function ZS(e,t,n){for(var i={audio:[],video:[]},r=new Map,s=[],a=!1,o=!1,u=d(t),l=u.next();!l.done;l=u.next()){var c=l.value;l=fS(c,"AUDIO");var f=fS(c,"VIDEO"),p=l||f;p&&(s.includes(p)||s.push(p),(c=fS(c,"PATHWAY-ID"))&&r.set(p,c),l?a=!0:f&&(o=!0))}s.length&&n.length&&(n=n.filter(function(e){return s.includes(pS(e,"GROUP-ID"))}),XS(e,n,r)),n=(r=s.sort().join(","))&&e.I.has(r)?e.I.get(r):[],a?i.audio.push.apply(i.audio,h(n)):o&&i.video.push.apply(i.video,h(n)),a=!1;var g=t.map(function(e){return pS(e,"URI")});return l=i.audio.find(function(e){return e&&e.O().find(function(e){return g.includes(e)})}),o=eE(e,t[0]),n=dt("video",o),(u=dt("audio",o))&&!n?(l="audio",a=0<i.audio.length):!i.audio.length&&!i.video.length&&u&&n?(l="video",o=[[n,u].join()]):i.audio.length&&l?(l="audio",a=!0):l=i.video.length&&!i.audio.length?"audio":"video",a||(e=aE(e,t,o,l),r&&(e.stream.groupId=r),i[e.stream.type]=[e]),i}function eE(e,t){return t=fS(t,"CODECS")||"",e.$=0<t.length,e.$||e.g.hls.disableCodecGuessing||(t=[],e.g.disableVideo||t.push(e.g.hls.defaultVideoCodec),e.g.disableAudio||t.push(e.g.hls.defaultAudioCodec),t=t.join(",")),xc(t.split(/\s*,\s*/))}function tE(e,t,n,i,r,s,a,o,u,l,c,h){for(var f=d(n),p=f.next();!p.done;p=f.next())ME(p.value.stream,r,s,a,o,u,null);for(r=e.g.disableAudio,t.length&&!r||(t=[null]),r=e.g.disableVideo,n.length&&!r||(n=[null]),r=[],t=d(t),s=t.next();!s.done;s=t.next())for(s=s.value,a=d(n),o=a.next();!o.done;o=a.next()){var g=o.value;(o=s?s.stream:null)&&(o.drmInfos=l,o.keyIds=c),(u=g?g.stream:null)&&(u.drmInfos=l,u.keyIds=c,e.g.disableIFrames||wr(u,h)),u&&!o&&(u.bandwidth=i),!u&&o&&(o.bandwidth=i),f=s?s.stream.drmInfos:null,p=g?g.stream.drmInfos:null,g=g?g.O().sort().join(","):"";var m=s?s.O().sort().join(","):"",v=[];o&&o.codecs&&v.push(o.codecs),u&&u.codecs&&v.push(u.codecs),g=[g,m,v.sort()].join("-"),o&&u&&!Or(f,p)||e.ab.has(g)||(o={id:e.F++,language:o?o.language:"und",disabledUntilTime:0,primary:!!o&&o.primary||!!u&&u.primary,audio:o,video:u,bandwidth:i,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},r.push(o),e.ab.add(g))}return r}function nE(e,t){t=yS(t,"CLOSED-CAPTIONS"),e.N=0==t.length,t=d(t);for(var n=t.next();!n.done;n=t.next()){var i=n.value,r=fS(i,"LANGUAGE");n=Vi(r||"und"),r||(r=fS(i,"NAME"))&&(n=r),r=pS(i,"GROUP-ID"),i=pS(i,"INSTREAM-ID").replace("SERVICE","svc"),e.G.get(r)||e.G.set(r,new Map),e.G.get(r).set(i,n)}}function iE(e,t,n,i){i=void 0===i||i;for(var r=[],s=[],a=new Map,o=d(t),u=o.next();!u.done;u=o.next()){var l=u.value;u=i?pS(l,"URI"):fS(l,"URI")||"shaka://hls-muxed",l=pS(l,"GROUP-ID"),r.push(u),s.push(l),a.set(l,u)}if(i=s.sort().join(","),u=t[0],t="",o=pS(u,"TYPE").toLowerCase(),"subtitles"==o&&(o=ft),o==ft)t=fS(u,"CODECS")||"";else for(s=d(s),l=s.next();!l.done;l=s.next())if(l=l.value,e.H.has(l)){t=e.H.get(l);break}if(s=r.sort().join(","),e.i.has(s))return e.i.get(s);if(l=e.F++,e.j){a=d(a);for(var c=a.next();!c.done;c=a.next()){var h=d(c.value);c=h.next().value,h=h.next().value,(c=n.get(c))&&yb(e.j,l,c,h)}}var f;n=fS(u,"LANGUAGE"),a=fS(u,"NAME"),c="YES"==fS(u,"DEFAULT"),h="audio"==o&&(h=fS(u,"CHANNELS"))?parseInt(h.split("/")[0],10):null,"audio"==o&&(f=fS(u,"CHANNELS"))?(f=f.split("/"),f=2==f.length&&("JOC"===f[1]||f[1].includes("ATMOS"))):f=!1;var p=fS(u,"CHARACTERISTICS"),g="YES"==fS(u,"FORCED");return u="audio"==o&&(u=fS(u,"SAMPLE-RATE"))?parseInt(u,10):null,r=oE(e,l,r,t,o,n,c,a,h,null,p,g,u,f),r.stream&&(r.stream.groupId=i),e.I.has(i)?e.I.get(i).push(r):e.I.set(i,[r]),e.i.set(s,r),r}function rE(e,t){var n,i,r,s,a,o,u,l,c,d;return U(function(h){return 1==h.g?(n=pS(t,"URI"),i=fS(t,"CODECS","jpeg")||"",e.i.has(n)?h.return(e.i.get(n)):(r=fS(t,"LANGUAGE"),s=fS(t,"NAME"),a=fS(t,"CHARACTERISTICS"),o=oE(e,e.F++,[n],i,"image",r,!1,s,null,null,a,!1,null,!1),(u=fS(t,"RESOLUTION"))?w(h,o.stream.createSegmentIndex(),3):h.u(2))):(2!=h.g&&(l=Wl(o.stream.segmentIndex),c=l.tilesLayout)&&(o.stream.width=Number(u.split("x")[0])*Number(c.split("x")[0]),o.stream.height=Number(u.split("x")[1])*Number(c.split("x")[1])),(d=fS(t,"BANDWIDTH"))&&(o.stream.bandwidth=Number(d)),e.i.set(n,o),h.return(o))})}function sE(e,t){var n="video",i=pS(t,"URI"),r=fS(t,"CODECS")||"";if("mjpg"==r&&(n="image"),e.i.has(i))return e.i.get(i);var s=fS(t,"LANGUAGE"),a=fS(t,"NAME"),o=fS(t,"CHARACTERISTICS");return n=oE(e,e.F++,[i],r,n,s,!1,a,null,null,o,!1,null,!1),r=fS(t,"RESOLUTION"),s=d(r?r.split("x"):[null,null]),r=s.next().value,s=s.next().value,n.stream.width=Number(r)||void 0,n.stream.height=Number(s)||void 0,(t=fS(t,"BANDWIDTH"))&&(n.stream.bandwidth=Number(t)),e.i.set(i,n),n}function aE(e,t,n,i){for(var r=e.F++,s=[],a=d(t),o=a.next();!o.done;o=a.next()){var u=o.value;o=pS(u,"URI"),u=fS(u,"PATHWAY-ID"),e.j&&u&&yb(e.j,r,u,o),s.push(o)}if(a=s.sort().join(",")+n.sort().join(","),e.i.has(a))return e.i.get(a);o=s.join(",");e:{if(t=fS(t[0],"CLOSED-CAPTIONS"),"video"==i){if(e.g.disableText){e.N=!1,t=null;break e}if(t){if("NONE"!=t){t=e.G.get(t);break e}e.N=!1}else if(!t&&e.G.size)for(t=d(e.G.keys()).next();!t.done;){t=e.G.get(t.value);break e}}t=null}return n=ct(i,n),i=oE(e,r,s,n,i,null,!1,o,null,t,null,!1,null,!1),e.i.set(a,i),i}function oE(e,t,n,i,r,s,a,o,u,l,c,h,f,p){function g(t){var n,g,y,T,S,E,I,R,C,D,M,P,_,O,N,F,B,j,$,G,V,H,K;return U(function(U){switch(U.g){case 1:return n=pt,x(U,2),w(U,t.promise,4);case 4:if(g=U.h,t.aborted)return U.return();if(y=g.uri,y!=g.originalUri&&(T=b.O(),T.includes(y)||b.wf.push(y)),S=xS(e.Oa,g.data),1!=S.type)throw new Ve(2,4,4017);return E=vS(S.ba,"EXT-X-DEFINE"),I=VS(e,E,y),R=!1,(!e.$&&e.g.hls.disableCodecGuessing||e.N&&r==n.xa&&!e.g.hls.disableClosedCaptionsDetection)&&0<S.segments.length&&(e.N=!1,R=!0),C=!e.$&&e.g.hls.disableCodecGuessing,D=OE(e),w(U,fE(e,0,I,S,m,i,r,s,a,o,u,l,c,h,f,p,void 0,R,C),5);case 5:if(M=U.h,t.aborted)return U.return();if(P=M.stream,yE(e,S),OE(e)&&!D&&SE(e,S),b.Tc=M.Tc,b.lc=M.lc,b.Le=M.Le,b.Ke=M.Ke,b.Pd=M.Pd,b.ef=M.ef,b.Qb=M.Qb,b.Rb=M.Rb,b.Kg=!0,v.segmentIndex=P.segmentIndex,v.encrypted=P.encrypted,v.drmInfos=P.drmInfos,v.keyIds=P.keyIds,v.mimeType=P.mimeType,v.bandwidth=v.bandwidth||P.bandwidth,v.codecs=v.codecs||P.codecs,v.closedCaptions=v.closedCaptions||P.closedCaptions,v.width=v.width||P.width,v.height=v.height||P.height,v.hdr=v.hdr||P.hdr,v.colorGamut=v.colorGamut||P.colorGamut,v.frameRate=v.frameRate||P.frameRate,"und"==v.language&&"und"!=P.language&&(v.language=P.language),v.language=v.language||P.language,v.channelsCount=v.channelsCount||P.channelsCount,v.audioSamplingRate=v.audioSamplingRate||P.audioSamplingRate,YS(v),v.drmInfos.length&&e.h.newDrmInfo(v),_=!1,(!l&&v.closedCaptions||l&&v.closedCaptions&&l.size!=v.closedCaptions.size)&&(_=!0),e.m&&_&&e.h.makeTextStreamsForClosedCaptions(e.m),r==n.xa||r==n.ea)for(O=d(e.i.values()),N=O.next();!N.done;N=O.next())F=N.value,F.Kg||F.type!=r||F.stream.isAudioMuxedInVideo||(F.stream.mimeType=P.mimeType,YS(F.stream));r==n.Ya&&(B=Wl(P.segmentIndex))&&B.Y&&(v.mimeType="application/mp4",YS(v)),j=oc(v),v.segmentIndex.Db(function(e){e.Y&&(e.Y.od=j)}),hE(e)&&(e.qc?cE(e,[b]):(e.qc=!0,$=Array.from(e.i.values()),G=$.filter(function(e){return e.stream.segmentIndex}),cE(e,G),$S(e),V=e.o,0<V&&e.B.ha(V))),IE(e,S.ba,v.type,I,m),e.m&&(e.m.startTime=e.s),k(U,0);break;case 2:if(H=L(U),v.closeSegmentIndex(),7001===H.code)return U.return();if(K=e.h.disableStream(v),!K)throw H;A(U)}})}function m(){return e.j&&1<n.length?bb(e.j,t):b.wf.concat(ES([e.C],n,e.A))}var v=gE(e,i,r,s,a,o,u,l,c,h,f,p);n.includes("shaka://hls-muxed")&&(v.isAudioMuxedInVideo=!0,v.mimeType="video/mp2t",YS(v));var y,b={stream:v,type:r,wf:[],Tc:0,lc:0,ef:new Map,Le:!1,Ke:!1,Pd:!1,jg:-1,Qb:-1,Rb:-1,Kg:!1,O:m},T=null;return v.createSegmentIndex=function(){return T||(v.isAudioMuxedInVideo?(v.segmentIndex=new Kl([]),Promise.resolve()):(y=PE(e,b.O(),!0),T=new Promise(function(e){e(g(y))})))},v.closeSegmentIndex=function(){T&&!v.segmentIndex&&y.abort(),v.segmentIndex&&(v.segmentIndex.release(),v.segmentIndex=null),T=null},b}function uE(e){var t=1/0;e=d(e.i.values());for(var n=e.next();!n.done;n=e.next())n=n.value,n.stream.segmentIndex&&"text"!=n.stream.type&&!n.stream.isAudioMuxedInVideo&&(t=Math.min(t,n.lc));return t}function lE(e,t){var n=[];t=d(t);for(var i=t.next();!i.done;i=t.next())i=i.value,i.segmentIndex&&i.segmentIndex.Db(function(e){n.push(e)});e.l.Yd(n)}function cE(e,t){if(!OE(e))for(var n=uE(e),i=d(t),r=i.next();!r.done;r=i.next())r.value.stream.segmentIndex.hd(0,n);lE(e,t.map(function(e){return e.stream})),i=Array.from(e.i.values()).filter(function(e){return e.stream.segmentIndex}),n=i.some(function(e){return"audio"==e.stream.type}),r=i.some(function(e){return"video"==e.stream.type}),i=OE(e)&&!e.Za,n=!OE(e)&&e.Za&&!(n&&r),e.g.hls.ignoreManifestProgramDateTime||i||n?OS(e,t,i):(NS(e,t),0<e.g.hls.ignoreManifestProgramDateTimeForTypes.length&&OS(e,t))}function dE(e,t){return!!e.g.hls.ignoreManifestProgramDateTime||e.g.hls.ignoreManifestProgramDateTimeForTypes.includes(t)}function hE(e){if(!e.m)return!1;var t=[],n=[];e=d(e.m.variants);for(var i=e.next();!i.done;i=e.next())i=i.value,i.video&&t.push(i.video),i.audio&&n.push(i.audio);return!(0<t.length&&!t.some(function(e){return e.segmentIndex})||0<n.length&&!n.some(function(e){return e.segmentIndex}))}function fE(e,t,n,i,r,s,a,o,u,l,c,d,h,f,p,g,m,v,y){var b,T,S,E,A,x,I,k,L,R,C,D,M,P,_,O,N,F,B,j,$,G,V,H,K,W,q,Y,z;return v=void 0===v||v,y=void 0===y||y,U(function(t){switch(t.g){case 1:if(b=i.segments||[],T=b.every(function(e){return!!bS(e.ba,"EXT-X-GAP")}),!b.length||T)throw new Ve(2,4,4053);if(bE(e,i),OE(e)&&TE(e,i),S=OE(e)?e.M.get(a):new Map,E=kE(e,i,S,n,r,a),A=E.segments,x=E.bandwidth,C=R=L=k=I=null,!(0<A.length&&v)){t.u(2);break}return w(t,BS(e,A),3);case 3:D=t.h,a=D.type,o=D.language,c=D.channelCount,p=D.sampleRate,e.g.disableText||(d=D.closedCaptions),k=D.height,I=D.width,L=D.le,R=D.colorGamut,C=D.frameRate,y&&(m=D.mimeType,s=D.codecs);case 2:if(m){t.u(4);break}return w(t,DE(e,a,s,A),5);case 5:m=t.h,a!=ft||s||"application/mp4"!=m||!A[0]||A[0].Y||(m="text/vtt");case 4:return w(t,mE(e,i,m,r,n),6);case 6:if(M=t.h,P=M.drmInfos,_=M.keyIds,O=M.encrypted,N=M.Eh,O&&!P.length&&!N)throw new Ve(2,4,4026);return F=gE(e,s,a,o,u,l,c,d,h,f,p,g),F.encrypted=O&&!N,F.drmInfos=P,F.keyIds=_,F.mimeType=m,x&&(F.bandwidth=x),YS(F),"video"==a&&(I||k||L||R)&&ME(F,I,k,C,L,null,R),OE(e)&&TE(e,i),B=A[0].startTime,j=A[A.length-1],$=j.endTime,G=new Kl(A),F.segmentIndex=G,H=!!(V=bS(i.ba,"EXT-X-SERVER-CONTROL"))&&null!=hS(V,"CAN-SKIP-UNTIL"),K=!!V&&null!=hS(V,"CAN-BLOCK-RELOAD"),W=TS(i.ba,"EXT-X-MEDIA-SEQUENCE",0),q=pE(W,A),Y=q.Qb,z=q.Rb,t.return({stream:F,type:a,wf:[],O:r,Tc:B,lc:$,Le:H,Ke:K,Pd:!1,jg:-1,Qb:Y,Rb:z,ef:S,Kg:!1})}})}function pE(e,t){e=e+t.length-1;var n=-1;if(!t.length)return e++,{Qb:e,Rb:n};t=t[t.length-1];var i=t.g;return t.g.length?(n=i.length-1,i[i.length-1].isPreload()||(e++,n=0),{Qb:e,Rb:n}):(e++,t.m&&(n=0),{Qb:e,Rb:n})}function gE(e,t,n,i,r,s,a,o,u,l,c,h){var f=LE(n,t)||RE(n),p=[];if(u){u=d(u.split(","));for(var g=u.next();!g.done;g=u.next())p.push(g.value)}return u=void 0,g=null,n==ft?u=p.includes("public.accessibility.transcribes-spoken-dialog")&&p.includes("public.accessibility.describes-music-and-sound")?"caption":"subtitle":p.includes("public.accessibility.describes-video")&&(g="visually impaired"),p.length||"subtitle"!==u||p.push("subtitle"),e={id:e.F++,originalId:s,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:f,codecs:t,kind:n==ft?"subtitle":void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:Vi(i||"und"),originalLanguage:i,label:s,type:n,primary:r,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:p,forced:l,channelsCount:a,audioSamplingRate:c,spatialAudio:h,closedCaptions:o,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,accessibilityPurpose:g,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null},YS(e),e}function mE(e,t,n,i,r){var s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,A,x,I,k,L,R,C,D,M,P,_,O;return U(function(N){switch(N.g){case 1:if(s=new Map,!e.g.ignoreDrmInfo&&t.segments)for(a=d(t.segments),o=a.next();!o.done;o=a.next())if(u=o.value,l=vS(u.ba,"EXT-X-KEY"),c=null,l.length)for(c=EE(e,t,u.ba,i,r),h=d(l),f=h.next();!f.done;f=h.next())p=f.value,s.set(p,c);m=g=!1,v=[],y=new Set,b=d(s),T=b.next();case 2:if(T.done){N.u(4);break}if(S=T.value,E=d(S),A=E.next().value,x=E.next().value,I=A,k=x,L=pS(I,"METHOD"),"NONE"==L){N.u(3);break}if(g=!0,R=fS(I,"KEYFORMAT")||"identity",C=null,FE(L)){m=!0,N.u(3);break}if("identity"==R)return w(N,jE(e,I,n,i,k,r),11);if(D=e.Yb.get(R),!D){M=null,N.u(9);break}return w(N,D(I,n,k),10);case 10:M=N.h;case 9:C=M,N.u(6);break;case 11:C=N.h;case 6:if(C){if(C.keyIds)for(P=d(C.keyIds),_=P.next();!_.done;_=P.next())O=_.value,y.add(O);v.push(C)}case 3:T=b.next(),N.u(2);break;case 4:return N.return({drmInfos:v,keyIds:y,encrypted:g,Eh:m})}})}function vE(t,n,i,r,s){if(!e.crypto||!e.crypto.subtle)throw Q("Web Crypto API is not available to decrypt AES. (Web Crypto only exists in secure origins like https)"),new Ve(2,4,4042);var a=0,o=fS(n,"IV","");if(o){var u=rt(o.substr(2));if(16!=u.byteLength)throw new Ve(2,4,4048)}else a=TS(i.ba,"EXT-X-MEDIA-SEQUENCE",0);var l=SS(r(),pS(n,"URI"),s),c=l.sort().join("");if(i=n.toString()+"-"+a+"-"+c,!t.oa.has(i)){var d={bitsKey:128,blockCipherMode:"CBC",iv:u,firstMediaSequenceNumber:a};switch(pS(n,"METHOD")){case"AES-256":d.bitsKey=256;break;case"AES-256-CTR":d.bitsKey=256,d.blockCipherMode="CTR"}d.fetchKey=function(){var n,i,r,s;return U(function(a){if(1==a.g)return t.L.has(c)||(n=us(l,t.g.retryParameters),i=UE(t,n,6).promise,t.L.set(c,i)),w(a,t.L.get(c),2);if(3!=a.g){if(r=a.h,!r.data||r.data.byteLength!=d.bitsKey/8)throw new Ve(2,4,4049);return s={name:"CTR"==d.blockCipherMode?"AES-CTR":"AES-CBC",length:d.bitsKey},w(a,e.crypto.subtle.importKey("raw",r.data,s,!0,["decrypt"]),3)}d.cryptoKey=a.h,d.fetchKey=void 0,A(a)})},t.oa.set(i,d)}return t.oa.get(i)}function yE(e,t){null==e.s&&(t=bS(t.ba,"EXT-X-START"))&&(e.s=Number(pS(t,"TIME-OFFSET")))}function bE(e,t){var n=bS(t.ba,"EXT-X-PLAYLIST-TYPE");t=bS(t.ba,"EXT-X-ENDLIST"),t=n&&"VOD"==n.value||t,n=n&&"EVENT"==n.value&&!t,n=!t&&!n,NE(e,t?zE:n?QE:XE)}function TE(e,t){var n=1/0,i=t.segments;if(i.length)for(var r=i.length-1;0<=r;){var s=bS(i[r].ba,"EXTINF");if(s){n=Number(s.value.split(",")[0]);break}r--}if(i=bS(t.ba,"EXT-X-TARGETDURATION"),!i)throw new Ve(2,4,4024,"EXT-X-TARGETDURATION");i=Number(i.value),(r=bS(t.ba,"EXT-X-PART-INF"))&&(e.P=Number(pS(r,"PART-TARGET"))),t=bS(t.ba,"EXT-X-SERVER-CONTROL"),e.ka&&e.P?(e.o=e.nc?5*e.P<=n?Math.min(e.P,e.o):Math.min(n,e.o):Math.min(e.P,e.o),e.Xa=t?Number(pS(t,"PART-HOLD-BACK")):0):(e.o=Math.min(n,e.o),n=t?hS(t,"HOLD-BACK"):null,e.Ka=n?Number(n.value):0),e.Ta=Math.max(i,e.Ta)}function SE(e,t){var n=0;if(e.g.defaultPresentationDelay)n=e.g.defaultPresentationDelay;else if(e.Xa)n=e.Xa;else if(e.Ka)n=e.Ka;else{var i=t.segments.length,r=e.g.hls.liveSegmentsDelay;for(r>i-2&&(r=Math.max(1,i-2)),r=i-r;r<i;r++){var s=bS(t.segments[r].ba,"EXTINF");n=s?n+Math.ceil(Number(s.value.split(",")[0])):n+e.Ta}}e.s&&0>e.s&&(n=Math.min(-e.s,n),e.s+=n),e.l.Ji(0),e.l.gh(n),e.l.Yc(!1)}function EE(e,t,n,i,r){var s=bS(n,"EXT-X-MAP");if(!s)return null;var a=pS(s,"URI"),o=SS(i(),a,r);if(a=[o.toString(),fS(s,"BYTERANGE","")].join("-"),!e.ya.has(a)){var u=void 0,l=null,c=!1;n=d(n);for(var h=n.next();!h.done;h=n.next())h=h.value,"EXT-X-KEY"==h.name?(c=pS(h,"METHOD"),FE(c)&&h.id<s.id?(c=!1,u=vE(e,h,t,i,r)):c="NONE"!=c):"EXT-X-BYTERANGE"==h.name&&h.id<s.id&&(l=h);t=wE(o,s,l,u,c),e.ya.set(a,t)}return e.ya.get(a)}function wE(e,t,n,i,r){var s=0,a=null;return t=fS(t,"BYTERANGE"),!t&&n&&(t=n.value),t&&(s=t.split("@"),a=Number(s[0]),s=Number(s[1]),a=s+a-1,i&&(n=a+1-s,n%16&&(a+=16-n%16))),new _o(function(){return e},s,a,null,null,null,i,r)}function AE(t,n,i,r,s,a,o,u,l){function c(e){e=new Te(e).mb.split(".").pop();var t=qE.get(o).get(e);return t||(t=GE.get(e)),t}var h=r.ba,f=bS(h,"EXTINF"),p=0,g=0,m=null;r.Zb.length&&(t.m.isLowLatency=!0);var v=null;if(!t.g.hls.ignoreManifestProgramDateTime){var y=bS(h,"EXT-X-PROGRAM-DATE-TIME");y&&y.value&&(v=fn(y.value),t.Za=!0)}var b=Fo;if(bS(h,"EXT-X-GAP")&&(t.m.gapCount++,b=2),!f){if(0==r.Zb.length)throw new Ve(2,4,4024,"EXTINF");if(!t.ka)return null}var T=[];y=!1;var S=null,E=!1,w=!1;if(t.ka&&r.Zb.length){p=n&&e.ReadableStream&&t.g.hls.allowLowLatencyByteRangeOptimization;for(var A=v,x={},I=0;I<r.Zb.length;x={Jf:void 0,qf:void 0},I++){var k=r.Zb[I],L=0==I?i:T[T.length-1],R=0==I?s:L.endTime,C=Number(fS(k,"DURATION"))||t.P;if(C){var D=R+C,M=0,P=null;if("EXT-X-PRELOAD-HINT"==k.name?(M=(M=fS(k,"BYTERANGE-START"))?Number(M):0,(L=fS(k,"BYTERANGE-LENGTH"))?P=M+Number(L)-1:M&&(P=Number.MAX_SAFE_INTEGER)):(M=fS(k,"BYTERANGE"),P=d(xE(L,M)),M=P.next().value,P=P.next().value),x.qf=fS(k,"URI"),x.qf){L=Fo,"YES"==fS(k,"GAP")&&(t.m.gapCount++,L=2,E=!0),x.Jf=null;var _=function(e){return function(){return null==e.Jf&&(e.Jf=SS(u(),e.qf,a)),e.Jf}}(x);p&&0<=M&&null!=P&&(S=_,y=!0),R=new No(R,D,_,M,P,n,0,0,1/0,[],"",null,A,L,l),"EXT-X-PRELOAD-HINT"==k.name&&(R.Lg(),w=!0),"YES"!=fS(k,"INDEPENDENT")&&0<I&&R.nd(),(x=c(x.qf))&&(R.mimeType=x,YE.has(x)&&(R.Y=null)),T.push(R),A&&(A+=C)}}}}if(f){if(f=Number(f.value.split(",")[0]),0==f)return null;p=s+f}else{if(!T.length)return null;p=T[T.length-1].endTime}y&&(E||0!=T[0].startByte?(y=!1,S=null):T=[]),(f=bS(h,"EXT-X-BYTERANGE"))?(m=d(xE(i,f.value)),g=m.next().value,m=m.next().value):T.length&&(g=T[0].startByte,m=T[T.length-1].endByte),i="",f=null,"image"==o&&(i="1x1",h=bS(h,"EXT-X-TILES"))&&(i=pS(h,"LAYOUT"),(h=fS(h,"DURATION"))&&(f=Number(h)));var O=null;return n=new No(s,p,function(){return S?S():(null==O&&(O=SS(u(),r.g,a)),O||[])},g,m,n,0,0,1/0,T,i,f,v,b,l,0<T.length&&!!r.g),(s=c(r.g))&&(n.mimeType=s,YE.has(s)&&(n.Y=null)),y&&(t.nc=!0,n.ei(),w&&n.Lg()),n}function xE(e,t){var n=0,i=null;return t&&(n=t.split("@"),t=Number(n[0]),n=n[1]?Number(n[1]):e.endByte+1,i=n+t-1),[n,i]}function IE(e,t,n,i,r){if("video"==n||"audio"==n){var s=e.l.m;if(s&&!dE(e,n))for(t=vS(t,"EXT-X-DATERANGE"),t=t.filter(function(e){return null!=hS(e,"START-DATE")}).sort(function(e,t){return e=pS(e,"START-DATE"),t=pS(t,"START-DATE"),e<t?-1:e>t?1:0}),n=0;n<t.length;n++){var a=t[n];try{var o=pS(a,"START-DATE"),u=fn(o);if(!isNaN(u)){var l=Math.max(0,u-s),c=null,h=fS(a,"END-DATE");if(h){var f=fn(h);if(!isNaN(f)&&(c=f-s,0>c))continue}if(null==c){var p=fS(a,"DURATION")||fS(a,"PLANNED-DURATION");if(p){var g=parseFloat(p);if(isNaN(g)||(c=l+g),0>u-s+g)continue}}var m=fS(a,"CLASS")||"com.apple.quicktime.HLS",v="YES"==fS(a,"END-ON-NEXT");if(null==c&&v){for(var y=n+1;y<t.length;y++){var b=fS(t[y],"CLASS")||"com.apple.quicktime.HLS";if(m==b){var T=pS(t[y],"START-DATE"),S=fn(T);if(!isNaN(S)&&S&&S>u){c=Math.max(0,S-s);break}}}if(null==c)continue}y=["CLASS","START-DATE","END-DATE","DURATION","END-ON-NEXT"];for(var E=[],w=d(a.attributes),A=w.next();!A.done;A=w.next()){var x=A.value;if(!y.includes(x.name)){var I=wS(x.value,i);"X-ASSET-URI"!=x.name&&"X-ASSET-LIST"!=x.name||(I=SS(r(),x.value,i)[0]),E.push({key:x.name,description:"",data:I,mimeType:null,pictureType:null})}}1<E.length&&e.h.onMetadata(m,l,c,E)}}catch(k){}}}}function kE(e,t,n,i,r,s){var a=t.segments,o=void 0,u=TS(t.ba,"EXT-X-DISCONTINUITY-SEQUENCE",-1),l=TS(t.ba,"EXT-X-MEDIA-SEQUENCE",0),c=bS(t.ba,"EXT-X-SKIP"),h=c?Number(fS(c,"SKIPPED-SEGMENTS")):0,f=l+h,p=0;OE(e)&&n.has(f)&&(p=n.get(f)),0===p&&e.Ba==QE&&0<n.size&&!n.has(f)&&null!=e.l.i&&(p=e.l.Fb());var g=[],m=null;c=[];for(var v=0;v<a.length;v++){var y=a[v],b=0==v?p:m.endTime;f=l+h+v,bS(y.ba,"EXT-X-DISCONTINUITY")&&(u++,m&&m.Y&&(m.Y.g=b));for(var T=d(y.ba),S=T.next();!S.done;S=T.next())S=S.value,"EXT-X-KEY"==S.name&&(o=FE(pS(S,"METHOD"))?vE(e,S,t,r,i):void 0);n.set(f,b),T=EE(e,t,y.ba,r,i),(b=AE(e,T,m,y,b,i,s,r,o))&&((m=TS(y.ba,"EXT-X-BITRATE"))?c.push({bitrate:m,duration:b.endTime-b.startTime}):c.length&&(m=c.pop(),m.duration+=b.endTime-b.startTime,c.push(m)),m=b,b.i=u,dE(e,s)&&null!=e.K&&f<e.K||g.push(b))}if(t=void 0,c.length&&(t=c.reduce(function(e,t){return e+t.duration},0),t=Math.round(c.reduce(function(e,t){return e+t.bitrate*t.duration},0)/t*1e3)),c=g.some(function(e){return null!=e.h}))for(n={},i=0;i<g.length;n={Qe:void 0,Pe:void 0,He:void 0,Vc:void 0,Ge:void 0},i++)if(n.Vc=g[i],null==n.Vc.h)for(n.Pe=0,n.Qe=i,r=function(e){return function(){var t=g[e.Qe];if(t){if(null!=t.h)return t.h+e.Pe;e.Pe-=t.endTime-t.startTime,e.Qe+=1}return null}}(n),n.Ge=0,n.He=i,a=function(e){return function(){var t=g[e.He];if(t){if(t!=e.Vc&&(e.Ge+=t.endTime-t.startTime),null!=t.h)return t.h+e.Ge;--e.He}return null}}(n);null==n.Vc.h;)n.Vc.h=a(),null==n.Vc.h&&(n.Vc.h=r());if(c)for(n=d(g),i=n.next();!i.done;i=n.next())for(r=i.value,i=r.h,r=d(r.g),a=r.next();!a.done;a=r.next())a=a.value,a.h=i,i+=a.endTime-a.startTime;if(n=e.ia,c&&1/0!=n&&!dE(e,s))for(e=d(g),s=e.next();!s.done;s=e.next())s.value.qh(n);return{segments:g,bandwidth:t}}function LE(e,t){if(e==ft){if("vtt"==t||"wvtt"==t)return"text/vtt";if(t&&""!==t)return"application/mp4"}return"image"!=e||t&&"jpeg"!=t?"audio"==e&&"mp4a.40.34"==t?"audio/mpeg":"mjpg"==t?"application/mp4":null:"image/jpeg"}function RE(e){return e==ft?"text/vtt":qE.get(e).get("mp4")}function CE(e,t){e=OE(e)?Math.trunc((t.length-1)/2):0;for(var n=t[e];2==n.Ac()&&e+1<t.length;)e++,n=t[e];return{segment:n,segmentIndex:e}}function DE(e,t,n,i){var r,s,a,o,u,l,c,d,h,f,p,g,m;return U(function(v){switch(v.g){case 1:return r=gs,s=CE(e,i),a=s.segment,2==a.status?v.return(RE(t)):(o=a.O(),u=new Te(o[0]),l=u.mb.split(".").pop(),c=qE.get(t),(d=c.get(l))||(d=GE.get(l))||(d=LE(t,n))?v.return(d):(f=1,p=us(o,e.g.retryParameters),x(v,2),p.method="HEAD",w(v,UE(e,p,r,{type:f}).promise,4)));case 4:g=v.h,h=g.headers["content-type"],k(v,3);break;case 2:if(m=L(v),!m||1002!=m.code&&1001!=m.code){v.u(3);break}return p.method="GET",e.g.hls.allowRangeRequestsToGuessMimeType&&(p.headers.Range="bytes=0-0"),w(v,UE(e,p,r,{type:f}).promise,6);case 6:g=v.h,h=g.headers["content-type"];case 3:if(!h){v.u(7);break}if(d=h.toLowerCase().split(";")[0],"application/octet-stream"!=d){v.u(8);break}if(g.data.byteLength){v.u(9);break}return p.method="GET",w(v,UE(e,p,r,{type:f}).promise,10);case 10:g=v.h;case 9:Iu(Be(g.data))&&(d="video/mp2t");case 8:if("application/octet-stream"!=d)return v.return(d);case 7:return v.return(RE(t))}})}function ME(e,t,n,i,r,s,a){e&&(e.width=Number(t)||void 0,e.height=Number(n)||void 0,e.frameRate=Number(i)||void 0,e.hdr=r||void 0,e.videoLayout=s||void 0,e.colorGamut=a||void 0)}function PE(e,t,n){return UE(e,us(t,e.g.retryParameters),0,{type:n?2:3})}function _E(e){var t,n,i,r,s,a;return U(function(o){switch(o.g){case 1:return e.h?(x(o,2),t=Date.now(),w(o,e.update(),4)):o.return();case 4:n=Date.now(),OE(e)&&(i=(n-t)/1e3,e.eb.sample(1,i),r=0<e.g.updatePeriod?e.g.updatePeriod:e.o,s=Math.max(0,r-q(e.eb)),e.B.ha(s)),k(o,3);break;case 2:if(a=L(o),!e.h)return o.return();if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.h.onError(a),o.return();a.severity=1,e.h.onError(a),e.B.ha(.1);case 3:if(!e.h)return o.return();e.h.onManifestUpdated(),A(o)}})}function OE(e){return e.Ba!=zE}function NE(e,t){e.Ba=t,e.l&&e.l.Yc(!OE(e)),OE(e)||e.B.stop()}function UE(e,t,n,i){if(!e.W)throw new Ve(2,7,7001);return i||(i={}),i.isPreload=e.Xb(),t=e.h.networkingEngine.request(n,t,i),rs(e.W,t),t}function FE(e){return"AES-128"==e||"AES-256"==e||"AES-256-CTR"==e}function BE(t,n,i,r){var s,a,o,u,l,c;return U(function(d){if(1==d.g){if("video/mp2t"==i)throw new Ve(2,4,4040);if("apple"===e.shakaMediaKeysPolyfill)throw new Ve(2,4,4041);if(s=pS(n,"METHOD"),a=["SAMPLE-AES","SAMPLE-AES-CTR"],!a.includes(s))return d.return(null);o="cenc","SAMPLE-AES"==s&&(o="cbcs"),u=pS(n,"URI"),l=ut("com.apple.fps",o,[{initDataType:"sinf",initData:new Uint8Array(0),keyId:null}],u);var h=new Te(u).Cb.replace(/-/g,"").toLowerCase();return(c=32===h.length&&/^[0-9a-f]+$/.test(h)?h:null)||!r?d.u(2):w(d,$E(t,r),3)}return 2!=d.g&&(c=d.h),c&&l.keyIds.add(c),d.return(l)})}function jE(t,n,i,r,s,a){var o,u,l,c,d,h,f,p,g,m,v,y;return U(function(b){switch(b.g){case 1:if("video/mp2t"==i)throw new Ve(2,4,4040);if("apple"===e.shakaMediaKeysPolyfill)throw new Ve(2,4,4041);if(o=pS(n,"METHOD"),u=["SAMPLE-AES","SAMPLE-AES-CTR"],!u.includes(o))return b.return(null);if(l=SS(r(),pS(n,"URI"),a),l[0].startsWith("data:text/plain;base64,")){c=st(it(l[0].split("data:text/plain;base64,").pop())),b.u(2);break}return d=l.sort().join(""),t.va.has(d)||(h=us(l,t.g.retryParameters),f=UE(t,h,6).promise,t.va.set(d,f)),w(b,t.va.get(d),3);case 3:p=b.h,c=st(p.data);case 2:if(g="00000000000000000000000000000000",!s){b.u(4);break}return w(b,$E(t,s),5);case 5:(m=b.h)&&(g=m);case 4:return v=new Map,v.set(g,c),y="cenc","SAMPLE-AES"==o&&(y="cbcs"),b.return(lt(v,y))}})}function $E(e,t){var n,i,r,s;return U(function(a){return 1==a.g?(n=null,e.wa.has(t)?(n=e.wa.get(t),a.u(2)):(i=Rc(t.O(),t.zc(),t.xc(),e.g.retryParameters),r=gs,w(a,UE(e,i,r,{type:0}).promise,3))):(2!=a.g&&(s=a.h,t.ee(s.data),n=kc(s.data),e.wa.set(t,n)),a.return(n))})}K("shaka.net.DataUriPlugin",RS),RS.parse=CS,as("data",CS),i=MS.prototype,i.configure=function(e,t){var n=this.h&&e.updatePeriod!=this.g.updatePeriod&&0<=e.updatePeriod;this.g=e,t&&(this.Xb=t),this.j&&this.j.configure(this.g),n&&this.m&&this.m.presentationTimeline.V()&&this.B.Hb()},i.start=function(e,t){var n,i=this;return U(function(r){return 1==r.g?(i.h=t,i.ka=t.isLowLatencyMode(),w(r,PE(i,[e]).promise,2)):3!=r.g?(n=r.h,i.C=n.uri,w(r,FS(i,n.data),3)):r.return(i.m)})},i.stop=function(){this.B&&(this.B.stop(),this.B=null);var e=[];return this.W&&(e.push(this.W.destroy()),this.W=null),this.g=this.h=null,this.ab.clear(),this.m=null,this.i.clear(),this.I.clear(),this.H.clear(),this.A.clear(),this.ya.clear(),this.oa.clear(),this.L.clear(),this.va.clear(),this.wa.clear(),this.j&&this.j.destroy(),this.S&&(this.S.release(),this.S=null),Promise.all(e)},i.update=function(){var e,t,n,i,r,s,a,o,u,l,c,f,p=this;return U(function(g){if(1==g.g){if(!OE(p))return g.return();for(e=[],t=Array.from(p.i.values()),p.o=1/0,p.m.gapCount=0,n=t.filter(function(e){return e.stream.segmentIndex}),i=d(n),r=i.next();!r.done;r=i.next())s=r.value,e.push(_S(p,s));return w(g,Promise.all(e),2)}for(lE(p,n.map(function(e){return e.stream})),a=n.some(function(e){return 0==e.Pd}),n.length&&!a&&(o=JE,NE(p,o.aj),u=n.map(function(e){return e.lc}),p.l.ob(Math.min.apply(Math,h(u))),p.h.updateDuration()),a&&$S(p),l=d(n),c=l.next();!c.done;c=l.next())f=c.value,f.stream.isAudioMuxedInVideo||!f.stream.segmentIndex||Wl(f.stream.segmentIndex)||p.h.disableStream(f.stream);A(g)})},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(){},i.banLocation=function(e){this.j&&this.j.banLocation(e)},i.setMediaElement=function(e){this.U=e},K("shaka.hls.HlsParser",MS);var GE=(new Map).set("aac","audio/aac").set("ac3","audio/ac3").set("ec3","audio/ec3").set("mp3","audio/mpeg"),VE=(new Map).set("mp4","audio/mp4").set("mp4a","audio/mp4").set("m4s","audio/mp4").set("m4i","audio/mp4").set("m4a","audio/mp4").set("m4f","audio/mp4").set("cmfa","audio/mp4").set("ts","video/mp2t").set("tsa","video/mp2t"),HE=(new Map).set("mp4","video/mp4").set("mp4v","video/mp4").set("m4s","video/mp4").set("m4i","video/mp4").set("m4v","video/mp4").set("m4f","video/mp4").set("cmfv","video/mp4").set("ts","video/mp2t").set("tsv","video/mp2t"),KE=(new Map).set("mp4","application/mp4").set("m4s","application/mp4").set("m4i","application/mp4").set("m4f","application/mp4").set("cmft","application/mp4").set("vtt","text/vtt").set("webvtt","text/vtt").set("ttml","application/ttml+xml"),WE=(new Map).set("jpg","image/jpeg").set("png","image/png").set("svg","image/svg+xml").set("webp","image/webp").set("avif","image/avif"),qE=(new Map).set("audio",VE).set("video",HE).set("text",KE).set("image",WE),YE=new Set(["video/mp2t"].concat(h(Ei))),zE="VOD",XE="EVENT",QE="LIVE",JE={aj:zE,zl:XE,Jl:QE};function ZE(e){return vy(e)}ja("application/x-mpegurl",function(){return new MS}),ja("application/vnd.apple.mpegurl",function(){return new MS});var ew=(new Map).set("com.microsoft.playready",ZE).set("com.microsoft.playready.recommendation",ZE).set("com.microsoft.playready.software",ZE).set("com.microsoft.playready.hardware",ZE);function tw(){var e=this;this.h=this.g=null,this.l=[],this.j=null,this.s=1,this.i=null,this.C=new W(5),this.o=new _i(function(){nw(e)}),this.B=new is,this.m=new Map,this.A=function(){return!1}}function nw(e){var t;U(function(n){switch(n.g){case 1:return x(n,2),w(n,iw(e),4);case 4:k(n,3);break;case 2:t=L(n),e.h&&(t.severity=1,e.h.onError(t));case 3:if(!e.h)return n.return();A(n)}})}function iw(e){var t,n,i,r,s,a,o;return U(function(u){if(1==u.g)return t=us(e.l,e.g.retryParameters),n=e.h.networkingEngine,i=Date.now(),r=n.request(0,t,{type:5,isPreload:e.A()}),rs(e.B,r),w(u,r.promise,2);if(s=u.h,!e.h)return u.return();s.uri&&!e.l.includes(s.uri)&&e.l.unshift(s.uri);var l=s.uri,c=s.data,f=e.g.mss.manifestPreprocessor;if(f!=$d){if(ge("manifest.mss.manifestPreprocessor configuration","Please Use manifest.mss.manifestPreprocessorTXml instead."),c=iT(c,"SmoothStreamingMedia"),!c)throw new Ve(2,4,4046,l);f(c),c=ze(c.outerHTML)}var p=Xt(c,"SmoothStreamingMedia");if(!p)throw new Ve(2,4,4046,l);if(l=e.g.mss.manifestPreprocessorTXml,l!=Gd&&l(p),e.i||(e.i=new Sl(null,0)),l=ln(p,"IsLive",Tn,!1))throw new Ve(2,4,4047);e.i.Yc(!l),f=ln(p,"TimeScale",yn,1e7),c=ln(p,"DVRWindowLength",yn),l&&(0===c||isNaN(c))&&(c=1/0);var g,m=ln(p,"CanSeek",Tn,!1);for(0===c&&m&&(c=1/0),m=null,c&&0<c&&(m=c/f),l&&!isNaN(e.g.availabilityWindowOverride)&&(m=e.g.availabilityWindowOverride),null==m&&(m=1/0),e.i.Cf(m),c=ln(p,"Duration",yn,1/0),l||e.i.ob(c/f),l={variants:[],textStreams:[],timescale:f,duration:c/f},m=nn(p,"Protection"),f=e.g.mss.keySystemsBySystemId,c=[],m=d(m),g=m.next();!g.done;g=m.next())c=c.concat(nn(g.value,"ProtectionHeader"));if(c.length){for(m=[],g=0;g<c.length;g++){var v=c[g],y=v.attributes.SystemID.toLowerCase(),b=f[y];if(b){var T;e:{if(T=my(v)){T=d(an(T,"DATA"));for(var S=T.next();!S.done;S=T.next())if(S=on(S.value,"KID")){T=it(rn(S)),T=new Uint8Array([T[3],T[2],T[1],T[0],T[5],T[4],T[7],T[6]].concat(h(T.slice(8)))),T=st(T);break e}}T=null}S=it(rn(v)),y=rt(y.replace(/-/g,"")),y=[{initData:Bs(S,y,new Set,0),initDataType:"cenc",keyId:T}],y=ut(b,"cenc",y),T&&y.keyIds.add(T),(b=ew.get(b))&&(y.licenseServerUri=b(v)),m.push(y)}}f=m}else f=[];for(g=f,m=[],f=[],c=[],p=nn(p,"StreamIndex"),p=d(p),v=p.next();!v.done;v=p.next()){v=v.value,b=nn(v,"QualityLevel"),y=l.timescale,T=l.duration,S=nn(v,"c");for(var E=[],x=0,I=0;I<S.length;++I){var k=S[I],L=S[I+1],R=ln(k,"t",yn),C=ln(k,"d",yn);if(k=ln(k,"r",mn),!C)break;if(R=null!=R?R:x,(k=k||0)&&k--,0>k)if(L){if(L=ln(L,"t",yn),null==L)break;if(R>=L)break;k=Math.ceil((L-R)/C)-1}else{if(1/0==T)break;if(R/y>=T)break;k=Math.ceil((T*y-R)/C)-1}for(L=0;L<=k;++L)x=R+C,E.push({start:R/y,end:x/y,xh:R}),R=x}for(y=E,b=d(b),T=b.next();!T.done;T=b.next())(T=rw(e,v,T.value,y,g,l))&&("audio"!=T.type||e.g.disableAudio?"video"!=T.type||e.g.disableVideo?T.type!=ft||e.g.disableText||c.push(T):f.push(T):m.push(T))}for(p=[],m=d(0<m.length?m:[null]),g=m.next();!g.done;g=m.next())for(g=g.value,v=d(0<f.length?f:[null]),E=v.next();!E.done;E=v.next())b=p,y=b.push,T=e,S=g,E=E.value,I=0,S&&S.bandwidth&&0<S.bandwidth&&(I+=S.bandwidth),E&&E.bandwidth&&0<E.bandwidth&&(I+=E.bandwidth),T={id:T.s++,language:S?S.language:"und",disabledUntilTime:0,primary:!!S&&S.primary||!!E&&E.primary,audio:S,video:E,bandwidth:I,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},y.call(b,T);l.variants=p,l.textStreams=c,e.j?(e.j.variants=l.variants,e.j.textStreams=l.textStreams,e.h.filter(e.j)):(e.j={presentationTimeline:e.i,variants:l.variants,textStreams:l.textStreams,imageStreams:[],offlineSessionIds:[],sequenceMode:e.g.mss.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"MSS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:null},e.i.df()),Promise.resolve(),a=Date.now(),o=(a-i)/1e3,e.C.sample(1,o),A(u)})}function rw(e,t,n,i,r,s){var a=t.attributes.Type;if("audio"!==a&&"video"!==a&&"text"!==a)return Q("Ignoring unrecognized type:",a),null;var o=t.attributes.Language,u=e.s++,l=ln(n,"Bitrate",vn),c=ln(n,"MaxWidth",vn),d=ln(n,"MaxHeight",vn),h=ln(n,"Channels",vn),f=ln(n,"SamplingRate",vn),p=s.duration;i.length&&(p=i[i.length-1].end-i[0].start);var g=e.i.getDuration();e.i.ob(Math.min(p,g));var m={id:u,originalId:t.attributes.Name||String(u),groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:"",codecs:"",frameRate:void 0,pixelAspectRatio:void 0,bandwidth:l||0,width:c||void 0,height:d||void 0,kind:"",encrypted:0<r.length,drmInfos:r,keyIds:new Set,language:Vi(o||"und"),originalLanguage:o,label:"",type:"",primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:[],roles:[],forced:!1,channelsCount:h,audioSamplingRate:f,spatialAudio:!1,closedCaptions:null,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,matchedStreams:[],mssPrivateData:{duration:p,timescale:s.timescale,codecPrivateData:null},accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null};if((r=t.attributes.Subtype)&&((r=cw.get(r))&&m.roles.push(r),"main"===r&&(m.primary=!0)),r=n.attributes.FourCC,null!==r&&""!==r||(r=t.attributes.FourCC),!r)if("audio"===a)r="AAC";else if("video"===a)return Q('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null;if(!lw.includes(r.toUpperCase()))return Q("Codec not supported:",r),null;switch(n=sw(n,a,r,m),m.mssPrivateData.codecPrivateData=n,a){case"audio":if(!n)return Q("Quality unsupported without CodecPrivateData",a),null;m.type="audio",m.mimeType="mss/audio/mp4",m.codecs=aw(r,n);break;case"video":if(!n)return Q("Quality unsupported without CodecPrivateData",a),null;m.type="video",m.mimeType="mss/video/mp4",m.codecs=ow(n);break;case"text":m.type=ft,m.mimeType="application/mp4",("TTML"===r||"DFXP"===r)&&(m.codecs="stpp")}return m.fullMimeTypes.add(hi(m.mimeType,m.codecs)),m.createSegmentIndex=function(){if(m.segmentIndex)return Promise.resolve();if(e.m.has(m.id))var n=e.m.get(m.id);else n=[],"video"==m.type&&(n=m.mssPrivateData.codecPrivateData.split("00000001").slice(1)),n={id:m.id,type:m.type,codecs:m.codecs,encrypted:m.encrypted,timescale:m.mssPrivateData.timescale,duration:m.mssPrivateData.duration,Ab:n,Ea:new Uint8Array([]),Na:new Uint8Array([]),Va:0,Wa:0,data:null,stream:m},n=eo(new Za([n])),e.m.set(m.id,n);return n=uw(e,new _o(function(){return[]},0,null,oc(m),m.mssPrivateData.timescale,n,null,m.encrypted),m,t,i),m.segmentIndex=new Kl(n),Promise.resolve()},m.closeSegmentIndex=function(){m.segmentIndex&&(m.segmentIndex.release(),m.segmentIndex=null)},m}function sw(e,t,n,i){if(e=e.attributes.CodecPrivateData)return e;if("audio"!==t)return null;t=i.channelsCount||2,e=i.audioSamplingRate||44100;var r={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12};return i=r[e],"AACH"===n?(n=new Uint8Array(4),e=r[2*e],n[0]=40|i>>1,n[1]=i<<7|t<<3|e>>1,n[2]=e<<7|8,n[3]=0,t=new Uint16Array(2),t[0]=(n[0]<<8)+n[1],t[1]=(n[2]<<8)+n[3],t[0].toString(16)+t[1].toString(16)):(n=new Uint8Array(2),n[0]=16|i>>1,n[1]=i<<7|t<<3,t=new Uint16Array(1),t[0]=(n[0]<<8)+n[1],t[0].toString(16))}function aw(e,t){var n=0;return"AACH"===e&&(n=5),t?0===n&&(n=(248&parseInt(t.substr(0,2),16))>>3):(n=2,"AACH"===e&&(n=5)),"mp4a.40."+n}function ow(e){var t=/00000001[0-9]7/.exec(e);return t.length&&e?"avc1."+e.substr(e.indexOf(t[0])+10,6):""}function uw(e,t,n,i,r){var s=i.attributes.Url.replace("{bitrate}",String(n.bandwidth));i=[],r=d(r);for(var a=r.next(),o={};!a.done;o={Ef:void 0},a=r.next())o.Ef=a.value,i.push(new No(o.Ef.start,o.Ef.end,function(t){return function(){return ot(e.l,[s.replace("{start time}",String(t.Ef.xh))])}}(o),0,null,t,0,0,n.mssPrivateData.duration));return i}i=tw.prototype,i.configure=function(e,t){this.g=e,t&&(this.A=t)},i.start=function(e,t){var n=this;return U(function(i){if(1==i.g)return n.l=[e],n.h=t,w(i,iw(n),2);if(!n.h)throw new Ve(2,7,7001);return i.return(n.j)})},i.stop=function(){return this.g=this.h=null,this.l=[],this.j=null,null!=this.o&&(this.o.stop(),this.o=null),this.m.clear(),this.B.destroy()},i.update=function(){var e,t=this;return U(function(n){return 1==n.g?(x(n,2),w(n,iw(t),4)):2!=n.g?k(n,0):(e=L(n),t.h&&e?(t.h.onError(e),void A(n)):n.return())})},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(){},i.banLocation=function(){},i.setMediaElement=function(){},K("shaka.mss.MssParser",tw);var lw="AAC AACL AACH AACP AVC1 H264 TTML DFXP".split(" "),cw=(new Map).set("CAPT","main").set("SUBT","alternate").set("DESC","main");function dw(e,t,n,i,r,s,a){if(200<=n&&299>=n&&202!=n||304==n)return{uri:r||i,originalUri:i,data:t,status:n,headers:e,fromCache:!!e["x-shaka-from-cache"],originalRequest:s};s=null;try{s=Ye(t)}catch(o){}throw new Ve(401==n||403==n?2:1,1,1001,i,n,s,e,a,r||i)}function hw(){}function fw(e,t,n,i,r,s){var a=new Tw;Es(t.headers).forEach(function(e,t){a.append(t,e)});var o=new yw,u={Ih:!1,Wi:!1};if(e=pw(e,t,n,{body:t.body||void 0,headers:a,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},u,i,r,t.streamDataCallback,s.minBytesForProgressEvents||0),e=new Wr(e,function(){return u.Ih=!0,o.abort(),Promise.resolve()}),t=t.retryParameters.timeout){var l=new _i(function(){u.Wi=!0,o.abort()});l.ha(t/1e3),e.finally(function(){l.stop()})}return e}function pw(e,t,n,i,r,s,a,o,u){var l,c,d,h,f,p,g,m,v,y,b,T,S,E,I;return U(function(R){switch(R.g){case 1:return l=vw,c=bw,h=new ArrayBuffer(0),p=f=0,g={},m=Date.now(),x(R,2),w(R,l(e,i),4);case 4:if(d=R.h,g=gw(d.headers),a(g),"HEAD"==i.method){R.u(5);break}return y=(v=d.headers.get("Content-Length"))?parseInt(v,10):0,d.body?(b=d.clone().body.getReader(),T=function(e){function t(){var n,i,r,a;return U(function(l){switch(l.g){case 1:return x(l,2),w(l,b.read(),4);case 4:n=l.h,k(l,3);break;case 2:return L(l),l.return();case 3:if(n.done){l.u(5);break}if(f+=n.value.byteLength,!o){l.u(5);break}return w(l,o(n.value),5);case 5:i=Date.now(),r=f-p,(100<i-m&&r>=u||n.done)&&(a=n.done?0:y-f,s(i-m,r,a),p=f,m=i),n.done?e.close():(e.enqueue(n.value),t()),A(l)}})}t()},new c({start:T}),w(R,d.arrayBuffer(),8)):w(R,d.arrayBuffer(),9);case 8:h=R.h,R.u(5);break;case 9:h=R.h,S=Date.now(),s(S-m,h.byteLength,0);case 5:t.headers.Range&&(E=t.headers.Range.replace("bytes=","").split("-").filter(function(e){return e}).map(function(e){return parseInt(e,10)}),2==E.length&&h.byteLength!=E[1]-E[0]+1&&Q("Payload length does not match range requested bytes",t,d)),k(R,3);break;case 2:if(I=L(R),r.Ih)throw new Ve(1,1,7001,e,n);if(r.Wi)throw new Ve(1,1,1003,e,n);throw new Ve(1,1,1002,e,I,n);case 3:return R.return(dw(g,h,d.status,e,d.url,t,n))}})}function gw(e){var t={};return e.forEach(function(e,n){t[n.trim()]=e}),t}function mw(){if(!e.ReadableStream)return!1;try{new ReadableStream({})}catch(aR){return!1}return!!e.Response&&(!!new Response("").body&&!(!e.fetch||"polyfill"in e.fetch||!e.AbortController))}ja("application/vnd.ms-sstr+xml",function(){return new tw}),K("shaka.net.HttpFetchPlugin",hw),hw.isSupported=mw,hw.parse=fw;var vw=e.fetch,yw=e.AbortController,bw=e.ReadableStream,Tw=e.Headers;function Sw(){}function Ew(e,t,n,i,r,s){var a=new ww,o=Date.now(),u=0,l=new Promise(function(l,c){a.open(t.method,e,!0),a.responseType="arraybuffer",a.timeout=t.retryParameters.timeout,a.withCredentials=t.allowCrossSiteCredentials;var h={};for(var f in a.onabort=function(){c(new Ve(1,1,7001,e,n))},a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.HEADERS_RECEIVED){var e=a.getAllResponseHeaders().trim().split("\r\n"),t={};e=d(e);for(var n=e.next();!n.done;n=e.next())n=n.value.split(": "),t[n[0].toLowerCase()]=n.slice(1).join(": ");h=t,r(h)}},a.onload=function(r){var s=a.response;try{i(Date.now()-o,r.loaded-u,0);var d=dw(h,s,a.status,e,a.responseURL,t,n);l(d)}catch(f){c(f)}},a.onerror=function(t){c(new Ve(1,1,1002,e,t,n))},a.ontimeout=function(){c(new Ve(1,1,1003,e,n))},a.onprogress=function(e){var t=Date.now(),n=s.minBytesForProgressEvents||0,r=e.loaded-u;(100<t-o&&r>=n||e.lengthComputable&&e.loaded==e.total)&&(i(t-o,r,4==a.readyState?0:e.total-e.loaded),u=e.loaded,o=t)},t.headers)a.setRequestHeader(f.toLowerCase(),t.headers[f]);a.send(t.body)});return new Wr(l,function(){return a.abort(),Promise.resolve()})}mw()&&(as("http",fw,2,!0),as("https",fw,2,!0),as("blob",fw,2,!0)),K("shaka.net.HttpXHRPlugin",Sw),Sw.parse=Ew;var ww=e.XMLHttpRequest;function Aw(e,t,n,i,r){this.g=e,this.i=t,this.groupId=n,this.h=i,this.j=r}function xw(e){var t=e.Wb(!1);return t?nt(t):e.O().map(function(e){return"{"+encodeURI(e.split("#xywh=")[0])+"}"}).join("")+":"+e.startByte+":"+e.endByte}function Iw(e,t){return Rc(e.g.O(),e.g.startByte,e.g.endByte,t.streaming.retryParameters)}function kw(){this.g=this.j=this.i=0,this.h=new Map,this.l=0}function Lw(e,t){e.i+=t;var n=e.l;return e.l++,e.h.set(n,t),n}function Rw(e){return 0==e.i?0:e.j/e.i}function Cw(e){var t=this;this.s=e,this.i=new Map,this.h=new ys(function(){return Mw(t).catch(function(){})}),this.j=[],this.o=function(){},this.m=function(){},this.g=new kw,this.l=!1}function Dw(e,t,n){e.o=t,e.m=n}function Mw(e){e.l=!0;var t=e.j.map(function(e){return e()});return e.j=[],Promise.all(t)}function Pw(e,t,n,i,r,s){bs(e.h);var a=(e.i.get(t)||Promise.resolve()).then(function(){if(e.h.g)throw new Ve(2,9,7001);if(r){var t=Be(n);for(var a in t=new Fs(t),t.data){var o=Number(a);e.m(t.data[o],t.g[o])}}return e.g.close(i,n.byteLength),e.o(Rw(e.g),e.g.g),s(n)});e.i.set(t,a)}function _w(e){return U(function(t){return 1==t.g?w(t,Promise.all(e.i.values()),2):t.return(e.g.g)})}function Ow(e,t){var n,i,r,s;return U(function(a){return 1==a.g?(n=gs,i=e.s.request(n,t),r=function(){return i.abort()},e.j.push(r),w(a,i.promise,2)):(s=a.h,Ut(e.j,r),a.return(s.data))})}function Nw(e,t){var n=this;this.i=e,this.h=e.objectStore(t),this.g=new Kr,e.onabort=function(e){e.preventDefault(),n.g.reject()},e.onerror=function(e){e.preventDefault(),n.g.reject()},e.oncomplete=function(){n.g.resolve()}}function Uw(e,t){return new Promise(function(n,i){var r=e.h.openCursor();r.onerror=i,r.onsuccess=function(){var e;return U(function(i){if(1==i.g)return null==r.result?(n(),i.return()):(e=r.result,w(i,t(e.key,e.value,e),2));e.continue(),A(i)})}})}function Fw(e){this.h=e,this.g=[]}function Bw(e,t){return jw(e,t,"readwrite")}function jw(e,t,n){n=e.h.transaction([t],n);var i=new Nw(n,t);return e.g.push(i),i.promise().then(function(){Ut(e.g,i)},function(){Ut(e.g,i)}),i}function $w(e,t,n){this.h=new Fw(e),this.i=t,this.g=n}function Gw(e,t,n){e=Bw(e.h,e.g);var i=e.store();return i.get(t).onsuccess=function(){i.put(n,t)},e.promise()}function Vw(e){return Promise.reject(new Ve(2,9,9011,"Cannot add new value to "+e))}function Hw(e,t,n,i){e=Bw(e.h,t),t=e.store(),n=d(n);for(var r=n.next(),s={};!r.done;s={Jg:void 0},r=n.next())s.Jg=r.value,t.delete(s.Jg).onsuccess=function(e){return function(){return i(e.Jg)}}(s);return e.promise()}function Kw(e,t,n){var i,r,s,a,o,u,l;return U(function(c){if(1==c.g){for(i=jw(e.h,t,"readonly"),r=i.store(),s={},a=[],o=d(n),u=o.next(),l={};!u.done;l={xf:void 0,Ze:void 0},u=o.next())l.Ze=u.value,l.xf=r.get(l.Ze),l.xf.onsuccess=function(e){return function(){void 0==e.xf.result&&a.push(e.Ze),s[e.Ze]=e.xf.result}}(l);return w(c,i.promise(),2)}if(a.length)throw new Ve(2,9,9012,"Could not find values for "+a);return c.return(n.map(function(e){return s[e]}))})}function Ww(e){this.g=new Fw(e)}function qw(){this.g=new Map}function Yw(e){var t=null;if(e.g.forEach(function(e,n){e.getCells().forEach(function(e,i){e.hasFixedKeySpace()||t||(t={path:{Pb:n,bb:i},bb:e})})}),t)return t;throw new Ve(2,9,9013,"Could not find a cell that supports add-operations")}function zw(e,t){e.g.forEach(function(e,n){e.getCells().forEach(function(e,i){t({Pb:n,bb:i},e)})})}function Xw(e,t,n){if(e=e.g.get(t),!e)throw new Ve(2,9,9013,"Could not find mechanism with name "+t);if(t=e.getCells().get(n),!t)throw new Ve(2,9,9013,"Could not find cell with name "+n);return t}function Qw(e,t){e.g.forEach(function(e){t(e.getEmeSessionCell())})}function Jw(e){var t=Array.from(e.g.keys());if(!t.length)throw new Ve(2,9,9e3,"No supported storage mechanisms found");return e.g.get(t[0]).getEmeSessionCell()}function Zw(e){var t,n,i;return U(function(r){return 1==r.g?(t=Array.from(e.g.values()),n=0<t.length,n||(i=tA,i.forEach(function(e){(e=e())&&t.push(e)})),w(r,Promise.all(t.map(function(e){return e.erase()})),2)):n?r.u(0):w(r,Promise.all(t.map(function(e){return e.destroy()})),0)})}function eA(e,t){tA.set(e,t)}as("http",Ew,1,!0),as("https",Ew,1,!0),as("blob",Ew,1,!0),kw.prototype.close=function(e,t){if(this.h.has(e)){var n=this.h.get(e);this.h.delete(e),this.j+=n,this.g+=t}},Cw.prototype.destroy=function(){return this.h.destroy()},Cw.prototype.queue=function(e,t,n,i,r){var s=this;bs(this.h);var a=(this.i.get(e)||Promise.resolve()).then(function(){var e,a,o,u,l,c,d;return U(function(h){if(1==h.g)return w(h,Ow(s,t),2);if(e=h.h,s.h.g)throw new Ve(2,9,7001);if(i)for(u in a=Be(e),o=new Fs(a),o.data)l=Number(u),c=o.data[l],d=o.g[l],s.m(c,d);return s.g.close(n,e.byteLength),s.o(Rw(s.g),s.g.g),h.return(r(e))})});return this.i.set(e,a),a},Nw.prototype.abort=function(){var e=this;return U(function(t){if(1==t.g){try{e.i.abort()}catch(n){}return x(t,2),w(t,e.g,4)}if(2!=t.g)return k(t,0);L(t),A(t)})},Nw.prototype.store=function(){return this.h},Nw.prototype.promise=function(){return this.g},Fw.prototype.destroy=function(){return Promise.all(this.g.map(function(e){return e.abort()}))},i=$w.prototype,i.destroy=function(){return this.h.destroy()},i.hasFixedKeySpace=function(){return!0},i.addSegments=function(){return Vw(this.i)},i.removeSegments=function(e,t){return Hw(this,this.i,e,t)},i.getSegments=function(e){var t,n=this;return U(function(i){return 1==i.g?w(i,Kw(n,n.i,e),2):(t=i.h,i.return(t.map(function(e){return n.Kh(e)})))})},i.addManifests=function(){return Vw(this.g)},i.updateManifest=function(){return Promise.reject(new Ve(2,9,9016,"Cannot modify values in "+this.g))},i.updateManifestExpiration=function(e,t){var n=Bw(this.h,this.g),i=n.store();return i.get(e).onsuccess=function(n){(n=n.target.result)&&(n.expiration=t,i.put(n,e))},n.promise()},i.removeManifests=function(e,t){return Hw(this,this.g,e,t)},i.getManifests=function(e){var t,n=this;return U(function(i){return 1==i.g?w(i,Kw(n,n.g,e),2):(t=i.h,i.return(Promise.all(t.map(function(e){return n.Hd(e)}))))})},i.getAllManifests=function(){var e,t,n=this;return U(function(i){return 1==i.g?(e=jw(n.h,n.g,"readonly"),t=new Map,w(i,Uw(e,function(e,i){var r;return U(function(s){if(1==s.g)return w(s,n.Hd(i),2);r=s.h,t.set(e,r),A(s)})}),2)):3!=i.g?w(i,e.promise(),3):i.return(t)})},i.Kh=function(e){return e},i.Hd=function(e){return Promise.resolve(e)},i.add=function(e,t){var n,i,r,s,a,o,u,l=this;return U(function(c){if(1==c.g){for(n=Bw(l.h,e),i=n.store(),r=[],s=d(t),a=s.next(),o={};!a.done;o={Xg:void 0},a=s.next())u=a.value,o.Xg=i.add(u),o.Xg.onsuccess=function(e){return function(){r.push(e.Xg.result)}}(o);return w(c,n.promise(),2)}return c.return(r)})},Ww.prototype.destroy=function(){return this.g.destroy()},Ww.prototype.getAll=function(){var e,t,n=this;return U(function(i){return 1==i.g?(e=jw(n.g,"session-ids","readonly"),t=[],w(i,Uw(e,function(e,n){t.push(n)}),2)):3!=i.g?w(i,e.promise(),3):i.return(t)})},Ww.prototype.add=function(e){var t=Bw(this.g,"session-ids"),n=t.store();e=d(e);for(var i=e.next();!i.done;i=e.next())n.add(i.value);return t.promise()},Ww.prototype.remove=function(e){var t,n=this;return U(function(i){return 1==i.g?(t=Bw(n.g,"session-ids"),w(i,Uw(t,function(t,n,i){e.includes(n.sessionId)&&i.delete()}),2)):w(i,t.promise(),0)})},qw.prototype.destroy=function(){for(var e=[],t=d(this.g.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.g.clear(),Promise.all(e)},qw.prototype.init=function(){var e=this;tA.forEach(function(t,n){(t=t())&&e.g.set(n,t)});for(var t=[],n=d(this.g.values()),i=n.next();!i.done;i=n.next())t.push(i.value.init());return Promise.all(t)},K("shaka.offline.StorageMuxer",qw),qw.unregister=function(e){tA.delete(e)},qw.register=eA,qw.prototype.destroy=qw.prototype.destroy;var tA=new Map;function nA(){$w.apply(this,arguments)}function iA(e,t){aA(e);for(var n=d(e.streams),i=n.next();!i.done;i=n.next());return e.streams.map(function(n){return rA(n,e.startTime,t)})}function rA(e,t,n){var i=e.initSegmentUri?sA(e.initSegmentUri):null,r=t+e.presentationTimeOffset,s=t+n;return{id:e.id,originalId:null,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,initSegmentKey:i,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(e){var n=sA(e.uri);return{startTime:t+e.startTime,endTime:t+e.endTime,dataKey:n,initSegmentKey:i,appendWindowStart:t,appendWindowEnd:s,timestampOffset:r,tilesLayout:"",mimeType:null,codecs:null,thumbnailSprite:null}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}}function sA(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new Ve(2,9,9004,"Could not parse uri "+e)}function aA(e){var t=e.streams.filter(function(e){return"audio"==e.contentType});if(e=e.streams.filter(function(e){return"video"==e.contentType}),!t.every(function(e){return e.variantIds})||!e.every(function(e){return e.variantIds})){for(var n=d(t),i=n.next();!i.done;i=n.next())i.value.variantIds=[];for(n=d(e),i=n.next();!i.done;i=n.next())i.value.variantIds=[];if(n=0,e.length&&!t.length){i=n++;for(var r=d(e),s=r.next();!s.done;s=r.next())s.value.variantIds.push(i)}if(!e.length&&t.length)for(i=n++,r=d(t),s=r.next();!s.done;s=r.next())s.value.variantIds.push(i);if(e.length&&t.length)for(t=d(t),i=t.next();!i.done;i=t.next())for(i=i.value,r=d(e),s=r.next();!s.done;s=r.next()){s=s.value;var a=n++;i.variantIds.push(a),s.variantIds.push(a)}}}function oA(){$w.apply(this,arguments)}function uA(e,t,n){return{id:e.id,originalId:e.originalId,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(i){return{startTime:t+i.startTime,endTime:t+i.endTime,initSegmentKey:e.initSegmentKey,appendWindowStart:t,appendWindowEnd:n,timestampOffset:t-e.presentationTimeOffset,dataKey:i.dataKey,tilesLayout:"",mimeType:null,codecs:null,thumbnailSprite:null}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}}function lA(){$w.apply(this,arguments)}function cA(){this.m=this.j=this.i=this.h=this.g=this.l=null}function dA(){var t=new Kr,n=e.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new Ve(2,9,9001,n.error)),e.preventDefault()},t}b(nA,$w),nA.prototype.updateManifestExpiration=function(e,t){var n,i,r,s=this;return U(function(a){return n=Bw(s.h,s.g),i=n.store(),r=new Kr,i.get(e).onsuccess=function(n){(n=n.target.result)?(n.expiration=t,i.put(n),r.resolve()):r.reject(new Ve(2,9,9012,"Could not find values for "+e))},w(a,Promise.all([n.promise(),r]),0)})},nA.prototype.Hd=function(e){var t,n,i,r,s,a;return U(function(o){if(1==o.g){for(t=[],n=0;n<e.periods.length;++n)i=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,r=i-e.periods[n].startTime,s=iA(e.periods[n],r),t.push(s);return w(o,Eb(t),2)}return a=o.h,o.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,streams:a,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})})},nA.prototype.Kh=function(e){return{data:e.data}},b(oA,$w),oA.prototype.Hd=function(e){var t,n,i,r,s,a;return U(function(o){if(1==o.g){for(t=[],n=0;n<e.periods.length;++n){i=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,r=i-e.periods[n].startTime;for(var u=e.periods[n],l=[],c=d(u.streams),h=c.next();!h.done;h=c.next())h=h.value,0!=h.variantIds.length&&l.push(uA(h,u.startTime,u.startTime+r));s=l,t.push(s)}return w(o,Eb(t),2)}return a=o.h,o.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:null==e.expiration?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:a,sequenceMode:!1})})},b(lA,$w),i=lA.prototype,i.hasFixedKeySpace=function(){return!1},i.addSegments=function(e){return this.add(this.i,e)},i.addManifests=function(e){return this.add(this.g,e)},i.updateManifest=function(e,t){return Gw(this,e,t)},i.Hd=function(e){return null==e.expiration&&(e.expiration=1/0),Promise.resolve(e)},i=cA.prototype,i.init=function(){var t=this,n=new Kr,i=!1,r=new _i(function(){i=!0,n.reject(new Ve(2,9,9017))});"number"===typeof hA&&0<hA&&r.ha(hA);var s=e.indexedDB.open("shaka_offline_db",5);return s.onsuccess=function(){if(!i){r.stop();var e=s.result;t.l=e;var a=e.objectStoreNames;a=a.contains("manifest")&&a.contains("segment")?new nA(e,"segment","manifest"):null,t.g=a,a=e.objectStoreNames,a=a.contains("manifest-v2")&&a.contains("segment-v2")?new oA(e,"segment-v2","manifest-v2"):null,t.h=a,a=e.objectStoreNames,a=a.contains("manifest-v3")&&a.contains("segment-v3")?new oA(e,"segment-v3","manifest-v3"):null,t.i=a,a=e.objectStoreNames,a=a.contains("manifest-v5")&&a.contains("segment-v5")?new lA(e,"segment-v5","manifest-v5"):null,t.j=a,e=e.objectStoreNames.contains("session-ids")?new Ww(e):null,t.m=e,n.resolve()}},s.onupgradeneeded=function(){for(var e=s.result,t=d(["segment-v5","manifest-v5","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},s.onerror=function(e){i||(r.stop(),n.reject(new Ve(2,9,9001,s.error)),e.preventDefault())},n},i.destroy=function(){var e=this;return U(function(t){switch(t.g){case 1:if(!e.g){t.u(2);break}return w(t,e.g.destroy(),2);case 2:if(!e.h){t.u(4);break}return w(t,e.h.destroy(),4);case 4:if(!e.i){t.u(6);break}return w(t,e.i.destroy(),6);case 6:if(!e.j){t.u(8);break}return w(t,e.j.destroy(),8);case 8:if(!e.m){t.u(10);break}return w(t,e.m.destroy(),10);case 10:e.l&&e.l.close(),A(t)}})},i.getCells=function(){var e=new Map;return this.g&&e.set("v1",this.g),this.h&&e.set("v2",this.h),this.i&&e.set("v3",this.i),this.j&&e.set("v5",this.j),e},i.getEmeSessionCell=function(){return this.m},i.erase=function(){var e=this;return U(function(t){switch(t.g){case 1:if(!e.g){t.u(2);break}return w(t,e.g.destroy(),2);case 2:if(!e.h){t.u(4);break}return w(t,e.h.destroy(),4);case 4:if(!e.i){t.u(6);break}return w(t,e.i.destroy(),6);case 6:if(!e.j){t.u(8);break}return w(t,e.j.destroy(),8);case 8:return e.l&&e.l.close(),w(t,dA(),10);case 10:return e.l=null,e.g=null,e.h=null,e.i=null,e.j=null,w(t,e.init(),0)}})};var hA=5;function fA(e,t,n,i){this.g=e,this.i=t,this.h=n,this.l=i,this.j=["offline:",e,"/",t,"/",n,"/",i].join("")}function pA(e){if(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e),null==e)return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var i=e[3];return i&&null!=t?new fA(t,n,i,Number(e[4])):null}function gA(e,t){this.h=e,this.g=t}function mA(e,t){var n=new Sl(null,0);n.ob(t.duration);var i=t.streams.filter(function(e){return"audio"==e.type}),r=t.streams.filter(function(e){return"video"==e.type});i=vA(e,i,r,n),r=t.streams.filter(function(e){return e.type==ft}).map(function(t){return yA(e,t,n)});var s=t.streams.filter(function(e){return"image"==e.type}).map(function(t){return yA(e,t,n)}),a=t.drmInfo?[t.drmInfo]:[];if(t.drmInfo)for(var o=d(i.values()),u=o.next();!u.done;u=o.next())u=u.value,u.audio&&u.audio.encrypted&&(u.audio.drmInfos=a),u.video&&u.video.encrypted&&(u.video.drmInfos=a);return{presentationTimeline:n,offlineSessionIds:t.sessionIds,variants:Array.from(i.values()),textStreams:r,imageStreams:s,sequenceMode:t.sequenceMode||!1,ignoreManifestTimestampsInSegmentsMode:!1,type:t.type||"UNKNOWN",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:null}}function vA(e,t,n,i){for(var r=new Set,s=d(t),a=s.next();!a.done;a=s.next()){a=d(a.value.variantIds);for(var o=a.next();!o.done;o=a.next())r.add(o.value)}for(s=d(n),a=s.next();!a.done;a=s.next())for(a=d(a.value.variantIds),o=a.next();!o.done;o=a.next())r.add(o.value);for(s=new Map,r=d(r),a=r.next();!a.done;a=r.next())a=a.value,s.set(a,{id:a,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(t=d(t),r=t.next();!r.done;r=t.next())for(a=r.value,r=yA(e,a,i),a=d(a.variantIds),o=a.next();!o.done;o=a.next())o=s.get(o.value),o.language=r.language,o.primary=o.primary||r.primary,o.audio=r;for(n=d(n),t=n.next();!t.done;t=n.next())for(r=t.value,t=yA(e,r,i),r=d(r.variantIds),a=r.next();!a.done;a=r.next())a=s.get(a.value),a.primary=a.primary||t.primary,a.video=t;return s}function yA(e,t,n){var i=t.segments.map(function(n){return bA(e,n,t)});return n.Yd(i),{id:t.id,originalId:t.originalId,groupId:t.groupId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Kl(i),mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate,pixelAspectRatio:t.pixelAspectRatio,hdr:t.hdr,colorGamut:t.colorGamut,videoLayout:t.videoLayout,kind:t.kind,encrypted:t.encrypted,drmInfos:[],keyIds:t.keyIds,language:t.language,originalLanguage:t.originalLanguage||null,label:t.label,type:t.type,primary:t.primary,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:t.roles,forced:t.forced,channelsCount:t.channelsCount,audioSamplingRate:t.audioSamplingRate,spatialAudio:t.spatialAudio,closedCaptions:t.closedCaptions,tilesLayout:t.tilesLayout,mssPrivateData:t.mssPrivateData,accessibilityPurpose:null,external:t.external,fastSwitching:t.fastSwitching,fullMimeTypes:new Set([hi(t.mimeType,t.codecs)]),isAudioMuxedInVideo:!1,baseOriginalId:null}}function bA(e,t,n){var i=new fA("segment",e.h,e.g,t.dataKey);return e=new No(t.startTime,t.endTime,function(){return[i.toString()]},0,null,null!=t.initSegmentKey?TA(e,t.initSegmentKey):null,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd,[],t.tilesLayout||""),e.mimeType=t.mimeType||n.mimeType||"",e.codecs=t.codecs||n.codecs||"",t.thumbnailSprite&&e.Df(t.thumbnailSprite),e}function TA(e,t){var n=new fA("segment",e.h,e.g,t);return new _o(function(){return[n.toString()]},0,null)}function SA(){this.g=null}function EA(){}function wA(e,t){var n=pA(e);return n&&"manifest"==n.g?(e={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"},originalRequest:t},e=zr(e)):e=n&&"segment"==n.g?AA(n.key(),n,t):qr(new Ve(2,1,9004,e)),e}function AA(e,t,n){var i=new qw;return zr(void 0).Ua(function(){return i.init()}).Ua(function(){return Xw(i,t.Pb(),t.bb())}).Ua(function(e){return e.getSegments([t.key()])}).Ua(function(e){return{uri:t,data:e[0].data,headers:{},originalRequest:n}}).finally(function(){return i.destroy()})}function xA(e,t,n){var i,r,s,a,o,u;return U(function(l){switch(l.g){case 1:i=[];for(var c=[],h=d(n),f=h.next();!f.done;f=h.next()){f=f.value;for(var p=!1,g=d(c),m=g.next();!m.done;m=g.next())if(m=m.value,kA(m.info,f)){m.sessionIds.push(f.sessionId),p=!0;break}p||c.push({info:f,sessionIds:[f.sessionId]})}r=d(c),s=r.next();case 2:if(s.done){l.u(4);break}return a=s.value,o=IA(e,t,a),w(l,o,5);case 5:u=l.h,i=i.concat(u),s=r.next(),l.u(2);break;case 4:return l.return(i)}})}function IA(e,t,n){var i,r;return U(function(s){switch(s.g){case 1:return i=new js({pc:t,onError:function(){},nf:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),x(s,2),i.configure(e),w(s,Hs(i,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:k(s,3);break;case 2:return L(s),w(s,i.destroy(),5);case 5:return s.return([]);case 3:return r=[],w(s,Promise.all(n.sessionIds.map(function(e){return U(function(t){return 1==t.g?(x(t,2),w(t,zs(i,e),4)):2!=t.g?(r.push(e),k(t,0)):(L(t),void A(t))})})),6);case 6:return w(s,i.destroy(),7);case 7:return s.return(r)}})}function kA(e,t){function n(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&Ft(e.audioCapabilities,t.audioCapabilities,n)&&Ft(e.videoCapabilities,t.videoCapabilities,n)}function LA(e,t,n){var i=t.presentationTimeline.getDuration();return t=CA(t),{offlineUri:null,originalManifestUri:e,duration:i,size:0,expiration:1/0,tracks:t,appMetadata:n,isIncomplete:!1}}function RA(e,t){var n=mA(new gA(e.Pb(),e.bb()),t),i=t.appMetadata||{};return n=CA(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:i,isIncomplete:t.isIncomplete||!1}}function CA(e){var t=[],n=Tr(e.variants);n=d(n);for(var i=n.next();!i.done;i=n.next())t.push(fr(i.value));for(e=d(e.textStreams),n=e.next();!n.done;n=e.next())t.push(pr(n.value));return t}function DA(){this.g=new Map}function MA(e,t){var n=t.audio,i=t.video;if(n&&!i&&e.g.set(n.id,n.bandwidth||t.bandwidth),!n&&i&&e.g.set(i.id,i.bandwidth||t.bandwidth),n&&i){var r=n.bandwidth||393216,s=i.bandwidth||t.bandwidth-r;0>=s&&(s=t.bandwidth),e.g.set(n.id,r),e.g.set(i.id,s)}}function PA(e,t){e.g.set(t.id,t.bandwidth||2048)}function _A(e,t){return e=e.g.get(t),null==e&&(e=0),e}function OA(e){var t=this;if(e&&e.constructor!=Pf)throw new Ve(2,9,9008);this.g=this.h=null,e?(this.h=e.g,this.g=e.Nb()):(this.h=Ud(),this.g=new ss,this.g.configure(this.h.networking)),this.i=[],this.l=[];var n=!e;this.j=new ys(function(){var e,i,r,s,a;return U(function(o){switch(o.g){case 1:return w(o,Promise.all(t.l.map(function(e){return Mw(e)})),2);case 2:for(e=function(){},i=[],r=d(t.i),s=r.next();!s.done;s=r.next())a=s.value,i.push(a.then(e,e));return w(o,Promise.all(i),3);case 3:if(!n){o.u(4);break}return w(o,t.g.destroy(),4);case 4:t.h=null,t.g=null,A(o)}})}),this.m=1e9}function NA(){if(KT(ce()))e:{for(var e=d(tA.values()),t=e.next();!t.done;t=e.next())if(t=t.value,t=t()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function UA(e,t,n,i,r,s,a,o){var u,l,c,h,f,p,g,m,v,y,b,T,S,E,A,I,k,D,M,P,_,O,N,F;return U(function(U){switch(U.g){case 1:return ox(),l=u=null,c=new qw,p=f=h=null,x(U,2,3),w(U,s(),5);case 5:return u=U.h,w(U,JA(e,t,u,a),6);case 6:if(g=U.h,ax(e),m=!g.presentationTimeline.V()&&!g.presentationTimeline.Sc(),!m)throw new Ve(2,9,9005,t);v=d(i),y=v.next();case 7:if(y.done){U.u(9);break}return b=y.value,w(U,ZA(e,b,g),10);case 10:T=U.h,g.imageStreams.push(T),ax(e),y=v.next(),U.u(7);break;case 9:S=d(r),E=S.next();case 11:return E.done?(Sa(a.drm.clearKeys,g.variants),k=g.variants.some(function(e){if(e.audio)for(var t=d(e.audio.drmInfos),n=t.next();!n.done;n=t.next())if(n.value.licenseServerUri.startsWith("data:"))return!0;if(e.video)for(e=d(e.video.drmInfos),t=e.next();!t.done;t=e.next())if(t.value.licenseServerUri.startsWith("data:"))return!0;return!1}),D=a.offline.usePersistentLicense,k&&(D=!1),w(U,e.ed(g,function(e){p=p||e},a,D),15)):(A=E.value,w(U,ex(e,g,A.uri,A.language,A.kind,A.mime,A.codecs),14));case 14:I=U.h,g.textStreams.push(I),ax(e),E=S.next(),U.u(11);break;case 15:if(l=U.h,ax(e),p)throw p;return w(U,$A(g,l,a,D),16);case 16:return w(U,c.init(),17);case 17:return ax(e),w(U,Yw(c),18);case 18:return h=U.h,ax(e),M=GA(l,g,t,n,a,o,D),P=M.jk,_=M.uh,w(U,h.bb.addManifests([P]),19);case 19:if(O=U.h,ax(e),f=O[0],ax(e),p)throw p;return w(U,FA(e,_,f,P,o,a,h.bb,g,l,D),20);case 20:return ax(e),KA(g,P,l,D),w(U,h.bb.updateManifest(f,P),21);case 21:return ax(e),N=new fA("manifest",h.path.Pb,h.path.bb,f),U.return(RA(N,P));case 3:return R(U),w(U,c.destroy(),22);case 22:if(!u){U.u(23);break}return w(U,u.stop(),23);case 23:if(!l){U.u(25);break}return w(U,l.destroy(),25);case 25:C(U,0);break;case 2:if(F=L(U),null==f){U.u(27);break}return w(U,BA(f),27);case 27:throw p||F}})}function FA(e,t,n,i,r,s,a,o,u,l){var c,h,f,p,g,m,v,y,b,T,S;return U(function(E){switch(E.g){case 1:if(c={},h=0,f=function(){if(e.j.g||r.l)throw new Ve(2,9,7001)},p=function(e,t){var p,g,m,v,y,b,T,S,E;return U(function(x){if(1==x.g){for(p=d(e),g=p.next(),m={};!g.done;m={hc:void 0},g=p.next())m.hc=g.value,f(),v=Iw(m.hc,s),y=m.hc.i,b=m.hc.h,T=function(e){return function(t){var n,i,r,s;return U(function(o){switch(o.g){case 1:if(n=e.hc.g,i=n.Wb(!1),!n.aesKey||i){o.u(2);break}return w(o,Lc(t,n.aesKey,e.hc.j),3);case 3:t=o.h;case 2:return r=xw(n),w(o,a.addSegments([{data:t}]),4);case 4:s=o.h,f(),c[r]=s[0],h+=t.byteLength,A(o)}})}}(m),S=m.hc.g,(E=S.Wb(!1))?Pw(r,m.hc.groupId,E,y,b,T):r.queue(m.hc.groupId,v,y,b,T);return w(x,_w(r),2)}return f(),!t||r.l?x.u(0):(KA(o,i,u,l),w(x,a.updateManifest(n,i),0))})},g=!1,x(E,2),!VA(o)||!g||HA(o)){E.u(4);break}return w(E,p(t.filter(function(e){return e.h}),!0),5);case 5:return f(),t=t.filter(function(e){return!e.h}),m=c,v=h,c={},h=0,w(E,jA(a,n,i,m,v,function(){return ax(e)}),6);case 6:f();case 4:if(g){E.u(7);break}return w(E,p(t,!1),8);case 8:return f(),y=c,b=h,c={},h=0,w(E,jA(a,n,i,y,b,function(){return f()}),9);case 9:f();case 7:k(E,0);break;case 2:return T=L(E),S=Object.values(c),w(E,a.removeSegments(S,function(){}),10);case 10:throw T}})}function BA(e){var t,n,i,r;return U(function(s){switch(s.g){case 1:return t=new qw,w(s,t.init(),2);case 2:return w(s,Yw(t),3);case 3:return n=s.h,i=new fA("manifest",n.path.Pb,n.path.bb,e),w(s,t.destroy(),4);case 4:return r=new OA,w(s,r.remove(i.toString()),0)}})}function jA(e,t,n,i,r,s){var a,o,u,l,c,h,f,p,g,m,v;return U(function(y){switch(y.g){case 1:for(a=!1,x(y,2),o=!0,u=d(n.streams),l=u.next();!l.done;l=u.next())for(c=l.value,h=d(c.segments),f=h.next();!f.done;f=h.next())p=f.value,g=p.pendingSegmentRefId?i[p.pendingSegmentRefId]:null,null!=g&&(p.dataKey=g,p.pendingSegmentRefId=void 0),g=p.pendingInitSegmentRefId?i[p.pendingInitSegmentRefId]:null,null!=g&&(p.initSegmentKey=g,p.pendingInitSegmentRefId=void 0),p.pendingSegmentRefId&&(o=!1),p.pendingInitSegmentRefId&&(o=!1);return n.size+=r,o&&(n.isIncomplete=!1),w(y,e.updateManifest(t,n),4);case 4:a=!0,s(),k(y,0);break;case 2:return m=L(y),w(y,BA(t),5);case 5:if(a){y.u(6);break}return v=Object.values(i),w(y,e.removeSegments(v,function(){}),6);case 6:throw m}})}function $A(e,t,n,i){var r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,I,R,C,D,M,P,_,O,N,F,B,j;return U(function(U){switch(U.g){case 1:return r={width:1/0,height:1/0},Ji(e,n.restrictions,r),w(U,tr(t,e,i,n.drm.preferredKeySystems,n.drm.keySystemsMapping),2);case 2:for(s=[],a=n.preferredDecodingAttributes,o=n.preferredVideoCodecs,u=n.preferredAudioCodecs,l=n.preferredTextFormats,Xi(e,o,u,a,l),c=d(e.variants),h=c.next();!h.done;h=c.next())f=h.value,s.push(fr(f));for(p=d(e.textStreams),g=p.next();!g.done;g=p.next())m=g.value,s.push(pr(m));for(v=d(e.imageStreams),y=v.next();!y.done;y=v.next())b=y.value,s.push(gr(b));return w(U,n.offline.trackSelectionCallback(s),3);case 3:for(T=U.h,S=e.presentationTimeline.getDuration(),E=0,I=d(T),R=I.next();!R.done;R=I.next())C=R.value,D=C.bandwidth*S/8,E+=D;return x(U,4),w(U,n.offline.downloadSizeCallback(E),6);case 6:if(M=U.h,!M)throw new Ve(2,9,9014);k(U,5);break;case 4:if(P=L(U),P instanceof Ve)throw P;throw new Ve(2,9,9015);case 5:for(_=new Set,O=new Set,N=new Set,F=d(T),B=F.next();!B.done;B=F.next())j=B.value,"variant"==j.type&&_.add(j.id),"text"==j.type&&O.add(j.id),"image"==j.type&&N.add(j.id);e.variants=e.variants.filter(function(e){return _.has(e.id)}),e.textStreams=e.textStreams.filter(function(e){return O.has(e.id)}),e.imageStreams=e.imageStreams.filter(function(e){return N.has(e.id)}),fx(e),A(U)}})}function GA(e,t,n,i,r,s,a){var o=LA(n,t,i),u=r.offline.progressCallback;Dw(s,function(e,t){o.size=t,u(o,e)},function(t,n){l&&a&&c==n&&Qs(e,"cenc",t)});var l=VA(t)&&!HA(t),c=null;l&&(c=px.get(e.g.keySystem));for(var h=new DA,f=d(t.textStreams),p=f.next();!p.done;p=f.next())h.g.set(p.value.id,52);for(f=d(t.imageStreams),p=f.next();!p.done;p=f.next())PA(h,p.value);for(f=d(t.variants),p=f.next();!p.done;p=f.next())MA(h,p.value);return s=ix(s,h,t,r),r=s.streams,s=s.uh,(h=e.g)&&a&&(h.initData=[]),{jk:{creationTime:Date.now(),originalManifestUri:n,duration:t.presentationTimeline.getDuration(),size:0,expiration:e.Nd(),streams:r,sessionIds:a?Js(e):[],drmInfo:h,appMetadata:i,isIncomplete:!0,sequenceMode:t.sequenceMode,type:t.type},uh:s}}function VA(e){return e.variants.some(function(e){var t=e.audio&&e.audio.encrypted;return e.video&&e.video.encrypted||t})}function HA(e){return e.variants.some(function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]).some(function(e){return e.initData&&e.initData.length})})}function KA(e,t,n,i){if(t.expiration=n.Nd(),n=Js(n),t.sessionIds=i?n:[],VA(e)&&i&&!n.length)throw new Ve(2,9,9007)}function WA(e,t){var n,i,r,s,a,o;return U(function(u){switch(u.g){case 1:if(ox(),n=pA(t),null==n||"manifest"!=n.g)throw new Ve(2,9,9004,t);return i=n,r=new qw,I(u,2),w(u,r.init(),4);case 4:return w(u,Xw(r,i.Pb(),i.bb()),5);case 5:return s=u.h,w(u,s.getManifests([i.key()]),6);case 6:return a=u.h,o=a[0],w(u,Promise.all([YA(e,o,r),zA(s,i,o)]),2);case 2:return R(u),w(u,r.destroy(),8);case 8:C(u,0)}})}function qA(e,t){for(var n=[],i=d(e.streams),r=i.next();!r.done;r=i.next())r=r.value,t&&"video"==r.type?n.push({contentType:hi(r.mimeType,r.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=r.type||n.push({contentType:hi(r.mimeType,r.codecs),robustness:e.drmInfo.audioRobustness});return n}function YA(e,t,n){return U(function(i){return w(i,dx(e.g,e.h.drm,n,t),0)})}function zA(e,t,n){function i(){}var r=cx(n);return RA(t,n),Promise.all([e.removeSegments(r,i),e.removeManifests([t.key()],i)])}function XA(e){var t,n,i,r,s,a,o,u,l,c;return U(function(h){switch(h.g){case 1:return ox(),t=e.g,n=e.h.drm,i=new qw,r=!1,I(h,2),w(h,i.init(),4);case 4:s=[],Qw(i,function(e){return s.push(e)}),a=d(s),o=a.next();case 5:if(o.done){h.u(2);break}return u=o.value,w(h,u.getAll(),8);case 8:return l=h.h,w(h,xA(n,t,l),9);case 9:return c=h.h,w(h,u.remove(c),10);case 10:c.length!=l.length&&(r=!0),o=a.next(),h.u(5);break;case 2:return R(h),w(h,i.destroy(),11);case 11:C(h,3);break;case 3:return h.return(!r)}})}function QA(){var e,t,n;return U(function(i){switch(i.g){case 1:return ox(),e=[],t=new qw,I(i,2),w(i,t.init(),4);case 4:return n=Promise.resolve(),zw(t,function(t,i){n=n.then(function(){var n;return U(function(r){if(1==r.g)return w(r,i.getAllManifests(),2);n=r.h,n.forEach(function(n,i){n=RA(new fA("manifest",t.Pb,t.bb,i),n),e.push(n)}),A(r)})})}),w(i,n,2);case 2:return R(i),w(i,t.destroy(),6);case 6:C(i,3);break;case 3:return i.return(e)}})}function JA(e,t,n,i){var r,s,a,o,u;return U(function(l){if(1==l.g)return r=null,s=e.g,a={networkingEngine:s,filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){r=e},isLowLatencyMode:function(){return!1},updateDuration:function(){},newDrmInfo:function(){},onManifestUpdated:function(){},getBandwidthEstimate:function(){return i.abr.defaultBandwidthEstimate},onMetadata:function(){},disableStream:function(){},addFont:function(){}},n.configure(i.manifest),ax(e),w(l,n.start(t,a),2);if(3!=l.g)return o=l.h,ax(e),u=hx(o),w(l,Promise.all(Ts(u,function(e){return e.createSegmentIndex()})),3);if(ax(e),r)throw r;return l.return(o)})}function ZA(e,t,n){var i,r,s,a,o,u,l,c,h,f,p,g,m,v,y;return U(function(b){switch(b.g){case 1:return w(b,tx(e,t),2);case 2:if(i=b.h,"text/vtt"!=i)throw new Ve(1,2,2017,t);return w(b,nx(t,e.g,e.h.streaming.retryParameters),3);case 3:if(r=b.h,s=xi(i),!s)throw new Ve(2,2,2014,i);for(a=s(),o={periodStart:0,segmentStart:0,segmentEnd:n.presentationTimeline.getDuration(),vttOffset:0},u=Be(r),l=a.parseMedia(u,o,t,[]),c=[],h=d(l),f=h.next(),p={};!f.done;p={Kf:void 0,gd:void 0},f=h.next())p.gd=f.value,p.Kf=null,g=function(e){return function(){return null==e.Kf&&(e.Kf=ot([t],[e.gd.payload])),e.Kf||[]}}(p),m=new No(p.gd.startTime,p.gd.endTime,g,0,null,null,0,0,1/0),p.gd.payload.includes("#xywh")&&(v=p.gd.payload.split("#xywh=")[1].split(","),4===v.length&&m.Df({height:parseInt(v[3],10),positionX:parseInt(v[0],10),positionY:parseInt(v[1],10),width:parseInt(v[2],10)})),c.push(m);if(y=i,!c.length){b.u(4);break}return w(b,Th(c[0].O()[0],e.g,e.h.manifest.retryParameters),5);case 5:y=b.h;case 4:return b.return({id:e.m++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Kl(c),mimeType:y||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:"image",primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([hi(y||"","")]),isAudioMuxedInVideo:!1,baseOriginalId:null})}})}function ex(e,t,n,i,r,s,a){var o,u,l;return U(function(c){if(1==c.g)return s?c.u(2):w(c,tx(e,n),3);if(2!=c.g&&(s=c.h),o={id:e.m++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:ql(0,t.presentationTimeline.getDuration(),[n]),mimeType:s||"",codecs:a||"",kind:r,encrypted:!1,drmInfos:[],keyIds:new Set,language:i,originalLanguage:i,label:null,type:ft,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([hi(s||"",a||"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},u=hi(o.mimeType,o.codecs),l=Ii(u),!l)throw new Ve(2,2,2014,s);return c.return(o)})}function tx(e,t){var n;return U(function(i){switch(i.g){case 1:return x(i,2),w(i,Th(t,e.g,e.h.streaming.retryParameters),4);case 4:n=i.h,k(i,3);break;case 2:L(i);case 3:if(n)return i.return(n);throw new Ve(1,2,2011,t)}})}function nx(e,t,n){var i,r,s;return U(function(a){return 1==a.g?(i=gs,r=us([e],n),r.method="GET",w(a,t.request(i,r).promise,2)):(s=a.h,a.return(s.data))})}function ix(e,t,n,i){var r=new Map,s=hx(n),a=new Map;s=d(s);for(var o=s.next();!o.done;o=s.next()){o=o.value;var u=rx(e,t,n,o,i,r);a.set(o.id,u)}for(e=d(n.variants),t=e.next();!t.done;t=e.next())t=t.value,t.audio&&a.get(t.audio.id).variantIds.push(t.id),t.video&&a.get(t.video.id).variantIds.push(t.id);return{streams:Array.from(a.values()),uh:Array.from(r.values())}}function rx(e,t,n,i,r,s){var a={id:i.id,originalId:i.originalId,groupId:i.groupId,primary:i.primary,type:i.type,mimeType:i.mimeType,codecs:i.codecs,frameRate:i.frameRate,pixelAspectRatio:i.pixelAspectRatio,hdr:i.hdr,colorGamut:i.colorGamut,videoLayout:i.videoLayout,kind:i.kind,language:i.language,originalLanguage:i.originalLanguage,label:i.label,width:i.width||null,height:i.height||null,encrypted:i.encrypted,keyIds:i.keyIds,segments:[],variantIds:[],roles:i.roles,forced:i.forced,channelsCount:i.channelsCount,audioSamplingRate:i.audioSamplingRate,spatialAudio:i.spatialAudio,closedCaptions:i.closedCaptions,tilesLayout:i.tilesLayout,mssPrivateData:i.mssPrivateData,external:i.external,fastSwitching:i.fastSwitching,isAudioMuxedInVideo:i.isAudioMuxedInVideo},o=r.offline.numberOfParallelDownloads,u=0===o?i.id:0;return sx(i,n.presentationTimeline.Fb(),function(n,r){var l=xw(n),c=void 0;if(!s.has(l)){var d=n.endTime-n.startTime;d=_A(t,i.id)*d,d=Lw(e.g,d),s.set(l,new Aw(n,d,u,!1,r))}n.Y&&(c=xw(n.Y),s.has(c)||(d=.5*_A(t,i.id),d=Lw(e.g,d),s.set(c,new Aw(n.Y,d,u,!0,r)))),a.segments.push({pendingInitSegmentRefId:c,initSegmentKey:c?0:null,startTime:n.startTime,endTime:n.endTime,appendWindowStart:n.appendWindowStart,appendWindowEnd:n.appendWindowEnd,timestampOffset:n.timestampOffset,tilesLayout:n.tilesLayout,pendingSegmentRefId:l,dataKey:0,mimeType:n.mimeType,codecs:n.codecs,thumbnailSprite:n.thumbnailSprite}),0!==o&&(u=(u+1)%o)}),a}function sx(e,t,n){if(t=e.segmentIndex.find(t),null!=t)for(var i=e.segmentIndex.get(t);i;)n(i,t),i=e.segmentIndex.get(++t)}function ax(e){if(e.j.g)throw new Ve(2,9,7001)}function ox(){if(!NA())throw new Ve(2,9,9e3)}function ux(e,t){return U(function(n){return 1==n.g?(e.i.push(t),I(n,2),w(n,t,4)):2!=n.g?n.return(n.h):(R(n),Ut(e.i,t),C(n,0))})}function lx(e,t){var n=t.promise;return e.i.push(n),t.finally(function(){Ut(e.i,n)})}function cx(e){var t=new Set;e=d(e.streams);for(var n=e.next();!n.done;n=e.next()){n=d(n.value.segments);for(var i=n.next();!i.done;i=n.next())i=i.value,null!=i.initSegmentKey&&t.add(i.initSegmentKey),t.add(i.dataKey)}return Array.from(t)}function dx(e,t,n,i){var r,s,a;return U(function(o){return 1==o.g?i.drmInfo?(r=Jw(n),s=i.sessionIds.map(function(e){return{sessionId:e,keySystem:i.drmInfo.keySystem,licenseUri:i.drmInfo.licenseServerUri,serverCertificate:i.drmInfo.serverCertificate,audioCapabilities:qA(i,!1),videoCapabilities:qA(i,!0)}}),w(o,xA(t,e,s),2)):o.return():3!=o.g?(a=o.h,w(o,r.remove(a),3)):w(o,r.add(s.filter(function(e){return!a.includes(e.sessionId)})),0)})}function hx(e){for(var t=new Set,n=d(e.variants),i=n.next();!i.done;i=n.next())i=i.value,i.audio&&t.add(i.audio),i.video&&t.add(i.video);for(n=d(e.textStreams),i=n.next();!i.done;i=n.next())t.add(i.value);for(e=d(e.imageStreams),n=e.next();!n.done;n=e.next())t.add(n.value);return t}function fx(e){e.variants.map(function(e){return e.video});var t=new Set(e.variants.map(function(e){return e.audio}));e=e.textStreams;for(var n=d(t),i=n.next();!i.done;i=n.next()){i=d(t);for(var r=i.next();!r.done;r=i.next());}for(t=d(e),n=t.next();!n.done;n=t.next())for(n=d(e),i=n.next();!i.done;i=n.next());}K("shaka.offline.indexeddb.StorageMechanismOpenTimeout",hA),eA("idb",function(){return ce().ph()?new cA:null}),fA.prototype.Pb=function(){return this.i},fA.prototype.bb=function(){return this.h},fA.prototype.key=function(){return this.l},fA.prototype.toString=function(){return this.j},i=SA.prototype,i.configure=function(){},i.start=function(e,t){var n,i,r,s,a,o,u,l=this;return U(function(c){switch(c.g){case 1:if(n=pA(e),l.g=n,null==n||"manifest"!=n.g)throw new Ve(2,1,9004,e);return i=new qw,I(c,2),w(c,i.init(),4);case 4:return w(c,Xw(i,n.Pb(),n.bb()),5);case 5:return r=c.h,w(c,r.getManifests([n.key()]),6);case 6:return s=c.h,a=s[0],o=new gA(n.Pb(),n.bb()),u=mA(o,a),t.makeTextStreamsForClosedCaptions(u),c.return(u);case 2:return R(c),w(c,i.destroy(),7);case 7:C(c,0)}})},i.stop=function(){return Promise.resolve()},i.update=function(){},i.onExpirationUpdated=function(e,t){var n,i,r,s,a,o,u,l=this;return U(function(c){switch(c.g){case 1:return n=l.g,i=new qw,x(c,2,3),w(c,i.init(),5);case 5:return w(c,Xw(i,n.Pb(),n.bb()),6);case 6:return r=c.h,w(c,r.getManifests([n.key()]),7);case 7:if(s=c.h,a=s[0],o=a.sessionIds.includes(e),u=void 0==a.expiration||a.expiration>t,!o||!u){c.u(3);break}return w(c,r.updateManifestExpiration(n.key(),t),3);case 3:return R(c),w(c,i.destroy(),10);case 10:C(c,0);break;case 2:L(c),c.u(3)}})},i.onInitialVariantChosen=function(){},i.banLocation=function(){},i.setMediaElement=function(){},ja("application/x-offline-manifest",function(){return new SA}),K("shaka.offline.OfflineScheme",EA),EA.plugin=wA,as("offline",wA),i=OA.prototype,i.destroy=function(){return this.j.destroy()},i.configure=function(e,t){return 2==arguments.length&&"string"==typeof e&&(e=yd(e,t)),Bd(this.h,e)},i.getConfiguration=function(){var e=Ud();return Bd(e,this.h,Ud()),e},i.Nb=function(){return this.g},i.store=function(e,t,n,i,r){var s=this,a=this.getConfiguration(),o=new Cw(this.g);return this.l.push(o),t=UA(this,e,t||{},i||[],r||[],function(){var t;return U(function(i){return 1==i.g?n?i.u(2):w(i,Th(e,s.g,a.manifest.retryParameters),3):(2!=i.g&&(n=i.h),t=Ga(e,n||null),i.return(t()))})},a,o),t=new Wr(t,function(){return Mw(o)}),t.finally(function(){Ut(s.l,o)}),lx(this,t)},i.remove=function(e){return ux(this,WA(this,e))},i.Gk=function(){return ux(this,XA(this))},i.list=function(){return ux(this,QA())},i.ed=function(e,t,n,i){var r,s=this;return U(function(a){return 1==a.g?(r=new js({pc:s.g,onError:t,nf:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),r.configure(n.drm),w(a,Gs(r,e.variants,i),2)):3!=a.g?w(a,Xs(r),3):a.return(r)})},K("shaka.offline.Storage",OA),OA.deleteAll=function(){var e;return U(function(t){return 1==t.g?(e=new qw,I(t,2),w(t,Zw(e),2)):5!=t.g?(R(t),w(t,e.destroy(),5)):C(t,0)})},OA.prototype.list=OA.prototype.list,OA.prototype.removeEmeSessions=OA.prototype.Gk,OA.prototype.remove=OA.prototype.remove,OA.prototype.store=OA.prototype.store,OA.prototype.getNetworkingEngine=OA.prototype.Nb,OA.prototype.getConfiguration=OA.prototype.getConfiguration,OA.prototype.configure=OA.prototype.configure,OA.prototype.destroy=OA.prototype.destroy,OA.support=NA;var px=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.huawei.wiseplay","3d5e6d359b9a41e8b843dd3c6e72c42c");function gx(){}function mx(e,t){for(e={priority:t||0,callback:e},t=0;t<vx.length;t++)if(vx[t].priority<e.priority)return void vx.splice(t,0,e);vx.push(e)}Uf("offline",NA),K("shaka.polyfill",gx),gx.register=mx,gx.installAll=function(){for(var e=d(vx),t=e.next();!t.done;t=e.next()){t=t.value;try{t.callback()}catch(n){Q("Error installing polyfill!",n)}}};var vx=[];function yx(){}function bx(){if(!Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))for(var e=d(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),t=e.next();!t.done;t=e.next())Tx(t.value)}function Tx(e){var t="aria-"+e.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,e,{get:function(){return this.getAttribute(t)},set:function(e){null==e||void 0==e?this.removeAttribute(t):this.setAttribute(t,e)}})}function Sx(){}function Ex(){ce().oh()&&ZL()}function wx(){}function Ax(){if(e.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,t=Document.prototype,t.exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",xx),document.addEventListener("webkitfullscreenerror",xx),document.addEventListener("mozfullscreenchange",xx),document.addEventListener("mozfullscreenerror",xx),document.addEventListener("MSFullscreenChange",xx),document.addEventListener("MSFullscreenError",xx)}}function xx(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),n=document.createEvent("Event");n.initEvent(t,e.bubbles,e.cancelable),e.target.dispatchEvent(n)}function Ix(){}function kx(){ce().bc()||(navigator.mediaCapabilities||(navigator.mediaCapabilities={}),Ix.originalMcap=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=Lx)}function Lx(e){var t,n,i,r,s,a,o,u,l,c,d;return U(function(h){switch(h.g){case 1:if(t={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:e},ce(),n=e.video,i=e.audio,"media-source"!=e.type){if("file"!=e.type)return h.return(t);if(n&&(r=n.contentType,s=""!=Xo().canPlayType(r),!s)||i&&(a=i.contentType,o=""!=Xo().canPlayType(a),!o))return h.return(t);h.u(2);break}if(!KT())return h.return(t);if(!n){h.u(3);break}return w(h,Rx(n),4);case 4:if(u=h.h,!u)return h.return(t);case 3:if(i){var f=ce().La(),p=i.contentType;if("CAST"===f&&i.spatialRendering&&(p+="; spatialRendering=true"),l=St(p),!l)return h.return(t)}case 2:return e.keySystemConfiguration?(c=e.keySystemConfiguration,w(h,Cx(n,i,c),6)):(t.supported=!0,h.return(t));case 6:(d=h.h)&&(t.supported=!0,t.keySystemAccess=d);case 5:return h.return(t)}})}function Rx(e){var t,n,i;return U(function(r){return 1==r.g?(t=ce(),n=t.La(),"CAST"!==n?r.u(2):w(r,Dx(e),3)):2!=r.g?(i=r.h,r.return(i)):r.return(St(e.contentType))})}function Cx(e,t,n){var i,r,s,a,o,u,l,c,d,h,f;return U(function(p){switch(p.g){case 1:if(i=[],r=[],n.audio&&(s={robustness:n.audio.robustness||"",contentType:t.contentType},ce().ji()&&t.contentType.includes('codecs="ac-3"')&&(s.contentType='audio/mp4; codecs="ec-3"'),n.audio.encryptionScheme&&(s.encryptionScheme=n.audio.encryptionScheme),i.push(s)),n.video&&(a={robustness:n.video.robustness||"",contentType:e.contentType},n.video.encryptionScheme&&(a.encryptionScheme=n.video.encryptionScheme),r.push(a)),o={initDataTypes:[n.initDataType],distinctiveIdentifier:n.distinctiveIdentifier,persistentState:n.persistentState,sessionTypes:n.sessionTypes},i.length&&(o.audioCapabilities=i),r.length&&(o.videoCapabilities=r),u=e?e.contentType:"",l=t?t.contentType:"",c=yi(u)+";"+vi(u),d=yi(l)+";"+vi(l),h=n.keySystem,f=null,x(p,2),$r.has(c+"#"+d+"#"+h)){f=$r.get(c+"#"+d+"#"+h)||null,p.u(4);break}return w(p,navigator.requestMediaKeySystemAccess(n.keySystem,[o]),5);case 5:f=p.h,$r.set(c+"#"+d+"#"+h,f);case 4:k(p,3);break;case 2:L(p);case 3:return p.return(f)}})}function Dx(t){var n,i,r,s,a;return U(function(o){if(1==o.g){if(!(e.cast&&cast.__platform__&&cast.__platform__.canDisplayType))return o.return(St(t.contentType));switch(n=t.contentType,t.width&&t.height&&1280<t.width&&720<t.height&&(n+="; width="+t.width+"; height="+t.height),t.framerate&&(i=Math.round(t.framerate),24>i||30<i)&&(n+="; framerate="+t.framerate),r=t.transferFunction||"",r){case"":case"srgb":break;case"pq":n+="; eotf=smpte2084";break;case"hlg":n+="; eotf=arib-std-b67";break;default:return o.return(!1)}return s=!1,a=Fx,a.has(n)?(s=a.get(n),o.u(2)):w(o,cast.__platform__.canDisplayType(n),3)}return 2!=o.g&&(s=o.h,a.set(n,s)),o.return(s)})}gx.Aria=yx,yx.install=bx,mx(bx),gx.EncryptionScheme=Sx,Sx.install=Ex,mx(Ex,-2),gx.Fullscreen=wx,wx.install=Ax,mx(Ax),gx.MediaCapabilities=Ix,Ix.install=kx,Ix.originalMcap=null;var Mx,Px,_x,Ox,Nx,Ux,Fx=new Map;function Bx(){}function jx(){var t=ce(),n="WEBKIT"===t.Da()?t.Ca():null;for((e.MediaSource||e.ManagedMediaSource)&&n&&e.MediaSource&&(12>=n?($x(),Gx()):15>=n&&$x()),t=d(t.ui()),n=t.next();!n.done;n=t.next())Hx(n.value);(e.MediaSource||e.ManagedMediaSource)&&Vx(),e.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&Kx()}function $x(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=e.apply(this,F.apply(0,arguments));return t.abort=function(){},t}}function Gx(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}function Vx(){if(e.MediaSource){var t=MediaSource.isTypeSupported.bind(MediaSource);MediaSource.isTypeSupported=function(e){return"mp2t"!=gi(e)&&t(e)}}if(e.ManagedMediaSource){var n=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);e.ManagedMediaSource.isTypeSupported=function(e){return"mp2t"!=gi(e)&&n(e)}}}function Hx(t){var n=MediaSource.isTypeSupported.bind(MediaSource);if(MediaSource.isTypeSupported=function(e){return vi(e)!=t&&n(e)},e.ManagedMediaSource){var i=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);e.ManagedMediaSource.isTypeSupported=function(e){return vi(e)!=t&&i(e)}}}function Kx(){var e=MediaSource.isTypeSupported;ce().Ti()&&(MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */),i=n.findIndex(function(e){return e.startsWith("codecs=")});if(0>i)return e(t);var r=n[i].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),s=r.findIndex(function(e){return e.startsWith("vp09")});return 0<=s&&(r[s]="vp9",n[i]='codecs="'+r.join(",")+'"',t=n.join("; ")),e(t)})}function Wx(){}function qx(){screen.orientation&&screen.orientation.unlock||(void 0!=screen.orientation?Yx():void 0!=e.orientation&&zx())}function Yx(){void 0===screen.orientation.lock&&(screen.orientation.lock=function(){return Promise.resolve()}),void 0===screen.orientation.unlock&&(screen.orientation.unlock=function(){})}function zx(){function t(){switch(e.orientation){case-90:n.type="landscape-secondary",n.angle=270;break;case 0:n.type="portrait-primary",n.angle=0;break;case 90:n.type="landscape-primary",n.angle=90;break;case 180:n.type="portrait-secondary",n.angle=180}}var n=new Xx;screen.orientation=n,t(),e.addEventListener("orientationchange",function(){t();var e=new Zr("change");n.dispatchEvent(e)})}function Xx(){ns.call(this),this.type="",this.angle=0}function Qx(){}function Jx(t){e.HTMLVideoElement&&e.WebKitMediaKeys&&e.shakaMediaKeysPolyfill!=uI&&(void 0!==t&&t&&(Mx=!0,Px=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),_x=HTMLMediaElement.prototype.setMediaKeys,Ox=e.MediaKeys,Nx=e.MediaKeySystemAccess,Ux=navigator.requestMediaKeySystemAccess),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=eI,e.MediaKeys=iI,e.MediaKeySystemAccess=nI,navigator.requestMediaKeySystemAccess=Zx,e.shakaMediaKeysPolyfill=uI,Ir.clear(),$r.clear())}function Zx(e,t){try{var n=new nI(e,t);return Promise.resolve(n)}catch(i){return Promise.reject(i)}}function eI(e){var t=this.mediaKeys;return t&&t!=e&&rI(t,null),delete this.mediaKeys,(this.mediaKeys=e)?rI(e,this):Promise.resolve()}function tI(e){if(e=Be(e.initData),$e(e).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=qe(e.subarray(4),!0),e=ze(e);var t=new Event("encrypted");t.initDataType="skd",t.initData=Fe(e),this.dispatchEvent(t)}function nI(e,t){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(e=d(t),t=e.next();!t.done;t=e.next()){var n=t.value;if("required"==n.persistentState)t=null;else{t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:n.initDataTypes,sessionTypes:["temporary"],label:n.label};var i=!1,r=!1;if(n.audioCapabilities)for(var s=d(n.audioCapabilities),a=s.next();!a.done;a=s.next())a=a.value,a.contentType&&(i=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,a.contentType.split(";")[0])&&(t.audioCapabilities.push(a),r=!0));if(n.videoCapabilities)for(n=d(n.videoCapabilities),s=n.next();!s.done;s=n.next())s=s.value,s.contentType&&(i=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,s.contentType.split(";")[0])&&(t.videoCapabilities.push(s),r=!0));i||(r=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),t=r?t:null}if(t)return void(this.g=t)}throw e=Error("Unsupported keySystem"),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function iI(e){this.h=new WebKitMediaKeys(e),this.g=new re}function rI(e,t){if(e.g.Qa(),!t)return Promise.resolve();e.g.D(t,"webkitneedkey",tI);try{return Ll(t,HTMLMediaElement.HAVE_METADATA,e.g,function(){t.webkitSetMediaKeys(e.h)}),Promise.resolve()}catch(n){return Promise.reject(n)}}function sI(e){ns.call(this),this.i=null,this.l=e,this.g=this.h=null,this.j=new re,this.sessionId="",this.expiration=NaN,this.closed=new Kr,this.keyStatuses=new oI}function aI(e,t){var n=e.keyStatuses;n.size=void 0==t?0:1,n.g=t,t=new Zr("keystatuseschange"),e.dispatchEvent(t)}function oI(){this.size=0,this.g=void 0}mx(kx,-1),gx.MediaSource=Bx,Bx.install=jx,mx(jx),gx.Orientation=Wx,Wx.install=qx,b(Xx,ns),Xx.prototype.lock=function(e){function t(e){return screen.lockOrientation?screen.lockOrientation(e):screen.mozLockOrientation?screen.mozLockOrientation(e):!!screen.msLockOrientation&&screen.msLockOrientation(e)}var n=!1;switch(e){case"natural":n=t("default");break;case"any":n=!0,this.unlock();break;default:n=t(e)}return n?Promise.resolve():(e=Error("screen.orientation.lock() is not available on this device"),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(e))},Xx.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},mx(qx),gx.PatchedMediaKeysApple=Qx,Qx.uninstall=function(){e.shakaMediaKeysPolyfill==uI&&Mx&&(Mx=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",Px),HTMLMediaElement.prototype.setMediaKeys=_x,e.MediaKeys=Ox,e.MediaKeySystemAccess=Nx,navigator.requestMediaKeySystemAccess=Ux,Px=Ux=_x=Nx=Ox=null,e.shakaMediaKeysPolyfill="",Ir.clear(),$r.clear())},Qx.install=Jx,nI.prototype.createMediaKeys=function(){var e=new iI(this.keySystem);return Promise.resolve(e)},nI.prototype.getConfiguration=function(){return this.g},iI.prototype.createSession=function(e){if(e=e||"temporary","temporary"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");return new sI(this.h,e)},iI.prototype.setServerCertificate=function(){return Promise.resolve(!1)},iI.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},b(sI,ns),i=sI.prototype,i.generateRequest=function(e,t){var n=this;this.h=new Kr;try{var i=this.l.createSession("video/mp4",Be(t));this.i=i,this.sessionId=i.sessionId||"",this.j.D(this.i,"webkitkeymessage",function(e){n.h&&(n.h.resolve(),n.h=null),e=(new Map).set("messageType",void 0==n.keyStatuses.Ac()?"license-request":"license-renewal").set("message",Fe(e.message)),e=new Zr("message",e),n.dispatchEvent(e)}),this.j.D(i,"webkitkeyadded",function(){n.g&&(aI(n,"usable"),n.g.resolve(),n.g=null)}),this.j.D(i,"webkitkeyerror",function(){var e=Error("EME PatchedMediaKeysApple key error");if(e.errorCode=n.i.error,null!=n.h)n.h.reject(e),n.h=null;else if(null!=n.g)n.g.reject(e),n.g=null;else switch(n.i.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:aI(n,"output-not-allowed");break;default:aI(n,"internal-error")}}),aI(this,"status-pending")}catch(r){this.h.reject(r)}return this.h},i.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},i.update=function(e){this.g=new Kr;try{this.i.update(Be(e))}catch(t){this.g.reject(t)}return this.g},i.close=function(){try{this.i.close(),this.closed.resolve(),this.j.Qa()}catch(aR){this.closed.reject(aR)}return this.closed},i.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},i=oI.prototype,i.Ac=function(){return this.g},i.forEach=function(e){this.g&&e(this.g,jr.value())},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=jr.value();return!(!this.g||!Ue(e,t))},i.entries=function(){},i.keys=function(){},i.values=function(){};var uI="apple";function lI(){}function cI(){if(e.MediaKeys){var t=ce();MediaKeys.prototype.setServerCertificate&&t.ge()||(MediaKeys.prototype.setServerCertificate=dI)}}function dI(){return Promise.resolve(!1)}function hI(){}function fI(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)II="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=gI,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=mI,e.MediaKeys=yI,e.MediaKeySystemAccess=vI,e.shakaMediaKeysPolyfill=kI}}function pI(e){var t=II;return t?t+e.charAt(0).toUpperCase()+e.slice(1):e}function gI(e,t){try{var n=new vI(e,t);return Promise.resolve(n)}catch(i){return Promise.reject(i)}}function mI(e){var t=this.mediaKeys;return t&&t!=e&&bI(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&bI(e,this),Promise.resolve()}function vI(e,t){this.g=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(this.g="webkit-org.w3.clearkey",n=!1);var i=!1,r=document.getElementsByTagName("video");r=r.length?r[0]:document.createElement("video"),t=d(t);for(var s=t.next();!s.done;s=t.next()){s=s.value;var a={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:s.initDataTypes,sessionTypes:["temporary"],label:s.label},o=!1;if(s.audioCapabilities)for(var u=d(s.audioCapabilities),l=u.next();!l.done;l=u.next())l=l.value,l.contentType&&(o=!0,r.canPlayType(l.contentType.split(";")[0],this.g)&&(a.audioCapabilities.push(l),i=!0));if(s.videoCapabilities)for(u=d(s.videoCapabilities),l=u.next();!l.done;l=u.next())l=l.value,l.contentType&&(o=!0,r.canPlayType(l.contentType,this.g)&&(a.videoCapabilities.push(l),i=!0));if(o||(i=r.canPlayType("video/mp4",this.g)||r.canPlayType("video/webm",this.g)),"required"==s.persistentState&&(n?(a.persistentState="required",a.sessionTypes=["persistent-license"]):i=!1),i)return void(this.h=a)}throw n="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(n="None of the requested configurations were supported."),e=Error(n),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function yI(e){this.l=e,this.h=null,this.g=new re,this.i=[],this.j=new Map}function bI(e,t){e.h=t,e.g.Qa();var n=II;t&&(e.g.D(t,n+"needkey",function(t){var n=new CustomEvent("encrypted");n.initDataType="cenc",n.initData=Fe(t.initData),e.h.dispatchEvent(n)}),e.g.D(t,n+"keymessage",function(t){var n=TI(e,t.sessionId);n&&(t=(new Map).set("messageType",void 0==n.keyStatuses.Ac()?"licenserequest":"licenserenewal").set("message",t.message),t=new Zr("message",t),n.h&&(n.h.resolve(),n.h=null),n.dispatchEvent(t))}),e.g.D(t,n+"keyadded",function(t){(t=TI(e,t.sessionId))&&t.ready()}),e.g.D(t,n+"keyerror",function(t){var n=TI(e,t.sessionId);if(n){var i=Error("EME v0.1b key error"),r=t.errorCode;r.systemCode=t.systemCode,i.errorCode=r,!t.sessionId&&n.h?(45==t.systemCode&&(i.message="Unsupported session type."),n.h.reject(i),n.h=null):t.sessionId&&n.g?(n.g.reject(i),n.g=null):(i=t.systemCode,t.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?AI(n,"output-restricted"):AI(n,1==i?"expired":"internal-error"))}}))}function TI(e,t){var n=e.j.get(t);return n||((n=e.i.shift())?(n.sessionId=t,e.j.set(t,n),n):null)}function SI(e,t,n){ns.call(this),this.j=e,this.m=!1,this.g=this.h=null,this.i=t,this.l=n,this.sessionId="",this.expiration=NaN,this.closed=new Kr,this.keyStatuses=new xI}function EI(e,t,n){if(e.m)return Promise.reject(Error("The session is already initialized."));e.m=!0;try{if("persistent-license"==e.l)if(n)var i=Be(ze("LOAD_SESSION|"+n));else{var r=ze("PERSISTENT|");i=at(r,t)}else i=Be(t)}catch(a){return Promise.reject(a)}e.h=new Kr;var s=pI("generateKeyRequest");try{e.j[s](e.i,i)}catch(a){if("InvalidStateError"!=a.name)return e.h=null,Promise.reject(a);new _i(function(){try{e.j[s](e.i,i)}catch(t){e.h.reject(t),e.h=null}}).ha(.01)}return e.h}function wI(e,t,n){if(e.g)e.g.then(function(){return wI(e,t,n)}).catch(function(){return wI(e,t,n)});else{if(e.g=t,"webkit-org.w3.clearkey"==e.i){var i=We(n),r=JSON.parse(i);"oct"!=r.keys[0].kty&&(e.g.reject(Error("Response is not a valid JSON Web Key Set.")),e.g=null),i=it(r.keys[0].k),r=it(r.keys[0].kid)}else i=Be(n),r=null;var s=pI("addKey");try{e.j[s](e.i,i,r,e.sessionId)}catch(a){e.g.reject(a),e.g=null}}}function AI(e,t){var n=e.keyStatuses;n.size=void 0==t?0:1,n.g=t,t=new Zr("keystatuseschange"),e.dispatchEvent(t)}function xI(){this.size=0,this.g=void 0}mx(function(){e.HTMLVideoElement&&e.WebKitMediaKeys&&(navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||Jx())}),gx.PatchedMediaKeysCert=lI,lI.install=cI,mx(cI),gx.PatchedMediaKeysWebkit=hI,hI.install=fI,vI.prototype.createMediaKeys=function(){var e=new yI(this.g);return Promise.resolve(e)},vI.prototype.getConfiguration=function(){return this.h},yI.prototype.createSession=function(e){if(e=e||"temporary","temporary"!=e&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.h||document.createElement("video");return t.src||(t.src="about:blank"),e=new SI(t,this.l,e),this.i.push(e),e},yI.prototype.setServerCertificate=function(){return Promise.resolve(!1)},yI.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},b(SI,ns),i=SI.prototype,i.ready=function(){AI(this,"usable"),this.g&&this.g.resolve(),this.g=null},i.generateRequest=function(e,t){return EI(this,t,null)},i.load=function(e){return"persistent-license"==this.l?EI(this,null,e):Promise.reject(Error("Not a persistent session."))},i.update=function(e){var t=new Kr;return wI(this,t,e),t},i.close=function(){if("persistent-license"!=this.l){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=pI("cancelKeyRequest");try{this.j[e](this.i,this.sessionId)}catch(t){}}return this.closed.resolve(),this.closed},i.remove=function(){return"persistent-license"!=this.l?Promise.reject(Error("Not a persistent session.")):this.close()},i=xI.prototype,i.Ac=function(){return this.g},i.forEach=function(e){this.g&&e(this.g,jr.value())},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=jr.value();return!(!this.g||!Ue(e,t))},i.entries=function(){},i.keys=function(){},i.values=function(){};var II="",kI="webkit";function LI(){}function RI(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||!t.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=DI,Object.defineProperty(t,"disablePictureInPicture",{get:PI,set:_I,enumerable:!0,configurable:!0}),document.exitPictureInPicture=MI,document.addEventListener("webkitpresentationmodechanged",CI,!0))}}function CI(e){if(e=e.target,"picture-in-picture"==e.webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function DI(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function MI(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function PI(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function _I(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function OI(){}function NI(){e.crypto&&("randomUUID"in e.crypto||(e.crypto.randomUUID=UI))}function UI(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)}function FI(){}function BI(){var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:jI})}function jI(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0}function $I(){}function GI(){for(var e=d([Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array]),t=e.next();!t.done;t=e.next())t=t.value,t.prototype.indexOf||(t.prototype.indexOf=VI),t.prototype.lastIndexOf||(t.prototype.lastIndexOf=HI),t.prototype.includes||(t.prototype.includes=KI)}function VI(e,t){return Array.prototype.indexOf.call(this,e,t)}function HI(e,t){return Array.prototype.lastIndexOf.call(this,e,t)}function KI(e,t){return-1!==this.indexOf(e,t)}function WI(){}function qI(){if(e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch(function(){}),e}}}function YI(){}function zI(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in t||"number"===typeof Xo().webkitDroppedFrameCount)&&(t.getVideoPlaybackQuality=XI)}}function XI(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function QI(){}function JI(){if(!e.VTTCue&&e.TextTrackCue){var t=null,n=TextTrackCue.length;if(3==n)t=ZI;else if(6==n)t=ek;else{try{var i=!!ZI(1,2,"")}catch(r){i=!1}i&&(t=ZI)}t&&(e.VTTCue=function(e,n,i){return t(e,n,i)})}}function ZI(t,n,i){return new e.TextTrackCue(t,n,i)}function ek(t,n,i){return new e.TextTrackCue(t+"-"+n+"-"+i,t,n,i)}function tk(e){ns.call(this),this.h=e,this.l=null,this.g=[],this.i=-1,this.j=null,this.m=new re}function nk(){}mx(fI),gx.PiPWebkit=LI,LI.install=RI,mx(RI),gx.RandomUUID=OI,OI.install=NI,mx(NI),gx.Symbol=FI,FI.install=BI,mx(BI),gx.TypedArray=$I,$I.install=GI,mx(GI),gx.VideoPlayPromise=WI,WI.install=qI,mx(qI),gx.VideoPlaybackQuality=YI,YI.install=zI,mx(zI),gx.VTTCue=QI,QI.install=JI,mx(JI),b(tk,ns),i=tk.prototype,i.destroy=function(){var e=this;return U(function(t){if(1==t.g)return w(t,e.removeAllItems(),2);e.h=null,e.m&&(e.m.release(),e.m=null),ns.prototype.release.call(e),A(t)})},i.configure=function(e){this.l=e},i.getConfiguration=function(){return this.l},i.getCurrentItem=function(){return this.g.length&&0<=this.i&&this.i<this.g.length?this.g[this.i]:null},i.getCurrentItemIndex=function(){return this.i},i.getItems=function(){return this.g.slice()},i.insertItems=function(e){this.g.push.apply(this.g,h(e)),this.dispatchEvent(new Zr("itemsinserted"))},i.removeAllItems=function(){var e=this;return U(function(t){switch(t.g){case 1:if(e.m.Qa(),!(e.g.length&&0<=e.i)){t.u(2);break}return w(t,e.h.uc(),2);case 2:if(!e.j){t.u(4);break}if(e.j.uf.o){t.u(5);break}return w(t,e.j.uf.destroy(),5);case 5:e.j=null;case 4:e.g=[],e.i=-1,e.dispatchEvent(new Zr("itemsremoved")),A(t)}})},i.playItem=function(e){var t,n,i,r,s,a,o,u,l,c,h,f,p,g,m=this;return U(function(v){if(1==v.g){if(m.m.Qa(),!m.g.length||e>=m.g.length)throw new Ve(2,7,7007);return t=m.g[e],m.i!=e&&(m.i=e,m.dispatchEvent(new Zr("currentitemchanged"))),n=m.h.h,i=m.l?m.l.preloadNextUrlWindow:0,0<i&&(r=!1,m.m.D(n,"timeupdate",function(){var e,t,s,a;return U(function(o){switch(o.g){case 1:if(m.j||1>=m.g.length||r||m.h.V()||!n.duration)return o.return();if(e=m.h.Ra().end-n.currentTime,isNaN(e)){o.u(0);break}if(!(e<=i)){o.u(0);break}if(t=m.l&&m.l.repeatMode,s=null,m.i+1<m.g.length?s=m.g[m.i+1]:1==t&&(s=m.g[0]),!s){o.u(0);break}return r=!0,a=null,x(o,5),w(o,m.h.preload(s.manifestUri,s.startTime,s.mimeType,s.config),7);case 7:a=o.h,k(o,6);break;case 5:L(o),a=null;case 6:m.j={item:s,uf:a},r=!1,A(o)}})})),m.m.D(m.h,"complete",function(){var e=m.l&&m.l.repeatMode,t=!1;if(2==e)t=!0;else{var i=m.i+1;i<m.g.length?m.playItem(i):1==e&&(1==m.g.length?t=!0:m.playItem(0))}t&&(n.paused?(n.currentTime=m.h.Ra().start,n.play()):m.m.D(n,"paused",function(){n.currentTime=m.h.Ra().start,n.play()}))}),t.config&&(m.h.Ai(),m.h.configure(t.config)),s=t.manifestUri,m.j&&m.j.item==t&&m.j.uf&&(s=m.j.uf),w(v,m.h.load(s,t.startTime,t.mimeType),2)}if(m.j=null,t.extraText)for(a=d(t.extraText),o=a.next();!o.done;o=a.next())u=o.value,u.mime?m.h.Ed(u.uri,u.language,u.kind,u.mime,u.codecs):m.h.Ed(u.uri,u.language,u.kind);if(t.extraThumbnail)for(l=d(t.extraThumbnail),c=l.next();!c.done;c=l.next())h=c.value,m.h.Fe(h);if(t.extraChapter)for(f=d(t.extraChapter),p=f.next();!p.done;p=f.next())g=p.value,m.h.Ee(g.uri,g.language,g.mime);A(v)})},K("shaka.queue.QueueManager",tk),tk.prototype.playItem=tk.prototype.playItem,tk.prototype.removeAllItems=tk.prototype.removeAllItems,tk.prototype.insertItems=tk.prototype.insertItems,tk.prototype.getItems=tk.prototype.getItems,tk.prototype.getCurrentItemIndex=tk.prototype.getCurrentItemIndex,tk.prototype.getCurrentItem=tk.prototype.getCurrentItem,tk.prototype.getConfiguration=tk.prototype.getConfiguration,tk.prototype.configure=tk.prototype.configure,tk.prototype.destroy=tk.prototype.destroy,lg=function(e){return new tk(e)},nk.prototype.parseInit=function(){},nk.prototype.setSequenceMode=function(){},nk.prototype.setManifestType=function(){},nk.prototype.parseMedia=function(e,t){var n=null,i=[];e=We(e).split(/\r?\n/),e=d(e);for(var r=e.next();!r.done;r=e.next())if((r=r.value)&&!/^\s+$/.test(r)&&(r=ik.exec(r))){var s=rk.exec(r[1]);s=60*parseInt(s[1],10)+parseFloat(s[2].replace(",",".")),r=new Cn(s,t.segmentEnd?t.segmentEnd:s+2,r[2]),n&&(n.endTime=s,i.push(n)),n=r}return n&&i.push(n),i},K("shaka.text.LrcTextParser",nk),nk.prototype.parseMedia=nk.prototype.parseMedia,nk.prototype.setManifestType=nk.prototype.setManifestType,nk.prototype.setSequenceMode=nk.prototype.setSequenceMode,nk.prototype.parseInit=nk.prototype.parseInit;var ik=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,rk=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;function sk(){}function ak(e,t,n,i,r,s,a,o,u,l,c,h,f){var p=l;if(en(e)){if(!c)return null;var g={tagName:"span",children:[rn(e)],attributes:{},parent:null}}else g=e;for(var m=null,v=d(Nk),y=v.next();!y.done&&!(m=gk(g,"backgroundImage",i,"#",y.value)[0]);y=v.next());v=null,y=hn(g,Nk,"backgroundImage");var b=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/;if(y&&b.test(y)){if(v=parseInt(y.split(":").pop(),10)-1,v>=f.length)return null;v=f[v]}else h&&y&&!y.startsWith("#")&&(b=new Te(h),y=new Te(y),(y=b.resolve(y).toString())&&(v=y));if(("p"==e.tagName||m||v)&&(c=!0),e=c,y="default"==(g.attributes["xml:space"]||(o?"default":"preserve")),b=g.children.every(en),o=[],!b)for(var T=d(g.children),S=T.next();!S.done;S=T.next())(S=ak(S.value,t,n,i,r,s,a,y,u,g,c,h,f))&&o.push(S);if(i=null!=l,h=rn(g),h=g.children.length&&h&&/\S/.test(h),T=g.attributes.begin||g.attributes.end||g.attributes.dur,!(T||h||"br"==g.tagName||0!=o.length||i&&!y))return null;for(f=vk(g,n),h=f.start,f=f.end;p&&p.tagName&&"tt"!=p.tagName;)f=mk(p,n,h,f),h=f.start,f=f.end,p=p.parent;if(null==h&&(h=0),h+=t.periodStart,f=null==f?1/0:f+t.periodStart,h=Math.max(h,t.segmentStart),f=Math.min(f,t.segmentEnd),!T&&0<o.length)for(h=1/0,f=0,t=d(o),n=t.next();!n.done;n=t.next())n=n.value,h=Math.min(h,n.startTime),f=Math.max(f,n.endTime);if("br"==g.tagName)return r=new Cn(h,f,""),r.lineBreak=!0,r;if(t="",b&&(t=Je(rn(g)||""),y&&(t=t.replace(/\s+/g," "))),t=new Cn(h,f,t),t.nestedCues=o,c||(t.isContainer=!0),u&&(t.cellResolution=u),u=gk(g,"region",s,"")[0],g.attributes.region&&u&&u.attributes["xml:id"]){var E=u.attributes["xml:id"];t.region=a.filter(function(e){return e.id==E})[0]}return a=u,l&&i&&!g.attributes.region&&!g.attributes.style&&(a=gk(l,"region",s,"")[0]),lk(t,g,a,m,v,r,e,0==o.length),t}function ok(e,t,n){var i=new Pt,r=e.attributes["xml:id"];if(!r)return null;i.id=r,r=null,n&&(r=Ek.exec(n)||xk.exec(n)),n=r?Number(r[1]):null,r=r?Number(r[2]):null;var s,a=hk(e,t,"extent");if(a){var o=(s=Ek.exec(a))||xk.exec(a);null!=o&&(i.width=Number(o[1]),i.height=Number(o[2]),s||(null!=n&&(i.width=100*i.width/n),null!=r&&(i.height=100*i.height/r)),i.widthUnits=s||null!=n?_t:0,i.heightUnits=s||null!=r?_t:0)}return(e=hk(e,t,"origin"))&&(o=(s=Ek.exec(e))||xk.exec(e),null!=o&&(i.viewportAnchorX=Number(o[1]),i.viewportAnchorY=Number(o[2]),s?a||(i.width=100-i.viewportAnchorX,i.widthUnits=_t,i.height=100-i.viewportAnchorY,i.heightUnits=_t):(null!=r&&(i.viewportAnchorY=100*i.viewportAnchorY/r),null!=n&&(i.viewportAnchorX=100*i.viewportAnchorX/n)),i.viewportAnchorUnits=s||null!=n?_t:0)),i}function uk(e){var t=e.match(/rgba\(([^)]+)\)/);return t&&(t=t[1].split(","),4==t.length)?(t[3]=String(Number(t[3])/255),"rgba("+t.join(",")+")"):e}function lk(e,t,n,i,r,s,a,o){if(a=a||o,"rtl"==dk(t,n,s,"direction",a)&&(e.direction="rtl"),o=dk(t,n,s,"writingMode",a),"tb"==o||"tblr"==o?e.writingMode="vertical-lr":"tbrl"==o?e.writingMode="vertical-rl":"rltb"==o||"rl"==o?e.direction="rtl":o&&(e.direction=Vn),(o=dk(t,n,s,"textAlign",!0))?(e.positionAlign=Pk.get(o),e.lineAlign=Mk.get(o),e.textAlign=jn[o.toUpperCase()]):e.textAlign=Bn,(o=dk(t,n,s,"displayAlign",!0))&&(e.displayAlign=Gn[o.toUpperCase()]),(o=dk(t,n,s,"color",a))&&(e.color=uk(o)),(o=dk(t,n,s,"backgroundColor",a))&&(e.backgroundColor=uk(o)),(o=dk(t,n,s,"border",a))&&(e.border=o),o=dk(t,n,s,"fontFamily",a))switch(o){case"monospaceSerif":e.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":e.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":e.fontFamily="sans-serif";break;case"monospaceSansSerif":e.fontFamily="Consolas,monospace";break;case"proportionalSerif":e.fontFamily="serif";break;default:e.fontFamily=o.split(",").filter(function(e){return"default"!=e}).join(",")}switch((o=dk(t,n,s,"fontWeight",a))&&"bold"==o&&(e.fontWeight=Qn),o=dk(t,n,s,"wrapOption",a),e.wrapLine=!o||"noWrap"!=o,(o=dk(t,n,s,"lineHeight",a))&&o.match(Ak)&&(e.lineHeight=o),(o=dk(t,n,s,"fontSize",a))&&(o.match(Ak)||o.match(wk))&&(e.fontSize=o),(o=dk(t,n,s,"fontStyle",a))&&(e.fontStyle=ei[o.toUpperCase()]),i?(r=i.attributes.imageType||i.attributes.imagetype,o=i.attributes.encoding,i=rn(i).trim(),"PNG"==r&&"Base64"==o&&i&&(e.backgroundImage="data:image/png;base64,"+i)):r&&(e.backgroundImage=r),(i=dk(t,n,s,"textOutline",a))&&(i=i.split(" "),i[0].match(Ak)?e.textStrokeColor=e.color:(e.textStrokeColor=uk(i[0]),i.shift()),i[0]&&i[0].match(Ak)?e.textStrokeWidth=i[0]:e.textStrokeColor=""),(i=dk(t,n,s,"letterSpacing",a))&&i.match(Ak)&&(e.letterSpacing=i),(i=dk(t,n,s,"linePadding",a))&&i.match(Ak)&&(e.linePadding=i),(i=dk(t,n,s,"opacity",a))&&(e.opacity=parseFloat(i)),(i=hk(n,s,"textDecoration"))&&ck(e,i),(i=fk(t,s,"textDecoration"))&&ck(e,i),(i=dk(t,n,s,"textCombine",a))&&(e.textCombineUpright=i),dk(t,n,s,"ruby",a)){case"container":e.rubyTag="ruby";break;case"text":e.rubyTag="rt"}}function ck(e,t){t=d(t.split(" "));for(var n=t.next();!n.done;n=t.next())switch(n.value){case"underline":e.textDecoration.includes(ti)||e.textDecoration.push(ti);break;case"noUnderline":e.textDecoration.includes(ti)&&Ut(e.textDecoration,ti);break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&Ut(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&Ut(e.textDecoration,"overline")}}function dk(e,t,n,i,r){return r=void 0===r||r,(e=fk(e,n,i))?e:r?hk(t,n,i):null}function hk(e,t,n){if(!e)return null;var i=hn(e,Ok,n);return i||pk(e,t,n)}function fk(e,t,n){var i=hn(e,Ok,n);return i||pk(e,t,n)}function pk(e,t,n){e=gk(e,"style",t,"");for(var i=null,r=0;r<e.length;r++){var s=cn(e[r],"urn:ebu:tt:style",n);s||(s=hn(e[r],Ok,n)),s||(s=fk(e[r],t,n)),s&&(i=s)}return i}function gk(e,t,n,i,r){var s=[];if(!e||1>n.length)return s;var a=e;for(e=null;!e&&!(e=r?cn(a,r,t):a.attributes[t])&&(a=a.parent,a););if(t=e)for(t=d(t.split(" ")),r=t.next();!r.done;r=t.next())for(r=r.value,e=d(n),a=e.next();!a.done;a=e.next())if(a=a.value,i+a.attributes["xml:id"]==r){s.push(a);break}return s}function mk(e,t,n,i){return e=vk(e,t),null==n?n=e.start:null!=e.start&&(n+=e.start),null==i?i=e.end:null!=e.start&&(i+=e.start),{start:n,end:i}}function vk(e,t){var n=yk(e.attributes.begin,t),i=yk(e.attributes.end,t);return e=yk(e.attributes.dur,t),null==i&&null!=e&&(i=n+e),{start:n,end:i}}function yk(e,t){var n=null;if(Ik.test(e)){e=Ik.exec(e),n=Number(e[1]);var i=Number(e[2]),r=Number(e[3]),s=Number(e[4]);s+=(Number(e[5])||0)/t.h,r+=s/t.frameRate,n=r+60*i+3600*n}else if(kk.test(e))n=bk(kk,e);else if(Lk.test(e))n=bk(Lk,e);else if(Rk.test(e))e=Rk.exec(e),n=Number(e[1])/t.frameRate;else if(Ck.test(e))e=Ck.exec(e),n=Number(e[1])/t.g;else if(Dk.test(e))n=bk(Dk,e);else if(e)throw new Ve(2,2,2001,"Could not parse cue time range in TTML");return n}function bk(e,t){return e=e.exec(t),null==e||""==e[0]?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+60*(Number(e[2])||0)+3600*(Number(e[1])||0)}function Tk(e){return e&&(e=/^(\d+) (\d+)$/.exec(e))?{Kc:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}function Sk(e,t,n,i){this.frameRate=Number(e)||30,this.h=Number(t)||1,this.g=Number(i),0==this.g&&(this.g=e?this.frameRate*this.h:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}Ai("application/x-subtitle-lrc",function(){return new nk}),sk.prototype.parseInit=function(){},sk.prototype.setSequenceMode=function(){},sk.prototype.setManifestType=function(){},sk.prototype.parseMedia=function(e,t,n,i){var r=We(e);if(e=[],""==r)return e;var s=Qt(r,"tt",!0);if(!s)throw new Ve(2,2,2005,"Failed to parse TTML.");if(r=an(s,"body")[0],!r)return[];var a=hn(s,_k,"frameRate"),o=hn(s,_k,"subFrameRate"),u=hn(s,_k,"frameRateMultiplier"),l=hn(s,_k,"tickRate"),c=hn(s,_k,"cellResolution"),h=s.attributes["xml:space"]||"default",f=hn(s,Ok,"extent");if("default"!=h&&"preserve"!=h)throw new Ve(2,2,2005,"Invalid xml:space value: "+h);h="default"==h,a=new Sk(a,o,u,l),c=Tk(c),o=an(s,"metadata")[0],o=(o?o.children:[]).filter(function(e){return"\n"!=e}),u=an(s,"style"),s=an(s,"region"),l=[];for(var p=d(s),g=p.next();!g.done;g=p.next())(g=ok(g.value,u,f))&&l.push(g);if(nn(r,"p").length)throw new Ve(2,2,2001,"<p> can only be inside <div> in TTML");for(f=d(nn(r,"div")),p=f.next();!p.done;p=f.next())if(nn(p.value,"span").length)throw new Ve(2,2,2001,"<span> can only be inside <p> in TTML");return(t=ak(r,t,a,o,u,s,l,h,c,null,!1,n,i))&&(t.backgroundColor||(t.backgroundColor="transparent"),e.push(t)),e},K("shaka.text.TtmlTextParser",sk),sk.prototype.parseMedia=sk.prototype.parseMedia,sk.prototype.setManifestType=sk.prototype.setManifestType,sk.prototype.setSequenceMode=sk.prototype.setSequenceMode,sk.prototype.parseInit=sk.prototype.parseInit;var Ek=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,wk=/^(\d{1,4}(?:\.\d+)?|100)%$/,Ak=/^(\d+px|\d+em|\d*\.?\d+c)$/,xk=/^(\d+)px (\d+)px$/,Ik=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,kk=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Lk=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d+)$/,Rk=/^(\d*(?:\.\d*)?)f$/,Ck=/^(\d*(?:\.\d*)?)t$/,Dk=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),Mk=(new Map).set("left",Wn).set("center","center").set("right","end").set("start",Wn).set("end","end"),Pk=(new Map).set("left","line-left").set("center","center").set("right","line-right"),_k=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],Ok=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],Nk=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];function Uk(){this.g=new sk}function Fk(){this.g="UNKNOWN"}function Bk(e,t,n){var i;(i=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=i[1],e.textAlign="middle"==t?Bn:jn[t.toUpperCase()]):(i=/^vertical:(lr|rl)$/.exec(t))?e.writingMode="lr"==i[1]?"vertical-lr":"vertical-rl":(i=/^size:([\d.]+)%$/.exec(t))?e.size=Number(i[1]):(i=/^position:([\d.]+)%(?:,(line-left|line-right|middle|center|start|end|auto))?$/.exec(t))?(e.position=Number(i[1]),i[2]&&(t=i[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center"==t||"middle"==t?"center":Fn)):(i=/^region:(.*)$/.exec(t))?(t=jk(n,i[1]))&&(e.region=t):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=qn[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=Kn,e.line=Number(n[1]),n[2]&&(e.lineAlign=qn[n[2].toUpperCase()]))}function jk(e,t){return e=e.filter(function(e){return e.id==t}),e.length?e[0]:null}function $k(){this.g=null}function Gk(e,t,n){var i,r,s;return(new ks).box("payl",Ms(function(e){i=We(e)})).box("iden",Ms(function(e){r=We(e)})).box("sttg",Ms(function(e){s=We(e)})).parse(e),i?Vk(i,r,s,t,n):null}function Vk(e,t,n,i,r){if(e=new Cn(i,r,e),Pn(e),t&&(e.id=t),n)for(t=new jt(n),n=Vt(t);n;)Bk(e,n,[]),$t(t),n=Vt(t);return e}function Hk(){}function Kk(){this.g=new Fk}function Wk(e){var t="WEBVTT\n\n";if(""==e)return t;e=e.replace(/\r+/g,""),e=e.trim(),e=d(e.split("\n\n"));for(var n=e.next();!n.done;n=e.next())n=n.value.split(/\n/),n[0].match(/\d+/)&&n.shift(),n[0]=n[0].replace(/,/g,"."),t+=n.join("\n").replace(/{b}/g,"<b>").replace(/{\/b}/g,"</b>").replace(/{i}/g,"<i>").replace(/{\/i}/g,"</i>").replace(/{u}/g,"<u>").replace(/{\/u}/g,"</u>")+"\n\n";return t}function qk(){}function Yk(e,t){var n=t.Fontname;if(n&&(e.fontFamily=n),(n=t.Fontsize)&&(e.fontSize=n+"px"),(n=t.PrimaryColour)&&(n=zk(n))&&(e.color=n),(n=t.BackColour)&&(n=zk(n))&&(e.backgroundColor=n),t.Bold&&(e.fontWeight=Qn),t.Italic&&(e.fontStyle=Zn),t.Underline&&e.textDecoration.push(ti),(n=t.Spacing)&&(e.letterSpacing=n+"px"),n=t.Alignment)switch(parseInt(n,10)){case 1:e.displayAlign=$n,e.textAlign="start";break;case 2:e.displayAlign=$n,e.textAlign=Bn;break;case 3:e.displayAlign=$n,e.textAlign="end";break;case 5:e.displayAlign="before",e.textAlign="start";break;case 6:e.displayAlign="before",e.textAlign=Bn;break;case 7:e.displayAlign="before",e.textAlign="end";break;case 9:e.displayAlign="center",e.textAlign="start";break;case 10:e.displayAlign="center",e.textAlign=Bn;break;case 11:e.displayAlign="center",e.textAlign="end"}(t=t.AlphaLevel)&&(e.opacity=parseFloat(t))}function zk(e){return e=parseInt(e.replace("&H",""),16),0<=e?"rgba("+(255&e)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null}function Xk(e){return e=eL.exec(e),3600*(e[1]?parseInt(e[1].replace(":",""),10):0)+60*parseInt(e[2],10)+parseFloat(e[3])}Ai("application/ttml+xml",function(){return new sk}),Uk.prototype.parseInit=function(e){var t=!1;if((new ks).box("moov",Ls).box("trak",Ls).box("mdia",Ls).box("minf",Ls).box("stbl",Ls).R("stsd",Rs).box("stpp",function(e){t=!0,e.parser.stop()}).parse(e),!t)throw new Ve(2,2,2007)},Uk.prototype.setSequenceMode=function(){},Uk.prototype.setManifestType=function(){},Uk.prototype.parseMedia=function(e,t,n){var i=[],r=null,s=[],a=new Map,o=[];if((new ks).box("moof",Ls).box("traf",Ls).R("tfhd",function(e){r=Ha(e.reader,e.flags).Kd}).R("trun",function(e){e=qa(e.reader,e.version,e.flags),e=d(e.ah);for(var t=e.next();!t.done;t=e.next())o.push(t.value.sampleSize||r||0)}).R("subs",function(e){for(var t=e.reader,n=t.T(),i=-1,r=0;r<n;r++){var s=t.T();i+=s,s=t.Aa();for(var o=[],u=0;u<s;u++)1==e.version?o.push(t.T()):o.push(t.Aa()),t.X(),t.X(),t.T();a.set(i,o)}}).box("mdat",Ms(function(e){s.push(e)})).parse(e,!1),0==s.length)throw new Ve(2,2,2007);for(var u=at.apply(et,h(s)),l=0,c=0;c<o.length;c++){var f=Be(u,l,o[c]);l+=o[c];var p=a.get(c);if(p&&p.length){f=Be(f,0,p[0]);for(var g=[],m=p[0],v=1;v<p.length;v++){var y=Be(e,m,p[v]);y=tt(y),g.push("data:image/png;base64,"+y),m+=p[v]}i=i.concat(this.g.parseMedia(f,t,n,g))}else i=i.concat(this.g.parseMedia(f,t,n,[]))}return i},K("shaka.text.Mp4TtmlParser",Uk),Uk.prototype.parseMedia=Uk.prototype.parseMedia,Uk.prototype.setManifestType=Uk.prototype.setManifestType,Uk.prototype.setSequenceMode=Uk.prototype.setSequenceMode,Uk.prototype.parseInit=Uk.prototype.parseInit,Ai('application/mp4; codecs="stpp"',function(){return new Uk}),Ai('application/mp4; codecs="stpp.ttml"',function(){return new Uk}),Ai('application/mp4; codecs="stpp.ttml.im1i"',function(){return new Uk}),Ai('application/mp4; codecs="stpp.ttml.im1t"',function(){return new Uk}),Ai('application/mp4; codecs="stpp.ttml.im2i"',function(){return new Uk}),Ai('application/mp4; codecs="stpp.ttml.im2t"',function(){return new Uk}),Ai('application/mp4; codecs="stpp.ttml.etd1"',function(){return new Uk}),Ai('application/mp4; codecs="stpp.ttml.etd1|im1t"',function(){return new Uk}),Ai('application/mp4; codecs="stpp.ttml.im1t|etd1"',function(){return new Uk}),Ai('application/mp4; codecs="stpp.TTML.im1t"',function(){return new Uk}),Fk.prototype.parseInit=function(){},Fk.prototype.setSequenceMode=function(){},Fk.prototype.setManifestType=function(e){this.g=e},Fk.prototype.parseMedia=function(e,t){e=We(e),e=e.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");var n=e.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new Ve(2,2,2e3);if(e=t.vttOffset,"HLS"==this.g)if(n[0].includes("X-TIMESTAMP-MAP")){var i=n[0];if(e=i.match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),i=i.match(/MPEGTS:(\d+)/m),!e||!i)throw new Ve(2,2,2e3);if(e=Kt(e[1]),null==e)throw new Ve(2,2,2e3);i=Number(i[1]);for(var r=t.segmentStart-t.periodStart;95443.7176888889<=r;)r-=95443.7176888889,i+=8589934592;e=t.periodStart+i/9e4-e}else t.periodStart&&t.vttOffset==t.periodStart&&(e=0);for(t=[],i=d(n[0].split("\n")),r=i.next();!r.done;r=i.next())if(r=r.value,/^Region:/.test(r)){r=new jt(r);var s=new Pt;Vt(r),$t(r);for(var a=Vt(r);a;){var o=s,u=a;(a=/^id=(.*)$/.exec(u))?o.id=a[1]:(a=/^width=(\d{1,2}|100)%$/.exec(u))?o.width=Number(a[1]):(a=/^lines=(\d+)$/.exec(u))?(o.height=Number(a[1]),o.heightUnits=2):(a=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(u))?(o.regionAnchorX=Number(a[1]),o.regionAnchorY=Number(a[2])):(a=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(u))?(o.viewportAnchorX=Number(a[1]),o.viewportAnchorY=Number(a[2])):/^scroll=up$/.exec(u)&&(o.scroll="up"),$t(r),a=Vt(r)}t.push(s)}for(i=new Map,_n(i),r=[],n=d(n.slice(1)),s=n.next();!s.done;s=n.next()){if(s=s.value.split("\n"),(1!=s.length||s[0])&&!/^NOTE($|[ \t])/.test(s[0])&&"STYLE"==s[0]){for(o=[],a=-1,u=1;u<s.length;u++)s[u].includes("::cue")&&(o.push([]),a=o.length-1),-1!=a&&(o[a].push(s[u]),s[u].includes("}")&&(a=-1));for(o=d(o),a=o.next();!a.done;a=o.next()){var l=a.value;a="global",(u=l[0].match(/\((.*)\)/))&&(a=u.pop()),u=l.slice(1,-1),l[0].includes("}")&&(l=/\{(.*?)\}/.exec(l[0]))&&(u=l[1].split(";")),(l=i.get(a))||(l=new Cn(0,0,""));for(var c=!1,h=0;h<u.length;h++){var f=/^\s*([^:]+):\s*(.*)/.exec(u[h]);if(f){var p=f[2].trim().replace(";","");switch(f[1].trim()){case"background-color":case"background":c=!0,l.backgroundColor=p;break;case"color":c=!0,l.color=p;break;case"font-family":c=!0,l.fontFamily=p;break;case"font-size":c=!0,l.fontSize=p;break;case"font-weight":(700<=parseInt(p,10)||"bold"==p)&&(c=!0,l.fontWeight=Qn);break;case"font-style":switch(p){case"normal":c=!0,l.fontStyle=Jn;break;case"italic":c=!0,l.fontStyle=Zn;break;case"oblique":c=!0,l.fontStyle="oblique"}break;case"opacity":c=!0,l.opacity=parseFloat(p);break;case"text-combine-upright":c=!0,l.textCombineUpright=p;break;case"text-shadow":c=!0,l.textShadow=p;break;case"white-space":c=!0,l.wrapLine="noWrap"!=p}}}c&&i.set(a,l)}}if(l=s,c=e,1==l.length&&!l[0]||/^NOTE($|[ \t])/.test(l[0])||"STYLE"==l[0]||"REGION"==l[0])s=null;else if(s=null,l[0].includes("--\x3e")||(s=l[0],l.splice(0,1)),o=new jt(l[0]),a=Ht(o),h=Gt(o,/[ \t]+--\x3e[ \t]+/g),u=Ht(o),null==a||null==h||null==u)Q("Failed to parse VTT time code. Cue skipped:",s,l),s=null;else{for(a+=c,u+=c,c=l.slice(1).join("\n").trim(),i.has("global")?(l=i.get("global").clone(),l.startTime=a,l.endTime=u,l.payload=c):l=new Cn(a,u,c),$t(o),a=Vt(o);a;)Bk(l,a,t),$t(o),a=Vt(o);Pn(l,i),null!=s&&(l.id=s),s=l}s&&r.push(s)}return r},K("shaka.text.VttTextParser",Fk),Fk.prototype.parseMedia=Fk.prototype.parseMedia,Fk.prototype.setManifestType=Fk.prototype.setManifestType,Fk.prototype.setSequenceMode=Fk.prototype.setSequenceMode,Fk.prototype.parseInit=Fk.prototype.parseInit,Ai("text/vtt",function(){return new Fk}),Ai('text/vtt; codecs="vtt"',function(){return new Fk}),Ai('text/vtt; codecs="wvtt"',function(){return new Fk}),$k.prototype.parseInit=function(e){var t=this,n=!1;if((new ks).box("moov",Ls).box("trak",Ls).box("mdia",Ls).R("mdhd",function(e){e=Wa(e.reader,e.version),t.g=e.timescale}).box("minf",Ls).box("stbl",Ls).R("stsd",Rs).box("wvtt",function(){n=!0}).parse(e),!this.g)throw new Ve(2,2,2008);if(!n)throw new Ve(2,2,2008)},$k.prototype.setSequenceMode=function(){},$k.prototype.setManifestType=function(){},$k.prototype.parseMedia=function(e,t){if(!e.length)return[];if(!this.g)throw new Ve(2,2,2008);var n,i=0,r=[],s=[],a=!1,o=!1,u=!1,l=null;if((new ks).box("moof",Ls).box("traf",Ls).R("tfdt",function(e){a=!0,i=Ka(e.reader,e.version).baseMediaDecodeTime}).R("tfhd",function(e){l=Ha(e.reader,e.flags).Jd}).R("trun",function(e){o=!0,r=qa(e.reader,e.version,e.flags).ah}).box("mdat",Ms(function(e){u=!0,n=e})).parse(e,!1),!u&&!a&&!o)throw new Ve(2,2,2008);e=i;for(var c=new As(n,0),h=d(r),f=h.next();!f.done;f=h.next()){f=f.value;var p=f.bh||l,g=f.yf?i+f.yf:e;e=g+(p||0);var m=0;do{var v=c.T();m+=v;var y=c.T(),b=null;"vttc"==_s(y)?8<v&&(b=c.Sb(v-8)):c.skip(v-8),p&&b&&(v=Gk(b,t.periodStart+g/this.g,t.periodStart+e/this.g),s.push(v))}while(f.sampleSize&&m<f.sampleSize)}return s.filter(Ui)},K("shaka.text.Mp4VttParser",$k),$k.prototype.parseMedia=$k.prototype.parseMedia,$k.prototype.setManifestType=$k.prototype.setManifestType,$k.prototype.setSequenceMode=$k.prototype.setSequenceMode,$k.prototype.parseInit=$k.prototype.parseInit,Ai('application/mp4; codecs="wvtt"',function(){return new $k}),Hk.prototype.parseInit=function(){},Hk.prototype.setSequenceMode=function(){},Hk.prototype.setManifestType=function(){},Hk.prototype.parseMedia=function(e){var t=We(e).replace(/\r+/g,"");if(t=t.trim(),e=[],""==t)return e;t=d(t.split("\n\n"));for(var n=t.next();!n.done;n=t.next()){n=n.value.split("\n");var i=new jt(n[0]),r=Ht(i),s=Gt(i,/,/g);if(i=Ht(i),null==r||null==s||null==i)throw new Ve(2,2,2001,"Could not parse cue time range in SubViewer");e.push(new Cn(r,i,n.slice(1).join("\n").trim()))}return e},K("shaka.text.SbvTextParser",Hk),Hk.prototype.parseMedia=Hk.prototype.parseMedia,Hk.prototype.setManifestType=Hk.prototype.setManifestType,Hk.prototype.setSequenceMode=Hk.prototype.setSequenceMode,Hk.prototype.parseInit=Hk.prototype.parseInit,Ai("text/x-subviewer",function(){return new Hk}),Kk.prototype.parseInit=function(){},Kk.prototype.setSequenceMode=function(){},Kk.prototype.setManifestType=function(){},Kk.prototype.parseMedia=function(e,t,n){return e=We(e),e=Wk(e),e=Be(ze(e)),this.g.parseMedia(e,t,n,[])},K("shaka.text.SrtTextParser",Kk),Kk.srt2webvtt=Wk,Kk.prototype.parseMedia=Kk.prototype.parseMedia,Kk.prototype.setManifestType=Kk.prototype.setManifestType,Kk.prototype.setSequenceMode=Kk.prototype.setSequenceMode,Kk.prototype.parseInit=Kk.prototype.parseInit,Ai("text/srt",function(){return new Kk}),qk.prototype.parseInit=function(){},qk.prototype.setSequenceMode=function(){},qk.prototype.setManifestType=function(){},qk.prototype.parseMedia=function(e){var t="",n="",i=null,r=null;for(r=We(e).split(/\r?\n\s*\r?\n/),e=d(r),r=e.next();!r.done;r=e.next()){var s=r.value;r=s,(s=Qk.exec(s))&&(i=s[1],r=s[2]),"V4 Styles"==i||"V4+ Styles"==i?(t=r,t=n?t+"\n"+r:r):"Events"==i&&(n=n?n+"\n"+r:r)}for(i=[],r=null,t=d(t.split(/\r?\n/)),e=t.next();!e.done;e=t.next())if(e=e.value,!/^\s*;/.test(e)&&(s=Jk.exec(e)))if(e=s[1].trim(),s=s[2].trim(),"Format"==e)r=s.split(Zk);else if("Style"==e){e=s.split(Zk),s={};for(var a=0;a<r.length&&a<e.length;a++)s[r[a]]=e[a];i.push(s)}for(r=[],t=null,n=d(n.split(/\r?\n/)),s=n.next(),e={};!s.done;e={Oi:void 0},s=n.next())if(s=s.value,!/^\s*;/.test(s)&&(a=Jk.exec(s)))if(s=a[1].trim(),a=a[2].trim(),"Format"==s)t=a.split(Zk);else if("Dialogue"==s){a=a.split(Zk),s={};for(var o=0;o<t.length&&o<a.length;o++)s[t[o]]=a[o];o=Xk(s.Start);var u=Xk(s.End);a=new Cn(o,u,a.slice(t.length-1).join(",").replace(/\\N/g,"\n").replace(/\{[^}]+\}/g,"")),e.Oi=s.Style,(e=i.find(function(e){return function(t){return t.Name==e.Oi}}(e)))&&Yk(a,e),r.push(a)}return r},K("shaka.text.SsaTextParser",qk),qk.prototype.parseMedia=qk.prototype.parseMedia,qk.prototype.setManifestType=qk.prototype.setManifestType,qk.prototype.setSequenceMode=qk.prototype.setSequenceMode,qk.prototype.parseInit=qk.prototype.parseInit;var Qk=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,Jk=/^\s*([^:]+):\s*(.*)/,Zk=/\s*,\s*/,eL=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;function tL(e,t){var n=1&e[t+1]?7:9;return t+n<=e.length&&(e=((3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5)-n,0<e)?{Sd:n,qa:e}:null}function nL(e,t){var n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=(60&e[t+2])>>>2;if(i>n.length-1)return null;var r=((192&e[t+2])>>>6)+1,s=(1&e[t+2])<<2;return s|=(192&e[t+3])>>>6,{sampleRate:n[i],channelCount:s,codec:"mp4a.40."+r}}function iL(e,t){if(t+1<e.length&&255===e[t]&&240===(246&e[t+1])){var n=1&e[t+1]?7:9;if(t+n>=e.length)return!1;var i=(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5;return!(i<=n)&&(t+=i,t===e.length||t+1<e.length&&255===e[t]&&240===(246&e[t+1]))}return!1}function rL(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t||3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}function sL(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function aL(e,t){if(t+8>e.length||11!==e[t]||119!==e[t+1])return null;var n=e[t+4]>>6;if(3<=n)return null;var i=63&e[t+4],r=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*i+n];if(t+r>e.length)return null;var s=e[t+6]>>5,a=0;2===s?a+=2:(1&s&&1!==s&&(a+=2),4&s&&(a+=2)),a=(e[t+6]<<8|e[t+7])>>12-a&1;var o=7&e[t+5];return e=new Uint8Array([n<<6|e[t+5]>>3<<1|o>>2,(3&o)<<6|s<<3|a<<2|i>>4,i<<4&224]),{sampleRate:[48e3,44100,32e3][n],channelCount:[2,1,2,3,3,4,4,5][s]+a,Ea:e,qa:r}}function oL(e,t){if(11===e[t]&&119===e[t+1]){var n,i,r=0,s=5;for(t+=s;0<s;){i=e[t];var a=Math.min(s,8),o=8-a;n=4278190080>>>24+o<<o,n=(i&n)>>o,r=r?r<<a|n:n,t+=1,s-=a}if(16>r)return!0}return!1}function uL(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function lL(e,t){if(t+8>e.length||2935!==(e[t]<<8|e[t+1]))return null;var n=new uu(e.subarray(t+2));cu(n,2),cu(n,3);var i=du(n,11)+1<<1,r=du(n,2);if(3==r){r=du(n,2),r=[24e3,22060,16e3][r];var s=3}else r=[48e3,44100,32e3][r],s=du(n,2);var a=du(n,3),o=du(n,1);return n=du(n,5),t+i>e.byteLength?null:(e=Math.floor(i*r/(16*[1,2,3,6][s])),e=new Uint8Array([(8160&e)>>5,(31&e)<<3,r<<6|n<<1,a<<1|o,0]),{sampleRate:r,channelCount:[2,1,2,3,3,4,4,5][a]+o,Ea:e,qa:i})}function cL(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function dL(e){if(!e.length)return null;var t=e.find(function(e){return 7==e.type});if(e=e.find(function(e){return 8==e.type}),!t||!e)return null;var n=new uu(t.data),i=vu(n);if(vu(n),vu(n),fu(n),fL.includes(i)&&(i=pu(n),3===i&&cu(n,1),fu(n),fu(n),cu(n,1),mu(n))){i=3!==i?8:12;for(var r=0;r<i;r++)mu(n)&&yu(n,6>r?16:64)}if(fu(n),i=pu(n),0===i)pu(n);else if(1===i)for(cu(n,1),fu(n),fu(n),i=pu(n),r=0;r<i;r++)fu(n);fu(n),cu(n,1);var s=pu(n),a=pu(n),o=du(n,1);0===o&&cu(n,1),cu(n,1);var u=0,l=0,c=0,d=0;if(mu(n)&&(u=pu(n),l=pu(n),c=pu(n),d=pu(n)),r=i=1,mu(n)&&mu(n)){var f=vu(n),p=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],g=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];0<f&&16>=f?(i=p[f-1],r=g[f-1]):255===f&&(i=du(n,16),r=du(n,16))}return n=(2-o)*(a+1)*16-2*c-2*d,s=16*(s+1)-2*u-2*l,u=[],t=t.fullData,u.push(t.byteLength>>>8&255),u.push(255&t.byteLength),u=u.concat.apply(u,h(t)),t=[],e=e.fullData,t.push(e.byteLength>>>8&255),t.push(255&e.byteLength),t=t.concat.apply(t,h(e)),e=new Uint8Array([1,u[3],u[4],u[5],255,225].concat(u,[1],t)),{height:n,width:s,Na:e,Va:i,Wa:r}}function hL(e){function t(e){r={data:new Uint8Array([]),frame:!1,isKeyframe:!1,pts:e.pts,dts:e.dts,nalus:[]}}function n(){if(r&&r.nalus.length&&r.frame){for(var e=[],t=d(r.nalus),n=t.next();!n.done;n=t.next()){n=n.value;var s=n.fullData.byteLength,a=new Uint8Array(4);a[0]=s>>24&255,a[1]=s>>16&255,a[2]=s>>8&255,a[3]=255&s,e.push(a),e.push(n.fullData)}r.data=at.apply(et,h(e)),i.push(r)}}for(var i=[],r=null,s=!1,a=0;a<e.length;a++){var o=e[a],u=o.nalus,l=!1;r&&u.length&&!s&&(n(),t(o)),u=d(o.nalus);for(var c=u.next();!c.done;c=u.next()){c=c.value;var f=!1;switch(c.type){case 1:var p=!1;f=!0;var g=c.data;l&&4<g.length&&(g=bu(new uu(g)),2===g||4===g||7===g||9===g)&&(p=!0),p&&r&&r.frame&&!r.isKeyframe&&(n(),r=null),r||t(o),r.frame=!0,r.isKeyframe=p;break;case 5:f=!0,r&&r.frame&&!r.isKeyframe&&(n(),r=null),r||t(o),r.frame=!0,r.isKeyframe=!0;break;case 6:f=!0;break;case 7:l=f=!0;break;case 8:f=!0;break;case 9:s=f=!0,r&&r.frame&&(n(),r=null),r||t(o);break;case 12:f=!0;break;default:f=!1}r&&f&&r.nalus.push(c)}}return n(),i}Ai("text/x-ssa",function(){return new qk}),i=sL.prototype,i.destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/aac"==e.toLowerCase().split(";")[0]&&St(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/aac"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="'+(bi(t)||"mp4a.40.2")+'"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){for(var r=Be(e),s=au(r),a=s.length;a<r.length&&!iL(r,a);a++);if(e=1e3*n.endTime,s=su(s),s.length&&n&&(s=s.find(function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description}))&&(e=s.data),s=nL(r,a),!s)return Promise.reject(new Ve(2,3,3018,n?n.O()[0]:null));t.audioSamplingRate=s.sampleRate,t.channelsCount=s.channelCount;for(var o=[];a<r.length;){var u=tL(r,a);if(!u)return Promise.reject(new Ve(2,3,3018,n?n.O()[0]:null));var l=u.Sd+u.qa;a+l<=r.length&&o.push({data:r.subarray(a+u.Sd,a+l),size:u.qa,duration:1024,qb:0,flags:{vb:0,kb:0,jb:0,hb:0,ib:2,wb:0}}),a+=l}return r=s.sampleRate,e=Math.floor(e*r/1e3),i={id:t.id,type:"audio",codecs:s.codec,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:i,Ab:[],Ea:new Uint8Array([]),Na:new Uint8Array([]),Va:0,Wa:0,data:{Tb:this.h,baseMediaDecodeTime:e,yb:o},stream:t},i=new Za([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=eo(i),this.g.set(n,t)),n=this.i!==t,i=so(i),this.i=t,this.h++,n?(t=at(t,i),Promise.resolve(t)):Promise.resolve(i)},K("shaka.transmuxer.AacTransmuxer",sL),sL.prototype.transmux=sL.prototype.transmux,sL.prototype.getOriginalMimeType=sL.prototype.getOriginalMimeType,sL.prototype.convertCodecs=sL.prototype.convertCodecs,sL.prototype.isSupported=sL.prototype.isSupported,sL.prototype.destroy=sL.prototype.destroy,ri("audio/aac",function(){return new sL("audio/aac")},oi),i=uL.prototype,i.destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/ac3"==e.toLowerCase().split(";")[0]&&St(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/ac3"==t.toLowerCase().split(";")[0]?ce().be()?'audio/mp4; codecs="ec-3"':'audio/mp4; codecs="ac-3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){e=Be(e);for(var r=au(e),s=r.length;s<e.length&&!oL(e,s);s++);var a=1e3*n.endTime;r=su(r),r.length&&n&&(r=r.find(function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description}))&&(a=r.data),r=0;for(var o=new Uint8Array([]),u=[];s<e.length;){var l=aL(e,s);if(!l)return Promise.reject(new Ve(2,3,3018,n?n.O()[0]:null));t.audioSamplingRate=l.sampleRate,t.channelsCount=l.channelCount,r=l.sampleRate,o=l.Ea,u.push({data:e.subarray(s,s+l.qa),size:l.qa,duration:1536,qb:0,flags:{vb:0,kb:0,jb:0,hb:0,ib:2,wb:0}}),s+=l.qa}return e=Math.floor(a*r/1e3),i={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:i,Ab:[],Ea:o,Na:new Uint8Array([]),Va:0,Wa:0,data:{Tb:this.h,baseMediaDecodeTime:e,yb:u},stream:t},i=new Za([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=eo(i),this.g.set(n,t)),n=this.i!==t,i=so(i),this.i=t,this.h++,n?(t=at(t,i),Promise.resolve(t)):Promise.resolve(i)},K("shaka.transmuxer.Ac3Transmuxer",uL),uL.prototype.transmux=uL.prototype.transmux,uL.prototype.getOriginalMimeType=uL.prototype.getOriginalMimeType,uL.prototype.convertCodecs=uL.prototype.convertCodecs,uL.prototype.isSupported=uL.prototype.isSupported,uL.prototype.destroy=uL.prototype.destroy,ri("audio/ac3",function(){return new uL("audio/ac3")},oi),i=cL.prototype,i.destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/ec3"==e.toLowerCase().split(";")[0]&&St(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/ec3"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="ec-3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){e=Be(e);for(var r=au(e),s=r.length;s<e.length&&2935!==(e[s]<<8|e[s+1]);s++);var a=1e3*n.endTime;r=su(r),r.length&&n&&(r=r.find(function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description}))&&(a=r.data),r=0;for(var o=new Uint8Array([]),u=[];s<e.length;){var l=lL(e,s);if(!l)return Promise.reject(new Ve(2,3,3018,n?n.O()[0]:null));t.audioSamplingRate=l.sampleRate,t.channelsCount=l.channelCount,r=l.sampleRate,o=l.Ea,u.push({data:e.subarray(s,s+l.qa),size:l.qa,duration:1536,qb:0,flags:{vb:0,kb:0,jb:0,hb:0,ib:2,wb:0}}),s+=l.qa}return e=Math.floor(a*r/1e3),i={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:i,Ab:[],Ea:o,Na:new Uint8Array([]),Va:0,Wa:0,data:{Tb:this.h,baseMediaDecodeTime:e,yb:u},stream:t},i=new Za([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=eo(i),this.g.set(n,t)),n=this.i!==t,i=so(i),this.i=t,this.h++,n?(t=at(t,i),Promise.resolve(t)):Promise.resolve(i)},K("shaka.transmuxer.Ec3Transmuxer",cL),cL.prototype.transmux=cL.prototype.transmux,cL.prototype.getOriginalMimeType=cL.prototype.getOriginalMimeType,cL.prototype.convertCodecs=cL.prototype.convertCodecs,cL.prototype.isSupported=cL.prototype.isSupported,cL.prototype.destroy=cL.prototype.destroy,ri("audio/ec3",function(){return new cL("audio/ec3")},oi);var fL=[100,110,122,244,44,83,86,118,128,138,139,134];function pL(e){if(!e.length)return null;var t=e.find(function(e){return 32==e.type}),n=e.find(function(e){return 33==e.type}),i=e.find(function(e){return 34==e.type});if(!t||!n||!i)return null;var r=gL(t.fullData);e=mL(n.fullData);var s=vL(i.fullData);return t=yL(t.fullData,n.fullData,i.fullData,{Ng:r.Ng,rh:r.rh,xg:e.xg,yg:e.yg,qg:e.qg,wg:e.wg,rg:e.rg,sg:e.sg,ug:e.ug,vg:e.vg,kg:e.kg,lg:e.lg,mg:e.mg,ng:e.ng,og:e.og,pg:e.pg,cg:e.cg,hf:e.hf,$f:e.$f,Zf:e.Zf,Yf:e.Yf,Pg:s.Pg}),{height:e.height,width:e.width,Na:t,Va:e.Kk,Wa:e.Jk}}function gL(e){var t=new uu(e,!0);return vu(t),vu(t),du(t,4),du(t,2),du(t,6),e=du(t,3),t=mu(t),{Ng:e+1,rh:t}}function mL(e){e=new uu(e,!0),vu(e),vu(e);var t=0,n=0,i=0,r=0;du(e,4);var s=du(e,3);mu(e);for(var a=du(e,2),o=du(e,1),u=du(e,5),l=vu(e),c=vu(e),d=vu(e),h=vu(e),f=vu(e),p=vu(e),g=vu(e),m=vu(e),v=vu(e),y=vu(e),b=vu(e),T=[],S=[],E=0;E<s;E++)T.push(mu(e)),S.push(mu(e));if(0<s)for(E=s;8>E;E++)du(e,2);for(E=0;E<s;E++)T[E]&&du(e,88),S[E]&&vu(e);pu(e),T=pu(e),3==T&&du(e,1),S=pu(e),E=pu(e),mu(e)&&(t+=pu(e),n+=pu(e),i+=pu(e),r+=pu(e));var w=pu(e),A=pu(e),x=pu(e);if(mu(e))for(var I=0;I<=s;I++)pu(e),pu(e),pu(e);else pu(e),pu(e),pu(e);if(pu(e),pu(e),pu(e),pu(e),pu(e),pu(e),mu(e)&&mu(e))for(I=0;4>I;I++)for(var k=0;k<(3===I?2:6);k++)if(mu(e)){var L=Math.min(64,1<<4+(I<<1));1<I&&gu(e);for(var R=0;R<L;R++)gu(e)}else pu(e);for(mu(e),mu(e),mu(e)&&(vu(e),pu(e),pu(e),mu(e)),I=pu(e),L=k=0;L<I;L++)if(R=!1,0!==L&&(R=mu(e)),R){L===I&&pu(e),mu(e),pu(e);for(var C=R=0;C<=k;C++){var D=mu(e),M=!1;D||(M=mu(e)),(D||M)&&R++}k=R}else{for(C=pu(e),R=pu(e),k=C+R,D=0;D<C;D++)pu(e),mu(e);for(C=0;C<R;C++)pu(e),mu(e)}if(mu(e))for(I=pu(e),k=0;k<I;k++){for(L=0;L<x+4;L++)du(e,1);du(e,1)}if(I=x=1,k=0,mu(e),mu(e),mu(e)){if(mu(e)&&(L=vu(e),R=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],C=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1],0<L&&16>=L?(x=R[L-1],I=C[L-1]):255===L&&(x=du(e,16),I=du(e,16))),mu(e)&&mu(e),mu(e)&&(du(e,3),mu(e),mu(e)&&(vu(e),vu(e),vu(e))),mu(e)&&(pu(e),pu(e)),mu(e),mu(e),mu(e),(L=mu(e))&&(pu(e),pu(e),pu(e),pu(e)),mu(e)&&(du(e,32),du(e,32),mu(e)&&pu(e),mu(e)))for(C=!1,L=mu(e),R=mu(e),(L||R)&&((C=mu(e))&&(vu(e),du(e,5),mu(e),du(e,5)),du(e,4),du(e,4),C&&du(e,4),du(e,5),du(e,5),du(e,5)),D=0;D<=s;D++){var P=!0;M=1,mu(e)||(P=mu(e));var _=!1;if(P?pu(e):_=mu(e),_||(M=pu(e)+1),L){for(P=0;P<M;P++)pu(e),pu(e),C&&(pu(e),pu(e));mu(e)}if(R){for(P=0;P<M;P++)pu(e),pu(e),C&&(pu(e),pu(e));mu(e)}}mu(e)&&(mu(e),mu(e),mu(e),k=pu(e),pu(e),pu(e),pu(e),pu(e))}return{qg:b,xg:a,yg:o,wg:u,rg:l,sg:c,ug:d,vg:h,kg:f,lg:p,mg:g,ng:m,og:v,pg:y,hf:k,cg:0,$f:T,Zf:w,Yf:A,width:S-(t+n)*(1===T||2===T?2:1),height:E-(i+r)*(1===T?2:1),Kk:x,Jk:I}}function vL(e){var t=new uu(e,!0);vu(t),vu(t),pu(t),pu(t),mu(t),mu(t),du(t,3),mu(t),mu(t),pu(t),pu(t),gu(t),mu(t),mu(t),mu(t)&&pu(t),gu(t),gu(t),mu(t),mu(t),mu(t),mu(t),e=mu(t),t=mu(t);var n=1;return t&&e?n=0:t?n=3:e&&(n=2),{Pg:n}}function yL(e,t,n,i){var r=new Uint8Array(23+(5+e.byteLength)+(5+t.byteLength)+(5+n.byteLength));return r[0]=1,r[1]=(3&i.xg)<<6|(i.yg?1:0)<<5|31&i.wg,r[2]=i.rg,r[3]=i.sg,r[4]=i.ug,r[5]=i.vg,r[6]=i.kg,r[7]=i.lg,r[8]=i.mg,r[9]=i.ng,r[10]=i.og,r[11]=i.pg,r[12]=i.qg,r[13]=240|(3840&i.hf)>>8,r[14]=255&i.hf,r[15]=252|3&i.Pg,r[16]=252|3&i.$f,r[17]=248|7&i.Zf,r[18]=248|7&i.Yf,r[19]=0,r[20]=0,r[21]=(3&i.cg)<<6|(7&i.Ng)<<3|(i.rh?1:0)<<2|3,r[22]=3,r[23]=160,r[24]=0,r[25]=1,r[26]=(65280&e.byteLength)>>8,r[27]=255&e.byteLength,r.set(e,28),r[23+(5+e.byteLength)]=161,r[e.byteLength+29]=0,r[e.byteLength+30]=1,r[e.byteLength+31]=(65280&t.byteLength)>>8,r[e.byteLength+32]=255&t.byteLength,r.set(t,e.byteLength+33),r[23+(e.byteLength+10+t.byteLength)]=162,r[e.byteLength+10+t.byteLength+24]=0,r[e.byteLength+10+t.byteLength+25]=1,r[e.byteLength+10+t.byteLength+26]=(65280&n.byteLength)>>8,r[e.byteLength+10+t.byteLength+27]=255&n.byteLength,r.set(n,e.byteLength+10+t.byteLength+28),r}function bL(e,t){var n=e[t+1]>>3&3,i=e[t+1]>>1&3,r=e[t+2]>>4&15,s=e[t+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==s){var a=e[t+3]>>6;r=1e3*EL[14*(3===n?3-i:3===i?3:4)+r-1],s=wL[3*(3===n?0:2===n?1:2)+s],n=AL[n][i];var o=xL[i],u=Math.floor(n*r/s+(e[t+2]>>1&1))*o,l=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);return(l=l?parseInt(l[1],10):0)&&87>=l&&2===i&&224e3<=r&&0===a&&(e[t+3]|=128),{sampleRate:s,channelCount:3===a?1:2,qa:u,Ik:8*n*o}}return null}function TL(e,t){return 255===e[t]&&224===(224&e[t+1])&&0!==(6&e[t+1])}function SL(e,t){if(t+1<e.length&&TL(e,t)){var n=bL(e,t),i=4;return n&&n.qa&&(i=n.qa),t+=i,t===e.length||t+1<e.length&&TL(e,t)}return!1}var EL=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],wL=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],AL=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],xL=[0,1,1,4];function IL(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function kL(e){this.h=e,this.g=null}
/*
 @license
 MSS Transmuxer
 Copyright 2015 Dash Industry Forum
 SPDX-License-Identifier: BSD-3-Clause
*/
function LL(e){this.h=e,(this.g=VT.get("ISOBoxer")())&&RL(this)}function RL(e){function t(){this._procFullBox(),1&this.flags&&(this._procField("AlgorithmID","uint",24),this._procField("IV_size","uint",8),this._procFieldArray("KID",16,"uint",8)),this._procField("sample_count","uint",32),this._procEntries("entry",this.sample_count,function(e){this._procEntryField(e,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(e,"NumberOfEntries","uint",16),this._procSubEntries(e,"clearAndCryptedData",e.NumberOfEntries,function(e){this._procEntryField(e,"BytesOfClearData","uint",16),this._procEntryField(e,"BytesOfEncryptedData","uint",32)}))})}e.g.addBoxProcessor("saio",function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",1===this.version?64:32)}),e.g.addBoxProcessor("saiz",function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),0===this.default_sample_info_size&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)}),e.g.addBoxProcessor("senc",t),e.g.addBoxProcessor("uuid",function(){for(var e=!0,n=0;16>n;n++)this.usertype[n]!==DL[n]&&(e=!1);e&&(this._parsing&&(this.type="sepiff"),t.call(this))})}function CL(e,t){for(var n=8,i=0;i<e.boxes.length&&e.boxes[i].type!==t;i++)n+=e.boxes[i].size;return n}i=IL.prototype,i.destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/mpeg"==e.toLowerCase().split(";")[0]&&St(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/mpeg"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="mp3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){for(var r=Be(e),s=au(r).length;s<r.length&&!SL(r,s);s++);var a;for(e=[];s<r.length;){var o=bL(r,s);if(!o)return Promise.reject(new Ve(2,3,3018,n?n.O()[0]:null));a||(a=o),s+o.qa<=r.length&&e.push({data:r.subarray(s,s+o.qa),size:o.qa,duration:1152,qb:0,flags:{vb:0,kb:0,jb:0,hb:0,ib:2,wb:0}}),s+=o.qa}return a?(r=9e4*a.Ik/a.sampleRate*this.h,i={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:a.sampleRate,duration:i,Ab:[],Ea:new Uint8Array([]),Na:new Uint8Array([]),Va:0,Wa:0,data:{Tb:this.h,baseMediaDecodeTime:r,yb:e},stream:t},i=new Za([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=eo(i),this.g.set(n,t)),n=this.i!==t,i=so(i),this.i=t,this.h++,n?(t=at(t,i),Promise.resolve(t)):Promise.resolve(i)):Promise.reject(new Ve(2,3,3018,n?n.O()[0]:null))},K("shaka.transmuxer.Mp3Transmuxer",IL),IL.prototype.transmux=IL.prototype.transmux,IL.prototype.getOriginalMimeType=IL.prototype.getOriginalMimeType,IL.prototype.convertCodecs=IL.prototype.convertCodecs,IL.prototype.isSupported=IL.prototype.isSupported,IL.prototype.destroy=IL.prototype.destroy,ri("audio/mpeg",function(){return new IL("audio/mpeg")},oi),i=kL.prototype,i.destroy=function(){},i.isSupported=function(e){if("video/mp2t"!=e.toLowerCase().split(";")[0])return!1;var t=bi(e).split(","),n=dt("audio",t);return t=dt("video",t),!(!n||t||"mp3"!=mi(n))&&St(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"video/mp2t"==t.toLowerCase().split(";")[0]?"audio/mpeg":t},i.getOriginalMimeType=function(){return this.h},i.transmux=function(e,t,n,i,r){if(this.g?this.g.clearData():this.g=new Tu,e=Be(e),e=this.g.parse(e),"mp3"!=e.Md().audio||"audio"!=r)return Promise.reject(new Ve(2,3,3018,n?n.O()[0]:null));for(n=new Uint8Array([]),r=d(e.rb()),e=r.next();!e.done;e=r.next())if(e=e.value.data)for(t=0;t<e.length;)(i=bL(e,t))?(t+i.qa<=e.length&&(n=at(n,e.subarray(t,t+i.qa))),t+=i.qa):t++;return Promise.resolve(n)},K("shaka.transmuxer.MpegTsTransmuxer",kL),kL.prototype.transmux=kL.prototype.transmux,kL.prototype.getOriginalMimeType=kL.prototype.getOriginalMimeType,kL.prototype.convertCodecs=kL.prototype.convertCodecs,kL.prototype.isSupported=kL.prototype.isSupported,kL.prototype.destroy=kL.prototype.destroy,ri("video/mp2t",function(){return new kL("video/mp2t")},ui),i=LL.prototype,i.destroy=function(){},i.isSupported=function(e,t){var n=e.startsWith("mss/");return!(!this.g||!n)&&(t?St(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),St(t)||St(e)))},i.convertCodecs=function(e,t){return t.replace("mss/","")},i.getOriginalMimeType=function(){return this.h},i.transmux=function(e,t,n){if(!n)return Promise.resolve(Be(e));if(!t.mssPrivateData)return Promise.reject(new Ve(2,3,3020,n?n.O()[0]:null));try{var i,r=this.g.parseBuffer(e),s=r.fetch("tfhd");s.track_ID=t.id+1;var a=r.fetch("tfdt"),o=r.fetch("traf");null===a&&(a=this.g.createFullBox("tfdt",o,s),a.version=1,a.flags=0,a.baseMediaDecodeTime=Math.floor(n.startTime*t.mssPrivateData.timescale));var u=r.fetch("trun"),l=r.fetch("tfxd");l&&l._parent.boxes.splice(l._parent.boxes.indexOf(l),1);var c=r.fetch("tfrf");c&&c._parent.boxes.splice(c._parent.boxes.indexOf(c),1);var d=r.fetch("sepiff");if(null!==d){d.type="senc",d.usertype=void 0;var h=r.fetch("saio");if(null===h){h=this.g.createFullBox("saio",o),h.version=0,h.flags=0,h.entry_count=1,h.offset=[0];var f=this.g.createFullBox("saiz",o);if(f.version=0,f.flags=0,f.sample_count=d.sample_count,f.default_sample_info_size=0,f.sample_info_size=[],2&d.flags)for(i=0;i<d.sample_count;i+=1)f.sample_info_size[i]=10+6*d.entry[i].NumberOfEntries;else f.default_sample_info_size=8}}s.flags&=16777214,s.flags|=131072,u.flags|=1;var p=r.fetch("moof");u.data_offset=p.getLength()+8;var g=r.fetch("saio");null!==g&&(g.offset[0]=CL(p,"traf")+CL(o,"senc")+16);var m=Be(r.write());return Promise.resolve(m)}catch(v){return v instanceof Ve?Promise.reject(v):Promise.reject(new Ve(2,3,3022,n?n.O()[0]:null))}},K("shaka.transmuxer.MssTransmuxer",LL),LL.prototype.transmux=LL.prototype.transmux,LL.prototype.getOriginalMimeType=LL.prototype.getOriginalMimeType,LL.prototype.convertCodecs=LL.prototype.convertCodecs,LL.prototype.isSupported=LL.prototype.isSupported,LL.prototype.destroy=LL.prototype.destroy;var DL=new Uint8Array([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244]);function ML(e){this.m=e,this.g=0,this.i=new Map,this.l=this.h=this.j=null}ri("mss/audio/mp4",function(){return new LL("mss/audio/mp4")},oi),ri("mss/video/mp4",function(){return new LL("mss/video/mp4")},oi),i=ML.prototype,i.destroy=function(){this.i.clear(),this.h&&this.h.destroy()},i.isSupported=function(e,t){if("video/mp2t"!=e.toLowerCase().split(";")[0])return!1;var n=e;t&&(n=this.convertCodecs(t,e));var i=bi(n).split(",");return n=dt("audio",i),i=dt("video",i),!(n&&(n=mi(n),!OL.includes(n))||i&&(n=mi(i),!NL.includes(n)))&&(t?St(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),St(t)||St(e)))},i.convertCodecs=function(e,t){return"video/mp2t"==t.toLowerCase().split(";")[0]?(t=bi(t).replace("mp4a.40.34","mp3").split(",").map(function(e){return ur(e,"audio/mp4")}).map(lr).join(","),"audio"==e?'audio/mp4; codecs="'+t+'"':'video/mp4; codecs="'+t+'"'):t},i.getOriginalMimeType=function(){return this.m},i.transmux=function(e,t,n,i,r){var s=Be(e);if("audio"==r&&!Iu(s)){for(var a=au(s),o=a.length;o<s.length;o++)if(SL(s,o))return Promise.reject(new Ve(2,3,3018,n?n.O()[0]:null));for(o=a.length;o<s.length;o++)if(iL(s,o))return this.h||(this.h=new sL("audio/aac")),this.h.transmux(e,t,n,i,r);return Promise.reject(new Ve(2,3,3018,n?n.O()[0]:null))}this.j?this.j.clearData():this.j=new Tu;var u=this.j.parse(s),l=[],c=u.Md();try{var f=null;if("video"==r){switch(c.video){case"avc":var p=[],g=null,m=u.Qc(),v=hL(m);if(!v.length)throw new Ve(2,3,3023,n?n.O()[0]:null);for(var y=0;y<v.length;y++){var b=v[y];null==g&&(g=b.dts);var T=void 0;T=y+1<v.length?(v[y+1].dts||0)-(b.dts||0):1<v.length?(b.dts||0)-(v[y-1].dts||0):9e4*(n.endTime-n.startTime),p.push({data:b.data,size:b.data.byteLength,duration:T,qb:Math.round((b.pts||0)-(b.dts||0)),flags:{vb:0,kb:0,jb:0,hb:0,ib:b.isKeyframe?2:1,wb:b.isKeyframe?0:1}})}for(var S=[],E=d(m),w=E.next();!w.done;w=E.next())S.push.apply(S,h(w.value.nalus));var A=dL(S);if(!A||null==g)throw new Ve(2,3,3018,n?n.O()[0]:null);t.height=A.height,t.width=A.width,f={id:t.id,type:"video",codecs:"avc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:9e4,duration:i,Ab:[],Ea:new Uint8Array([]),Na:A.Na,Va:A.Va,Wa:A.Wa,data:{Tb:this.g,baseMediaDecodeTime:g,yb:p},stream:t};break;case"hvc":var x=[],I=null,k=[],L=u.Qc();if(!L.length)throw new Ve(2,3,3023,n?n.O()[0]:null);for(var R=0;R<L.length;R++){var C=L[R],D=C.nalus;k.push.apply(k,h(D));for(var M=!1,P=[],_=!1,O=d(D),N=O.next();!N.done;N=O.next()){var U=N.value;switch(U.type){case 1:case 0:var F=_=!0;break;case 19:case 20:case 21:M=F=_=!0;break;case 32:F=!0;break;case 33:F=!0;break;case 34:F=!0;break;case 35:_=F=!0;break;case 39:case 40:F=!0;break;default:F=!1}if(_&&F){var B=U.fullData.byteLength,j=new Uint8Array(4);j[0]=B>>24&255,j[1]=B>>16&255,j[2]=B>>8&255,j[3]=255&B,P.push(j),P.push(U.fullData)}}var $=P.length?{data:at.apply(et,h(P)),isKeyframe:M}:null;if($){null==I&&null!=C.dts&&(I=C.dts);var G=void 0;G=R+1<L.length?(L[R+1].dts||0)-(C.dts||0):1<L.length?(C.dts||0)-(L[R-1].dts||0):9e4*(n.endTime-n.startTime),x.push({data:$.data,size:$.data.byteLength,duration:G,qb:Math.round((C.pts||0)-(C.dts||0)),flags:{vb:0,kb:0,jb:0,hb:0,ib:$.isKeyframe?2:1,wb:$.isKeyframe?0:1}})}}var V=pL(k);if(!V||null==I)throw new Ve(2,3,3018,n?n.O()[0]:null);t.height=V.height,t.width=V.width,f={id:t.id,type:"video",codecs:"hvc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:9e4,duration:i,Ab:[],Ea:new Uint8Array([]),Na:V.Na,Va:V.Va,Wa:V.Wa,data:{Tb:this.g,baseMediaDecodeTime:I,yb:x},stream:t}}f&&(l.push(f),f=null)}if("audio"==r){switch(c.audio){case"aac":for(var H,K=[],W=null,q=null,Y=null,z=d(u.rb()),X=z.next();!X.done;X=z.next()){var Q=X.value,J=Q.data;if(J){var Z=0;if(-1==q&&Y)J=at(Y,Q.data),q=null;else if(null!=q&&Y){Z=Math.max(0,q);var ee=at(Y,J.subarray(0,Z));K.push({data:ee,size:ee.byteLength,duration:1024,qb:0,flags:{vb:0,kb:0,jb:0,hb:0,ib:2,wb:0}}),q=Y=null}if(H=nL(J,Z),!H)throw new Ve(2,3,3018,n?n.O()[0]:null);for(t.audioSamplingRate=H.sampleRate,t.channelsCount=H.channelCount,null==W&&null!==Q.pts&&(W=Q.pts);Z<J.length;){var te=tL(J,Z);if(!te){Y=J.subarray(Z,J.length),q=-1;break}var ne=te.Sd+te.qa;q=Math.max(0,Z+ne-J.length),0!=q?Y=J.subarray(Z+te.Sd,Z+ne):Z+ne<=J.length&&K.push({data:J.subarray(Z+te.Sd,Z+ne),size:te.qa,duration:1024,qb:0,flags:{vb:0,kb:0,jb:0,hb:0,ib:2,wb:0}}),Z+=ne}}}if(!H||null==W){if(!u.Qc().length)throw new Ve(2,3,3018,n?n.O()[0]:null);W=9e4*n.startTime;var ie=dt("audio",t.codecs.split(","));if(!ie||!t.channelsCount||!t.audioSamplingRate)throw new Ve(2,3,3018,n?n.O()[0]:null);H={sampleRate:t.audioSamplingRate,channelCount:t.channelsCount,codec:ie};var re=rL(ie,t.channelsCount);if(!re)throw new Ve(2,3,3018,n?n.O()[0]:null);for(var se=W+9e4*(n.endTime-n.startTime),ae=W;ae<se;)K.push({data:re,size:re.byteLength,duration:1024,qb:0,flags:{vb:0,kb:0,jb:0,hb:0,ib:2,wb:0}}),ae+=1024/H.sampleRate*9e4}var oe=H.sampleRate,ue=W/9e4*oe;f={id:t.id,type:"audio",codecs:H.codec,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:oe,duration:i,Ab:[],Ea:new Uint8Array([]),Na:new Uint8Array([]),Va:0,Wa:0,data:{Tb:this.g,baseMediaDecodeTime:ue,yb:K},stream:t};break;case"ac3":for(var le=[],ce=0,de=new Uint8Array([]),he=null,fe=d(u.rb()),pe=fe.next();!pe.done;pe=fe.next()){var ge=pe.value,me=ge.data;null==he&&null!==ge.pts&&(he=ge.pts);for(var ve=0;ve<me.length;){var ye=aL(me,ve);ye?(t.audioSamplingRate=ye.sampleRate,t.channelsCount=ye.channelCount,ce=ye.sampleRate,de=ye.Ea,le.push({data:me.subarray(ve,ve+ye.qa),size:ye.qa,duration:1536,qb:0,flags:{vb:0,kb:0,jb:0,hb:0,ib:2,wb:0}}),ve+=ye.qa):ve++}}if(0==ce||0==de.byteLength||null==he)throw new Ve(2,3,3018,n?n.O()[0]:null);var be=he/9e4*ce;f={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:ce,duration:i,Ab:[],Ea:de,Na:new Uint8Array([]),Va:0,Wa:0,data:{Tb:this.g,baseMediaDecodeTime:be,yb:le},stream:t};break;case"ec3":for(var Te=[],Se=0,Ee=new Uint8Array([]),we=null,Ae=d(u.rb()),xe=Ae.next();!xe.done;xe=Ae.next()){var Ie=xe.value,ke=Ie.data;null==we&&null!==Ie.pts&&(we=Ie.pts);for(var Le=0;Le<ke.length;){var Re=lL(ke,Le);Re?(t.audioSamplingRate=Re.sampleRate,t.channelsCount=Re.channelCount,Se=Re.sampleRate,Ee=Re.Ea,Te.push({data:ke.subarray(Le,Le+Re.qa),size:Re.qa,duration:1536,qb:0,flags:{vb:0,kb:0,jb:0,hb:0,ib:2,wb:0}}),Le+=Re.qa):Le++}}if(0==Se||0==Ee.byteLength||null==we)throw new Ve(2,3,3018,n?n.O()[0]:null);var Ce=we/9e4*Se;f={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:Se,duration:i,Ab:[],Ea:Ee,Na:new Uint8Array([]),Va:0,Wa:0,data:{Tb:this.g,baseMediaDecodeTime:Ce,yb:Te},stream:t};break;case"mp3":for(var De,Me=[],Pe=null,_e=d(u.rb()),Oe=_e.next();!Oe.done;Oe=_e.next()){var Ne=Oe.value,Ue=Ne.data;if(Ue){null==Pe&&null!==Ne.pts&&(Pe=Ne.pts);for(var Fe=0;Fe<Ue.length;){var je=bL(Ue,Fe);je?(De||(De=je),Fe+je.qa<=Ue.length&&Me.push({data:Ue.subarray(Fe,Fe+je.qa),size:je.qa,duration:1152,qb:0,flags:{vb:0,kb:0,jb:0,hb:0,ib:2,wb:0}}),Fe+=je.qa):Fe++}}}if(!De||null==Pe)throw new Ve(2,3,3018,n?n.O()[0]:null);var $e=De.sampleRate,Ge=Pe/9e4*$e;f={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:$e,duration:i,Ab:[],Ea:new Uint8Array([]),Na:new Uint8Array([]),Va:0,Wa:0,data:{Tb:this.g,baseMediaDecodeTime:Ge,yb:Me},stream:t};break;case"opus":var He=[],Ke=null,We=u.F;if(!We)throw new Ve(2,3,3018,n?n.O()[0]:null);var qe=[];switch(We.hj){case 1:case 2:qe=[0];break;case 0:qe=[255,1,1,0,1];break;case 128:qe=[255,2,0,0,1];break;case 3:qe=[1,2,1,0,2,1];break;case 4:qe=[1,2,2,0,1,2,3];break;case 5:qe=[1,3,2,0,4,1,2,3];break;case 6:qe=[1,4,2,0,4,1,2,3,5];break;case 7:qe=[1,4,2,0,4,1,2,3,5,6];break;case 8:qe=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:qe=[1,1,2,0,1];break;case 131:qe=[1,1,3,0,1,2];break;case 132:qe=[1,1,4,0,1,2,3];break;case 133:qe=[1,1,5,0,1,2,3,4];break;case 134:qe=[1,1,6,0,1,2,3,4,5];break;case 135:qe=[1,1,7,0,1,2,3,4,5,6];break;case 136:qe=[1,1,8,0,1,2,3,4,5,6,7]}for(var Ye=new Uint8Array([0,We.channelCount,0,0,We.sampleRate>>>24&255,We.sampleRate>>>17&255,We.sampleRate>>>8&255,We.sampleRate>>>0&255,0,0].concat(h(qe))),ze=We.sampleRate,Xe=d(u.rb()),Qe=Xe.next();!Qe.done;Qe=Xe.next()){var Je=Qe.value,Ze=Je.data;null==Ke&&null!==Je.pts&&(Ke=Je.pts);for(var tt=0;tt<Ze.length;){for(var nt=0!==(16&Ze[tt+1]),it=0!==(8&Ze[tt+1]),rt=tt+2,st=0;255===Ze[rt];)st+=255,rt+=1;st+=Ze[rt],rt+=1,rt+=nt?2:0,rt+=it?2:0;var ot=Ze.slice(rt,rt+st);He.push({data:ot,size:ot.byteLength,duration:960,qb:0,flags:{vb:0,kb:0,jb:0,hb:0,ib:2,wb:0}}),tt=rt+st}}if(0==Ye.byteLength||null==Ke)throw new Ve(2,3,3018,n?n.O()[0]:null);t.audioSamplingRate=We.sampleRate,t.channelsCount=We.channelCount;var ut=Ke/9e4*ze;f={id:t.id,type:"audio",codecs:"opus",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:ze,duration:i,Ab:[],Ea:Ye,Na:new Uint8Array([]),Va:0,Wa:0,data:{Tb:this.g,baseMediaDecodeTime:ut,yb:He},stream:t}}f&&(l.push(f),f=null)}}catch(mt){return mt&&3023==mt.code?Promise.resolve(new Uint8Array([])):Promise.reject(mt)}if(!l.length)return Promise.reject(new Ve(2,3,3018,n?n.O()[0]:null));var lt=new Za(l),ct=t.id+"_"+n.i;if(this.i.has(ct))var ht=this.i.get(ct);else ht=eo(lt),this.i.set(ct,ht);var ft=this.l!==ht,pt=so(lt);if(this.l=ht,this.g++,ft){var gt=at(ht,pt);return Promise.resolve(gt)}return Promise.resolve(pt)},K("shaka.transmuxer.TsTransmuxer",ML),ML.prototype.transmux=ML.prototype.transmux,ML.prototype.getOriginalMimeType=ML.prototype.getOriginalMimeType,ML.prototype.convertCodecs=ML.prototype.convertCodecs,ML.prototype.isSupported=ML.prototype.isSupported,ML.prototype.destroy=ML.prototype.destroy;var PL,_L,OL=["aac","ac-3","ec-3","mp3","opus"],NL=["avc","hevc"];function UL(){}
/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function FL(){}function BL(){PL||navigator.emeEncryptionSchemePolyfilled?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(PL=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=jL,navigator.emeEncryptionSchemePolyfilled=!0):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function jL(e,t){var n,i=this;return U(function(r){return 1==r.g?(console.assert(i==navigator,'bad "this" for requestMediaKeySystemAccess'),w(r,PL.call(i,e,t),2)):(n=r.h,XL(n)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=PL,r.return(n)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=$L,r.return($L.call(i,e,t))))})}function $L(e,t){var n,i,r,s,a,o,u,l,c,h,f,p,g=this;return U(function(m){if(1==m.g){for(console.assert(g==navigator,'bad "this" for requestMediaKeySystemAccess'),n=zL(e),i=[],r=d(t),s=r.next();!s.done;s=r.next())a=s.value,o=GL(a.videoCapabilities,n),u=GL(a.audioCapabilities,n),a.videoCapabilities&&a.videoCapabilities.length&&!o.length||a.audioCapabilities&&a.audioCapabilities.length&&!u.length||(l=Object.assign({},a),l.videoCapabilities=o,l.audioCapabilities=u,i.push(l));if(!i.length)throw c=Error("Unsupported keySystem or supportedConfigurations."),c.name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c;return w(m,PL.call(g,e,i),2)}return h=m.h,p=f=null,i[0]&&(i[0].videoCapabilities&&(f=i[0].videoCapabilities[0].encryptionScheme),i[0].audioCapabilities&&(p=i[0].audioCapabilities[0].encryptionScheme)),m.return(new YL(h,f,p))})}function GL(e,t){return e?e.filter(function(e){return QL(e.encryptionScheme,t)}):e}function VL(){}function HL(){_L||navigator.mediaCapabilitiesEncryptionSchemePolyfilled?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(_L=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=KL,navigator.mediaCapabilitiesEncryptionSchemePolyfilled=!0):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function KL(e){var t,n,i=this;return U(function(r){switch(r.g){case 1:return console.assert(i==navigator.mediaCapabilities,'bad "this" for decodingInfo'),w(r,_L.call(i,e),2);case 2:if(t=r.h,!t.supported||!e.keySystemConfiguration)return r.return(t);if((n=t.keySystemAccess)&&XL(n))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=_L,r.return(t);if(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=WL,n){r.u(3);break}return w(r,qL(e),4);case 4:return t.keySystemAccess=r.h,r.return(t);case 3:return r.return(WL.call(i,e))}})}function WL(e){var t,n,i,r,s,a,o,u=this;return U(function(l){switch(l.g){case 1:return console.assert(u==navigator.mediaCapabilities,'bad "this" for decodingInfo'),n=t=null,!e.keySystemConfiguration||(i=e.keySystemConfiguration,r=i.keySystem,n=i.audio&&i.audio.encryptionScheme,t=i.video&&i.video.encryptionScheme,s=zL(r),a={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},QL(n,s)&&QL(t,s))?w(l,_L.call(u,e),2):l.return(a);case 2:if(o=l.h,o.keySystemAccess){o.keySystemAccess=new YL(o.keySystemAccess,t,n),l.u(3);break}if(!e.keySystemConfiguration){l.u(3);break}return w(l,qL(e),5);case 5:o.keySystemAccess=l.h;case 3:return l.return(o)}})}function qL(e){var t,n;return U(function(i){if(1==i.g){var r=e.keySystemConfiguration,s=[],a=[];return r.audio&&s.push({robustness:r.audio.robustness||"",contentType:e.audio.contentType,encryptionScheme:r.audio.encryptionScheme}),r.video&&a.push({robustness:r.video.robustness||"",contentType:e.video.contentType,encryptionScheme:r.video.encryptionScheme}),r={initDataTypes:r.initDataType?[r.initDataType]:[],distinctiveIdentifier:r.distinctiveIdentifier,persistentState:r.persistentState,sessionTypes:r.sessionTypes},s.length&&(r.audioCapabilities=s),a.length&&(r.videoCapabilities=a),t=r,w(i,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[t]),2)}return n=i.h,i.return(n)})}function YL(e,t,n){this.g=e,this.i=t||null,this.h=n||null,this.keySystem=e.keySystem}function zL(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs":e.startsWith("com.huawei")?"cenc":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function XL(e){e=e.getConfiguration();var t=e.audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function QL(e,t){return!e||e==t||!("cbcs"!=e&&"cbcs-1-9"!=e||!(nR||sR||tR))}function JL(){}function ZL(){BL(),HL()}ri("video/mp2t",function(){return new ML("video/mp2t")},li),b(UL,Sd),K("shaka.util.FairPlayUtils",UL),K("EmeEncryptionSchemePolyfill",FL),FL.install=BL,K("McEncryptionSchemePolyfill",VL),VL.install=HL,YL.prototype.getConfiguration=function(){var e=this.g.getConfiguration();if(e.videoCapabilities)for(var t=d(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.i;if(e.audioCapabilities)for(t=d(e.audioCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.h;return e},YL.prototype.createMediaKeys=function(){return this.g.createMediaKeys()},K("EncryptionSchemePolyfills",JL),JL.install=ZL;var eR,tR=navigator.userAgent.includes("CrKey"),nR=100<=parseInt(navigator.userAgent.split("Firefox/").pop(),10),iR=navigator.userAgent||"";if(iR.includes("Web0S")){var rR=iR.match(/Chrome\/(\d+)/);eR=!!rR&&79<=parseInt(rR[1],10)}else eR=!1;var sR=eR;"undefined"!==typeof n&&n.exports&&(n.exports=JL)}.call(i,e,e,void 0),i.shaka)t[r]=i.shaka[r]}()},851:function(e,t,n){"use strict";var i=n(6955),r=n(5966),s=n(4117),a=n(6269),o=n(8227),u=o("iterator");e.exports=function(e){if(!s(e))return r(e,u)||r(e,"@@iterator")||a[i(e)]}},1072:function(e,t,n){"use strict";var i=n(1828),r=n(8727);e.exports=Object.keys||function(e){return i(e,r)}},1108:function(e,t,n){"use strict";var i=n(6955);e.exports=function(e){var t=i(e);return"BigInt64Array"===t||"BigUint64Array"===t}},1148:function(e,t,n){"use strict";var i=n(6518),r=n(9565),s=n(2652),a=n(9306),o=n(8551),u=n(1767),l=n(9539),c=n(4549),d=c("every",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:d},{every:function(e){o(this);try{a(e)}catch(i){l(this,"throw",i)}if(d)return r(d,this,e);var t=u(this),n=0;return!s(t,function(t,i){if(!e(t,n++))return i()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},1181:function(e,t,n){"use strict";var i,r,s,a=n(8622),o=n(4576),u=n(34),l=n(6699),c=n(9297),d=n(7629),h=n(6119),f=n(421),p="Object already initialized",g=o.TypeError,m=o.WeakMap,v=function(e){return s(e)?r(e):i(e,{})},y=function(e){return function(t){var n;if(!u(t)||(n=r(t)).type!==e)throw new g("Incompatible receiver, "+e+" required");return n}};if(a||d.state){var b=d.state||(d.state=new m);b.get=b.get,b.has=b.has,b.set=b.set,i=function(e,t){if(b.has(e))throw new g(p);return t.facade=e,b.set(e,t),t},r=function(e){return b.get(e)||{}},s=function(e){return b.has(e)}}else{var T=h("state");f[T]=!0,i=function(e,t){if(c(e,T))throw new g(p);return t.facade=e,l(e,T,t),t},r=function(e){return c(e,T)?e[T]:{}},s=function(e){return c(e,T)}}e.exports={set:i,get:r,has:s,enforce:v,getterFor:y}},1241:function(e,t){"use strict";t.A=(e,t)=>{const n=e.__vccOpts||e;for(const[i,r]of t)n[i]=r;return n}},1291:function(e,t,n){"use strict";var i=n(741);e.exports=function(e){var t=+e;return t!==t||0===t?0:i(t)}},1385:function(e,t,n){"use strict";var i=n(9539);e.exports=function(e,t,n){for(var r=e.length-1;r>=0;r--)if(void 0!==e[r])try{n=i(e[r].iterator,t,n)}catch(s){t="throw",n=s}if("throw"===t)throw n;return n}},1387:function(e,t,n){"use strict";n.d(t,{Bt:function(){return le},aE:function(){return st},lq:function(){return ut},rd:function(){return ot}});n(4114),n(8111),n(1148),n(2489),n(116),n(7588),n(1701),n(8237),n(3579),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698);var i=n(6768),r=n(144);
/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */
const s="undefined"!==typeof document;function a(e){return"object"===typeof e||"displayName"in e||"props"in e||"__vccOpts"in e}function o(e){return e.__esModule||"Module"===e[Symbol.toStringTag]||e.default&&a(e.default)}const u=Object.assign;function l(e,t){const n={};for(const i in t){const r=t[i];n[i]=d(r)?r.map(e):e(r)}return n}const c=()=>{},d=Array.isArray;const h=/#/g,f=/&/g,p=/\//g,g=/=/g,m=/\?/g,v=/\+/g,y=/%5B/g,b=/%5D/g,T=/%5E/g,S=/%60/g,E=/%7B/g,w=/%7C/g,A=/%7D/g,x=/%20/g;function I(e){return encodeURI(""+e).replace(w,"|").replace(y,"[").replace(b,"]")}function k(e){return I(e).replace(E,"{").replace(A,"}").replace(T,"^")}function L(e){return I(e).replace(v,"%2B").replace(x,"+").replace(h,"%23").replace(f,"%26").replace(S,"`").replace(E,"{").replace(A,"}").replace(T,"^")}function R(e){return L(e).replace(g,"%3D")}function C(e){return I(e).replace(h,"%23").replace(m,"%3F")}function D(e){return null==e?"":C(e).replace(p,"%2F")}function M(e){try{return decodeURIComponent(""+e)}catch(t){}return""+e}const P=/\/$/,_=e=>e.replace(P,"");function O(e,t,n="/"){let i,r={},s="",a="";const o=t.indexOf("#");let u=t.indexOf("?");return o<u&&o>=0&&(u=-1),u>-1&&(i=t.slice(0,u),s=t.slice(u+1,o>-1?o:t.length),r=e(s)),o>-1&&(i=i||t.slice(0,o),a=t.slice(o,t.length)),i=V(null!=i?i:t,n),{fullPath:i+(s&&"?")+s+a,path:i,query:r,hash:M(a)}}function N(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function U(e,t){return t&&e.toLowerCase().startsWith(t.toLowerCase())?e.slice(t.length)||"/":e}function F(e,t,n){const i=t.matched.length-1,r=n.matched.length-1;return i>-1&&i===r&&B(t.matched[i],n.matched[r])&&j(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function B(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function j(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!$(e[n],t[n]))return!1;return!0}function $(e,t){return d(e)?G(e,t):d(t)?G(t,e):e===t}function G(e,t){return d(t)?e.length===t.length&&e.every((e,n)=>e===t[n]):1===e.length&&e[0]===t}function V(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),i=e.split("/"),r=i[i.length-1];".."!==r&&"."!==r||i.push("");let s,a,o=n.length-1;for(s=0;s<i.length;s++)if(a=i[s],"."!==a){if(".."!==a)break;o>1&&o--}return n.slice(0,o).join("/")+"/"+i.slice(s).join("/")}const H={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var K,W;(function(e){e["pop"]="pop",e["push"]="push"})(K||(K={})),function(e){e["back"]="back",e["forward"]="forward",e["unknown"]=""}(W||(W={}));function q(e){if(!e)if(s){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return"/"!==e[0]&&"#"!==e[0]&&(e="/"+e),_(e)}const Y=/^[^#]+#/;function z(e,t){return e.replace(Y,"#")+t}function X(e,t){const n=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-n.left-(t.left||0),top:i.top-n.top-(t.top||0)}}const Q=()=>({left:window.scrollX,top:window.scrollY});function J(e){let t;if("el"in e){const n=e.el,i="string"===typeof n&&n.startsWith("#");0;const r="string"===typeof n?i?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;t=X(r,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(null!=t.left?t.left:window.scrollX,null!=t.top?t.top:window.scrollY)}function Z(e,t){const n=history.state?history.state.position-t:-1;return n+e}const ee=new Map;function te(e,t){ee.set(e,t)}function ne(e){const t=ee.get(e);return ee.delete(e),t}let ie=()=>location.protocol+"//"+location.host;function re(e,t){const{pathname:n,search:i,hash:r}=t,s=e.indexOf("#");if(s>-1){let t=r.includes(e.slice(s))?e.slice(s).length:1,n=r.slice(t);return"/"!==n[0]&&(n="/"+n),U(n,"")}const a=U(n,e);return a+i+r}function se(e,t,n,i){let r=[],s=[],a=null;const o=({state:s})=>{const o=re(e,location),u=n.value,l=t.value;let c=0;if(s){if(n.value=o,t.value=s,a&&a===u)return void(a=null);c=l?s.position-l.position:0}else i(o);r.forEach(e=>{e(n.value,u,{delta:c,type:K.pop,direction:c?c>0?W.forward:W.back:W.unknown})})};function l(){a=n.value}function c(e){r.push(e);const t=()=>{const t=r.indexOf(e);t>-1&&r.splice(t,1)};return s.push(t),t}function d(){const{history:e}=window;e.state&&e.replaceState(u({},e.state,{scroll:Q()}),"")}function h(){for(const e of s)e();s=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:l,listen:c,destroy:h}}function ae(e,t,n,i=!1,r=!1){return{back:e,current:t,forward:n,replaced:i,position:window.history.length,scroll:r?Q():null}}function oe(e){const{history:t,location:n}=window,i={value:re(e,n)},r={value:t.state};function s(i,s,a){const o=e.indexOf("#"),u=o>-1?(n.host&&document.querySelector("base")?e:e.slice(o))+i:ie()+e+i;try{t[a?"replaceState":"pushState"](s,"",u),r.value=s}catch(l){console.error(l),n[a?"replace":"assign"](u)}}function a(e,n){const a=u({},t.state,ae(r.value.back,e,r.value.forward,!0),n,{position:r.value.position});s(e,a,!0),i.value=e}function o(e,n){const a=u({},r.value,t.state,{forward:e,scroll:Q()});s(a.current,a,!0);const o=u({},ae(i.value,e,null),{position:a.position+1},n);s(e,o,!1),i.value=e}return r.value||s(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0),{location:i,state:r,push:o,replace:a}}function ue(e){e=q(e);const t=oe(e),n=se(e,t.state,t.location,t.replace);function i(e,t=!0){t||n.pauseListeners(),history.go(e)}const r=u({location:"",base:e,go:i,createHref:z.bind(null,e)},t,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>t.state.value}),r}function le(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),ue(e)}function ce(e){return"string"===typeof e||e&&"object"===typeof e}function de(e){return"string"===typeof e||"symbol"===typeof e}const he=Symbol("");var fe;(function(e){e[e["aborted"]=4]="aborted",e[e["cancelled"]=8]="cancelled",e[e["duplicated"]=16]="duplicated"})(fe||(fe={}));function pe(e,t){return u(new Error,{type:e,[he]:!0},t)}function ge(e,t){return e instanceof Error&&he in e&&(null==t||!!(e.type&t))}const me="[^/]+?",ve={sensitive:!1,strict:!1,start:!0,end:!0},ye=/[.+*?^${}()[\]/\\]/g;function be(e,t){const n=u({},ve,t),i=[];let r=n.start?"^":"";const s=[];for(const u of e){const e=u.length?[]:[90];n.strict&&!u.length&&(r+="/");for(let t=0;t<u.length;t++){const i=u[t];let a=40+(n.sensitive?.25:0);if(0===i.type)t||(r+="/"),r+=i.value.replace(ye,"\\$&"),a+=40;else if(1===i.type){const{value:e,repeatable:n,optional:o,regexp:l}=i;s.push({name:e,repeatable:n,optional:o});const d=l||me;if(d!==me){a+=10;try{new RegExp(`(${d})`)}catch(c){throw new Error(`Invalid custom RegExp for param "${e}" (${d}): `+c.message)}}let h=n?`((?:${d})(?:/(?:${d}))*)`:`(${d})`;t||(h=o&&u.length<2?`(?:/${h})`:"/"+h),o&&(h+="?"),r+=h,a+=20,o&&(a+=-8),n&&(a+=-20),".*"===d&&(a+=-50)}e.push(a)}i.push(e)}if(n.strict&&n.end){const e=i.length-1;i[e][i[e].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const a=new RegExp(r,n.sensitive?"":"i");function o(e){const t=e.match(a),n={};if(!t)return null;for(let i=1;i<t.length;i++){const e=t[i]||"",r=s[i-1];n[r.name]=e&&r.repeatable?e.split("/"):e}return n}function l(t){let n="",i=!1;for(const r of e){i&&n.endsWith("/")||(n+="/"),i=!1;for(const e of r)if(0===e.type)n+=e.value;else if(1===e.type){const{value:s,repeatable:a,optional:o}=e,u=s in t?t[s]:"";if(d(u)&&!a)throw new Error(`Provided param "${s}" is an array but it is not repeatable (* or + modifiers)`);const l=d(u)?u.join("/"):u;if(!l){if(!o)throw new Error(`Missing required param "${s}"`);r.length<2&&(n.endsWith("/")?n=n.slice(0,-1):i=!0)}n+=l}}return n||"/"}return{re:a,score:i,keys:s,parse:o,stringify:l}}function Te(e,t){let n=0;while(n<e.length&&n<t.length){const i=t[n]-e[n];if(i)return i;n++}return e.length<t.length?1===e.length&&80===e[0]?-1:1:e.length>t.length?1===t.length&&80===t[0]?1:-1:0}function Se(e,t){let n=0;const i=e.score,r=t.score;while(n<i.length&&n<r.length){const e=Te(i[n],r[n]);if(e)return e;n++}if(1===Math.abs(r.length-i.length)){if(Ee(i))return 1;if(Ee(r))return-1}return r.length-i.length}function Ee(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const we={type:0,value:""},Ae=/[a-zA-Z0-9_]/;function xe(e){if(!e)return[[]];if("/"===e)return[[we]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(e){throw new Error(`ERR (${n})/"${l}": ${e}`)}let n=0,i=n;const r=[];let s;function a(){s&&r.push(s),s=[]}let o,u=0,l="",c="";function d(){l&&(0===n?s.push({type:0,value:l}):1===n||2===n||3===n?(s.length>1&&("*"===o||"+"===o)&&t(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:l,regexp:c,repeatable:"*"===o||"+"===o,optional:"*"===o||"?"===o})):t("Invalid state to consume buffer"),l="")}function h(){l+=o}while(u<e.length)if(o=e[u++],"\\"!==o||2===n)switch(n){case 0:"/"===o?(l&&d(),a()):":"===o?(d(),n=1):h();break;case 4:h(),n=i;break;case 1:"("===o?n=2:Ae.test(o)?h():(d(),n=0,"*"!==o&&"?"!==o&&"+"!==o&&u--);break;case 2:")"===o?"\\"==c[c.length-1]?c=c.slice(0,-1)+o:n=3:c+=o;break;case 3:d(),n=0,"*"!==o&&"?"!==o&&"+"!==o&&u--,c="";break;default:t("Unknown state");break}else i=n,n=4;return 2===n&&t(`Unfinished custom RegExp for param "${l}"`),d(),a(),r}function Ie(e,t,n){const i=be(xe(e.path),n);const r=u(i,{record:e,parent:t,children:[],alias:[]});return t&&!r.record.aliasOf===!t.record.aliasOf&&t.children.push(r),r}function ke(e,t){const n=[],i=new Map;function r(e){return i.get(e)}function s(e,n,i){const r=!i,o=Re(e);o.aliasOf=i&&i.record;const d=Pe(t,e),h=[o];if("alias"in e){const t="string"===typeof e.alias?[e.alias]:e.alias;for(const e of t)h.push(Re(u({},o,{components:i?i.record.components:o.components,path:e,aliasOf:i?i.record:o})))}let f,p;for(const t of h){const{path:u}=t;if(n&&"/"!==u[0]){const e=n.record.path,i="/"===e[e.length-1]?"":"/";t.path=n.record.path+(u&&i+u)}if(f=Ie(t,n,d),i?i.alias.push(f):(p=p||f,p!==f&&p.alias.push(f),r&&e.name&&!De(f)&&a(e.name)),Ne(f)&&l(f),o.children){const e=o.children;for(let t=0;t<e.length;t++)s(e[t],f,i&&i.children[t])}i=i||f}return p?()=>{a(p)}:c}function a(e){if(de(e)){const t=i.get(e);t&&(i.delete(e),n.splice(n.indexOf(t),1),t.children.forEach(a),t.alias.forEach(a))}else{const t=n.indexOf(e);t>-1&&(n.splice(t,1),e.record.name&&i.delete(e.record.name),e.children.forEach(a),e.alias.forEach(a))}}function o(){return n}function l(e){const t=_e(e,n);n.splice(t,0,e),e.record.name&&!De(e)&&i.set(e.record.name,e)}function d(e,t){let r,s,a,o={};if("name"in e&&e.name){if(r=i.get(e.name),!r)throw pe(1,{location:e});0,a=r.record.name,o=u(Le(t.params,r.keys.filter(e=>!e.optional).concat(r.parent?r.parent.keys.filter(e=>e.optional):[]).map(e=>e.name)),e.params&&Le(e.params,r.keys.map(e=>e.name))),s=r.stringify(o)}else if(null!=e.path)s=e.path,r=n.find(e=>e.re.test(s)),r&&(o=r.parse(s),a=r.record.name);else{if(r=t.name?i.get(t.name):n.find(e=>e.re.test(t.path)),!r)throw pe(1,{location:e,currentLocation:t});a=r.record.name,o=u({},t.params,e.params),s=r.stringify(o)}const l=[];let c=r;while(c)l.unshift(c.record),c=c.parent;return{name:a,path:s,params:o,matched:l,meta:Me(l)}}function h(){n.length=0,i.clear()}return t=Pe({strict:!1,end:!0,sensitive:!1},t),e.forEach(e=>s(e)),{addRoute:s,resolve:d,removeRoute:a,clearRoutes:h,getRoutes:o,getRecordMatcher:r}}function Le(e,t){const n={};for(const i of t)i in e&&(n[i]=e[i]);return n}function Re(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:Ce(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function Ce(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const i in e.components)t[i]="object"===typeof n?n[i]:n;return t}function De(e){while(e){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Me(e){return e.reduce((e,t)=>u(e,t.meta),{})}function Pe(e,t){const n={};for(const i in e)n[i]=i in t?t[i]:e[i];return n}function _e(e,t){let n=0,i=t.length;while(n!==i){const r=n+i>>1,s=Se(e,t[r]);s<0?i=r:n=r+1}const r=Oe(e);return r&&(i=t.lastIndexOf(r,i-1)),i}function Oe(e){let t=e;while(t=t.parent)if(Ne(t)&&0===Se(e,t))return t}function Ne({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Ue(e){const t={};if(""===e||"?"===e)return t;const n="?"===e[0],i=(n?e.slice(1):e).split("&");for(let r=0;r<i.length;++r){const e=i[r].replace(v," "),n=e.indexOf("="),s=M(n<0?e:e.slice(0,n)),a=n<0?null:M(e.slice(n+1));if(s in t){let e=t[s];d(e)||(e=t[s]=[e]),e.push(a)}else t[s]=a}return t}function Fe(e){let t="";for(let n in e){const i=e[n];if(n=R(n),null==i){void 0!==i&&(t+=(t.length?"&":"")+n);continue}const r=d(i)?i.map(e=>e&&L(e)):[i&&L(i)];r.forEach(e=>{void 0!==e&&(t+=(t.length?"&":"")+n,null!=e&&(t+="="+e))})}return t}function Be(e){const t={};for(const n in e){const i=e[n];void 0!==i&&(t[n]=d(i)?i.map(e=>null==e?null:""+e):null==i?i:""+i)}return t}const je=Symbol(""),$e=Symbol(""),Ge=Symbol(""),Ve=Symbol(""),He=Symbol("");function Ke(){let e=[];function t(t){return e.push(t),()=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function We(e,t,n,i,r,s=e=>e()){const a=i&&(i.enterCallbacks[r]=i.enterCallbacks[r]||[]);return()=>new Promise((o,u)=>{const l=e=>{!1===e?u(pe(4,{from:n,to:t})):e instanceof Error?u(e):ce(e)?u(pe(2,{from:t,to:e})):(a&&i.enterCallbacks[r]===a&&"function"===typeof e&&a.push(e),o())},c=s(()=>e.call(i&&i.instances[r],t,n,l));let d=Promise.resolve(c);e.length<3&&(d=d.then(l)),d.catch(e=>u(e))})}function qe(e,t,n,i,r=e=>e()){const s=[];for(const u of e){0;for(const e in u.components){let l=u.components[e];if("beforeRouteEnter"===t||u.instances[e])if(a(l)){const a=l.__vccOpts||l,o=a[t];o&&s.push(We(o,n,i,u,e,r))}else{let a=l();0,s.push(()=>a.then(s=>{if(!s)throw new Error(`Couldn't resolve component "${e}" at "${u.path}"`);const a=o(s)?s.default:s;u.mods[e]=s,u.components[e]=a;const l=a.__vccOpts||a,c=l[t];return c&&We(c,n,i,u,e,r)()}))}}}return s}function Ye(e){const t=(0,i.WQ)(Ge),n=(0,i.WQ)(Ve);const s=(0,i.EW)(()=>{const n=(0,r.R1)(e.to);return t.resolve(n)}),a=(0,i.EW)(()=>{const{matched:e}=s.value,{length:t}=e,i=e[t-1],r=n.matched;if(!i||!r.length)return-1;const a=r.findIndex(B.bind(null,i));if(a>-1)return a;const o=et(e[t-2]);return t>1&&et(i)===o&&r[r.length-1].path!==o?r.findIndex(B.bind(null,e[t-2])):a}),o=(0,i.EW)(()=>a.value>-1&&Ze(n.params,s.value.params)),u=(0,i.EW)(()=>a.value>-1&&a.value===n.matched.length-1&&j(n.params,s.value.params));function l(n={}){if(Je(n)){const n=t[(0,r.R1)(e.replace)?"replace":"push"]((0,r.R1)(e.to)).catch(c);return e.viewTransition&&"undefined"!==typeof document&&"startViewTransition"in document&&document.startViewTransition(()=>n),n}return Promise.resolve()}return{route:s,href:(0,i.EW)(()=>s.value.href),isActive:o,isExactActive:u,navigate:l}}function ze(e){return 1===e.length?e[0]:e}const Xe=(0,i.pM)({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Ye,setup(e,{slots:t}){const n=(0,r.Kh)(Ye(e)),{options:s}=(0,i.WQ)(Ge),a=(0,i.EW)(()=>({[tt(e.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[tt(e.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const r=t.default&&ze(t.default(n));return e.custom?r:(0,i.h)("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:a.value},r)}}}),Qe=Xe;function Je(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&(void 0===e.button||0===e.button)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Ze(e,t){for(const n in t){const i=t[n],r=e[n];if("string"===typeof i){if(i!==r)return!1}else if(!d(r)||r.length!==i.length||i.some((e,t)=>e!==r[t]))return!1}return!0}function et(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const tt=(e,t,n)=>null!=e?e:null!=t?t:n,nt=(0,i.pM)({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const s=(0,i.WQ)(He),a=(0,i.EW)(()=>e.route||s.value),o=(0,i.WQ)($e,0),l=(0,i.EW)(()=>{let e=(0,r.R1)(o);const{matched:t}=a.value;let n;while((n=t[e])&&!n.components)e++;return e}),c=(0,i.EW)(()=>a.value.matched[l.value]);(0,i.Gt)($e,(0,i.EW)(()=>l.value+1)),(0,i.Gt)(je,c),(0,i.Gt)(He,a);const d=(0,r.KR)();return(0,i.wB)(()=>[d.value,c.value,e.name],([e,t,n],[i,r,s])=>{t&&(t.instances[n]=e,r&&r!==t&&e&&e===i&&(t.leaveGuards.size||(t.leaveGuards=r.leaveGuards),t.updateGuards.size||(t.updateGuards=r.updateGuards))),!e||!t||r&&B(t,r)&&i||(t.enterCallbacks[n]||[]).forEach(t=>t(e))},{flush:"post"}),()=>{const r=a.value,s=e.name,o=c.value,l=o&&o.components[s];if(!l)return it(n.default,{Component:l,route:r});const h=o.props[s],f=h?!0===h?r.params:"function"===typeof h?h(r):h:null,p=e=>{e.component.isUnmounted&&(o.instances[s]=null)},g=(0,i.h)(l,u({},f,t,{onVnodeUnmounted:p,ref:d}));return it(n.default,{Component:g,route:r})||g}}});function it(e,t){if(!e)return null;const n=e(t);return 1===n.length?n[0]:n}const rt=nt;function st(e){const t=ke(e.routes,e),n=e.parseQuery||Ue,a=e.stringifyQuery||Fe,o=e.history;const h=Ke(),f=Ke(),p=Ke(),g=(0,r.IJ)(H);let m=H;s&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const v=l.bind(null,e=>""+e),y=l.bind(null,D),b=l.bind(null,M);function T(e,n){let i,r;return de(e)?(i=t.getRecordMatcher(e),r=n):r=e,t.addRoute(r,i)}function S(e){const n=t.getRecordMatcher(e);n&&t.removeRoute(n)}function E(){return t.getRoutes().map(e=>e.record)}function w(e){return!!t.getRecordMatcher(e)}function A(e,i){if(i=u({},i||g.value),"string"===typeof e){const r=O(n,e,i.path),s=t.resolve({path:r.path},i),a=o.createHref(r.fullPath);return u(r,s,{params:b(s.params),hash:M(r.hash),redirectedFrom:void 0,href:a})}let r;if(null!=e.path)r=u({},e,{path:O(n,e.path,i.path).path});else{const t=u({},e.params);for(const e in t)null==t[e]&&delete t[e];r=u({},e,{params:y(t)}),i.params=y(i.params)}const s=t.resolve(r,i),l=e.hash||"";s.params=v(b(s.params));const c=N(a,u({},e,{hash:k(l),path:s.path})),d=o.createHref(c);return u({fullPath:c,hash:l,query:a===Fe?Be(e.query):e.query||{}},s,{redirectedFrom:void 0,href:d})}function x(e){return"string"===typeof e?O(n,e,g.value.path):u({},e)}function I(e,t){if(m!==e)return pe(8,{from:t,to:e})}function L(e){return P(e)}function R(e){return L(u(x(e),{replace:!0}))}function C(e){const t=e.matched[e.matched.length-1];if(t&&t.redirect){const{redirect:n}=t;let i="function"===typeof n?n(e):n;return"string"===typeof i&&(i=i.includes("?")||i.includes("#")?i=x(i):{path:i},i.params={}),u({query:e.query,hash:e.hash,params:null!=i.path?{}:e.params},i)}}function P(e,t){const n=m=A(e),i=g.value,r=e.state,s=e.force,o=!0===e.replace,l=C(n);if(l)return P(u(x(l),{state:"object"===typeof l?u({},r,l.state):r,force:s,replace:o}),t||n);const c=n;let d;return c.redirectedFrom=t,!s&&F(a,i,n)&&(d=pe(16,{to:c,from:i}),ie(i,i,!0,!1)),(d?Promise.resolve(d):B(c,i)).catch(e=>ge(e)?ge(e,2)?e:ee(e):z(e,c,i)).then(e=>{if(e){if(ge(e,2))return P(u({replace:o},x(e.to),{state:"object"===typeof e.to?u({},r,e.to.state):r,force:s}),t||c)}else e=$(c,i,!0,o,r);return j(c,i,e),e})}function _(e,t){const n=I(e,t);return n?Promise.reject(n):Promise.resolve()}function U(e){const t=ae.values().next().value;return t&&"function"===typeof t.runWithContext?t.runWithContext(e):e()}function B(e,t){let n;const[i,r,s]=at(e,t);n=qe(i.reverse(),"beforeRouteLeave",e,t);for(const o of i)o.leaveGuards.forEach(i=>{n.push(We(i,e,t))});const a=_.bind(null,e,t);return n.push(a),ue(n).then(()=>{n=[];for(const i of h.list())n.push(We(i,e,t));return n.push(a),ue(n)}).then(()=>{n=qe(r,"beforeRouteUpdate",e,t);for(const i of r)i.updateGuards.forEach(i=>{n.push(We(i,e,t))});return n.push(a),ue(n)}).then(()=>{n=[];for(const i of s)if(i.beforeEnter)if(d(i.beforeEnter))for(const r of i.beforeEnter)n.push(We(r,e,t));else n.push(We(i.beforeEnter,e,t));return n.push(a),ue(n)}).then(()=>(e.matched.forEach(e=>e.enterCallbacks={}),n=qe(s,"beforeRouteEnter",e,t,U),n.push(a),ue(n))).then(()=>{n=[];for(const i of f.list())n.push(We(i,e,t));return n.push(a),ue(n)}).catch(e=>ge(e,8)?e:Promise.reject(e))}function j(e,t,n){p.list().forEach(i=>U(()=>i(e,t,n)))}function $(e,t,n,i,r){const a=I(e,t);if(a)return a;const l=t===H,c=s?history.state:{};n&&(i||l?o.replace(e.fullPath,u({scroll:l&&c&&c.scroll},r)):o.push(e.fullPath,r)),g.value=e,ie(e,t,n,l),ee()}let G;function V(){G||(G=o.listen((e,t,n)=>{if(!oe.listening)return;const i=A(e),r=C(i);if(r)return void P(u(r,{replace:!0,force:!0}),i).catch(c);m=i;const a=g.value;s&&te(Z(a.fullPath,n.delta),Q()),B(i,a).catch(e=>ge(e,12)?e:ge(e,2)?(P(u(x(e.to),{force:!0}),i).then(e=>{ge(e,20)&&!n.delta&&n.type===K.pop&&o.go(-1,!1)}).catch(c),Promise.reject()):(n.delta&&o.go(-n.delta,!1),z(e,i,a))).then(e=>{e=e||$(i,a,!1),e&&(n.delta&&!ge(e,8)?o.go(-n.delta,!1):n.type===K.pop&&ge(e,20)&&o.go(-1,!1)),j(i,a,e)}).catch(c)}))}let W,q=Ke(),Y=Ke();function z(e,t,n){ee(e);const i=Y.list();return i.length?i.forEach(i=>i(e,t,n)):console.error(e),Promise.reject(e)}function X(){return W&&g.value!==H?Promise.resolve():new Promise((e,t)=>{q.add([e,t])})}function ee(e){return W||(W=!e,V(),q.list().forEach(([t,n])=>e?n(e):t()),q.reset()),e}function ie(t,n,r,a){const{scrollBehavior:o}=e;if(!s||!o)return Promise.resolve();const u=!r&&ne(Z(t.fullPath,0))||(a||!r)&&history.state&&history.state.scroll||null;return(0,i.dY)().then(()=>o(t,n,u)).then(e=>e&&J(e)).catch(e=>z(e,t,n))}const re=e=>o.go(e);let se;const ae=new Set,oe={currentRoute:g,listening:!0,addRoute:T,removeRoute:S,clearRoutes:t.clearRoutes,hasRoute:w,getRoutes:E,resolve:A,options:e,push:L,replace:R,go:re,back:()=>re(-1),forward:()=>re(1),beforeEach:h.add,beforeResolve:f.add,afterEach:p.add,onError:Y.add,isReady:X,install(e){const t=this;e.component("RouterLink",Qe),e.component("RouterView",rt),e.config.globalProperties.$router=t,Object.defineProperty(e.config.globalProperties,"$route",{enumerable:!0,get:()=>(0,r.R1)(g)}),s&&!se&&g.value===H&&(se=!0,L(o.location).catch(e=>{0}));const n={};for(const r in H)Object.defineProperty(n,r,{get:()=>g.value[r],enumerable:!0});e.provide(Ge,t),e.provide(Ve,(0,r.Gc)(n)),e.provide(He,g);const i=e.unmount;ae.add(e),e.unmount=function(){ae.delete(e),ae.size<1&&(m=H,G&&G(),G=null,g.value=H,se=!1,W=!1),i()}}};function ue(e){return e.reduce((e,t)=>e.then(()=>U(t)),Promise.resolve())}return oe}function at(e,t){const n=[],i=[],r=[],s=Math.max(t.matched.length,e.matched.length);for(let a=0;a<s;a++){const s=t.matched[a];s&&(e.matched.find(e=>B(e,s))?i.push(s):n.push(s));const o=e.matched[a];o&&(t.matched.find(e=>B(e,o))||r.push(o))}return[n,i,r]}function ot(){return(0,i.WQ)(Ge)}function ut(e){return(0,i.WQ)(Ve)}},1510:function(e,t,n){"use strict";n.d(t,{KpY:function(){return b}});n(4114),n(8111),n(1148),n(2489),n(116),n(531),n(7588),n(1701),n(8237),n(3579),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698),n(9577),n(4979);var i=n(144),r=n(6768);function s(e){return!!(0,i.o5)()&&((0,i.jr)(e),!0)}const a="undefined"!==typeof window&&"undefined"!==typeof document,o=("undefined"!==typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope),Object.prototype.toString),u=e=>"[object Object]"===o.call(e);function l(e){return Array.isArray(e)?e:[e]}function c(e){const t=Object.create(null);return n=>{const i=t[n];return i||(t[n]=e(n))}}const d=/\B([A-Z])/g,h=(c(e=>e.replace(d,"-$1").toLowerCase()),/-(\w)/g);c(e=>e.replace(h,(e,t)=>t?t.toUpperCase():""));function f(e,t,n){return(0,r.wB)(e,t,{...n,immediate:!0})}const p=a?window:void 0;a&&window.document,a&&window.navigator,a&&window.location;function g(e){var t;const n=(0,i.BA)(e);return null!=(t=null==n?void 0:n.$el)?t:n}function m(...e){const t=[],n=()=>{t.forEach(e=>e()),t.length=0},a=(e,t,n,i)=>(e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)),o=(0,r.EW)(()=>{const t=l((0,i.BA)(e[0])).filter(e=>null!=e);return t.every(e=>"string"!==typeof e)?t:void 0}),c=f(()=>{var t,n;return[null!=(n=null==(t=o.value)?void 0:t.map(e=>g(e)))?n:[p].filter(e=>null!=e),l((0,i.BA)(o.value?e[1]:e[0])),l((0,i.R1)(o.value?e[2]:e[1])),(0,i.BA)(o.value?e[3]:e[2])]},([e,i,r,s])=>{if(n(),!(null==e?void 0:e.length)||!(null==i?void 0:i.length)||!(null==r?void 0:r.length))return;const o=u(s)?{...s}:s;t.push(...e.flatMap(e=>i.flatMap(t=>r.map(n=>a(e,t,n,o)))))},{flush:"post"}),d=()=>{c(),n()};return s(n),d}function v(){const e=(0,i.IJ)(!1),t=(0,r.nI)();return t&&(0,r.sV)(()=>{e.value=!0},t),e}function y(e){const t=v();return(0,r.EW)(()=>(t.value,Boolean(e())))}Symbol("vueuse-ssr-width");"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self&&self;function b(e={}){const{window:t=p}=e,n=y(()=>t&&"screen"in t&&"orientation"in t.screen),r=n.value?t.screen.orientation:{},s=(0,i.KR)(r.type),a=(0,i.IJ)(r.angle||0);n.value&&m(t,"orientationchange",()=>{s.value=r.type,a.value=r.angle},{passive:!0});const o=e=>n.value&&"function"===typeof r.lock?r.lock(e):Promise.reject(new Error("Not supported")),u=()=>{n.value&&"function"===typeof r.unlock&&r.unlock()};return{isSupported:n,orientation:s,angle:a,lockOrientation:o,unlockOrientation:u}}Number.POSITIVE_INFINITY},1625:function(e,t,n){"use strict";var i=n(9504);e.exports=i({}.isPrototypeOf)},1698:function(e,t,n){"use strict";var i=n(6518),r=n(4204),s=n(9835),a=n(4916),o=!a("union")||!s("union");i({target:"Set",proto:!0,real:!0,forced:o},{union:r})},1701:function(e,t,n){"use strict";var i=n(6518),r=n(9565),s=n(9306),a=n(8551),o=n(1767),u=n(9462),l=n(6319),c=n(9539),d=n(684),h=n(4549),f=n(6395),p=!f&&!d("map",function(){}),g=!f&&!p&&h("map",TypeError),m=f||p||g,v=u(function(){var e=this.iterator,t=a(r(this.next,e)),n=this.done=!!t.done;if(!n)return l(e,this.mapper,[t.value,this.counter++],!0)});i({target:"Iterator",proto:!0,real:!0,forced:m},{map:function(e){a(this);try{s(e)}catch(t){c(this,"throw",t)}return g?r(g,this,e):new v(o(this),{mapper:e})}})},1712:function(e,t,n){"use strict";n.d(t,{m:function(){return u}});var i=n(3883),r=n(4156),s=n(2436),a=n(4068);function o(e,t){const n=(0,a.a)(e,t?.in);return n.setHours(0,0,0,0),n}function u(e,t,n){const[a,u]=(0,r.x)(n?.in,e,t),l=o(a),c=o(u),d=+l-(0,i.G)(l),h=+c-(0,i.G)(c);return Math.round((d-h)/s.w4)}},1767:function(e){"use strict";e.exports=function(e){return{iterator:e,next:e.next,done:!1}}},1806:function(e,t,n){"use strict";var i=n(6518),r=n(8551),s=n(2652),a=n(1767),o=[].push;i({target:"Iterator",proto:!0,real:!0},{toArray:function(){var e=[];return s(a(r(this)),o,{that:e,IS_RECORD:!0}),e}})},1828:function(e,t,n){"use strict";var i=n(9504),r=n(9297),s=n(5397),a=n(9617).indexOf,o=n(421),u=i([].push);e.exports=function(e,t){var n,i=s(e),l=0,c=[];for(n in i)!r(o,n)&&r(i,n)&&u(c,n);while(t.length>l)r(i,n=t[l++])&&(~a(c,n)||u(c,n));return c}},2106:function(e,t,n){"use strict";var i=n(283),r=n(4913);e.exports=function(e,t,n){return n.get&&i(n.get,t,{getter:!0}),n.set&&i(n.set,t,{setter:!0}),r.f(e,t,n)}},2140:function(e,t,n){"use strict";var i=n(8227),r=i("toStringTag"),s={};s[r]="z",e.exports="[object z]"===String(s)},2195:function(e,t,n){"use strict";var i=n(9504),r=i({}.toString),s=i("".slice);e.exports=function(e){return s(r(e),8,-1)}},2211:function(e,t,n){"use strict";var i=n(9039);e.exports=!i(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})},2360:function(e,t,n){"use strict";var i,r=n(8551),s=n(6801),a=n(8727),o=n(421),u=n(397),l=n(4055),c=n(6119),d=">",h="<",f="prototype",p="script",g=c("IE_PROTO"),m=function(){},v=function(e){return h+p+d+e+h+"/"+p+d},y=function(e){e.write(v("")),e.close();var t=e.parentWindow.Object;return e=null,t},b=function(){var e,t=l("iframe"),n="java"+p+":";return t.style.display="none",u.appendChild(t),t.src=String(n),e=t.contentWindow.document,e.open(),e.write(v("document.F=Object")),e.close(),e.F},T=function(){try{i=new ActiveXObject("htmlfile")}catch(t){}T="undefined"!=typeof document?document.domain&&i?y(i):b():y(i);var e=a.length;while(e--)delete T[f][a[e]];return T()};o[g]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(m[f]=r(e),n=new m,m[f]=null,n[g]=e):n=T(),void 0===t?n:s.f(n,t)}},2436:function(e,t,n){"use strict";n.d(t,{F6:function(){return a},Nw:function(){return s},_P:function(){return o},my:function(){return i},w4:function(){return r}});Math.pow(10,8);const i=6048e5,r=864e5,s=43200,a=1440,o=Symbol.for("constructDateFrom")},2475:function(e,t,n){"use strict";var i=n(6518),r=n(8527),s=n(4916),a=!s("isSupersetOf",function(e){return!e});i({target:"Set",proto:!0,real:!0,forced:a},{isSupersetOf:r})},2489:function(e,t,n){"use strict";var i=n(6518),r=n(9565),s=n(9306),a=n(8551),o=n(1767),u=n(9462),l=n(6319),c=n(6395),d=n(9539),h=n(684),f=n(4549),p=!c&&!h("filter",function(){}),g=!c&&!p&&f("filter",TypeError),m=c||p||g,v=u(function(){var e,t,n,i=this.iterator,s=this.predicate,o=this.next;while(1){if(e=a(r(o,i)),t=this.done=!!e.done,t)return;if(n=e.value,l(i,s,[n,this.counter++],!0))return n}});i({target:"Iterator",proto:!0,real:!0,forced:m},{filter:function(e){a(this);try{s(e)}catch(t){d(this,"throw",t)}return g?r(g,this,e):new v(o(this),{predicate:e})}})},2529:function(e){"use strict";e.exports=function(e,t){return{value:e,done:t}}},2603:function(e,t,n){"use strict";var i=n(655);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:i(e)}},2652:function(e,t,n){"use strict";var i=n(6080),r=n(9565),s=n(8551),a=n(6823),o=n(4209),u=n(6198),l=n(1625),c=n(81),d=n(851),h=n(9539),f=TypeError,p=function(e,t){this.stopped=e,this.result=t},g=p.prototype;e.exports=function(e,t,n){var m,v,y,b,T,S,E,w=n&&n.that,A=!(!n||!n.AS_ENTRIES),x=!(!n||!n.IS_RECORD),I=!(!n||!n.IS_ITERATOR),k=!(!n||!n.INTERRUPTED),L=i(t,w),R=function(e){return m&&h(m,"normal"),new p(!0,e)},C=function(e){return A?(s(e),k?L(e[0],e[1],R):L(e[0],e[1])):k?L(e,R):L(e)};if(x)m=e.iterator;else if(I)m=e;else{if(v=d(e),!v)throw new f(a(e)+" is not iterable");if(o(v)){for(y=0,b=u(e);b>y;y++)if(T=C(e[y]),T&&l(g,T))return T;return new p(!1)}m=c(e,v)}S=x?e.next:m.next;while(!(E=r(S,m)).done){try{T=C(E.value)}catch(D){h(m,"throw",D)}if("object"==typeof T&&T&&l(g,T))return T}return new p(!1)}},2777:function(e,t,n){"use strict";var i=n(9565),r=n(34),s=n(757),a=n(5966),o=n(4270),u=n(8227),l=TypeError,c=u("toPrimitive");e.exports=function(e,t){if(!r(e)||s(e))return e;var n,u=a(e,c);if(u){if(void 0===t&&(t="default"),n=i(u,e,t),!r(n)||s(n))return n;throw new l("Can't convert object to primitive value")}return void 0===t&&(t="number"),o(e,t)}},2787:function(e,t,n){"use strict";var i=n(9297),r=n(4901),s=n(8981),a=n(6119),o=n(2211),u=a("IE_PROTO"),l=Object,c=l.prototype;e.exports=o?l.getPrototypeOf:function(e){var t=s(e);if(i(t,u))return t[u];var n=t.constructor;return r(n)&&t instanceof n?n.prototype:t instanceof l?c:null}},2796:function(e,t,n){"use strict";var i=n(9039),r=n(4901),s=/#|\.prototype\./,a=function(e,t){var n=u[o(e)];return n===c||n!==l&&(r(t)?i(t):!!t)},o=a.normalize=function(e){return String(e).replace(s,".").toLowerCase()},u=a.data={},l=a.NATIVE="N",c=a.POLYFILL="P";e.exports=a},2812:function(e){"use strict";var t=TypeError;e.exports=function(e,n){if(e<n)throw new t("Not enough arguments");return e}},2839:function(e,t,n){"use strict";var i=n(4576),r=i.navigator,s=r&&r.userAgent;e.exports=s?String(s):""},2967:function(e,t,n){"use strict";var i=n(6706),r=n(34),s=n(7750),a=n(3506);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{e=i(Object.prototype,"__proto__","set"),e(n,[]),t=n instanceof Array}catch(o){}return function(n,i){return s(n),a(i),r(n)?(t?e(n,i):n.__proto__=i,n):n}}():void 0)},3066:function(e,t,n){"use strict";n.d(t,{B:function(){return y}});var i=n(8541),r=n(9369),s=n(3883),a=n(4156),o=n(4068);function u(e,t){const n=+(0,o.a)(e)-+(0,o.a)(t);return n<0?-1:n>0?1:n}var l=n(2436);function c(e,t,n){const[i,r]=(0,a.x)(n?.in,e,t),s=i.getFullYear()-r.getFullYear(),o=i.getMonth()-r.getMonth();return 12*s+o}function d(e,t){const n=(0,o.a)(e,t?.in);return n.setHours(23,59,59,999),n}function h(e,t){const n=(0,o.a)(e,t?.in),i=n.getMonth();return n.setFullYear(n.getFullYear(),i+1,0),n.setHours(23,59,59,999),n}function f(e,t){const n=(0,o.a)(e,t?.in);return+d(n,t)===+h(n,t)}function p(e,t,n){const[i,r,s]=(0,a.x)(n?.in,e,e,t),o=u(r,s),l=Math.abs(c(r,s));if(l<1)return 0;1===r.getMonth()&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-o*l);let d=u(r,s)===-o;f(i)&&1===l&&1===u(i,s)&&(d=!1);const h=o*(l-+d);return 0===h?0:h}function g(e){return t=>{const n=e?Math[e]:Math.trunc,i=n(t);return 0===i?0:i}}function m(e,t){return+(0,o.a)(e)-+(0,o.a)(t)}function v(e,t,n){const i=m(e,t)/1e3;return g(n?.roundingMethod)(i)}function y(e,t,n){const o=(0,r.q)(),c=n?.locale??o.locale??i.c,d=2520,h=u(e,t);if(isNaN(h))throw new RangeError("Invalid time value");const f=Object.assign({},n,{addSuffix:n?.addSuffix,comparison:h}),[g,m]=(0,a.x)(n?.in,...h>0?[t,e]:[e,t]),y=v(m,g),b=((0,s.G)(m)-(0,s.G)(g))/1e3,T=Math.round((y-b)/60);let S;if(T<2)return n?.includeSeconds?y<5?c.formatDistance("lessThanXSeconds",5,f):y<10?c.formatDistance("lessThanXSeconds",10,f):y<20?c.formatDistance("lessThanXSeconds",20,f):y<40?c.formatDistance("halfAMinute",0,f):y<60?c.formatDistance("lessThanXMinutes",1,f):c.formatDistance("xMinutes",1,f):0===T?c.formatDistance("lessThanXMinutes",1,f):c.formatDistance("xMinutes",T,f);if(T<45)return c.formatDistance("xMinutes",T,f);if(T<90)return c.formatDistance("aboutXHours",1,f);if(T<l.F6){const e=Math.round(T/60);return c.formatDistance("aboutXHours",e,f)}if(T<d)return c.formatDistance("xDays",1,f);if(T<l.Nw){const e=Math.round(T/l.F6);return c.formatDistance("xDays",e,f)}if(T<2*l.Nw)return S=Math.round(T/l.Nw),c.formatDistance("aboutXMonths",S,f);if(S=p(m,g),S<12){const e=Math.round(T/l.Nw);return c.formatDistance("xMonths",e,f)}{const e=S%12,t=Math.trunc(S/12);return e<3?c.formatDistance("aboutXYears",t,f):e<9?c.formatDistance("overXYears",t,f):c.formatDistance("almostXYears",t+1,f)}}},3167:function(e,t,n){"use strict";var i=n(4901),r=n(34),s=n(2967);e.exports=function(e,t,n){var a,o;return s&&i(a=t.constructor)&&a!==n&&r(o=a.prototype)&&o!==n.prototype&&s(e,o),e}},3392:function(e,t,n){"use strict";var i=n(9504),r=0,s=Math.random(),a=i(1.1.toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++r+s,36)}},3440:function(e,t,n){"use strict";var i=n(7080),r=n(4402),s=n(9286),a=n(5170),o=n(3789),u=n(8469),l=n(507),c=r.has,d=r.remove;e.exports=function(e){var t=i(this),n=o(e),r=s(t);return a(t)<=n.size?u(t,function(e){n.includes(e)&&d(r,e)}):l(n.getIterator(),function(e){c(r,e)&&d(r,e)}),r}},3506:function(e,t,n){"use strict";var i=n(3925),r=String,s=TypeError;e.exports=function(e){if(i(e))return e;throw new s("Can't set "+r(e)+" as a prototype")}},3579:function(e,t,n){"use strict";var i=n(6518),r=n(9565),s=n(2652),a=n(9306),o=n(8551),u=n(1767),l=n(9539),c=n(4549),d=c("some",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:d},{some:function(e){o(this);try{a(e)}catch(i){l(this,"throw",i)}if(d)return r(d,this,e);var t=u(this),n=0;return s(t,function(t,i){if(e(t,n++))return i()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},3650:function(e,t,n){"use strict";var i=n(7080),r=n(4402),s=n(9286),a=n(3789),o=n(507),u=r.add,l=r.has,c=r.remove;e.exports=function(e){var t=i(this),n=a(e).getIterator(),r=s(t);return o(n,function(e){l(t,e)?c(r,e):u(r,e)}),r}},3706:function(e,t,n){"use strict";var i=n(9504),r=n(4901),s=n(7629),a=i(Function.toString);r(s.inspectSource)||(s.inspectSource=function(e){return a(e)}),e.exports=s.inspectSource},3717:function(e,t){"use strict";t.f=Object.getOwnPropertySymbols},3724:function(e,t,n){"use strict";var i=n(9039);e.exports=!i(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},3789:function(e,t,n){"use strict";var i=n(9306),r=n(8551),s=n(9565),a=n(1291),o=n(1767),u="Invalid size",l=RangeError,c=TypeError,d=Math.max,h=function(e,t){this.set=e,this.size=d(t,0),this.has=i(e.has),this.keys=i(e.keys)};h.prototype={getIterator:function(){return o(r(s(this.keys,this.set)))},includes:function(e){return s(this.has,this.set,e)}},e.exports=function(e){r(e);var t=+e.size;if(t!==t)throw new c(u);var n=a(t);if(n<0)throw new l(u);return new h(e,n)}},3838:function(e,t,n){"use strict";var i=n(7080),r=n(5170),s=n(8469),a=n(3789);e.exports=function(e){var t=i(this),n=a(e);return!(r(t)>n.size)&&!1!==s(t,function(e){if(!n.includes(e))return!1},!0)}},3853:function(e,t,n){"use strict";var i=n(6518),r=n(4449),s=n(4916),a=!s("isDisjointFrom",function(e){return!e});i({target:"Set",proto:!0,real:!0,forced:a},{isDisjointFrom:r})},3883:function(e,t,n){"use strict";n.d(t,{G:function(){return r}});var i=n(4068);function r(e){const t=(0,i.a)(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}},3925:function(e,t,n){"use strict";var i=n(34);e.exports=function(e){return i(e)||null===e}},4004:function(e,t,n){"use strict";n.d(t,{Ay:function(){return Wl}});n(4114),n(8111),n(2489),n(116),n(7588),n(1701),n(8237),n(3579),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698),n(9577),n(4979);const i=Number.isFinite||function(e){return"number"===typeof e&&isFinite(e)},r=Number.isSafeInteger||function(e){return"number"===typeof e&&Math.abs(e)<=s},s=Number.MAX_SAFE_INTEGER||9007199254740991;let a=function(e){return e["NETWORK_ERROR"]="networkError",e["MEDIA_ERROR"]="mediaError",e["KEY_SYSTEM_ERROR"]="keySystemError",e["MUX_ERROR"]="muxError",e["OTHER_ERROR"]="otherError",e}({}),o=function(e){return e["KEY_SYSTEM_NO_KEYS"]="keySystemNoKeys",e["KEY_SYSTEM_NO_ACCESS"]="keySystemNoAccess",e["KEY_SYSTEM_NO_SESSION"]="keySystemNoSession",e["KEY_SYSTEM_NO_CONFIGURED_LICENSE"]="keySystemNoConfiguredLicense",e["KEY_SYSTEM_LICENSE_REQUEST_FAILED"]="keySystemLicenseRequestFailed",e["KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED"]="keySystemServerCertificateRequestFailed",e["KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED"]="keySystemServerCertificateUpdateFailed",e["KEY_SYSTEM_SESSION_UPDATE_FAILED"]="keySystemSessionUpdateFailed",e["KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED"]="keySystemStatusOutputRestricted",e["KEY_SYSTEM_STATUS_INTERNAL_ERROR"]="keySystemStatusInternalError",e["KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR"]="keySystemDestroyMediaKeysError",e["KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR"]="keySystemDestroyCloseSessionError",e["KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR"]="keySystemDestroyRemoveSessionError",e["MANIFEST_LOAD_ERROR"]="manifestLoadError",e["MANIFEST_LOAD_TIMEOUT"]="manifestLoadTimeOut",e["MANIFEST_PARSING_ERROR"]="manifestParsingError",e["MANIFEST_INCOMPATIBLE_CODECS_ERROR"]="manifestIncompatibleCodecsError",e["LEVEL_EMPTY_ERROR"]="levelEmptyError",e["LEVEL_LOAD_ERROR"]="levelLoadError",e["LEVEL_LOAD_TIMEOUT"]="levelLoadTimeOut",e["LEVEL_PARSING_ERROR"]="levelParsingError",e["LEVEL_SWITCH_ERROR"]="levelSwitchError",e["AUDIO_TRACK_LOAD_ERROR"]="audioTrackLoadError",e["AUDIO_TRACK_LOAD_TIMEOUT"]="audioTrackLoadTimeOut",e["SUBTITLE_LOAD_ERROR"]="subtitleTrackLoadError",e["SUBTITLE_TRACK_LOAD_TIMEOUT"]="subtitleTrackLoadTimeOut",e["FRAG_LOAD_ERROR"]="fragLoadError",e["FRAG_LOAD_TIMEOUT"]="fragLoadTimeOut",e["FRAG_DECRYPT_ERROR"]="fragDecryptError",e["FRAG_PARSING_ERROR"]="fragParsingError",e["FRAG_GAP"]="fragGap",e["REMUX_ALLOC_ERROR"]="remuxAllocError",e["KEY_LOAD_ERROR"]="keyLoadError",e["KEY_LOAD_TIMEOUT"]="keyLoadTimeOut",e["BUFFER_ADD_CODEC_ERROR"]="bufferAddCodecError",e["BUFFER_INCOMPATIBLE_CODECS_ERROR"]="bufferIncompatibleCodecsError",e["BUFFER_APPEND_ERROR"]="bufferAppendError",e["BUFFER_APPENDING_ERROR"]="bufferAppendingError",e["BUFFER_STALLED_ERROR"]="bufferStalledError",e["BUFFER_FULL_ERROR"]="bufferFullError",e["BUFFER_SEEK_OVER_HOLE"]="bufferSeekOverHole",e["BUFFER_NUDGE_ON_STALL"]="bufferNudgeOnStall",e["ASSET_LIST_LOAD_ERROR"]="assetListLoadError",e["ASSET_LIST_LOAD_TIMEOUT"]="assetListLoadTimeout",e["ASSET_LIST_PARSING_ERROR"]="assetListParsingError",e["INTERSTITIAL_ASSET_ITEM_ERROR"]="interstitialAssetItemError",e["INTERNAL_EXCEPTION"]="internalException",e["INTERNAL_ABORTED"]="aborted",e["ATTACH_MEDIA_ERROR"]="attachMediaError",e["UNKNOWN"]="unknown",e}({}),u=function(e){return e["MEDIA_ATTACHING"]="hlsMediaAttaching",e["MEDIA_ATTACHED"]="hlsMediaAttached",e["MEDIA_DETACHING"]="hlsMediaDetaching",e["MEDIA_DETACHED"]="hlsMediaDetached",e["MEDIA_ENDED"]="hlsMediaEnded",e["STALL_RESOLVED"]="hlsStallResolved",e["BUFFER_RESET"]="hlsBufferReset",e["BUFFER_CODECS"]="hlsBufferCodecs",e["BUFFER_CREATED"]="hlsBufferCreated",e["BUFFER_APPENDING"]="hlsBufferAppending",e["BUFFER_APPENDED"]="hlsBufferAppended",e["BUFFER_EOS"]="hlsBufferEos",e["BUFFERED_TO_END"]="hlsBufferedToEnd",e["BUFFER_FLUSHING"]="hlsBufferFlushing",e["BUFFER_FLUSHED"]="hlsBufferFlushed",e["MANIFEST_LOADING"]="hlsManifestLoading",e["MANIFEST_LOADED"]="hlsManifestLoaded",e["MANIFEST_PARSED"]="hlsManifestParsed",e["LEVEL_SWITCHING"]="hlsLevelSwitching",e["LEVEL_SWITCHED"]="hlsLevelSwitched",e["LEVEL_LOADING"]="hlsLevelLoading",e["LEVEL_LOADED"]="hlsLevelLoaded",e["LEVEL_UPDATED"]="hlsLevelUpdated",e["LEVEL_PTS_UPDATED"]="hlsLevelPtsUpdated",e["LEVELS_UPDATED"]="hlsLevelsUpdated",e["AUDIO_TRACKS_UPDATED"]="hlsAudioTracksUpdated",e["AUDIO_TRACK_SWITCHING"]="hlsAudioTrackSwitching",e["AUDIO_TRACK_SWITCHED"]="hlsAudioTrackSwitched",e["AUDIO_TRACK_LOADING"]="hlsAudioTrackLoading",e["AUDIO_TRACK_LOADED"]="hlsAudioTrackLoaded",e["AUDIO_TRACK_UPDATED"]="hlsAudioTrackUpdated",e["SUBTITLE_TRACKS_UPDATED"]="hlsSubtitleTracksUpdated",e["SUBTITLE_TRACKS_CLEARED"]="hlsSubtitleTracksCleared",e["SUBTITLE_TRACK_SWITCH"]="hlsSubtitleTrackSwitch",e["SUBTITLE_TRACK_LOADING"]="hlsSubtitleTrackLoading",e["SUBTITLE_TRACK_LOADED"]="hlsSubtitleTrackLoaded",e["SUBTITLE_TRACK_UPDATED"]="hlsSubtitleTrackUpdated",e["SUBTITLE_FRAG_PROCESSED"]="hlsSubtitleFragProcessed",e["CUES_PARSED"]="hlsCuesParsed",e["NON_NATIVE_TEXT_TRACKS_FOUND"]="hlsNonNativeTextTracksFound",e["INIT_PTS_FOUND"]="hlsInitPtsFound",e["FRAG_LOADING"]="hlsFragLoading",e["FRAG_LOAD_EMERGENCY_ABORTED"]="hlsFragLoadEmergencyAborted",e["FRAG_LOADED"]="hlsFragLoaded",e["FRAG_DECRYPTED"]="hlsFragDecrypted",e["FRAG_PARSING_INIT_SEGMENT"]="hlsFragParsingInitSegment",e["FRAG_PARSING_USERDATA"]="hlsFragParsingUserdata",e["FRAG_PARSING_METADATA"]="hlsFragParsingMetadata",e["FRAG_PARSED"]="hlsFragParsed",e["FRAG_BUFFERED"]="hlsFragBuffered",e["FRAG_CHANGED"]="hlsFragChanged",e["FPS_DROP"]="hlsFpsDrop",e["FPS_DROP_LEVEL_CAPPING"]="hlsFpsDropLevelCapping",e["MAX_AUTO_LEVEL_UPDATED"]="hlsMaxAutoLevelUpdated",e["ERROR"]="hlsError",e["DESTROYING"]="hlsDestroying",e["KEY_LOADING"]="hlsKeyLoading",e["KEY_LOADED"]="hlsKeyLoaded",e["LIVE_BACK_BUFFER_REACHED"]="hlsLiveBackBufferReached",e["BACK_BUFFER_REACHED"]="hlsBackBufferReached",e["STEERING_MANIFEST_LOADED"]="hlsSteeringManifestLoaded",e["ASSET_LIST_LOADING"]="hlsAssetListLoading",e["ASSET_LIST_LOADED"]="hlsAssetListLoaded",e["INTERSTITIALS_UPDATED"]="hlsInterstitialsUpdated",e["INTERSTITIALS_BUFFERED_TO_BOUNDARY"]="hlsInterstitialsBufferedToBoundary",e["INTERSTITIAL_ASSET_PLAYER_CREATED"]="hlsInterstitialAssetPlayerCreated",e["INTERSTITIAL_STARTED"]="hlsInterstitialStarted",e["INTERSTITIAL_ASSET_STARTED"]="hlsInterstitialAssetStarted",e["INTERSTITIAL_ASSET_ENDED"]="hlsInterstitialAssetEnded",e["INTERSTITIAL_ASSET_ERROR"]="hlsInterstitialAssetError",e["INTERSTITIAL_ENDED"]="hlsInterstitialEnded",e["INTERSTITIALS_PRIMARY_RESUMED"]="hlsInterstitialsPrimaryResumed",e["PLAYOUT_LIMIT_REACHED"]="hlsPlayoutLimitReached",e["EVENT_CUE_ENTER"]="hlsEventCueEnter",e}({});var l={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},c={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class d{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class h{constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new d(e),this.fast_=new d(t),this.defaultTTFB_=i,this.ttfb_=new d(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:r}=this;n.halfLife!==e&&(this.slow_=new d(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new d(t,i.getEstimate(),i.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new d(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,i=e/1e3,r=n/i;this.fast_.sample(i,r),this.slow_.sample(i,r)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function f(e,t,n){return(t=y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},p.apply(null,arguments)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){f(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function v(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function y(e){var t=v(e,"string");return"symbol"==typeof t?t:t+""}class b{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const n=`[${e}]:`;this.trace=T,this.debug=t.debug.bind(null,n),this.log=t.log.bind(null,n),this.warn=t.warn.bind(null,n),this.info=t.info.bind(null,n),this.error=t.error.bind(null,n)}}const T=function(){},S={trace:T,debug:T,log:T,warn:T,info:T,error:T};function E(){return p({},S)}function w(e,t){const n=self.console[e];return n?n.bind(self.console,`${t?"["+t+"] ":""}[${e}] >`):T}function A(e,t,n){return t[e]?t[e].bind(t):w(e,n)}const x=E();function I(e,t,n){const i=E();if("object"===typeof console&&!0===e||"object"===typeof e){const s=["debug","log","info","warn","error"];s.forEach(t=>{i[t]=A(t,e,n)});try{i.log(`Debug logs enabled for "${t}" in hls.js version 1.6.5`)}catch(r){return E()}s.forEach(t=>{x[t]=A(t,e)})}else p(x,i);return i}const k=x;function L(e=!0){if("undefined"===typeof self)return;const t=(e||!self.MediaSource)&&self.ManagedMediaSource;return t||self.MediaSource||self.WebKitMediaSource}function R(e){return"undefined"!==typeof self&&e===self.ManagedMediaSource}function C(e,t){const n=Object.keys(e),i=Object.keys(t),r=n.length,s=i.length;return!r||!s||r===s&&!n.some(e=>-1===i.indexOf(e))}function D(e,t=!1){if("undefined"!==typeof TextDecoder){const n=new TextDecoder("utf-8"),i=n.decode(e);if(t){const e=i.indexOf("\0");return-1!==e?i.substring(0,e):i}return i.replace(/\0/g,"")}const n=e.length;let i,r,s,a="",o=0;while(o<n){if(i=e[o++],0===i&&t)return a;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:r=e[o++],a+=String.fromCharCode((31&i)<<6|63&r);break;case 14:r=e[o++],s=e[o++],a+=String.fromCharCode((15&i)<<12|(63&r)<<6|63&s);break}}return a}const M={hexDump:function(e){let t="";for(let n=0;n<e.length;n++){let i=e[n].toString(16);i.length<2&&(i="0"+i),t+=i}return t}};function P(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}var _,O={exports:{}};function N(){return _||(_=1,function(e){(function(){var t=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,r=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),t=t.trim(),!t){if(!i.alwaysNormalize)return e;var r=s.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=s.normalizePath(r.path),s.buildURLFromParts(r)}var a=s.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o=s.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var u=n.exec(o.path);o.netLoc=u[1],o.path=u[2]}o.netLoc&&!o.path&&(o.path="/");var l={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(l.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;l.path=s.normalizePath(d)}else l.path=o.path,a.params||(l.params=o.params,a.query||(l.query=o.query));return null===l.path&&(l.path=i.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(l)},parseURL:function(e){var n=t.exec(e);return n?{scheme:n[1]||"",netLoc:n[2]||"",path:n[3]||"",params:n[4]||"",query:n[5]||"",fragment:n[6]||""}:null},normalizePath:function(e){e=e.split("").reverse().join("").replace(i,"");while(e.length!==(e=e.replace(r,"")).length);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=s})()}(O)),O.exports}var U=N();class F{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var B={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class j{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,"string"===typeof e&&(e={url:e}),this.base=e,K(this,"stats")}setByteRange(e,t){const n=e.split("@",2);let i;i=1===n.length?(null==t?void 0:t.byteRangeEndOffset)||0:parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get baseurl(){return this.base.url}get byteRange(){return null===this._byteRange?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return null===this._streams&&(this._streams={[B.AUDIO]:null,[B.VIDEO]:null,[B.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return null!==this._stats}get hasStreams(){return null!==this._streams}get stats(){return null===this._stats&&(this._stats=new F),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=U.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[B.AUDIO]=null,e[B.VIDEO]=null,e[B.AUDIOVIDEO]=null}}function $(e){return"initSegment"!==e.sn}class G extends j{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange){const e=this.byteRange[0],t=this.byteRange[1];if(i(e)&&i(t))return t-e}return null}get bitrate(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{const e=Object.keys(this.levelkeys);if(1===e.length)return this._decryptdata=this.levelkeys[e[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;const e=i(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){const e=Object.keys(this.levelkeys),t=e.length;if(t>1||1===t&&this.levelkeys[e[0]].encrypted)return!0}return!1}get programDateTime(){return null===this._programDateTime&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){i(e)?this._programDateTime=e:this._programDateTime=this.rawProgramDateTime=null}get ref(){return $(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,n,i,r,s=!1){const{elementaryStreams:a}=this,o=a[e];o?(o.startPTS=Math.min(o.startPTS,t),o.endPTS=Math.max(o.endPTS,n),o.startDTS=Math.min(o.startDTS,i),o.endDTS=Math.max(o.endDTS,r)):a[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:r,partial:s}}}class V extends j{constructor(e,t,n,i,r){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const s=e.enumeratedString("BYTERANGE");s&&this.setByteRange(s,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function H(e,t){const n=Object.getPrototypeOf(e);if(n){const e=Object.getOwnPropertyDescriptor(n,t);return e||H(n,t)}}function K(e,t){const n=H(e,t);n&&(n.enumerable=!0,Object.defineProperty(e,t,n))}const W=Math.pow(2,32)-1,q=[].push,Y={video:1,audio:2,id3:3,text:4};function z(e){return String.fromCharCode.apply(null,e)}function X(e,t){const n=e[t]<<8|e[t+1];return n<0?65536+n:n}function Q(e,t){const n=Z(e,t);return n<0?4294967296+n:n}function J(e,t){let n=Q(e,t);return n*=Math.pow(2,32),n+=Q(e,t+4),n}function Z(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function ee(e,t,n){e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function te(e){const t=e.byteLength;for(let n=0;n<t;){const i=Q(e,n);if(i>8&&109===e[n+4]&&111===e[n+5]&&111===e[n+6]&&102===e[n+7])return!0;n=i>1?n+i:t}return!1}function ne(e,t){const n=[];if(!t.length)return n;const i=e.byteLength;for(let r=0;r<i;){const s=Q(e,r),a=z(e.subarray(r+4,r+8)),o=s>1?r+s:i;if(a===t[0])if(1===t.length)n.push(e.subarray(r+8,o));else{const i=ne(e.subarray(r+8,o),t.slice(1));i.length&&q.apply(n,i)}r=o}return n}function ie(e){const t=[],n=e[0];let i=8;const r=Q(e,i);i+=4;let s=0,a=0;0===n?(s=Q(e,i),a=Q(e,i+4),i+=8):(s=J(e,i),a=J(e,i+8),i+=16),i+=2;let o=e.length+a;const u=X(e,i);i+=2;for(let l=0;l<u;l++){let n=i;const s=Q(e,n);n+=4;const a=2147483647&s,u=(2147483648&s)>>>31;if(1===u)return k.warn("SIDX has hierarchical references (not supported)"),null;const l=Q(e,n);n+=4,t.push({referenceSize:a,subsegmentDuration:l,info:{duration:l/r,start:o,end:o+a-1}}),o+=a,n+=4,i=n}return{earliestPresentationTime:s,timescale:r,version:n,referencesCount:u,references:t}}function re(e){const t=[],n=ne(e,["moov","trak"]);for(let r=0;r<n.length;r++){const e=n[r],i=ne(e,["tkhd"])[0];if(i){let n=i[0];const r=Q(i,0===n?12:20),s=ne(e,["mdia","mdhd"])[0];if(s){n=s[0];const i=Q(s,0===n?12:20),a=ne(e,["mdia","hdlr"])[0];if(a){const n=z(a.subarray(8,12)),s={soun:B.AUDIO,vide:B.VIDEO}[n],o=ne(e,["mdia","minf","stbl","stsd"])[0],u=se(o);s?(t[r]={timescale:i,type:s,stsd:u},t[s]=m({timescale:i,id:r},u)):t[r]={timescale:i,type:n,stsd:u}}}}}const i=ne(e,["moov","mvex","trex"]);return i.forEach(e=>{const n=Q(e,4),i=t[n];i&&(i.default={duration:Q(e,12),flags:Q(e,20)})}),t}function se(e){const t=e.subarray(8),n=t.subarray(86),i=z(t.subarray(4,8));let r,s=i;const a="enca"===i||"encv"===i;if(a){const e=ne(t,[i])[0],n=e.subarray("enca"===i?28:78),r=ne(n,["sinf"]);r.forEach(e=>{const t=ne(e,["schm"])[0];if(t){const n=z(t.subarray(4,8));if("cbcs"===n||"cenc"===n){const t=ne(e,["frma"])[0];t&&(s=z(t))}}})}const o=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const e=ne(n,["avcC"])[0];e&&e.length>3&&(s+="."+le(e[1])+le(e[2])+le(e[3]),r=ae("avc1"===o?"dva1":"dvav",n));break}case"mp4a":{const e=ne(t,[i])[0],n=ne(e.subarray(28),["esds"])[0];if(n&&n.length>7){let e=4;if(3!==n[e++])break;e=ue(n,e),e+=2;const t=n[e++];if(128&t&&(e+=2),64&t&&(e+=n[e++]),4!==n[e++])break;e=ue(n,e);const i=n[e++];if(64!==i)break;if(s+="."+le(i),e+=12,5!==n[e++])break;e=ue(n,e);const r=n[e++];let a=(248&r)>>3;31===a&&(a+=1+((7&r)<<3)+((224&n[e])>>5)),s+="."+a}break}case"hvc1":case"hev1":{const e=ne(n,["hvcC"])[0];if(e&&e.length>12){const t=e[1],n=["","A","B","C"][t>>6],i=31&t,r=Q(e,2),a=(32&t)>>5?"H":"L",o=e[12],u=e.subarray(6,12);s+="."+n+i,s+="."+oe(r).toString(16).toUpperCase(),s+="."+a+o;let l="";for(let e=u.length;e--;){const t=u[e];if(t||l){const e=t.toString(16).toUpperCase();l="."+e+l}}s+=l}r=ae("hev1"==o?"dvhe":"dvh1",n);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":s=ae(s,n)||s;break;case"vp09":{const e=ne(n,["vpcC"])[0];if(e&&e.length>6){const t=e[4],n=e[5],i=e[6]>>4&15;s+="."+ce(t)+"."+ce(n)+"."+ce(i)}break}case"av01":{const e=ne(n,["av1C"])[0];if(e&&e.length>2){const t=e[1]>>>5,i=31&e[1],a=e[2]>>>7?"H":"M",o=(64&e[2])>>6,u=(32&e[2])>>5,l=2===t&&o?u?12:10:o?10:8,c=(16&e[2])>>4,d=(8&e[2])>>3,h=(4&e[2])>>2,f=3&e[2],p=1,g=1,m=1,v=0;s+="."+t+"."+ce(i)+a+"."+ce(l)+"."+c+"."+d+h+f+"."+ce(p)+"."+ce(g)+"."+ce(m)+"."+v,r=ae("dav1",n)}break}}return{codec:s,encrypted:a,supplemental:r}}function ae(e,t){const n=ne(t,["dvvC"]),i=n.length?n[0]:ne(t,["dvcC"])[0];if(i){const t=i[2]>>1&127,n=i[2]<<5&32|i[3]>>3&31;return e+"."+ce(t)+"."+ce(n)}}function oe(e){let t=0;for(let n=0;n<32;n++)t|=(e>>n&1)<<31-n;return t>>>0}function ue(e,t){const n=t+5;while(128&e[t++]&&t<n);return t}function le(e){return("0"+e.toString(16).toUpperCase()).slice(-2)}function ce(e){return(e<10?"0":"")+e}function de(e,t){if(!e||!t)return e;const n=t.keyId;if(n&&t.isCommonEncryption){const t=ne(e,["moov","trak"]);t.forEach(e=>{const t=ne(e,["mdia","minf","stbl","stsd"])[0],i=t.subarray(8);let r=ne(i,["enca"]);const s=r.length>0;s||(r=ne(i,["encv"])),r.forEach(e=>{const t=s?e.subarray(28):e.subarray(78),i=ne(t,["sinf"]);i.forEach(e=>{const t=he(e);if(t){const e=t.subarray(8,24);e.some(e=>0!==e)||(k.log(`[eme] Patching keyId in 'enc${s?"a":"v"}>sinf>>tenc' box: ${M.hexDump(e)} -> ${M.hexDump(n)}`),t.set(n,8))}})})})}return e}function he(e){const t=ne(e,["schm"])[0];if(t){const n=z(t.subarray(4,8));if("cbcs"===n||"cenc"===n)return ne(e,["schi","tenc"])[0]}return null}function fe(e,t,n){const r={},s=ne(e,["moof","traf"]);for(let a=0;a<s.length;a++){const e=s[a],o=ne(e,["tfhd"])[0],u=Q(o,4),l=t[u];if(!l)continue;const c=r[u]||(r[u]={start:NaN,duration:0,sampleCount:0,timescale:l.timescale,type:l.type}),d=ne(e,["tfdt"])[0];if(d){const e=d[0];let t=Q(d,4);1===e&&(t===W?n.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(t*=W+1,t+=Q(d,8))),i(t)&&(!i(c.start)||t<c.start)&&(c.start=t)}const h=l.default,f=Q(o,0)|(null==h?void 0:h.flags);let p=(null==h?void 0:h.duration)||0;8&f&&(p=Q(o,2&f?12:8));const g=ne(e,["trun"]);let m=c.start||0,v=0,y=p;for(let t=0;t<g.length;t++){const e=g[t],n=Q(e,4),i=c.sampleCount;c.sampleCount+=n;const r=1&e[3],s=4&e[3],a=1&e[2],o=2&e[2],u=4&e[2],l=8&e[2];let d=8,h=n;if(r&&(d+=4),s&&n){const t=1&e[d+1];t||void 0!==c.keyFrameIndex||(c.keyFrameIndex=i),d+=4,a?(y=Q(e,d),d+=4):y=p,o&&(d+=4),l&&(d+=4),m+=y,v+=y,h--}while(h--){if(a?(y=Q(e,d),d+=4):y=p,o&&(d+=4),u){const t=1&e[d+1];t||void 0===c.keyFrameIndex&&(c.keyFrameIndex=c.sampleCount-(h+1),c.keyFrameStart=m),d+=4}l&&(d+=4),m+=y,v+=y}!v&&p&&(v+=p*n)}c.duration+=v}if(!Object.keys(r).some(e=>r[e].duration)){let t=1/0,n=0;const s=ne(e,["sidx"]);for(let e=0;e<s.length;e++){const i=ie(s[e]);if(null!=i&&i.references){t=Math.min(t,i.earliestPresentationTime/i.timescale);const e=i.references.reduce((e,t)=>e+t.info.duration||0,0);n=Math.max(n,e+i.earliestPresentationTime/i.timescale)}}n&&i(n)&&Object.keys(r).forEach(e=>{r[e].duration||(r[e].duration=n*r[e].timescale-r[e].start)})}return r}function pe(e,t,n){ne(t,["moof","traf"]).forEach(t=>{ne(t,["tfhd"]).forEach(i=>{const r=Q(i,4),s=e[r];if(!s)return;const a=s.timescale||9e4;ne(t,["tfdt"]).forEach(e=>{const t=e[0],i=n*a;if(i){let n=Q(e,4);if(0===t)n-=i,n=Math.max(n,0),ee(e,4,n);else{n*=Math.pow(2,32),n+=Q(e,8),n-=i,n=Math.max(n,0);const t=Math.floor(n/(W+1)),r=Math.floor(n%(W+1));ee(e,4,t),ee(e,8,r)}}})})})}function ge(e){const t={valid:null,remainder:null},n=ne(e,["moof"]);if(n.length<2)return t.remainder=e,t;const i=n[n.length-1];return t.valid=e.slice(0,i.byteOffset-8),t.remainder=e.slice(i.byteOffset-8),t}function me(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function ve(e,t){const n=[],i=t.samples,r=t.timescale,s=t.id;let a=!1;const o=ne(i,["moof"]);return o.map(o=>{const u=o.byteOffset-8,l=ne(o,["traf"]);l.map(o=>{const l=ne(o,["tfdt"]).map(e=>{const t=e[0];let n=Q(e,4);return 1===t&&(n*=Math.pow(2,32),n+=Q(e,8)),n/r})[0];return void 0!==l&&(e=l),ne(o,["tfhd"]).map(l=>{const c=Q(l,4),d=16777215&Q(l,0),h=0!==(1&d),f=0!==(2&d),p=0!==(8&d);let g=0;const m=0!==(16&d);let v=0;const y=0!==(32&d);let b=8;c===s&&(h&&(b+=8),f&&(b+=4),p&&(g=Q(l,b),b+=4),m&&(v=Q(l,b),b+=4),y&&(b+=4),"video"===t.type&&(a=ye(t.codec)),ne(o,["trun"]).map(s=>{const o=s[0],l=16777215&Q(s,0),c=0!==(1&l);let d=0;const h=0!==(4&l),f=0!==(256&l);let p=0;const m=0!==(512&l);let y=0;const b=0!==(1024&l),T=0!==(2048&l);let S=0;const E=Q(s,4);let w=8;c&&(d=Q(s,w),w+=4),h&&(w+=4);let A=d+u;for(let u=0;u<E;u++){if(f?(p=Q(s,w),w+=4):p=g,m?(y=Q(s,w),w+=4):y=v,b&&(w+=4),T&&(S=0===o?Q(s,w):Z(s,w),w+=4),t.type===B.VIDEO){let t=0;while(t<y){const s=Q(i,A);if(A+=4,be(a,i[A])){const t=i.subarray(A,A+s);Te(t,a?2:1,e+S/r,n)}A+=s,t+=s+4}}e+=p/r}}))})})}),n}function ye(e){if(!e)return!1;const t=e.substring(0,4);return"hvc1"===t||"hev1"===t||"dvh1"===t||"dvhe"===t}function be(e,t){if(e){const e=t>>1&63;return 39===e||40===e}{const e=31&t;return 6===e}}function Te(e,t,n,i){const r=Se(e);let s=0;s+=t;let a=0,o=0,u=0;while(s<r.length){a=0;do{if(s>=r.length)break;u=r[s++],a+=u}while(255===u);o=0;do{if(s>=r.length)break;u=r[s++],o+=u}while(255===u);const e=r.length-s;let t=s;if(o<e)s+=o;else if(o>e){k.error(`Malformed SEI payload. ${o} is too small, only ${e} bytes left to parse.`);break}if(4===a){const e=r[t++];if(181===e){const e=X(r,t);if(t+=2,49===e){const e=Q(r,t);if(t+=4,1195456820===e){const e=r[t++];if(3===e){const s=r[t++],o=31&s,u=64&s,l=u?2+3*o:0,c=new Uint8Array(l);if(u){c[0]=s;for(let e=1;e<l;e++)c[e]=r[t++]}i.push({type:e,payloadType:a,pts:n,bytes:c})}}}}}else if(5===a&&o>16){const e=[];for(let n=0;n<16;n++){const i=r[t++].toString(16);e.push(1==i.length?"0"+i:i),3!==n&&5!==n&&7!==n&&9!==n||e.push("-")}const s=o-16,u=new Uint8Array(s);for(let n=0;n<s;n++)u[n]=r[t++];i.push({payloadType:a,pts:n,uuid:e.join(""),userData:D(u),userDataBytes:u})}}}function Se(e){const t=e.byteLength,n=[];let i=1;while(i<t-2)0===e[i]&&0===e[i+1]&&3===e[i+2]?(n.push(i+2),i+=2):i++;if(0===n.length)return e;const r=t-n.length,s=new Uint8Array(r);let a=0;for(i=0;i<r;a++,i++)a===n[0]&&(a++,n.shift()),s[i]=e[a];return s}function Ee(e){const t=e[0];let n="",i="",s=0,a=0,o=0,u=0,l=0,c=0;if(0===t){while("\0"!==z(e.subarray(c,c+1)))n+=z(e.subarray(c,c+1)),c+=1;n+=z(e.subarray(c,c+1)),c+=1;while("\0"!==z(e.subarray(c,c+1)))i+=z(e.subarray(c,c+1)),c+=1;i+=z(e.subarray(c,c+1)),c+=1,s=Q(e,12),a=Q(e,16),u=Q(e,20),l=Q(e,24),c=28}else if(1===t){c+=4,s=Q(e,c),c+=4;const t=Q(e,c);c+=4;const a=Q(e,c);c+=4,o=2**32*t+a,r(o)||(o=Number.MAX_SAFE_INTEGER,k.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),u=Q(e,c),c+=4,l=Q(e,c),c+=4;while("\0"!==z(e.subarray(c,c+1)))n+=z(e.subarray(c,c+1)),c+=1;n+=z(e.subarray(c,c+1)),c+=1;while("\0"!==z(e.subarray(c,c+1)))i+=z(e.subarray(c,c+1)),c+=1;i+=z(e.subarray(c,c+1)),c+=1}const d=e.subarray(c,e.byteLength);return{schemeIdUri:n,value:i,timeScale:s,presentationTime:o,presentationTimeDelta:a,eventDuration:u,id:l,payload:d}}function we(e,...t){const n=t.length;let i=8,r=n;while(r--)i+=t[r].byteLength;const s=new Uint8Array(i);for(s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=255&i,s.set(e,4),r=0,i=8;r<n;r++)s.set(t[r],i),i+=t[r].byteLength;return s}function Ae(e,t,n){if(16!==e.byteLength)throw new RangeError("Invalid system id");let i,r,s;i=0,r=new Uint8Array,i>0?(s=new Uint8Array(4),t.length>0&&new DataView(s.buffer).setUint32(0,t.length,!1)):s=new Uint8Array;const a=new Uint8Array(4);return n&&n.byteLength>0&&new DataView(a.buffer).setUint32(0,n.byteLength,!1),we([112,115,115,104],new Uint8Array([i,0,0,0]),e,s,r,a,n||new Uint8Array)}function xe(e){const t=[];if(e instanceof ArrayBuffer){const n=e.byteLength;let i=0;while(i+32<n){const n=new DataView(e,i),r=Ie(n);t.push(r),i+=r.size}}return t}function Ie(e){const t=e.getUint32(0),n=e.byteOffset,i=e.byteLength;if(i<t)return{offset:n,size:i};const r=e.getUint32(4);if(1886614376!==r)return{offset:n,size:t};const s=e.getUint32(8)>>>24;if(0!==s&&1!==s)return{offset:n,size:t};const a=e.buffer,o=M.hexDump(new Uint8Array(a,n+12,16)),u=e.getUint32(28);let l=null,c=null;if(0===s){if(t-32<u||u<22)return{offset:n,size:t};c=new Uint8Array(a,n+32,u)}else if(1===s){if(!u||i<n+32+16*u+16)return{offset:n,size:t};l=[];for(let e=0;e<u;e++)l.push(new Uint8Array(a,n+32+16*e,16))}return{version:s,systemId:o,kids:l,data:c,offset:n,size:t}}const ke=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Le={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Re(e,t){const n=Le[t];return!!n&&!!n[e.slice(0,4)]}function Ce(e,t,n=!0){return!e.split(",").some(e=>!De(e,t,n))}function De(e,t,n=!0){var i;const r=L(n);return null!=(i=null==r?void 0:r.isTypeSupported(Me(e,t)))&&i}function Me(e,t){return`${t}/mp4;codecs=${e}`}function Pe(e){if(e){const t=e.substring(0,4);return Le.video[t]}return 2}function _e(e){const t=ke();return e.split(",").reduce((e,n)=>{const i=t&&ye(n),r=i?9:Le.video[n];return r?(2*r+e)/(e?3:2):(Le.audio[n]+e)/(e?2:1)},0)}const Oe={};function Ne(e,t=!0){if(Oe[e])return Oe[e];const n={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[e];for(let r=0;r<n.length;r++){var i;if(De(n[r],"audio",t))return Oe[e]=n[r],n[r];if("mp3"===n[r]&&null!=(i=L(t))&&i.isTypeSupported("audio/mpeg"))return""}return e}const Ue=/flac|opus|mp4a\.40\.34/i;function Fe(e,t=!0){return e.replace(Ue,e=>Ne(e.toLowerCase(),t))}function Be(e,t){const n=[];if(e){const t=e.split(",");for(let e=0;e<t.length;e++)Re(t[e],"video")||n.push(t[e])}return t&&n.push(t),n.join(",")}function je(e,t){if(e&&(e.length>4||-1!==["ac-3","ec-3","alac","fLaC","Opus"].indexOf(e)))return e;if(t){const n=t.split(",");if(n.length>1){if(e)for(let t=n.length;t--;)if(n[t].substring(0,4)===e.substring(0,4))return n[t];return n[0]}}return t||e}function $e(e){const t=e.split(",");for(let n=0;n<t.length;n++){const e=t[n].split(".");e.length>2&&"avc1"===e[0]&&(t[n]=`avc1.${parseInt(e[1]).toString(16)}${("000"+parseInt(e[2]).toString(16)).slice(-4)}`)}return t.join(",")}function Ge(e){if(e.startsWith("av01.")){const t=e.split("."),n=["0","111","01","01","01","0"];for(let e=t.length;e>4&&e<10;e++)t[e]=n[e-4];return t.join(".")}return e}function Ve(e){const t=L(e)||{isTypeSupported:()=>!1};return{mpeg:t.isTypeSupported("audio/mpeg"),mp3:t.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:t.isTypeSupported('audio/mp4; codecs="ac-3"')}}function He(e){return e.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const Ke={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function We(e,t){return{supported:!1,configurations:t,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:e}}const qe={};function Ye(e,t,n,r,s,a){const o=e.audioCodec?e.audioGroups:null,u=null==a?void 0:a.audioCodec,l=null==a?void 0:a.channels,c=l?parseInt(l):u?1/0:2;let d=null;if(null!=o&&o.length)try{d=1===o.length&&o[0]?t.groups[o[0]].channels:o.reduce((e,n)=>{if(n){const i=t.groups[n];if(!i)throw new Error(`Audio track group ${n} not found`);Object.keys(i.channels).forEach(t=>{e[t]=(e[t]||0)+i.channels[t]})}return e},{2:0})}catch(h){return!0}return void 0!==e.videoCodec&&(e.width>1920&&e.height>1088||e.height>1920&&e.width>1088||e.frameRate>Math.max(r,30)||"SDR"!==e.videoRange&&e.videoRange!==n||e.bitrate>Math.max(s,8e6))||!!d&&i(c)&&Object.keys(d).some(e=>parseInt(e)>c)}function ze(e,t,n){const r=e.videoCodec,s=e.audioCodec;if(!r&&!s||!n)return Promise.resolve(Ke);const a=[];if(r){const t={width:e.width,height:e.height,bitrate:Math.ceil(Math.max(.9*e.bitrate,e.averageBitrate)),framerate:e.frameRate||30},n=e.videoRange;"SDR"!==n&&(t.transferFunction=n.toLowerCase());const i=r.split(","),s=navigator.userAgent;if(i.some(e=>ye(e))&&ke())return Promise.resolve(We(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: (${s})`),a));a.push.apply(a,i.map(e=>({type:"media-source",video:m(m({},t),{},{contentType:Me(Ge(e),"video")})})))}return s&&e.audioGroups&&e.audioGroups.forEach(e=>{var n;e&&(null==(n=t.groups[e])||n.tracks.forEach(t=>{if(t.groupId===e){const e=t.channels||"",n=parseFloat(e);i(n)&&n>2&&a.push.apply(a,s.split(",").map(e=>({type:"media-source",audio:{contentType:Me(e,"audio"),channels:""+n}})))}}))}),Promise.all(a.map(e=>{const t=Xe(e);return qe[t]||(qe[t]=n.decodingInfo(e))})).then(e=>({supported:!e.some(e=>!e.supported),configurations:a,decodingInfoResults:e})).catch(e=>({supported:!1,configurations:a,decodingInfoResults:[],error:e}))}function Xe(e){const{audio:t,video:n}=e,i=n||t;if(i){const e=He(i.contentType);if(n)return`r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${e}_${Math.ceil(n.bitrate/1e5)}`;if(t)return`c${t.channels}${t.spatialRendering?"s":"n"}_${e}`}return""}const Qe=["NONE","TYPE-0","TYPE-1",null];function Je(e){return Qe.indexOf(e)>-1}const Ze=["SDR","PQ","HLG"];function et(e){return!!e&&Ze.indexOf(e)>-1}var tt={No:"",Yes:"YES",v2:"v2"};function nt(e){const{canSkipUntil:t,canSkipDateRanges:n,age:i}=e,r=i<t/2;return t&&r?n?tt.v2:tt.Yes:tt.No}class it{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class rt{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(e=>!!e).map(e=>e.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const n=null==(t=e.supplemental)?void 0:t.videoCodec;n&&n!==e.videoCodec&&(this.codecSet+=`,${n.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return st(this._audioGroups,e)}hasSubtitleGroup(e){return st(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t)if("audio"===e){let e=this._audioGroups;e||(e=this._audioGroups=[]),-1===e.indexOf(t)&&e.push(t)}else if("text"===e){let e=this._subtitleGroups;e||(e=this._subtitleGroups=[]),-1===e.indexOf(t)&&e.push(t)}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return null==(e=this.audioGroups)?void 0:e[0]}get textGroupId(){var e;return null==(e=this.subtitleGroups)?void 0:e[0]}addFallback(){}}function st(e,t){return!(!t||!e)&&-1!==e.indexOf(t)}function at(){if("function"===typeof matchMedia){const e=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(e.media!==t.media)return!0===e.matches}return!1}function ot(e,t){let n=!1,i=[];if(e&&(n="SDR"!==e,i=[e]),t){i=t.allowedVideoRanges||Ze.slice(0);const e="SDR"!==i.join("")&&!t.videoCodec;n=void 0!==t.preferHDR?t.preferHDR:e&&at(),n||(i=["SDR"])}return{preferHDR:n,allowedVideoRanges:i}}const ut=e=>{const t=new WeakSet;return(n,i)=>{if(e&&(i=e(n,i)),"object"===typeof i&&null!==i){if(t.has(i))return;t.add(i)}return i}},lt=(e,t)=>JSON.stringify(e,ut(t));function ct(e,t,n,r,s){const a=Object.keys(e),o=null==r?void 0:r.channels,u=null==r?void 0:r.audioCodec,l=null==s?void 0:s.videoCodec,c=o&&2===parseInt(o);let d=!1,h=!1,f=1/0,p=1/0,g=1/0,m=1/0,v=0,y=[];const{preferHDR:b,allowedVideoRanges:T}=ot(t,s);for(let i=a.length;i--;){const t=e[a[i]];d||(d=t.channels[2]>0),f=Math.min(f,t.minHeight),p=Math.min(p,t.minFramerate),g=Math.min(g,t.minBitrate);const n=T.filter(e=>t.videoRanges[e]>0);n.length>0&&(h=!0)}f=i(f)?f:0,p=i(p)?p:0;const S=Math.max(1080,f),E=Math.max(30,p);g=i(g)?g:n,n=Math.max(g,n),h||(t=void 0);const w=a.length>1,A=a.reduce((t,i)=>{const r=e[i];if(i===t)return t;if(y=h?T.filter(e=>r.videoRanges[e]>0):[],w){if(r.minBitrate>n)return dt(i,`min bitrate of ${r.minBitrate} > current estimate of ${n}`),t;if(!r.hasDefaultAudio)return dt(i,"no renditions with default or auto-select sound found"),t;if(u&&i.indexOf(u.substring(0,4))%5!==0)return dt(i,`audio codec preference "${u}" not found`),t;if(o&&!c){if(!r.channels[o])return dt(i,`no renditions with ${o} channel sound found (channels options: ${Object.keys(r.channels)})`),t}else if((!u||c)&&d&&0===r.channels["2"])return dt(i,"no renditions with stereo sound found"),t;if(r.minHeight>S)return dt(i,`min resolution of ${r.minHeight} > maximum of ${S}`),t;if(r.minFramerate>E)return dt(i,`min framerate of ${r.minFramerate} > maximum of ${E}`),t;if(!y.some(e=>r.videoRanges[e]>0))return dt(i,`no variants with VIDEO-RANGE of ${lt(y)} found`),t;if(l&&i.indexOf(l.substring(0,4))%5!==0)return dt(i,`video codec preference "${l}" not found`),t;if(r.maxScore<v)return dt(i,`max score of ${r.maxScore} < selected max of ${v}`),t}return t&&(_e(i)>=_e(t)||r.fragmentError>e[t].fragmentError)?t:(m=r.minIndex,v=r.maxScore,i)},void 0);return{codecSet:A,videoRanges:y,preferHDR:b,minFramerate:p,minBitrate:g,minIndex:m}}function dt(e,t){k.log(`[abr] start candidates with "${e}" ignored because ${t}`)}function ht(e){return e.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const i=t.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function ft(e,t,n,i){return e.slice(n,i+1).reduce((e,n,i)=>{if(!n.codecSet)return e;const r=n.audioGroups;let s=e[n.codecSet];s||(e[n.codecSet]=s={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:i,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!r,fragmentError:0}),s.minBitrate=Math.min(s.minBitrate,n.bitrate);const a=Math.min(n.height,n.width);return s.minHeight=Math.min(s.minHeight,a),s.minFramerate=Math.min(s.minFramerate,n.frameRate),s.minIndex=Math.min(s.minIndex,i),s.maxScore=Math.max(s.maxScore,n.score),s.fragmentError+=n.fragmentError,s.videoRanges[n.videoRange]=(s.videoRanges[n.videoRange]||0)+1,r&&r.forEach(e=>{if(!e)return;const n=t.groups[e];n&&(s.hasDefaultAudio=s.hasDefaultAudio||t.hasDefaultAudio?n.hasDefault:n.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(n.channels).forEach(e=>{s.channels[e]=(s.channels[e]||0)+n.channels[e]}))}),e},{})}function pt(e){if(!e)return e;const{lang:t,assocLang:n,characteristics:i,channels:r,audioCodec:s}=e;return{lang:t,assocLang:n,characteristics:i,channels:r,audioCodec:s}}function gt(e,t,n){if("attrs"in e){const n=t.indexOf(e);if(-1!==n)return n}for(let i=0;i<t.length;i++){const r=t[i];if(mt(e,r,n))return i}return-1}function mt(e,t,n){const{groupId:i,name:r,lang:s,assocLang:a,default:o}=e,u=e.forced;return(void 0===i||t.groupId===i)&&(void 0===r||t.name===r)&&(void 0===s||vt(s,t.lang))&&(void 0===s||t.assocLang===a)&&(void 0===o||t.default===o)&&(void 0===u||t.forced===u)&&(!("characteristics"in e)||yt(e.characteristics||"",t.characteristics))&&(void 0===n||n(e,t))}function vt(e,t="--"){return e.length===t.length?e===t:e.startsWith(t)||t.startsWith(e)}function yt(e,t=""){const n=e.split(","),i=t.split(",");return n.length===i.length&&!n.some(e=>-1===i.indexOf(e))}function bt(e,t){const{audioCodec:n,channels:i}=e;return(void 0===n||(t.audioCodec||"").substring(0,4)===n.substring(0,4))&&(void 0===i||i===(t.channels||"2"))}function Tt(e,t,n,i,r){const s=t[i],a=t.reduce((e,t,n)=>{const i=t.uri,r=e[i]||(e[i]=[]);return r.push(n),e},{}),o=a[s.uri];o.length>1&&(i=Math.max.apply(Math,o));const u=s.videoRange,l=s.frameRate,c=s.codecSet.substring(0,4),d=St(t,i,t=>{if(t.videoRange!==u||t.frameRate!==l||t.codecSet.substring(0,4)!==c)return!1;const i=t.audioGroups,s=n.filter(e=>!i||-1!==i.indexOf(e.groupId));return gt(e,s,r)>-1});return d>-1?d:St(t,i,t=>{const i=t.audioGroups,s=n.filter(e=>!i||-1!==i.indexOf(e.groupId));return gt(e,s,r)>-1})}function St(e,t,n){for(let i=t;i>-1;i--)if(n(e[i]))return i;for(let i=t+1;i<e.length;i++)if(n(e[i]))return i;return-1}function Et(e,t){var n;return!!e&&e!==(null==(n=t.loadLevelObj)?void 0:n.uri)}class wt extends b{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.bwEstimator=void 0,this._abandonRulesCheck=e=>{var t;const{fragCurrent:n,partCurrent:r,hls:s}=this,{autoLevelEnabled:a,media:o}=s;if(!n||!o)return;const l=performance.now(),c=r?r.stats:n.stats,d=r?r.duration:n.duration,h=l-c.loading.start,f=s.minAutoLevel,p=n.level,g=this._nextAutoLevel;if(c.aborted||c.loaded&&c.loaded===c.total||p<=f)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!a)return;const m=g>-1&&g!==p,v=!!e||m;if(!v&&(o.paused||!o.playbackRate||!o.readyState))return;const y=s.mainForwardBufferInfo;if(!v&&null===y)return;const b=this.bwEstimator.getEstimateTTFB(),T=Math.abs(o.playbackRate);if(h<=Math.max(b,d/(2*T)*1e3))return;const S=y?y.len/T:0,E=c.loading.first?c.loading.first-c.loading.start:-1,w=c.loaded&&E>-1,A=this.getBwEstimate(),x=s.levels,I=x[p],k=Math.max(c.loaded,Math.round(d*(n.bitrate||I.averageBitrate)/8));let L=w?h-E:h;L<1&&w&&(L=Math.min(h,8*c.loaded/A));const R=w?1e3*c.loaded/L:0,C=b/1e3,D=R?(k-c.loaded)/R:8*k/A+C;if(D<=S)return;const M=R?8*R:A,P=!0===(null==(t=(null==e?void 0:e.details)||this.hls.latestLevelDetails)?void 0:t.live),_=this.hls.config.abrBandWidthUpFactor;let O,N=Number.POSITIVE_INFINITY;for(O=p-1;O>f;O--){const e=x[O].maxBitrate,t=!x[O].details||P;if(N=this.getTimeToLoadFrag(C,M,d*e,t),N<Math.min(S,d+C))break}if(N>=D)return;if(N>10*d)return;w?this.bwEstimator.sample(h-Math.min(b,E),c.loaded):this.bwEstimator.sampleTTFB(h);const U=x[O].maxBitrate;this.getBwEstimate()*_>U&&this.resetEstimator(U);const F=this.findBestLevel(U,f,O,0,S,1,1);F>-1&&(O=F),this.warn(`Fragment ${n.sn}${r?" part "+r.index:""} of level ${p} is loading too slowly;\n      Fragment duration: ${n.duration.toFixed(3)}\n      Time to underbuffer: ${S.toFixed(3)} s\n      Estimated load time for current fragment: ${D.toFixed(3)} s\n      Estimated load time for down switch fragment: ${N.toFixed(3)} s\n      TTFB estimate: ${0|E} ms\n      Current BW estimate: ${i(A)?0|A:"Unknown"} bps\n      New BW estimate: ${0|this.getBwEstimate()} bps\n      Switching to level ${O} @ ${0|U} bps`),s.nextLoadLevel=s.nextAutoLevel=O,this.clearTimer();const B=()=>{if(this.clearTimer(),this.fragCurrent===n&&this.hls.loadLevel===O&&O>0){const e=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${O>0?"and switching down":""}\n      Fragment duration: ${n.duration.toFixed(3)} s\n      Time to underbuffer: ${e.toFixed(3)} s`),n.abortRequests(),this.fragCurrent=this.partCurrent=null,O>f){let t=this.findBestLevel(this.hls.levels[f].bitrate,f,O,0,e,1,1);-1===t&&(t=f),this.hls.nextLoadLevel=this.hls.nextAutoLevel=t,this.resetEstimator(this.hls.levels[t].bitrate)}}};m||D>2*N?B():this.timer=self.setInterval(B,1e3*N),s.trigger(u.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:r,stats:c})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new h(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.FRAG_LOADING,this.onFragLoading,this),e.on(u.FRAG_LOADED,this.onFragLoaded,this),e.on(u.FRAG_BUFFERED,this.onFragBuffered,this),e.on(u.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(u.LEVEL_LOADED,this.onLevelLoaded,this),e.on(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(u.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(u.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.FRAG_LOADING,this.onFragLoading,this),e.off(u.FRAG_LOADED,this.onFragLoaded,this),e.off(u.FRAG_BUFFERED,this.onFragBuffered,this),e.off(u.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(u.LEVEL_LOADED,this.onLevelLoaded,this),e.off(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(u.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(u.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){var i;if(!n.bitrateTest)this.fragCurrent=n,this.partCurrent=null!=(i=t.part)?i:null;this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case o.BUFFER_ADD_CODEC_ERROR:case o.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case o.FRAG_LOAD_TIMEOUT:{const e=t.frag,{fragCurrent:n,partCurrent:i}=this;if(e&&n&&e.sn===n.sn&&e.level===n.level){const t=performance.now(),n=i?i.stats:e.stats,r=t-n.loading.start,s=n.loading.first?n.loading.first-n.loading.start:-1,a=n.loaded&&s>-1;if(a){const e=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(r-Math.min(e,s),n.loaded)}else this.bwEstimator.sampleTTFB(r)}break}}}getTimeToLoadFrag(e,t,n,i){const r=e+n/t,s=i?e+this.lastLevelLoadSec:0;return r+s}onLevelLoaded(e,t){const n=this.hls.config,{loading:r}=t.stats,s=r.end-r.first;i(s)&&(this.lastLevelLoadSec=s/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:n}){const i=n?n.stats:t.stats;if(t.type===c.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const e=n?n.duration:t.duration,r=this.hls.levels[t.level],s=(r.loaded?r.loaded.bytes:0)+i.loaded,a=(r.loaded?r.loaded.duration:0)+e;r.loaded={bytes:s,duration:a},r.realBitrate=Math.round(8*s/a)}if(t.bitrateTest){const e={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered(u.FRAG_BUFFERED,e),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:i}=t,r=null!=i&&i.stats.loaded?i.stats:n.stats;if(r.aborted)return;if(this.ignoreFragment(n))return;const s=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(s,r.loaded),r.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=s/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==c.MAIN||"initSegment"===e.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,r=this.findBestLevel(n,t,e,0,i,1,1);if(r>-1)return r;const s=this.hls.firstLevel,a=Math.min(Math.max(s,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${s} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,t=this.bwEstimator,n=t.canEstimate(),i=this.lastLoadedFragLevel>-1;if(-1!==e&&(!n||!i||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const r=n&&i?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){const t=this.hls.levels;if(t.length>Math.max(e,r)&&t[e].loadError<=t[r].loadError)return e}return this._nextAutoLevel=r,this.nextAutoLevelKey=this.getAutoLevelKey(),r}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this;if(n.levels.length<=1)return n.loadLevel;const{maxAutoLevel:i,config:r,minAutoLevel:s}=n,a=t?t.duration:e?e.duration:0,o=this.getBwEstimate(),u=this.getStarvationDelay();let l=r.abrBandWidthFactor,c=r.abrBandWidthUpFactor;if(u){const e=this.findBestLevel(o,s,i,u,0,l,c);if(e>=0)return this.rebufferNotice=-1,e}let d=a?Math.min(a,r.maxStarvationDelay):r.maxStarvationDelay;if(!u){const e=this.bitrateTestDelay;if(e){const t=a?Math.min(a,r.maxLoadingDelay):r.maxLoadingDelay;d=t-e,this.info(`bitrate test took ${Math.round(1e3*e)}ms, set first fragment max fetchDuration to ${Math.round(1e3*d)} ms`),l=c=1}}const h=this.findBestLevel(o,s,i,u,d,l,c);if(this.rebufferNotice!==h&&(this.rebufferNotice=h,this.info(`${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${h}`)),h>-1)return h;const f=n.levels[s],p=n.loadLevelObj;return p&&(null==f?void 0:f.bitrate)<p.bitrate?s:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,r,s,a,o){var u;const l=r+s,c=this.lastLoadedFragLevel,d=-1===c?this.hls.firstLevel:c,{fragCurrent:h,partCurrent:f}=this,{levels:p,allAudioTracks:g,loadLevel:m,config:v}=this.hls;if(1===p.length)return 0;const y=p[d],b=!(null==(u=this.hls.latestLevelDetails)||!u.live),T=-1===m||-1===c;let S,E="SDR",w=(null==y?void 0:y.frameRate)||0;const{audioPreference:A,videoPreference:x}=v,I=this.audioTracksByGroup||(this.audioTracksByGroup=ht(g));let k=-1;if(T){if(-1!==this.firstSelection)return this.firstSelection;const i=this.codecTiers||(this.codecTiers=ft(p,I,t,n)),r=ct(i,E,e,A,x),{codecSet:s,videoRanges:a,minFramerate:o,minBitrate:u,minIndex:l,preferHDR:c}=r;k=l,S=s,E=c?a[a.length-1]:a[0],w=o,e=Math.max(e,u),this.log(`picked start tier ${lt(r)}`)}else S=null==y?void 0:y.codecSet,E=null==y?void 0:y.videoRange;const L=f?f.duration:h?h.duration:0,R=this.bwEstimator.getEstimateTTFB()/1e3,C=[];for(let M=n;M>=t;M--){var D;const t=p[M],u=M>d;if(!t)continue;if(v.useMediaCapabilities&&!t.supportedResult&&!t.supportedPromise){const n=navigator.mediaCapabilities;"function"===typeof(null==n?void 0:n.decodingInfo)&&(Ye(t,I,E,w,e,A)||ye(t.videoCodec))?(t.supportedPromise=ze(t,I,n),t.supportedPromise.then(e=>{if(!this.hls)return;t.supportedResult=e;const n=this.hls.levels,i=n.indexOf(t);e.error?this.warn(`MediaCapabilities decodingInfo error: "${e.error}" for level ${i} ${lt(e)}`):e.supported||(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${i} ${lt(e)}`),i>-1&&n.length>1&&(this.log(`Removing unsupported level ${i}`),this.hls.removeLevel(i),-1===this.hls.loadLevel&&(this.hls.nextLoadLevel=0)))})):t.supportedResult=Ke}if((S&&t.codecSet!==S||E&&t.videoRange!==E||u&&w>t.frameRate||!u&&w>0&&w<t.frameRate||t.supportedResult&&(null==(D=t.supportedResult.decodingInfoResults)||!D[0].smooth))&&(!T||M!==k)){C.push(M);continue}const h=t.details,g=(f?null==h?void 0:h.partTarget:null==h?void 0:h.averagetargetduration)||L;let y;y=u?o*e:a*e;const x=L&&r>=2*L&&0===s?t.averageBitrate:t.maxBitrate,P=this.getTimeToLoadFrag(R,y,x*g,void 0===h),_=y>=x&&(M===c||0===t.loadError&&0===t.fragmentError)&&(P<=R||!i(P)||b&&!this.bitrateTestDelay||P<l);if(_){const e=this.forcedAutoLevel;return M===m||-1!==e&&e===m||(C.length&&this.trace(`Skipped level(s) ${C.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${p[C[0]].codecs}" ${p[C[0]].videoRange}; not compatible with "${S}" ${E}`),this.info(`switch candidate:${d}->${M} adjustedbw(${Math.round(y)})-bitrate=${Math.round(y-x)} ttfb:${R.toFixed(1)} avgDuration:${g.toFixed(1)} maxFetchDuration:${l.toFixed(1)} fetchDuration:${P.toFixed(1)} firstSelection:${T} codecSet:${t.codecSet} videoRange:${t.videoRange} hls.loadLevel:${m}`)),T&&(this.firstSelection=M),M}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls;return Math.min(Math.max(e,n),t)}}const At={search:function(e,t){let n=0,i=e.length-1,r=null,s=null;while(n<=i){r=(n+i)/2|0,s=e[r];const a=t(s);if(a>0)n=r+1;else{if(!(a<0))return s;i=r-1}}return null}};function xt(e,t,n){if(null===t||!Array.isArray(e)||!e.length||!i(t))return null;const r=e[0].programDateTime;if(t<(r||0))return null;const s=e[e.length-1].endProgramDateTime;if(t>=(s||0))return null;for(let i=0;i<e.length;++i){const r=e[i];if(Rt(t,n,r))return r}return null}function It(e,t,n=0,i=0,r=.005){let s=null;if(e){s=t[1+e.sn-t[0].sn]||null;const i=e.endDTS-n;i>0&&i<15e-7&&(n+=15e-7),s&&e.level!==s.level&&s.end<=e.end&&(s=t[2+e.sn-t[0].sn]||null)}else 0===n&&0===t[0].start&&(s=t[0]);if(s&&((!e||e.level===s.level)&&0===Lt(n,i,s)||kt(s,e,Math.min(r,i))))return s;const a=At.search(t,Lt.bind(null,n,i));return!a||a===e&&s?s:a}function kt(e,t,n){if(t&&0===t.start&&t.level<e.level&&(t.endPTS||0)>0){const i=t.tagList.reduce((e,t)=>("INF"===t[0]&&(e+=parseFloat(t[1])),e),n);return e.start<=i}return!1}function Lt(e=0,t=0,n){if(n.start<=e&&n.start+n.duration>e)return 0;const i=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-i<=e?1:n.start-i>e&&n.start?-1:0}function Rt(e,t,n){const i=1e3*Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0)),r=n.endProgramDateTime||0;return r-i>e}function Ct(e,t,n){if(e&&e.startCC<=t&&e.endCC>=t){let i=e.fragments;const{fragmentHint:r}=e;let s;return r&&(i=i.concat(r)),At.search(i,e=>e.cc<t?1:e.cc>t?-1:(s=e,e.end<=n?1:e.start>n?-1:0)),s||null}return null}function Dt(e){switch(e.details){case o.FRAG_LOAD_TIMEOUT:case o.KEY_LOAD_TIMEOUT:case o.LEVEL_LOAD_TIMEOUT:case o.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Mt(e,t){const n=Dt(t);return e.default[(n?"timeout":"error")+"Retry"]}function Pt(e,t){const n="linear"===e.backoff?1:Math.pow(2,t);return Math.min(n*e.retryDelayMs,e.maxRetryDelayMs)}function _t(e){return m(m({},e),{errorRetry:null,timeoutRetry:null})}function Ot(e,t,n,i){if(!e)return!1;const r=null==i?void 0:i.code,s=t<e.maxNumRetry&&(Nt(r)||!!n);return e.shouldRetry?e.shouldRetry(e,t,n,i,s):s}function Nt(e){return 0===e&&!1===navigator.onLine||!!e&&(e<400||e>499)}var Ut={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},Ft={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class Bt extends b{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(u.ERROR,this.onError,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(u.ERROR,this.onError,this),e.off(u.ERROR,this.onErrorOut,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(null==e?void 0:e.type)===c.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n;if(t.fatal)return;const i=this.hls,r=t.context;switch(t.details){case o.FRAG_LOAD_ERROR:case o.FRAG_LOAD_TIMEOUT:case o.KEY_LOAD_ERROR:case o.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case o.FRAG_PARSING_ERROR:if(null!=(n=t.frag)&&n.gap)return void(t.errorAction=jt());case o.FRAG_GAP:case o.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=Ut.SendAlternateToPenaltyBox);case o.LEVEL_EMPTY_ERROR:case o.LEVEL_PARSING_ERROR:{var s,u;const e=t.parent===c.MAIN?t.level:i.loadLevel;t.details===o.LEVEL_EMPTY_ERROR&&null!=(s=t.context)&&null!=(u=s.levelDetails)&&u.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case o.LEVEL_LOAD_ERROR:case o.LEVEL_LOAD_TIMEOUT:return void("number"===typeof(null==r?void 0:r.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.level)));case o.AUDIO_TRACK_LOAD_ERROR:case o.AUDIO_TRACK_LOAD_TIMEOUT:case o.SUBTITLE_LOAD_ERROR:case o.SUBTITLE_TRACK_LOAD_TIMEOUT:if(r){const e=i.loadLevelObj;if(e&&(r.type===l.AUDIO_TRACK&&e.hasAudioGroup(r.groupId)||r.type===l.SUBTITLE_TRACK&&e.hasSubtitleGroup(r.groupId)))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=Ut.SendAlternateToPenaltyBox,void(t.errorAction.flags=Ft.MoveAllAlternatesMatchingHost)}return;case o.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const e=i.loadLevelObj,n=null==e?void 0:e.attrs["HDCP-LEVEL"];n?t.errorAction={action:Ut.SendAlternateToPenaltyBox,flags:Ft.MoveAllAlternatesMatchingHDCP,hdcpLevel:n}:this.keySystemError(t)}return;case o.BUFFER_ADD_CODEC_ERROR:case o.REMUX_ALLOC_ERROR:case o.BUFFER_APPEND_ERROR:var d;if(!t.errorAction)t.errorAction=this.getLevelSwitchAction(t,null!=(d=t.level)?d:i.loadLevel);return;case o.INTERNAL_EXCEPTION:case o.BUFFER_APPENDING_ERROR:case o.BUFFER_FULL_ERROR:case o.LEVEL_SWITCH_ERROR:case o.BUFFER_STALLED_ERROR:case o.BUFFER_SEEK_OVER_HOLE:case o.BUFFER_NUDGE_ON_STALL:return void(t.errorAction=jt())}t.type===a.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,i=Mt(n.config.playlistLoadPolicy,e),r=this.playlistError++,s=Ot(i,r,Dt(e),e.response);if(s)return{action:Ut.RetryRequest,flags:Ft.None,retryConfig:i,retryCount:r};const a=this.getLevelSwitchAction(e,t);return i&&(a.retryConfig=i,a.retryCount=r),a}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:r,keyLoadPolicy:s}=t.config,a=Mt(e.details.startsWith("key")?s:r,e),u=t.levels.reduce((e,t)=>e+t.fragmentError,0);if(i){e.details!==o.FRAG_GAP&&i.fragmentError++;const t=Ot(a,u,Dt(e),e.response);if(t)return{action:Ut.RetryRequest,flags:Ft.None,retryConfig:a,retryCount:u}}const l=this.getLevelSwitchAction(e,n);return a&&(l.retryConfig=a,l.retryCount=u),l}getLevelSwitchAction(e,t){const n=this.hls;null!==t&&void 0!==t||(t=n.loadLevel);const i=this.hls.levels[t];if(i){var r,s;const t=e.details;i.loadError++,t===o.BUFFER_APPEND_ERROR&&i.fragmentError++;let d=-1;const{levels:h,loadLevel:f,minAutoLevel:p,maxAutoLevel:g}=n;n.autoLevelEnabled||n.config.preserveManualLevelOnError||(n.loadLevel=-1);const m=null==(r=e.frag)?void 0:r.type,v=m===c.AUDIO&&t===o.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(t===o.BUFFER_ADD_CODEC_ERROR||t===o.BUFFER_APPEND_ERROR),y=v&&h.some(({audioCodec:e})=>i.audioCodec!==e),b="video"===e.sourceBufferName&&(t===o.BUFFER_ADD_CODEC_ERROR||t===o.BUFFER_APPEND_ERROR),T=b&&h.some(({codecSet:e,audioCodec:t})=>i.codecSet!==e&&i.audioCodec===t),{type:S,groupId:E}=null!=(s=e.context)?s:{};for(let n=h.length;n--;){const r=(n+f)%h.length;if(r!==f&&r>=p&&r<=g&&0===h[r].loadError){var a,u;const n=h[r];if(t===o.FRAG_GAP&&m===c.MAIN&&e.frag){const t=h[r].details;if(t){const n=It(e.frag,t.fragments,e.frag.start);if(null!=n&&n.gap)continue}}else{if(S===l.AUDIO_TRACK&&n.hasAudioGroup(E)||S===l.SUBTITLE_TRACK&&n.hasSubtitleGroup(E))continue;if(m===c.AUDIO&&null!=(a=i.audioGroups)&&a.some(e=>n.hasAudioGroup(e))||m===c.SUBTITLE&&null!=(u=i.subtitleGroups)&&u.some(e=>n.hasSubtitleGroup(e))||y&&i.audioCodec===n.audioCodec||!y&&i.audioCodec!==n.audioCodec||T&&i.codecSet===n.codecSet)continue}d=r;break}}if(d>-1&&n.loadLevel!==d)return e.levelRetry=!0,this.playlistError=0,{action:Ut.SendAlternateToPenaltyBox,flags:Ft.None,nextAutoLevel:d}}return{action:Ut.SendAlternateToPenaltyBox,flags:Ft.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch(null==(n=t.errorAction)?void 0:n.action){case Ut.DoNothing:break;case Ut.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===o.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError()):t.fatal=!0;break;case Ut.RetryRequest:break}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i,hdcpLevel:r,nextAutoLevel:s}=n;switch(i){case Ft.None:this.switchLevel(e,s);break;case Ft.MoveAllAlternatesMatchingHDCP:r&&(t.maxHdcpLevel=Qe[Qe.indexOf(r)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,s)}switchLevel(e,t){if(void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===o.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&"audiovideo"!==e.sourceBufferName)){const t=He(e.mimeType),n=this.hls.levels;for(let i=n.length;i--;)n[i][`${e.sourceBufferName}Codec`]===t&&this.hls.removeLevel(i)}}}function jt(e){const t={action:Ut.DoNothing,flags:Ft.None};return e&&(t.resolved=!0),t}var $t={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class Gt{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.BUFFER_APPENDED,this.onBufferAppended,this),e.on(u.FRAG_BUFFERED,this.onFragBuffered,this),e.on(u.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.BUFFER_APPENDED,this.onBufferAppended,this),e.off(u.FRAG_BUFFERED,this.onFragBuffered,this),e.off(u.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let i=n.length;i--;){const t=n[i];if(!t)break;const r=t.end;if(t.start<=e&&null!==r&&e<=r)return t}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,n){const{fragments:i}=this,r=Object.keys(i);for(let s=r.length;s--;){const a=i[r[s]];if((null==a?void 0:a.body.type)===t&&(!n||a.buffered)){const t=a.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,n,i,r){this.timeRanges&&(this.timeRanges[e]=t);const s=(null==i?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(i=>{const a=this.fragments[i];if(!a)return;if(s>=a.body.sn)return;if(!a.buffered&&(!a.loaded||r))return void(a.body.type===n&&this.removeFragment(a.body));const o=a.range[e];o&&(0!==o.time.length?o.time.some(e=>{const n=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return n&&this.removeFragment(a.body),n}):this.removeFragment(a.body))})}detectPartialFragments(e){const t=this.timeRanges;if(!t||"initSegment"===e.frag.sn)return;const n=e.frag,i=Ht(n),r=this.fragments[i];if(!r||r.buffered&&n.gap)return;const s=!n.relurl;if(Object.keys(t).forEach(i=>{const a=n.elementaryStreams[i];if(!a)return;const o=t[i],u=s||!0===a.partial;r.range[i]=this.getBufferedTimes(n,e.part,u,o)}),r.loaded=null,Object.keys(r.range).length){r.buffered=!0;const e=r.body.endList=n.endList||r.body.endList;e&&(this.endListFragments[r.body.type]=r),Vt(r)||this.removeParts(n.sn-1,n.type)}else this.removeFragment(r.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=Kt(n,t=>t.fragment.sn>=e))}fragBuffered(e,t){const n=Ht(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){const r={time:[],partial:n},s=e.start,a=e.end,o=e.minEndPTS||a,u=e.maxStartPTS||s;for(let l=0;l<i.length;l++){const e=i.start(l)-this.bufferPadding,t=i.end(l)+this.bufferPadding;if(u>=e&&o<=t){r.time.push({startPTS:Math.max(s,i.start(l)),endPTS:Math.min(a,i.end(l))});break}if(s<t&&a>e){const e=Math.max(s,i.start(l)),t=Math.min(a,i.end(l));t>e&&(r.partial=!0,r.time.push({startPTS:e,endPTS:t}))}else if(a<=e)break}return r}getPartialFragment(e){let t,n,i,r=null,s=0;const{bufferPadding:a,fragments:o}=this;return Object.keys(o).forEach(u=>{const l=o[u];l&&Vt(l)&&(n=l.body.start-a,i=l.body.end+a,e>=n&&e<=i&&(t=Math.min(e-n,i-e),s<=t&&(r=l.body,s=t)))}),r}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||Vt(t))}getState(e){const t=Ht(e),n=this.fragments[t];return n?n.buffered?Vt(n)?$t.PARTIAL:$t.OK:$t.APPENDING:$t.NOT_LOADED}isTimeBuffered(e,t,n){let i,r;for(let s=0;s<n.length;s++){if(i=n.start(s)-this.bufferPadding,r=n.end(s)+this.bufferPadding,e>=i&&t<=r)return!0;if(t<=i)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if("initSegment"===t.frag.sn||t.frag.bitrateTest)return;const n=t.frag,i=t.part?null:t,r=Ht(n);this.fragments[r]={body:n,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:r,type:s}=t;if("initSegment"===n.sn)return;const a=n.type;if(i){let e=this.activePartLists[a];e||(this.activePartLists[a]=e=[]),e.push(i)}this.timeRanges=r;const o=r[s];this.detectEvictedFragments(s,o,a,i)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Ht(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,n=Object.keys(t);if(!e)return n.length>0;for(let i=n.length;i--;){const r=t[n[i]];if((null==r?void 0:r.body.type)===e)return!0}return!1}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,n,i,r){i&&!this.hasGaps||Object.keys(this.fragments).forEach(s=>{const a=this.fragments[s];if(!a)return;const o=a.body;o.type!==n||i&&!o.gap||o.start<t&&o.end>e&&(a.buffered||r)&&this.removeFragment(o)})}removeFragment(e){const t=Ht(e);e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const t=e.sn;this.activePartLists[e.type]=Kt(n,e=>e.fragment.sn!==t)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e,t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const n=null==(e=this.hls)||null==(t=e.latestLevelDetails)?void 0:t.partList;n&&n.forEach(e=>e.clearElementaryStreamInfo())}}function Vt(e){var t,n,i;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(n=e.range.audio)?void 0:n.partial)||(null==(i=e.range.audiovideo)?void 0:i.partial))}function Ht(e){return`${e.type}_${e.level}_${e.sn}`}function Kt(e,t){return e.filter(e=>{const n=t(e);return n||e.clearElementaryStreamInfo(),n})}var Wt={cbc:0,ctr:1};class qt{constructor(e,t,n){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=n}decrypt(e,t){switch(this.aesMode){case Wt.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case Wt.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function Yt(e){const t=e.byteLength,n=t&&new DataView(e.buffer).getUint8(t-1);return n?e.slice(0,t-n):e}class zt{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=t.getUint32(4*i);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],r=n[1],s=n[2],a=n[3],o=this.invSubMix,u=o[0],l=o[1],c=o[2],d=o[3],h=new Uint32Array(256);let f=0,p=0,g=0;for(g=0;g<256;g++)h[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){let n=p^p<<1^p<<2^p<<3^p<<4;n=n>>>8^255&n^99,e[f]=n,t[n]=f;const o=h[f],g=h[o],m=h[g];let v=257*h[n]^16843008*n;i[f]=v<<24|v>>>8,r[f]=v<<16|v>>>16,s[f]=v<<8|v>>>24,a[f]=v,v=16843009*m^65537*g^257*o^16843008*f,u[n]=v<<24|v>>>8,l[n]=v<<16|v>>>16,c[n]=v<<8|v>>>24,d[n]=v,f?(f=o^h[h[h[m^o]]],p^=h[h[p]]):f=p=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;while(i<t.length&&n)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);const s=this.ksRows=4*(r+6+1);let a,o;const u=this.keySchedule=new Uint32Array(s),l=this.invKeySchedule=new Uint32Array(s),c=this.sBox,d=this.rcon,h=this.invSubMix,f=h[0],p=h[1],g=h[2],m=h[3];let v,y;for(a=0;a<s;a++)a<r?v=u[a]=t[a]:(y=v,a%r===0?(y=y<<8|y>>>24,y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y],y^=d[a/r|0]<<24):r>6&&a%r===4&&(y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y]),u[a]=v=(u[a-r]^y)>>>0);for(o=0;o<s;o++)a=s-o,y=3&o?u[a]:u[a-4],l[o]=o<4||a<=4?y:f[c[y>>>24]]^p[c[y>>>16&255]]^g[c[y>>>8&255]]^m[c[255&y]],l[o]=l[o]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,r=this.invKeySchedule,s=this.invSBox,a=this.invSubMix,o=a[0],u=a[1],l=a[2],c=a[3],d=this.uint8ArrayToUint32Array_(n);let h=d[0],f=d[1],p=d[2],g=d[3];const m=new Int32Array(e),v=new Int32Array(m.length);let y,b,T,S,E,w,A,x,I,k,L,R,C,D;const M=this.networkToHostOrderSwap;while(t<m.length){for(I=M(m[t]),k=M(m[t+1]),L=M(m[t+2]),R=M(m[t+3]),E=I^r[0],w=R^r[1],A=L^r[2],x=k^r[3],C=4,D=1;D<i;D++)y=o[E>>>24]^u[w>>16&255]^l[A>>8&255]^c[255&x]^r[C],b=o[w>>>24]^u[A>>16&255]^l[x>>8&255]^c[255&E]^r[C+1],T=o[A>>>24]^u[x>>16&255]^l[E>>8&255]^c[255&w]^r[C+2],S=o[x>>>24]^u[E>>16&255]^l[w>>8&255]^c[255&A]^r[C+3],E=y,w=b,A=T,x=S,C+=4;y=s[E>>>24]<<24^s[w>>16&255]<<16^s[A>>8&255]<<8^s[255&x]^r[C],b=s[w>>>24]<<24^s[A>>16&255]<<16^s[x>>8&255]<<8^s[255&E]^r[C+1],T=s[A>>>24]<<24^s[x>>16&255]<<16^s[E>>8&255]<<8^s[255&w]^r[C+2],S=s[x>>>24]<<24^s[E>>16&255]<<16^s[w>>8&255]<<8^s[255&A]^r[C+3],v[t]=M(y^h),v[t+1]=M(S^f),v[t+2]=M(T^p),v[t+3]=M(b^g),h=I,f=k,p=L,g=R,t+=4}return v.buffer}}class Xt{constructor(e,t,n){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=n}expandKey(){const e=Qt(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function Qt(e){switch(e){case Wt.cbc:return"AES-CBC";case Wt.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${e}`)}}const Jt=16;class Zt{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(n){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?Yt(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n,i){return this.useSoftware?new Promise((r,s)=>{const a=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(a,t,n,i);const o=this.flush();o?r(o.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n,i)}softwareDecrypt(e,t,n,i){const{currentIV:r,currentResult:s,remainderData:a}=this;if(i!==Wt.cbc||16!==t.byteLength)return k.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),a&&(e=me(a,e),this.remainderData=null);const o=this.getValidChunk(e);if(!o.length)return null;r&&(n=r);let u=this.softwareDecrypter;u||(u=this.softwareDecrypter=new zt),u.expandKey(t);const l=s;return this.currentResult=u.decrypt(o.buffer,0,n),this.currentIV=o.slice(-16).buffer,l||null}webCryptoDecrypt(e,t,n,i){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n,i));this.key=t,this.fastAesKey=new Xt(this.subtle,t,i)}return this.fastAesKey.expandKey().then(t=>{if(!this.subtle)return Promise.reject(new Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");const r=new qt(this.subtle,new Uint8Array(n),i);return r.decrypt(e.buffer,t)}).catch(r=>(k.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,n,i)))}onWebCryptoError(e,t,n,i){const r=this.enableSoftwareAES;if(r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n,i);const r=this.flush();if(r)return r.buffer}throw new Error("WebCrypto"+(r?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%Jt;return n!==e.length&&(t=e.slice(0,n),this.remainderData=e.slice(n)),t}logOnce(e){this.logEnabled&&(k.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const en=Math.pow(2,17);class tn{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new an({type:a.NETWORK_ERROR,details:o.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(n?"part list":"url")),networkDetails:null}));this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise((u,l)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some(e=>"GAP"===e[0]))return void l(rn(e));e.gap=!1}const c=this.loader=r?new r(i):new s(i),d=nn(e);e.loader=c;const h=_t(i.fragLoadPolicy.default),f={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:en};e.stats=c.stats;const p={onSuccess:(t,n,i,r)=>{this.resetLoader(e,c);let s=t.data;i.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(s.slice(0,16)),s=s.slice(16)),u({frag:e,part:null,payload:s,networkDetails:r})},onError:(t,i,r,s)=>{this.resetLoader(e,c),l(new an({type:a.NETWORK_ERROR,details:o.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:m({url:n,data:void 0},t),error:new Error(`HTTP Error ${t.code} ${t.text}`),networkDetails:r,stats:s}))},onAbort:(t,n,i)=>{this.resetLoader(e,c),l(new an({type:a.NETWORK_ERROR,details:o.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:i,stats:t}))},onTimeout:(t,n,i)=>{this.resetLoader(e,c),l(new an({type:a.NETWORK_ERROR,details:o.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:i,stats:t}))}};t&&(p.onProgress=(n,i,r,s)=>t({frag:e,part:null,payload:r,networkDetails:s})),c.load(d,f,p)})}loadPart(e,t,n){this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise((u,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void l(rn(e,t));const c=this.loader=r?new r(i):new s(i),d=nn(e,t);e.loader=c;const h=_t(i.fragLoadPolicy.default),f={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:en};t.stats=c.stats,c.load(d,f,{onSuccess:(i,r,s,a)=>{this.resetLoader(e,c),this.updateStatsFromPart(e,t);const o={frag:e,part:t,payload:i.data,networkDetails:a};n(o),u(o)},onError:(n,i,r,s)=>{this.resetLoader(e,c),l(new an({type:a.NETWORK_ERROR,details:o.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:m({url:d.url,data:void 0},n),error:new Error(`HTTP Error ${n.code} ${n.text}`),networkDetails:r,stats:s}))},onAbort:(n,i,r)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,c),l(new an({type:a.NETWORK_ERROR,details:o.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:r,stats:n}))},onTimeout:(n,i,r)=>{this.resetLoader(e,c),l(new an({type:a.NETWORK_ERROR,details:o.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:r,stats:n}))}})})}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,r=i.total;if(n.loaded+=i.loaded,r){const i=Math.round(e.duration/t.duration),s=Math.min(Math.round(n.loaded/r),i),a=i-s,o=a*Math.round(n.loaded/s);n.total=n.loaded+o}else n.total=Math.max(n.loaded,n.total);const s=n.loading,a=i.loading;s.start?s.first+=a.first-a.start:(s.start=a.start,s.first=a.first),s.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function nn(e,t=null){const n=t||e,r={frag:e,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},s=n.byteRangeStartOffset,a=n.byteRangeEndOffset;if(i(s)&&i(a)){var o;let t=s,n=a;if("initSegment"===e.sn&&sn(null==(o=e.decryptdata)?void 0:o.method)){const e=a-s;e%16&&(n=a+(16-e%16)),0!==s&&(r.resetIV=!0,t=s-16)}r.rangeStart=t,r.rangeEnd=n}return r}function rn(e,t){const n=new Error(`GAP ${e.gap?"tag":"attribute"} found`),i={type:a.MEDIA_ERROR,details:o.FRAG_GAP,fatal:!1,frag:e,error:n,networkDetails:null};return t&&(i.part=t),(t||e).stats.aborted=!0,new an(i)}function sn(e){return"AES-128"===e||"AES-256"===e}class an extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class on extends b{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class un{constructor(e,t,n,i=0,r=-1,s=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=ln(),this.buffering={audio:ln(),video:ln(),audiovideo:ln()},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=r,this.partial=s}}function ln(){return{start:0,executeStart:0,executeEnd:0,end:0}}const cn={length:0,start:()=>0,end:()=>0};class dn{static isBuffered(e,t){if(e){const n=dn.getBuffered(e);for(let e=n.length;e--;)if(t>=n.start(e)&&t<=n.end(e))return!0}return!1}static bufferedRanges(e){if(e){const t=dn.getBuffered(e);return dn.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}static bufferInfo(e,t,n){if(e){const i=dn.bufferedRanges(e);if(i.length)return dn.bufferedInfo(i,t,n)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.length>1&&e.sort((e,t)=>e.start-t.start||t.end-e.end);let i=-1,r=[];if(n)for(let l=0;l<e.length;l++){t>=e[l].start&&t<=e[l].end&&(i=l);const s=r.length;if(s){const t=r[s-1].end;e[l].start-t<n?e[l].end>t&&(r[s-1].end=e[l].end):r.push(e[l])}else r.push(e[l])}else r=e;let s,a=0,o=t,u=t;for(let l=0;l<r.length;l++){const e=r[l].start,c=r[l].end;if(-1===i&&t>=e&&t<=c&&(i=l),t+n>=e&&t<c)o=e,u=c,a=u-t;else if(t+n<e){s=e;break}}return{len:a,start:o||0,end:u||0,nextStart:s,buffered:e,bufferedIndex:i}}static getBuffered(e){try{return e.buffered||cn}catch(t){return k.log("failed to get media.buffered",t),cn}}}const hn=/\{\$([a-zA-Z0-9-_]+)\}/g;function fn(e){return hn.test(e)}function pn(e,t){if(null!==e.variableList||e.hasVariableRefs){const n=e.variableList;return t.replace(hn,t=>{const i=t.substring(2,t.length-1),r=null==n?void 0:n[i];return void 0===r?(e.playlistParsingError||(e.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),t):r})}return t}function gn(e,t,n){let i,r,s=e.variableList;if(s||(e.variableList=s={}),"QUERYPARAM"in t){i=t.QUERYPARAM;try{const e=new self.URL(n).searchParams;if(!e.has(i))throw new Error(`"${i}" does not match any query parameter in URI: "${n}"`);r=e.get(i)}catch(a){e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else i=t.NAME,r=t.VALUE;i in s?e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):s[i]=r||""}function mn(e,t,n){const i=t.IMPORT;if(n&&i in n){let t=e.variableList;t||(e.variableList=t={}),t[i]=n[i]}else e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}const vn=/^(\d+)x(\d+)$/,yn=/(.+?)=(".*?"|.*?)(?:,|$)/g;class bn{constructor(e,t){"string"===typeof e&&(e=bn.parseAttrList(e,t)),p(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>"X-"===e.substring(0,2))}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const n=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)n[e]=parseInt(t.slice(2*e,2*e+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const n=this[e];return(n?n.split(/[ ,]+/):[]).reduce((e,t)=>(e[t.toLowerCase()]=!0,e),t)}bool(e){return"YES"===this[e]}decimalResolution(e){const t=vn.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let n;const i={},r='"';yn.lastIndex=0;while(null!==(n=yn.exec(e))){const s=n[1].trim();let a=n[2];const o=0===a.indexOf(r)&&a.lastIndexOf(r)===a.length-1;let u=!1;if(o)a=a.slice(1,-1);else switch(s){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":u=!0}if(t&&(o||u))a=pn(t,a);else if(!u&&!o)switch(s){case"CLOSED-CAPTIONS":if("NONE"===a)break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":k.warn(`${e}: attribute ${s} is missing quotes`)}i[s]=a}return i}}const Tn="com.apple.hls.interstitial";function Sn(e){return"ID"!==e&&"CLASS"!==e&&"CUE"!==e&&"START-DATE"!==e&&"DURATION"!==e&&"END-DATE"!==e&&"END-ON-NEXT"!==e}function En(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e||"SCTE35-CMD"===e}class wn{constructor(e,t,n=0){var r;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(null==t?void 0:t.tagAnchor)||null,this.tagOrder=null!=(r=null==t?void 0:t.tagOrder)?r:n,t){const n=t.attr;for(const t in n)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==n[t]){k.warn(`DATERANGE tag attribute: "${t}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=t;break}e=p(new bn({}),n,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const e=(null==t?void 0:t.endDate)||new Date(this.attr["END-DATE"]);i(e.getTime())&&(this._endDate=e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return void 0===e?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return null===e||null===e.programDateTime?(k.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return null!==t?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*t):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(i(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===Tn}get isValid(){return!!this.id&&!this._badValueForSameId&&i(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const An=10;class xn{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1}get hasProgramDateTime(){return!!this.fragments.length&&i(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||An}get drift(){const e=this.driftEndTime-this.driftStartTime;if(e>0){const t=this.driftEnd-this.driftStart;return 1e3*t/e}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(-1!==t){for(let n=e.length;n--;)if(e[n].index>t)return e[n].index;return t}}return 0}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function In(e){return"AES-128"===e||"AES-256"===e||"AES-256-CTR"===e}function kn(e){switch(e){case"AES-128":case"AES-256":return Wt.cbc;case"AES-256-CTR":return Wt.ctr;default:throw new Error(`invalid full segment method ${e}`)}}function Ln(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}function Rn(e){return Uint8Array.from(unescape(encodeURIComponent(e)),e=>e.charCodeAt(0))}function Cn(e){const t=Rn(e).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}function Dn(e){const t=function(e,t,n){const i=e[t];e[t]=e[n],e[n]=i};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}function Mn(e){const t=e.split(":");let n=null;if("data"===t[0]&&2===t.length){const e=t[1].split(";"),i=e[e.length-1].split(",");if(2===i.length){const t="base64"===i[0],r=i[1];t?(e.splice(-1,1),n=Ln(r)):n=Cn(r)}}return n}const Pn="undefined"!==typeof self?self:void 0;var _n={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},On={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Nn(e){switch(e){case On.FAIRPLAY:return _n.FAIRPLAY;case On.PLAYREADY:return _n.PLAYREADY;case On.WIDEVINE:return _n.WIDEVINE;case On.CLEARKEY:return _n.CLEARKEY}}var Un={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function Fn(e){return e===Un.WIDEVINE?_n.WIDEVINE:e===Un.PLAYREADY?_n.PLAYREADY:e===Un.CENC||e===Un.CLEARKEY?_n.CLEARKEY:void 0}function Bn(e){switch(e){case _n.FAIRPLAY:return On.FAIRPLAY;case _n.PLAYREADY:return On.PLAYREADY;case _n.WIDEVINE:return On.WIDEVINE;case _n.CLEARKEY:return On.CLEARKEY}}function jn(e){const{drmSystems:t,widevineLicenseUrl:n}=e,i=t?[_n.FAIRPLAY,_n.WIDEVINE,_n.PLAYREADY,_n.CLEARKEY].filter(e=>!!t[e]):[];return!i[_n.WIDEVINE]&&n&&i.push(_n.WIDEVINE),i}const $n=function(e){return null!=Pn&&null!=(e=Pn.navigator)&&e.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function Gn(e,t,n,i){let r;switch(e){case _n.FAIRPLAY:r=["cenc","sinf"];break;case _n.WIDEVINE:case _n.PLAYREADY:r=["cenc"];break;case _n.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${e}`)}return Vn(r,t,n,i)}function Vn(e,t,n,i){const r={initDataTypes:e,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map(e=>({contentType:`audio/mp4; codecs=${e}`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:n.map(e=>({contentType:`video/mp4; codecs=${e}`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))};return[r]}function Hn(e){var t;return"persistent-license"===e.sessionType||!(null==(t=e.sessionTypes)||!t.some(e=>"persistent-license"===e))}function Kn(e){const t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),n=String.fromCharCode.apply(null,Array.from(t)),i=n.substring(n.indexOf("<"),n.length),r=new DOMParser,s=r.parseFromString(i,"text/xml"),a=s.getElementsByTagName("KID")[0];if(a){const e=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(e){const t=Ln(e).subarray(0,16);return Dn(t),t}}return null}let Wn={};class qn{static clearKeyUriToKeyIdMap(){Wn={}}constructor(e,t,n,i=[1],r=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=r,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&!In(e)}isSupported(){if(this.method){if(In(this.method)||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case On.FAIRPLAY:case On.WIDEVINE:case On.PLAYREADY:case On.CLEARKEY:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(In(this.method)&&this.uri&&!this.iv){"number"!==typeof e&&(k.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const t=Yn(e),n=new qn(this.method,this.uri,"identity",this.keyFormatVersions,t);return n}const t=Mn(this.uri);if(t)switch(this.keyFormat){case On.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case On.PLAYREADY:{const e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Ae(e,null,t),this.keyId=Kn(t);break}default:{let e=t.subarray(0,16);if(16!==e.length){const t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e;break}}if(!this.keyId||16!==this.keyId.byteLength){let e=Wn[this.uri];if(!e){const t=Object.keys(Wn).length%Number.MAX_SAFE_INTEGER;e=new Uint8Array(16);const n=new DataView(e.buffer,12,4);n.setUint32(0,t),Wn[this.uri]=e}this.keyId=e}return this}}function Yn(e){const t=new Uint8Array(16);for(let n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}const zn=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Xn=/#EXT-X-MEDIA:(.*)/g,Qn=/^#EXT(?:INF|-X-TARGETDURATION):/m,Jn=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),Zn=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class ei{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static resolve(e,t){return U.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return Qn.test(e)}static parseMasterPlaylist(e,t){const n=fn(e),i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},r=[];let s;zn.lastIndex=0;while(null!=(s=zn.exec(e)))if(s[1]){var a;const e=new bn(s[1],i),n=pn(i,s[2]),o={attrs:e,bitrate:e.decimalInteger("BANDWIDTH")||e.decimalInteger("AVERAGE-BANDWIDTH"),name:e.NAME,url:ei.resolve(n,t)},u=e.decimalResolution("RESOLUTION");u&&(o.width=u.width,o.height=u.height),si(e.CODECS,o);const l=e["SUPPLEMENTAL-CODECS"];l&&(o.supplemental={},si(l,o.supplemental)),null!=(a=o.unknownCodecs)&&a.length||r.push(o),i.levels.push(o)}else if(s[3]){const e=s[3],n=s[4];switch(e){case"SESSION-DATA":{const e=new bn(n,i),t=e["DATA-ID"];t&&(null===i.sessionData&&(i.sessionData={}),i.sessionData[t]=e);break}case"SESSION-KEY":{const e=ii(n,t,i);e.encrypted&&e.isSupported()?(null===i.sessionKeys&&(i.sessionKeys=[]),i.sessionKeys.push(e)):k.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${n}"`);break}case"DEFINE":{const e=new bn(n,i);gn(i,e,t)}break;case"CONTENT-STEERING":{const e=new bn(n,i);i.contentSteering={uri:ei.resolve(e["SERVER-URI"],t),pathwayId:e["PATHWAY-ID"]||"."};break}case"START":i.startTimeOffset=ri(n);break}}const o=r.length>0&&r.length<i.levels.length;return i.levels=o?r:i.levels,0===i.levels.length&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,t,n){let i;const r={},s=n.levels,a={AUDIO:s.map(e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec})),SUBTITLES:s.map(e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec})),"CLOSED-CAPTIONS":[]};let o=0;Xn.lastIndex=0;while(null!==(i=Xn.exec(e))){const e=new bn(i[1],n),s=e.TYPE;if(s){const n=a[s],i=r[s]||[];r[s]=i;const u=e.LANGUAGE,l=e["ASSOC-LANGUAGE"],c=e.CHANNELS,d=e.CHARACTERISTICS,h=e["INSTREAM-ID"],f={attrs:e,bitrate:0,id:o++,groupId:e["GROUP-ID"]||"",name:e.NAME||u||"",type:s,default:e.bool("DEFAULT"),autoselect:e.bool("AUTOSELECT"),forced:e.bool("FORCED"),lang:u,url:e.URI?ei.resolve(e.URI,t):""};if(l&&(f.assocLang=l),c&&(f.channels=c),d&&(f.characteristics=d),h&&(f.instreamId=h),null!=n&&n.length){const e=ei.findGroup(n,f.groupId)||n[0];ai(f,e,"audioCodec"),ai(f,e,"textCodec")}i.push(f)}}return r}static parseLevelPlaylist(e,t,n,r,s,a){var o;const u={url:t},l=new xn(t),c=l.fragments,d=[];let h,f,g,m,v=null,y=0,b=0,T=0,S=0,E=0,w=null,A=new G(r,u),x=-1,I=!1,L=null;if(Jn.lastIndex=0,l.m3u8=e,l.hasVariableRefs=fn(e),"#EXTM3U"!==(null==(o=Jn.exec(e))?void 0:o[0]))return l.playlistParsingError=new Error("Missing format identifier #EXTM3U"),l;while(null!==(h=Jn.exec(e))){I&&(I=!1,A=new G(r,u),A.playlistOffset=T,A.start=T,A.sn=y,A.cc=S,E&&(A.bitrate=E),A.level=n,v&&(A.initSegment=v,v.rawProgramDateTime&&(A.rawProgramDateTime=v.rawProgramDateTime,v.rawProgramDateTime=null),L&&(A.setByteRange(L),L=null)));const e=h[1];if(e){A.duration=parseFloat(e);const t=(" "+h[2]).slice(1);A.title=t||null,A.tagList.push(t?["INF",e,t]:["INF",e])}else if(h[3]){if(i(A.duration)){A.playlistOffset=T,A.start=T,g&&ci(A,g,l),A.sn=y,A.level=n,A.cc=S,c.push(A);const e=(" "+h[3]).slice(1);A.relurl=pn(l,e),ui(A,w,d),w=A,T+=A.duration,y++,b=0,I=!0}}else{if(h=h[0].match(Zn),!h){k.warn("No matches on slow regex match for level playlist!");continue}for(f=1;f<h.length;f++)if(void 0!==h[f])break;const e=(" "+h[f]).slice(1),s=(" "+h[f+1]).slice(1),o=h[f+2]?(" "+h[f+2]).slice(1):null;switch(e){case"BYTERANGE":w?A.setByteRange(s,w):A.setByteRange(s);break;case"PROGRAM-DATE-TIME":A.rawProgramDateTime=s,A.tagList.push(["PROGRAM-DATE-TIME",s]),-1===x&&(x=c.length);break;case"PLAYLIST-TYPE":l.type&&di(l,e,h),l.type=s.toUpperCase();break;case"MEDIA-SEQUENCE":0!==l.startSN?di(l,e,h):c.length>0&&hi(l,e,h),y=l.startSN=parseInt(s);break;case"SKIP":{l.skippedSegments&&di(l,e,h);const t=new bn(s,l),n=t.decimalInteger("SKIPPED-SEGMENTS");if(i(n)){l.skippedSegments+=n;for(let e=n;e--;)c.push(null);y+=n}const r=t.enumeratedString("RECENTLY-REMOVED-DATERANGES");r&&(l.recentlyRemovedDateranges=(l.recentlyRemovedDateranges||[]).concat(r.split("\t")));break}case"TARGETDURATION":0!==l.targetduration&&di(l,e,h),l.targetduration=Math.max(parseInt(s),1);break;case"VERSION":null!==l.version&&di(l,e,h),l.version=parseInt(s);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":l.live||di(l,e,h),l.live=!1;break;case"#":(s||o)&&A.tagList.push(o?[s,o]:[s]);break;case"DISCONTINUITY":S++,A.tagList.push(["DIS"]);break;case"GAP":A.gap=!0,A.tagList.push([e]);break;case"BITRATE":A.tagList.push([e,s]),E=1e3*parseInt(s),i(E)?A.bitrate=E:E=0;break;case"DATERANGE":{const e=new bn(s,l),t=new wn(e,l.dateRanges[e.ID],l.dateRangeTagCount);l.dateRangeTagCount++,t.isValid||l.skippedSegments?l.dateRanges[t.id]=t:k.warn(`Ignoring invalid DATERANGE tag: "${s}"`),A.tagList.push(["EXT-X-DATERANGE",s]);break}case"DEFINE":{const e=new bn(s,l);"IMPORT"in e?mn(l,e,a):gn(l,e,t)}break;case"DISCONTINUITY-SEQUENCE":0!==l.startCC?di(l,e,h):c.length>0&&hi(l,e,h),l.startCC=S=parseInt(s);break;case"KEY":{const e=ii(s,t,l);if(e.isSupported()){if("NONE"===e.method){g=void 0;break}g||(g={}),g[e.keyFormat]&&(g=p({},g)),g[e.keyFormat]=e}else k.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${s}"`);break}case"START":l.startTimeOffset=ri(s);break;case"MAP":{const e=new bn(s,l);if(A.duration){const t=new G(r,u);li(t,e,n,g),v=t,A.initSegment=v,v.rawProgramDateTime&&!A.rawProgramDateTime&&(A.rawProgramDateTime=v.rawProgramDateTime)}else{const t=A.byteRangeEndOffset;if(t){const e=A.byteRangeStartOffset;L=`${t-e}@${e}`}else L=null;li(A,e,n,g),v=A,I=!0}v.cc=S;break}case"SERVER-CONTROL":m&&di(l,e,h),m=new bn(s),l.canBlockReload=m.bool("CAN-BLOCK-RELOAD"),l.canSkipUntil=m.optionalFloat("CAN-SKIP-UNTIL",0),l.canSkipDateRanges=l.canSkipUntil>0&&m.bool("CAN-SKIP-DATERANGES"),l.partHoldBack=m.optionalFloat("PART-HOLD-BACK",0),l.holdBack=m.optionalFloat("HOLD-BACK",0);break;case"PART-INF":{l.partTarget&&di(l,e,h);const t=new bn(s);l.partTarget=t.decimalFloatingPoint("PART-TARGET");break}case"PART":{let e=l.partList;e||(e=l.partList=[]);const t=b>0?e[e.length-1]:void 0,n=b++,i=new bn(s,l),r=new V(i,A,u,n,t);e.push(r),A.duration+=r.duration;break}case"PRELOAD-HINT":{const e=new bn(s,l);l.preloadHint=e;break}case"RENDITION-REPORT":{const e=new bn(s,l);l.renditionReports=l.renditionReports||[],l.renditionReports.push(e);break}default:k.warn(`line parsed but not handled: ${h}`);break}}}w&&!w.relurl?(c.pop(),T-=w.duration,l.partList&&(l.fragmentHint=w)):l.partList&&(ui(A,w,d),A.cc=S,l.fragmentHint=A,g&&ci(A,g,l)),l.targetduration||(l.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const R=c.length,C=c[0],D=c[R-1];if(T+=l.skippedSegments*l.targetduration,T>0&&R&&D){l.averagetargetduration=T/R;const e=D.sn;l.endSN="initSegment"!==e?e:0,l.live||(D.endList=!0),C&&void 0===l.startCC&&(l.startCC=C.cc),x>0&&(oi(c,x),C&&d.unshift(C))}else l.endSN=0,l.startCC=0;return l.fragmentHint&&(T+=l.fragmentHint.duration),l.totalduration=T,d.length&&l.dateRangeTagCount&&C&&ti(d,l),l.endCC=S,l}}function ti(e,t){const n=e.length;if(!n)return;const i=e[n-1],r=t.live?1/0:t.totalduration,s=Object.keys(t.dateRanges);for(let a=s.length;a--;){const o=t.dateRanges[s[a]],u=o.startDate.getTime();o.tagAnchor=i.ref;for(let i=n;i--;){const n=ni(t,u,e,i,r);if(-1!==n){o.tagAnchor=t.fragments[n].ref;break}}}}function ni(e,t,n,i,r){const s=n[i];if(s){const o=s.programDateTime;if(t>=o||0===i){var a;const u=((null==(a=n[i+1])?void 0:a.start)||r)-s.start;if(t<=o+1e3*u){const r=n[i].sn-e.startSN,s=e.fragments;if(s.length>n.length){const a=n[i+1]||s[s.length-1],o=a.sn-e.startSN;for(let e=o;e>r;e--){const n=s[e].programDateTime;if(t>=n&&t<n+1e3*s[e].duration)return e}}return r}}}return-1}function ii(e,t,n){var i,r;const s=new bn(e,n),a=null!=(i=s.METHOD)?i:"",o=s.URI,u=s.hexadecimalInteger("IV"),l=s.KEYFORMATVERSIONS,c=null!=(r=s.KEYFORMAT)?r:"identity";o&&s.IV&&!u&&k.error(`Invalid IV: ${s.IV}`);const d=o?ei.resolve(o,t):"",h=(l||"1").split("/").map(Number).filter(Number.isFinite);return new qn(a,d,c,h,u)}function ri(e){const t=new bn(e),n=t.decimalFloatingPoint("TIME-OFFSET");return i(n)?n:null}function si(e,t){let n=(e||"").split(/[ ,]+/).filter(e=>e);["video","audio","text"].forEach(e=>{const i=n.filter(t=>Re(t,e));i.length&&(t[`${e}Codec`]=i.map(e=>e.split("/")[0]).join(","),n=n.filter(e=>-1===i.indexOf(e)))}),t.unknownCodecs=n}function ai(e,t,n){const i=t[n];i&&(e[n]=i)}function oi(e,t){let n=e[t];for(let i=t;i--;){const t=e[i];if(!t)return;t.programDateTime=n.programDateTime-1e3*t.duration,n=t}}function ui(e,t,n){e.rawProgramDateTime?n.push(e):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime)}function li(e,t,n,i){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=n,e.sn="initSegment",i&&(e.levelkeys=i),e.initSegment=null}function ci(e,t,n){e.levelkeys=t;const{encryptedFragments:i}=n;i.length&&i[i.length-1].levelkeys===t||!Object.keys(t).some(e=>t[e].isCommonEncryption)||i.push(e)}function di(e,t,n){e.playlistParsingError=new Error(`#EXT-X-${t} must not appear more than once (${n[0]})`)}function hi(e,t,n){e.playlistParsingError=new Error(`#EXT-X-${t} must appear before the first Media Segment (${n[0]})`)}function fi(e,t){const n=t.startPTS;if(i(n)){let i,r=0;t.sn>e.sn?(r=n-e.start,i=e):(r=e.start-n,i=t),i.duration!==r&&i.setDuration(r)}else if(t.sn>e.sn){const n=e.cc===t.cc;n&&e.minEndPTS?t.setStart(e.start+(e.minEndPTS-e.start)):t.setStart(e.start+e.duration)}else t.setStart(Math.max(e.start-t.duration,0))}function pi(e,t,n,r,s,a){const o=r-n;o<=0&&(k.warn("Fragment should have a positive duration",t),r=n+t.duration,a=s+t.duration);let u=n,l=r;const c=t.startPTS,d=t.endPTS;if(i(c)){const e=Math.abs(c-n);i(t.deltaPTS)?t.deltaPTS=Math.max(e,t.deltaPTS):t.deltaPTS=e,u=Math.max(n,c),n=Math.min(n,c),s=Math.min(s,t.startDTS),l=Math.min(r,d),r=Math.max(r,d),a=Math.max(a,t.endDTS)}const h=n-t.start;0!==t.start&&t.setStart(n),t.setDuration(r-t.start),t.startPTS=n,t.maxStartPTS=u,t.startDTS=s,t.endPTS=r,t.minEndPTS=l,t.endDTS=a;const f=t.sn;if(!e||f<e.startSN||f>e.endSN)return 0;let p;const g=f-e.startSN,m=e.fragments;for(m[g]=t,p=g;p>0;p--)fi(m[p],m[p-1]);for(p=g;p<m.length-1;p++)fi(m[p],m[p+1]);return e.fragmentHint&&fi(m[m.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,h}function gi(e,t){if(e===t)return;let n=null;const r=e.fragments;for(let i=r.length-1;i>=0;i--){const e=r[i].initSegment;if(e){n=e;break}}let s;e.fragmentHint&&delete e.fragmentHint.endPTS,yi(e,t,(e,r,a,o)=>{if((!t.startCC||t.skippedSegments)&&r.cc!==e.cc){const n=e.cc-r.cc;for(let e=a;e<o.length;e++)o[e].cc+=n;t.endCC=o[o.length-1].cc}i(e.startPTS)&&i(e.endPTS)&&(r.setStart(r.startPTS=e.startPTS),r.startDTS=e.startDTS,r.maxStartPTS=e.maxStartPTS,r.endPTS=e.endPTS,r.endDTS=e.endDTS,r.minEndPTS=e.minEndPTS,r.setDuration(e.endPTS-e.startPTS),r.duration&&(s=r),t.PTSKnown=t.alignedSliding=!0),e.hasStreams&&(r.elementaryStreams=e.elementaryStreams),r.loader=e.loader,e.hasStats&&(r.stats=e.stats),e.initSegment&&(r.initSegment=e.initSegment,n=e.initSegment)});const a=t.fragments,o=t.fragmentHint?a.concat(t.fragmentHint):a;if(n&&o.forEach(e=>{var t;!e||e.initSegment&&e.initSegment.relurl!==(null==(t=n)?void 0:t.relurl)||(e.initSegment=n)}),t.skippedSegments){if(t.deltaUpdateFailed=a.some(e=>!e),t.deltaUpdateFailed){k.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let e=t.skippedSegments;e--;)a.shift();t.startSN=a[0].sn}else{t.canSkipDateRanges&&(t.dateRanges=mi(e.dateRanges,t));const n=e.fragments.filter(e=>e.rawProgramDateTime);if(e.hasProgramDateTime&&!t.hasProgramDateTime)for(let e=1;e<o.length;e++)null===o[e].programDateTime&&ui(o[e],o[e-1],n);ti(n,t)}t.endCC=a[a.length-1].cc}if(!t.startCC){var u;const n=wi(e,t.startSN-1);t.startCC=null!=(u=null==n?void 0:n.cc)?u:a[0].cc}vi(e.partList,t.partList,(e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats}),s?pi(t,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):Ti(e,t),a.length&&(t.totalduration=t.edge-a[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;const l=t.advancedDateTime;if(t.advanced&&l){const e=t.edge;t.driftStart||(t.driftStartTime=l,t.driftStart=e),t.driftEndTime=l,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime;-1===t.requestScheduled&&(t.requestScheduled=e.requestScheduled)}function mi(e,t){const{dateRanges:n,recentlyRemovedDateranges:i}=t,r=p({},e);i&&i.forEach(e=>{delete r[e]});const s=Object.keys(r),a=s.length;return a&&Object.keys(n).forEach(e=>{const t=r[e],i=new wn(n[e].attr,t);i.isValid?(r[e]=i,t||(i.tagOrder+=a)):k.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${lt(n[e].attr)}"`)}),r}function vi(e,t,n){if(e&&t){let i=0;for(let r=0,s=e.length;r<=s;r++){const s=e[r],a=t[r+i];s&&a&&s.index===a.index&&s.fragment.sn===a.fragment.sn?n(s,a):i--}}}function yi(e,t,n){const i=t.skippedSegments,r=Math.max(e.startSN,t.startSN)-t.startSN,s=(e.fragmentHint?1:0)+(i?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,a=t.startSN-e.startSN,o=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,u=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let l=r;l<=s;l++){const r=u[a+l];let s=o[l];if(i&&!s&&r&&(s=t.fragments[l]=r),r&&s){if(n(r,s,l,o),r.url&&r.url!==s.url)return void(t.playlistParsingError=bi(`media sequence mismatch ${s.sn}:`,e,t,r,s));if(r.cc!==s.cc)return void(t.playlistParsingError=bi(`discontinuity sequence mismatch (${r.cc}!=${s.cc})`,e,t,r,s))}}}function bi(e,t,n,i,r){return new Error(`${e} ${r.url}\nPlaylist starting @${t.startSN}\n${t.m3u8}\n\nPlaylist starting @${n.startSN}\n${n.m3u8}`)}function Ti(e,t,n=!0){const i=t.startSN+t.skippedSegments-e.startSN,r=e.fragments,s=i>=0;let a=0;if(s&&i<r.length)a=r[i].start;else if(s&&t.startSN===e.endSN+1)a=e.fragmentEnd;else if(s&&n)a=e.fragmentStart+i*t.levelTargetDuration;else{if(t.skippedSegments||0!==t.fragmentStart)return;a=e.fragmentStart}Si(t,a)}function Si(e,t){if(t){const n=e.fragments;for(let i=e.skippedSegments;i<n.length;i++)n[i].addStart(t);e.fragmentHint&&e.fragmentHint.addStart(t)}}function Ei(e,t=1/0){let n=1e3*e.targetduration;if(e.updated){const i=e.fragments,r=4;if(i.length&&n*r>t){const e=1e3*i[i.length-1].duration;e<n&&(n=e)}}else n/=2;return Math.round(n)}function wi(e,t,n){if(!e)return null;let i=e.fragments[t-e.startSN];return i||(i=e.fragmentHint,i&&i.sn===t?i:t<e.startSN&&n&&n.sn===t?n:null)}function Ai(e,t,n){return e?xi(e.partList,t,n):null}function xi(e,t,n){if(e)for(let i=e.length;i--;){const r=e[i];if(r.index===n&&r.fragment.sn===t)return r}return null}function Ii(e){e.forEach((e,t)=>{var n;null==(n=e.details)||n.fragments.forEach(e=>{e.level=t,e.initSegment&&(e.initSegment.level=t)})})}function ki(e,t){for(let i=0,r=e.length;i<r;i++){var n;if((null==(n=e[i])?void 0:n.cc)===t)return e[i]}return null}function Li(e,t){return!!(e&&t.startCC<e.endCC&&t.endCC>e.startCC)}function Ri(e,t){if(e){const n=e.start+t;e.start=e.startPTS=n,e.endPTS=n+e.duration}}function Ci(e,t){const n=t.fragments;for(let i=0,r=n.length;i<r;i++)Ri(n[i],e);t.fragmentHint&&Ri(t.fragmentHint,e),t.alignedSliding=!0}function Di(e,t){e&&(Mi(t,e),!t.alignedSliding&&e&&Pi(t,e),t.alignedSliding||!e||t.skippedSegments||Ti(e,t,!1))}function Mi(e,t){if(!Li(t,e))return;const n=Math.min(t.endCC,e.endCC),i=ki(t.fragments,n),r=ki(e.fragments,n);if(!i||!r)return;k.log(`Aligning playlist at start of dicontinuity sequence ${n}`);const s=i.start-r.start;Ci(s,e)}function Pi(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;const n=e.fragments,i=t.fragments;if(!n.length||!i.length)return;let r,s;const a=Math.min(t.endCC,e.endCC);t.startCC<a&&e.startCC<a&&(r=ki(i,a),s=ki(n,a)),r&&s||(r=i[Math.floor(i.length/2)],s=ki(n,r.cc)||n[Math.floor(n.length/2)]);const o=r.programDateTime,u=s.programDateTime;if(!o||!u)return;const l=(u-o)/1e3-(s.start-r.start);Ci(l,e)}const _i={toString:function(e){let t="";const n=e.length;for(let i=0;i<n;i++)t+=`[${e.start(i).toFixed(3)}-${e.end(i).toFixed(3)}]`;return t}},Oi={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Ni extends on{constructor(e,t,n,r,s){super(r,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Oi.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:e,fragCurrent:t,media:n,mediaBuffer:r,state:s}=this,a=n?n.currentTime:0,o=dn.bufferInfo(r||n,a,e.maxBufferHole);if(this.log(`media seeking to ${i(a)?a.toFixed(3):a}, state: ${s}`),this.state===Oi.ENDED)this.resetLoadingState();else if(t){const n=e.maxFragLookUpTolerance,i=t.start-n,r=t.start+t.duration+n;if(!o.len||r<o.start||i>o.end){const e=a>r;(a<i||e)&&(e&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(n){this.fragmentTracker.removeFragmentsInRange(a,1/0,this.playlistType,!0);const e=this.lastCurrentTime;if(a>e&&(this.lastCurrentTime=a),!this.loadingParts){const e=Math.max(o.end,a),t=this.shouldLoadParts(this.getLevelDetails(),e);t&&(this.log(`LL-Part loading ON after seeking to ${a.toFixed(2)} with buffer @${e.toFixed(2)}`),this.loadingParts=t)}}this.hls.hasEnoughToStart||o.len||(this.log(`setting startPosition to ${a} because of seek before start`),this.nextLoadPosition=this.startPosition=a),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=s,this.hls=e,this.fragmentLoader=new tn(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Zt(e.config)}registerListeners(){const{hls:e}=this;e.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(u.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(u.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===Oi.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Oi.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return-1===t&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const n=e.end||0,i=this.config.timelineOffset||0;if(n<=i)return!1;const r=e.buffered;this.config.maxBufferHole&&r&&r.length>1&&(e=dn.bufferedInfo(r,e.start,0));const s=e.nextStart,a=s&&s>i&&s<t.edge;if(a)return!1;if(this.media.currentTime<e.start)return!1;const o=t.partList;if(null!=o&&o.length){const e=o[o.length-1],t=dn.isBuffered(this.media,e.start+e.duration/2);return t}const u=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(u)}getLevelDetails(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levelLastLoaded)?void 0:e.details}get timelineOffset(){const e=this.config.timelineOffset;var t;return e?(null==(t=this.getLevelDetails())?void 0:t.appliedTimelineOffset)||e:0}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;n.removeEventListener("seeking",this.onMediaSeeking),n.removeEventListener("ended",this.onMediaEnded),n.addEventListener("seeking",this.onMediaSeeking),n.addEventListener("ended",this.onMediaEnded);const i=this.config;this.levels&&i.autoStartLoad&&this.state===Oi.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(e,t){const n=!!t.transferMedia,i=this.media;if(null!==i){if(i.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),i.removeEventListener("seeking",this.onMediaSeeking),i.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!n&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,n)return this.resetLoadingState(),void this.resetTransmuxer();this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=Oi.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this.startFragRequested=!0,this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const i=e=>{const t=e.frag;if(this.fragContextChanged(t))return this.warn(`${t.type} sn: ${t.sn}${e.part?" part: "+e.part.index:""} of ${this.fragInfo(t,!1,e.part)}) was dropped during download.`),void this.fragmentTracker.removeFragment(t);t.stats.chunkCount++,this._handleFragmentLoadProgress(e)};this._doFragLoad(e,t,n,i).then(e=>{if(!e)return;const t=this.state,n=e.frag;this.fragContextChanged(n)?(t===Oi.FRAG_LOADING||!this.fragCurrent&&t===Oi.PARSING)&&(this.fragmentTracker.removeFragment(n),this.state=Oi.IDLE):("payload"in e&&(this.log(`Loaded ${n.type} sn: ${n.sn} of ${this.playlistLabel()} ${n.level}`),this.hls.trigger(u.FRAG_LOADED,e)),this._handleFragmentLoadComplete(e))}).catch(t=>{this.state!==Oi.STOPPED&&this.state!==Oi.ERROR&&(this.warn(`Frag error: ${(null==t?void 0:t.message)||t}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this,i=n.getState(e);if(i===$t.APPENDING){const t=e.type,i=this.getFwdBufferInfo(this.mediaBuffer,t),r=Math.max(e.duration,i?i.len:this.config.maxBufferLength),s=this.backtrackFragment,a=s?e.sn-s.sn:0;(1===a||this.reduceMaxBufferLength(r,e.duration))&&n.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===$t.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(null==t?void 0:t.live)&&"EVENT"!==t.type&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:n};this.hls.trigger(u.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(e=>{const t=null==e?void 0:e.frag;if(!t||this.fragContextChanged(t)||!this.levels)throw new Error("init load aborted");return e}).then(e=>{const{hls:t}=this,{frag:n,payload:i}=e,r=n.decryptdata;if(i&&i.byteLength>0&&null!=r&&r.key&&r.iv&&In(r.method)){const s=self.performance.now();return this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer,kn(r.method)).catch(e=>{throw t.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:n}),e}).then(i=>{const r=self.performance.now();return t.trigger(u.FRAG_DECRYPTED,{frag:n,payload:i,stats:{tstart:s,tdecrypt:r}}),e.payload=i,this.completeInitSegmentLoad(e)})}return this.completeInitSegmentLoad(e)}).catch(t=>{this.state!==Oi.STOPPED&&this.state!==Oi.ERROR&&(this.warn(t),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state!==Oi.STOPPED&&(this.state=Oi.IDLE),e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const n=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${n?_i.toString(dn.getBuffered(n)):"(detached)"})`),$(e)){var i;if(e.type!==c.SUBTITLE){const t=e.elementaryStreams;if(!Object.keys(t).some(e=>!!t[e]))return void(this.state=Oi.IDLE)}const t=null==(i=this.levels)?void 0:i[e.level];null!=t&&t.fragmentError&&(this.log(`Resetting level fragment error count of ${t.fragmentError} on frag buffered`),t.fragmentError=0)}this.state=Oi.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:r}=e,s=!r||0===r.length||r.some(e=>!e),a=new un(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!s);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,r){var s;this.fragCurrent=e;const a=null==t?void 0:t.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;!e.encrypted||null!=(s=e.decryptdata)&&s.key?e.encrypted||(o=this.keyLoader.loadClear(e,a.encryptedFragments),o&&this.log("[eme] blocking frag load until media-keys acquired")):(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=Oi.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger(u.KEY_LOADED,e),this.state===Oi.KEY_LOADING&&(this.state=Oi.IDLE),e}),this.hls.trigger(u.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING"))));const l=this.fragPrevious;if($(e)&&(!l||e.sn!==l.sn)){const n=this.shouldLoadParts(t.details,e.end);n!==this.loadingParts&&(this.log(`LL-Part loading ${n?"ON":"OFF"} loading sn ${null==l?void 0:l.sn}->${e.sn}`),this.loadingParts=n)}if(n=Math.max(e.start,n||0),this.loadingParts&&$(e)){const i=a.partList;if(i&&r){n>e.end&&a.fragmentHint&&(e=a.fragmentHint);const s=this.getNextPart(i,e,n);if(s>-1){const l=i[s];let c;return e=this.fragCurrent=l.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${l.index} (${s}/${i.length-1}) of ${this.fragInfo(e,!1,l)}) cc: ${e.cc} [${a.startSN}-${a.endSN}], target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=l.start+l.duration,this.state=Oi.FRAG_LOADING,c=o?o.then(n=>!n||this.fragContextChanged(n.frag)?null:this.doFragPartsLoad(e,l,t,r)).catch(e=>this.handleFragLoadError(e)):this.doFragPartsLoad(e,l,t,r).catch(e=>this.handleFragLoadError(e)),this.hls.trigger(u.FRAG_LOADING,{frag:e,part:l,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):c}if(!e.url||this.loadedEndOfParts(i,n))return Promise.resolve(null)}}if($(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${n.toFixed(2)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${a?"["+a.startSN+"-"+a.endSN+"]":""}, target: ${parseFloat(n.toFixed(3))}`),i(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Oi.FRAG_LOADING;const c=this.config.progressive;let d;return d=c&&o?o.then(t=>!t||this.fragContextChanged(null==t?void 0:t.frag)?null:this.fragmentLoader.load(e,r)).catch(e=>this.handleFragLoadError(e)):Promise.all([this.fragmentLoader.load(e,c?r:void 0),o]).then(([e])=>(!c&&e&&r&&r(e),e)).catch(e=>this.handleFragLoadError(e)),this.hls.trigger(u.FRAG_LOADING,{frag:e,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):d}doFragPartsLoad(e,t,n,i){return new Promise((r,s)=>{var a;const o=[],l=null==(a=n.details)?void 0:a.partList,c=t=>{this.fragmentLoader.loadPart(e,t,i).then(i=>{o[t.index]=i;const s=i.part;this.hls.trigger(u.FRAG_LOADED,i);const a=Ai(n.details,e.sn,t.index+1)||xi(l,e.sn,t.index+1);if(!a)return r({frag:e,part:s,partsLoaded:o});c(a)}).catch(s)};c(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===o.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(u.ERROR,t)}else this.hls.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==Oi.PARSING)return void(this.fragCurrent||this.state===Oi.STOPPED||this.state===Oi.ERROR||(this.state=Oi.IDLE));const{frag:n,part:i,level:r}=t,s=self.performance.now();n.stats.parsing.end=s,i&&(i.stats.parsing.end=s);const a=this.getLevelDetails(),o=a&&n.sn>a.endSN,u=o||this.shouldLoadParts(a,n.end);u!==this.loadingParts&&(this.log(`LL-Part loading ${u?"ON":"OFF"} after parsing segment ending @${n.end.toFixed(2)}`),this.loadingParts=u),this.updateLevelTiming(n,i,r,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(null!=e&&e.partList){var n;const r=e.partList[0],s=r.end+((null==(n=e.fragmentHint)?void 0:n.duration)||0);if(t>=s){var i;const e=this.hls.hasEnoughToStart?(null==(i=this.media)?void 0:i.currentTime)||this.lastCurrentTime:this.getLoadPosition();if(e>r.start-r.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:r,part:s}=e;if(null==t||!t[i])return this.warn(`Levels object was unset while buffering fragment ${r} of ${this.playlistLabel()} ${i}. The current chunk will not be buffered.`),null;const a=t[i],o=a.details,u=s>-1?Ai(o,r,s):null,l=u?u.fragment:wi(o,r,n);return l?(n&&n!==l&&(l.stats=n.stats),{frag:l,part:u,level:a}):null}bufferFragmentData(e,t,n,i,r){var s;if(!e||this.state!==Oi.PARSING)return;const{data1:a,data2:o}=e;let l=a;if(a&&o&&(l=me(a,o)),null==(s=l)||!s.length)return;const c={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:l};if(this.hls.trigger(u.BUFFER_APPENDING,c),e.dropped&&e.independent&&!n){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!dn.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const n=t.currentTime,i=dn.bufferInfo(t,n,0),r=e.duration,s=Math.min(2*this.config.maxFragLookUpTolerance,.25*r),a=Math.max(Math.min(e.start-s,i.end-s),n+s);e.start-a>s&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){var n;const r=this.getLoadPosition();if(!i(r))return null;const s=this.lastCurrentTime>r,a=s||null!=(n=this.media)&&n.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,r,t,a)}getFwdBufferInfoAtPos(e,t,n,i){const r=dn.bufferInfo(e,t,i);if(0===r.len&&void 0!==r.nextStart){const s=this.fragmentTracker.getBufferedFrag(t,n);if(s&&(r.nextStart<=s.end||s.gap)){const n=Math.max(Math.min(r.nextStart,s.end)-t,i);return dn.bufferInfo(e,t,n)}}return r}getMaxBufferLength(e){const{config:t}=this;let n;return n=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,i=Math.max(Math.min(e-t,n.maxBufferLength),t),r=Math.max(e-3*t,n.maxMaxBufferLength/2,i);return r>=i&&(n.maxMaxBufferLength=r,this.warn(`Reduce max buffer length to ${r}s`),!0)}getAppendedFrag(e,t=c.MAIN){var n;const i=null==(n=this.fragmentTracker)?void 0:n.getAppendedFrag(e,t);return i&&"fragment"in i?i.fragment:i}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:r}=this,s=n[0].start,a=r.lowLatencyMode&&!!t.partList;let o=null;if(t.live){const n=r.initialLiveManifestSize;if(i<n)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${n})`),null;if(!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||e<s){var u;a&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),o=this.getInitialLiveFragment(t);const n=this.hls.startPosition,i=this.hls.liveSyncPosition,r=o?(-1!==n&&n>=s?n:i)||o.start:e;this.log(`Setting startPosition to ${r} to match start frag at live edge. mainStart: ${n} liveSyncPosition: ${i} frag.start: ${null==(u=o)?void 0:u.start}`),this.startPosition=this.nextLoadPosition=r}}else e<=s&&(o=n[0]);if(!o){const n=this.loadingParts?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,n,t)}let l=this.filterReplacedPrimary(o,t);if(!l&&o){const e=o.sn-t.startSN;l=this.filterReplacedPrimary(n[e+1]||null,t)}return this.mapToInitFragWhenRequired(l)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===$t.OK||n===$t.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,r){let s=null;if(e.gap&&(s=this.getNextFragment(this.nextLoadPosition,t),s&&!s.gap&&n.nextStart)){const e=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i,0);if(null!==e&&n.len+e.len>=r){const e=s.sn;return this.loopSn!==e&&(this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e}`),this.loopSn=e),null}}return this.loopSn=void 0,s}get primaryPrefetch(){if(Ui(this.hls.config)){var e,t;const n=null==(e=this.hls.interstitialsManager)||null==(t=e.playingItem)?void 0:t.event;if(n)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(Ui(this.hls.config)&&e.type!==c.SUBTITLE){const n=this.hls.interstitialsManager,i=null==n?void 0:n.bufferingItem;if(i){const n=i.event;if(n){if(n.appendInPlace||Math.abs(e.start-i.start)>1||0===i.start)return null}else{if(e.end<=i.start&&!1===(null==t?void 0:t.live))return null;if(e.start>i.end&&i.nextEvent&&(i.nextEvent.appendInPlace||e.start-i.end>1))return null}}const r=null==n?void 0:n.playerQueue;if(r)for(let t=r.length;t--;){const n=r[t].interstitial;if(n.appendInPlace&&e.start>=n.startTime&&e.end<=n.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,n){let i=-1,r=!1,s=!0;for(let a=0,o=e.length;a<o;a++){const o=e[a];if(s=s&&!o.independent,i>-1&&n<o.start)break;const u=o.loaded;u?i=-1:(r||o.independent||s)&&o.fragment===t&&(i=a),r=u}return i}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e){const t=e.fragments,n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=xt(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const r=n.sn+1;if(r>=e.startSN&&r<=e.endSN){const s=t[r-e.startSN];n.cc===s.cc&&(i=s,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=Ct(e,n.cc,n.end),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const t=this.hls.liveSyncPosition;null!==t&&(i=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:r}=this,{fragments:s,endSN:a}=n;const{fragmentHint:o}=n,{maxFragLookUpTolerance:u}=i,l=n.partList,c=!!(this.loadingParts&&null!=l&&l.length&&o);let d;if(c&&o&&!this.bitrateTest&&l[l.length-1].fragment.sn===o.sn&&(s=s.concat(o),a=o.sn),e<t){var h;const n=e<this.lastCurrentTime,i=n||e>t-u||null!=(h=this.media)&&h.paused||!this.startFragRequested?0:u;d=It(r,s,e,i)}else d=s[s.length-1];if(d){const e=d.sn-n.startSN,t=this.fragmentTracker.getState(d);if((t===$t.OK||t===$t.PARTIAL&&d.gap)&&(r=d),r&&d.sn===r.sn&&(!c||l[0].fragment.sn>d.sn||!n.live&&!c)){const t=r&&d.level===r.level;if(t){const t=s[e+1];d=d.sn<a&&this.fragmentTracker.getState(t)!==$t.OK?t:null}}}return d}alignPlaylists(e,t,n){const r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const s=e.fragmentStart,a=!t,o=e.alignedSliding&&i(s);if(a||!o&&!s){Di(n,e);const i=e.fragmentStart;return this.log(`Live playlist sliding: ${i.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${r}`),i}return s}waitForCdnTuneIn(e){const t=3;return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*t)}setStartPosition(e,t){let n=this.startPosition;n<t&&(n=-1);const r=this.timelineOffset;if(-1===n){const s=null!==this.startTimeOffset,a=s?this.startTimeOffset:e.startTimeOffset;null!==a&&i(a)?(n=t+a,a<0&&(n+=e.edge),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Setting startPosition to ${n} for start time offset ${a} found in ${s?"multivariant":"media"} playlist`),this.startPosition=n):e.live?(n=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${n}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=n=0),this.lastCurrentTime=n+r}this.nextLoadPosition=n+r}getLoadPosition(){var e;const{media:t}=this;let n=0;return null!=(e=this.hls)&&e.hasEnoughToStart&&t?n=t.currentTime:this.nextLoadPosition>=0&&(n=this.nextLoadPosition),n}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&$(e)&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===Oi.FRAG_LOADING_WAITING_RETRY)||(this.state=Oi.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;var i;if(this.fragContextChanged(n))return void this.warn(`Frag load error must match current frag to retry ${n.url} > ${null==(i=this.fragCurrent)?void 0:i.url}`);const r=t.details===o.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(n,!0);const s=t.errorAction,{action:a,flags:u,retryCount:l=0,retryConfig:c}=s||{},d=!!s&&!!c,h=d&&a===Ut.RetryRequest,f=d&&!s.resolved&&u===Ft.MoveAllAlternatesMatchingHost;if(!h&&f&&$(n)&&!n.endList)this.resetFragmentErrors(e),this.treatAsGap(n),s.resolved=!0;else if((h||f)&&l<c.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);const i=Pt(c,l);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${l+1}/${c.maxNumRetry} in ${i}ms`),s.resolved=!0,this.retryDate=self.performance.now()+i,this.state=Oi.FRAG_LOADING_WAITING_RETRY}else if(c&&s){if(this.resetFragmentErrors(e),!(l<c.maxNumRetry))return void this.warn(`${t.details} reached or exceeded max retry (${l})`);r||a===Ut.RemoveAlternatePermanently||(s.resolved=!0)}else a===Ut.SendAlternateToPenaltyBox?this.state=Oi.WAITING_LEVEL:this.state=Oi.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Oi.PARSING||this.state===Oi.PARSED){const t=e.frag,n=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),r=i&&i.len>.5;r&&this.reduceMaxBufferLength(i.len,(null==t?void 0:t.duration)||10);const s=!r;return s&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(e){e===c.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==Oi.STOPPED&&(this.state=Oi.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const i=dn.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===Oi.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==Oi.STOPPED&&(this.state=Oi.IDLE)}resetStartWhenNotLoaded(e){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=e?e.details:null;null!=t&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of ${this.playlistLabel()} ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){const r=n.details;if(!r)return void this.warn("level.details undefined");const s=Object.keys(e.elementaryStreams).reduce((t,s)=>{const a=e.elementaryStreams[s];if(a){const o=a.endPTS-a.startPTS;if(o<=0)return this.warn(`Could not parse fragment ${e.sn} ${s} duration reliably (${o})`),t||!1;const l=i?0:pi(r,e,a.startPTS,a.endPTS,a.startDTS,a.endDTS);return this.hls.trigger(u.LEVEL_PTS_UPDATED,{details:r,level:n,drift:l,type:s,frag:e,start:a.startPTS,end:a.endPTS}),!0}return t},!1);var l;if(!s&&(0===n.fragmentError&&this.treatAsGap(e,n),null===(null==(l=this.transmuxer)?void 0:l.error))){const t=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(t.message),this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Oi.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(u.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===c.MAIN?"level":"track"}fragInfo(e,t=!0,n){var i,r;return`${this.playlistLabel()} ${e.level} (${n?"part":"frag"}:[${(null!=(i=t&&!n?e.startPTS:(n||e).start)?i:NaN).toFixed(3)}-${(null!=(r=t&&!n?e.endPTS:(n||e).end)?r:NaN).toFixed(3)}]${n&&"main"===e.type?"INDEPENDENT="+(n.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;null==(e=this.transmuxer)||e.reset()}recoverWorkerError(e){"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function Ui(e){return!!e.interstitialsController&&!1!==e.enableInterstitialPlayback}class Fi{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;return e.length?(n=1===e.length?e[0]:Bi(e,t),this.reset(),n):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function Bi(e,t){const n=new Uint8Array(t);let i=0;for(let r=0;r<e.length;r++){const t=e[r];n.set(t,i),i+=t.length}return n}var ji,$i={exports:{}};function Gi(){return ji||(ji=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,i,s,a){if("function"!==typeof i)throw new TypeError("The listener must be a function");var o=new r(i,s||e,a),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],o]:e._events[u].push(o):(e._events[u]=o,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new i:delete e._events[t]}function o(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a},o.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},o.prototype.emit=function(e,t,i,r,s,a){var o=n?n+e:e;if(!this._events[o])return!1;var u,l,c=this._events[o],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,r),!0;case 5:return c.fn.call(c.context,t,i,r,s),!0;case 6:return c.fn.call(c.context,t,i,r,s,a),!0}for(l=1,u=new Array(d-1);l<d;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var h,f=c.length;for(l=0;l<f;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),d){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,i);break;case 4:c[l].fn.call(c[l].context,t,i,r);break;default:if(!u)for(h=1,u=new Array(d-1);h<d;h++)u[h-1]=arguments[h];c[l].fn.apply(c[l].context,u)}}return!0},o.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,i,r){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||r&&!o.once||i&&o.context!==i||a(this,s);else{for(var u=0,l=[],c=o.length;u<c;u++)(o[u].fn!==t||r&&!o[u].once||i&&o[u].context!==i)&&l.push(o[u]);l.length?this._events[s]=1===l.length?l[0]:l:a(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}($i)),$i.exports}var Vi=Gi(),Hi=P(Vi);const Ki="1.6.5",Wi={};function qi(){return"function"===typeof __HLS_WORKER_BUNDLE__}function Yi(){const e=Wi[Ki];if(e)return e.clientCount++,e;const t=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),n=self.URL.createObjectURL(t),i=new self.Worker(n),r={worker:i,objectURL:n,clientCount:1};return Wi[Ki]=r,r}function zi(e){const t=Wi[e];if(t)return t.clientCount++,t;const n=new self.URL(e,self.location.href).href,i=new self.Worker(n),r={worker:i,scriptURL:n,clientCount:1};return Wi[e]=r,r}function Xi(e){const t=Wi[e||Ki];if(t){const n=t.clientCount--;if(1===n){const{worker:n,objectURL:i}=t;delete Wi[e||Ki],i&&self.URL.revokeObjectURL(i),n.terminate()}}}function Qi(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function Ji(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function Zi(e,t){let n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3],n}function er(e,t){const n=t;let i=0;while(Ji(e,t)){i+=10;const n=Zi(e,t+6);i+=n,Qi(e,t+10)&&(i+=10),t+=i}if(i>0)return e.subarray(n,n+i)}function tr(e,t,n,i){const r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],s=t[n+2],l=s>>2&15;if(l>12){const t=new Error(`invalid ADTS sampling index:${l}`);return void e.emit(u.ERROR,u.ERROR,{type:a.MEDIA_ERROR,details:o.FRAG_PARSING_ERROR,fatal:!0,error:t,reason:t.message})}const c=1+(s>>6&3),d=t[n+3]>>6&3|(1&s)<<2,h="mp4a.40."+c,f=r[l];let p=l;5!==c&&29!==c||(p-=3);const g=[c<<3|(14&p)>>1,(1&p)<<7|d<<3];return k.log(`manifest codec:${i}, parsed codec:${h}, channels:${d}, rate:${f} (ADTS object type:${c} sampling index:${l})`),{config:g,samplerate:f,channelCount:d,codec:h,parsedCodec:h,manifestCodec:i}}function nr(e,t){return 255===e[t]&&240===(246&e[t+1])}function ir(e,t){return 1&e[t+1]?7:9}function rr(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function sr(e,t){return t+5<e.length}function ar(e,t){return t+1<e.length&&nr(e,t)}function or(e,t){return sr(e,t)&&nr(e,t)&&rr(e,t)<=e.length-t}function ur(e,t){if(ar(e,t)){const n=ir(e,t);if(t+n>=e.length)return!1;const i=rr(e,t);if(i<=n)return!1;const r=t+i;return r===e.length||ar(e,r)}return!1}function lr(e,t,n,i,r){if(!e.samplerate){const s=tr(t,n,i,r);if(!s)return;p(e,s)}}function cr(e){return 9216e4/e}function dr(e,t){const n=ir(e,t);if(t+n<=e.length){const i=rr(e,t)-n;if(i>0)return{headerLength:n,frameLength:i}}}function hr(e,t,n,i,r){const s=cr(e.samplerate),a=i+r*s,o=dr(t,n);let u;if(o){const{frameLength:i,headerLength:r}=o,s=r+i,l=Math.max(0,n+s-t.length);l?(u=new Uint8Array(s-r),u.set(t.subarray(n+r,t.length),0)):u=t.subarray(n+r,n+s);const c={unit:u,pts:a};return l||e.samples.push(c),{sample:c,length:s,missing:l}}const l=t.length-n;u=new Uint8Array(l),u.set(t.subarray(n,t.length),0);const c={unit:u,pts:a};return{sample:c,length:l,missing:-1}}function fr(e,t){return Ji(e,t)&&Zi(e,t+6)+10<=e.length-t}function pr(e){return e instanceof ArrayBuffer?e:0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer}function gr(e,t=0,n=1/0){return mr(e,t,n,Uint8Array)}function mr(e,t,n,i){const r=vr(e);let s=1;"BYTES_PER_ELEMENT"in i&&(s=i.BYTES_PER_ELEMENT);const a=yr(e)?e.byteOffset:0,o=(a+e.byteLength)/s,u=(a+t)/s,l=Math.floor(Math.max(0,Math.min(u,o))),c=Math.floor(Math.min(l+Math.max(n,0),o));return new i(r,l,c-l)}function vr(e){return e instanceof ArrayBuffer?e:e.buffer}function yr(e){return e&&e.buffer instanceof ArrayBuffer&&void 0!==e.byteLength&&void 0!==e.byteOffset}function br(e){const t={key:e.type,description:"",data:"",mimeType:null,pictureType:null},n=3;if(e.size<2)return;if(e.data[0]!==n)return void console.log("Ignore frame with unrecognized character encoding");const i=e.data.subarray(1).indexOf(0);if(-1===i)return;const r=D(gr(e.data,1,i)),s=e.data[2+i],a=e.data.subarray(3+i).indexOf(0);if(-1===a)return;const o=D(gr(e.data,3+i,a));let u;return u="--\x3e"===r?D(gr(e.data,4+i+a)):pr(e.data.subarray(4+i+a)),t.mimeType=r,t.pictureType=s,t.description=o,t.data=u,t}function Tr(e){if(e.size<2)return;const t=D(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}}function Sr(e){if(e.size<2)return;if("TXXX"===e.type){let t=1;const n=D(e.data.subarray(t),!0);t+=n.length+1;const i=D(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=D(e.data.subarray(1));return{key:e.type,info:"",data:t}}function Er(e){if("WXXX"===e.type){if(e.size<2)return;let t=1;const n=D(e.data.subarray(t),!0);t+=n.length+1;const i=D(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=D(e.data);return{key:e.type,info:"",data:t}}function wr(e){return"PRIV"===e.type?Tr(e):"W"===e.type[0]?Er(e):"APIC"===e.type?br(e):Sr(e)}function Ar(e){const t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=Zi(e,4),i=10;return{type:t,size:n,data:e.subarray(i,i+n)}}const xr=10,Ir=10;function kr(e){let t=0;const n=[];while(Ji(e,t)){const i=Zi(e,t+6);e[t+5]>>6&1&&(t+=xr),t+=xr;const r=t+i;while(t+Ir<r){const i=Ar(e.subarray(t)),r=wr(i);r&&n.push(r),t+=i.size+xr}Qi(e,t)&&(t+=xr)}return n}function Lr(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info}function Rr(e){if(8===e.data.byteLength){const t=new Uint8Array(e.data),n=1&t[3];let i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,n&&(i+=47721858.84),Math.round(i)}}function Cr(e){const t=kr(e);for(let n=0;n<t.length;n++){const e=t[n];if(Lr(e))return Rr(e)}}let Dr=function(e){return e["audioId3"]="org.id3",e["dateRange"]="com.apple.quicktime.HLS",e["emsg"]="https://aomedia.org/emsg/ID3",e["misbklv"]="urn:misb:KLV:bin:1910.1",e}({});function Mr(e="",t=9e4){return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class Pr{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=me(this.cachedData,e),this.cachedData=null);let n,r=er(e,0),s=r?r.length:0;const a=this._audioTrack,o=this._id3Track,u=r?Cr(r):void 0,l=e.length;(null===this.basePTS||0===this.frameIndex&&i(u))&&(this.basePTS=_r(u,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),r&&r.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Dr.audioId3,duration:Number.POSITIVE_INFINITY});while(s<l){if(this.canParse(e,s)){const t=this.appendFrame(a,e,s);t?(this.frameIndex++,this.lastPTS=t.sample.pts,s+=t.length,n=s):s=l}else fr(e,s)?(r=er(e,s),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Dr.audioId3,duration:Number.POSITIVE_INFINITY}),s+=r.length,n=s):s++;if(s===l&&n!==l){const t=e.slice(n);this.cachedData?this.cachedData=me(this.cachedData,t):this.cachedData=t}}return{audioTrack:a,videoTrack:Mr(),id3Track:o,textTrack:Mr()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Mr(),id3Track:this._id3Track,textTrack:Mr()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const _r=(e,t,n)=>{if(i(e))return 90*e;const r=n?9e4*n.baseTime/n.timescale:0;return 9e4*t+r};let Or=null;const Nr=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Ur=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Fr=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Br=[0,1,1,4];function jr(e,t,n,i,r){if(n+24>t.length)return;const s=$r(t,n);if(s&&n+s.frameLength<=t.length){const a=9e4*s.samplesPerFrame/s.sampleRate,o=i+r*a,u={unit:t.subarray(n,n+s.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=s.channelCount,e.samplerate=s.sampleRate,e.samples.push(u),{sample:u,length:s.frameLength,missing:0}}}function $r(e,t){const n=e[t+1]>>3&3,i=e[t+1]>>1&3,r=e[t+2]>>4&15,s=e[t+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==s){const a=e[t+2]>>1&1,o=e[t+3]>>6,u=3===n?3-i:3===i?3:4,l=1e3*Nr[14*u+r-1],c=3===n?0:2===n?1:2,d=Ur[3*c+s],h=3===o?1:2,f=Fr[n][i],p=Br[i],g=8*f*p,m=Math.floor(f*l/d+a)*p;if(null===Or){const e=navigator.userAgent||"",t=e.match(/Chrome\/(\d+)/i);Or=t?parseInt(t[1]):0}const v=!!Or&&Or<=87;return v&&2===i&&l>=224e3&&0===o&&(e[t+3]=128|e[t+3]),{sampleRate:d,channelCount:h,frameLength:m,samplesPerFrame:g}}}function Gr(e,t){return 255===e[t]&&224===(224&e[t+1])&&0!==(6&e[t+1])}function Vr(e,t){return t+1<e.length&&Gr(e,t)}function Hr(e,t){const n=4;return Gr(e,t)&&n<=e.length-t}function Kr(e,t){if(t+1<e.length&&Gr(e,t)){const n=4,i=$r(e,t);let r=n;null!=i&&i.frameLength&&(r=i.frameLength);const s=t+r;return s===e.length||Vr(e,s)}return!1}class Wr extends Pr{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const n=er(e,0);let i=(null==n?void 0:n.length)||0;if(Kr(e,i))return!1;for(let r=e.length;i<r;i++)if(ur(e,i))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return or(e,t)}appendFrame(e,t,n){lr(e,this.observer,t,n,e.manifestCodec);const i=hr(e,t,n,this.basePTS,this.frameIndex);if(i&&0===i.missing)return i}}const qr=(e,t)=>{let n=0,i=5;t+=i;const r=new Uint32Array(1),s=new Uint32Array(1),a=new Uint8Array(1);while(i>0){a[0]=e[t];const o=Math.min(i,8),u=8-o;s[0]=4278190080>>>24+u<<u,r[0]=(a[0]&s[0])>>u,n=n?n<<o|r[0]:r[0],t+=1,i-=o}return n};class Yr extends Pr{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const i=zr(e,t,n,this.basePTS,this.frameIndex);if(-1!==i){const t=e.samples[e.samples.length-1];return{sample:t,length:i,missing:0}}}static probe(e){if(!e)return!1;const t=er(e,0);if(!t)return!1;const n=t.length;return 11===e[n]&&119===e[n+1]&&void 0!==Cr(t)&&qr(e,n)<16}}function zr(e,t,n,i,r){if(n+8>t.length)return-1;if(11!==t[n]||119!==t[n+1])return-1;const s=t[n+4]>>6;if(s>=3)return-1;const a=[48e3,44100,32e3],o=a[s],u=63&t[n+4],l=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920],c=2*l[3*u+s];if(n+c>t.length)return-1;const d=t[n+6]>>5;let h=0;2===d?h+=2:(1&d&&1!==d&&(h+=2),4&d&&(h+=2));const f=(t[n+6]<<8|t[n+7])>>12-h&1,p=[2,1,2,3,3,4,4,5],g=p[d]+f,m=t[n+5]>>3,v=7&t[n+5],y=new Uint8Array([s<<6|m<<1|v>>2,(3&v)<<6|d<<3|f<<2|u>>4,u<<4&224]),b=1536/o*9e4,T=i+r*b,S=t.subarray(n,n+c);return e.config=y,e.channelCount=g,e.samplerate=o,e.samples.push({unit:S,pts:T}),c}class Xr extends Pr{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=er(e,0);let n=(null==t?void 0:t.length)||0;if(t&&11===e[n]&&119===e[n+1]&&void 0!==Cr(t)&&qr(e,n)<=16)return!1;for(let i=e.length;n<i;n++)if(Kr(e,n))return k.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return Hr(e,t)}appendFrame(e,t,n){if(null!==this.basePTS)return jr(e,t,n,this.basePTS,this.frameIndex)}}const Qr=/\/emsg[-/]ID3/i;class Jr{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const r=this.videoTrack=Mr("video",1),s=this.audioTrack=Mr("audio",1),a=this.txtTrack=Mr("text",1);if(this.id3Track=Mr("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const o=re(e);if(o.video){const{id:e,timescale:t,codec:n,supplemental:i}=o.video;r.id=e,r.timescale=a.timescale=t,r.codec=n,r.supplemental=i}if(o.audio){const{id:e,timescale:t,codec:n}=o.audio;s.id=e,s.timescale=t,s.codec=n}a.id=Y.text,r.sampleDuration=0,r.duration=s.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return te(e)}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=me(this.remainderData,e));const t=ge(n);this.remainderData=t.remainder,i.samples=t.valid||new Uint8Array}else i.samples=n;const s=this.extractID3Track(i,t);return r.samples=ve(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=ve(e,t),{videoTrack:t,audioTrack:Mr(),id3Track:i,textTrack:Mr()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=ne(e.samples,["emsg"]);i&&i.forEach(e=>{const i=Ee(e);if(Qr.test(i.schemeIdUri)){const e=Zr(i,t);let r=4294967295===i.eventDuration?Number.POSITIVE_INFINITY:i.eventDuration/i.timeScale;r<=.001&&(r=Number.POSITIVE_INFINITY);const s=i.payload;n.samples.push({data:s,len:s.byteLength,dts:e,pts:e,type:Dr.emsg,duration:r})}else if(this.config.enableEmsgKLVMetadata&&i.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const e=Zr(i,t);n.samples.push({data:i.payload,len:i.payload.byteLength,dts:e,pts:e,type:Dr.misbklv,duration:Number.POSITIVE_INFINITY})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function Zr(e,t){return i(e.presentationTime)?e.presentationTime/e.timeScale:t+e.presentationTimeDelta/e.timeScale}class es{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new Zt(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,Wt.cbc)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const r=i.subarray(16,i.length-i.length%16),s=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(s).then(r=>{const s=new Uint8Array(r);i.set(s,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)n.set(e.subarray(r,r+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)e.set(n.subarray(i,i+16),r);return e}decryptAvcSample(e,t,n,i,r){const s=Se(r.data),a=this.getAvcEncryptedData(s);this.decryptBuffer(a.buffer).then(a=>{r.data=this.getAvcDecryptedUnit(s,a),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)})}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length)return void i();const r=e[t].units;for(;;n++){if(n>=r.length)break;const s=r[n];if(!(s.data.length<=48||1!==s.type&&5!==s.type)&&(this.decryptAvcSample(e,t,n,i,s),!this.decrypter.isSync()))return}}}}class ts{constructor(){this.VideoSample=null}createVideoSample(e,t,n){return{key:e,frame:!1,pts:t,dts:n,units:[],length:0}}getLastNalUnit(e){var t;let n,i=this.VideoSample;if(i&&0!==i.units.length||(i=e[e.length-1]),null!=(t=i)&&t.units){const e=i.units;n=e[e.length-1]}return n}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){const n=t.samples,i=n.length;if(!i)return void t.dropped++;{const t=n[i-1];e.pts=t.pts,e.dts=t.dts}}t.samples.push(e)}}parseNALu(e,t,n){const i=t.byteLength;let r=e.naluState||0;const s=r,a=[];let o,u,l,c=0,d=-1,h=0;-1===r&&(d=0,h=this.getNALuType(t,0),r=0,c=1);while(c<i)if(o=t[c++],r)if(1!==r)if(o)if(1===o){if(u=c-r-1,d>=0){const e={data:t.subarray(d,u),type:h};a.push(e)}else{const n=this.getLastNalUnit(e.samples);n&&(s&&c<=4-s&&n.state&&(n.data=n.data.subarray(0,n.data.byteLength-s)),u>0&&(n.data=me(n.data,t.subarray(0,u)),n.state=0))}c<i?(l=this.getNALuType(t,c),d=c,h=l,r=0):r=-1}else r=0;else r=3;else r=o?0:2;else r=o?0:1;if(d>=0&&r>=0){const e={data:t.subarray(d,i),type:h,state:r};a.push(e)}if(0===a.length){const n=this.getLastNalUnit(e.samples);n&&(n.data=me(n.data,t))}return e.naluState=r,a}}class ns{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");i.set(e.subarray(n,n+r)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&k.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(0!==(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class is extends ts{parsePES(e,t,n,i){const r=this.parseNALu(e,n.data,i);let s,a=this.VideoSample,o=!1;n.data=null,a&&r.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),r.forEach(i=>{var r,u;switch(i.type){case 1:{let t=!1;s=!0;const r=i.data;if(o&&r.length>4){const e=this.readSliceType(r);2!==e&&4!==e&&7!==e&&9!==e||(t=!0)}var l;if(t)null!=(l=a)&&l.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null);a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.frame=!0,a.key=t;break}case 5:s=!0,null!=(r=a)&&r.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 6:s=!0,Te(i.data,1,n.pts,t.samples);break;case 7:{var c,d;s=!0,o=!0;const t=i.data,n=this.readSPS(t);if(!e.sps||e.width!==n.width||e.height!==n.height||(null==(c=e.pixelRatio)?void 0:c[0])!==n.pixelRatio[0]||(null==(d=e.pixelRatio)?void 0:d[1])!==n.pixelRatio[1]){e.width=n.width,e.height=n.height,e.pixelRatio=n.pixelRatio,e.sps=[t];const i=t.subarray(1,4);let r="avc1.";for(let e=0;e<3;e++){let t=i[e].toString(16);t.length<2&&(t="0"+t),r+=t}e.codec=r}break}case 8:s=!0,e.pps=[i.data];break;case 9:s=!0,e.audFound=!0,null!=(u=a)&&u.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;case 12:s=!0;break;default:s=!1;break}if(a&&s){const e=a.units;e.push(i)}}),i&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}getNALuType(e,t){return 31&e[t]}readSliceType(e){const t=new ns(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let n,i=8,r=8;for(let s=0;s<e;s++)0!==r&&(n=t.readEG(),r=(i+n+256)%256),i=0===r?i:r}readSPS(e){const t=new ns(e);let n,i,r,s=0,a=0,o=0,u=0;const l=t.readUByte.bind(t),c=t.readBits.bind(t),d=t.readUEG.bind(t),h=t.readBoolean.bind(t),f=t.skipBits.bind(t),p=t.skipEG.bind(t),g=t.skipUEG.bind(t),m=this.skipScalingList.bind(this);l();const v=l();if(c(5),f(3),l(),g(),100===v||110===v||122===v||244===v||44===v||83===v||86===v||118===v||128===v){const e=d();if(3===e&&f(1),g(),g(),f(1),h())for(i=3!==e?8:12,r=0;r<i;r++)h()&&m(r<6?16:64,t)}g();const y=d();if(0===y)d();else if(1===y)for(f(1),p(),p(),n=d(),r=0;r<n;r++)p();g(),f(1);const b=d(),T=d(),S=c(1);0===S&&f(1),f(1),h()&&(s=d(),a=d(),o=d(),u=d());let E=[1,1];if(h()&&h()){const e=l();switch(e){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:E=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil(16*(b+1)-2*s-2*a),height:(2-S)*(T+1)*16-(S?2:4)*(o+u),pixelRatio:E}}}class rs extends ts{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,n,i){const r=this.parseNALu(e,n.data,i);let s,a=this.VideoSample,o=!1;n.data=null,a&&r.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),r.forEach(i=>{var r,u;switch(i.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),a.frame=!0,s=!0;break;case 16:case 17:case 18:case 21:var l;if(s=!0,o)null!=(l=a)&&l.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null);a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:s=!0,null!=(r=a)&&r.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 39:s=!0,Te(i.data,2,n.pts,t.samples);break;case 32:s=!0,e.vps||("object"!==typeof e.params&&(e.params={}),e.params=p(e.params,this.readVPS(i.data)),this.initVPS=i.data),e.vps=[i.data];break;case 33:if(s=!0,o=!0,void 0===e.vps||e.vps[0]===this.initVPS||void 0===e.sps||this.matchSPS(e.sps[0],i.data)||(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const t=this.readSPS(i.data);e.width=t.width,e.height=t.height,e.pixelRatio=t.pixelRatio,e.codec=t.codecString,e.sps=[],"object"!==typeof e.params&&(e.params={});for(const n in t.params)e.params[n]=t.params[n]}this.pushParameterSet(e.sps,i.data,e.vps),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0;break;case 34:if(s=!0,"object"===typeof e.params){if(!e.pps){e.pps=[];const t=this.readPPS(i.data);for(const n in t)e.params[n]=t[n]}this.pushParameterSet(e.pps,i.data,e.vps)}break;case 35:s=!0,e.audFound=!0,null!=(u=a)&&u.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;default:s=!1;break}if(a&&s){const e=a.units;e.push(i)}}),i&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}pushParameterSet(e,t,n){(n&&n[0]===this.initVPS||!n&&!e.length)&&e.push(t)}getNALuType(e,t){return(126&e[t])>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let n=0;for(let i=0;i<e.byteLength;i++)i>=2&&3===e[i]&&0===e[i-1]&&0===e[i-2]||(t[n]=e[i],n++);return new Uint8Array(t.buffer,0,n)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new ns(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const n=t.readBits(3),i=t.readBoolean();return{numTemporalLayers:n+1,temporalIdNested:i}}readSPS(e){const t=new ns(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const n=t.readBits(3);t.readBoolean();const i=t.readBits(2),r=t.readBoolean(),s=t.readBits(5),a=t.readUByte(),o=t.readUByte(),u=t.readUByte(),l=t.readUByte(),c=t.readUByte(),d=t.readUByte(),h=t.readUByte(),f=t.readUByte(),p=t.readUByte(),g=t.readUByte(),m=t.readUByte(),v=[],y=[];for(let Q=0;Q<n;Q++)v.push(t.readBoolean()),y.push(t.readBoolean());if(n>0)for(let Q=n;Q<8;Q++)t.readBits(2);for(let Q=0;Q<n;Q++)v[Q]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),y[Q]&&t.readUByte();t.readUEG();const b=t.readUEG();3==b&&t.skipBits(1);const T=t.readUEG(),S=t.readUEG(),E=t.readBoolean();let w=0,A=0,x=0,I=0;E&&(w+=t.readUEG(),A+=t.readUEG(),x+=t.readUEG(),I+=t.readUEG());const k=t.readUEG(),L=t.readUEG(),R=t.readUEG(),C=t.readBoolean();for(let Q=C?0:n;Q<=n;Q++)t.skipUEG(),t.skipUEG(),t.skipUEG();t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG();const D=t.readBoolean();if(D){const e=t.readBoolean();if(e)for(let n=0;n<4;n++)for(let e=0;e<(3===n?2:6);e++){const e=t.readBoolean();if(e){const e=Math.min(64,1<<4+(n<<1));n>1&&t.readEG();for(let n=0;n<e;n++)t.readEG()}else t.readUEG()}}t.readBoolean(),t.readBoolean();const M=t.readBoolean();M&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const P=t.readUEG();let _=0;for(let Q=0;Q<P;Q++){let e=!1;if(0!==Q&&(e=t.readBoolean()),e){Q===P&&t.readUEG(),t.readBoolean(),t.readUEG();let e=0;for(let n=0;n<=_;n++){const n=t.readBoolean();let i=!1;n||(i=t.readBoolean()),(n||i)&&e++}_=e}else{const e=t.readUEG(),n=t.readUEG();_=e+n;for(let i=0;i<e;i++)t.readUEG(),t.readBoolean();for(let i=0;i<n;i++)t.readUEG(),t.readBoolean()}}const O=t.readBoolean();if(O){const e=t.readUEG();for(let n=0;n<e;n++){for(let e=0;e<R+4;e++)t.readBits(1);t.readBits(1)}}let N=0,U=1,F=1,B=!0,j=1,$=0;t.readBoolean(),t.readBoolean();let G=!1;const V=t.readBoolean();if(V){const e=t.readBoolean();if(e){const e=t.readUByte(),n=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],i=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];e>0&&e<16?(U=n[e-1],F=i[e-1]):255===e&&(U=t.readBits(16),F=t.readBits(16))}const i=t.readBoolean();i&&t.readBoolean();const r=t.readBoolean();if(r){t.readBits(3),t.readBoolean();const e=t.readBoolean();e&&(t.readUByte(),t.readUByte(),t.readUByte())}const s=t.readBoolean();s&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),G=t.readBoolean(),G&&(w+=t.readUEG(),A+=t.readUEG(),x+=t.readUEG(),I+=t.readUEG());const a=t.readBoolean();if(a){j=t.readBits(32),$=t.readBits(32);const e=t.readBoolean();e&&t.readUEG();const i=t.readBoolean();if(i){const e=t.readBoolean(),i=t.readBoolean();let r=!1;(e||i)&&(r=t.readBoolean(),r&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),r&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let s=0;s<=n;s++){B=t.readBoolean();const n=B||t.readBoolean();let s=!1;n?t.readEG():s=t.readBoolean();const a=s?1:t.readUEG()+1;if(e)for(let e=0;e<a;e++)t.readUEG(),t.readUEG(),r&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(i)for(let e=0;e<a;e++)t.readUEG(),t.readUEG(),r&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}}const o=t.readBoolean();o&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),N=t.readUEG())}let H=T,K=S;if(E||G){let e=1,t=1;1===b?e=t=2:2==b&&(e=2),H=T-e*A-e*w,K=S-t*I-t*x}const W=i?["A","B","C"][i]:"",q=a<<24|o<<16|u<<8|l;let Y=0;for(let Q=0;Q<32;Q++)Y=(Y|(q>>Q&1)<<31-Q)>>>0;let z=Y.toString(16);1===s&&"2"===z&&(z="6");const X=r?"H":"L";return{codecString:`hvc1.${W}${s}.${z}.${X}${m}.B0`,params:{general_tier_flag:r,general_profile_idc:s,general_profile_space:i,general_profile_compatibility_flags:[a,o,u,l],general_constraint_indicator_flags:[c,d,h,f,p,g],general_level_idc:m,bit_depth:k+8,bit_depth_luma_minus8:k,bit_depth_chroma_minus8:L,min_spatial_segmentation_idc:N,chroma_format_idc:b,frame_rate:{fixed:B,fps:$/j}},width:H,height:K,pixelRatio:[U,F]}}readPPS(e){const t=new ns(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2);const n=t.readBoolean();n&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const i=t.readBoolean(),r=t.readBoolean();let s=1;return r&&i?s=0:r?s=3:i&&(s=2),{parallelismType:s}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const ss=188;class as{constructor(e,t,n,i){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=i,this.videoParser=null}static probe(e,t){const n=as.syncOffset(e);return n>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),-1!==n}static syncOffset(e){const t=e.length;let n=Math.min(5*ss,t-ss)+1,i=0;while(i<n){let r=!1,s=-1,a=0;for(let o=i;o<t;o+=ss){if(71!==e[o]||t-o!==ss&&71!==e[o+ss]){if(a)return-1;break}if(a++,-1===s&&(s=o,0!==s&&(n=Math.min(s+99*ss,e.length-ss)+1)),r||(r=0===os(e,o)),r&&a>1&&(0===s&&a>2||o+ss>n))return s}i++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:Y[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=as.createTrack("video"),this._videoTrack.duration=i,this._audioTrack=as.createTrack("audio",i),this._id3Track=as.createTrack("id3"),this._txtTrack=as.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,i=!1){let r;n||(this.sampleAes=null);const s=this._videoTrack,a=this._audioTrack,o=this._id3Track,u=this._txtTrack;let l=s.pid,c=s.pesData,d=a.pid,h=o.pid,f=a.pesData,p=o.pesData,g=null,m=this.pmtParsed,v=this._pmtId,y=e.length;if(this.remainderData&&(e=me(this.remainderData,e),y=e.length,this.remainderData=null),y<ss&&!i)return this.remainderData=e,{audioTrack:a,videoTrack:s,id3Track:o,textTrack:u};const b=Math.max(0,as.syncOffset(e));y-=(y-b)%ss,y<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,y,e.buffer.byteLength-y));let T=0;for(let E=b;E<y;E+=ss)if(71===e[E]){const t=!!(64&e[E+1]),i=os(e,E),y=(48&e[E+3])>>4;let T;if(y>1){if(T=E+5+e[E+4],T===E+ss)continue}else T=E+4;switch(i){case l:if(t){if(c&&(r=hs(c,this.logger))){if(null===this.videoParser)switch(s.segmentCodec){case"avc":this.videoParser=new is;break;case"hevc":this.videoParser=new rs;break}null!==this.videoParser&&this.videoParser.parsePES(s,u,r,!1)}c={data:[],size:0}}c&&(c.data.push(e.subarray(T,E+ss)),c.size+=E+ss-T);break;case d:if(t){if(f&&(r=hs(f,this.logger)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,r);break;case"mp3":this.parseMPEGPES(a,r);break;case"ac3":this.parseAC3PES(a,r);break}f={data:[],size:0}}f&&(f.data.push(e.subarray(T,E+ss)),f.size+=E+ss-T);break;case h:t&&(p&&(r=hs(p,this.logger))&&this.parseID3PES(o,r),p={data:[],size:0}),p&&(p.data.push(e.subarray(T,E+ss)),p.size+=E+ss-T);break;case 0:t&&(T+=e[T]+1),v=this._pmtId=us(e,T);break;case v:{t&&(T+=e[T]+1);const i=ls(e,T,this.typeSupported,n,this.observer,this.logger);l=i.videoPid,l>0&&(s.pid=l,s.segmentCodec=i.segmentVideoCodec),d=i.audioPid,d>0&&(a.pid=d,a.segmentCodec=i.segmentAudioCodec),h=i.id3Pid,h>0&&(o.pid=h),null===g||m||(this.logger.warn(`MPEG-TS PMT found at ${E} after unknown PID '${g}'. Backtracking to sync byte @${b} to parse all TS packets.`),g=null,E=b-188),m=this.pmtParsed=!0;break}case 17:case 8191:break;default:g=i;break}}else T++;T>0&&cs(this.observer,new Error(`Found ${T} TS packet/s that do not start with 0x47`),void 0,this.logger),s.pesData=c,a.pesData=f,o.pesData=p;const S={audioTrack:a,videoTrack:s,id3Track:o,textTrack:u};return i&&this.extractRemainingSamples(S),S}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:r}=e,s=n.pesData,a=t.pesData,o=i.pesData;let u;if(s&&(u=hs(s,this.logger))){if(null===this.videoParser)switch(n.segmentCodec){case"avc":this.videoParser=new is;break;case"hevc":this.videoParser=new rs;break}null!==this.videoParser&&(this.videoParser.parsePES(n,r,u,!0),n.pesData=null)}else n.pesData=s;if(a&&(u=hs(a,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,u);break;case"mp3":this.parseMPEGPES(t,u);break;case"ac3":this.parseAC3PES(t,u);break}t.pesData=null}else null!=a&&a.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;o&&(u=hs(o,this.logger))?(this.parseID3PES(i,u),i.pesData=null):i.pesData=o}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),r=this.sampleAes=new es(this.observer,this.config,t);return this.decrypt(i,r)}decrypt(e,t){return new Promise(n=>{const{audioTrack:i,videoTrack:r}=e;i.samples&&"aac"===i.segmentCodec?t.decryptAacSamples(i.samples,0,()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,()=>{n(e)}):n(e)}):r.samples&&t.decryptAvcSamples(r.samples,0,0,()=>{n(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let r,s,a,o=t.data;if(i){this.aacOverFlow=null;const t=i.missing,r=i.sample.unit.byteLength;if(-1===t)o=me(i.sample.unit,o);else{const s=r-t;i.sample.unit.set(o.subarray(0,t),s),e.samples.push(i.sample),n=i.missing}}for(r=n,s=o.length;r<s-1;r++)if(ar(o,r))break;if(r!==n){let e;const t=r<s-1;if(e=t?`AAC PES did not start with ADTS header,offset:${r}`:"No ADTS header found in AAC PES",cs(this.observer,new Error(e),t,this.logger),!t)return}if(lr(e,this.observer,o,r,this.audioCodec),void 0!==t.pts)a=t.pts;else{if(!i)return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");{const t=cr(e.samplerate);a=i.sample.pts+t}}let u,l=0;while(r<s){if(u=hr(e,o,r,a,l),r+=u.length,u.missing){this.aacOverFlow=u;break}for(l++;r<s-1;r++)if(ar(o,r))break}}parseMPEGPES(e,t){const n=t.data,i=n.length;let r=0,s=0;const a=t.pts;if(void 0!==a)while(s<i)if(Vr(n,s)){const t=jr(e,n,s,a,r);if(!t)break;s+=t.length,r++}else s++;else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(e,t){{const n=t.data,i=t.pts;if(void 0===i)return void this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");const r=n.length;let s,a=0,o=0;while(o<r&&(s=zr(e,n,o,i,a++))>0)o+=s}}parseID3PES(e,t){if(void 0===t.pts)return void this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");const n=p({},t,{type:this._videoTrack?Dr.emsg:Dr.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function os(e,t){return((31&e[t+1])<<8)+e[t+2]}function us(e,t){return(31&e[t+10])<<8|e[t+11]}function ls(e,t,n,i,r,s){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(15&e[t+1])<<8|e[t+2],u=t+3+o-4,l=(15&e[t+10])<<8|e[t+11];t+=12+l;while(t<u){const o=os(e,t),u=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 207:if(!i){ds("ADTS AAC",s);break}case 15:-1===a.audioPid&&(a.audioPid=o);break;case 21:-1===a.id3Pid&&(a.id3Pid=o);break;case 219:if(!i){ds("H.264",s);break}case 27:-1===a.videoPid&&(a.videoPid=o);break;case 3:case 4:n.mpeg||n.mp3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="mp3"):s.log("MPEG audio found, not supported in this browser");break;case 193:if(!i){ds("AC-3",s);break}case 129:n.ac3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="ac3"):s.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===a.audioPid&&u>0){let i=t+5,r=u;while(r>2){const t=e[i];switch(t){case 106:!0!==n.ac3?s.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=o,a.segmentAudioCodec="ac3");break}const u=e[i+1]+2;i+=u,r-=u}}break;case 194:case 135:return cs(r,new Error("Unsupported EC-3 in M2TS found"),void 0,s),a;case 36:-1===a.videoPid&&(a.videoPid=o,a.segmentVideoCodec="hevc",s.log("HEVC in M2TS found"));break}t+=u+5}return a}function cs(e,t,n,i){i.warn(`parsing error: ${t.message}`),e.emit(u.ERROR,u.ERROR,{type:a.MEDIA_ERROR,details:o.FRAG_PARSING_ERROR,fatal:!1,levelRetry:n,error:t,reason:t.message})}function ds(e,t){t.log(`${e} with AES-128-CBC encryption found in unencrypted stream`)}function hs(e,t){let n,i,r,s,a,o=0;const u=e.data;if(!e||0===e.size)return null;while(u[0].length<19&&u.length>1)u[0]=me(u[0],u[1]),u.splice(1,1);n=u[0];const l=(n[0]<<16)+(n[1]<<8)+n[2];if(1===l){if(i=(n[4]<<8)+n[5],i&&i>e.size-6)return null;const l=n[7];192&l&&(s=536870912*(14&n[9])+4194304*(255&n[10])+16384*(254&n[11])+128*(255&n[12])+(254&n[13])/2,64&l?(a=536870912*(14&n[14])+4194304*(255&n[15])+16384*(254&n[16])+128*(255&n[17])+(254&n[18])/2,s-a>54e5&&(t.warn(`${Math.round((s-a)/9e4)}s delta between PTS and DTS, align them`),s=a)):a=s),r=n[8];let c=r+9;if(e.size<=c)return null;e.size-=c;const d=new Uint8Array(e.size);for(let e=0,t=u.length;e<t;e++){n=u[e];let t=n.byteLength;if(c){if(c>t){c-=t;continue}n=n.subarray(c),t-=c,c=0}d.set(n,o),o+=t}return i&&(i-=r+3),{data:d,pts:s,dts:a,len:i}}return null}class fs{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const ps=Math.pow(2,32)-1;class gs{static init(){let e;for(e in gs.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},gs.types)gs.types.hasOwnProperty(e)&&(gs.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);gs.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);gs.STTS=gs.STSC=gs.STCO=r,gs.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),gs.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),gs.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),gs.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const s=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);gs.FTYP=gs.box(gs.types.ftyp,s,o,s,a),gs.DINF=gs.box(gs.types.dinf,gs.box(gs.types.dref,i))}static box(e,...t){let n=8,i=t.length;const r=i;while(i--)n+=t[i].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=255&n,s.set(e,4),i=0,n=8;i<r;i++)s.set(t[i],n),n+=t[i].byteLength;return s}static hdlr(e){return gs.box(gs.types.hdlr,gs.HDLR_TYPES[e])}static mdat(e){return gs.box(gs.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(ps+1)),i=Math.floor(t%(ps+1));return gs.box(gs.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}static mdia(e){return gs.box(gs.types.mdia,gs.mdhd(e.timescale||0,e.duration||0),gs.hdlr(e.type),gs.minf(e))}static mfhd(e){return gs.box(gs.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?gs.box(gs.types.minf,gs.box(gs.types.smhd,gs.SMHD),gs.DINF,gs.stbl(e)):gs.box(gs.types.minf,gs.box(gs.types.vmhd,gs.VMHD),gs.DINF,gs.stbl(e))}static moof(e,t,n){return gs.box(gs.types.moof,gs.mfhd(e),gs.traf(n,t))}static moov(e){let t=e.length;const n=[];while(t--)n[t]=gs.trak(e[t]);return gs.box.apply(null,[gs.types.moov,gs.mvhd(e[0].timescale||0,e[0].duration||0)].concat(n).concat(gs.mvex(e)))}static mvex(e){let t=e.length;const n=[];while(t--)n[t]=gs.trex(e[t]);return gs.box.apply(null,[gs.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(ps+1)),i=Math.floor(t%(ps+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return gs.box(gs.types.mvhd,r)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,r;for(i=0;i<t.length;i++)r=t[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return gs.box(gs.types.sdtp,n)}static stbl(e){return gs.box(gs.types.stbl,gs.stsd(e),gs.box(gs.types.stts,gs.STTS),gs.box(gs.types.stsc,gs.STSC),gs.box(gs.types.stsz,gs.STSZ),gs.box(gs.types.stco,gs.STCO))}static avc1(e){let t,n,i,r=[],s=[];for(t=0;t<e.sps.length;t++)n=e.sps[t],i=n.byteLength,r.push(i>>>8&255),r.push(255&i),r=r.concat(Array.prototype.slice.call(n));for(t=0;t<e.pps.length;t++)n=e.pps[t],i=n.byteLength,s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(n));const a=gs.box(gs.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|e.sps.length].concat(r).concat([e.pps.length]).concat(s))),o=e.width,u=e.height,l=e.pixelRatio[0],c=e.pixelRatio[1];return gs.box(gs.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,gs.box(gs.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),gs.box(gs.types.pasp,new Uint8Array([l>>24,l>>16&255,l>>8&255,255&l,c>>24,c>>16&255,c>>8&255,255&c])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,255&t,0,0])}static mp4a(e){return gs.box(gs.types.mp4a,gs.audioStsd(e),gs.box(gs.types.esds,gs.esds(e)))}static mp3(e){return gs.box(gs.types[".mp3"],gs.audioStsd(e))}static ac3(e){return gs.box(gs.types["ac-3"],gs.audioStsd(e),gs.box(gs.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if("audio"===e.type){if("aac"===t)return gs.box(gs.types.stsd,gs.STSD,gs.mp4a(e));if("ac3"===t&&e.config)return gs.box(gs.types.stsd,gs.STSD,gs.ac3(e));if("mp3"===t&&"mp3"===e.codec)return gs.box(gs.types.stsd,gs.STSD,gs.mp3(e))}else{if(!e.pps||!e.sps)throw new Error("video track missing pps or sps");if("avc"===t)return gs.box(gs.types.stsd,gs.STSD,gs.avc1(e));if("hevc"===t&&e.vps)return gs.box(gs.types.stsd,gs.STSD,gs.hvc1(e))}throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,n=(e.duration||0)*(e.timescale||0),i=e.width||0,r=e.height||0,s=Math.floor(n/(ps+1)),a=Math.floor(n%(ps+1));return gs.box(gs.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,r>>8&255,255&r,0,0]))}static traf(e,t){const n=gs.sdtp(e),i=e.id,r=Math.floor(t/(ps+1)),s=Math.floor(t%(ps+1));return gs.box(gs.types.traf,gs.box(gs.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),gs.box(gs.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s])),gs.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,gs.box(gs.types.trak,gs.tkhd(e),gs.mdia(e))}static trex(e){const t=e.id;return gs.box(gs.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,r=12+16*i,s=new Uint8Array(r);let a,o,u,l,c,d;for(t+=8+r,s.set(["video"===e.type?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,255&i,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),a=0;a<i;a++)o=n[a],u=o.duration,l=o.size,c=o.flags,d=o.cts,s.set([u>>>24&255,u>>>16&255,u>>>8&255,255&u,l>>>24&255,l>>>16&255,l>>>8&255,255&l,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,61440&c.degradPrio,15&c.degradPrio,d>>>24&255,d>>>16&255,d>>>8&255,255&d],12+16*a);return gs.box(gs.types.trun,s)}static initSegment(e){gs.types||gs.init();const t=gs.moov(e),n=me(gs.FTYP,t);return n}static hvc1(e){const t=e.params,n=[e.vps,e.sps,e.pps],i=4,r=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),i-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),n.length]);let s=r.length;for(let f=0;f<n.length;f+=1){s+=3;for(let e=0;e<n[f].length;e+=1)s+=2+n[f][e].length}const a=new Uint8Array(s);a.set(r,0),s=r.length;const o=n.length-1;for(let f=0;f<n.length;f+=1){a.set(new Uint8Array([32+f|(f===o?128:0),0,n[f].length]),s),s+=3;for(let e=0;e<n[f].length;e+=1)a.set(new Uint8Array([n[f][e].length>>8,255&n[f][e].length]),s),s+=2,a.set(n[f][e],s),s+=n[f][e].length}const u=gs.box(gs.types.hvcC,a),l=e.width,c=e.height,d=e.pixelRatio[0],h=e.pixelRatio[1];return gs.box(gs.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,gs.box(gs.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),gs.box(gs.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,255&d,h>>24,h>>16&255,h>>8&255,255&h])))}}gs.types=void 0,gs.HDLR_TYPES=void 0,gs.STTS=void 0,gs.STSC=void 0,gs.STCO=void 0,gs.STSZ=void 0,gs.VMHD=void 0,gs.SMHD=void 0,gs.STSD=void 0,gs.FTYP=void 0,gs.DINF=void 0;const ms=9e4;function vs(e,t,n=1,i=!1){const r=e*t*n;return i?Math.round(r):r}function ys(e,t,n=1,i=!1){return vs(e,t,1/n,i)}function bs(e,t=!1){return vs(e,1e3,1/ms,t)}function Ts(e,t=1){return vs(e,ms,1/t)}const Ss=1e4,Es=1024,ws=1152,As=1536;let xs,Is=null,ks=null;function Ls(e,t,n,i){return{duration:t,size:n,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class Rs{constructor(e,t,n,i){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=i,this.ISGenerated=!1,null===Is){const e=navigator.userAgent||"",t=e.match(/Chrome\/(\d+)/i);Is=t?parseInt(t[1]):0}if(null===ks){const e=navigator.userAgent.match(/Safari\/(\d+)/i);ks=e?parseInt(e[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,i=e.reduce((e,i)=>{let r=i.pts,s=r-e;return s<-4294967296&&(t=!0,r=Cs(r,n),s=r-e),s>0?e:r},n);return t&&this.logger.debug("PTS rollover detected"),i}remux(e,t,n,i,r,s,a,o){let u,l,d,h,f,p,g=r,m=r;const v=e.pid>-1,y=t.pid>-1,b=t.samples.length,T=e.samples.length>0,S=a&&b>0||b>1,E=(!v||T)&&(!y||S)||this.ISGenerated||a;if(E){if(this.ISGenerated){var w,A,x,I;const e=this.videoTrackConfig;(e&&(t.width!==e.width||t.height!==e.height||(null==(w=t.pixelRatio)?void 0:w[0])!==(null==(A=e.pixelRatio)?void 0:A[0])||(null==(x=t.pixelRatio)?void 0:x[1])!==(null==(I=e.pixelRatio)?void 0:I[1]))||!e&&S||null===this.nextAudioPts&&T)&&this.resetInitSegment()}this.ISGenerated||(d=this.generateIS(e,t,r,s));const n=this.isVideoContiguous;let i,a=-1;if(S&&(a=Ds(t.samples),!n&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,a>0){this.logger.warn(`[mp4-remuxer]: Dropped ${a} out of ${b} video samples due to a missing keyframe`);const e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(a),t.dropped+=a,m+=(t.samples[0].pts-e)/t.inputTimeScale,i=m}else-1===a&&(this.logger.warn(`[mp4-remuxer]: No keyframe found out of ${b} video samples`),p=!1);if(this.ISGenerated){if(T&&S){const n=this.getVideoStartPts(t.samples),i=Cs(e.samples[0].pts,n)-n,r=i/t.inputTimeScale;g+=Math.max(0,r),m+=Math.max(0,-r)}if(T){if(e.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,t,r,s)),l=this.remuxAudio(e,g,this.isAudioContiguous,s,y||S||o===c.AUDIO?m:void 0),S){const i=l?l.endPTS-l.startPTS:0;t.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,t,r,s)),u=this.remuxVideo(t,m,n,i)}}else S&&(u=this.remuxVideo(t,m,n,0));u&&(u.firstKeyFrame=a,u.independent=-1!==a,u.firstKeyFramePTS=i)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(f=Ms(n,r,this._initPTS,this._initDTS)),i.samples.length&&(h=Ps(i,r,this._initPTS))),{audio:l,video:u,initSegment:d,independent:p,text:h,id3:f}}generateIS(e,t,n,i){const r=e.samples,s=t.samples,a=this.typeSupported,o={},u=this._initPTS;let l,c,d,h,f=!u||i,p="audio/mp4";if(f&&(l=c=1/0),e.config&&r.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(p="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}o.audio={id:"audio",container:p,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&a.mpeg?new Uint8Array(0):gs.initSegment([e]),metadata:{channelCount:e.channelCount}},f&&(h=e.id,d=e.inputTimeScale,u&&d===u.timescale?f=!1:l=c=r[0].pts-Math.round(d*n))}if(t.sps&&t.pps&&s.length){if(t.timescale=t.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:gs.initSegment([t]),metadata:{width:t.width,height:t.height}},f)if(h=t.id,d=t.inputTimeScale,u&&d===u.timescale)f=!1;else{const e=this.getVideoStartPts(s),t=Math.round(d*n);c=Math.min(c,Cs(s[0].dts,e)-t),l=Math.min(l,e-t)}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(o).length)return this.ISGenerated=!0,f?(this._initPTS={baseTime:l,timescale:d},this._initDTS={baseTime:c,timescale:d}):l=d=void 0,{tracks:o,initPTS:l,timescale:d,trackId:h}}remuxVideo(e,t,n,i){const r=e.inputTimeScale,s=e.samples,l=[],c=s.length,d=this._initPTS;let h,f,g=this.nextAvcDts,m=8,v=this.videoSampleDuration,y=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,T=!1;if(!n||null===g){const e=t*r,i=s[0].pts-Cs(s[0].dts,s[0].pts);Is&&null!==g&&Math.abs(e-i-g)<15e3?n=!0:g=e-i}const S=d.baseTime*r/d.timescale;for(let a=0;a<c;a++){const e=s[a];e.pts=Cs(e.pts-S,g),e.dts=Cs(e.dts-S,g),e.dts<s[a>0?a-1:a].dts&&(T=!0)}T&&s.sort(function(e,t){const n=e.dts-t.dts,i=e.pts-t.pts;return n||i}),h=s[0].dts,f=s[s.length-1].dts;const E=f-h,w=E?Math.round(E/(c-1)):v||e.inputTimeScale/30;if(n){const n=h-g,i=n>w,r=n<-1;if((i||r)&&(i?this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${bs(n,!0)} ms (${n}dts) hole between fragments detected at ${t.toFixed(3)}`):this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${bs(-n,!0)} ms (${n}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!r||g>=s[0].pts||Is)){h=g;const e=s[0].pts-n;if(i)s[0].dts=h,s[0].pts=e;else{let t=!0;for(let i=0;i<s.length;i++){if(s[i].dts>e&&t)break;const r=s[i].pts;if(s[i].dts-=n,s[i].pts-=n,i<s.length-1){const e=s[i+1].pts,n=s[i].pts,a=e<=n,o=e<=r;t=a==o}}}this.logger.log(`Video: Initial PTS/DTS adjusted: ${bs(e,!0)}/${bs(h,!0)}, delta: ${bs(n,!0)} ms`)}}h=Math.max(0,h);let A=0,x=0,I=h;for(let a=0;a<c;a++){const e=s[a],t=e.units,n=t.length;let i=0;for(let r=0;r<n;r++)i+=t[r].data.length;x+=i,A+=n,e.length=i,e.dts<I?(e.dts=I,I+=w/4|0||1):I=e.dts,y=Math.min(e.pts,y),b=Math.max(e.pts,b)}f=s[c-1].dts;const k=x+4*A+8;let L;try{L=new Uint8Array(k)}catch(F){return void this.observer.emit(u.ERROR,u.ERROR,{type:a.MUX_ERROR,details:o.REMUX_ALLOC_ERROR,fatal:!1,error:F,bytes:k,reason:`fail allocating video mdat ${k}`})}const R=new DataView(L.buffer);R.setUint32(0,k),L.set(gs.types.mdat,4);let C=!1,D=Number.POSITIVE_INFINITY,M=Number.POSITIVE_INFINITY,P=Number.NEGATIVE_INFINITY,_=Number.NEGATIVE_INFINITY;for(let a=0;a<c;a++){const e=s[a],t=e.units;let n,o=0;for(let i=0,r=t.length;i<r;i++){const e=t[i],n=e.data,r=e.data.byteLength;R.setUint32(m,r),m+=4,L.set(n,m),m+=r,o+=4+r}if(a<c-1)v=s[a+1].dts-e.dts,n=s[a+1].pts-e.pts;else{const t=this.config,o=a>0?e.dts-s[a-1].dts:w;if(n=a>0?e.pts-s[a-1].pts:w,t.stretchShortVideoTrack&&null!==this.nextAudioPts){const n=Math.floor(t.maxBufferHole*r),s=(i?y+i*r:this.nextAudioPts)-e.pts;s>n?(v=s-o,v<0?v=o:C=!0,this.logger.log(`[mp4-remuxer]: It is approximately ${s/90} ms to the next segment; using duration ${v/90} ms for the last video frame.`)):v=o}else v=o}const u=Math.round(e.pts-e.dts);D=Math.min(D,v),P=Math.max(P,v),M=Math.min(M,n),_=Math.max(_,n),l.push(Ls(e.key,v,o,u))}if(l.length)if(Is){if(Is<70){const e=l[0].flags;e.dependsOn=2,e.isNonSync=0}}else if(ks&&_-M<P-D&&w/P<.025&&0===l[0].cts){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let e=h;for(let t=0,n=l.length;t<n;t++){const i=e+l[t].duration,r=e+l[t].cts;if(t<n-1){const e=i+l[t+1].cts;l[t].duration=e-r}else l[t].duration=t?l[t-1].duration:w;l[t].cts=0,e=i}}v=C||!v?w:v,this.nextAvcDts=g=f+v,this.videoSampleDuration=v,this.isVideoContiguous=!0;const O=gs.moof(e.sequenceNumber++,h,p(e,{samples:l})),N="video",U={data1:O,data2:L,startPTS:y/r,endPTS:(b+v)/r,startDTS:h/r,endDTS:g/r,type:N,hasAudio:!1,hasVideo:!0,nb:l.length,dropped:e.dropped};return e.samples=[],e.dropped=0,U}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return ws;case"ac3":return As;default:return Es}}remuxAudio(e,t,n,i,r){const s=e.inputTimeScale,l=e.samplerate?e.samplerate:s,c=s/l,d=this.getSamplesPerFrame(e),h=d*c,f=this._initPTS,g="mp3"===e.segmentCodec&&this.typeSupported.mpeg,m=[],v=void 0!==r;let y=e.samples,b=g?0:8,T=this.nextAudioPts||-1;const S=t*s,E=f.baseTime*s/f.timescale;if(this.isAudioContiguous=n=n||y.length&&T>0&&(i&&Math.abs(S-T)<9e3||Math.abs(Cs(y[0].pts-E,S)-T)<20*h),y.forEach(function(e){e.pts=Cs(e.pts-E,S)}),!n||T<0){if(y=y.filter(e=>e.pts>=0),!y.length)return;T=0===r?0:i&&!v?Math.max(0,S):y[0].pts}if("aac"===e.segmentCodec){const t=this.config.maxAudioFramesDrift;for(let n=0,i=T;n<y.length;n++){const r=y[n],a=r.pts,o=a-i,u=Math.abs(1e3*o/s);if(o<=-t*h&&v)0===n&&(this.logger.warn(`Audio frame @ ${(a/s).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*o/s)} ms.`),this.nextAudioPts=T=i=a);else if(o>=t*h&&u<Ss&&v){let t=Math.round(o/h);i=a-t*h,i<0&&(t--,i+=h),0===n&&(this.nextAudioPts=T=i),this.logger.warn(`[mp4-remuxer]: Injecting ${t} audio frame @ ${(i/s).toFixed(3)}s due to ${Math.round(1e3*o/s)} ms gap.`);for(let s=0;s<t;s++){const t=Math.max(i,0);let s=fs.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);s||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),s=r.unit.subarray()),y.splice(n,0,{unit:s,pts:t}),i+=h,n++}}r.pts=i,i+=h}}let w,A=null,x=null,I=0,k=y.length;while(k--)I+=y[k].unit.byteLength;for(let p=0,N=y.length;p<N;p++){const t=y[p],i=t.unit;let r=t.pts;if(null!==x){const e=m[p-1];e.duration=Math.round((r-x)/c)}else{if(n&&"aac"===e.segmentCodec&&(r=T),A=r,!(I>0))return;I+=b;try{w=new Uint8Array(I)}catch(O){return void this.observer.emit(u.ERROR,u.ERROR,{type:a.MUX_ERROR,details:o.REMUX_ALLOC_ERROR,fatal:!1,error:O,bytes:I,reason:`fail allocating audio mdat ${I}`})}if(!g){const e=new DataView(w.buffer);e.setUint32(0,I),w.set(gs.types.mdat,4)}}w.set(i,b);const s=i.byteLength;b+=s,m.push(Ls(!0,d,s,0)),x=r}const L=m.length;if(!L)return;const R=m[m.length-1];this.nextAudioPts=T=x+c*R.duration;const C=g?new Uint8Array(0):gs.moof(e.sequenceNumber++,A/c,p({},e,{samples:m}));e.samples=[];const D=A/s,M=T/s,P="audio",_={data1:C,data2:w,startPTS:D,endPTS:M,startDTS:D,endDTS:M,type:P,hasAudio:!0,hasVideo:!1,nb:L};return this.isAudioContiguous=!0,_}}function Cs(e,t){let n;if(null===t)return e;n=t<e?-8589934592:8589934592;while(Math.abs(e-t)>4294967296)e+=n;return e}function Ds(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}function Ms(e,t,n,i){const r=e.samples.length;if(!r)return;const s=e.inputTimeScale;for(let o=0;o<r;o++){const r=e.samples[o];r.pts=Cs(r.pts-n.baseTime*s/n.timescale,t*s)/s,r.dts=Cs(r.dts-i.baseTime*s/i.timescale,t*s)/s}const a=e.samples;return e.samples=[],{samples:a}}function Ps(e,t,n){const i=e.samples.length;if(!i)return;const r=e.inputTimeScale;for(let a=0;a<i;a++){const i=e.samples[a];i.pts=Cs(i.pts-n.baseTime*r/n.timescale,t*r)/r}e.samples.sort((e,t)=>e.pts-t.pts);const s=e.samples;return e.samples=[],{samples:s}}class _s{constructor(e,t,n,i){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1,this.logger=i}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(de(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const i=this.initData=re(e);i.audio&&(t=Us(i.audio,B.AUDIO,this.logger)),i.video&&(n=Us(i.video,B.VIDEO,this.logger));const r={};i.audio&&i.video?r.audiovideo={container:"video/mp4",codec:t+","+n,supplemental:i.video.supplemental,initSegment:e,id:"main"}:i.audio?r.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?r.video={container:"video/mp4",codec:n,supplemental:i.video.supplemental,initSegment:e,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(e,t,n,r,s,a){var o,u;let{initPTS:l,lastEndTime:c}=this;const d={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};i(c)||(c=this.lastEndTime=s||0);const h=t.samples;if(null==h||!h.length)return d;const f={initPTS:void 0,timescale:void 0,trackId:void 0};let p=this.initData;if(null!=(o=p)&&o.length||(this.generateInitSegment(h),p=this.initData),null==(u=p)||!u.length)return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(f.tracks=this.initTracks,this.emitInitSegment=!1);const g=fe(h,p,this.logger),m=p.audio?g[p.audio.id]:null,v=p.video?g[p.video.id]:null,y=Os(v,1/0),b=Os(m,1/0),T=Os(v,0,!0),S=Os(m,0,!0);let E,w=s,A=0;if(m&&(!v||!l&&b<y||l&&l.trackId===p.audio.id)?(f.trackId=p.audio.id,E=m,A=S-b):v&&(f.trackId=p.video.id,E=v,A=T-y),E){const e=E.timescale;w=E.start/e,f.timescale=e,l||(f.initPTS=E.start-s*e,this.initPTS=l={baseTime:f.initPTS,timescale:e,trackId:f.trackId})}!a&&l||!Ns(l,w,s,A)&&f.timescale===l.timescale||(f.initPTS=w-s,l&&1===l.timescale&&this.logger.warn(`Adjusting initPTS @${s} from ${l.baseTime/l.timescale} to ${f.initPTS}`),this.initPTS=l={baseTime:f.initPTS,timescale:1});const x=e?w-l.baseTime/l.timescale:c;pe(p,h,l.baseTime/l.timescale);const I=x+A;A>0?this.lastEndTime=I:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const k=!!p.audio,L=!!p.video;let R="";k&&(R+="audio"),L&&(R+="video");const C={data1:h,startPTS:x,startDTS:x,endPTS:I,endDTS:I,type:R,hasAudio:k,hasVideo:L,nb:1,dropped:0};d.audio=k&&!L?C:void 0,d.video=L?C:void 0;const D=null==v?void 0:v.sampleCount;if(D){const e=v.keyFrameIndex,t=-1!==e;C.nb=D,C.dropped=0===e||this.isVideoContiguous?0:t?e:D,C.independent=t,C.firstKeyFrame=e,t&&v.keyFrameStart&&(C.firstKeyFramePTS=v.keyFrameStart-l.baseTime/l.timescale),this.isVideoContiguous||(d.independent=t),this.isVideoContiguous||(this.isVideoContiguous=t),C.dropped&&this.logger.warn(`fmp4 does not start with IDR: firstIDR ${e}/${D} dropped: ${C.dropped} pts: ${C.firstKeyFramePTS||"NA"}`)}return d.initSegment=f,d.id3=Ms(n,s,l,l),r.samples.length&&(d.text=Ps(r,s,l)),d}}function Os(e,t,n=!1){return void 0!==(null==e?void 0:e.start)?(e.start+(n?e.duration:0))/e.timescale:t}function Ns(e,t,n,i){if(null===e)return!0;const r=Math.max(i,1),s=t-e.baseTime/e.timescale;return Math.abs(s-n)>r}function Us(e,t,n){const i=null==e?void 0:e.codec;if(i&&i.length>4)return i;if(t===B.AUDIO){if("ec-3"===i||"ac-3"===i||"alac"===i)return i;if("fLaC"===i||"Opus"===i){const e=!1;return Fe(i,e)}return n.warn(`Unhandled audio codec "${i}" in mp4 MAP`),i||"mp4a"}return n.warn(`Unhandled video codec "${i}" in mp4 MAP`),i||"avc1"}try{xs=self.performance.now.bind(self.performance)}catch(ql){xs=Date.now}const Fs=[{demux:Jr,remux:_s},{demux:as,remux:Rs},{demux:Wr,remux:Rs},{demux:Xr,remux:Rs}];Fs.splice(2,0,{demux:Yr,remux:Rs});class Bs{constructor(e,t,n,i,r,s){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.id=r,this.logger=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const r=n.transmuxing;r.executeStart=xs();let s=new Uint8Array(e);const{currentTransmuxState:l,transmuxConfig:c}=this;i&&(this.currentTransmuxState=i);const{contiguous:d,discontinuity:h,trackSwitch:f,accurateTimeOffset:p,timeOffset:g,initSegmentChange:m}=i||l,{audioCodec:v,videoCodec:y,defaultInitPts:b,duration:T,initSegmentData:S}=c,E=js(s,t);if(E&&In(E.method)){const e=this.getDecrypter(),t=kn(E.method);if(!e.isSync())return this.asyncResult=!0,this.decryptionPromise=e.webCryptoDecrypt(s,E.key.buffer,E.iv.buffer,t).then(e=>{const t=this.push(e,null,n);return this.decryptionPromise=null,t}),this.decryptionPromise;{let i=e.softwareDecrypt(s,E.key.buffer,E.iv.buffer,t);const a=n.part>-1;if(a){const t=e.flush();i=t?t.buffer:t}if(!i)return r.executeEnd=xs(),$s(n);s=new Uint8Array(i)}}const w=this.needsProbing(h,f);if(w){const e=this.configureTransmuxer(s);if(e)return this.logger.warn(`[transmuxer] ${e.message}`),this.observer.emit(u.ERROR,u.ERROR,{type:a.MEDIA_ERROR,details:o.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),r.executeEnd=xs(),$s(n)}(h||f||m||w)&&this.resetInitSegment(S,v,y,T,t),(h||m||w)&&this.resetInitialTimestamp(b),d||this.resetContiguity();const A=this.transmux(s,E,g,p,n);this.asyncResult=Gs(A);const x=this.currentTransmuxState;return x.contiguous=!0,x.discontinuity=!1,x.trackSwitch=!1,r.executeEnd=xs(),A}flush(e){const t=e.transmuxing;t.executeStart=xs();const{decrypter:n,currentTransmuxState:i,decryptionPromise:r}=this;if(r)return this.asyncResult=!0,r.then(()=>this.flush(e));const s=[],{timeOffset:a}=i;if(n){const t=n.flush();t&&s.push(this.push(t.buffer,null,e))}const{demuxer:o,remuxer:u}=this;if(!o||!u){t.executeEnd=xs();const n=[$s(e)];return this.asyncResult?Promise.resolve(n):n}const l=o.flush(a);return Gs(l)?(this.asyncResult=!0,l.then(t=>(this.flushRemux(s,t,e),s))):(this.flushRemux(s,l,e),this.asyncResult?Promise.resolve(s):s)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:r,id3Track:s,textTrack:a}=t,{accurateTimeOffset:o,timeOffset:u}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${n.sn}${n.part>-1?" part: "+n.part:""} of ${this.id===c.MAIN?"level":"track"} ${n.level}`);const l=this.remuxer.remux(i,r,s,a,u,o,!0,this.id);e.push({remuxResult:l,chunkMeta:n}),n.transmuxing.executeEnd=xs()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;t&&n&&(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,r){const{demuxer:s,remuxer:a}=this;s&&a&&(s.resetInitSegment(e,t,n,i),a.resetInitSegment(e,t,n,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,r){let s;return s=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,n,i,r):this.transmuxUnencrypted(e,n,i,r),s}transmuxUnencrypted(e,t,n,i){const{audioTrack:r,videoTrack:s,id3Track:a,textTrack:o}=this.demuxer.demux(e,t,!1,!this.config.progressive),u=this.remuxer.remux(r,s,a,o,t,n,!1,this.id);return{remuxResult:u,chunkMeta:i}}transmuxSampleAes(e,t,n,i,r){return this.demuxer.demuxSampleAes(e,t,n).then(e=>{const t=this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,n,i,!1,this.id);return{remuxResult:t,chunkMeta:r}})}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i}=this;let r;for(let c=0,d=Fs.length;c<d;c++){var s;if(null!=(s=Fs[c].demux)&&s.probe(e,this.logger)){r=Fs[c];break}}if(!r)return new Error("Failed to find demuxer by probing fragment data");const a=this.demuxer,o=this.remuxer,u=r.remux,l=r.demux;o&&o instanceof u||(this.remuxer=new u(n,t,i,this.logger)),a&&a instanceof l||(this.demuxer=new l(n,t,i,this.logger),this.probe=l.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Zt(this.config)),e}}function js(e,t){let n=null;return e.byteLength>0&&null!=(null==t?void 0:t.key)&&null!==t.iv&&null!=t.method&&(n=t),n}const $s=e=>({remuxResult:{},chunkMeta:e});function Gs(e){return"then"in e&&e.then instanceof Function}class Vs{constructor(e,t,n,i,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=r||null}}class Hs{constructor(e,t,n,i,r,s){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=r,this.initSegmentChange=s}}let Ks=0;class Ws{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=Ks++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=e=>{const t=e.data,n=this.hls;if(n&&null!=t&&t.event&&t.instanceNo===this.instanceNo)switch(t.event){case"init":{var i;const e=null==(i=this.workerContext)?void 0:i.objectURL;e&&self.URL.revokeObjectURL(e);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":n.logger[t.data.logType]&&n.logger[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.part=this.part,t.data.id=this.id,n.trigger(t.event,t.data);break}},this.onWorkerError=e=>{if(!this.hls)return;const t=new Error(`${e.message}  (${e.filename}:${e.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:t})};const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const s=(e,t)=>{t=t||{},t.frag=this.frag||void 0,e===u.ERROR&&(t.parent=this.id,t.part=this.part,this.error=t.error),this.hls.trigger(e,t)};this.observer=new Hi,this.observer.on(u.FRAG_DECRYPTED,s),this.observer.on(u.ERROR,s);const l=Ve(r.preferManagedMediaSource);if(this.useWorker&&"undefined"!==typeof Worker){const n=this.hls.logger,i=r.workerPath||qi();if(i){try{r.workerPath?(n.log(`loading Web Worker ${r.workerPath} for "${t}"`),this.workerContext=zi(r.workerPath)):(n.log(`injecting Web Worker for "${t}"`),this.workerContext=Yi());const{worker:e}=this.workerContext;e.addEventListener("message",this.onWorkerMessage),e.addEventListener("error",this.onWorkerError),e.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:l,id:t,config:lt(r)})}catch(ql){n.warn(`Error setting up "${t}" Web Worker, fallback to inline`,ql),this.terminateWorker(),this.error=null,this.transmuxer=new Bs(this.observer,l,r,"",t,e.logger)}return}}this.transmuxer=new Bs(this.observer,l,r,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=Ks++;const t=this.hls.config,n=Ve(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:n,id:this.id,config:lt(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),Xi(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,n,i,r,s,a,o,u,l){var d,h;u.transmuxing.start=self.performance.now();const{instanceNo:f,transmuxer:p}=this,g=s?s.start:r.start,m=r.decryptdata,v=this.frag,y=!(v&&r.cc===v.cc),b=!(v&&u.level===v.level),T=v?u.sn-v.sn:-1,S=this.part?u.part-this.part.index:-1,E=0===T&&u.id>1&&u.id===(null==v?void 0:v.stats.chunkCount),w=!b&&(1===T||0===T&&(1===S||E&&S<=0)),A=self.performance.now();(b||T||0===r.stats.parsing.start)&&(r.stats.parsing.start=A),!s||!S&&w||(s.stats.parsing.start=A);const x=!(v&&(null==(d=r.initSegment)?void 0:d.url)===(null==(h=v.initSegment)?void 0:h.url)),I=new Hs(y,w,o,b,g,x);if(!w||y||x){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${r.type} sn: ${u.sn}${u.part>-1?" part: "+u.part:""} ${this.id===c.MAIN?"level":"track"}: ${u.level} id: ${u.id}\n        discontinuity: ${y}\n        trackSwitch: ${b}\n        contiguous: ${w}\n        accurateTimeOffset: ${o}\n        timeOffset: ${g}\n        initSegmentChange: ${x}`);const e=new Vs(n,i,t,a,l);this.configureTransmuxer(e)}if(this.frag=r,this.part=s,this.workerContext)this.workerContext.worker.postMessage({instanceNo:f,cmd:"demux",data:e,decryptdata:m,chunkMeta:u,state:I},e instanceof ArrayBuffer?[e]:[]);else if(p){const t=p.push(e,m,u,I);Gs(t)?t.then(e=>{this.handleTransmuxComplete(e)}).catch(e=>{this.transmuxerError(e,u,"transmuxer-interface push error")}):this.handleTransmuxComplete(t)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(n){const t=n.flush(e);Gs(t)?t.then(t=>{this.handleFlushResult(t,e)}).catch(t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")}):this.handleFlushResult(t,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(e=>{this.handleTransmuxComplete(e)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):n&&n.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const qs=100;class Ys extends Ni{constructor(e,t,n){super(e,t,n,"audio-stream-controller",c.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(u.LEVEL_LOADED,this.onLevelLoaded,this),e.on(u.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(u.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(u.BUFFER_RESET,this.onBufferReset,this),e.on(u.BUFFER_CREATED,this.onBufferCreated,this),e.on(u.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(u.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(u.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(u.FRAG_LOADING,this.onFragLoading,this),e.on(u.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(u.LEVEL_LOADED,this.onLevelLoaded,this),e.off(u.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(u.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(u.BUFFER_RESET,this.onBufferReset,this),e.off(u.BUFFER_CREATED,this.onBufferCreated,this),e.off(u.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(u.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(u.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(u.FRAG_LOADING,this.onFragLoading,this),e.off(u.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r}){if(n===c.MAIN){const e=t.cc,n=this.fragCurrent;if(this.initPTS[e]={baseTime:i,timescale:r},this.log(`InitPTS for cc: ${e} found from main: ${i}/${r}`),this.mainAnchor=t,this.state===Oi.WAITING_INIT_PTS){const n=this.waitingData;(!n&&!this.loadingParts||n&&n.frag.cc!==e)&&this.syncWithAnchor(t,null==n?void 0:n.frag)}else!this.hls.hasEnoughToStart&&n&&n.cc!==e?(n.abortRequests(),this.syncWithAnchor(t,n)):this.state===Oi.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var n;const i=(null==(n=this.mainFragLoading)?void 0:n.frag)||null;if(t&&(null==i?void 0:i.cc)===t.cc)return;const r=(i||e).cc,s=this.getLevelDetails(),a=this.getLoadPosition(),o=Ct(s,r,a);o&&(this.log(`Waiting fragment cc (${null==t?void 0:t.cc}) cancelled because video is at cc ${e.cc}`),this.startFragRequested=!1,this.nextLoadPosition=o.start,this.resetLoadingState(),this.state===Oi.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels)return this.startPosition=e,void(this.state=Oi.STOPPED);const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(qs),n>0&&-1===e?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n,this.state=Oi.IDLE):this.state=Oi.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case Oi.IDLE:this.doTickIdle();break;case Oi.WAITING_TRACK:{const{levels:e,trackId:t}=this,n=null==e?void 0:e[t],i=null==n?void 0:n.details;if(i&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(i))break;this.state=Oi.WAITING_INIT_PTS}break}case Oi.FRAG_LOADING_WAITING_RETRY:{var e;const t=performance.now(),n=this.retryDate;if(!n||t>=n||null!=(e=this.media)&&e.seeking){const{levels:e,trackId:t}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((null==e?void 0:e[t])||null),this.state=Oi.IDLE}break}case Oi.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:i,complete:r}=e,s=this.mainAnchor;if(void 0!==this.initPTS[t.cc]){this.waitingData=null,this.state=Oi.FRAG_LOADING;const e=i.flush().buffer,s={frag:t,part:n,payload:e,networkDetails:null};this._handleFragmentLoadProgress(s),r&&super._handleFragmentLoadComplete(s)}else s&&s.cc!==e.frag.cc&&this.syncWithAnchor(s,e.frag)}else this.state=Oi.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:n,media:i,trackId:r}=this,s=t.config;if(!this.buffering||!i&&!this.primaryPrefetch&&(this.startFragRequested||!s.startFragPrefetch)||null==n||!n[r])return;const a=n[r],o=a.details;if(!o||this.waitForLive(a)||this.waitForCdnTuneIn(o))return this.state=Oi.WAITING_TRACK,void(this.startFragRequested=!1);const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,B.AUDIO,c.AUDIO));const d=this.getFwdBufferInfo(l,c.AUDIO);if(null===d)return;if(!this.switchingTrack&&this._streamEnded(d,o))return t.trigger(u.BUFFER_EOS,{type:"audio"}),void(this.state=Oi.ENDED);const h=d.len,f=t.maxBufferLength,p=o.fragments,g=p[0].start,m=this.getLoadPosition(),v=this.flushing?m:d.end;if(this.switchingTrack&&i){const e=m;o.PTSKnown&&e<g&&(d.end>g||d.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=g+.05)}if(h>=f&&!this.switchingTrack&&v<p[p.length-1].start)return;let y=this.getNextFragment(v,o);if(y&&this.isLoopLoading(y,v)&&(y=this.getNextFragmentLoopLoading(y,o,d,c.MAIN,f)),!y)return void(this.bufferFlushed=!0);let b=(null==(e=this.mainFragLoading)?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&b&&$(y)&&!y.endList&&(!o.live||!this.loadingParts&&v<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(b)===$t.OK&&(this.mainFragLoading=b=null),b&&$(b))){if(y.start>b.end){const e=this.fragmentTracker.getFragAtPos(v,c.MAIN);e&&e.end>b.end&&(b=e,this.mainFragLoading={frag:e,targetBufferTime:null})}const e=y.start>b.end;if(e)return}this.loadFragment(y,a,v)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(e=>new rt(e))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==Oi.STOPPED&&(this.setInterval(qs),this.state=Oi.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const n=this.cachedTrackLoadedData;n&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(u.AUDIO_TRACK_LOADED,n))}onAudioTrackLoaded(e,t){var n;const{levels:i}=this,{details:r,id:s,groupId:a,track:o}=t;if(!i)return void this.warn(`Audio tracks reset while loading track ${s} "${o.name}" of "${a}"`);const l=this.mainDetails;if(!l||r.endCC>l.endCC||l.expired)return this.cachedTrackLoadedData=t,void(this.state!==Oi.STOPPED&&(this.state=Oi.WAITING_TRACK));this.cachedTrackLoadedData=null,this.log(`Audio track ${s} "${o.name}" of "${a}" loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const c=i[s];let d=0;if(r.live||null!=(n=c.details)&&n.live){if(this.checkLiveUpdate(r),r.deltaUpdateFailed)return;var h;if(c.details)d=this.alignPlaylists(r,c.details,null==(h=this.levelLastLoaded)?void 0:h.details);r.alignedSliding||(Mi(r,l),r.alignedSliding||Pi(r,l),d=r.fragmentStart)}c.details=r,this.levelLastLoaded=c,this.startFragRequested||this.setStartPosition(l,d),this.hls.trigger(u.AUDIO_TRACK_UPDATED,{details:r,id:s,groupId:t.groupId}),this.state!==Oi.WAITING_TRACK||this.waitForCdnTuneIn(r)||(this.state=Oi.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:i,payload:r}=e,{config:s,trackId:a,levels:o}=this;if(!o)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const u=o[a];if(!u)return void this.warn("Audio track is undefined on fragment load progress");const l=u.details;if(!l)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(n.start);const d=s.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let h=this.transmuxer;h||(h=this.transmuxer=new Ws(this.hls,c.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const f=this.initPTS[n.cc],p=null==(t=n.initSegment)?void 0:t.data;if(void 0!==f){const e=!1,t=i?i.index:-1,s=-1!==t,a=new un(n.level,n.sn,n.stats.chunkCount,r.byteLength,t,s);h.push(r,p,d,"",n,i,l.totalduration,e,a,f)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${l.startSN} ,${l.endSN}],track ${a}`);const{cache:e}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new Fi,complete:!1};e.push(new Uint8Array(r)),this.state!==Oi.STOPPED&&(this.state=Oi.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===c.MAIN&&$(t.frag)&&(this.mainFragLoading=t,this.state===Oi.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type===c.AUDIO)if(this.fragContextChanged(n))this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if($(n)){this.fragPrevious=n;const e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger(u.AUDIO_TRACK_SWITCHED,m({},e)))}this.fragBufferedComplete(n,i),this.media&&this.tick()}else this.audioOnly||n.type!==c.MAIN||n.elementaryStreams.video||n.elementaryStreams.audiovideo||(this.audioOnly=!0,this.mainFragLoading=null)}onError(e,t){var n;if(t.fatal)this.state=Oi.ERROR;else switch(t.details){case o.FRAG_GAP:case o.FRAG_PARSING_ERROR:case o.FRAG_DECRYPT_ERROR:case o.FRAG_LOAD_ERROR:case o.FRAG_LOAD_TIMEOUT:case o.KEY_LOAD_ERROR:case o.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(c.AUDIO,t);break;case o.AUDIO_TRACK_LOAD_ERROR:case o.AUDIO_TRACK_LOAD_TIMEOUT:case o.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Oi.WAITING_TRACK||(null==(n=t.context)?void 0:n.type)!==l.AUDIO_TRACK||(this.state=Oi.IDLE);break;case o.BUFFER_ADD_CODEC_ERROR:case o.BUFFER_APPEND_ERROR:if("audio"!==t.parent)return;this.resetLoadingState();break;case o.BUFFER_FULL_ERROR:if("audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case o.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==B.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==B.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===Oi.ENDED&&(this.state=Oi.IDLE);const e=this.mediaBuffer||this.media;e&&(this.afterBufferFlushed(e,t,c.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:r,chunkMeta:s}=e,a=this.getCurrentContext(s);if(!a)return void this.resetWhenMissingContext(s);const{frag:o,part:l,level:c}=a,{details:d}=c,{audio:h,text:f,id3:g,initSegment:m}=r;if(!this.fragContextChanged(o)&&d){if(this.state=Oi.PARSING,this.switchingTrack&&h&&this.completeAudioSwitch(this.switchingTrack),null!=m&&m.tracks){const e=o.initSegment||o;this._bufferInitSegment(c,m.tracks,e,s),i.trigger(u.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:m.tracks})}if(h){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=h;l&&(l.elementaryStreams[B.AUDIO]={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),o.setElementaryStreamInfo(B.AUDIO,e,t,n,i),this.bufferFragmentData(h,o,l,s)}if(null!=g&&null!=(t=g.samples)&&t.length){const e=p({id:n,frag:o,details:d},g);i.trigger(u.FRAG_PARSING_METADATA,e)}if(f){const e=p({id:n,frag:o,details:d},f);i.trigger(u.FRAG_PARSING_USERDATA,e)}}else this.fragmentTracker.removeFragment(o)}_bufferInitSegment(e,t,n,i){if(this.state!==Oi.PARSING)return;if(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio)return;const r=t.audio;r.id=c.AUDIO;const s=e.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${s}/${r.codec}]`),s&&1===s.split(",").length&&(r.levelCodec=s),this.hls.trigger(u.BUFFER_CODECS,t);const a=r.initSegment;if(null!=a&&a.byteLength){const e={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:a};this.hls.trigger(u.BUFFER_APPENDING,e)}this.tickImmediate()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);var r;if(this.switchingTrack||i===$t.NOT_LOADED||i===$t.PARTIAL)if($(e))if(null!=(r=t.details)&&r.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Oi.WAITING_INIT_PTS;const n=this.mainDetails;n&&n.fragmentStart!==t.details.fragmentStart&&Pi(t.details,n)}else super.loadFragment(e,t,n);else this._loadInitSegment(e,t);else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:i,characteristics:r,audioCodec:s,channels:a}=this.bufferedTrack;mt({name:t,lang:n,assocLang:i,characteristics:r,audioCodec:s,channels:a},e,bt)||(Et(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(u.AUDIO_TRACK_SWITCHED,m({},e))}}class zs extends b{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const i=null==t?void 0:t.renditionReports;if(i){let s=-1;for(let n=0;n<i.length;n++){const a=i[n];let o;try{o=new self.URL(a.URI,t.url).href}catch(r){this.warn(`Could not construct new URL for Rendition Report: ${r}`),o=a.URI||""}if(o===e){s=n;break}o===e.substring(0,o.length)&&(s=n)}if(-1!==s){const e=i[s],r=parseInt(e["LAST-MSN"])||(null==t?void 0:t.lastPartSn);let a=parseInt(e["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const e=Math.min(t.age-t.partTarget,t.targetduration);a>=0&&e>t.partTarget&&(a+=1)}const o=n&&nt(n);return new it(r,a>=0?a:void 0,o)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(n){this.warn(`Could not construct new URL with HLS Delivery Directives: ${n}`)}return e}playlistLoaded(e,t,n){const{details:i,stats:r}=t,s=self.performance.now(),l=r.loading.first?Math.max(0,s-r.loading.first):0;i.advancedDateTime=Date.now()-l;const c=this.hls.config.timelineOffset;if(c!==i.appliedTimelineOffset){const e=Math.max(c||0,0);i.appliedTimelineOffset=e,i.fragments.forEach(t=>{t.start=t.playlistOffset+e})}if(i.live||null!=n&&n.live){const c="levelInfo"in t?t.levelInfo:t.track;if(i.reloaded(n),n&&i.fragments.length>0){gi(n,i);const e=i.playlistParsingError;if(e){this.warn(e);const n=this.hls;if(!n.config.ignorePlaylistParsingErrors){var d;const{networkDetails:s}=t;return void n.trigger(u.ERROR,{type:a.NETWORK_ERROR,details:o.LEVEL_PARSING_ERROR,fatal:!1,url:i.url,error:e,reason:e.message,level:t.level||void 0,parent:null==(d=i.fragments[0])?void 0:d.type,networkDetails:s,stats:r})}i.playlistParsingError=null}}-1===i.requestScheduled&&(i.requestScheduled=r.loading.start);const h=this.hls.mainForwardBufferInfo,f=h?h.end-h.len:0,p=1e3*(i.edge-f),g=Ei(i,p);if(i.requestScheduled+g<s?i.requestScheduled=s:i.requestScheduled+=g,this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),!this.canLoad||!i.live)return;let m,v,y;if(i.canBlockReload&&i.endSN&&i.advanced){const e=this.hls.config.lowLatencyMode,r=i.lastPartSn,a=i.endSN,o=i.lastPartIndex,u=-1!==o,l=r===a;u?l?(v=a+1,y=e?0:o):(v=r,y=e?o+1:i.maxPartIndex):v=a+1;const d=i.age,h=d+i.ageHeader;let f=Math.min(h-i.partTarget,1.5*i.targetduration);if(f>0){if(h>3*i.targetduration)this.log(`Playlist last advanced ${d.toFixed(2)}s ago. Omitting segment and part directives.`),v=void 0,y=void 0;else if(null!=n&&n.tuneInGoal&&h-i.partTarget>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${f} with playlist age: ${i.age}`),f=0;else{const e=Math.floor(f/i.targetduration);if(v+=e,void 0!==y){const e=Math.round(f%i.targetduration/i.partTarget);y+=e}this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${d.toFixed(2)}s goal: ${f} skip sn ${e} to part ${y}`)}i.tuneInGoal=f}if(m=this.getDeliveryDirectives(i,t.deliveryDirectives,v,y),e||!l)return i.requestScheduled=s,void this.loadingPlaylist(c,m)}else(i.canBlockReload||i.canSkipUntil)&&(m=this.getDeliveryDirectives(i,t.deliveryDirectives,v,y));m&&void 0!==v&&i.canBlockReload&&(i.requestScheduled=r.loading.first+Math.max(g-2*l,g/2)),this.scheduleLoading(c,m,i)}else this.clearTimer()}scheduleLoading(e,t,n){const i=n||e.details;if(!i)return void this.loadingPlaylist(e,t);const r=self.performance.now(),s=i.requestScheduled;if(r>=s)return void this.loadingPlaylist(e,t);const a=s-r;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(a)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),a)}getDeliveryDirectives(e,t,n,i){let r=nt(e);return null!=t&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,r=tt.No),new it(n,i,r)}checkRetry(e){const t=e.details,n=Dt(e),i=e.errorAction,{action:r,retryCount:s=0,retryConfig:a}=i||{},o=!!i&&!!a&&(r===Ut.RetryRequest||!i.resolved&&r===Ut.SendAlternateToPenaltyBox);if(o){var u;if(s>=a.maxNumRetry)return!1;if(n&&null!=(u=e.context)&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${s+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const e=Pt(a,s);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),e),this.warn(`Retrying playlist loading ${s+1}/${a.maxNumRetry} after "${t}" in ${e}ms`)}e.levelRetry=!0,i.resolved=!0}return o}}function Xs(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Qs(e[n].attrs,t[n].attrs))return!1;return!0}function Qs(e,t,n){const i=e["STABLE-RENDITION-ID"];return i&&!n?i===t["STABLE-RENDITION-ID"]:!(n||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(n=>e[n]!==t[n])}function Js(e,t){return t.label.toLowerCase()===e.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(e.lang||"").toLowerCase())}class Zs extends zs{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.MANIFEST_PARSED,this.onManifestParsed,this),e.on(u.LEVEL_LOADING,this.onLevelLoading,this),e.on(u.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(u.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(u.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.MANIFEST_PARSED,this.onManifestParsed,this),e.off(u.LEVEL_LOADING,this.onLevelLoading,this),e.off(u.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(u.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(u.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn(`Audio track with id:${n} and group:${i} not found in active group ${null==s?void 0:s.groupId}`);const a=s.details;s.details=t.details,this.log(`Audio track ${n} "${s.name}" lang:${s.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some(e=>-1===(null==i?void 0:i.indexOf(e)))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter(e=>!n||-1!==n.indexOf(e.groupId));if(e.length)this.selectDefaultTrack&&!e.some(e=>e.default)&&(this.selectDefaultTrack=!1),e.forEach((e,t)=>{e.id=t});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.audioPreference;if(!r&&t){const n=gt(t,e,bt);if(n>-1)r=e[n];else{const e=gt(t,this.tracks);r=this.tracks[e]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const l={audioTracks:e};this.log(`Updating audio tracks, ${e.length} track(s) found in group(s): ${null==n?void 0:n.join(",")}`),this.hls.trigger(u.AUDIO_TRACKS_UPDATED,l);const c=this.trackId;if(-1!==i&&-1===c)this.setAudioTrack(i);else if(e.length&&-1===c){var s;const t=new Error(`No audio track selected for current audio group-ID(s): ${null==(s=this.groupIds)?void 0:s.join(",")} track count: ${e.length}`);this.warn(t.message),this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}}onError(e,t){!t.fatal&&t.context&&(t.context.type!==l.AUDIO_TRACK||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&mt(e,i,bt))return i;const r=gt(e,this.tracksInGroup,bt);if(r>-1){const e=this.tracksInGroup[r];return this.setAudioTrack(r),e}if(i){let i=t.loadLevel;-1===i&&(i=t.firstAutoLevel);const r=Tt(e,t.levels,n,i,bt);if(-1===r)return null;t.nextLoadLevel=r}if(e.channels||e.audioCodec){const t=gt(e,n);if(t>-1)return n[t]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn(`Invalid audio track id: ${e}`);this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e],r=i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;if(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger(u.AUDIO_TRACK_SWITCHING,m({},i)),r)return;const s=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(s)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||mt(e,i,bt)))return n}if(e){const{name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o}=e;for(let e=0;e<t.length;e++){const u=t[e];if(mt({name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o},u,bt))return e}for(let u=0;u<t.length;u++){const n=t[u];if(Qs(e.attrs,n.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<t.length;u++){const n=t[u];if(Qs(e.attrs,n.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Et(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,i=e.groupId,r=this.getUrlWithDirectives(e.url,t),s=e.details,a=null==s?void 0:s.age;this.log(`Loading audio-track ${n} "${e.name}" lang:${e.lang} group:${i}${void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:""}${a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""} ${r}`),this.hls.trigger(u.AUDIO_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:t||null,track:e})}}class ea{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,n){if(null===this.queues||null===this.tracks)return;const i=this.queues[t];i.push(e),1!==i.length||n||this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const n={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(n,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const n={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(n)}})}removeBlockers(){null!==this.queues&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const n=null==(t=e[0])?void 0:t.label;"async-blocker"!==n&&"async-blocker-prepend"!==n||(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(null===this.queues)return;const t=this.queues.audio;t[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(null===this.queues||null===this.tracks)return;const t=this.queues[e];if(t.length){const r=t[0];try{r.execute()}catch(i){var n;if(r.onError(i),null===this.queues||null===this.tracks)return;const t=null==(n=this.tracks[e])?void 0:n.buffer;null!=t&&t.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){null!==this.queues&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return(null==(t=this.queues)?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return null===e||null===t?"<destroyed>":`\n${this.list("video")}\n${this.list("audio")}\n${this.list("audiovideo")}}`}list(e){var t,n;return null!=(t=this.queues)&&t[e]||null!=(n=this.tracks)&&n[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const n=null==(t=this.tracks)?void 0:t[e],i=null==n?void 0:n.buffer;return i?`SourceBuffer${i.updating?" updating":""}${n.ended?" ended":""}${n.ending?" ending":""}`:"none"}listOps(e){var t;return(null==(t=this.queues)?void 0:t[e].map(e=>e.label).join(", "))||""}}const ta=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,na="HlsJsTrackRemovedError";class ia extends Error{constructor(e){super(e),this.name=na}}class ra extends b{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=e=>{var t;this.hls&&"open"===(null==(t=this.mediaSource)?void 0:t.readyState)&&this.hls.pauseBuffering()},this._onStartStreaming=e=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=e=>{const{media:t,mediaSource:n}=this;e&&this.log("Media source opened"),t&&n&&(n.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(u.MEDIA_ATTACHED,{media:t,mediaSource:n}),null!==this.mediaSource&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:e,_objectUrl:t}=this;e!==t&&this.error(`Media element src was set while attaching MediaSource (${t} > ${e})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=R(L(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.MANIFEST_PARSED,this.onManifestParsed,this),e.on(u.BUFFER_RESET,this.onBufferReset,this),e.on(u.BUFFER_APPENDING,this.onBufferAppending,this),e.on(u.BUFFER_CODECS,this.onBufferCodecs,this),e.on(u.BUFFER_EOS,this.onBufferEos,this),e.on(u.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(u.FRAG_PARSED,this.onFragParsed,this),e.on(u.FRAG_CHANGED,this.onFragChanged,this),e.on(u.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.MANIFEST_PARSED,this.onManifestParsed,this),e.off(u.BUFFER_RESET,this.onBufferReset,this),e.off(u.BUFFER_APPENDING,this.onBufferAppending,this),e.off(u.BUFFER_CODECS,this.onBufferCodecs,this),e.off(u.BUFFER_EOS,this.onBufferEos,this),e.off(u.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(u.FRAG_PARSED,this.onFragParsed,this),e.off(u.FRAG_CHANGED,this.onFragChanged,this),e.off(u.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const n={};if(this.operationQueue){const e=this.isUpdating();e||this.operationQueue.removeBlockers();const t=this.isQueued();(e||t)&&this.warn(`Transfering MediaSource with${t?" operations in queue":""}${e?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const i=this.transferData;return!this.sourceBufferCount&&i&&i.mediaSource===t?p(n,i.tracks):this.sourceBuffers.forEach(e=>{const[t]=e;t&&(n[t]=p({},this.tracks[t]),this.removeBuffer(t)),e[0]=e[1]=null}),{media:e,mediaSource:t,tracks:n}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var n;let i=2;(t.audio&&!t.video||!t.altAudio)&&(i=1),this.bufferCodecEventsTotal=i,this.log(`${i} bufferCodec event(s) expected.`),null!=(n=this.transferData)&&n.mediaSource&&this.sourceBufferCount&&i&&this.bufferCreated()}onMediaAttaching(e,t){const n=this.media=t.media,i=L(this.appendSource);if(this.transferData=this.overrides=void 0,n&&i){const e=!!t.mediaSource;(e||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const s=this.mediaSource=t.mediaSource||new i;if(this.assignMediaSource(s),e)this._objectUrl=n.src,this.attachTransferred();else{const e=this._objectUrl=self.URL.createObjectURL(s);if(this.appendSource)try{n.removeAttribute("src");const t=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||t&&s instanceof t,sa(n),aa(n,e),n.load()}catch(r){n.src=e}else n.src=e}n.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,n;this.log(`${(null==(t=this.transferData)?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${null==(n=e.constructor)?void 0:n.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const n=this.tracks,i=t.tracks,r=i?Object.keys(i):null,s=r?r.length:0,a=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(i&&r&&s){if(!this.tracksReady)return this.hls.config.startFragPrefetch=!0,void this.log("attachTransferred: waiting for SourceBuffer track info");if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})\nrequired tracks: ${lt(n,(e,t)=>"initSegment"===e?void 0:t)};\ntransfer tracks: ${lt(i,(e,t)=>"initSegment"===e?void 0:t)}}`),!C(i,n)){t.mediaSource=null,t.tracks=void 0;const r=e.currentTime,s=this.details,a=Math.max(r,(null==s?void 0:s.fragments[0].start)||0);return a-r>1?void this.log(`attachTransferred: waiting for playback to reach new tracks start time ${r} -> ${a}`):(this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(i)}"->"${Object.keys(n)}") start time: ${a} currentTime: ${r}`),this.onMediaDetaching(u.MEDIA_DETACHING,{}),this.onMediaAttaching(u.MEDIA_ATTACHING,t),void(e.currentTime=a))}this.transferData=void 0,r.forEach(e=>{const t=e,n=i[t];if(n){const e=n.buffer;if(e){const i=this.fragmentTracker,r=n.id;if(i.hasFragments(r)||i.hasParts(r)){const n=dn.getBuffered(e);i.detectEvictedFragments(t,n,r,null,!0)}const s=oa(t),a=[t,e];this.sourceBuffers[s]=a,e.updating&&this.operationQueue&&this.operationQueue.prependBlocker(t),this.trackSourceBuffer(t,n)}}}),a(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),a()}get mediaSourceOpenOrEnded(){var e;const t=null==(e=this.mediaSource)?void 0:e.readyState;return"open"===t||"ended"===t}onMediaDetaching(e,t){const n=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:i,mediaSource:r,_objectUrl:s}=this;if(r){if(this.log("media source "+(n?"transferring":"detaching")),n)this.sourceBuffers.forEach(([e])=>{e&&this.removeBuffer(e)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const e="open"===r.readyState;try{const t=r.sourceBuffers;for(let n=t.length;n--;)e&&t[n].abort(),r.removeSourceBuffer(t[n]);e&&r.endOfStream()}catch(ql){this.warn(`onMediaDetaching: ${ql.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}r.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("sourceended",this._onMediaSourceEnded),r.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}i&&(i.removeEventListener("emptied",this._onMediaEmptied),n||(s&&self.URL.revokeObjectURL(s),this.mediaSrc===s?(i.removeAttribute("src"),this.appendSource&&sa(i),i.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(u.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const n=null==(t=this.tracks[e])?void 0:t.buffer;if(this.removeBuffer(e),n)try{var i;null!=(i=this.mediaSource)&&i.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}catch(ql){this.warn(`onBufferReset ${e}`,ql)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[oa(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new ea(this.tracks)}onBufferCodecs(e,t){const n=this.tracks,i=Object.keys(t);this.log(`BUFFER_CODECS: "${i}" (current SB count ${this.sourceBufferCount})`);const r="audiovideo"in t&&(n.audio||n.video)||n.audiovideo&&("audio"in t||"video"in t),s=!r&&this.sourceBufferCount&&this.media&&i.some(e=>!n[e]);r||s?this.warn(`Unsupported transition between "${Object.keys(n)}" and "${i}" SourceBuffers`):(i.forEach(e=>{var i,r,s;const a=t[e],{id:o,codec:u,levelCodec:l,container:c,metadata:d,supplemental:h}=a;let f=n[e];const p=null==(i=this.transferData)||null==(r=i.tracks)?void 0:r[e],g=null!=p&&p.buffer?p:f,m=(null==g?void 0:g.pendingCodec)||(null==g?void 0:g.codec),v=null==g?void 0:g.levelCodec;f||(f=n[e]={buffer:void 0,listeners:[],codec:u,supplemental:h,container:c,levelCodec:l,metadata:d,id:o});const y=je(m,v),b=null==y?void 0:y.replace(ta,"$1");let T=je(u,l);const S=null==(s=T)?void 0:s.replace(ta,"$1");T&&y&&b!==S&&("audio"===e.slice(0,5)&&(T=Fe(T,this.appendSource)),this.log(`switching codec ${m} to ${T}`),T!==(f.pendingCodec||f.codec)&&(f.pendingCodec=T),f.container=c,this.appendChangeType(e,c,T))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),this.sourceBufferCount||this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const n=this.tracks[t];return e[t]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},e},{})}appendChangeType(e,t,n){const i=`${t};codecs=${n}`,r={label:`change-type=${i}`,execute:()=>{const r=this.tracks[e];if(r){const s=r.buffer;null!=s&&s.changeType&&(this.log(`changing ${e} sourceBuffer type to ${i}`),s.changeType(i),r.codec=n,r.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{this.warn(`Failed to change ${e} SourceBuffer type`,t)}};this.append(r,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const n=e.start,i=n+.05*e.duration,r=!0===(null==(t=this.fragmentTracker.getAppendedFrag(n,c.MAIN))?void 0:t.gap);if(r)return;const s={label:"block-audio",execute:()=>{var e;const t=this.tracks.video;(this.lastVideoAppendEnd>i||null!=t&&t.buffer&&dn.isBuffered(t.buffer,i)||!0===(null==(e=this.fragmentTracker.getAppendedFrag(i,c.MAIN))?void 0:e.gap))&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:e=>{this.warn("Error executing block-audio operation",e)}};this.blockedAudioAppend={op:s,frag:e},this.append(s,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:n}=this,{data:i,type:r,parent:s,frag:l,part:c,chunkMeta:d}=t,h=d.buffering[r],f=l.sn,p=self.performance.now();h.start=p;const g=l.stats.buffering,m=c?c.stats.buffering:null;0===g.start&&(g.start=p),m&&0===m.start&&(m.start=p);const v=n.audio;let y=!1;"audio"===r&&"audio/mpeg"===(null==v?void 0:v.container)&&(y=!this.lastMpegAudioChunk||1===d.id||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const b=this.tracks.video,T=null==b?void 0:b.buffer;if(T&&"initSegment"!==f){const e=c||l,t=this.blockedAudioAppend;if("audio"!==r||"main"===s||this.blockedAudioAppend){if("video"===r){const n=e.end;if(t){const e=t.frag.start;(n>e||n<this.lastVideoAppendEnd||dn.isBuffered(T,e))&&this.unblockAudio()}this.lastVideoAppendEnd=n}}else{const t=e.start,n=t+.05*e.duration,i=T.buffered,r=this.currentOp("video");i.length||r?!r&&!dn.isBuffered(T,n)&&this.lastVideoAppendEnd<n&&this.blockAudio(e):this.blockAudio(e)}}const S=(c||l).start,E={label:`append-${r}`,execute:()=>{if(h.executeStart=self.performance.now(),y){const e=this.tracks[r];if(e){const t=e.buffer;if(t){const e=S-t.timestampOffset;Math.abs(e)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${S} (delta: ${e}) sn: ${f})`),t.timestampOffset=S)}}}this.appendExecutor(i,r)},onStart:()=>{},onComplete:()=>{const e=self.performance.now();h.executeEnd=h.end=e,0===g.first&&(g.first=e),m&&0===m.first&&(m.first=e);const t={};this.sourceBuffers.forEach(([e,n])=>{e&&(t[e]=dn.getBuffered(n))}),this.appendErrors[r]=0,"audio"===r||"video"===r?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(u.BUFFER_APPENDED,{type:r,frag:l,part:c,chunkMeta:d,parent:l.type,timeRanges:t})},onError:e=>{var t;const n={type:a.MEDIA_ERROR,parent:l.type,details:o.BUFFER_APPEND_ERROR,sourceBufferName:r,frag:l,part:c,chunkMeta:d,error:e,err:e,fatal:!1},i=null==(t=this.media)?void 0:t.error;if(e.code===DOMException.QUOTA_EXCEEDED_ERR)n.details=o.BUFFER_FULL_ERROR;else if(e.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!i)n.errorAction=jt(!0);else if(e.name===na&&0===this.sourceBufferCount)n.errorAction=jt(!0);else{const e=++this.appendErrors[r];this.warn(`Failed ${e}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${r}" sourceBuffer (${i||"no media error"})`),(e>=this.hls.config.appendErrorMaxRetry||i)&&(n.fatal=!0)}this.hls.trigger(u.ERROR,n)}};this.append(E,r,this.isPending(this.tracks[r]))}getFlushOp(e,t,n){return this.log(`queuing "${e}" remove ${t}-${n}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,n)},onStart:()=>{},onComplete:()=>{this.hls.trigger(u.BUFFER_FLUSHED,{type:e})},onError:i=>{this.warn(`Failed to remove ${t}-${n} from "${e}" SourceBuffer`,i)}}}onBufferFlushing(e,t){const{type:n,startOffset:i,endOffset:r}=t;n?this.append(this.getFlushOp(n,i,r),n):this.sourceBuffers.forEach(([e])=>{e&&this.append(this.getFlushOp(e,i,r),e)})}onFragParsed(e,t){const{frag:n,part:i}=t,r=[],s=i?i.elementaryStreams:n.elementaryStreams;s[B.AUDIOVIDEO]?r.push("audiovideo"):(s[B.AUDIO]&&r.push("audio"),s[B.VIDEO]&&r.push("video"));const a=()=>{const e=self.performance.now();n.stats.buffering.end=e,i&&(i.stats.buffering.end=e);const t=i?i.stats:n.stats;this.hls.trigger(u.FRAG_BUFFERED,{frag:n,part:i,stats:t,id:n.type})};0===r.length&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(a,r).catch(e=>{this.warn(`Fragment buffered callback ${e}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t,n;return e&&(!(null!=(t=this.tracks[e])&&t.ended)||(null==(n=this.tracks[e])?void 0:n.ending))})}onBufferEos(e,t){var n;this.sourceBuffers.forEach(([e])=>{if(e){const n=this.tracks[e];t.type&&t.type!==e||(n.ending=!0,n.ended||(n.ended=!0,this.log(`${e} buffer reached EOS`)))}});const i=!1!==(null==(n=this.overrides)?void 0:n.endOfStream),r=this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t;return e&&!(null!=(t=this.tracks[e])&&t.ended)});r&&(i?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:e}=this;e&&"open"===e.readyState?(this.log("Calling mediaSource.endOfStream()"),e.endOfStream(),this.hls.trigger(u.BUFFERED_TO_END,void 0)):e&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${e.readyState}`)})):(this.tracksEnded(),this.hls.trigger(u.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(null!==e){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){const e=this.getDurationAndRange();e&&this.blockUntilOpen(()=>this.updateMediaSource(e))}onError(e,t){if(t.details===o.BUFFER_APPEND_ERROR&&t.frag){var n;const e=null==(n=t.errorAction)?void 0:n.nextAutoLevel;i(e)&&e!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||null===t)return;if(!this.sourceBufferCount)return;const r=e.config,s=n.currentTime,a=t.levelTargetDuration,o=t.live&&null!==r.liveBackBufferLength?r.liveBackBufferLength:r.backBufferLength;if(i(o)&&o>=0){const e=Math.max(o,a),t=Math.floor(s/a)*a-e;this.flushBackBuffer(s,a,t)}if(i(r.frontBufferFlushThreshold)&&r.frontBufferFlushThreshold>0){const e=Math.max(r.maxBufferLength,r.frontBufferFlushThreshold),t=Math.max(e,a),n=Math.floor(s/a)*a+t;this.flushFrontBuffer(s,a,n)}}flushBackBuffer(e,t,n){this.sourceBuffers.forEach(([e,t])=>{if(t){const r=dn.getBuffered(t);if(r.length>0&&n>r.start(0)){var i;this.hls.trigger(u.BACK_BUFFER_REACHED,{bufferEnd:n});const t=this.tracks[e];if(null!=(i=this.details)&&i.live)this.hls.trigger(u.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(null!=t&&t.ended)return void this.log(`Cannot flush ${e} back buffer while SourceBuffer is in ended state`);this.hls.trigger(u.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:e})}}})}flushFrontBuffer(e,t,n){this.sourceBuffers.forEach(([t,i])=>{if(i){const r=dn.getBuffered(i),s=r.length;if(s<2)return;const a=r.start(s-1),o=r.end(s-1);if(n>a||e>=a&&e<=o)return;this.hls.trigger(u.BUFFER_FLUSHING,{startOffset:a,endOffset:1/0,type:t})}})}getDurationAndRange(){var e;const{details:t,mediaSource:n}=this;if(!t||!this.media||"open"!==(null==n?void 0:n.readyState))return null;const r=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){const e=t.fragments.length;if(e&&t.live&&n.setLiveSeekableRange){const e=Math.max(0,t.fragmentStart),n=Math.max(e,r);return{duration:1/0,start:e,end:n}}return{duration:1/0}}const s=null==(e=this.overrides)?void 0:e.duration;if(s)return i(s)?{duration:s}:null;const a=this.media.duration,o=i(n.duration)?n.duration:0;return r>o&&r>a||!i(a)?{duration:r}:null}updateMediaSource({duration:e,start:t,end:n}){const r=this.mediaSource;this.media&&r&&"open"===r.readyState&&(r.duration!==e&&(i(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),r.duration=e),void 0!==t&&void 0!==n&&(this.log(`MediaSource duration is set to ${r.duration}. Setting seekable range to ${t}-${n}.`),r.setLiveSeekableRange(t,n)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:n}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${lt(n)}`),this.tracksReady){var i;const e=null==(i=this.transferData)?void 0:i.tracks;e&&Object.keys(e).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,n])=>{if(t){const i=this.tracks[t];e[t]={buffer:n,container:i.container,codec:i.codec,supplemental:i.supplemental,levelCodec:i.levelCodec,id:i.id,metadata:i.metadata}}}),this.hls.trigger(u.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([e])=>{this.executeNext(e)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:n}=this;if(!n)throw new Error("createSourceBuffers called when mediaSource was null");for(const s in e){const l=s,c=e[l];if(this.isPending(c)){const e=this.getTrackCodec(c,l),s=`${c.container};codecs=${e}`;c.codec=e,this.log(`creating sourceBuffer(${s})${this.currentOp(l)?" Queued":""} ${lt(c)}`);try{const e=n.addSourceBuffer(s),i=oa(l),r=[l,e];t[i]=r,c.buffer=e}catch(r){var i;return this.error(`error while trying to add sourceBuffer: ${r.message}`),this.shiftAndExecuteNext(l),null==(i=this.operationQueue)||i.removeBlockers(),delete this.tracks[l],void this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:r,sourceBufferName:l,mimeType:s,parent:c.id})}this.trackSourceBuffer(l,c)}}this.bufferCreated()}getTrackCodec(e,t){const n=e.supplemental;let i=e.codec;n&&("video"===t||"audiovideo"===t)&&Ce(n,"video")&&(i=Be(i,n));const r=je(i,e.levelCodec);return r?"audio"===t.slice(0,5)?Fe(r,this.appendSource):r:""}trackSourceBuffer(e,t){const n=t.buffer;if(!n)return;const i=this.getTrackCodec(t,e);this.tracks[e]={buffer:n,codec:i,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(e,t)=>{const n=t.removedRanges;null!=n&&n.length&&this.hls.trigger(u.BUFFER_FLUSHED,{type:e})})}get mediaSrc(){var e,t;const n=(null==(e=this.media)||null==(t=e.querySelector)?void 0:t.call(e,"source"))||this.media;return null==n?void 0:n.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if("closed"===(null==(t=this.mediaSource)?void 0:t.readyState))return void this.resetBuffer(e);const n=this.currentOp(e);n&&(n.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var n;const i=new Error(`${e} SourceBuffer error. MediaSource readyState: ${null==(n=this.mediaSource)?void 0:n.readyState}`);this.error(`${i}`,t),this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const r=this.currentOp(e);r&&r.onError(i)}removeExecutor(e,t,n){const{media:r,mediaSource:s}=this,a=this.tracks[e],o=null==a?void 0:a.buffer;if(!r||!s||!o)return this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),void this.shiftAndExecuteNext(e);const u=i(r.duration)?r.duration:1/0,l=i(s.duration)?s.duration:1/0,c=Math.max(0,t),d=Math.min(n,u,l);d>c&&(!a.ending||a.ended)?(a.ended=!1,this.log(`Removing [${c},${d}] from the ${e} SourceBuffer`),o.remove(c,d)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.tracks[t],i=null==n?void 0:n.buffer;if(!i)throw new ia(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);n.ending=!1,n.ended=!1,i.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(e=>{this.warn(`SourceBuffer blocked callback ${e}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:n}=this,i=t.map(e=>this.appendBlocker(e)),r=t.length>1&&!!this.blockedAudioAppend;return r&&this.unblockAudio(),Promise.all(i).then(t=>{n===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(e=>{var t;const n=null==(t=this.tracks[e])?void 0:t.buffer;n&&!n.updating&&this.shiftAndExecuteNext(e)})}append(e,t,n){this.operationQueue&&this.operationQueue.append(e,t,n)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,n){const i=this.tracks[e];if(!i)return;const r=i.buffer;if(!r)return;const s=n.bind(this,e);i.listeners.push({event:t,listener:s}),r.addEventListener(t,s)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const n=t.buffer;n&&(t.listeners.forEach(e=>{n.removeEventListener(e.event,e.listener)}),t.listeners.length=0)}}function sa(e){const t=e.querySelectorAll("source");[].slice.call(t).forEach(t=>{e.removeChild(t)})}function aa(e,t){const n=self.document.createElement("source");n.type="video/mp4",n.src=t,e.appendChild(n)}function oa(e){return"audio"===e?1:0}class ua{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(u.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(u.MANIFEST_PARSED,this.onManifestParsed,this),e.on(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(u.BUFFER_CODECS,this.onBufferCodecs,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(u.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(u.MANIFEST_PARSED,this.onManifestParsed,this),e.off(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(u.BUFFER_CODECS,this.onBufferCodecs,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&i(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){const n=this.hls;n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((t,n)=>this.isLevelAllowed(t)&&n<=e);return this.clientRect=null,ua.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.width||t.height||(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(t){}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){const t=this.restrictedLevels;return!t.some(t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height)}static getMaxLevelByMediaSize(e,t,n){if(null==e||!e.length)return-1;const i=(e,t)=>!t||(e.width!==t.width||e.height!==t.height);let r=e.length-1;const s=Math.max(t,n);for(let a=0;a<e.length;a+=1){const t=e[a];if((t.width>=s||t.height>=s)&&i(t,e[a+1])){r=a;break}}return r}}const la={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},ca=la,da={HLS:"h"},ha=da,fa="CMCD-Object",pa="CMCD-Request",ga="CMCD-Session",ma="CMCD-Status",va={OBJECT:fa,REQUEST:pa,SESSION:ga,STATUS:ma},ya={[va.OBJECT]:["br","d","ot","tb"],[va.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[va.SESSION]:["cid","pr","sf","sid","st","v"],[va.STATUS]:["bs","rtp"]};class ba{constructor(e,t){Array.isArray(e)&&(e=e.map(e=>e instanceof ba?e:new ba(e))),this.value=e,this.params=t}}const Ta="Dict";function Sa(e){return Array.isArray(e)?JSON.stringify(e):e instanceof Map?"Map{}":e instanceof Set?"Set{}":"object"===typeof e?JSON.stringify(e):String(e)}function Ea(e,t,n,i){return new Error(`failed to ${e} "${Sa(t)}" as ${n}`,{cause:i})}function wa(e,t,n){return Ea("serialize",e,t,n)}class Aa{constructor(e){this.description=e}}const xa="Bare Item",Ia="Boolean";function ka(e){if("boolean"!==typeof e)throw wa(e,Ia);return e?"?1":"?0"}function La(e){return btoa(String.fromCharCode(...e))}const Ra="Byte Sequence";function Ca(e){if(!1===ArrayBuffer.isView(e))throw wa(e,Ra);return`:${La(e)}:`}const Da="Integer";function Ma(e){return e<-999999999999999||999999999999999<e}function Pa(e){if(Ma(e))throw wa(e,Da);return e.toString()}function _a(e){return`@${Pa(e.getTime()/1e3)}`}function Oa(e,t){if(e<0)return-Oa(-e,t);const n=Math.pow(10,t),i=Math.abs(e*n%1-.5)<Number.EPSILON;if(i){const t=Math.floor(e*n);return(t%2===0?t:t+1)/n}return Math.round(e*n)/n}const Na="Decimal";function Ua(e){const t=Oa(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw wa(e,Na);const n=t.toString();return n.includes(".")?n:`${n}.0`}const Fa="String",Ba=/[\x00-\x1f\x7f]+/;function ja(e){if(Ba.test(e))throw wa(e,Fa);return`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function $a(e){return e.description||e.toString().slice(7,-1)}const Ga="Token";function Va(e){const t=$a(e);if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t))throw wa(t,Ga);return t}function Ha(e){switch(typeof e){case"number":if(!i(e))throw wa(e,xa);return Number.isInteger(e)?Pa(e):Ua(e);case"string":return ja(e);case"symbol":return Va(e);case"boolean":return ka(e);case"object":if(e instanceof Date)return _a(e);if(e instanceof Uint8Array)return Ca(e);if(e instanceof Aa)return Va(e);default:throw wa(e,xa)}}const Ka="Key";function Wa(e){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(e))throw wa(e,Ka);return e}function qa(e){return null==e?"":Object.entries(e).map(([e,t])=>!0===t?`;${Wa(e)}`:`;${Wa(e)}=${Ha(t)}`).join("")}function Ya(e){return e instanceof ba?`${Ha(e.value)}${qa(e.params)}`:Ha(e)}function za(e){return`(${e.value.map(Ya).join(" ")})${qa(e.params)}`}function Xa(e,t={whitespace:!0}){if("object"!==typeof e)throw wa(e,Ta);const n=e instanceof Map?e.entries():Object.entries(e),i=(null===t||void 0===t?void 0:t.whitespace)?" ":"";return Array.from(n).map(([e,t])=>{t instanceof ba===!1&&(t=new ba(t));let n=Wa(e);return!0===t.value?n+=qa(t.params):(n+="=",Array.isArray(t.value)?n+=za(t):n+=Ya(t)),n}).join(`,${i}`)}function Qa(e,t){return Xa(e,t)}function Ja(e){return"ot"===e||"sf"===e||"st"===e}function Za(e){return"number"===typeof e?i(e):null!=e&&""!==e&&!1!==e}function eo(e,t){const n=new URL(e),i=new URL(t);if(n.origin!==i.origin)return e;const r=n.pathname.split("/").slice(1),s=i.pathname.split("/").slice(1,-1);while(r[0]===s[0])r.shift(),s.shift();while(s.length)s.shift(),r.unshift("..");return r.join("/")}const to=e=>Math.round(e),no=(e,t)=>((null===t||void 0===t?void 0:t.baseUrl)&&(e=eo(e,t.baseUrl)),encodeURIComponent(e)),io=e=>100*to(e/100),ro={br:to,d:to,bl:io,dl:io,mtp:io,nor:no,rtp:io,tb:to};function so(e,t){const n={};if(null==e||"object"!==typeof e)return n;const i=Object.keys(e).sort(),r=p({},ro,null===t||void 0===t?void 0:t.formatters),s=null===t||void 0===t?void 0:t.filter;return i.forEach(i=>{if(null===s||void 0===s?void 0:s(i))return;let a=e[i];const o=r[i];o&&(a=o(a,t)),"v"===i&&1===a||"pr"==i&&1===a||Za(a)&&(Ja(i)&&"string"===typeof a&&(a=new Aa(a)),n[i]=a)}),n}function ao(e,t={}){return e?Qa(so(e,t),p({whitespace:!1},t)):""}function oo(e,t={}){const n={};if(!e)return n;const i=Object.entries(e),r=Object.entries(ya).concat(Object.entries((null===t||void 0===t?void 0:t.customHeaderMap)||{})),s=i.reduce((e,t)=>{var n,i;const[s,a]=t,o=(null===(n=r.find(e=>e[1].includes(s)))||void 0===n?void 0:n[0])||va.REQUEST;return null!==(i=e[o])&&void 0!==i||(e[o]={}),e[o][s]=a,e},{});return Object.entries(s).reduce((e,[n,i])=>(e[n]=ao(i,t),e),n)}function uo(e,t,n){return p(e,oo(t,n))}const lo="CMCD";function co(e,t={}){if(!e)return"";const n=ao(e,t);return`${lo}=${encodeURIComponent(n)}`}const ho=/CMCD=[^&#]+/;function fo(e,t,n){const i=co(t,n);if(!i)return e;if(ho.test(e))return e.replace(ho,i);const r=e.includes("?")?"&":"?";return`${e}${r}${i}`}class po{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=e=>{try{this.apply(e,{ot:ca.MANIFEST,su:!this.initialized})}catch(t){this.hls.logger.warn("Could not generate manifest CMCD data.",t)}},this.applyFragmentData=e=>{try{const{frag:t,part:n}=e,i=this.hls.levels[t.level],r=this.getObjectType(t),s={d:1e3*(n||t).duration,ot:r};r!==ca.VIDEO&&r!==ca.AUDIO&&r!=ca.MUXED||(s.br=i.bitrate/1e3,s.tb=this.getTopBandwidth(r)/1e3,s.bl=this.getBufferLength(r));const a=n?this.getNextPart(n):this.getNextFrag(t);null!=a&&a.url&&a.url!==t.url&&(s.nor=a.url),this.apply(e,s)}catch(t){this.hls.logger.warn("Could not generate segment CMCD data.",t)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;null!=n&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.sessionId,this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(u.MEDIA_DETACHED,this.onMediaDetached,this),e.on(u.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(u.MEDIA_DETACHED,this.onMediaDetached,this),e.off(u.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=null==(n=t.tracks.audio)?void 0:n.buffer,this.videoBuffer=null==(i=t.tracks.video)?void 0:i.buffer}createData(){var e;return{v:1,sf:ha.HLS,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){p(t,this.createData());const n=t.ot===ca.INIT||t.ot===ca.VIDEO||t.ot===ca.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering);const{includeKeys:i}=this;i&&(t=Object.keys(t).reduce((e,n)=>(i.includes(n)&&(e[n]=t[n]),e),{}));const r={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),uo(e.headers,t,r)):e.url=fo(e.url,t,r)}getNextFrag(e){var t;const n=null==(t=this.hls.levels[e.level])?void 0:t.details;if(n){const t=e.sn-n.startSN;return n.fragments[t+1]}}getNextPart(e){var t,n;const{index:i,fragment:r}=e,s=null==(t=this.hls.levels[r.level])||null==(n=t.details)?void 0:n.partList;if(s){const{sn:e}=r;for(let t=s.length-1;t>=0;t--){const n=s[t];if(n.index===i&&n.fragment.sn===e)return s[t+1]}}}getObjectType(e){const{type:t}=e;return"subtitle"===t?ca.TIMED_TEXT:"initSegment"===e.sn?ca.INIT:"audio"===t?ca.AUDIO:"main"===t?this.hls.audioTracks.length?ca.VIDEO:ca.MUXED:void 0}getTopBandwidth(e){let t,n=0;const i=this.hls;if(e===ca.AUDIO)t=i.audioTracks;else{const e=i.maxAutoLevel,n=e>-1?e+1:i.levels.length;t=i.levels.slice(0,n)}return t.forEach(e=>{e.bitrate>n&&(n=e.bitrate)}),n>0?n:NaN}getBufferLength(e){const t=this.media,n=e===ca.AUDIO?this.audioBuffer:this.videoBuffer;if(!n||!t)return NaN;const i=dn.bufferInfo(n,t.currentTime,this.config.maxBufferHole);return 1e3*i.len}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}}const go=3e5;class mo extends b{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(u.MANIFEST_PARSED,this.onManifestParsed,this),e.on(u.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(u.MANIFEST_PARSED,this.onManifestParsed,this),e.off(u.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(t=>t!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;null!==n&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((null==n?void 0:n.action)===Ut.SendAlternateToPenaltyBox&&n.flags===Ft.MoveAllAlternatesMatchingHost){const e=this.levels;let i=this._pathwayPriority,r=this.pathwayId;if(t.context){const{groupId:n,pathwayId:i,type:s}=t.context;n&&e?r=this.getPathwayForGroupId(n,s,r):i&&(r=i)}r in this.penalizedPathways||(this.penalizedPathways[r]=performance.now()),!i&&e&&(i=this.pathways()),i&&i.length>1&&(this.updatePathwayPriority(i),n.resolved=this.pathwayId!==r),n.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${r} levels: ${e?e.length:e} priorities: ${lt(i)} penalized: ${lt(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){let t;this._pathwayPriority=e;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(e=>{i-n[e]>go&&delete n[e]});for(let r=0;r<e.length;r++){const i=e[r];if(i in n)continue;if(i===this.pathwayId)return;const s=this.hls.nextLoadLevel,a=this.hls.levels[s];if(t=this.getLevelsForPathway(i),t.length>0){this.log(`Setting Pathway to "${i}"`),this.pathwayId=i,Ii(t),this.hls.trigger(u.LEVELS_UPDATED,{levels:t});const e=this.hls.levels[s];a&&e&&this.levels&&(e.attrs["STABLE-VARIANT-ID"]!==a.attrs["STABLE-VARIANT-ID"]&&e.bitrate!==a.bitrate&&this.log(`Unstable Pathways change from bitrate ${a.bitrate} to ${e.bitrate}`),this.hls.nextLoadLevel=s);break}}}getPathwayForGroupId(e,t,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let r=0;r<i.length;r++)if(t===l.AUDIO_TRACK&&i[r].hasAudioGroup(e)||t===l.SUBTITLE_TRACK&&i[r].hasSubtitleGroup(e))return i[r].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach(e=>{const{ID:r,"BASE-ID":s,"URI-REPLACEMENT":a}=e;if(t.some(e=>e.pathwayId===r))return;const o=this.getLevelsForPathway(s).map(e=>{const t=new bn(e.attrs);t["PATHWAY-ID"]=r;const s=t.AUDIO&&`${t.AUDIO}_clone_${r}`,o=t.SUBTITLES&&`${t.SUBTITLES}_clone_${r}`;s&&(n[t.AUDIO]=s,t.AUDIO=s),o&&(i[t.SUBTITLES]=o,t.SUBTITLES=o);const u=yo(e.uri,t["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a),l=new rt({attrs:t,audioCodec:e.audioCodec,bitrate:e.bitrate,height:e.height,name:e.name,url:u,videoCodec:e.videoCodec,width:e.width});if(e.audioGroups)for(let n=1;n<e.audioGroups.length;n++)l.addGroupId("audio",`${e.audioGroups[n]}_clone_${r}`);if(e.subtitleGroups)for(let n=1;n<e.subtitleGroups.length;n++)l.addGroupId("text",`${e.subtitleGroups[n]}_clone_${r}`);return l});t.push(...o),vo(this.audioTracks,n,a,r),vo(this.subtitleTracks,i,a,r)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;let i;this.loader&&this.loader.destroy(),this.loader=new n(t);try{i=new self.URL(e)}catch(c){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${e}`)}if("data:"!==i.protocol){const e=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+e)}const r={responseType:"json",url:i.href},s=t.steeringManifestLoadPolicy.default,a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(e,t,n,r)=>{this.log(`Loaded steering manifest: "${i}"`);const s=e.data;if(1!==(null==s?void 0:s.VERSION))return void this.log(`Steering VERSION ${s.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=s.TTL;const{"RELOAD-URI":a,"PATHWAY-CLONES":o,"PATHWAY-PRIORITY":l}=s;if(a)try{this.uri=new self.URL(a,i).href}catch(c){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${a}`)}this.scheduleRefresh(this.uri||n.url),o&&this.clonePathways(o);const d={steeringManifest:s,url:i.toString()};this.hls.trigger(u.STEERING_MANIFEST_LOADED,d),l&&this.updatePathwayPriority(l)},onError:(e,t,n,i)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),this.stopLoad(),410===e.code)return this.enabled=!1,void this.log(`Steering manifest ${t.url} no longer available`);let r=1e3*this.timeToLoad;if(429!==e.code)this.scheduleRefresh(this.uri||t.url,r);else{const e=this.loader;if("function"===typeof(null==e?void 0:e.getResponseHeader)){const t=e.getResponseHeader("Retry-After");t&&(r=1e3*parseFloat(t))}this.log(`Steering manifest ${t.url} rate limited`)}},onTimeout:(e,t,n)=>{this.log(`Timeout loading steering manifest (${t.url})`),this.scheduleRefresh(this.uri||t.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(r,o,l)}scheduleRefresh(e,t=1e3*this.timeToLoad){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var t;const n=null==(t=this.hls)?void 0:t.media;!n||n.ended?this.scheduleRefresh(e,1e3*this.timeToLoad):this.loadSteeringManifest(e)},t)}}function vo(e,t,n,i){e&&Object.keys(t).forEach(r=>{const s=e.filter(e=>e.groupId===r).map(e=>{const s=p({},e);return s.details=void 0,s.attrs=new bn(s.attrs),s.url=s.attrs.URI=yo(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),s.groupId=s.attrs["GROUP-ID"]=t[r],s.attrs["PATHWAY-ID"]=i,s});e.push(...s)})}function yo(e,t,n,i){const{HOST:r,PARAMS:s,[n]:a}=i;let o;t&&(o=null==a?void 0:a[t],o&&(e=o));const u=new self.URL(e);return r&&!o&&(u.host=r),s&&Object.keys(s).sort().forEach(e=>{e&&u.searchParams.set(e,s[e])}),u.href}function bo(e,t,n){To(e,t,n),e.addEventListener(t,n)}function To(e,t,n){e.removeEventListener(t,n)}class So extends b{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=So.CDMCleanupPromise?[So.CDMCleanupPromise]:[],this.onMediaEncrypted=e=>{const{initDataType:t,initData:n}=e,i=`"${e.type}" event: init data type: "${t}"`;if(this.debug(i),null!==n){if(!this.keyFormatPromise){let e=Object.keys(this.keySystemAccessPromises);e.length||(e=jn(this.config));const t=e.map(Bn).filter(e=>!!e);this.keyFormatPromise=this.getKeyFormatPromise(t)}this.keyFormatPromise.then(r=>{const s=Nn(r);let a,o;if("sinf"===t){if(s!==_n.FAIRPLAY)return void this.warn(`Ignoring unexpected "${e.type}" event with init data type: "${t}" for selected key-system ${s}`);const r=z(new Uint8Array(n));try{const e=Ln(JSON.parse(r).sinf),t=he(e);if(!t)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");a=new Uint8Array(t.subarray(8,24)),o=_n.FAIRPLAY}catch(h){return void this.warn(`${i} Failed to parse sinf: ${h}`)}}else{if(s!==_n.WIDEVINE&&s!==_n.PLAYREADY)return void this.warn(`Ignoring unexpected "${e.type}" event with init data type: "${t}" for selected key-system ${s}`);const r=xe(n),u=r.filter(e=>!!e.systemId&&Fn(e.systemId)===s);u.length>1&&this.warn(`${i} Using first of ${u.length} pssh found for selected key-system ${s}`);const l=u[0];if(!l)return void(0===r.length||r.some(e=>!e.systemId)?this.warn(`${i} contains incomplete or invalid pssh data`):this.log(`ignoring ${i} for ${r.map(e=>Fn(e.systemId)).join(",")} pssh data in favor of playlist keys`));if(o=Fn(l.systemId),0===l.version&&l.data)if(o===_n.WIDEVINE){const e=l.data.length-22;a=new Uint8Array(l.data.subarray(e,e+16))}else o===_n.PLAYREADY&&(a=Kn(l.data))}if(!o||!a)return;const u=M.hexDump(a),{keyIdToKeySessionPromise:l,mediaKeySessions:c}=this;let d=l[u];for(let e=0;e<c.length;e++){const i=c[e],r=i.decryptdata;if(!r.keyId)continue;const s=M.hexDump(r.keyId);if(u===s||-1!==r.uri.replace(/-/g,"").indexOf(u)){if(d=l[s],r.pssh)break;delete l[s],r.pssh=new Uint8Array(n),r.keyId=a,d=l[u]=d.then(()=>this.generateRequestWithPreferredKeySession(i,t,n,"encrypted-event-key-match")),d.catch(e=>this.handleError(e));break}}if(!d){if(o!==s)return void this.log(`Ignoring "${e.type}" event with ${o} init data for selected key-system ${s}`);d=l[u]=this.getKeySystemSelectionPromise([o]).then(({keySystem:e,mediaKeys:i})=>{var r;this.throwIfDestroyed();const s=new qn("ISO-23001-7",u,null!=(r=Bn(e))?r:"");return s.pssh=new Uint8Array(n),s.keyId=a,this.attemptSetMediaKeys(e,i).then(()=>{this.throwIfDestroyed();const r=this.createMediaKeySessionContext({decryptdata:s,keySystem:e,mediaKeys:i});return this.generateRequestWithPreferredKeySession(r,t,n,"encrypted-event-no-match")})}),d.catch(e=>this.handleError(e))}})}},this.onWaitingForKey=e=>{this.log(`"${e.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(u.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(u.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(u.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(u.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(u.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(u.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(u.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(u.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t[e];return i?i.licenseUrl:e===_n.WIDEVINE&&n?n:void 0}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(void 0===t)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(e,t,n)=>!!e&&n.indexOf(e)===t,i=t.map(e=>e.audioCodec).filter(n),r=t.map(e=>e.videoCodec).filter(n);return i.length+r.length===0&&r.push("avc1.42e01e"),new Promise((t,n)=>{const s=e=>{const u=e.shift();this.getMediaKeysPromise(u,i,r).then(e=>t({keySystem:u,mediaKeys:e})).catch(t=>{e.length?s(e):n(t instanceof Eo?t:new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))})};s(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if("function"!==typeof n){let e=`Configured requestMediaKeySystemAccess is not a function ${n}`;return null===$n&&"http:"===self.location.protocol&&(e=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(e))}return n(e,t)}getMediaKeysPromise(e,t,n){const i=Gn(e,t,n,this.config.drmSystemOptions),r=this.keySystemAccessPromises[e];let s=null==r?void 0:r.keySystemAccess;if(!s){this.log(`Requesting encrypted media "${e}" key-system access with config: ${lt(i)}`),s=this.requestMediaKeySystemAccess(e,i);const t=this.keySystemAccessPromises[e]={keySystemAccess:s};return s.catch(t=>{this.log(`Failed to obtain access to key-system "${e}": ${t}`)}),s.then(n=>{this.log(`Access for key-system "${n.keySystem}" obtained`);const i=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),t.mediaKeys=n.createMediaKeys().then(n=>(this.log(`Media-keys created for "${e}"`),t.hasMediaKeys=!0,i.then(t=>t?this.setMediaKeysServerCertificate(n,e,t):n))),t.mediaKeys.catch(t=>{this.error(`Failed to create media-keys for "${e}"}: ${t}`)}),t.mediaKeys})}return s.then(()=>r.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${M.hexDump(e.keyId||[])}`);const i=n.createSession(),r={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),r="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,r,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return M.hexDump(e.keyId)}updateKeySession(e,t){var n;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${M.hexDump((null==(n=e.decryptdata)?void 0:n.keyId)||[])}\n      } (data length: ${t?t.byteLength:t})`),i.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>Bn(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:e,mediaKeys:t})=>this.attemptSetMediaKeys(e,t))}selectKeySystem(e){return new Promise((t,n)=>this.getKeySystemSelectionPromise(e).then(({keySystem:e})=>{const i=Bn(e);i?t(i):n(new Error(`Unable to find format for key-system "${e}"`))}).catch(n))}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=jn(this.config),n=e.map(Nn).filter(e=>!!e&&-1!==t.indexOf(e));return this.selectKeySystem(n)}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),i=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let r=this.keyIdToKeySessionPromise[n];if(!r){r=this.getKeySystemForKeyPromise(t).then(({keySystem:n,mediaKeys:r})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(n,r).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:n,mediaKeys:r,decryptdata:t})))));const s=this.keyIdToKeySessionPromise[n]=r.then(e=>{const n="cenc",i=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(e,n,i,"playlist-key")});s.catch(e=>this.handleError(e))}return r}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Eo?this.hls.trigger(u.ERROR,e.data):this.hls.trigger(u.ERROR,{type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const t=Nn(e.keyFormat),n=t?[t]:jn(this.config);return this.attemptKeySystemAccess(n)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=jn(this.config)),0===e.length)throw new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${lt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaKeys===t)return Promise.resolve();const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.mediaKeys=t,this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(e=>-1===n.indexOf(e))})}generateRequestWithPreferredKeySession(e,t,n,i){var r,s;const u=null==(r=this.config.drmSystems)||null==(s=r[e.keySystem])?void 0:s.generateRequest;if(u)try{const i=u.call(this.hls,t,n,e);if(!i)throw new Error("Invalid response from configured generateRequest filter");t=i.initDataType,n=i.initData?i.initData:null,e.decryptdata.pssh=n?new Uint8Array(n):null}catch(g){var l;if(this.warn(g.message),null!=(l=this.hls)&&l.config.debug)throw g}if(null===n)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const c=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${c} (init data type: ${t} length: ${n?n.byteLength:null})`);const d=new Hi,h=e._onmessage=t=>{const n=e.mediaKeysSession;if(!n)return void d.emit("error",new Error("invalid state"));const{messageType:i,message:r}=t;this.log(`"${i}" message event for session "${n.sessionId}" message size: ${r.byteLength}`),"license-request"===i||"license-renewal"===i?this.renewLicense(e,r).catch(e=>{d.eventNames().length?d.emit("error",e):this.handleError(e)}):"license-release"===i?e.keySystem===_n.FAIRPLAY&&(this.updateKeySession(e,Rn("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${i}"`)},f=e._onkeystatuseschange=t=>{const n=e.mediaKeysSession;if(!n)return void d.emit("error",new Error("invalid state"));this.onKeyStatusChange(e);const i=e.keyStatus;d.emit("keyStatus",i),"expired"===i&&(this.warn(`${e.keySystem} expired for key ${c}`),this.renewKeySession(e))};bo(e.mediaKeysSession,"message",h),bo(e.mediaKeysSession,"keystatuseschange",f);const p=new Promise((e,t)=>{d.on("error",t),d.on("keyStatus",n=>{n.startsWith("usable")?e():"output-restricted"===n?t(new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===n?t(new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${n}"`)):"expired"===n?t(new Error("key expired while generating request")):this.warn(`unhandled key status change "${n}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var t;this.log(`Request generated for key-session "${null==(t=e.mediaKeysSession)?void 0:t.sessionId}" keyId: ${c}`)}).catch(e=>{throw new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},`Error generating key-session request: ${e}`)}).then(()=>p).catch(t=>{throw d.removeAllListeners(),this.removeSession(e),t}).then(()=>(d.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{if("string"===typeof n&&"object"===typeof t){const e=n;n=t,t=e}this.log(`key status change "${t}" for keyStatuses keyId: ${M.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${M.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,i=new n(t),r=this.getServerCertificateUrl(e);return r?(this.log(`Fetching server certificate for "${e}"`),new Promise((n,s)=>{const u={responseType:"arraybuffer",url:r},l=t.certLoadPolicy.default,c={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(e,t,i,r)=>{n(e.data)},onError:(t,n,i,l)=>{s(new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:m({url:u.url,data:void 0},t)},`"${e}" certificate request failed (${r}). Status: ${t.code} (${t.text})`))},onTimeout:(t,n,i)=>{s(new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:{url:u.url,data:void 0}},`"${e}" certificate request timed out (${r})`))},onAbort:(e,t,n)=>{s(new Error("aborted"))}};i.load(u,c,d)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((i,r)=>{e.setServerCertificate(n).then(r=>{this.log(`setServerCertificate ${r?"success":"not supported by CDM"} (${null==n?void 0:n.byteLength}) on "${t}"`),i(e)}).catch(e=>{r(new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(t=>this.updateKeySession(e,new Uint8Array(t)).catch(e=>{throw new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const i=(new DOMParser).parseFromString(n,"application/xml"),r=i.querySelectorAll("HttpHeader");if(r.length>0){let t;for(let n=0,i=r.length;n<i;n++){var s,a;t=r[n];const i=null==(s=t.querySelector("name"))?void 0:s.textContent,o=null==(a=t.querySelector("value"))?void 0:a.textContent;i&&o&&e.setRequestHeader(i,o)}}const o=i.querySelector("Challenge"),u=null==o?void 0:o.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return Rn(atob(u))}setupLicenseXHR(e,t,n,i){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,n,i)}).catch(s=>{if(!n.decryptdata)throw s;return e.open("POST",t,!0),r.call(this.hls,e,t,n,i)}).then(n=>{e.readyState||e.open("POST",t,!0);const r=n||i;return{xhr:e,licenseChallenge:r}}):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((i,r)=>{const s=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${s}`);const u=new XMLHttpRequest;u.responseType="arraybuffer",u.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(4===u.readyState)if(200===u.status){this._requestLicenseFailureCount=0;let t=u.response;this.log(`License received ${t instanceof ArrayBuffer?t.byteLength:t}`);const n=this.config.licenseResponseCallback;if(n)try{t=n.call(this.hls,u,s,e)}catch(l){this.error(l)}i(t)}else{const l=n.errorRetry,c=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>c||u.status>=400&&u.status<500)r(new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:u,response:{url:s,data:void 0,code:u.status,text:u.statusText}},`License Request XHR failed (${s}). Status: ${u.status} (${u.statusText})`));else{const n=c-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${n} attempts left`),this.requestLicense(e,t).then(i,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=u,this.setupLicenseXHR(u,s,e,t).then(({xhr:t,licenseChallenge:n})=>{e.keySystem==_n.PLAYREADY&&(n=this.unpackPlayReadyKeyMessage(t,n)),t.send(n)})})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,bo(n,"encrypted",this.onMediaEncrypted),bo(n,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(To(e,"encrypted",this.onMediaEncrypted),To(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const t=this.media,n=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,qn.clearKeyUriToKeyIdMap();const i=n.length;So.CDMCleanupPromise=Promise.all(n.map(e=>this.removeSession(e)).concat(null==t||null==(e=t.setMediaKeys(null))?void 0:e.catch(e=>{var t;this.log(`Could not clear media keys: ${e}`),null==(t=this.hls)||t.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${e}`)})}))).catch(e=>{var t;this.log(`Could not close sessions and clear media keys: ${e}`),null==(t=this.hls)||t.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${e}`)})}).then(()=>{i&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(t&&this.config.emeEnabled&&!this.keyFormatPromise){const e=t.reduce((e,t)=>(-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e),[]);this.log(`Selecting key-system from session-keys ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);i>-1&&this.mediaKeySessions.splice(i,1);const{drmSystemOptions:r}=this.config,s=Hn(r)?new Promise((e,n)=>{self.setTimeout(()=>n(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(e)}):Promise.resolve();return s.catch(e=>{var t;this.log(`Could not remove session: ${e}`),null==(t=this.hls)||t.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${e}`)})}).then(()=>t.close()).catch(e=>{var t;this.log(`Could not close session: ${e}`),null==(t=this.hls)||t.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${e}`)})})}}}So.CDMCleanupPromise=void 0;class Eo extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}class wo{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(u.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(u.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&"function"===typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const e=i-this.lastTime,r=n-this.lastDroppedFrames,s=t-this.lastDecodedFrames,a=1e3*r/e,o=this.hls;if(o.trigger(u.FPS_DROP,{currentDropped:r,currentDecoded:s,totalDroppedFrames:n}),a>0&&r>o.config.fpsDroppedMonitoringThreshold*s){let e=o.currentLevel;o.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===o.autoLevelCapping||o.autoLevelCapping>=e)&&(e-=1,o.trigger(u.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:o.currentLevel}),o.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function Ao(e,t){let n;try{n=new Event("addtrack")}catch(ql){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function xo(e,t){const n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(ql){k.debug(`[texttrack-utils]: ${ql}`);try{const n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(i){k.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${i}`)}}"disabled"===n&&(e.mode=n)}function Io(e,t){const n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues)for(let i=e.cues.length;i--;)t&&e.cues[i].removeEventListener("enter",t),e.removeCue(e.cues[i]);"disabled"===n&&(e.mode=n)}function ko(e,t,n,i){const r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&e.cues.length>0){const r=Ro(e.cues,t,n);for(let t=0;t<r.length;t++)i&&!i(r[t])||e.removeCue(r[t])}"disabled"===r&&(e.mode=r)}function Lo(e,t){if(t<=e[0].startTime)return 0;const n=e.length-1;if(t>e[n].endTime)return-1;let i,r=0,s=n;while(r<=s)if(i=Math.floor((s+r)/2),t<e[i].startTime)s=i-1;else{if(!(t>e[i].startTime&&r<n))return i;r=i+1}return e[r].startTime-t<t-e[s].startTime?r:s}function Ro(e,t,n){const i=[],r=Lo(e,t);if(r>-1)for(let s=r,a=e.length;s<a;s++){const r=e[s];if(r.startTime>=t&&r.endTime<=n)i.push(r);else if(r.startTime>n)return i}return i}function Co(e){const t=[];for(let n=0;n<e.length;n++){const i=e[n];"subtitles"!==i.kind&&"captions"!==i.kind||!i.label||t.push(e[n])}return t}class Do extends zs{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=null;const t=Co(this.media.textTracks);for(let i=0;i<t.length;i++)if("hidden"===t[i].mode)e=t[i];else if("showing"===t[i].mode){e=t[i];break}const n=this.findTrackForTextTrack(e);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.MANIFEST_PARSED,this.onManifestParsed,this),e.on(u.LEVEL_LOADING,this.onLevelLoading,this),e.on(u.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(u.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(u.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.MANIFEST_PARSED,this.onManifestParsed,this),e.off(u.LEVEL_LOADING,this.onLevelLoading,this),e.off(u.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(u.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(u.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const n=this.media;if(!n)return;const i=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||n.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,i)return;const r=Co(n.textTracks);r.forEach(e=>{Io(e)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn(`Subtitle track with id:${n} and group:${i} not found in active group ${null==s?void 0:s.groupId}`);const a=s.details;s.details=t.details,this.log(`Subtitle track ${n} "${s.name}" lang:${s.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some(e=>-1===(null==i?void 0:i.indexOf(e)))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter(e=>!n||-1!==n.indexOf(e.groupId));if(e.length)this.selectDefaultTrack&&!e.some(e=>e.default)&&(this.selectDefaultTrack=!1),e.forEach((e,t)=>{e.id=t});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.subtitlePreference;if(!r&&t){this.selectDefaultTrack=!1;const n=gt(t,e);if(n>-1)r=e[n];else{const e=gt(t,this.tracks);r=this.tracks[e]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const s={subtitleTracks:e};this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${null==n?void 0:n.join(",")}" group-id`),this.hls.trigger(u.SUBTITLE_TRACKS_UPDATED,s),-1!==i&&-1===this.trackId&&this.setSubtitleTrack(i)}}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<t.length;i++){const r=t[i];if((!n||r.default)&&(n||e)&&(!e||mt(r,e)))return i}if(e){for(let n=0;n<t.length;n++){const i=t[n];if(Qs(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const i=t[n];if(Qs(e.attrs,i.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(Js(i,e))return n}}return-1}onError(e,t){!t.fatal&&t.context&&(t.context.type!==l.SUBTITLE_TRACK||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(-1===e.id)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&mt(e,n))return n;const i=gt(e,this.tracksInGroup);if(i>-1){const e=this.tracksInGroup[i];return this.setSubtitleTrack(i),e}if(n)return null;{const n=gt(e,t);if(n>-1)return t[n]}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,i=e.groupId,r=this.getUrlWithDirectives(e.url,t),s=e.details,a=null==s?void 0:s.age;this.log(`Loading subtitle ${n} "${e.name}" lang:${e.lang} group:${i}${void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:""}${a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""} ${r}`),this.hls.trigger(u.SUBTITLE_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Co(e.textTracks),n=this.currentTrack;let i;if(n&&(i=t.filter(e=>Js(n,e))[0],i||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(e=>{"disabled"!==e.mode&&e!==i&&(e.mode="disabled")}),i){const e=this.subtitleDisplay?"showing":"hidden";i.mode!==e&&(i.mode=e)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(e<-1||e>=t.length||!i(e))return void this.warn(`Invalid subtitle track id: ${e}`);this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r)return void this.hls.trigger(u.SUBTITLE_TRACK_SWITCH,{id:e});const s=!!r.details&&!r.details.live;if(e===this.trackId&&r===n&&s)return;this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:a,groupId:o="",name:l,type:c,url:d}=r;this.hls.trigger(u.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:l,type:c,url:d});const h=this.switchParams(r.url,null==n?void 0:n.details,r.details);this.loadPlaylist(h)}}function Mo(){try{return crypto.randomUUID()}catch(e){try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch(e){let t=(new Date).getTime();const n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)});return n}}}function Po(e){let t=5381,n=e.length;while(n)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()}const _o=.025;let Oo=function(e){return e[e["Point"]=0]="Point",e[e["Range"]=1]="Range",e}({});function No(e,t,n){return`${e.identifier}-${n+1}-${Po(t)}`}class Uo{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,null==(e=this.assetListLoader)||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const n=this.playoutLimit;if(e<=0||isNaN(n))return!1;if(0===n)return!0;const i=(null==(t=this.assetList[e])?void 0:t.startOffset)||0;return i>n}findAssetIndex(e){const t=this.assetList.indexOf(e);return t}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Fo(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(0===this.startTime||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,n=Fo(t,e);return t-n<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=i(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Fo(e,t)}return e}get appendInPlace(){return!!this.appendInPlaceStarted||!this.appendInPlaceDisabled&&!(this.cue.once||this.cue.pre||!this.startIsAligned||!(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<_o))}set appendInPlace(e){this.appendInPlaceStarted?this.resetOnResume=!e:this.appendInPlaceDisabled=!e}get timelineStart(){return null!==this._timelineStart?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return t=null!==this._duration?this._duration:this.dateRange.duration?this.dateRange.duration:this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return"RANGE"===this.dateRange.attr["X-TIMELINE-OCCUPIES"]?Oo.Range:Oo.Point}get supplementsPrimary(){return"PRIMARY"===this.dateRange.attr["X-TIMELINE-STYLE"]}get contentMayVary(){return"NO"!==this.dateRange.attr["X-CONTENT-MAY-VARY"]}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||null!==this.assetListResponse}toString(){return $o(this)}}function Fo(e,t){return e-t.start<t.duration/2&&!(Math.abs(e-(t.start+t.duration))<_o)?t.start:t.start+t.duration}function Bo(e,t,n){const i=new self.URL(e,n);return"data:"!==i.protocol&&i.searchParams.set("_HLS_primary_id",t),i}function jo(e,t){while(null!=(n=e.assetList[++t])&&n.error)var n;return t}function $o(e){return`["${e.identifier}" ${e.cue.pre?"<pre>":e.cue.post?"<post>":""}${e.timelineStart.toFixed(2)}-${e.resumeTime.toFixed(2)}]`}function Go(e){const t=e.timelineStart,n=e.duration||0;return`["${e.identifier}" ${t.toFixed(2)}-${(t+n).toFixed(2)}]`}class Vo{constructor(e,t,n,i){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls.trigger(u.PLAYOUT_LIMIT_REACHED,{})};const r=this.hls=new e(t);this.interstitial=n,this.assetItem=i;let s=i.uri;try{s=Bo(s,t.primarySessionId).href}catch(o){}r.loadSource(s);const a=()=>{this.hasDetails=!0};r.once(u.LEVEL_LOADED,a),r.once(u.AUDIO_TRACK_LOADED,a),r.once(u.SUBTITLE_TRACK_LOADED,a),r.on(u.MEDIA_ATTACHING,(e,{media:t})=>{this.removeMediaListeners(),this.mediaAttached=t;const n=this.interstitial;n.playoutLimit&&(t.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&r.on(u.BUFFER_APPENDED,()=>{const e=this.bufferedEnd;this.reachedPlayout(e)&&(this._bufferedEosTime=e,r.trigger(u.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){var e;return(null==(e=this.interstitial)?void 0:e.appendInPlace)||!1}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if(null!=(t=this.hls)&&t.bufferedToEnd)return!0;if(!e||!this._bufferedEosTime)return!1;const n=this.timelineOffset,i=dn.bufferInfo(e,n,0),r=this.getAssetTime(i.end);return r>=this._bufferedEosTime-.02}reachedPlayout(e){const t=this.interstitial,n=t.playoutLimit;return this.startOffset+e>=n}get destroyed(){var e;return!(null!=(e=this.hls)&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return(null==(e=this.hls)?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=dn.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;return e||0}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return(null==(e=this.hls)?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const n=e-t;if(Math.abs(n)>1/9e4){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,n=this.duration;return Math.min(Math.max(0,e-t),n)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){var e;this.mediaAttached&&(null!=(e=this.hls)&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd))}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){this.hls.attachMedia(e)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}resetDetails(){const e=this.hls;if(this.hasDetails){e.stopLoad();const t=e=>delete e.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,n){this.hls.on(e,t)}once(e,t,n){this.hls.once(e,t)}off(e,t,n){this.hls.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${Go(this.assetItem)} ${null==(e=this.hls)?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const Ho=.033;class Ko extends b{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((n,i)=>e<=i.startOffset&&t>i.startOffset?(delete i.error,n+1):n,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let n=-1;e.nextEvent?n=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(n=this.findEventIndex(e.previousEvent.identifier)+1);const i=this.items;if(i){i[n]||(void 0===t&&(t=e.start),n=this.findItemIndexAtTime(t));while(n>=0&&null!=(r=i[n])&&r.event){var r;n--}}return n}findItemIndexAtTime(e,t){const n=this.items;if(n)for(let i=0;i<n.length;i++){let r=n[i];if(t&&"primary"!==t&&(r=r[t]),e===r.start||e>r.start&&e<r.end)return i}return-1}findJumpRestrictedIndex(e,t){const n=this.items;if(n)for(let i=e;i<=t;i++){if(!n[i])break;const e=n[i].event;if(null!=e&&e.restrictions.jump&&!e.appendInPlace)return i}return-1}findEventIndex(e){const t=this.items;if(t)for(let i=t.length;i--;){var n;if((null==(n=t[i].event)?void 0:n.identifier)===e)return i}return-1}findAssetIndex(e,t){const n=e.assetList,i=n.length;if(i>1)for(let r=0;r<i;r++){const e=n[r];if(!e.error){const n=e.timelineStart;if(t===n||t>n&&t<n+(e.duration||0))return r}}return 0}get assetIdAtEnd(){var e,t;const n=null==(e=this.items)||null==(t=e[this.length-1])?void 0:t.event;if(n){const e=n.assetList,t=e[e.length-1];if(t)return t.identifier}return null}parseInterstitialDateRanges(e,t){const n=e.main.details,{dateRanges:i}=n,r=this.events,s=this.parseDateRanges(i,{url:n.url},t),a=Object.keys(i),o=r?r.filter(e=>!a.includes(e.identifier)):[];s.length&&s.sort((e,t)=>{const n=e.cue.pre,i=e.cue.post,r=t.cue.pre,s=t.cue.post;if(n&&!r)return-1;if(r&&!n)return 1;if(i&&!s)return 1;if(s&&!i)return-1;if(!n&&!r&&!i&&!s){const n=e.startTime,i=t.startTime;if(n!==i)return n-i}return e.dateRange.tagOrder-t.dateRange.tagOrder}),this.events=s,o.forEach(e=>{this.removeEvent(e)}),this.updateSchedule(e,o)}updateSchedule(e,t=[]){const n=this.events||[];if(n.length||t.length||this.length<2){const i=this.items,r=this.parseSchedule(n,e),s=t.length||(null==i?void 0:i.length)!==r.length||r.some((e,t)=>Math.abs(e.playout.start-i[t].playout.start)>.005||Math.abs(e.playout.end-i[t].playout.end)>.005);s&&(this.items=r,this.onScheduleUpdate(t,i))}}parseDateRanges(e,t,n){const i=[],r=Object.keys(e);for(let s=0;s<r.length;s++){const a=r[s],o=e[a];if(o.isInterstitial){let e=this.eventMap[a];e?e.setDateRange(o):(e=new Uo(o,t),this.eventMap[a]=e,!1===n&&(e.appendInPlace=n)),i.push(e)}}return i}parseSchedule(e,t){const n=[],i=t.main.details,r=i.live?1/0:i.edge;let s=0;if(e=e.filter(e=>!e.error&&!(e.cue.once&&e.hasPlayed)),e.length){this.resolveOffsets(e,t);let i=0,o=0;if(e.forEach((t,a)=>{const u=t.cue.pre,l=t.cue.post,c=e[a-1]||null,d=t.appendInPlace,h=l?r:t.startOffset,f=t.duration,p=t.timelineOccupancy===Oo.Range?f:0,g=t.resumptionOffset,m=(null==c?void 0:c.startTime)===h,v=h+t.cumulativeDuration;let y=d?v+f:h+g;if(u||!l&&h<=0){const e=o;o+=p,t.timelineStart=v;const i=s;s+=f,n.push({event:t,start:v,end:y,playout:{start:i,end:s},integrated:{start:e,end:o}})}else{if(!(h<=r))return;{if(!m){const r=h-i;if(r>Ho){const u=i,l=o;o+=r;const c=s;s+=r;const d={previousEvent:e[a-1]||null,nextEvent:t,start:u,end:u+r,playout:{start:c,end:s},integrated:{start:l,end:o}};n.push(d)}else r>0&&c&&(c.cumulativeDuration+=r,n[n.length-1].end=h)}l&&(y=v),t.timelineStart=v;const r=o;o+=p;const u=s;s+=f,n.push({event:t,start:v,end:y,playout:{start:u,end:s},integrated:{start:r,end:o}})}}const b=t.resumeTime;i=l||b>r?r:b}),i<r){var a;const e=i,t=o,u=r-i;o+=u;const l=s;s+=u,n.push({previousEvent:(null==(a=n[n.length-1])?void 0:a.event)||null,nextEvent:null,start:i,end:e+u,playout:{start:l,end:s},integrated:{start:t,end:o}})}this.setDurations(r,s,o)}else{const e=0;n.push({previousEvent:null,nextEvent:null,start:e,end:r,playout:{start:e,end:r},integrated:{start:e,end:r}}),this.setDurations(r,r,r)}return n}setDurations(e,t,n){this.durations={primary:e,playout:t,integrated:n}}resolveOffsets(e,t){const n=t.main.details,r=n.live?1/0:n.edge;let s=0,a=-1;e.forEach((o,u)=>{const l=o.cue.pre,c=o.cue.post,d=l?0:c?r:o.startTime;this.updateAssetDurations(o);const h=a===d;if(h?o.cumulativeDuration=s:(s=0,a=d),!c&&o.snapOptions.in&&(o.resumeAnchor=It(null,n.fragments,o.startOffset+o.resumptionOffset,0,0)||void 0),o.appendInPlace&&!o.appendInPlaceStarted){const e=this.primaryCanResumeInPlaceAt(o,t);e||(o.appendInPlace=!1)}if(!o.appendInPlace&&u+1<e.length){const t=e[u+1].startTime-e[u].resumeTime;t<Ho&&(e[u+1].appendInPlace=!1,e[u+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${o}`))}const f=i(o.resumeOffset)?o.resumeOffset:o.duration;s+=f})}primaryCanResumeInPlaceAt(e,t){const n=e.resumeTime,i=e.startTime+e.resumptionOffset;if(Math.abs(n-i)>_o)return this.log(`"${e.identifier}" resumption ${n} not aligned with estimated timeline end ${i}`),!1;if(!t)return this.log(`"${e.identifier}" resumption ${n} can not be aligned with media (none selected)`),!1;const r=Object.keys(t);return!r.some(i=>{const r=t[i].details,s=r.edge;if(n>=s)return this.log(`"${e.identifier}" resumption ${n} past ${i} playlist end ${s}`),!1;const a=It(null,r.fragments,n);if(!a)return this.log(`"${e.identifier}" resumption ${n} does not align with any fragments in ${i} playlist (${r.fragStart}-${r.fragmentEnd})`),!0;const o="audio"===i?.175:0,u=Math.abs(a.start-n)<_o+o||Math.abs(a.end-n)<_o+o;return!u&&(this.log(`"${e.identifier}" resumption ${n} not aligned with ${i} fragment bounds (${a.start}-${a.end} sn: ${a.sn} cc: ${a.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let n=0,i=!1,r=!1;e.assetList.forEach((e,s)=>{const a=t+n;e.startOffset=n,e.timelineStart=a,i||(i=null===e.duration),r||(r=!!e.error);const o=e.error?0:e.duration||0;n+=o}),e.duration=i&&!r?Math.max(n,e.duration):n}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function Wo(e){return`[${e.event?'"'+e.event.identifier+'"':"primary"}: ${e.start.toFixed(2)}-${e.end.toFixed(2)}]`}class qo{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const n=e.assetListUrl;let i;try{i=Bo(n,this.hls.sessionId,e.baseUrl)}catch(f){const t=this.assignAssetListError(e,o.ASSET_LIST_LOAD_ERROR,f,n);return void this.hls.trigger(u.ERROR,t)}t&&"data:"!==i.protocol&&i.searchParams.set("_HLS_start_offset",""+t);const r=this.hls.config,s=r.loader,a=new s(r),l={responseType:"json",url:i.href},c=r.interstitialAssetListLoadPolicy.default,d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(t,n,i,r)=>{const s=t.data,a=null==s?void 0:s.ASSETS;if(Array.isArray(a))e.assetListResponse=s,this.hls.trigger(u.ASSET_LIST_LOADED,{event:e,assetListResponse:s,networkDetails:r});else{const t=this.assignAssetListError(e,o.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),i.url,n,r);this.hls.trigger(u.ERROR,t)}},onError:(t,n,i,r)=>{const s=this.assignAssetListError(e,o.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${t.code} ${t.text} (${n.url})`),n.url,r,i);this.hls.trigger(u.ERROR,s)},onTimeout:(t,n,i)=>{const r=this.assignAssetListError(e,o.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${n.url})`),n.url,t,i);this.hls.trigger(u.ERROR,r)}};return a.load(l,d,h),this.hls.trigger(u.ASSET_LIST_LOADING,{event:e}),a}assignAssetListError(e,t,n,i,r,s){return e.error=n,{type:a.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:i,error:n,networkDetails:s,stats:r}}}function Yo(e){null==e||e.play().catch(()=>{})}class zo extends b{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const e=this.currentTime;if(void 0===e||this.playbackDisabled)return;const t=e-this.timelinePos,n=Math.abs(t)<1/7056e5;if(n)return;const i=t<=-.01;this.timelinePos=e,this.bufferedPos=e;const r=this.playingItem;if(!r)return void this.checkBuffer();if(i){const n=this.schedule.resetErrorsInRange(e,e-t);n&&this.updateSchedule()}if(this.checkBuffer(),i&&e<r.start||e>=r.end){var s;const e=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(r)&&null!=(s=this.media)&&s.paused&&(this.shouldPlay=!1),!i){const t=this.findItemIndex(r);if(e>t){const n=this.schedule.findJumpRestrictedIndex(t+1,e);if(n>t)return void this.setSchedulePosition(n)}}return void this.setSchedulePosition(e)}const a=this.playingAsset;if(!a){if(this.playingLastItem&&this.isInterstitial(r)){const t=r.event.assetList[0];t&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(e,t))}return}const o=a.timelineStart,u=a.duration||0;(i&&e<o||e>=o+u)&&this.setScheduleToAssetAtTime(e,a)},this.onTimeupdate=()=>{const e=this.currentTime;if(void 0===e||this.playbackDisabled)return;if(!(e>this.timelinePos))return;this.timelinePos=e,e>this.bufferedPos&&this.checkBuffer();const t=this.playingItem;if(!t||this.playingLastItem)return;if(e>=t.end){this.timelinePos=t.end;const e=this.findItemIndex(t);this.setSchedulePosition(e+1)}const n=this.playingAsset;if(!n)return;const i=n.timelineStart+(n.duration||0);e>=i&&this.setScheduleToAssetAtTime(e,n)},this.onScheduleUpdate=(e,t)=>{const n=this.schedule,i=this.playingItem,r=n.events||[],s=n.items||[],a=n.durations,o=e.map(e=>e.identifier),l=!(!r.length&&!o.length);(l||t)&&this.log(`INTERSTITIALS_UPDATED (${r.length}): ${r}\nSchedule: ${s.map(e=>Wo(e))} pos: ${this.timelinePos}`),o.length&&this.log(`Removed events ${o}`),this.playerQueue.forEach(e=>{if(e.interstitial.appendInPlace){const n=e.assetItem.timelineStart,i=e.timelineOffset-n;if(i)try{e.timelineOffset=n}catch(t){Math.abs(i)>_o&&this.warn(`${t} ("${e.assetId}" ${e.timelineOffset}->${n})`)}}});let c=null;if(i){const e=this.updateItem(i,this.timelinePos);this.itemsMatch(i,e)&&(this.playingItem=e,this.waitingItem=this.endedItem=null,c=()=>this.trimInPlace(e,i))}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const d=this.bufferingItem;if(d){const e=this.updateItem(d,this.bufferedPos);this.itemsMatch(d,e)?(this.bufferingItem=e,c||(c=()=>this.trimInPlace(e,d))):d.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(d.event,null))}if(e.forEach(e=>{e.assetList.forEach(e=>{this.clearAssetPlayer(e.identifier,null)})}),l||t){if(this.hls.trigger(u.INTERSTITIALS_UPDATED,{events:r.slice(0),schedule:s.slice(0),durations:a,removedIds:o}),this.isInterstitial(i)&&o.includes(i.event.identifier))return this.warn(`Interstitial "${i.event.identifier}" removed while playing`),void this.primaryFallback(i.event);c&&c(),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new qo(e),this.schedule=new Ko(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(u.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(u.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(u.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(u.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(u.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(u.BUFFER_APPENDED,this.onBufferAppended,this),e.on(u.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(u.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(u.MEDIA_ENDED,this.onMediaEnded,this),e.on(u.ERROR,this.onError,this),e.on(u.DESTROYING,this.onDestroying,this)}unregisterListeners(){const e=this.hls;e&&(e.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(u.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(u.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(u.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(u.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(u.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(u.BUFFER_CODECS,this.onBufferCodecs,this),e.off(u.BUFFER_APPENDED,this.onBufferAppended,this),e.off(u.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(u.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(u.MEDIA_ENDED,this.onMediaEnded,this),e.off(u.ERROR,this.onError,this),e.off(u.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;null==(e=this.getBufferingPlayer())||e.resumeBuffering()}pauseBuffering(){var e;null==(e=this.getBufferingPlayer())||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){To(e,"play",this.onPlay),To(e,"pause",this.onPause),To(e,"seeking",this.onSeeking),To(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const n=this.media=t.media;bo(n,"seeking",this.onSeeking),bo(n,"timeupdate",this.onTimeupdate),bo(n,"play",this.onPlay),bo(n,"pause",this.onPause)}onMediaAttached(e,t){const n=this.effectivePlayingItem,i=this.detachedData;if(this.detachedData=null,null===n)this.checkStart();else if(!i){this.clearScheduleState();const e=this.findItemIndex(n);this.setSchedulePosition(e)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const n=!!t.transferMedia,i=this.media;if(this.media=null,!n&&(i&&this.removeMediaListeners(i),this.detachedData)){const e=this.getBufferingPlayer();e&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,e.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const e=this,t=()=>e.bufferingItem||e.waitingItem,n=t=>t?e.getAssetPlayer(t.identifier):t,i=(t,i,r,a,o)=>{if(t){let u=t[i].start;const l=t.event;if(l){if("playout"===i||l.timelineOccupancy!==Oo.Point){const e=n(r);(null==e?void 0:e.interstitial)===l&&(u+=e.assetItem.startOffset+e[o])}}else{const n="bufferedPos"===a?s():e[a];u+=n-t.start}return u}return 0},r=(t,n)=>{if(0!==t&&"primary"!==n&&e.schedule.length){var i;const r=e.schedule.findItemIndexAtTime(t),s=null==(i=e.schedule.items)?void 0:i[r];if(s){const e=s[n].start-s.start;return t+e}}return t},s=()=>{const t=e.bufferedPos;return t===Number.MAX_VALUE?a("primary"):Math.max(t,0)},a=t=>{var n;return null!=(n=e.primaryDetails)&&n.live?e.primaryDetails.edge:e.schedule.durations[t]},o=(t,r)=>{var s,a;const o=e.effectivePlayingItem;if(null!=o&&null!=(s=o.event)&&s.restrictions.skip)return;e.log(`seek to ${t} "${r}"`);const u=e.effectivePlayingItem,l=e.schedule.findItemIndexAtTime(t,r),c=null==(a=e.schedule.items)?void 0:a[l],d=e.getBufferingPlayer(),h=null==d?void 0:d.interstitial,f=null==h?void 0:h.appendInPlace,p=u&&e.itemsMatch(u,c);if(u&&(f||p)){const s=n(e.playingAsset),a=(null==s?void 0:s.media)||e.primaryMedia;if(a){const n="primary"===r?a.currentTime:i(u,r,e.playingAsset,"timelinePos","currentTime"),o=t-n,l=(f?n:a.currentTime)+o;if(l>=0&&(!s||f||l<=s.duration))return void(a.currentTime=l)}}if(c){let n=t;if("primary"!==r){const e=c[r].start,i=t-e;n=c.start+i}const i=!e.isInterstitial(c);if(e.isInterstitial(u)&&!u.event.appendInPlace||!i&&!c.event.appendInPlace){if(u){const s=e.findItemIndex(u);if(l>s){const t=e.schedule.findJumpRestrictedIndex(s+1,l);if(t>s)return void e.setSchedulePosition(t)}let a=0;if(i)e.timelinePos=n,e.checkBuffer();else{var g;const e=null==c||null==(g=c.event)?void 0:g.assetList;if(e){const n=t-(c[r]||c).start;for(let t=e.length;t--;){const i=e[t];if(i.duration&&n>=i.startOffset&&n<i.startOffset+i.duration){a=t;break}}}}e.setSchedulePosition(l,a)}}else{const t=e.media||(f?null==d?void 0:d.media:null);t&&(t.currentTime=n)}}},u=()=>{const n=e.effectivePlayingItem;if(e.isInterstitial(n))return n;const i=t();return e.isInterstitial(i)?i:null},l={get currentTime(){const t=u(),n=e.effectivePlayingItem;return n&&n===t?i(n,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-n.playout.start:0},set currentTime(t){const n=u(),i=e.effectivePlayingItem;i&&i===n&&o(t+i.playout.start,"playout")},get duration(){const e=u();return e?e.playout.end-e.playout.start:0},get assetPlayers(){var t;const n=null==(t=u())?void 0:t.event.assetList;return n?n.map(t=>e.getAssetPlayer(t.identifier)):[]},get playingIndex(){var t;const n=null==(t=u())?void 0:t.event;return n&&e.effectivePlayingAsset?n.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return u()}};this.manager={get events(){var t,n;return(null==(t=e.schedule)||null==(n=t.events)?void 0:n.slice(0))||[]},get schedule(){var t,n;return(null==(t=e.schedule)||null==(n=t.items)?void 0:n.slice(0))||[]},get interstitialPlayer(){return u()?l:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const n=t();return e.findItemIndex(n)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const t=e.effectivePlayingItem;return e.findItemIndex(t)},primary:{get bufferedEnd(){return s()},get currentTime(){const t=e.timelinePos;return t>0?t:0},set currentTime(e){o(e,"primary")},get duration(){return a("primary")},get seekableStart(){var t;return(null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0}},integrated:{get bufferedEnd(){return i(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return i(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(e){o(e,"integrated")},get duration(){return a("integrated")},get seekableStart(){var t;return r((null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0,"integrated")}},skip:()=>{const t=e.effectivePlayingItem,n=null==t?void 0:t.event;if(n&&!n.restrictions.skip){const i=e.findItemIndex(t);if(n.appendInPlace){const e=t.playout.start+t.event.duration;o(e+.001,"playout")}else e.advanceAfterAssetEnded(n,i,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,n=null==(e=this.schedule)?void 0:e.items;return!!(this.playbackStarted&&t&&n)&&this.findItemIndex(t)===n.length-1}get playbackStarted(){return null!==this.effectivePlayingItem}get currentTime(){var e,t,n;if(null===this.mediaSelection)return;const r=this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&!r.event.appendInPlace)return;let s=this.media;!s&&null!=(e=this.bufferingItem)&&null!=(t=e.event)&&t.appendInPlace&&(s=this.primaryMedia);const a=null==(n=s)?void 0:n.currentTime;return void 0!==a&&i(a)?a:void 0}get primaryMedia(){var e;return this.media||(null==(e=this.detachedData)?void 0:e.media)||null}isInterstitial(e){return!(null==e||!e.event)}retreiveMediaSource(e,t){const n=this.getAssetPlayer(e);n&&this.transferMediaFromPlayer(n,t)}transferMediaFromPlayer(e,t){const n=e.interstitial.appendInPlace,i=e.media;if(n&&i===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&i)return void(this.detachedData={media:i});const n=e.transferMedia();this.log(`transfer MediaSource from ${e} ${lt(n)}`),this.detachedData=n}else t&&i&&(this.shouldPlay||(this.shouldPlay=!i.paused))}transferMediaTo(e,t){var n,i;if(e.media===t)return;let r=null;const s=this.hls,a=e!==s,o=a&&e.interstitial.appendInPlace,u=null==(n=this.detachedData)?void 0:n.mediaSource;let l;if(s.media)o&&(r=s.transferMedia(),this.detachedData=r),l="Primary";else if(u){const e=this.getBufferingPlayer();e?(r=e.transferMedia(),l=`${e}`):l="detached MediaSource"}else l="detached media";if(!r)if(u)r=this.detachedData,this.log(`using detachedData: MediaSource ${lt(r)}`);else if(!this.detachedData||s.media===t){const e=this.playerQueue;e.length>1&&e.forEach(e=>{if(a&&e.interstitial.appendInPlace!==o){const t=e.interstitial;this.clearInterstitial(e.interstitial,null),t.appendInPlace=!1,t.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${t}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}const c=r&&"mediaSource"in r&&"closed"!==(null==(i=r.mediaSource)?void 0:i.readyState),d=c&&r?r:t;if(this.log(`${c?"transfering MediaSource":"attaching media"} to ${a?e:"Primary"} from ${l}`),d===r){const t=a&&e.assetId===this.schedule.assetIdAtEnd;d.overrides={duration:this.schedule.duration,endOfStream:!a||t,cueRemoval:!a}}e.attachMedia(d)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e.events;if(!t||this.playbackDisabled||!this.media)return;-1===this.bufferedPos&&(this.bufferedPos=0);const n=this.timelinePos,i=this.effectivePlayingItem;if(-1===n){const n=this.hls.startPosition;if(this.timelinePos=n,t.length&&t[0].cue.pre){const n=e.findEventIndex(t[0].identifier);this.setSchedulePosition(n)}else if(n>=0||!this.primaryLive){const t=this.timelinePos=n>0?n:0,i=e.findItemIndexAtTime(t);this.setSchedulePosition(i)}}else if(i&&!this.playingItem){const t=e.findItemIndex(i);this.setSchedulePosition(t)}}advanceAfterAssetEnded(e,t,n){const i=jo(e,n);if(e.isAssetPastPlayoutLimit(i)){const n=this.schedule.items;if(n){const i=t+1,r=n.length;if(i>=r)return void this.setSchedulePosition(-1);const s=e.resumeTime;this.timelinePos<s&&(this.timelinePos=s,this.checkBuffer()),this.setSchedulePosition(i)}}else this.setSchedulePosition(t,i)}setScheduleToAssetAtTime(e,t){const n=this.schedule,i=t.parentIdentifier,r=n.getEvent(i);if(r){const t=n.findEventIndex(i),s=n.findAssetIndex(r,e);this.advanceAfterAssetEnded(r,t,s-1)}}setSchedulePosition(e,t){const n=this.schedule.items;if(!n||this.playbackDisabled)return;this.log(`setSchedulePosition ${e}, ${t}`);const i=e>=0?n[e]:null,r=this.playingItem,s=this.playingLastItem;if(this.isInterstitial(r)){var a;const l=r.event,c=this.playingAsset,d=null==c?void 0:c.identifier,h=d?this.getAssetPlayer(d):null;if(h&&d&&(!this.eventItemsMatch(r,i)||void 0!==t&&d!==(null==(a=l.assetList)?void 0:a[t].identifier))){var o;const t=l.findAssetIndex(c);this.log(`INTERSTITIAL_ASSET_ENDED ${t+1}/${l.assetList.length} ${Go(c)}`),this.endedAsset=c,this.playingAsset=null,this.hls.trigger(u.INTERSTITIAL_ASSET_ENDED,{asset:c,assetListIndex:t,event:l,schedule:n.slice(0),scheduleIndex:e,player:h}),this.retreiveMediaSource(d,i),!h.media||null!=(o=this.detachedData)&&o.mediaSource||h.detachMedia()}if(!this.eventItemsMatch(r,i)&&(this.endedItem=r,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${l} ${Wo(r)}`),l.hasPlayed=!0,this.hls.trigger(u.INTERSTITIAL_ENDED,{event:l,schedule:n.slice(0),scheduleIndex:e}),l.cue.once)){this.updateSchedule();const e=this.schedule.items;if(i&&e){const n=this.schedule.findItemIndex(i);this.advanceSchedule(n,e,t,r,s)}return}}this.advanceSchedule(e,n,t,r,s)}advanceSchedule(e,t,n,i,r){const s=e>=0?t[e]:null,a=this.primaryMedia,o=this.playerQueue;if(o.length&&o.forEach(t=>{const n=t.interstitial,i=this.schedule.findEventIndex(n.identifier);(i<e||i>e+1)&&this.clearInterstitial(n,s)}),this.isInterstitial(s)){this.timelinePos=Math.min(Math.max(this.timelinePos,s.start),s.end);const r=s.event;if(void 0===n){n=this.schedule.findAssetIndex(r,this.timelinePos);const t=jo(r,n-1);if(r.isAssetPastPlayoutLimit(t))return void this.advanceAfterAssetEnded(r,e,n);n=t}const o=this.waitingItem;this.assetsBuffered(s,a)||this.setBufferingItem(s);let l=this.preloadAssets(r,n);if(this.eventItemsMatch(s,o||i)||(this.waitingItem=s,this.log(`INTERSTITIAL_STARTED ${Wo(s)} ${r.appendInPlace?"append in place":""}`),this.hls.trigger(u.INTERSTITIAL_STARTED,{event:r,schedule:t.slice(0),scheduleIndex:e})),!r.assetListLoaded)return void this.log(`Waiting for ASSET-LIST to complete loading ${r}`);if(r.assetListLoader&&(r.assetListLoader.destroy(),r.assetListLoader=void 0),!a)return void this.log(`Waiting for attachMedia to start Interstitial ${r}`);this.waitingItem=this.endedItem=null,this.playingItem=s;const c=r.assetList[n];if(!c){const i=t[e+1],s=this.media;return i&&s&&!this.isInterstitial(i)&&s.currentTime<i.start&&(s.currentTime=this.timelinePos=i.start),void this.advanceAfterAssetEnded(r,e,n||0)}if(l||(l=this.getAssetPlayer(c.identifier)),null===l||l.destroyed){const e=r.assetList.length;this.warn(`asset ${n+1}/${e} player destroyed ${r}`),l=this.createAssetPlayer(r,c,n)}if(!this.eventItemsMatch(s,this.bufferingItem)&&r.appendInPlace&&this.isAssetBuffered(c))return;this.startAssetPlayer(l,n,t,e,a),this.shouldPlay&&Yo(l.media)}else null!==s?(this.resumePrimary(s,e,i),this.shouldPlay&&Yo(this.hls.media)):r&&this.isInterstitial(i)&&(this.endedItem=null,this.playingItem=i,i.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return!1===this.hls.config.enableInterstitialPlayback}get primaryDetails(){var e,t;return null==(e=this.mediaSelection)||null==(t=e.main)?void 0:t.details}get primaryLive(){var e;return!(null==(e=this.primaryDetails)||!e.live)}resumePrimary(e,t,n){var i;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${Wo(e)}`),null==(i=this.detachedData)||!i.mediaSource){let n=this.timelinePos;(n<e.start||n>=e.end)&&(n=this.getPrimaryResumption(e,t),this.timelinePos=n),this.attachPrimary(n,e)}if(!n)return;const r=this.schedule.items;r&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${Wo(e)}`),this.hls.trigger(u.INTERSTITIALS_PRIMARY_RESUMED,{schedule:r.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const n=e.start;if(this.primaryLive){const e=this.primaryDetails;if(0===t)return this.hls.startPosition;if(e&&(n<e.fragmentStart||n>e.edge))return this.hls.liveSyncPosition||-1}return n}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);if(null!=t&&t.hls)return t.hls.bufferedToEnd;const n=dn.bufferInfo(this.primaryMedia,this.timelinePos,0);return n.end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,n){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const i=this.primaryMedia;if(!i)return;const r=this.hls;r.media?this.checkBuffer():(this.transferMediaTo(r,i),n&&this.startLoadingPrimaryAt(e,n)),n||(this.timelinePos=e,this.startLoadingPrimaryAt(e,n))}startLoadingPrimaryAt(e,t){var n;const i=this.hls;!i.loadingEnabled||!i.media||Math.abs(((null==(n=i.mainForwardBufferInfo)?void 0:n.start)||i.media.currentTime)-e)>.5?i.startLoad(e,t):i.bufferingEnabled||i.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(u.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(u.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(-1===t.level)return;const n=this.hls.levels[t.level],i=m(m({},this.mediaSelection||this.altSelection),{},{main:n});this.mediaSelection=i,this.schedule.parseInterstitialDateRanges(i,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const n=this.hls.audioTracks[t.id],i=this.mediaSelection;if(!i)return void(this.altSelection=m(m({},this.altSelection),{},{audio:n}));const r=m(m({},i),{},{audio:n});this.mediaSelection=r}onSubtitleTrackUpdated(e,t){const n=this.hls.subtitleTracks[t.id],i=this.mediaSelection;if(!i)return void(this.altSelection=m(m({},this.altSelection),{},{subtitles:n}));const r=m(m({},i),{},{subtitles:n});this.mediaSelection=r}onAudioTrackSwitching(e,t){const n=pt(t);this.playerQueue.forEach(e=>e.hls.setAudioOption(t)||e.hls.setAudioOption(n))}onSubtitleTrackSwitch(e,t){const n=pt(t);this.playerQueue.forEach(e=>e.hls.setSubtitleOption(t)||-1!==t.id&&e.hls.setSubtitleOption(n))}onBufferCodecs(e,t){const n=t.tracks;n&&(this.requiredTracks=n)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const n=this.playingItem;if(n&&!this.itemsMatch(n,this.bufferingItem)&&!this.isInterstitial(n)){const e=this.timelinePos;this.bufferedPos=e,this.checkBuffer()}}onBufferedToEnd(e){const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let e=0;e<t.length;e++){const i=t[e];if(i.cue.post){var n;const e=this.schedule.findEventIndex(i.identifier),t=null==(n=this.schedule.items)?void 0:n[e];this.isInterstitial(t)&&this.eventItemsMatch(t,this.bufferingItem)&&this.bufferedToItem(t,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const e=this.findItemIndex(t);this.setSchedulePosition(e+1)}else this.shouldPlay=!1}updateItem(e,t){const n=this.schedule.items;if(e&&n){const i=this.findItemIndex(e,t);return n[i]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((t,n)=>{e.event.isAssetPastPlayoutLimit(n)&&this.clearAssetPlayer(t.identifier,null)});const t=e.end+.25,n=dn.bufferInfo(this.primaryMedia,t,0);(n.end>t||(n.nextStart||0)>t)&&(this.attachPrimary(t,null),this.flushFrontBuffer(t))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var n;return!!t&&(e===t||e.event.identifier===(null==(n=t.event)?void 0:n.identifier))}findItemIndex(e,t){return e?this.schedule.findItemIndex(e,t):-1}updateSchedule(){const e=this.mediaSelection;e&&this.schedule.updateSchedule(e,[])}checkBuffer(e){const t=this.schedule.items;if(!t)return;const n=dn.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=n.len<1),this.updateBufferedPos(n.end,t,e)}updateBufferedPos(e,t,n){const i=this.schedule,r=this.bufferingItem;if(this.bufferedPos>e)return;if(1===t.length&&this.itemsMatch(t[0],r))return void(this.bufferedPos=e);const s=this.playingItem,a=this.findItemIndex(s);let o=i.findItemIndexAtTime(e);if(this.bufferedPos<e){var u,l;const n=this.findItemIndex(r),i=Math.min(n+1,t.length-1),s=t[i];if((-1===o&&r&&e>=r.end||null!=(u=s.event)&&u.appendInPlace&&e+.01>=s.start)&&(o=i),i-a>1&&!1===(null==r||null==(l=r.event)?void 0:l.appendInPlace))return;if(this.bufferedPos=e,o>n&&o>a)this.bufferedToItem(s);else{const t=this.primaryDetails;this.primaryLive&&t&&e>t.edge-t.targetduration&&s.start<t.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(s)&&this.preloadAssets(s.event,0)}}else n&&s&&!this.itemsMatch(s,r)&&(o===a?this.bufferedToItem(s):o===a+1&&this.bufferedToItem(t[o]))}assetsBuffered(e,t){const n=e.event.assetList;return 0!==n.length&&!e.event.assetList.some(e=>{const n=this.getAssetPlayer(e.identifier);return!(null!=n&&n.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,n=this.schedule;if(this.itemsMatch(e,t))this.bufferingItem!==e&&(this.bufferingItem=e);else{const{items:i,events:r}=n;if(!i||!r)return t;const s=this.isInterstitial(e),a=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const o=a?a.remaining:t?t.end-this.timelinePos:0;this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${Wo(e)}`+(t?` (${o.toFixed(2)} remaining)`:"")),this.playbackDisabled||(s?e.event.assetList.forEach(e=>{const t=this.getAssetPlayer(e.identifier);t&&t.resumeBuffering()}):(this.hls.resumeBuffering(),this.playerQueue.forEach(e=>e.pauseBuffering()))),this.hls.trigger(u.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:r.slice(0),schedule:i.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}return t}bufferedToItem(e,t=0){const n=this.setBufferingItem(e);if(!this.playbackDisabled)if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(null!==n){this.bufferingAsset=null;const t=this.detachedData;if(t)if(t.mediaSource){const t=!0;this.attachPrimary(e.start,e,t)}else this.preloadPrimary(e);else this.preloadPrimary(e)}}preloadPrimary(e){const t=this.findItemIndex(e),n=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(n)}bufferedToEvent(e,t){const n=e.event,i=0===n.assetList.length&&!n.assetListLoader,r=n.cue.once;if(i||!r){const e=this.preloadAssets(n,t);if(null!=e&&e.interstitial.appendInPlace){const i=n.assetList[t],r=this.primaryMedia;i&&r&&this.bufferAssetPlayer(e,r)}}}preloadAssets(e,t){const n=e.assetUrl,i=e.assetList.length,r=0===i&&!e.assetListLoader,s=e.cue.once;if(r){const r=e.timelineStart;if(e.appendInPlace){var a;const t=this.playingItem;this.isInterstitial(t)||(null==t||null==(a=t.nextEvent)?void 0:a.identifier)!==e.identifier||this.flushFrontBuffer(r+.25)}let s,o=0;if(!this.playingItem&&this.primaryLive&&(o=this.hls.startPosition,-1===o&&(o=this.hls.liveSyncPosition||0)),o&&!e.cue.pre&&!e.cue.post){const e=o-r;e>0&&(s=Math.round(1e3*e)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${n?1:i} ${e}${s?` live-start: ${o} start-offset: ${s}`:""}`),n)return this.createAsset(e,0,0,r,e.duration,n);const u=this.assetListLoader.loadAssetList(e,s);u&&(e.assetListLoader=u)}else if(!s&&i){for(let n=t;n<i;n++){const t=e.assetList[n],i=this.getAssetPlayerQueueIndex(t.identifier);-1!==i&&!this.playerQueue[i].destroyed||t.error||this.createAssetPlayer(e,t,n)}return this.getAssetPlayer(e.assetList[t].identifier)}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`);const n=Object.keys(t);n.forEach(t=>{this.hls.trigger(u.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:t})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let n=0;n<t.length;n++)if(e===t[n].assetId)return n;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t)for(let n=0;n<e.length;n++)if(e[n].media===t)return e[n];return null}createAsset(e,t,n,i,r,s){const a={parentIdentifier:e.identifier,identifier:No(e,s,t),duration:r,startOffset:n,timelineStart:i,uri:s};return this.createAssetPlayer(e,a,t)}createAssetPlayer(e,t,n){const i=this.hls,r=i.userConfig;let s=r.videoPreference;const l=i.loadLevelObj||i.levels[i.currentLevel];(s||l)&&(s=p({},s),l.videoCodec&&(s.videoCodec=l.videoCodec),l.videoRange&&(s.allowedVideoRanges=[l.videoRange]));const c=i.audioTracks[i.audioTrack],d=i.subtitleTracks[i.subtitleTrack];let h=0;if(this.primaryLive||e.appendInPlace){const e=this.timelinePos-t.timelineStart;if(e>1){const n=t.duration;n&&e<n&&(h=e)}}const f=t.identifier,g=m(m({},r),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:i.sessionId,assetPlayerId:f,abrEwmaDefaultEstimate:i.bandwidthEstimate,interstitialsController:void 0,startPosition:h,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:s,audioPreference:c||r.audioPreference,subtitlePreference:d||r.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(g.timelineOffset=t.timelineStart));const v=g.cmcd;null!=v&&v.sessionId&&v.contentId&&(g.cmcd=p({},v,{contentId:Po(t.uri)})),this.getAssetPlayer(f)&&this.warn(`Duplicate date range identifier ${e} and asset ${f}`);const y=new Vo(this.HlsPlayerClass,g,e,t);this.playerQueue.push(y),e.assetList[n]=t;const b=i=>{if(i.live){const t=new Error(`Interstitials MUST be VOD assets ${e}`),i={fatal:!0,type:a.OTHER_ERROR,details:o.INTERSTITIAL_ASSET_ITEM_ERROR,error:t};return void this.handleAssetItemError(i,e,this.schedule.findEventIndex(e.identifier),n,t.message)}const r=i.edge-i.fragmentStart,s=t.duration;(null===s||r>s)&&(this.log(`Interstitial asset "${f}" duration change ${s} > ${r}`),t.duration=r,this.updateSchedule())};y.on(u.LEVEL_UPDATED,(e,{details:t})=>b(t)),y.on(u.LEVEL_PTS_UPDATED,(e,{details:t})=>b(t));const T=(e,t)=>{const n=this.getAssetPlayer(f);if(n&&t.tracks){n.off(u.BUFFER_CODECS,T),n.tracks=t.tracks;const e=this.primaryMedia;this.bufferingAsset===n.assetItem&&e&&!n.media&&this.bufferAssetPlayer(n,e)}};y.on(u.BUFFER_CODECS,T);const S=()=>{var n;const i=this.getAssetPlayer(f);if(this.log(`buffered to end of asset ${i}`),!i)return;const r=this.schedule.findEventIndex(e.identifier),s=null==(n=this.schedule.items)?void 0:n[r];if(this.isInterstitial(s)){const n=e.findAssetIndex(t),i=jo(e,n);if(e.isAssetPastPlayoutLimit(i)){var a;const e=null==(a=this.schedule.items)?void 0:a[r+1];e&&this.bufferedToItem(e)}else this.bufferedToItem(s,i)}};y.on(u.BUFFERED_TO_END,S);const E=t=>()=>{const n=this.getAssetPlayer(f);if(!n)return;this.shouldPlay=!0;const i=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,i,t)};return y.once(u.MEDIA_ENDED,E(n)),y.once(u.PLAYOUT_LIMIT_REACHED,E(1/0)),y.on(u.ERROR,(t,i)=>{const r=this.getAssetPlayer(f);if(i.details!==o.BUFFER_STALLED_ERROR)this.handleAssetItemError(i,e,this.schedule.findEventIndex(e.identifier),n,`Asset player error ${i.error} ${e}`);else if(null!=r&&r.media){const t=r.currentTime,n=r.duration-t;t&&e.appendInPlace&&n/r.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${f} ${e} at ${r.media.currentTime}`),S()):(this.warn(`Stalled at ${t} of ${t+n} in asset ${f} ${e}`),this.onTimeupdate(),this.checkBuffer(!0))}}),y.on(u.DESTROYING,()=>{const t=this.getAssetPlayer(f);if(!t)return;const i=new Error(`Asset player destroyed unexpectedly ${f}`),r={fatal:!0,type:a.OTHER_ERROR,details:o.INTERSTITIAL_ASSET_ITEM_ERROR,error:i};this.handleAssetItemError(r,e,this.schedule.findEventIndex(e.identifier),n,i.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${Go(t)}`),this.hls.trigger(u.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:n,event:e,player:y}),y}clearInterstitial(e,t){e.assetList.forEach(e=>{this.clearAssetPlayer(e.identifier,t)}),e.reset()}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(-1!==t){this.log(`reset asset player "${e}" after error`);const n=this.playerQueue[t];this.transferMediaFromPlayer(n,null),n.resetDetails()}}clearAssetPlayer(e,t){const n=this.getAssetPlayerQueueIndex(e);if(-1!==n){this.log(`clear asset player "${e}" toSegment: ${t?Wo(t):t}`);const i=this.playerQueue[n];this.transferMediaFromPlayer(i,t),this.playerQueue.splice(n,1),i.destroy()}}emptyPlayerQueue(){let e;while(e=this.playerQueue.pop())e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,n,i,r){const{interstitial:s,assetItem:a,assetId:o}=e,l=s.assetList.length,c=this.playingAsset;this.endedAsset=null,this.playingAsset=a,c&&c.identifier===o||(c&&(this.clearAssetPlayer(c.identifier,n[i]),delete c.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${l} ${Go(a)}`),this.hls.trigger(u.INTERSTITIAL_ASSET_STARTED,{asset:a,assetListIndex:t,event:s,schedule:n.slice(0),scheduleIndex:i,player:e})),this.bufferAssetPlayer(e,r)}bufferAssetPlayer(e,t){var n,i;const{interstitial:r,assetItem:s}=e,u=this.schedule.findEventIndex(r.identifier),l=null==(n=this.schedule.items)?void 0:n[u];if(!l)return;this.setBufferingItem(l),this.bufferingAsset=s;const c=this.getBufferingPlayer();if(c===e)return;const d=r.appendInPlace;if(d&&!1===(null==c?void 0:c.interstitial.appendInPlace))return;const h=(null==c?void 0:c.tracks)||(null==(i=this.detachedData)?void 0:i.tracks)||this.requiredTracks;if(d&&s!==this.playingAsset){if(!e.tracks)return;if(h&&!C(h,e.tracks)){const t=new Error(`Asset ${Go(s)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(h)}')`),n={fatal:!0,type:a.OTHER_ERROR,details:o.INTERSTITIAL_ASSET_ITEM_ERROR,error:t},i=r.findAssetIndex(s);return void this.handleAssetItemError(n,r,u,i,t.message)}}this.transferMediaTo(e,t)}handleAssetItemError(e,t,n,i,r){if(e.details===o.BUFFER_STALLED_ERROR)return;const s=t.assetList[i];this.warn(`INTERSTITIAL_ASSET_ERROR ${s?Go(s):s} ${e.error}`);const a=null==s?void 0:s.identifier,l=this.getAssetPlayerQueueIndex(a),c=this.playerQueue[l]||null,d=this.schedule.items,h=p({},e,{fatal:!1,errorAction:jt(!0),asset:s,assetListIndex:i,event:t,schedule:d,scheduleIndex:n,player:c});if(this.hls.trigger(u.INTERSTITIAL_ASSET_ERROR,h),!e.fatal)return;const f=this.playingAsset,g=new Error(r);if(s&&(this.clearAssetPlayer(a,null),s.error=g),t.assetList.some(e=>!e.error)){if(t.appendInPlace){for(let e=i;e<t.assetList.length;e++)this.resetAssetPlayer(t.assetList[e].identifier);this.updateSchedule()}}else t.error=g;t.error?this.primaryFallback(t):f&&f.identifier===a&&this.advanceAfterAssetEnded(t,n,i)}primaryFallback(e){const t=e.timelineStart,n=this.effectivePlayingItem;if(this.updateSchedule(),n){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${n?Wo(n):"<none>"} error: ${e.error}`);let i=this.timelinePos;-1===i&&(i=this.hls.startPosition);const r=this.updateItem(n,i);this.itemsMatch(n,r)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t));const s=this.schedule.findItemIndexAtTime(i);this.setSchedulePosition(s)}else this.checkStart()}onAssetListLoaded(e,t){var n;const i=t.event,r=i.identifier,s=t.assetListResponse.ASSETS;if(!this.schedule.hasEvent(r))return;const a=i.timelineStart,o=i.duration;let u=0;s.forEach((e,t)=>{const n=parseFloat(e.DURATION);this.createAsset(i,t,u,a+u,n,e.URI),u+=n}),i.duration=u,this.log(`Loaded asset-list with duration: ${u} (was: ${o}) ${i}`);const l=this.waitingItem,c=(null==l?void 0:l.event.identifier)===r;this.updateSchedule();const d=null==(n=this.bufferingItem)?void 0:n.event;if(c){var h;const e=this.schedule.findEventIndex(r),t=null==(h=this.schedule.items)?void 0:h[e];if(t){if(!this.playingItem&&this.timelinePos>t.end){const t=this.schedule.findItemIndexAtTime(this.timelinePos);if(t!==e)return i.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${i}`),void this.primaryFallback(i)}this.setBufferingItem(t)}this.setSchedulePosition(e)}else if((null==d?void 0:d.identifier)===r&&d.appendInPlace){const e=i.assetList[0],t=this.getAssetPlayer(e.identifier),n=this.primaryMedia;e&&t&&n&&this.bufferAssetPlayer(t,n)}}onError(e,t){switch(t.details){case o.ASSET_LIST_PARSING_ERROR:case o.ASSET_LIST_LOAD_ERROR:case o.ASSET_LIST_LOAD_TIMEOUT:{const e=t.interstitial;e&&this.primaryFallback(e);break}case o.BUFFER_STALLED_ERROR:this.onTimeupdate(),this.checkBuffer(!0);break}}}const Xo=500;class Qo extends Ni{constructor(e,t,n){super(e,t,n,"subtitle-stream-controller",c.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(u.LEVEL_LOADED,this.onLevelLoaded,this),e.on(u.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(u.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(u.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(u.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(u.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(u.LEVEL_LOADED,this.onLevelLoaded,this),e.off(u.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(u.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(u.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(u.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(u.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=Oi.IDLE,this.setInterval(Xo),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if($(n)&&(this.fragPrevious=n),this.state=Oi.IDLE,!i)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let s;const a=n.start;for(let u=0;u<r.length;u++)if(a>=r[u].start&&a<=r[u].end){s=r[u];break}const o=n.start+n.duration;s?s.end=o:(s={start:a,end:o},r.push(s)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(0===n&&i!==Number.POSITIVE_INFINITY){const e=i-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach(t=>{for(let n=0;n<t.length;)if(t[n].end<=e)t.shift();else{if(!(t[n].start<e))break;t[n].start=e,n++}}),this.fragmentTracker.removeFragmentsInRange(n,e,c.SUBTITLE)}}onError(e,t){const n=t.frag;(null==n?void 0:n.type)===c.SUBTITLE&&(t.details===o.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Oi.STOPPED&&(this.state=Oi.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){this.levels&&Xs(this.levels,t)?this.levels=t.map(e=>new rt(e)):(this.tracksBuffered=[],this.levels=t.map(e=>{const t=new rt(e);return this.tracksBuffered[t.id]=[],t}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,c.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,null==(n=this.levels)||!n.length||-1===this.currentTrackId)return void this.clearInterval();const i=this.levels[this.currentTrackId];null!=i&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.state!==Oi.STOPPED&&this.setInterval(Xo)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:i,levels:r}=this,{details:s,id:a}=t;if(!r)return void this.warn(`Subtitle tracks were reset while loading level ${a}`);const o=r[a];if(a>=r.length||!o)return;this.log(`Subtitle track ${a} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(s.live||null!=(n=o.details)&&n.live){const e=this.mainDetails;if(s.deltaUpdateFailed||!e)return;const t=e.fragments[0];var c;if(o.details)l=this.alignPlaylists(s,o.details,null==(c=this.levelLastLoaded)?void 0:c.details),0===l&&t&&(l=t.start,Si(s,l));else s.hasProgramDateTime&&e.hasProgramDateTime?(Pi(s,e),l=s.fragmentStart):t&&(l=t.start,Si(s,l))}if(o.details=s,this.levelLastLoaded=o,a===i&&(this.hls.trigger(u.SUBTITLE_TRACK_UPDATED,{details:s,id:a,groupId:t.groupId}),this.tick(),s.live&&!this.fragCurrent&&this.media&&this.state===Oi.IDLE)){const e=It(null,s.fragments,this.media.currentTime,0);e||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0)}}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&null!=i&&i.key&&i.iv&&In(i.method)){const e=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer,kn(i.method)).catch(e=>{throw r.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e}).then(n=>{const i=performance.now();r.trigger(u.FRAG_DECRYPTED,{frag:t,payload:n,stats:{tstart:e,tdecrypt:i}})}).catch(e=>{this.warn(`${e.name}: ${e.message}`),this.state=Oi.IDLE})}}doTick(){if(this.media){if(this.state===Oi.IDLE){const{currentTrackId:e,levels:t}=this,n=null==t?void 0:t[e];if(!n||!t.length||!n.details)return;if(this.waitForLive(n))return;const{config:i}=this,r=this.getLoadPosition(),s=dn.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,i.maxBufferHole),{end:a,len:o}=s,u=n.details,l=this.hls.maxBufferLength+u.levelTargetDuration;if(o>l)return;const c=u.fragments,d=c.length,h=u.edge;let f=null;const p=this.fragPrevious;if(a<h){const e=i.maxFragLookUpTolerance,t=a>h-e?0:e;f=It(p,c,Math.max(c[0].start,a),t),!f&&p&&p.start<c[0].start&&(f=c[0])}else f=c[d-1];if(f=this.filterReplacedPrimary(f,n.details),!f)return;const g=f.sn-u.startSN,m=c[g-1];if(m&&m.cc===f.cc&&this.fragmentTracker.getState(m)===$t.NOT_LOADED&&(f=m),this.fragmentTracker.getState(f)===$t.NOT_LOADED){const e=this.mapToInitFragWhenRequired(f);e&&this.loadFragment(e,n,a)}}}else this.state=Oi.IDLE}loadFragment(e,t,n){$(e)?super.loadFragment(e,t,n):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new Jo(this.tracksBuffered[this.currentTrackId]||[])}}class Jo{constructor(e){this.buffered=void 0;const t=(t,n,i)=>{if(n>>>=0,n>i-1)throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${i})`);return e[n][t]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}const Zo={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},eu=e=>String.fromCharCode(Zo[e]||e),tu=15,nu=100,iu={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},ru={17:2,18:4,21:6,22:8,23:10,19:13,20:15},su={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},au={25:2,26:4,29:6,30:8,31:10,27:13,28:15},ou=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class uu{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n="function"===typeof t?t():t;k.log(`${this.time} [${e}] ${n}`)}}}const lu=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class cu{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class du{constructor(){this.uchar=" ",this.penState=new cu}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class hu{constructor(e){this.chars=[],this.pos=0,this.currPenState=new cu,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<nu;t++)this.chars.push(new du);this.logger=e}equals(e){for(let t=0;t<nu;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<nu;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<nu;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>nu&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=nu)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=eu(e);this.pos>=nu?this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<nu;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<nu;n++){const i=this.chars[n].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e);const t=this.chars[this.pos];t.setPenState(this.currPenState)}}class fu{constructor(e){this.rows=[],this.currRow=tu-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<tu;t++)this.rows.push(new hu(e));this.logger=e}reset(){for(let e=0;e<tu;e++)this.rows[e].clear();this.currRow=tu-1}equals(e){let t=!0;for(let n=0;n<tu;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<tu;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<tu;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){const e=this.rows[this.currRow];e.backSpace()}clearToEndOfRow(){const e=this.rows[this.currRow];e.clearToEndOfRow()}insertChar(e){const t=this.rows[this.currRow];t.insertChar(e)}setPen(e){const t=this.rows[this.currRow];t.setPenStyles(e)}moveCursor(e){const t=this.rows[this.currRow];t.moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e);const t=this.rows[this.currRow];t.setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+lt(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let t=0;t<tu;t++)this.rows[t].clear();const e=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){const i=n.rows[e].cueStartTime,r=this.logger.time;if(null!==i&&null!==r&&i<r)for(let s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(n.rows[e+s])}}this.currRow=t;const n=this.rows[this.currRow];if(null!==e.indent){const t=e.indent,i=Math.max(t-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+lt(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let r=0;r<tu;r++){const n=this.rows[r].getTextString();n&&(i=r+1,e?t.push("Row "+i+": '"+n+"'"):t.push(n.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}getTextAndFormat(){return this.rows}}class pu{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new fu(n),this.nonDisplayedMemory=new fu(n),this.lastOutputScreen=new fu(n),this.currRollUpRow=this.displayedMemory.rows[tu-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[tu-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+lt(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class gu{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=yu(),this.logger=void 0;const i=this.logger=new uu;this.channels=[null,new pu(e,t,i),new pu(e+1,n,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const e=127&t[n],i=127&t[n+1];let r=!1,s=null;if(0===e&&0===i)continue;this.logger.log(3,()=>"["+lu([t[n],t[n+1]])+"] -> ("+lu([e,i])+")");const a=this.cmdHistory,o=e>=16&&e<=31;if(o){if(vu(e,i,a)){mu(null,null,a),this.logger.log(3,()=>"Repeated command ("+lu([e,i])+") is dropped");continue}mu(e,i,this.cmdHistory),r=this.parseCmd(e,i),r||(r=this.parseMidrow(e,i)),r||(r=this.parsePAC(e,i)),r||(r=this.parseBackgroundAttributes(e,i))}else mu(null,null,a);if(!r&&(s=this.parseChars(e,i),s)){const e=this.currentChannel;if(e&&e>0){const t=this.channels[e];t.insertChars(s)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}r||s||this.logger.log(2,()=>"Couldn't parse cleaned data "+lu([e,i])+" orig: "+lu([t[n],t[n+1]]))}}parseCmd(e,t){const n=(20===e||28===e||21===e||29===e)&&t>=32&&t<=47,i=(23===e||31===e)&&t>=33&&t<=35;if(!n&&!i)return!1;const r=20===e||21===e||23===e?1:2,s=this.channels[r];return 20===e||21===e||28===e||29===e?32===t?s.ccRCL():33===t?s.ccBS():34===t?s.ccAOF():35===t?s.ccAON():36===t?s.ccDER():37===t?s.ccRU(2):38===t?s.ccRU(3):39===t?s.ccRU(4):40===t?s.ccFON():41===t?s.ccRDC():42===t?s.ccTR():43===t?s.ccRTD():44===t?s.ccEDM():45===t?s.ccCR():46===t?s.ccENM():47===t&&s.ccEOC():s.ccTO(t-32),this.currentChannel=r,!0}parseMidrow(e,t){let n=0;if((17===e||25===e)&&t>=32&&t<=47){if(n=17===e?1:2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return!!i&&(i.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+lu([e,t])+")"),!0)}return!1}parsePAC(e,t){let n;const i=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,r=(16===e||24===e)&&t>=64&&t<=95;if(!i&&!r)return!1;const s=e<=23?1:2;n=t>=64&&t<=95?1===s?iu[e]:su[e]:1===s?ru[e]:au[e];const a=this.channels[s];return!!a&&(a.setPAC(this.interpretPAC(n,t)),this.currentChannel=s,!0)}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,i.underline=1===(1&n),n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((n-16)/2),i}parseChars(e,t){let n,i=null,r=null;if(e>=25?(n=2,r=e-8):(n=1,r=e),r>=17&&r<=19){let e;e=17===r?t+80:18===r?t+112:t+144,this.logger.log(2,()=>"Special char '"+eu(e)+"' in channel "+n),i=[e]}else e>=32&&e<=127&&(i=0===t?[e]:[e,t]);return i&&this.logger.log(3,()=>"Char codes =  "+lu(i).join(",")),i}parseBackgroundAttributes(e,t){const n=(16===e||24===e)&&t>=32&&t<=47,i=(23===e||31===e)&&t>=45&&t<=47;if(!n&&!i)return!1;let r;const s={};16===e||24===e?(r=Math.floor((t-32)/2),s.background=ou[r],t%2===1&&(s.background=s.background+"_semi")):45===t?s.background="transparent":(s.foreground="black",47===t&&(s.underline=!0));const a=e<=23?1:2,o=this.channels[a];return o.setBkgData(s),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}mu(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function mu(e,t,n){n.a=e,n.b=t}function vu(e,t,n){return n.a===e&&n.b===t}function yu(){return{a:null,b:null}}var bu=function(){if(null!=Pn&&Pn.VTTCue)return self.VTTCue;const e=["","lr","rl"],t=["start","middle","end","left","right"];function n(e,t){if("string"!==typeof t)return!1;if(!Array.isArray(e))return!1;const n=t.toLowerCase();return!!~e.indexOf(n)&&n}function i(t){return n(e,t)}function r(e){return n(t,e)}function s(e,...t){let n=1;for(;n<arguments.length;n++){const t=arguments[n];for(const n in t)e[n]=t[n]}return e}function a(e,t,n){const a=this,o={enumerable:!0};a.hasBeenReset=!1;let u="",l=!1,c=e,d=t,h=n,f=null,p="",g=!0,m="auto",v="start",y=50,b="middle",T=50,S="middle";Object.defineProperty(a,"id",s({},o,{get:function(){return u},set:function(e){u=""+e}})),Object.defineProperty(a,"pauseOnExit",s({},o,{get:function(){return l},set:function(e){l=!!e}})),Object.defineProperty(a,"startTime",s({},o,{get:function(){return c},set:function(e){if("number"!==typeof e)throw new TypeError("Start time must be set to a number.");c=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"endTime",s({},o,{get:function(){return d},set:function(e){if("number"!==typeof e)throw new TypeError("End time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"text",s({},o,{get:function(){return h},set:function(e){h=""+e,this.hasBeenReset=!0}})),Object.defineProperty(a,"region",s({},o,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"vertical",s({},o,{get:function(){return p},set:function(e){const t=i(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");p=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"snapToLines",s({},o,{get:function(){return g},set:function(e){g=!!e,this.hasBeenReset=!0}})),Object.defineProperty(a,"line",s({},o,{get:function(){return m},set:function(e){if("number"!==typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"lineAlign",s({},o,{get:function(){return v},set:function(e){const t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"position",s({},o,{get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"positionAlign",s({},o,{get:function(){return b},set:function(e){const t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"size",s({},o,{get:function(){return T},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");T=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"align",s({},o,{get:function(){return S},set:function(e){const t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");S=t,this.hasBeenReset=!0}})),a.displayState=void 0}return a.prototype.getCueAsHTML=function(){const e=self.WebVTT;return e.convertCueToDOMTree(self,this.text)},a}();class Tu{decode(e,t){if(!e)return"";if("string"!==typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function Su(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+parseFloat(i||0)}const n=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}class Eu{constructor(){this.values=Object.create(null)}set(e,t){this.get(e)||""===t||(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function wu(e,t,n,i){const r=i?e.split(i):[e];for(const s in r){if("string"!==typeof r[s])continue;const e=r[s].split(n);if(2!==e.length)continue;const i=e[0],a=e[1];t(i,a)}}const Au=new bu(0,0,""),xu="middle"===Au.align?"middle":"center";function Iu(e,t,n){const i=e;function r(){const t=Su(e);if(null===t)throw new Error("Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function s(e,t){const i=new Eu;wu(e,function(e,t){let r;switch(e){case"region":for(let r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":r=t.split(","),i.integer(e,r[0]),i.percent(e,r[0])&&i.set("snapToLines",!1),i.alt(e,r[0],["auto"]),2===r.length&&i.alt("lineAlign",r[1],["start",xu,"end"]);break;case"position":r=t.split(","),i.percent(e,r[0]),2===r.length&&i.alt("positionAlign",r[1],["start",xu,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",xu,"end","left","right"]);break}},/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");let r=i.get("line","auto");"auto"===r&&-1===Au.line&&(r=-1),t.line=r,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",xu);let s=i.get("position","auto");"auto"===s&&50===Au.position&&(s="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=s}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=r(),a(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.slice(3),a(),t.endTime=r(),a(),s(e,t)}function ku(e){return e.replace(/<br(?: \/)?>/gi,"\n")}class Lu{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Tu,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;function n(){let e=t.buffer,n=0;e=ku(e);while(n<e.length&&"\r"!==e[n]&&"\n"!==e[n])++n;const i=e.slice(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.slice(n),i}function i(e){wu(e,function(e,t){},/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let e="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;e=n();const i=e.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(null==i||!i[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let s=!1;while(t.buffer){if(!/\r\n|\n/.test(t.buffer))return this;switch(s?s=!1:e=n(),t.state){case"HEADER":/:/.test(e)?i(e):e||(t.state="ID");continue;case"NOTE":e||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){t.state="NOTE";break}if(!e)continue;if(t.cue=new bu(0,0,""),t.state="CUE",-1===e.indexOf("--\x3e")){t.cue.id=e;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{Iu(e,t.cue,t.regionList)}catch(r){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const n=-1!==e.indexOf("--\x3e");if(!e||n&&(s=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=e}continue;case"BADCUE":e||(t.state="ID")}}}catch(r){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const Ru=/\r\n|\n\r|\n|\r/g,Cu=function(e,t,n=0){return e.slice(n,n+t.length)===t},Du=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!i(t)||!i(n)||!i(r)||!i(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=6e4*r,t+=36e5*s,t};function Mu(e,t,n){return Po(e.toString())+Po(t.toString())+Po(n)}const Pu=function(e,t,n){let i=e[t],r=e[i.prevCC];if(!r||!r.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,void(i.new=!1);while(null!=(s=r)&&s.new){var s;e.ccOffset+=i.start-r.start,i.new=!1,i=r,r=e[i.prevCC]}e.presentationOffset=n};function _u(e,t,n,i,r,s,a){const o=new Lu,u=D(new Uint8Array(e)).trim().replace(Ru,"\n").split("\n"),l=[],c=t?Ts(t.baseTime,t.timescale):0;let d,h="00:00.000",f=0,p=0,g=!0;o.oncue=function(e){const s=n[i];let a=n.ccOffset;const o=(f-c)/9e4;if(null!=s&&s.new&&(void 0!==p?a=n.ccOffset=s.start:Pu(n,i,o)),o){if(!t)return void(d=new Error("Missing initPTS for VTT MPEGTS"));a=o-n.presentationOffset}const u=e.endTime-e.startTime,h=Cs(9e4*(e.startTime+a-p),9e4*r)/9e4;e.startTime=Math.max(h,0),e.endTime=Math.max(h+u,0);const g=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(g)),e.id||(e.id=Mu(e.startTime,e.endTime,g)),e.endTime>0&&l.push(e)},o.onparsingerror=function(e){d=e},o.onflush=function(){d?a(d):s(l)},u.forEach(e=>{if(g){if(Cu(e,"X-TIMESTAMP-MAP=")){g=!1,e.slice(16).split(",").forEach(e=>{Cu(e,"LOCAL:")?h=e.slice(6):Cu(e,"MPEGTS:")&&(f=parseInt(e.slice(7)))});try{p=Du(h)/1e3}catch(t){d=t}return}""===e&&(g=!1)}o.parse(e+"\n")}),o.flush()}const Ou="stpp.ttml.im1t",Nu=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Uu=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Fu={left:"start",center:"center",right:"end",start:"start",end:"end"};function Bu(e,t,n,i){const r=ne(new Uint8Array(e),["mdat"]);if(0===r.length)return void i(new Error("Could not parse IMSC1 mdat"));const s=r.map(e=>D(e)),a=ys(t.baseTime,1,t.timescale);try{s.forEach(e=>n(ju(e,a)))}catch(o){i(o)}}function ju(e,t){const n=new DOMParser,i=n.parseFromString(e,"text/xml"),r=i.getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(s).reduce((e,t)=>(e[t]=r.getAttribute(`ttp:${t}`)||s[t],e),{}),o="preserve"!==r.getAttribute("xml:space"),u=Gu($u(r,"styling","style")),l=Gu($u(r,"layout","region")),c=$u(r,"body","[begin]");return[].map.call(c,e=>{const n=Vu(e,o);if(!n||!e.hasAttribute("begin"))return null;const i=qu(e.getAttribute("begin"),a),r=qu(e.getAttribute("dur"),a);let s=qu(e.getAttribute("end"),a);if(null===i)throw Wu(e);if(null===s){if(null===r)throw Wu(e);s=i+r}const c=new bu(i-t,s-t,n);c.id=Mu(c.startTime,c.endTime,c.text);const d=l[e.getAttribute("region")],h=u[e.getAttribute("style")],f=Hu(d,h,u),{textAlign:g}=f;if(g){const e=Fu[g];e&&(c.lineAlign=e),c.align=g}return p(c,f),c}).filter(e=>null!==e)}function $u(e,t,n){const i=e.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(n)):[]}function Gu(e){return e.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function Vu(e,t){return[].slice.call(e.childNodes).reduce((e,n,i)=>{var r;return"br"===n.nodeName&&i?e+"\n":null!=(r=n.childNodes)&&r.length?Vu(n,t):t?e+n.textContent.trim().replace(/\s+/g," "):e+n.textContent},"")}function Hu(e,t,n){const i="http://www.w3.org/ns/ttml#styling";let r=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return a&&n.hasOwnProperty(a)&&(r=n[a]),s.reduce((n,s)=>{const a=Ku(t,i,s)||Ku(e,i,s)||Ku(r,i,s);return a&&(n[s]=a),n},{})}function Ku(e,t,n){return e&&e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function Wu(e){return new Error(`Could not parse ttml timestamp ${e}`)}function qu(e,t){if(!e)return null;let n=Su(e);return null===n&&(Nu.test(e)?n=Yu(e,t):Uu.test(e)&&(n=zu(e,t))),n}function Yu(e,t){const n=Nu.exec(e),i=(0|n[4])+(0|n[5])/t.subFrameRate;return 3600*(0|n[1])+60*(0|n[2])+(0|n[3])+i/t.frameRate}function zu(e,t){const n=Uu.exec(e),i=Number(n[1]),r=n[2];switch(r){case"h":return 3600*i;case"m":return 60*i;case"ms":return 1e3*i;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}class Xu{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class Qu{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=tl(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(u.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(u.FRAG_LOADING,this.onFragLoading,this),e.on(u.FRAG_LOADED,this.onFragLoaded,this),e.on(u.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(u.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(u.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(u.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(u.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(u.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(u.FRAG_LOADING,this.onFragLoading,this),e.off(u.FRAG_LOADED,this.onFragLoaded,this),e.off(u.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(u.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(u.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(u.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(u.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Xu(this,"textTrack1"),t=new Xu(this,"textTrack2"),n=new Xu(this,"textTrack3"),i=new Xu(this,"textTrack4");this.cea608Parser1=new gu(1,e,t),this.cea608Parser2=new gu(3,n,i)}addCues(e,t,n,i,r){let s=!1;for(let a=r.length;a--;){const e=r[a],i=el(e[0],e[1],t,n);if(i>=0&&(e[0]=Math.min(e[0],t),e[1]=Math.max(e[1],n),s=!0,i/(n-t)>.5))return}if(s||r.push([t,n]),this.config.renderTextTracksNatively){const r=this.captionsTracks[e];this.Cues.newCue(r,t,n,i)}else{const r=this.Cues.newCue(null,t,n,i);this.hls.trigger(u.CUES_PARSED,{type:"captions",cues:r,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r}){const{unparsedVttFrags:s}=this;n===c.MAIN&&(this.initPTS[t.cc]={baseTime:i,timescale:r}),s.length&&(this.unparsedVttFrags=[],s.forEach(e=>{this.onFragLoaded(u.FRAG_LOADED,e)}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const r=n.textTracks[i];if(Zu(r,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:r,languageCode:s}=t[e],a=this.getExistingTrack(r,s);if(a)n[e]=a,Io(n[e]),Ao(n[e],i);else{const t=this.createTextTrack("captions",r,s);t&&(t[e]=!0,n[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,i={_id:e,label:n,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(u.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,n){const i=this.media;if(i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const n=!!t.transferMedia;if(this.media=null,n)return;const{captionsTracks:i}=this;Object.keys(i).forEach(e=>{Io(i[e]),delete i[e]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=tl(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Io(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some(e=>e.textCodec===Ou);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){const e=Xs(this.tracks,n);if(e)return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const e=this.media,t=e?Co(e.textTracks):null;if(this.tracks.forEach((e,n)=>{let i;if(t){let n=null;for(let i=0;i<t.length;i++)if(t[i]&&Zu(t[i],e)){n=t[i],t[i]=null;break}n&&(i=n)}if(i)Io(i);else{const t=Ju(e);i=this.createTextTrack(t,e.name,e.lang),i&&(i.mode="disabled")}i&&this.textTracks.push(i)}),null!=t&&t.length){const e=t.filter(e=>null!==e).map(e=>e.label);e.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${e.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const e=this.tracks.map(e=>({label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}));this.hls.trigger(u.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(e=>{const t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;const n=`textTrack${t[1]}`,i=this.captionsProperties[n];i&&(i.label=e.name,e.lang&&(i.languageCode=e.lang),i.media=e)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===c.MAIN){var n,i;const{cea608Parser1:e,cea608Parser2:r,lastSn:s}=this,{cc:a,sn:o}=t.frag,u=null!=(n=null==(i=t.part)?void 0:i.index)?n:-1;e&&r&&(o!==s+1||o===s&&u!==this.lastPartIndex+1||a!==this.lastCc)&&(e.reset(),r.reset()),this.lastCc=a,this.lastSn=o,this.lastPartIndex=u}}onFragLoaded(e,t){const{frag:n,payload:i}=t;if(n.type===c.SUBTITLE)if(i.byteLength){const e=n.decryptdata,r="stats"in t;if(null==e||!e.encrypted||r){const e=this.tracks[n.level],r=this.vttCCs;r[n.cc]||(r[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),e&&e.textCodec===Ou?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;Bu(t,this.initPTS[e.cc],t=>{this._appendCues(t,e.level),n.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},t=>{n.logger.log(`Failed to parse IMSC1: ${t}`),n.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})})}_parseVTTs(e){var t;const{frag:n,payload:i}=e,{initPTS:r,unparsedVttFrags:s}=this,a=r.length-1;if(!r[n.cc]&&-1===a)return void s.push(e);const o=this.hls,l=null!=(t=n.initSegment)&&t.data?me(n.initSegment.data,new Uint8Array(i)).buffer:i;_u(l,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,e=>{this._appendCues(e,n.level),o.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},t=>{const r="Missing initPTS for VTT MPEGTS"===t.message;r?s.push(e):this._fallbackToIMSC1(n,i),o.logger.log(`Failed to parse VTT cue: ${t}`),r&&a>n.cc||o.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||Bu(t,this.initPTS[e.cc],()=>{n.textCodec=Ou,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||"disabled"===n.mode)return;e.forEach(e=>xo(n,e))}else{const i=this.tracks[t];if(!i)return;const r=i.default?"default":"subtitles"+t;n.trigger(u.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===c.SUBTITLE&&this.onFragLoaded(u.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:n,samples:i}=t;if(n.type!==c.MAIN||"NONE"!==this.closedCaptionsForLevel(n))for(let r=0;r<i.length;r++){const e=i[r].bytes;if(e){this.cea608Parser1||this.initCea608Parsers();const t=this.extractCea608Data(e);this.cea608Parser1.addData(i[r].pts,t[0]),this.cea608Parser2.addData(i[r].pts,t[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:r}){const{media:s}=this;if(s&&!(s.currentTime<n)){if(!r||"video"===r){const{captionsTracks:e}=this;Object.keys(e).forEach(i=>ko(e[i],t,n))}if(this.config.renderTextTracksNatively&&0===t&&void 0!==i){const{textTracks:e}=this;Object.keys(e).forEach(n=>ko(e[n],t,i))}}}extractCea608Data(e){const t=[[],[]],n=31&e[0];let i=2;for(let r=0;r<n;r++){const n=e[i++],r=127&e[i++],s=127&e[i++];if(0===r&&0===s)continue;const a=0!==(4&n);if(a){const e=3&n;0!==e&&1!==e||(t[e].push(r),t[e].push(s))}}return t}}function Ju(e){return e.characteristics&&/transcribes-spoken-dialog/gi.test(e.characteristics)&&/describes-music-and-sound/gi.test(e.characteristics)?"captions":"subtitles"}function Zu(e,t){return!!e&&e.kind===Ju(t)&&Js(t,e)}function el(e,t,n,i){return Math.min(t,i)-Math.max(e,n)}function tl(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const nl=/\s/,il={newCue(e,t,n,i){const r=[];let s,a,o,u,l;const c=self.VTTCue||self.TextTrackCue;for(let h=0;h<i.rows.length;h++)if(s=i.rows[h],o=!0,u=0,l="",!s.isEmpty()){var d;for(let e=0;e<s.chars.length;e++)nl.test(s.chars[e].uchar)&&o?u++:(l+=s.chars[e].uchar,o=!1);s.cueStartTime=t,t===n&&(n+=1e-4),u>=16?u--:u++;const i=ku(l.trim()),f=Mu(t,n,i);null!=e&&null!=(d=e.cues)&&d.getCueById(f)||(a=new c(t,n,i),a.id=f,a.line=h+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*u/32)),r.push(a))}return e&&r.length&&(r.sort((e,t)=>"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line),r.forEach(t=>xo(e,t))),r}};function rl(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}const sl=/(\d+)-(\d+)\/(\d+)/;class al{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||cl,this.controller=new self.AbortController,this.stats=new F}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const s=ol(e,this.controller.signal),a="arraybuffer"===e.responseType,o=a?"byteLength":"length",{maxTimeToFirstByteMs:u,maxLoadTimeMs:l}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=u&&i(u)?u:l,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},t.timeout);const c=Gs(this.request)?this.request.then(self.fetch):self.fetch(this.request);c.then(n=>{var s;this.response=this.loader=n;const o=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=l,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},l-(o-r.loading.start)),!n.ok){const{status:e,statusText:t}=n;throw new dl(t||"fetch, bad network response",e,n)}r.loading.first=o,r.total=ll(n.headers)||r.total;const u=null==(s=this.callbacks)?void 0:s.onProgress;return u&&i(t.highWaterMark)?this.loadProgressively(n,r,e,t.highWaterMark,u):a?n.arrayBuffer():"json"===e.responseType?n.json():n.text()}).then(n=>{var s,a;const u=this.response;if(!u)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const l=n[o];l&&(r.loaded=r.total=l);const c={url:u.url,data:n,code:u.status},d=null==(s=this.callbacks)?void 0:s.onProgress;d&&!i(t.highWaterMark)&&d(r,e,n,u),null==(a=this.callbacks)||a.onSuccess(c,r,e,u)}).catch(t=>{var n;if(self.clearTimeout(this.requestTimeout),r.aborted)return;const i=t&&t.code||0,s=t?t.message:null;null==(n=this.callbacks)||n.onError({code:i,text:s},e,t?t.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,r){const s=new Fi,a=e.body.getReader(),o=()=>a.read().then(a=>{if(a.done)return s.dataLength&&r(t,n,s.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const u=a.value,l=u.length;return t.loaded+=l,l<i||s.dataLength?(s.push(u),s.dataLength>=i&&r(t,n,s.flush().buffer,e)):r(t,n,u.buffer,e),o()}).catch(()=>Promise.reject());return o()}}function ol(e,t){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(p({},e.headers))};return e.rangeEnd&&n.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),n}function ul(e){const t=sl.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}function ll(e){const t=e.get("Content-Range");if(t){const e=ul(t);if(i(e))return e}const n=e.get("Content-Length");if(n)return parseInt(n)}function cl(e,t){return new self.Request(e.url,t)}class dl extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const hl=/^age:\s*[\d.]+\s*$/im;class fl{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new F,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then(()=>{if(this.loader===n&&!this.stats.aborted)return r(n,t.url)}).catch(e=>{if(this.loader===n&&!this.stats.aborted)return n.open("GET",t.url,!0),r(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(e=>{var r;null==(r=this.callbacks)||r.onError({code:n.status,text:e.message},t,n,i)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const r=t.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:a}=n.loadPolicy;if(r)for(const i in r)e.setRequestHeader(i,r[i]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=s&&i(s)?s:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,r=this.config;if(!n.aborted&&i>=2&&(0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),4===i)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const i=t.status,u="text"===t.responseType?t.responseText:null;if(i>=200&&i<300){const r=null!=u?u:t.response;if(null!=r){var s,a;n.loading.end=Math.max(self.performance.now(),n.loading.first);const o="arraybuffer"===t.responseType?r.byteLength:r.length;n.loaded=n.total=o,n.bwEstimate=8e3*n.total/(n.loading.end-n.loading.first);const u=null==(s=this.callbacks)?void 0:s.onProgress;u&&u(n,e,r,t);const l={url:t.responseURL,data:r,code:i};return void(null==(a=this.callbacks)||a.onSuccess(l,n,e,t))}}const l=r.loadPolicy.errorRetry,c=n.retry,d={url:e.url,data:void 0,code:i};var o;if(Ot(l,c,!1,d))this.retry(l);else k.error(`${i} while loading ${e.url}`),null==(o=this.callbacks)||o.onError({code:i,text:t.statusText},e,t,n)}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(Ot(e,t,!0))this.retry(e);else{var n;k.warn(`timeout while loading ${null==(n=this.context)?void 0:n.url}`);const e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Pt(e,n.retry),n.retry++,k.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${null==t?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&hl.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const pl={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},gl=m(m({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:fl,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:wt,bufferController:ra,capLevelController:ua,errorController:Bt,fpsController:wo,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:$n,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:pl},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},ml()),{},{subtitleStreamController:Qo,subtitleTrackController:Do,timelineController:Qu,audioStreamController:Ys,audioTrackController:Zs,emeController:So,cmcdController:po,contentSteeringController:mo,interstitialsController:zo});function ml(){return{cueHandler:il,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function vl(e,t,n){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=yl(e),r=["manifest","level","frag"],s=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return r.forEach(e=>{const r=`${"level"===e?"playlist":e}LoadPolicy`,a=void 0===t[r],o=[];s.forEach(n=>{const s=`${e}Loading${n}`,u=t[s];if(void 0!==u&&a){o.push(s);const e=i[r].default;switch(t[r]={default:e},n){case"TimeOut":e.maxLoadTimeMs=u,e.maxTimeToFirstByteMs=u;break;case"MaxRetry":e.errorRetry.maxNumRetry=u,e.timeoutRetry.maxNumRetry=u;break;case"RetryDelay":e.errorRetry.retryDelayMs=u,e.timeoutRetry.retryDelayMs=u;break;case"MaxRetryTimeout":e.errorRetry.maxRetryDelayMs=u,e.timeoutRetry.maxRetryDelayMs=u;break}}}),o.length&&n.warn(`hls.js config: "${o.join('", "')}" setting(s) are deprecated, use "${r}": ${lt(t[r])}`)}),m(m({},i),t)}function yl(e){return e&&"object"===typeof e?Array.isArray(e)?e.map(yl):Object.keys(e).reduce((t,n)=>(t[n]=yl(e[n]),t),{}):e}function bl(e,t){const n=e.loader;if(n!==al&&n!==fl)t.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1;else{const n=rl();n&&(e.loader=al,e.progressive=!0,e.enableSoftwareAES=!0,t.log("[config]: Progressive streaming enabled, using FetchLoader"))}}const Tl=2,Sl=.1,El=.05,wl=100;class Al extends on{constructor(e,t){super("gap-controller",e.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var e;null!=(e=this.media)&&e.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{var e;this.hls&&(this.ended=(null==(e=this.media)?void 0:e.currentTime)||1,this.hls.trigger(u.MEDIA_ENDED,{stalled:!1}))},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(wl),this.mediaSource=t.mediaSource;const n=this.media=t.media;bo(n,"playing",this.onMediaPlaying),bo(n,"waiting",this.onMediaWaiting),bo(n,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:n}=this;n&&(To(n,"playing",this.onMediaPlaying),To(n,"waiting",this.onMediaWaiting),To(n,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(null==(e=this.media)||!e.readyState||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var n,i;const r=null==(n=this.hls)?void 0:n.config;if(!r)return;const s=this.media;if(!s)return;const{seeking:a}=s,o=this.seeking&&!a,l=!this.seeking&&a,c=s.paused&&!a||s.ended||0===s.playbackRate;if(this.seeking=a,e!==t)return t&&(this.ended=0),this.moved=!0,a||(this.nudgeRetry=0,r.nudgeOnVideoHole&&!c&&e>t&&this.nudgeOnVideoHole(e,t)),void(0===this.waiting&&this.stallResolved(e));if(l||o)return void(o&&this.stallResolved(e));if(c)return this.nudgeRetry=0,this.stallResolved(e),void(!this.ended&&s.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(u.MEDIA_ENDED,{stalled:!1})));if(!dn.getBuffered(s).length)return void(this.nudgeRetry=0);const d=dn.bufferInfo(s,e,0),h=d.nextStart||0,f=this.fragmentTracker;if(a&&f&&this.hls){const t=xl(this.hls.inFlightFragments,e),n=d.len>Tl,i=!h||t||h-e>Tl&&!f.getPartialFragment(e);if(n||i)return;this.moved=!1}const p=null==(i=this.hls)?void 0:i.latestLevelDetails;if(!this.moved&&null!==this.stalled&&f){const t=d.len>0;if(!t&&!h)return;const n=Math.max(h,d.start||0)-e,i=!(null==p||!p.live),r=i?2*p.targetduration:Tl,a=f.getPartialFragment(e);if(n>0&&(n<=r||a))return void(s.paused||this._trySkipBufferHole(a))}const g=r.detectStallWithCurrentTimeMs,m=self.performance.now(),v=this.waiting;let y=this.stalled;if(null===y){if(!(v>0&&m-v<g))return void(this.stalled=m);y=this.stalled=v}const b=m-y;if(!a&&(b>=g||v)&&this.hls){var T;if("ended"===(null==(T=this.mediaSource)?void 0:T.readyState)&&(null==p||!p.live)&&Math.abs(e-((null==p?void 0:p.edge)||0))<1){if(this.ended)return;return this.ended=e||1,void this.hls.trigger(u.MEDIA_ENDED,{stalled:!0})}if(this._reportStall(d),!this.media||!this.hls)return}const S=dn.bufferInfo(s,e,r.maxBufferHole);this._tryFixBufferStall(S,b,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const n=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(n)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(u.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var n;const i=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&null!=(n=this.buffered.audio)&&n.length&&i&&i.length>1&&e>i.end(0)){const n=dn.bufferedInfo(dn.timeRangesToArray(this.buffered.audio),e,0);if(n.len>1&&t>=n.start){const n=dn.timeRangesToArray(i),r=dn.bufferedInfo(n,t,0).bufferedIndex;if(r>-1&&r<n.length-1){const t=dn.bufferedInfo(n,e,0).bufferedIndex,i=n[r].end,s=n[r+1].start;if((-1===t||t>r)&&s-i<1&&e-i<2){const n=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${i} -> ${s} buffered index: ${t}`);this.warn(n.message),this.media.currentTime+=1e-6;const r=this.fragmentTracker.getPartialFragment(e)||void 0,l=dn.bufferInfo(this.media,e,0);this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:n,reason:n.message,frag:r,buffer:l.len,bufferInfo:l})}}}}}_tryFixBufferStall(e,t,n){var i,r;const{fragmentTracker:s,media:a}=this,o=null==(i=this.hls)?void 0:i.config;if(!a||!s||!o)return;const u=null==(r=this.hls)?void 0:r.latestLevelDetails,l=s.getPartialFragment(n);if(l||null!=u&&u.live&&n<u.fragmentStart){const e=this._trySkipBufferHole(l);if(e||!this.media)return}const c=e.buffered,d=this.adjacentTraversal(e,n);(c&&c.length>1&&e.len>o.maxBufferHole||e.nextStart&&(e.nextStart-n<o.maxBufferHole||d))&&(t>1e3*o.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const n=this.fragmentTracker,i=e.nextStart;if(n&&i){const e=n.getFragAtPos(t,c.MAIN),r=n.getFragAtPos(i,c.MAIN);if(e&&r)return r.sn-e.sn<2}return!1}_reportStall(e){const{hls:t,media:n,stallReported:i,stalled:r}=this;if(!i&&null!==r&&n&&t){this.stallReported=!0;const i=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${lt(e)})`);this.warn(i.message),t.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_STALLED_ERROR,fatal:!1,error:i,buffer:e.len,bufferInfo:e,stalled:{start:r}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:n,media:i}=this,r=null==(t=this.hls)?void 0:t.config;if(!i||!n||!r)return 0;const s=i.currentTime,l=dn.bufferInfo(i,s,0),d=s<l.start?l.start:l.nextStart;if(d&&this.hls){const t=l.len<=r.maxBufferHole,f=l.len>0&&l.len<1&&i.readyState<3,p=d-s;if(p>0&&(t||f)){if(p>r.maxBufferHole){let t=!1;if(0===s){const e=n.getAppendedFrag(0,c.MAIN);e&&d<e.end&&(t=!0)}if(!t){const t=e||n.getAppendedFrag(s,c.MAIN);if(t){var h;if(null==(h=this.hls.loadLevelObj)||!h.details)return 0;const e=xl(this.hls.inFlightFragments,d);if(e)return 0;let i=!1,r=t.end;while(r<d){const e=n.getPartialFragment(r);if(!e){i=!0;break}r+=e.duration}if(i)return 0}}}const t=Math.max(d+El,s+Sl);if(this.warn(`skipping hole, adjusting currentTime from ${s} to ${t}`),this.moved=!0,i.currentTime=t,null==e||!e.gap){const n=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${t}`);this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:n,reason:n.message,frag:e||void 0,buffer:l.len,bufferInfo:l})}return t}}return 0}_tryNudgeBuffer(e){const{hls:t,media:n,nudgeRetry:i}=this,r=null==t?void 0:t.config;if(!n||!r)return 0;const s=n.currentTime;if(this.nudgeRetry++,i<r.nudgeMaxRetry){const l=s+(i+1)*r.nudgeOffset,c=new Error(`Nudging 'currentTime' from ${s} to ${l}`);this.warn(c.message),n.currentTime=l,t.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_NUDGE_ON_STALL,error:c,fatal:!1,buffer:e.len,bufferInfo:e})}else{const n=new Error(`Playhead still not moving while enough data buffered @${s} after ${r.nudgeMaxRetry} nudges`);this.error(n.message),t.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_STALLED_ERROR,error:n,fatal:!0,buffer:e.len,bufferInfo:e})}}}function xl(e,t){const n=Il(e.main);if(n&&n.start<=t)return n;const i=Il(e.audio);return i&&i.start<=t?i:null}function Il(e){if(!e)return null;switch(e.state){case Oi.IDLE:case Oi.STOPPED:case Oi.ENDED:case Oi.ERROR:return null}return e.frag}const kl=.25;function Ll(){if("undefined"!==typeof self)return self.VTTCue||self.TextTrackCue}function Rl(e,t,n,i,r){let s=new e(t,n,"");try{s.value=i,r&&(s.type=r)}catch(a){s=new e(t,n,lt(r?m({type:r},i):i))}return s}const Cl=(()=>{const e=Ll();try{e&&new e(0,Number.POSITIVE_INFINITY,"")}catch(t){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Dl(e){return Uint8Array.from(e.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class Ml{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(u.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(u.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(u.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(u.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(u.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(e,t){var n;this.media=t.media,!1===(null==(n=t.overrides)?void 0:n.cueRemoval)&&(this.removeCues=!1)}onMediaAttached(){const e=this.hls.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(e,t){this.media=null;const n=!!t.transferMedia;n||(this.id3Track&&(this.removeCues&&Io(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if("metadata"===n.kind&&"id3"===n.label)return Ao(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const s=Ll();if(s)for(let a=0;a<r.length;a++){const e=r[a].type;if(e===Dr.emsg&&!n||!i)continue;const t=kr(r[a].data);if(t){const n=r[a].pts;let i=n+r[a].duration;i>Cl&&(i=Cl);const o=i-n;o<=0&&(i=n+kl);for(let r=0;r<t.length;r++){const a=t[r];if(!Lr(a)){this.updateId3CueEnds(n,e);const t=Rl(s,n,i,a,e);t&&this.id3Track.addCue(t)}}}}}updateId3CueEnds(e,t){var n;const i=null==(n=this.id3Track)?void 0:n.cues;if(i)for(let r=i.length;r--;){const n=i[r];n.type===t&&n.startTime<e&&n.endTime===Cl&&(n.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){const{id3Track:r,hls:s}=this;if(!s)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:o}}=s;if(r&&(a||o)){let e;e="audio"===i?e=>e.type===Dr.audioId3&&o:"video"===i?e=>e.type===Dr.emsg&&a:e=>e.type===Dr.audioId3&&o||e.type===Dr.emsg&&a,ko(r,t,n,e)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.media||!e.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{id3Track:n}=this,{dateRanges:r}=e,s=Object.keys(r);let a=this.dateRangeCuesAppended;var o;if(n&&t)if(null!=(o=n.cues)&&o.length){const e=Object.keys(a).filter(e=>!s.includes(e));for(let t=e.length;t--;){const i=e[t],r=a[i].cues;delete a[i],Object.keys(r).forEach(e=>{try{const t=r[e];t.removeEventListener("enter",this.onEventCueEnter),n.removeCue(t)}catch(t){}})}}else a=this.dateRangeCuesAppended={};const u=e.fragments[e.fragments.length-1];if(0===s.length||!i(null==u?void 0:u.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=Ll();for(let i=0;i<s.length;i++){const e=s[i],t=r[e],n=t.startTime,o=a[e],u=(null==o?void 0:o.cues)||{};let c=(null==o?void 0:o.durationKnown)||!1,d=Cl;const{duration:h,endDate:f}=t;if(f&&null!==h)d=n+h,c=!0;else if(t.endOnNext&&!c){const e=s.reduce((e,n)=>{if(n!==t.id){const i=r[n];if(i.class===t.class&&i.startDate>t.startDate&&(!e||t.startDate<e.startDate))return i}return e},null);e&&(d=e.startTime,c=!0)}const p=Object.keys(t.attr);for(let i=0;i<p.length;i++){const r=p[i];if(!Sn(r))continue;const s=u[r];if(s)c&&!o.durationKnown?s.endTime=d:Math.abs(s.startTime-n)>.01&&(s.startTime=n,s.endTime=d);else if(l){let i=t.attr[r];En(r)&&(i=Dl(i));const s={key:r,data:i},a=Rl(l,n,d,s,Dr.dateRange);a&&(a.id=e,this.id3Track.addCue(a),u[r]=a,this.hls.config.interstitialsController&&("X-ASSET-LIST"!==r&&"X-ASSET-URL"!==r||a.addEventListener("enter",this.onEventCueEnter)))}}a[e]={cues:u,dateRange:t,durationKnown:c}}}}class Pl{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:e}=this,t=this.levelDetails;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(null===n)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:r}=this.config;if(!i||1===r||!t.live)return;const s=this.targetLatency;if(null===s)return;const a=n-s,o=Math.min(this.maxLatency,s+t.targetduration),u=a<o;if(u&&a>.05&&this.forwardBufferLength>1){const t=Math.min(2,Math.max(1,r)),n=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20,i=Math.min(t,Math.max(1,n));this.changeMediaPlaybackRate(e,i)}else 1!==e.playbackRate&&0!==e.playbackRate&&this.changeMediaPlaybackRate(e,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return(null==(e=this.hls)?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(void 0!==e.liveMaxLatencyDuration)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(null===e||null===this.hls)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:r,liveSyncDurationCount:s,lowLatencyMode:a}=this.config,o=this.hls.userConfig;let u=a&&n||t;(this._targetLatencyUpdated||o.liveSyncDuration||o.liveSyncDurationCount||0===u)&&(u=void 0!==r?r:s*i);const l=i;return u+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,l)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(null===e||null===t)return null;const n=this.levelDetails;if(null===n)return null;const i=n.edge,r=e-t-this.edgeStalled,s=i-n.totalduration,a=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(s,r),a)}get drift(){const e=this.levelDetails;return null===e?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(null===e)return 0;const t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(u.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(u.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var n;t.details===o.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&null!=(n=this.levelDetails)&&n.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var n,i;e.playbackRate!==t&&(null==(n=this.hls)||n.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${null==(i=this.targetLatency)?void 0:i.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}class _l extends zs{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(u.LEVEL_LOADED,this.onLevelLoaded,this),e.on(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(u.FRAG_BUFFERED,this.onFragBuffered,this),e.on(u.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(u.LEVEL_LOADED,this.onLevelLoaded,this),e.off(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(u.FRAG_BUFFERED,this.onFragBuffered,this),e.off(u.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){const e=this._levels;e.forEach(e=>{e.loadError=0,e.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,i=[],r={},s={};let a=!1,o=!1,u=!1;t.levels.forEach(e=>{const t=e.attrs;let{audioCodec:l,videoCodec:c}=e;l&&(e.audioCodec=l=Fe(l,n)||void 0),c&&(c=e.videoCodec=$e(c));const{width:d,height:h,unknownCodecs:f}=e;let p=f?f.length:0;if(f)for(let n=p;n--;){const t=f[n];this.isAudioSupported(t)?(e.audioCodec=l=l?`${l},${t}`:t,p--,Le.audio[l.substring(0,4)]=2):this.isVideoSupported(t)&&(e.videoCodec=c=c?`${c},${t}`:t,p--,Le.video[c.substring(0,4)]=2)}if(a||(a=!(!d||!h)),o||(o=!!c),u||(u=!!l),p||l&&!this.isAudioSupported(l)||c&&!this.isVideoSupported(c))return void this.log(`Some or all CODECS not supported "${t.CODECS}"`);const{CODECS:g,"FRAME-RATE":m,"HDCP-LEVEL":v,"PATHWAY-ID":y,RESOLUTION:b,"VIDEO-RANGE":T}=t,S=`${y||"."}-`,E=`${S}${e.bitrate}-${b}-${m}-${g}-${T}-${v}`;if(r[E])if(r[E].uri===e.url||e.attrs["PATHWAY-ID"])r[E].addGroupId("audio",t.AUDIO),r[E].addGroupId("text",t.SUBTITLES);else{const t=s[E]+=1;e.attrs["PATHWAY-ID"]=new Array(t+1).join(".");const n=this.createLevel(e);r[E]=n,i.push(n)}else{const t=this.createLevel(e);r[E]=t,s[E]=1,i.push(t)}}),this.filterAndSortMediaOptions(i,t,a,o,u)}createLevel(e){const t=new rt(e),n=e.supplemental;if(null!=n&&n.videoCodec&&!this.isVideoSupported(n.videoCodec)){const e=new Error(`SUPPLEMENTAL-CODECS not supported "${n.videoCodec}"`);this.log(e.message),t.supportedResult=We(e,[])}return t}isAudioSupported(e){return Ce(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return Ce(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,n,i,r){let s=[],l=[],c=e;if((n||i)&&r&&(c=c.filter(({videoCodec:e,videoRange:t,width:n,height:i})=>(!!e||!(!n||!i))&&et(t))),0===c.length)return void Promise.resolve().then(()=>{if(this.hls){let e="no level with compatible codecs found in manifest",n=e;t.levels.length&&(n=`one or more CODECS in variant not supported: ${lt(t.levels.map(e=>e.attrs.CODECS).filter((e,t,n)=>n.indexOf(e)===t))}`,this.warn(n),e+=` (${n})`);const i=new Error(e);this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:i,reason:n})}});t.audioTracks&&(s=t.audioTracks.filter(e=>!e.audioCodec||this.isAudioSupported(e.audioCodec)),Ol(s)),t.subtitles&&(l=t.subtitles,Ol(l));const d=c.slice(0);c.sort((e,t)=>{if(e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"])return(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&e.height!==t.height)return e.height-t.height;if(e.frameRate!==t.frameRate)return e.frameRate-t.frameRate;if(e.videoRange!==t.videoRange)return Ze.indexOf(e.videoRange)-Ze.indexOf(t.videoRange);if(e.videoCodec!==t.videoCodec){const n=Pe(e.videoCodec),i=Pe(t.videoCodec);if(n!==i)return i-n}if(e.uri===t.uri&&e.codecSet!==t.codecSet){const n=_e(e.codecSet),i=_e(t.codecSet);if(n!==i)return i-n}return e.averageBitrate!==t.averageBitrate?e.averageBitrate-t.averageBitrate:0});let h=d[0];if(this.steering&&(c=this.steering.filterParsedLevels(c),c.length!==d.length))for(let a=0;a<d.length;a++)if(d[a].pathwayId===c[0].pathwayId){h=d[a];break}this._levels=c;for(let a=0;a<c.length;a++)if(c[a]===h){var f;this._firstLevel=a;const e=h.bitrate,t=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${c.length} level(s) found, first bitrate: ${e}`),void 0===(null==(f=this.hls.userConfig)?void 0:f.abrEwmaDefaultEstimate)){const n=Math.min(e,this.hls.config.abrEwmaDefaultEstimateMax);n>t&&t===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=n)}break}const p=r&&!i,g=this.hls.config,m=!(!g.audioStreamController||!g.audioTrackController),v={levels:c,audioTracks:s,subtitleTracks:l,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:r,video:i,altAudio:m&&!p&&s.some(e=>!!e.url)};this.hls.trigger(u.MANIFEST_PARSED,v)}get levels(){return 0===this._levels.length?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const n=new Error("invalid level idx"),i=e<0;if(this.hls.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.LEVEL_SWITCH_ERROR,level:e,fatal:i,error:n,reason:n.message}),i)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,r=i?i.attrs["PATHWAY-ID"]:void 0,s=t[e],l=s.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=s,n===e&&i&&r===l)return;this.log(`Switching to level ${e} (${s.height?s.height+"p ":""}${s.videoRange?s.videoRange+" ":""}${s.codecSet?s.codecSet+" ":""}@${s.bitrate})${l?" with Pathway "+l:""} from level ${n}${r?" with Pathway "+r:""}`);const c={level:e,attrs:s.attrs,details:s.details,bitrate:s.bitrate,averageBitrate:s.averageBitrate,maxBitrate:s.maxBitrate,realBitrate:s.realBitrate,width:s.width,height:s.height,codecSet:s.codecSet,audioCodec:s.audioCodec,videoCodec:s.videoCodec,audioGroups:s.audioGroups,subtitleGroups:s.subtitleGroups,loaded:s.loaded,loadError:s.loadError,fragmentError:s.fragmentError,name:s.name,id:s.id,uri:s.uri,url:s.url,urlId:0,audioGroupIds:s.audioGroupIds,textGroupIds:s.textGroupIds};this.hls.trigger(u.LEVEL_SWITCHING,c);const d=s.details;if(!d||d.live){const e=this.switchParams(s.uri,null==i?void 0:i.details,d);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),n=e.filter(e=>-1!==t.indexOf(e));if(e.length<1)return void this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);this.steering.pathwayPriority=n}}onError(e,t){!t.fatal&&t.context&&t.context.type===l.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(void 0!==t&&t.type===c.MAIN){const e=t.elementaryStreams;if(!Object.keys(e).some(t=>!!e[t]))return;const n=this._levels[t.level];null!=n&&n.loadError&&(this.log(`Resetting level error count of ${n.loadError} on frag buffered`),n.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:r}=t,s=t.levelInfo;var a;if(!s)return this.warn(`Invalid level index ${i}`),void(null!=(a=t.deliveryDirectives)&&a.skip&&(r.deltaUpdateFailed=!0));if(s===this.currentLevel||t.withoutMultiVariant){0===s.fragmentError&&(s.loadError=0);let e=s.details;e===t.details&&e.advanced&&(e=void 0),this.playlistLoaded(i,t,e)}else null!=(n=t.deliveryDirectives)&&n.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=this.getUrlWithDirectives(e.uri,t),i=this.currentLevelIndex,r=e.attrs["PATHWAY-ID"],s=e.details,a=null==s?void 0:s.age;this.log(`Loading level index ${i}${void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:""}${r?" Pathway "+r:""}${a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""} ${n}`),this.hls.trigger(u.LEVEL_LOADING,{url:n,level:i,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(1===this._levels.length)return;const n=this._levels.filter((t,n)=>n!==e||(this.steering&&this.steering.removeLevel(t),t===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,t.details&&t.details.fragments.forEach(e=>e.level=-1)),!1));Ii(n),this._levels=n,this.currentLevelIndex>-1&&null!=(t=this.currentLevel)&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const i=n.length-1;this._firstLevel=Math.min(this._firstLevel,i),this._startLevel&&(this._startLevel=Math.min(this._startLevel,i)),this.hls.trigger(u.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(u.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function Ol(e){const t={};e.forEach(e=>{const n=e.groupId||"";e.id=t[n]=t[n]||0,t[n]++})}function Nl(){return self.SourceBuffer||self.WebKitSourceBuffer}function Ul(){const e=L();if(!e)return!1;const t=Nl();return!t||t.prototype&&"function"===typeof t.prototype.appendBuffer&&"function"===typeof t.prototype.remove}function Fl(){if(!Ul())return!1;const e=L();return"function"===typeof(null==e?void 0:e.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>e.isTypeSupported(Me(t,"video")))||["mp4a.40.2","fLaC"].some(t=>e.isTypeSupported(Me(t,"audio"))))}function Bl(){var e;const t=Nl();return"function"===typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}const jl=100;class $l extends Ni{constructor(e,t,n){super(e,t,n,"stream-controller",c.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const e=this.media,t=e?e.currentTime:null;if(null===t||!i(t))return;if(this.log(`Media seeked to ${t.toFixed(3)}`),!this.getBufferedFrag(t))return;const n=this.getFwdBufferInfoAtPos(e,t,c.MAIN,0);null!==n&&0!==n.len?this.tick():this.warn(`Main forward buffer length at ${t} on "seeked" event ${n?n.len:"empty"})`)},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(u.MANIFEST_PARSED,this.onManifestParsed,this),e.on(u.LEVEL_LOADING,this.onLevelLoading,this),e.on(u.LEVEL_LOADED,this.onLevelLoaded,this),e.on(u.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(u.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(u.BUFFER_CREATED,this.onBufferCreated,this),e.on(u.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(u.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(u.MANIFEST_PARSED,this.onManifestParsed,this),e.off(u.LEVEL_LOADED,this.onLevelLoaded,this),e.off(u.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(u.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(u.BUFFER_CREATED,this.onBufferCreated,this),e.off(u.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(u.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:n,hls:i}=this;if(this.stopLoad(),this.setInterval(jl),this.level=-1,!this.startFragRequested){let e=i.startLevel;-1===e&&(i.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=i.firstAutoLevel),i.nextLoadLevel=e,this.level=i.loadLevel,this._hasEnoughToStart=!!t}n>0&&-1===e&&!t&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n),this.state=Oi.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=Oi.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Oi.WAITING_LEVEL:{const{levels:e,level:t}=this,n=null==e?void 0:e[t],i=null==n?void 0:n.details;if(i&&(!i.live||this.levelLastLoaded===n&&!this.waitForLive(n))){if(this.waitForCdnTuneIn(i))break;this.state=Oi.IDLE;break}if(this.hls.nextLoadLevel!==this.level){this.state=Oi.IDLE;break}break}case Oi.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||null!=(e=this.media)&&e.seeking){const{levels:e,level:t}=this,n=null==e?void 0:e[t];this.resetStartWhenNotLoaded(n||null),this.state=Oi.IDLE}}break}this.state===Oi.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),null!=(e=this.media)&&e.readyState&&!1===this.media.seeking&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this;if(null===t||!i&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const r=this.buffering?e.nextLoadLevel:e.loadLevel;if(null==n||!n[r])return;const s=n[r],a=this.getMainFwdBufferInfo();if(null===a)return;const o=this.getLevelDetails();if(o&&this._streamEnded(a,o)){const e={};return 2===this.altAudio&&(e.type="video"),this.hls.trigger(u.BUFFER_EOS,e),void(this.state=Oi.ENDED)}if(!this.buffering)return;e.loadLevel!==r&&-1===e.manualLevel&&this.log(`Adapting to level ${r} from level ${this.level}`),this.level=e.nextLoadLevel=r;const l=s.details;if(!l||this.state===Oi.WAITING_LEVEL||this.waitForLive(s))return this.level=r,this.state=Oi.WAITING_LEVEL,void(this.startFragRequested=!1);const d=a.len,h=this.getMaxBufferLength(s.maxBitrate);if(d>=h)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const f=this.backtrackFragment?this.backtrackFragment.start:a.end;let p=this.getNextFragment(f,l);if(this.couldBacktrack&&!this.fragPrevious&&p&&$(p)&&this.fragmentTracker.getState(p)!==$t.OK){var g;const e=(null!=(g=this.backtrackFragment)?g:p).sn,t=e-l.startSN,n=l.fragments[t-1];n&&p.cc===n.cc&&(p=n,this.fragmentTracker.removeFragment(n))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(p&&this.isLoopLoading(p,f)){const e=p.gap;if(!e){const e=this.audioOnly&&!this.altAudio?B.AUDIO:B.VIDEO,t=(e===B.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,c.MAIN)}p=this.getNextFragmentLoopLoading(p,l,a,c.MAIN,h)}p&&(!p.initSegment||p.initSegment.data||this.bitrateTest||(p=p.initSegment),this.loadFragment(p,s,f))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);i===$t.NOT_LOADED||i===$t.PARTIAL?$(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,n):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,c.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const r=this.getLevelDetails();if(null!=r&&r.live){const e=this.getMainFwdBufferInfo();if(!e||e.len<2*r.targetduration)return}if(!t.paused&&e){const t=this.hls.nextLoadLevel,i=e[t],r=this.fragLastKbps;n=r&&this.fragCurrent?this.fragCurrent.duration*i.maxBitrate/(1e3*r)+1:0}else n=0;const s=this.getBufferedFrag(t.currentTime+n);if(s){const e=this.followingBufferedFrag(s);if(e){this.abortCurrentFrag();const t=e.maxStartPTS?e.maxStartPTS:e.start,n=e.duration,i=Math.max(s.end,t+Math.min(Math.max(n-this.config.maxFragLookUpTolerance,n*(this.couldBacktrack?.5:.125)),n*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(i,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Oi.KEY_LOADING:case Oi.FRAG_LOADING:case Oi.FRAG_LOADING_WAITING_RETRY:case Oi.PARSING:case Oi.PARSED:this.state=Oi.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,2===this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;bo(n,"playing",this.onMediaPlaying),bo(n,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:n}=this;n&&(To(n,"playing",this.onMediaPlaying),To(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t);const i=!!t.transferMedia;i||(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(u.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let n=!1,i=!1;t.levels.forEach(e=>{const t=e.audioCodec;t&&(n=n||-1!==t.indexOf("mp4a.40.2"),i=i||-1!==t.indexOf("mp4a.40.5"))}),this.audioCodecSwitch=n&&i&&!Bl(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==Oi.IDLE)return;const i=t.levelInfo;(!i.details||i.details.live&&(this.levelLastLoaded!==i||i.details.expired)||this.waitForCdnTuneIn(i.details))&&(this.state=Oi.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:i,startFragRequested:r}=this,s=t.level,a=t.details,o=a.totalduration;if(!i)return void this.warn(`Levels were reset while loading level ${s}`);this.log(`Level ${s} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${o}`);const l=t.levelInfo,c=this.fragCurrent;!c||this.state!==Oi.FRAG_LOADING&&this.state!==Oi.FRAG_LOADING_WAITING_RETRY||c.level!==t.level&&c.loader&&this.abortCurrentFrag();let d=0;if(a.live||null!=(n=l.details)&&n.live){var h;if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;d=this.alignPlaylists(a,l.details,null==(h=this.levelLastLoaded)?void 0:h.details)}if(l.details=a,this.levelLastLoaded=l,r||this.setStartPosition(a,d),this.hls.trigger(u.LEVEL_UPDATED,{details:a,level:s}),this.state===Oi.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=Oi.IDLE}r&&a.live&&this.synchronizeToLiveEdge(a),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,r=this.getLoadPosition(),s=e.fragmentStart,a=e.edge,o=r>=s-t.maxFragLookUpTolerance&&r<=a;if(null!==i&&n.duration>i&&(r<i||!o)){const s=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!o&&n.readyState<4||r<a-s)&&(this._hasEnoughToStart||(this.nextLoadPosition=i),n.readyState))if(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${i.toFixed(3)}`),"buffered"===this.config.liveSyncMode){var u;const e=dn.bufferInfo(n,i,0);if(null==e||null==(u=e.buffered)||!u.length)return void(n.currentTime=i);const t=e.start<=r;if(t)return void(n.currentTime=i);const{nextStart:s}=dn.bufferedInfo(e.buffered,r,0);s&&(n.currentTime=s)}else n.currentTime=i}}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:i,payload:r}=e,{levels:s}=this;if(!s)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const a=s[n.level];if(!a)return void this.warn(`Level ${n.level} not found on progress`);const o=a.details;if(!o)return this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),void this.fragmentTracker.removeFragment(n);const u=a.videoCodec,l=o.PTSKnown||!o.live,d=null==(t=n.initSegment)?void 0:t.data,h=this._getAudioCodec(a),f=this.transmuxer=this.transmuxer||new Ws(this.hls,c.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),p=i?i.index:-1,g=-1!==p,m=new un(n.level,n.sn,n.stats.chunkCount,r.byteLength,p,g),v=this.initPTS[n.cc];f.push(r,d,h,u,n,i,o.totalduration,l,m,v)}onAudioTrackSwitching(e,t){const n=this.hls,i=2===this.altAudio,r=Et(t.url,n);if(r)this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const e=this.fragCurrent;e&&(this.log("Switching to main audio track, cancel main fragment load"),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(i)return this.fragmentTracker.removeAllFragments(),n.once(u.BUFFER_FLUSHED,()=>{var e;null==(e=this.hls)||e.trigger(u.AUDIO_TRACK_SWITCHED,t)}),void n.trigger(u.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});n.trigger(u.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=Et(t.url,this.hls);if(n){const e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=e)}this.altAudio=n?2:0,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,r,s=!1;for(const a in n){const e=n[a];if("main"===e.id){if(r=a,i=e,"video"===a){const e=n[a];e&&(this.videoBuffer=e.buffer)}}else s=!0}s&&i?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t,r=n.type===c.MAIN;if(r){if(this.fragContextChanged(n))return this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===Oi.PARSED&&(this.state=Oi.IDLE));const e=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*e.total/(e.buffering.end-e.loading.first)),$(n)&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}const s=this.media;s&&(!this._hasEnoughToStart&&dn.getBuffered(s).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),r&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var n;if(t.fatal)this.state=Oi.ERROR;else switch(t.details){case o.FRAG_GAP:case o.FRAG_PARSING_ERROR:case o.FRAG_DECRYPT_ERROR:case o.FRAG_LOAD_ERROR:case o.FRAG_LOAD_TIMEOUT:case o.KEY_LOAD_ERROR:case o.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(c.MAIN,t);break;case o.LEVEL_LOAD_ERROR:case o.LEVEL_LOAD_TIMEOUT:case o.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Oi.WAITING_LEVEL||(null==(n=t.context)?void 0:n.type)!==l.LEVEL||(this.state=Oi.IDLE);break;case o.BUFFER_ADD_CODEC_ERROR:case o.BUFFER_APPEND_ERROR:if("main"!==t.parent)return;this.resetLoadingState();break;case o.BUFFER_FULL_ERROR:if("main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case o.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=Oi.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==B.AUDIO||!this.altAudio){const e=(t===B.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;e&&(this.afterBufferFlushed(e,t,c.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,-1===this.level&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking)return void this.log(`could not seek to ${n}, already seeking at ${t}`);const i=this.timelineOffset;i&&n&&(n+=i);const r=this.getLevelDetails(),s=dn.getBuffered(e),a=s.length?s.start(0):0,o=a-n,u=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||o>0&&(o<u||this.loadingParts&&o<2*((null==r?void 0:r.partTarget)||0)))&&(this.log(`adjusting start position by ${o} to match buffer start`),n+=o,this.startPosition=n),t<n&&(this.log(`seek to target start position ${n} from current time ${t} buffer start ${a}`),e.currentTime=n)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(e=>{const{hls:n}=this,i=null==e?void 0:e.frag;if(!i||this.fragContextChanged(i))return;t.fragmentError=0,this.state=Oi.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const r=i.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),n.trigger(u.FRAG_LOADED,e),i.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n=this.playlistType,{hls:r}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o)return void this.resetWhenMissingContext(a);const{frag:l,part:c,level:d}=o,{video:h,text:f,id3:p,initSegment:g}=s,{details:m}=d,v=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l))this.fragmentTracker.removeFragment(l);else{if(this.state=Oi.PARSING,g){if(null!=g&&g.tracks){const e=l.initSegment||l;this._bufferInitSegment(d,g.tracks,e,a),r.trigger(u.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:g.tracks})}const e=g.initPTS,t=g.timescale;i(e)&&(this.initPTS[l.cc]={baseTime:e,timescale:t},r.trigger(u.INIT_PTS_FOUND,{frag:l,id:n,initPTS:e,timescale:t}))}if(h&&m){v&&"audiovideo"===h.type&&this.logMuxedErr(l);const e=m.fragments[l.sn-1-m.startSN],t=l.sn===m.startSN,n=!e||l.cc>e.cc;if(!1!==s.independent){const{startPTS:e,endPTS:i,startDTS:r,endDTS:s}=h;if(c)c.elementaryStreams[h.type]={startPTS:e,endPTS:i,startDTS:r,endDTS:s};else if(h.firstKeyFrame&&h.independent&&1===a.id&&!n&&(this.couldBacktrack=!0),h.dropped&&h.independent){const r=this.getMainFwdBufferInfo(),a=(r?r.end:this.getLoadPosition())+this.config.maxBufferHole,o=h.firstKeyFramePTS?h.firstKeyFramePTS:e;if(!t&&a<o-this.config.maxBufferHole&&!n)return void this.backtrack(l);n&&(l.gap=!0),l.setElementaryStreamInfo(h.type,l.start,i,l.start,s,!0)}else t&&e-(m.appliedTimelineOffset||0)>Tl&&(l.gap=!0);l.setElementaryStreamInfo(h.type,e,i,r,s),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(h,l,c,a,t||n)}else{if(!t&&!n)return void this.backtrack(l);l.gap=!0}}if(v){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=v;c&&(c.elementaryStreams[B.AUDIO]={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),l.setElementaryStreamInfo(B.AUDIO,e,t,n,i),this.bufferFragmentData(v,l,c,a)}if(m&&null!=p&&null!=(t=p.samples)&&t.length){const e={id:n,frag:l,details:m,samples:p.samples};r.trigger(u.FRAG_PARSING_METADATA,e)}if(m&&f){const e={id:n,frag:l,details:m,samples:f.samples};r.trigger(u.FRAG_PARSING_USERDATA,e)}}}logMuxedErr(e){this.warn(`${$(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,n,i){if(this.state!==Oi.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(n));const{audio:r,video:s,audiovideo:a}=t;if(r){let n=je(r.codec,e.audioCodec);"mp4a"===n&&(n="mp4a.40.5");const i=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){n&&(n=-1!==n.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const e=r.metadata;e&&"channelCount"in e&&1!==(e.channelCount||1)&&-1===i.indexOf("firefox")&&(n="mp4a.40.5")}n&&-1!==n.indexOf("mp4a.40.5")&&-1!==i.indexOf("android")&&"audio/mpeg"!==r.container&&(n="mp4a.40.2",this.log(`Android: force audio codec to ${n}`)),e.audioCodec&&e.audioCodec!==n&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${n}"`),r.levelCodec=n,r.id=c.MAIN,this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${n||""}/${e.audioCodec||""}/${r.codec}]`),delete t.audiovideo}if(s){s.levelCodec=e.videoCodec,s.id=c.MAIN;const n=s.codec;if(4===(null==n?void 0:n.length))switch(n){case"hvc1":case"hev1":s.codec="hvc1.1.6.L120.90";break;case"av01":s.codec="av01.0.04M.08";break;case"avc1":s.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${s.container}, codecs[level/parsed]=[${e.videoCodec||""}/${n}]${s.codec!==n?" parsed-corrected="+s.codec:""}${s.supplemental?" supplemental="+s.supplemental:""}`),delete t.audiovideo}a&&(this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),delete t.video,delete t.audio);const o=Object.keys(t);if(o.length){if(this.hls.trigger(u.BUFFER_CODECS,t),!this.hls)return;o.forEach(e=>{const r=t[e],s=r.initSegment;null!=s&&s.byteLength&&this.hls.trigger(u.BUFFER_APPENDING,{type:e,data:s,frag:n,part:null,chunkMeta:i,parent:n.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&2===this.altAudio?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,c.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,n=null==e?void 0:e[t];return n?this.getMaxBufferLength(n.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Oi.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const n=e.currentTime;if(dn.isBuffered(e,n)?t=this.getAppendedFrag(n):dn.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const e=this.fragPlaying,n=t.level;e&&t.sn===e.sn&&e.level===n||(this.fragPlaying=t,this.hls.trigger(u.FRAG_CHANGED,{frag:t}),e&&e.level===n||this.hls.trigger(u.LEVEL_SWITCHED,{level:n}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;return i(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;if(i(t)){const e=this.getLevelDetails(),n=this.currentFrag||(e?It(null,e.fragments,t):null);if(n){const e=n.programDateTime;if(null!==e){const i=e+1e3*(t-n.start);return new Date(i)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Gl{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[n].loader;if(i){var t;if(e&&e!==(null==(t=i.context)?void 0:t.frag.type))return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=o.KEY_LOAD_ERROR,n,i,r){return new an({type:a.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:n,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length)if(t.length){const{sn:n,cc:i}=e;for(let e=0;e<t.length;e++){const r=t[e];if(i<=r.cc&&("initSegment"===n||"initSegment"===r.sn||n<r.sn))return this.emeController.selectKeySystemFormat(r).then(e=>{if(r.setKeyFormat(e),this.emeController&&this.config.requireKeySystemAccessOnStart){const t=Nn(e);if(t)return this.emeController.getKeySystemAccess([t])}})}}else if(this.config.requireKeySystemAccessOnStart){const e=jn(this.config);if(e.length)return this.emeController.getKeySystemAccess(e)}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const n=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,o.KEY_LOAD_ERROR,n))}const s=r.uri;if(!s)return Promise.reject(this.createKeyLoadError(e,o.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${s}"`)));let a=this.keyUriToKeyInfo[s];if(null!=(n=a)&&n.decryptdata.key)return r.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});var u;if(null!=(i=a)&&i.keyLoadPromise)switch(null==(u=a.mediaKeySessionContext)?void 0:u.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then(t=>(r.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:a}))}switch(a=this.keyUriToKeyInfo[s]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===r.keyFormat?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,o.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const t=this.emeController.loadKey(n);if(t)return(e.keyLoadPromise=t.then(t=>(e.mediaKeySessionContext=t,n))).catch(t=>{throw e.keyLoadPromise=null,t})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=n.loader,r=new i(n);return t.keyLoader=e.loader=r,e.keyLoadPromise=new Promise((i,s)=>{const a={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=n.keyLoadPolicy.default,l={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(e,t,n,r)=>{const{frag:a,keyInfo:u,url:l}=n;if(!a.decryptdata||u!==this.keyUriToKeyInfo[l])return s(this.createKeyLoadError(a,o.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),r));u.decryptdata.key=a.decryptdata.key=new Uint8Array(e.data),a.keyLoader=null,u.loader=null,i({frag:a,keyInfo:u})},onError:(e,n,i,r)=>{this.resetLoader(n),s(this.createKeyLoadError(t,o.KEY_LOAD_ERROR,new Error(`HTTP Error ${e.code} loading key ${e.text}`),i,m({url:a.url,data:void 0},e)))},onTimeout:(e,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(t,o.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),i))},onAbort:(e,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(t,o.INTERNAL_ABORTED,new Error("key loading aborted"),i))}};r.load(a,l,c)})}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,r=n.loader;t.keyLoader===r&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],r&&r.destroy()}}function Vl(e){const{type:t}=e;switch(t){case l.AUDIO_TRACK:return c.AUDIO;case l.SUBTITLE_TRACK:return c.SUBTITLE;default:return c.MAIN}}function Hl(e,t){let n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n}class Kl{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.LEVEL_LOADING,this.onLevelLoading,this),e.on(u.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(u.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(u.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.LEVEL_LOADING,this.onLevelLoading,this),e.off(u.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(u.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(u.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,r=n||i,s=new r(t);return this.loaders[e.type]=s,s}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:l.MANIFEST,url:n,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:n,level:i,pathwayId:r,url:s,deliveryDirectives:a,levelInfo:o}=t;this.load({id:n,level:i,pathwayId:r,responseType:"text",type:l.LEVEL,url:s,deliveryDirectives:a,levelOrTrack:o})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:s,track:a}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:l.AUDIO_TRACK,url:r,deliveryDirectives:s,levelOrTrack:a})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:s,track:a}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:l.SUBTITLE_TRACK,url:r,deliveryDirectives:s,levelOrTrack:a})}onLevelsUpdated(e,t){const n=this.loaders[l.LEVEL];if(n){const e=n.context;e&&!t.levels.some(t=>t===e.levelOrTrack)&&(n.abort(),delete this.loaders[l.LEVEL])}}load(e){var t;const n=this.hls.config;let r,s=this.getInternalLoader(e);if(s){const t=this.hls.logger,n=s.context;if(n&&n.levelOrTrack===e.levelOrTrack&&(n.url===e.url||n.deliveryDirectives&&!e.deliveryDirectives))return void(n.url===e.url?t.log(`[playlist-loader]: ignore ${e.url} ongoing request`):t.log(`[playlist-loader]: ignore ${e.url} in favor of ${n.url}`));t.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),s.abort()}if(r=e.type===l.MANIFEST?n.manifestLoadPolicy.default:p({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(e),i(null==(t=e.deliveryDirectives)?void 0:t.part)){let t;if(e.type===l.LEVEL&&null!==e.level?t=this.hls.levels[e.level].details:e.type===l.AUDIO_TRACK&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===l.SUBTITLE_TRACK&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t){const e=t.partTarget,n=t.targetduration;if(e&&n){const t=1e3*Math.max(3*e,.8*n);r=p({},r,{maxTimeToFirstByteMs:Math.min(t,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,r.maxTimeToFirstByteMs)})}}}const a=r.errorRetry||r.timeoutRetry||{},o={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},u={onSuccess:(e,t,n,i)=>{const r=this.getInternalLoader(n);this.resetInternalLoader(n.type);const s=e.data;0===s.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),ei.isMediaPlaylist(s)||n.type!==l.MANIFEST?this.handleTrackOrLevelPlaylist(e,t,n,i||null,r):this.handleMasterPlaylist(e,t,n,i)):this.handleManifestParsingError(e,n,new Error("no EXTM3U delimiter"),i||null,t)},onError:(e,t,n,i)=>{this.handleNetworkError(t,n,!1,e,i)},onTimeout:(e,t,n)=>{this.handleNetworkError(t,n,!0,void 0,e)}};s.load(e,o,u)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:n}=this.hls;(e||n)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,n,i){const r=this.hls,s=e.data,a=Hl(e,n),o=ei.parseMasterPlaylist(s,a);if(o.playlistParsingError)return void this.handleManifestParsingError(e,n,o.playlistParsingError,i,t);const{contentSteering:l,levels:c,sessionData:d,sessionKeys:h,startTimeOffset:f,variableList:p}=o;this.variableList=p;const{AUDIO:g=[],SUBTITLES:m,"CLOSED-CAPTIONS":v}=ei.parseMasterPlaylistMedia(s,a,o);if(g.length){const e=g.some(e=>!e.url);e||!c[0].audioCodec||c[0].attrs.AUDIO||(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),g.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new bn({}),bitrate:0,url:""}))}r.trigger(u.MANIFEST_LOADED,{levels:c,audioTracks:g,subtitles:m,captions:v,contentSteering:l,url:a,stats:t,networkDetails:i,sessionData:d,sessionKeys:h,startTimeOffset:f,variableList:p})}handleTrackOrLevelPlaylist(e,t,n,r,s){const a=this.hls,{id:o,level:c,type:d}=n,h=Hl(e,n),f=i(c)?c:i(o)?o:0,p=Vl(n),g=ei.parseLevelPlaylist(e.data,h,f,p,0,this.variableList);if(d===l.MANIFEST){const e={attrs:new bn({}),bitrate:0,details:g,name:"",url:h};g.requestScheduled=t.loading.start+Ei(g,0),a.trigger(u.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:h,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=g,this.handlePlaylistLoaded(g,e,t,n,r,s)}handleManifestParsingError(e,t,n,i,r){this.hls.trigger(u.ERROR,{type:a.NETWORK_ERROR,details:o.MANIFEST_PARSING_ERROR,fatal:t.type===l.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:r})}handleNetworkError(e,t,n=!1,i,r){let s=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===l.LEVEL?s+=`: ${e.level} id: ${e.id}`:e.type!==l.AUDIO_TRACK&&e.type!==l.SUBTITLE_TRACK||(s+=` id: ${e.id} group-id: "${e.groupId}"`);const c=new Error(s);this.hls.logger.warn(`[playlist-loader]: ${s}`);let d=o.UNKNOWN,h=!1;const f=this.getInternalLoader(e);switch(e.type){case l.MANIFEST:d=n?o.MANIFEST_LOAD_TIMEOUT:o.MANIFEST_LOAD_ERROR,h=!0;break;case l.LEVEL:d=n?o.LEVEL_LOAD_TIMEOUT:o.LEVEL_LOAD_ERROR,h=!1;break;case l.AUDIO_TRACK:d=n?o.AUDIO_TRACK_LOAD_TIMEOUT:o.AUDIO_TRACK_LOAD_ERROR,h=!1;break;case l.SUBTITLE_TRACK:d=n?o.SUBTITLE_TRACK_LOAD_TIMEOUT:o.SUBTITLE_LOAD_ERROR,h=!1;break}f&&this.resetInternalLoader(e.type);const p={type:a.NETWORK_ERROR,details:d,fatal:h,url:e.url,loader:f,context:e,error:c,networkDetails:t,stats:r};if(i){const n=(null==t?void 0:t.url)||e.url;p.response=m({url:n,data:void 0},i)}this.hls.trigger(u.ERROR,p)}handlePlaylistLoaded(e,t,n,i,r,s){const d=this.hls,{type:h,level:f,id:p,groupId:g,deliveryDirectives:m}=i,v=Hl(t,i),y=Vl(i),b="number"===typeof i.level&&y===c.MAIN?f:void 0;if(!e.fragments.length){const s=e.playlistParsingError=new Error("No Segments found in Playlist");return void d.trigger(u.ERROR,{type:a.NETWORK_ERROR,details:o.LEVEL_EMPTY_ERROR,fatal:!1,url:v,error:s,reason:s.message,response:t,context:i,level:b,parent:y,networkDetails:r,stats:n})}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const T=e.playlistParsingError;if(T){if(this.hls.logger.warn(T),!d.config.ignorePlaylistParsingErrors)return void d.trigger(u.ERROR,{type:a.NETWORK_ERROR,details:o.LEVEL_PARSING_ERROR,fatal:!1,url:v,error:T,reason:T.message,response:t,context:i,level:b,parent:y,networkDetails:r,stats:n});e.playlistParsingError=null}switch(e.live&&s&&(s.getCacheAge&&(e.ageHeader=s.getCacheAge()||0),s.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),h){case l.MANIFEST:case l.LEVEL:d.trigger(u.LEVEL_LOADED,{details:e,levelInfo:i.levelOrTrack||d.levels[0],level:b||0,id:p||0,stats:n,networkDetails:r,deliveryDirectives:m,withoutMultiVariant:h===l.MANIFEST});break;case l.AUDIO_TRACK:d.trigger(u.AUDIO_TRACK_LOADED,{details:e,track:i.levelOrTrack,id:p||0,groupId:g||"",stats:n,networkDetails:r,deliveryDirectives:m});break;case l.SUBTITLE_TRACK:d.trigger(u.SUBTITLE_TRACK_LOADED,{details:e,track:i.levelOrTrack,id:p||0,groupId:g||"",stats:n,networkDetails:r,deliveryDirectives:m});break}}}class Wl{static get version(){return Ki}static isMSESupported(){return Ul()}static isSupported(){return Fl()}static getMediaSource(){return L()}static get Events(){return u}static get MetadataSchema(){return Dr}static get ErrorTypes(){return a}static get ErrorDetails(){return o}static get DefaultConfig(){return Wl.defaultConfig?Wl.defaultConfig:gl}static set DefaultConfig(e){Wl.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Hi,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=I(e.debug||!1,"Hls instance",e.assetPlayerId),n=this.config=vl(Wl.DefaultConfig,e,t);this.userConfig=e,n.progressive&&bl(n,t);const{abrController:i,bufferController:r,capLevelController:s,errorController:a,fpsController:o}=n,l=new a(this),c=this.abrController=new i(this),d=new Gt(this),h=n.interstitialsController,f=h?this.interstitialsController=new h(this,Wl):null,p=this.bufferController=new r(this,d),g=this.capLevelController=new s(this),m=new o(this),v=new Kl(this),y=n.contentSteeringController,b=y?new y(this):null,T=this.levelController=new _l(this,b),S=new Ml(this),E=new Gl(this.config),w=this.streamController=new $l(this,d,E),A=this.gapController=new Al(this,d);g.setStreamController(w),m.setStreamController(w);const x=[v,T,w];f&&x.splice(1,0,f),b&&x.splice(1,0,b),this.networkControllers=x;const k=[c,p,A,g,m,S,d];this.audioTrackController=this.createController(n.audioTrackController,x);const L=n.audioStreamController;L&&x.push(this.audioStreamController=new L(this,d,E)),this.subtitleTrackController=this.createController(n.subtitleTrackController,x);const R=n.subtitleStreamController;R&&x.push(this.subtititleStreamController=new R(this,d,E)),this.createController(n.timelineController,k),E.emeController=this.emeController=this.createController(n.emeController,k),this.cmcdController=this.createController(n.cmcdController,k),this.latencyController=this.createController(Pl,k),this.coreComponents=k,x.push(l);const C=l.onErrorOut;"function"===typeof C&&this.on(u.ERROR,C,l),this.on(u.MANIFEST_LOADED,v.onManifestLoaded,v)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const t=e===u.ERROR;this.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.INTERNAL_EXCEPTION,fatal:t,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(u.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(e=>e.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(e=>e.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const t=new Error(`attachMedia failed: invalid argument (${e})`);return void this.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.ATTACH_MEDIA_ERROR,fatal:!0,error:t})}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,n=t?e.media:e,i=t?e:{media:n};this._media=n,this.trigger(u.MEDIA_ATTACHING,i)}detachMedia(){this.logger.log("detachMedia"),this.trigger(u.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(u.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,n=this._url,i=this._url=U.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(u.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let n=0;n<this.networkControllers.length;n++)if(this.networkControllers[n].startLoad(e,t),!this.started||!this.networkControllers)break}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length;e++)if(this.networkControllers[e].stopLoad(),this.started||!this.networkControllers)break}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[c.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[c.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[c.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=null==e?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=Mo()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return-1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){Je(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(i=-1===t&&null!=e&&e.length?e.length-1:t,n)for(let r=i;r--;){const t=e[r].attrs["HDCP-LEVEL"];if(t&&t<=n)return r}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return(null==(t=this.audioTrackController)?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return(null==(t=this.subtitleTrackController)?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!(null==(e=this.bufferController)||!e.bufferedToEnd)}get interstitialsManager(){var e;return(null==(e=this.interstitialsController)?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const n=ht(t);return ze(e,n,navigator.mediaCapabilities)}}Wl.defaultConfig=void 0},4055:function(e,t,n){"use strict";var i=n(4576),r=n(34),s=i.document,a=r(s)&&r(s.createElement);e.exports=function(e){return a?s.createElement(e):{}}},4068:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var i=n(5808);function r(e,t){return(0,i.w)(t||e,e)}},4114:function(e,t,n){"use strict";var i=n(6518),r=n(8981),s=n(6198),a=n(4527),o=n(6837),u=n(9039),l=u(function(){return 4294967297!==[].push.call({length:4294967296},1)}),c=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},d=l||!c();i({target:"Array",proto:!0,arity:1,forced:d},{push:function(e){var t=r(this),n=s(t),i=arguments.length;o(n+i);for(var u=0;u<i;u++)t[n]=arguments[u],n++;return a(t,n),n}})},4117:function(e){"use strict";e.exports=function(e){return null===e||void 0===e}},4138:function(e,t,n){"use strict";n.d(t,{GP:function(){return H}});n(8111),n(1701);var i=n(8541),r=n(9369),s=n(1712),a=n(4068);function o(e,t){const n=(0,a.a)(e,t?.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function u(e,t){const n=(0,a.a)(e,t?.in),i=(0,s.m)(n,o(n)),r=i+1;return r}var l=n(2436);function c(e,t){const n=(0,r.q)(),i=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,s=(0,a.a)(e,t?.in),o=s.getDay(),u=(o<i?7:0)+o-i;return s.setDate(s.getDate()-u),s.setHours(0,0,0,0),s}function d(e,t){return c(e,{...t,weekStartsOn:1})}var h=n(5808);function f(e,t){const n=(0,a.a)(e,t?.in),i=n.getFullYear(),r=(0,h.w)(n,0);r.setFullYear(i+1,0,4),r.setHours(0,0,0,0);const s=d(r),o=(0,h.w)(n,0);o.setFullYear(i,0,4),o.setHours(0,0,0,0);const u=d(o);return n.getTime()>=s.getTime()?i+1:n.getTime()>=u.getTime()?i:i-1}function p(e,t){const n=f(e,t),i=(0,h.w)(t?.in||e,0);return i.setFullYear(n,0,4),i.setHours(0,0,0,0),d(i)}function g(e,t){const n=(0,a.a)(e,t?.in),i=+d(n)-+p(n);return Math.round(i/l.my)+1}function m(e,t){const n=(0,a.a)(e,t?.in),i=n.getFullYear(),s=(0,r.q)(),o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,u=(0,h.w)(t?.in||e,0);u.setFullYear(i+1,0,o),u.setHours(0,0,0,0);const l=c(u,t),d=(0,h.w)(t?.in||e,0);d.setFullYear(i,0,o),d.setHours(0,0,0,0);const f=c(d,t);return+n>=+l?i+1:+n>=+f?i:i-1}function v(e,t){const n=(0,r.q)(),i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,s=m(e,t),a=(0,h.w)(t?.in||e,0);a.setFullYear(s,0,i),a.setHours(0,0,0,0);const o=c(a,t);return o}function y(e,t){const n=(0,a.a)(e,t?.in),i=+c(n,t)-+v(n,t);return Math.round(i/l.my)+1}function b(e,t){const n=e<0?"-":"",i=Math.abs(e).toString().padStart(t,"0");return n+i}const T={y(e,t){const n=e.getFullYear(),i=n>0?n:1-n;return b("yy"===t?i%100:i,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):b(n+1,2)},d(e,t){return b(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return"am"===n?"a.m.":"p.m."}},h(e,t){return b(e.getHours()%12||12,t.length)},H(e,t){return b(e.getHours(),t.length)},m(e,t){return b(e.getMinutes(),t.length)},s(e,t){return b(e.getSeconds(),t.length)},S(e,t){const n=t.length,i=e.getMilliseconds(),r=Math.trunc(i*Math.pow(10,n-3));return b(r,t.length)}},S={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},E={G:function(e,t,n){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});case"GGGG":default:return n.era(i,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),i=t>0?t:1-t;return n.ordinalNumber(i,{unit:"year"})}return T.y(e,t)},Y:function(e,t,n,i){const r=m(e,i),s=r>0?r:1-r;if("YY"===t){const e=s%100;return b(e,2)}return"Yo"===t?n.ordinalNumber(s,{unit:"year"}):b(s,t.length)},R:function(e,t){const n=f(e);return b(n,t.length)},u:function(e,t){const n=e.getFullYear();return b(n,t.length)},Q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return b(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return b(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,n){const i=e.getMonth();switch(t){case"M":case"MM":return T.M(e,t);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,n){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return b(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,n,i){const r=y(e,i);return"wo"===t?n.ordinalNumber(r,{unit:"week"}):b(r,t.length)},I:function(e,t,n){const i=g(e);return"Io"===t?n.ordinalNumber(i,{unit:"week"}):b(i,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):T.d(e,t)},D:function(e,t,n){const i=u(e);return"Do"===t?n.ordinalNumber(i,{unit:"dayOfYear"}):b(i,t.length)},E:function(e,t,n){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});case"EEEE":default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,n,i){const r=e.getDay(),s=(r-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return b(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(e,t,n,i){const r=e.getDay(),s=(r-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return b(s,t.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(e,t,n){const i=e.getDay(),r=0===i?7:i;switch(t){case"i":return String(r);case"ii":return b(r,t.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});case"iiii":default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,n){const i=e.getHours(),r=i/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){const i=e.getHours();let r;switch(r=12===i?S.noon:0===i?S.midnight:i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){const i=e.getHours();let r;switch(r=i>=17?S.evening:i>=12?S.afternoon:i>=4?S.morning:S.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return T.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):T.H(e,t)},K:function(e,t,n){const i=e.getHours()%12;return"Ko"===t?n.ordinalNumber(i,{unit:"hour"}):b(i,t.length)},k:function(e,t,n){let i=e.getHours();return 0===i&&(i=24),"ko"===t?n.ordinalNumber(i,{unit:"hour"}):b(i,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):T.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):T.s(e,t)},S:function(e,t){return T.S(e,t)},X:function(e,t,n){const i=e.getTimezoneOffset();if(0===i)return"Z";switch(t){case"X":return A(i);case"XXXX":case"XX":return x(i);case"XXXXX":case"XXX":default:return x(i,":")}},x:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"x":return A(i);case"xxxx":case"xx":return x(i);case"xxxxx":case"xxx":default:return x(i,":")}},O:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+w(i,":");case"OOOO":default:return"GMT"+x(i,":")}},z:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+w(i,":");case"zzzz":default:return"GMT"+x(i,":")}},t:function(e,t,n){const i=Math.trunc(+e/1e3);return b(i,t.length)},T:function(e,t,n){return b(+e,t.length)}};function w(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),r=Math.trunc(i/60),s=i%60;return 0===s?n+String(r):n+String(r)+t+b(s,2)}function A(e,t){if(e%60===0){const t=e>0?"-":"+";return t+b(Math.abs(e)/60,2)}return x(e,t)}function x(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),r=b(Math.trunc(i/60),2),s=b(i%60,2);return n+r+t+s}const I=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},k=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},L=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],i=n[1],r=n[2];if(!r)return I(e,t);let s;switch(i){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",I(i,t)).replace("{{time}}",k(r,t))},R={p:k,P:L},C=/^D+$/,D=/^Y+$/,M=["D","DD","YY","YYYY"];function P(e){return C.test(e)}function _(e){return D.test(e)}function O(e,t,n){const i=N(e,t,n);if(console.warn(i),M.includes(e))throw new RangeError(i)}function N(e,t,n){const i="Y"===e[0]?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}function U(e){return e instanceof Date||"object"===typeof e&&"[object Date]"===Object.prototype.toString.call(e)}function F(e){return!(!U(e)&&"number"!==typeof e||isNaN(+(0,a.a)(e)))}const B=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,j=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,$=/^'([^]*?)'?$/,G=/''/g,V=/[a-zA-Z]/;function H(e,t,n){const s=(0,r.q)(),o=n?.locale??s.locale??i.c,u=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,l=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??s.weekStartsOn??s.locale?.options?.weekStartsOn??0,c=(0,a.a)(e,n?.in);if(!F(c))throw new RangeError("Invalid time value");let d=t.match(j).map(e=>{const t=e[0];if("p"===t||"P"===t){const n=R[t];return n(e,o.formatLong)}return e}).join("").match(B).map(e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:K(e)};if(E[t])return{isToken:!0,value:e};if(t.match(V))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}});o.localize.preprocessor&&(d=o.localize.preprocessor(c,d));const h={firstWeekContainsDate:u,weekStartsOn:l,locale:o};return d.map(i=>{if(!i.isToken)return i.value;const r=i.value;(!n?.useAdditionalWeekYearTokens&&_(r)||!n?.useAdditionalDayOfYearTokens&&P(r))&&O(r,t,String(e));const s=E[r[0]];return s(c,r,o.localize,h)}).join("")}function K(e){const t=e.match($);return t?t[1].replace(G,"'"):e}},4156:function(e,t,n){"use strict";n.d(t,{x:function(){return r}});n(8111),n(116),n(1701);var i=n(5808);function r(e,...t){const n=i.w.bind(null,e||t.find(e=>"object"===typeof e));return t.map(n)}},4204:function(e,t,n){"use strict";var i=n(7080),r=n(4402).add,s=n(9286),a=n(3789),o=n(507);e.exports=function(e){var t=i(this),n=a(e).getIterator(),u=s(t);return o(n,function(e){r(u,e)}),u}},4209:function(e,t,n){"use strict";var i=n(8227),r=n(6269),s=i("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[s]===e)}},4215:function(e,t,n){"use strict";var i=n(4576),r=n(2839),s=n(2195),a=function(e){return r.slice(0,e.length)===e};e.exports=function(){return a("Bun/")?"BUN":a("Cloudflare-Workers")?"CLOUDFLARE":a("Deno/")?"DENO":a("Node.js/")?"NODE":i.Bun&&"string"==typeof Bun.version?"BUN":i.Deno&&"object"==typeof Deno.version?"DENO":"process"===s(i.process)?"NODE":i.window&&i.document?"BROWSER":"REST"}()},4232:function(e,t,n){"use strict";n.d(t,{$3:function(){return f},$H:function(){return U},BH:function(){return K},BX:function(){return ne},Bm:function(){return S},C4:function(){return Q},CE:function(){return g},CP:function(){return l},DY:function(){return F},Gv:function(){return E},J$:function(){return Z},Kg:function(){return T},MZ:function(){return r},Mp:function(){return u},NO:function(){return o},Oj:function(){return s},PT:function(){return M},Qd:function(){return k},Ro:function(){return $},SU:function(){return R},TF:function(){return d},Tg:function(){return _},Tn:function(){return b},Tr:function(){return W},We:function(){return V},X$:function(){return c},Y2:function(){return ee},ZH:function(){return O},Zf:function(){return I},bB:function(){return j},cy:function(){return p},gd:function(){return y},pD:function(){return i},rU:function(){return N},tE:function(){return a},u3:function(){return ie},vM:function(){return m},v_:function(){return se},yI:function(){return L},yL:function(){return w},yQ:function(){return B}});n(4114),n(8111),n(2489),n(7588);
/**
* @vue/shared v3.5.16
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/
/*! #__NO_SIDE_EFFECTS__ */
function i(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return e=>e in t}const r={},s=[],a=()=>{},o=()=>!1,u=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),l=e=>e.startsWith("onUpdate:"),c=Object.assign,d=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},h=Object.prototype.hasOwnProperty,f=(e,t)=>h.call(e,t),p=Array.isArray,g=e=>"[object Map]"===x(e),m=e=>"[object Set]"===x(e),v=e=>"[object Date]"===x(e),y=e=>"[object RegExp]"===x(e),b=e=>"function"===typeof e,T=e=>"string"===typeof e,S=e=>"symbol"===typeof e,E=e=>null!==e&&"object"===typeof e,w=e=>(E(e)||b(e))&&b(e.then)&&b(e.catch),A=Object.prototype.toString,x=e=>A.call(e),I=e=>x(e).slice(8,-1),k=e=>"[object Object]"===x(e),L=e=>T(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,R=i(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),C=e=>{const t=Object.create(null);return n=>{const i=t[n];return i||(t[n]=e(n))}},D=/-(\w)/g,M=C(e=>e.replace(D,(e,t)=>t?t.toUpperCase():"")),P=/\B([A-Z])/g,_=C(e=>e.replace(P,"-$1").toLowerCase()),O=C(e=>e.charAt(0).toUpperCase()+e.slice(1)),N=C(e=>{const t=e?`on${O(e)}`:"";return t}),U=(e,t)=>!Object.is(e,t),F=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},B=(e,t,n,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:n})},j=e=>{const t=parseFloat(e);return isNaN(t)?e:t},$=e=>{const t=T(e)?Number(e):NaN;return isNaN(t)?e:t};let G;const V=()=>G||(G="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{});const H="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol",K=i(H);function W(e){if(p(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],r=T(i)?X(i):W(i);if(r)for(const e in r)t[e]=r[e]}return t}if(T(e)||E(e))return e}const q=/;(?![^(]*\))/g,Y=/:([^]+)/,z=/\/\*[^]*?\*\//g;function X(e){const t={};return e.replace(z,"").split(q).forEach(e=>{if(e){const n=e.split(Y);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function Q(e){let t="";if(T(e))t=e;else if(p(e))for(let n=0;n<e.length;n++){const i=Q(e[n]);i&&(t+=i+" ")}else if(E(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const J="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Z=i(J);function ee(e){return!!e||""===e}function te(e,t){if(e.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<e.length;i++)n=ne(e[i],t[i]);return n}function ne(e,t){if(e===t)return!0;let n=v(e),i=v(t);if(n||i)return!(!n||!i)&&e.getTime()===t.getTime();if(n=S(e),i=S(t),n||i)return e===t;if(n=p(e),i=p(t),n||i)return!(!n||!i)&&te(e,t);if(n=E(e),i=E(t),n||i){if(!n||!i)return!1;const r=Object.keys(e).length,s=Object.keys(t).length;if(r!==s)return!1;for(const n in e){const i=e.hasOwnProperty(n),r=t.hasOwnProperty(n);if(i&&!r||!i&&r||!ne(e[n],t[n]))return!1}}return String(e)===String(t)}function ie(e,t){return e.findIndex(e=>ne(e,t))}const re=e=>!(!e||!0!==e["__v_isRef"]),se=e=>T(e)?e:null==e?"":p(e)||E(e)&&(e.toString===A||!b(e.toString))?re(e)?se(e.value):JSON.stringify(e,ae,2):String(e),ae=(e,t)=>re(t)?ae(e,t.value):g(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[t,n],i)=>(e[oe(t,i)+" =>"]=n,e),{})}:m(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>oe(e))}:S(t)?oe(t):!E(t)||p(t)||k(t)?t:String(t),oe=(e,t="")=>{var n;return S(e)?`Symbol(${null!=(n=e.description)?n:t})`:e}},4270:function(e,t,n){"use strict";var i=n(9565),r=n(4901),s=n(34),a=TypeError;e.exports=function(e,t){var n,o;if("string"===t&&r(n=e.toString)&&!s(o=i(n,e)))return o;if(r(n=e.valueOf)&&!s(o=i(n,e)))return o;if("string"!==t&&r(n=e.toString)&&!s(o=i(n,e)))return o;throw new a("Can't convert object to primitive value")}},4373:function(e,t,n){"use strict";n.d(t,{A:function(){return yn}});var i={};n.r(i),n.d(i,{hasBrowserEnv:function(){return Ue},hasStandardBrowserEnv:function(){return Be},hasStandardBrowserWebWorkerEnv:function(){return je},navigator:function(){return Fe},origin:function(){return $e}});n(4114),n(8111),n(7588),n(9577),n(9848);function r(e,t){return function(){return e.apply(t,arguments)}}const{toString:s}=Object.prototype,{getPrototypeOf:a}=Object,{iterator:o,toStringTag:u}=Symbol,l=(e=>t=>{const n=s.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),c=e=>(e=e.toLowerCase(),t=>l(t)===e),d=e=>t=>typeof t===e,{isArray:h}=Array,f=d("undefined");function p(e){return null!==e&&!f(e)&&null!==e.constructor&&!f(e.constructor)&&y(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const g=c("ArrayBuffer");function m(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&g(e.buffer),t}const v=d("string"),y=d("function"),b=d("number"),T=e=>null!==e&&"object"===typeof e,S=e=>!0===e||!1===e,E=e=>{if("object"!==l(e))return!1;const t=a(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(u in e)&&!(o in e)},w=c("Date"),A=c("File"),x=c("Blob"),I=c("FileList"),k=e=>T(e)&&y(e.pipe),L=e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||y(e.append)&&("formdata"===(t=l(e))||"object"===t&&y(e.toString)&&"[object FormData]"===e.toString()))},R=c("URLSearchParams"),[C,D,M,P]=["ReadableStream","Request","Response","Headers"].map(c),_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function O(e,t,{allOwnKeys:n=!1}={}){if(null===e||"undefined"===typeof e)return;let i,r;if("object"!==typeof e&&(e=[e]),h(e))for(i=0,r=e.length;i<r;i++)t.call(null,e[i],i,e);else{const r=n?Object.getOwnPropertyNames(e):Object.keys(e),s=r.length;let a;for(i=0;i<s;i++)a=r[i],t.call(null,e[a],a,e)}}function N(e,t){t=t.toLowerCase();const n=Object.keys(e);let i,r=n.length;while(r-- >0)if(i=n[r],t===i.toLowerCase())return i;return null}const U=(()=>"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global)(),F=e=>!f(e)&&e!==U;function B(){const{caseless:e}=F(this)&&this||{},t={},n=(n,i)=>{const r=e&&N(t,i)||i;E(t[r])&&E(n)?t[r]=B(t[r],n):E(n)?t[r]=B({},n):h(n)?t[r]=n.slice():t[r]=n};for(let i=0,r=arguments.length;i<r;i++)arguments[i]&&O(arguments[i],n);return t}const j=(e,t,n,{allOwnKeys:i}={})=>(O(t,(t,i)=>{n&&y(t)?e[i]=r(t,n):e[i]=t},{allOwnKeys:i}),e),$=e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),G=(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},V=(e,t,n,i)=>{let r,s,o;const u={};if(t=t||{},null==e)return t;do{r=Object.getOwnPropertyNames(e),s=r.length;while(s-- >0)o=r[s],i&&!i(o,e,t)||u[o]||(t[o]=e[o],u[o]=!0);e=!1!==n&&a(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},H=(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return-1!==i&&i===n},K=e=>{if(!e)return null;if(h(e))return e;let t=e.length;if(!b(t))return null;const n=new Array(t);while(t-- >0)n[t]=e[t];return n},W=(e=>t=>e&&t instanceof e)("undefined"!==typeof Uint8Array&&a(Uint8Array)),q=(e,t)=>{const n=e&&e[o],i=n.call(e);let r;while((r=i.next())&&!r.done){const n=r.value;t.call(e,n[0],n[1])}},Y=(e,t)=>{let n;const i=[];while(null!==(n=e.exec(t)))i.push(n);return i},z=c("HTMLFormElement"),X=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,n){return t.toUpperCase()+n}),Q=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),J=c("RegExp"),Z=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};O(n,(n,r)=>{let s;!1!==(s=t(n,r,e))&&(i[r]=s||n)}),Object.defineProperties(e,i)},ee=e=>{Z(e,(t,n)=>{if(y(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=e[n];y(i)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},te=(e,t)=>{const n={},i=e=>{e.forEach(e=>{n[e]=!0})};return h(e)?i(e):i(String(e).split(t)),n},ne=()=>{},ie=(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t;function re(e){return!!(e&&y(e.append)&&"FormData"===e[u]&&e[o])}const se=e=>{const t=new Array(10),n=(e,i)=>{if(T(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[i]=e;const r=h(e)?[]:{};return O(e,(e,t)=>{const s=n(e,i+1);!f(s)&&(r[t]=s)}),t[i]=void 0,r}}return e};return n(e,0)},ae=c("AsyncFunction"),oe=e=>e&&(T(e)||y(e))&&y(e.then)&&y(e.catch),ue=((e,t)=>e?setImmediate:t?((e,t)=>(U.addEventListener("message",({source:n,data:i})=>{n===U&&i===e&&t.length&&t.shift()()},!1),n=>{t.push(n),U.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))("function"===typeof setImmediate,y(U.postMessage)),le="undefined"!==typeof queueMicrotask?queueMicrotask.bind(U):"undefined"!==typeof process&&process.nextTick||ue,ce=e=>null!=e&&y(e[o]);var de={isArray:h,isArrayBuffer:g,isBuffer:p,isFormData:L,isArrayBufferView:m,isString:v,isNumber:b,isBoolean:S,isObject:T,isPlainObject:E,isReadableStream:C,isRequest:D,isResponse:M,isHeaders:P,isUndefined:f,isDate:w,isFile:A,isBlob:x,isRegExp:J,isFunction:y,isStream:k,isURLSearchParams:R,isTypedArray:W,isFileList:I,forEach:O,merge:B,extend:j,trim:_,stripBOM:$,inherits:G,toFlatObject:V,kindOf:l,kindOfTest:c,endsWith:H,toArray:K,forEachEntry:q,matchAll:Y,isHTMLForm:z,hasOwnProperty:Q,hasOwnProp:Q,reduceDescriptors:Z,freezeMethods:ee,toObjectSet:te,toCamelCase:X,noop:ne,toFiniteNumber:ie,findKey:N,global:U,isContextDefined:F,isSpecCompliantForm:re,toJSONObject:se,isAsyncFn:ae,isThenable:oe,setImmediate:ue,asap:le,isIterable:ce};n(1701),n(3579),n(1806);function he(e,t,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}de.inherits(he,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:de.toJSONObject(this.config),code:this.code,status:this.status}}});const fe=he.prototype,pe={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{pe[e]={value:e}}),Object.defineProperties(he,pe),Object.defineProperty(fe,"isAxiosError",{value:!0}),he.from=(e,t,n,i,r,s)=>{const a=Object.create(fe);return de.toFlatObject(e,a,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e),he.call(a,e.message,t,n,i,r),a.cause=e,a.name=e.name,s&&Object.assign(a,s),a};var ge=he,me=null;function ve(e){return de.isPlainObject(e)||de.isArray(e)}function ye(e){return de.endsWith(e,"[]")?e.slice(0,-2):e}function be(e,t,n){return e?e.concat(t).map(function(e,t){return e=ye(e),!n&&t?"["+e+"]":e}).join(n?".":""):t}function Te(e){return de.isArray(e)&&!e.some(ve)}const Se=de.toFlatObject(de,{},null,function(e){return/^is[A-Z]/.test(e)});function Ee(e,t,n){if(!de.isObject(e))throw new TypeError("target must be an object");t=t||new(me||FormData),n=de.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!de.isUndefined(t[e])});const i=n.metaTokens,r=n.visitor||c,s=n.dots,a=n.indexes,o=n.Blob||"undefined"!==typeof Blob&&Blob,u=o&&de.isSpecCompliantForm(t);if(!de.isFunction(r))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(de.isDate(e))return e.toISOString();if(de.isBoolean(e))return e.toString();if(!u&&de.isBlob(e))throw new ge("Blob is not supported. Use a Buffer instead.");return de.isArrayBuffer(e)||de.isTypedArray(e)?u&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,r){let o=e;if(e&&!r&&"object"===typeof e)if(de.endsWith(n,"{}"))n=i?n:n.slice(0,-2),e=JSON.stringify(e);else if(de.isArray(e)&&Te(e)||(de.isFileList(e)||de.endsWith(n,"[]"))&&(o=de.toArray(e)))return n=ye(n),o.forEach(function(e,i){!de.isUndefined(e)&&null!==e&&t.append(!0===a?be([n],i,s):null===a?n:n+"[]",l(e))}),!1;return!!ve(e)||(t.append(be(r,n,s),l(e)),!1)}const d=[],h=Object.assign(Se,{defaultVisitor:c,convertValue:l,isVisitable:ve});function f(e,n){if(!de.isUndefined(e)){if(-1!==d.indexOf(e))throw Error("Circular reference detected in "+n.join("."));d.push(e),de.forEach(e,function(e,i){const s=!(de.isUndefined(e)||null===e)&&r.call(t,e,de.isString(i)?i.trim():i,n,h);!0===s&&f(e,n?n.concat(i):[i])}),d.pop()}}if(!de.isObject(e))throw new TypeError("data must be an object");return f(e),t}var we=Ee;function Ae(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function xe(e,t){this._pairs=[],e&&we(e,this,t)}const Ie=xe.prototype;Ie.append=function(e,t){this._pairs.push([e,t])},Ie.toString=function(e){const t=e?function(t){return e.call(this,t,Ae)}:Ae;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};var ke=xe;function Le(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Re(e,t,n){if(!t)return e;const i=n&&n.encode||Le;de.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let s;if(s=r?r(t,n):de.isURLSearchParams(t)?t.toString():new ke(t,n).toString(i),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}class Ce{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){de.forEach(this.handlers,function(t){null!==t&&e(t)})}}var De=Ce,Me={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Pe="undefined"!==typeof URLSearchParams?URLSearchParams:ke,_e="undefined"!==typeof FormData?FormData:null,Oe="undefined"!==typeof Blob?Blob:null,Ne={isBrowser:!0,classes:{URLSearchParams:Pe,FormData:_e,Blob:Oe},protocols:["http","https","file","blob","url","data"]};const Ue="undefined"!==typeof window&&"undefined"!==typeof document,Fe="object"===typeof navigator&&navigator||void 0,Be=Ue&&(!Fe||["ReactNative","NativeScript","NS"].indexOf(Fe.product)<0),je=(()=>"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts)(),$e=Ue&&window.location.href||"http://localhost";var Ge={...i,...Ne};function Ve(e,t){return we(e,new Ge.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,i){return Ge.isNode&&de.isBuffer(e)?(this.append(t,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function He(e){return de.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}function Ke(e){const t={},n=Object.keys(e);let i;const r=n.length;let s;for(i=0;i<r;i++)s=n[i],t[s]=e[s];return t}function We(e){function t(e,n,i,r){let s=e[r++];if("__proto__"===s)return!0;const a=Number.isFinite(+s),o=r>=e.length;if(s=!s&&de.isArray(i)?i.length:s,o)return de.hasOwnProp(i,s)?i[s]=[i[s],n]:i[s]=n,!a;i[s]&&de.isObject(i[s])||(i[s]=[]);const u=t(e,n,i[s],r);return u&&de.isArray(i[s])&&(i[s]=Ke(i[s])),!a}if(de.isFormData(e)&&de.isFunction(e.entries)){const n={};return de.forEachEntry(e,(e,i)=>{t(He(e),i,n,0)}),n}return null}var qe=We;function Ye(e,t,n){if(de.isString(e))try{return(t||JSON.parse)(e),de.trim(e)}catch(i){if("SyntaxError"!==i.name)throw i}return(n||JSON.stringify)(e)}const ze={transitional:Me,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,r=de.isObject(e);r&&de.isHTMLForm(e)&&(e=new FormData(e));const s=de.isFormData(e);if(s)return i?JSON.stringify(qe(e)):e;if(de.isArrayBuffer(e)||de.isBuffer(e)||de.isStream(e)||de.isFile(e)||de.isBlob(e)||de.isReadableStream(e))return e;if(de.isArrayBufferView(e))return e.buffer;if(de.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Ve(e,this.formSerializer).toString();if((a=de.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return we(a?{"files[]":e}:e,t&&new t,this.formSerializer)}}return r||i?(t.setContentType("application/json",!1),Ye(e)):e}],transformResponse:[function(e){const t=this.transitional||ze.transitional,n=t&&t.forcedJSONParsing,i="json"===this.responseType;if(de.isResponse(e)||de.isReadableStream(e))return e;if(e&&de.isString(e)&&(n&&!this.responseType||i)){const n=t&&t.silentJSONParsing,s=!n&&i;try{return JSON.parse(e)}catch(r){if(s){if("SyntaxError"===r.name)throw ge.from(r,ge.ERR_BAD_RESPONSE,this,null,this.response);throw r}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ge.classes.FormData,Blob:Ge.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};de.forEach(["delete","get","head","post","put","patch"],e=>{ze.headers[e]={}});var Xe=ze;const Qe=de.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);var Je=e=>{const t={};let n,i,r;return e&&e.split("\n").forEach(function(e){r=e.indexOf(":"),n=e.substring(0,r).trim().toLowerCase(),i=e.substring(r+1).trim(),!n||t[n]&&Qe[n]||("set-cookie"===n?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)}),t};const Ze=Symbol("internals");function et(e){return e&&String(e).trim().toLowerCase()}function tt(e){return!1===e||null==e?e:de.isArray(e)?e.map(tt):String(e)}function nt(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;while(i=n.exec(e))t[i[1]]=i[2];return t}const it=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function rt(e,t,n,i,r){return de.isFunction(i)?i.call(this,t,n):(r&&(t=n),de.isString(t)?de.isString(i)?-1!==t.indexOf(i):de.isRegExp(i)?i.test(t):void 0:void 0)}function st(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}function at(e,t){const n=de.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+n,{value:function(e,n,r){return this[i].call(this,t,e,n,r)},configurable:!0})})}class ot{constructor(e){e&&this.set(e)}set(e,t,n){const i=this;function r(e,t,n){const r=et(t);if(!r)throw new Error("header name must be a non-empty string");const s=de.findKey(i,r);(!s||void 0===i[s]||!0===n||void 0===n&&!1!==i[s])&&(i[s||t]=tt(e))}const s=(e,t)=>de.forEach(e,(e,n)=>r(e,n,t));if(de.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(de.isString(e)&&(e=e.trim())&&!it(e))s(Je(e),t);else if(de.isObject(e)&&de.isIterable(e)){let n,i,r={};for(const t of e){if(!de.isArray(t))throw TypeError("Object iterator must return a key-value pair");r[i=t[0]]=(n=r[i])?de.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}s(r,t)}else null!=e&&r(t,e,n);return this}get(e,t){if(e=et(e),e){const n=de.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return nt(e);if(de.isFunction(t))return t.call(this,e,n);if(de.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=et(e),e){const n=de.findKey(this,e);return!(!n||void 0===this[n]||t&&!rt(this,this[n],n,t))}return!1}delete(e,t){const n=this;let i=!1;function r(e){if(e=et(e),e){const r=de.findKey(n,e);!r||t&&!rt(n,n[r],r,t)||(delete n[r],i=!0)}}return de.isArray(e)?e.forEach(r):r(e),i}clear(e){const t=Object.keys(this);let n=t.length,i=!1;while(n--){const r=t[n];e&&!rt(this,this[r],r,e,!0)||(delete this[r],i=!0)}return i}normalize(e){const t=this,n={};return de.forEach(this,(i,r)=>{const s=de.findKey(n,r);if(s)return t[s]=tt(i),void delete t[r];const a=e?st(r):String(r).trim();a!==r&&delete t[r],t[a]=tt(i),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return de.forEach(this,(n,i)=>{null!=n&&!1!==n&&(t[i]=e&&de.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(e=>n.set(e)),n}static accessor(e){const t=this[Ze]=this[Ze]={accessors:{}},n=t.accessors,i=this.prototype;function r(e){const t=et(e);n[t]||(at(i,e),n[t]=!0)}return de.isArray(e)?e.forEach(r):r(e),this}}ot.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),de.reduceDescriptors(ot.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}}),de.freezeMethods(ot);var ut=ot;function lt(e,t){const n=this||Xe,i=t||n,r=ut.from(i.headers);let s=i.data;return de.forEach(e,function(e){s=e.call(n,s,r.normalize(),t?t.status:void 0)}),r.normalize(),s}function ct(e){return!(!e||!e.__CANCEL__)}function dt(e,t,n){ge.call(this,null==e?"canceled":e,ge.ERR_CANCELED,t,n),this.name="CanceledError"}de.inherits(dt,ge,{__CANCEL__:!0});var ht=dt;function ft(e,t,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(new ge("Request failed with status code "+n.status,[ge.ERR_BAD_REQUEST,ge.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}function pt(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function gt(e,t){e=e||10;const n=new Array(e),i=new Array(e);let r,s=0,a=0;return t=void 0!==t?t:1e3,function(o){const u=Date.now(),l=i[a];r||(r=u),n[s]=o,i[s]=u;let c=a,d=0;while(c!==s)d+=n[c++],c%=e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),u-r<t)return;const h=l&&u-l;return h?Math.round(1e3*d/h):void 0}}var mt=gt;function vt(e,t){let n,i,r=0,s=1e3/t;const a=(t,s=Date.now())=>{r=s,n=null,i&&(clearTimeout(i),i=null),e.apply(null,t)},o=(...e)=>{const t=Date.now(),o=t-r;o>=s?a(e,t):(n=e,i||(i=setTimeout(()=>{i=null,a(n)},s-o)))},u=()=>n&&a(n);return[o,u]}var yt=vt;const bt=(e,t,n=3)=>{let i=0;const r=mt(50,250);return yt(n=>{const s=n.loaded,a=n.lengthComputable?n.total:void 0,o=s-i,u=r(o),l=s<=a;i=s;const c={loaded:s,total:a,progress:a?s/a:void 0,bytes:o,rate:u||void 0,estimated:u&&a&&l?(a-s)/u:void 0,event:n,lengthComputable:null!=a,[t?"download":"upload"]:!0};e(c)},n)},Tt=(e,t)=>{const n=null!=e;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},St=e=>(...t)=>de.asap(()=>e(...t));n(2489),n(4979);var Et=Ge.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Ge.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Ge.origin),Ge.navigator&&/(msie|trident)/i.test(Ge.navigator.userAgent)):()=>!0,wt=Ge.hasStandardBrowserEnv?{write(e,t,n,i,r,s){const a=[e+"="+encodeURIComponent(t)];de.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),de.isString(i)&&a.push("path="+i),de.isString(r)&&a.push("domain="+r),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function At(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function xt(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function It(e,t,n){let i=!At(t);return e&&(i||0==n)?xt(e,t):t}const kt=e=>e instanceof ut?{...e}:e;function Lt(e,t){t=t||{};const n={};function i(e,t,n,i){return de.isPlainObject(e)&&de.isPlainObject(t)?de.merge.call({caseless:i},e,t):de.isPlainObject(t)?de.merge({},t):de.isArray(t)?t.slice():t}function r(e,t,n,r){return de.isUndefined(t)?de.isUndefined(e)?void 0:i(void 0,e,n,r):i(e,t,n,r)}function s(e,t){if(!de.isUndefined(t))return i(void 0,t)}function a(e,t){return de.isUndefined(t)?de.isUndefined(e)?void 0:i(void 0,e):i(void 0,t)}function o(n,r,s){return s in t?i(n,r):s in e?i(void 0,n):void 0}const u={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(e,t,n)=>r(kt(e),kt(t),n,!0)};return de.forEach(Object.keys(Object.assign({},e,t)),function(i){const s=u[i]||r,a=s(e[i],t[i],i);de.isUndefined(a)&&s!==o||(n[i]=a)}),n}var Rt=e=>{const t=Lt({},e);let n,{data:i,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:a,headers:o,auth:u}=t;if(t.headers=o=ut.from(o),t.url=Re(It(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),de.isFormData(i))if(Ge.hasStandardBrowserEnv||Ge.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(!1!==(n=o.getContentType())){const[e,...t]=n?n.split(";").map(e=>e.trim()).filter(Boolean):[];o.setContentType([e||"multipart/form-data",...t].join("; "))}if(Ge.hasStandardBrowserEnv&&(r&&de.isFunction(r)&&(r=r(t)),r||!1!==r&&Et(t.url))){const e=s&&a&&wt.read(a);e&&o.set(s,e)}return t};const Ct="undefined"!==typeof XMLHttpRequest;var Dt=Ct&&function(e){return new Promise(function(t,n){const i=Rt(e);let r=i.data;const s=ut.from(i.headers).normalize();let a,o,u,l,c,{responseType:d,onUploadProgress:h,onDownloadProgress:f}=i;function p(){l&&l(),c&&c(),i.cancelToken&&i.cancelToken.unsubscribe(a),i.signal&&i.signal.removeEventListener("abort",a)}let g=new XMLHttpRequest;function m(){if(!g)return;const i=ut.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),r=d&&"text"!==d&&"json"!==d?g.response:g.responseText,s={data:r,status:g.status,statusText:g.statusText,headers:i,config:e,request:g};ft(function(e){t(e),p()},function(e){n(e),p()},s),g=null}g.open(i.method.toUpperCase(),i.url,!0),g.timeout=i.timeout,"onloadend"in g?g.onloadend=m:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(m)},g.onabort=function(){g&&(n(new ge("Request aborted",ge.ECONNABORTED,e,g)),g=null)},g.onerror=function(){n(new ge("Network Error",ge.ERR_NETWORK,e,g)),g=null},g.ontimeout=function(){let t=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const r=i.transitional||Me;i.timeoutErrorMessage&&(t=i.timeoutErrorMessage),n(new ge(t,r.clarifyTimeoutError?ge.ETIMEDOUT:ge.ECONNABORTED,e,g)),g=null},void 0===r&&s.setContentType(null),"setRequestHeader"in g&&de.forEach(s.toJSON(),function(e,t){g.setRequestHeader(t,e)}),de.isUndefined(i.withCredentials)||(g.withCredentials=!!i.withCredentials),d&&"json"!==d&&(g.responseType=i.responseType),f&&([u,c]=bt(f,!0),g.addEventListener("progress",u)),h&&g.upload&&([o,l]=bt(h),g.upload.addEventListener("progress",o),g.upload.addEventListener("loadend",l)),(i.cancelToken||i.signal)&&(a=t=>{g&&(n(!t||t.type?new ht(null,e,g):t),g.abort(),g=null)},i.cancelToken&&i.cancelToken.subscribe(a),i.signal&&(i.signal.aborted?a():i.signal.addEventListener("abort",a)));const v=pt(i.url);v&&-1===Ge.protocols.indexOf(v)?n(new ge("Unsupported protocol "+v+":",ge.ERR_BAD_REQUEST,e)):g.send(r||null)})};const Mt=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,i=new AbortController;const r=function(e){if(!n){n=!0,a();const t=e instanceof Error?e:this.reason;i.abort(t instanceof ge?t:new ht(t instanceof Error?t.message:t))}};let s=t&&setTimeout(()=>{s=null,r(new ge(`timeout ${t} of ms exceeded`,ge.ETIMEDOUT))},t);const a=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(r):e.removeEventListener("abort",r)}),e=null)};e.forEach(e=>e.addEventListener("abort",r));const{signal:o}=i;return o.unsubscribe=()=>de.asap(a),o}};var Pt=Mt;const _t=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let i,r=0;while(r<n)i=r+t,yield e.slice(r,i),r=i},Ot=async function*(e,t){for await(const n of Nt(e))yield*_t(n,t)},Nt=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}},Ut=(e,t,n,i)=>{const r=Ot(e,t);let s,a=0,o=e=>{s||(s=!0,i&&i(e))};return new ReadableStream({async pull(e){try{const{done:t,value:i}=await r.next();if(t)return o(),void e.close();let s=i.byteLength;if(n){let e=a+=s;n(e)}e.enqueue(new Uint8Array(i))}catch(t){throw o(t),t}},cancel(e){return o(e),r.return()}},{highWaterMark:2})},Ft="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,Bt=Ft&&"function"===typeof ReadableStream,jt=Ft&&("function"===typeof TextEncoder?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),$t=(e,...t)=>{try{return!!e(...t)}catch(n){return!1}},Gt=Bt&&$t(()=>{let e=!1;const t=new Request(Ge.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Vt=65536,Ht=Bt&&$t(()=>de.isReadableStream(new Response("").body)),Kt={stream:Ht&&(e=>e.body)};Ft&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Kt[t]&&(Kt[t]=de.isFunction(e[t])?e=>e[t]():(e,n)=>{throw new ge(`Response type '${t}' is not supported`,ge.ERR_NOT_SUPPORT,n)})})})(new Response);const Wt=async e=>{if(null==e)return 0;if(de.isBlob(e))return e.size;if(de.isSpecCompliantForm(e)){const t=new Request(Ge.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return de.isArrayBufferView(e)||de.isArrayBuffer(e)?e.byteLength:(de.isURLSearchParams(e)&&(e+=""),de.isString(e)?(await jt(e)).byteLength:void 0)},qt=async(e,t)=>{const n=de.toFiniteNumber(e.getContentLength());return null==n?Wt(t):n};var Yt=Ft&&(async e=>{let{url:t,method:n,data:i,signal:r,cancelToken:s,timeout:a,onDownloadProgress:o,onUploadProgress:u,responseType:l,headers:c,withCredentials:d="same-origin",fetchOptions:h}=Rt(e);l=l?(l+"").toLowerCase():"text";let f,p=Pt([r,s&&s.toAbortSignal()],a);const g=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let m;try{if(u&&Gt&&"get"!==n&&"head"!==n&&0!==(m=await qt(c,i))){let e,n=new Request(t,{method:"POST",body:i,duplex:"half"});if(de.isFormData(i)&&(e=n.headers.get("content-type"))&&c.setContentType(e),n.body){const[e,t]=Tt(m,bt(St(u)));i=Ut(n.body,Vt,e,t)}}de.isString(d)||(d=d?"include":"omit");const r="credentials"in Request.prototype;f=new Request(t,{...h,signal:p,method:n.toUpperCase(),headers:c.normalize().toJSON(),body:i,duplex:"half",credentials:r?d:void 0});let s=await fetch(f,h);const a=Ht&&("stream"===l||"response"===l);if(Ht&&(o||a&&g)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=s[t]});const t=de.toFiniteNumber(s.headers.get("content-length")),[n,i]=o&&Tt(t,bt(St(o),!0))||[];s=new Response(Ut(s.body,Vt,n,()=>{i&&i(),g&&g()}),e)}l=l||"text";let v=await Kt[de.findKey(Kt,l)||"text"](s,e);return!a&&g&&g(),await new Promise((t,n)=>{ft(t,n,{data:v,headers:ut.from(s.headers),status:s.status,statusText:s.statusText,config:e,request:f})})}catch(v){if(g&&g(),v&&"TypeError"===v.name&&/Load failed|fetch/i.test(v.message))throw Object.assign(new ge("Network Error",ge.ERR_NETWORK,e,f),{cause:v.cause||v});throw ge.from(v,v&&v.code,e,f)}});const zt={http:me,xhr:Dt,fetch:Yt};de.forEach(zt,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(n){}Object.defineProperty(e,"adapterName",{value:t})}});const Xt=e=>`- ${e}`,Qt=e=>de.isFunction(e)||null===e||!1===e;var Jt={getAdapter:e=>{e=de.isArray(e)?e:[e];const{length:t}=e;let n,i;const r={};for(let s=0;s<t;s++){let t;if(n=e[s],i=n,!Qt(n)&&(i=zt[(t=String(n)).toLowerCase()],void 0===i))throw new ge(`Unknown adapter '${t}'`);if(i)break;r[t||"#"+s]=i}if(!i){const e=Object.entries(r).map(([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build"));let n=t?e.length>1?"since :\n"+e.map(Xt).join("\n"):" "+Xt(e[0]):"as no adapter specified";throw new ge("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return i},adapters:zt};function Zt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ht(null,e)}function en(e){Zt(e),e.headers=ut.from(e.headers),e.data=lt.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);const t=Jt.getAdapter(e.adapter||Xe.adapter);return t(e).then(function(t){return Zt(e),t.data=lt.call(e,e.transformResponse,t),t.headers=ut.from(t.headers),t},function(t){return ct(t)||(Zt(e),t&&t.response&&(t.response.data=lt.call(e,e.transformResponse,t.response),t.response.headers=ut.from(t.response.headers))),Promise.reject(t)})}const tn="1.10.0",nn={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{nn[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const rn={};function sn(e,t,n){if("object"!==typeof e)throw new ge("options must be an object",ge.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let r=i.length;while(r-- >0){const s=i[r],a=t[s];if(a){const t=e[s],n=void 0===t||a(t,s,e);if(!0!==n)throw new ge("option "+s+" must be "+n,ge.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new ge("Unknown option "+s,ge.ERR_BAD_OPTION)}}nn.transitional=function(e,t,n){function i(e,t){return"[Axios v"+tn+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,r,s)=>{if(!1===e)throw new ge(i(r," has been removed"+(t?" in "+t:"")),ge.ERR_DEPRECATED);return t&&!rn[r]&&(rn[r]=!0,console.warn(i(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,s)}},nn.spelling=function(e){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};var an={assertOptions:sn,validators:nn};const on=an.validators;class un{constructor(e){this.defaults=e||{},this.interceptors={request:new De,response:new De}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(i){}}throw n}}_request(e,t){"string"===typeof e?(t=t||{},t.url=e):t=e||{},t=Lt(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:r}=t;void 0!==n&&an.assertOptions(n,{silentJSONParsing:on.transitional(on.boolean),forcedJSONParsing:on.transitional(on.boolean),clarifyTimeoutError:on.transitional(on.boolean)},!1),null!=i&&(de.isFunction(i)?t.paramsSerializer={serialize:i}:an.assertOptions(i,{encode:on.function,serialize:on.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),an.assertOptions(t,{baseUrl:on.spelling("baseURL"),withXsrfToken:on.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=r&&de.merge(r.common,r[t.method]);r&&de.forEach(["delete","get","head","post","put","patch","common"],e=>{delete r[e]}),t.headers=ut.concat(s,r);const a=[];let o=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,a.unshift(e.fulfilled,e.rejected))});const u=[];let l;this.interceptors.response.forEach(function(e){u.push(e.fulfilled,e.rejected)});let c,d=0;if(!o){const e=[en.bind(this),void 0];e.unshift.apply(e,a),e.push.apply(e,u),c=e.length,l=Promise.resolve(t);while(d<c)l=l.then(e[d++],e[d++]);return l}c=a.length;let h=t;d=0;while(d<c){const e=a[d++],t=a[d++];try{h=e(h)}catch(f){t.call(this,f);break}}try{l=en.call(this,h)}catch(f){return Promise.reject(f)}d=0,c=u.length;while(d<c)l=l.then(u[d++],u[d++]);return l}getUri(e){e=Lt(this.defaults,e);const t=It(e.baseURL,e.url,e.allowAbsoluteUrls);return Re(t,e.params,e.paramsSerializer)}}de.forEach(["delete","get","head","options"],function(e){un.prototype[e]=function(t,n){return this.request(Lt(n||{},{method:e,url:t,data:(n||{}).data}))}}),de.forEach(["post","put","patch"],function(e){function t(t){return function(n,i,r){return this.request(Lt(r||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}un.prototype[e]=t(),un.prototype[e+"Form"]=t(!0)});var ln=un;class cn{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;while(t-- >0)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const i=new Promise(e=>{n.subscribe(e),t=e}).then(e);return i.cancel=function(){n.unsubscribe(t)},i},e(function(e,i,r){n.reason||(n.reason=new ht(e,i,r),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;const t=new cn(function(t){e=t});return{token:t,cancel:e}}}var dn=cn;function hn(e){return function(t){return e.apply(null,t)}}function fn(e){return de.isObject(e)&&!0===e.isAxiosError}const pn={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(pn).forEach(([e,t])=>{pn[t]=e});var gn=pn;function mn(e){const t=new ln(e),n=r(ln.prototype.request,t);return de.extend(n,ln.prototype,t,{allOwnKeys:!0}),de.extend(n,t,null,{allOwnKeys:!0}),n.create=function(t){return mn(Lt(e,t))},n}const vn=mn(Xe);vn.Axios=ln,vn.CanceledError=ht,vn.CancelToken=dn,vn.isCancel=ct,vn.VERSION=tn,vn.toFormData=we,vn.AxiosError=ge,vn.Cancel=vn.CanceledError,vn.all=function(e){return Promise.all(e)},vn.spread=hn,vn.isAxiosError=fn,vn.mergeConfig=Lt,vn.AxiosHeaders=ut,vn.formToJSON=e=>qe(de.isHTMLForm(e)?new FormData(e):e),vn.getAdapter=Jt.getAdapter,vn.HttpStatusCode=gn,vn.default=vn;var yn=vn},4376:function(e,t,n){"use strict";var i=n(2195);e.exports=Array.isArray||function(e){return"Array"===i(e)}},4402:function(e,t,n){"use strict";var i=n(9504),r=Set.prototype;e.exports={Set:Set,add:i(r.add),has:i(r.has),remove:i(r["delete"]),proto:r}},4449:function(e,t,n){"use strict";var i=n(7080),r=n(4402).has,s=n(5170),a=n(3789),o=n(8469),u=n(507),l=n(9539);e.exports=function(e){var t=i(this),n=a(e);if(s(t)<=n.size)return!1!==o(t,function(e){if(n.includes(e))return!1},!0);var c=n.getIterator();return!1!==u(c,function(e){if(r(t,e))return l(c,"normal",!1)})}},4495:function(e,t,n){"use strict";var i=n(9519),r=n(9039),s=n(4576),a=s.String;e.exports=!!Object.getOwnPropertySymbols&&!r(function(){var e=Symbol("symbol detection");return!a(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&i&&i<41})},4527:function(e,t,n){"use strict";var i=n(3724),r=n(4376),s=TypeError,a=Object.getOwnPropertyDescriptor,o=i&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=o?function(e,t){if(r(e)&&!a(e,"length").writable)throw new s("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},4549:function(e,t,n){"use strict";var i=n(4576);e.exports=function(e,t){var n=i.Iterator,r=n&&n.prototype,s=r&&r[e],a=!1;if(s)try{s.call({next:function(){return{done:!0}},return:function(){a=!0}},-1)}catch(o){o instanceof t||(a=!1)}if(!a)return s}},4576:function(e,t,n){"use strict";var i=function(e){return e&&e.Math===Math&&e};e.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof n.g&&n.g)||i("object"==typeof this&&this)||function(){return this}()||Function("return this")()},4644:function(e,t,n){"use strict";var i,r,s,a=n(7811),o=n(3724),u=n(4576),l=n(4901),c=n(34),d=n(9297),h=n(6955),f=n(6823),p=n(6699),g=n(6840),m=n(2106),v=n(1625),y=n(2787),b=n(2967),T=n(8227),S=n(3392),E=n(1181),w=E.enforce,A=E.get,x=u.Int8Array,I=x&&x.prototype,k=u.Uint8ClampedArray,L=k&&k.prototype,R=x&&y(x),C=I&&y(I),D=Object.prototype,M=u.TypeError,P=T("toStringTag"),_=S("TYPED_ARRAY_TAG"),O="TypedArrayConstructor",N=a&&!!b&&"Opera"!==h(u.opera),U=!1,F={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},B={BigInt64Array:8,BigUint64Array:8},j=function(e){if(!c(e))return!1;var t=h(e);return"DataView"===t||d(F,t)||d(B,t)},$=function(e){var t=y(e);if(c(t)){var n=A(t);return n&&d(n,O)?n[O]:$(t)}},G=function(e){if(!c(e))return!1;var t=h(e);return d(F,t)||d(B,t)},V=function(e){if(G(e))return e;throw new M("Target is not a typed array")},H=function(e){if(l(e)&&(!b||v(R,e)))return e;throw new M(f(e)+" is not a typed array constructor")},K=function(e,t,n,i){if(o){if(n)for(var r in F){var s=u[r];if(s&&d(s.prototype,e))try{delete s.prototype[e]}catch(a){try{s.prototype[e]=t}catch(l){}}}C[e]&&!n||g(C,e,n?t:N&&I[e]||t,i)}},W=function(e,t,n){var i,r;if(o){if(b){if(n)for(i in F)if(r=u[i],r&&d(r,e))try{delete r[e]}catch(s){}if(R[e]&&!n)return;try{return g(R,e,n?t:N&&R[e]||t)}catch(s){}}for(i in F)r=u[i],!r||r[e]&&!n||g(r,e,t)}};for(i in F)r=u[i],s=r&&r.prototype,s?w(s)[O]=r:N=!1;for(i in B)r=u[i],s=r&&r.prototype,s&&(w(s)[O]=r);if((!N||!l(R)||R===Function.prototype)&&(R=function(){throw new M("Incorrect invocation")},N))for(i in F)u[i]&&b(u[i],R);if((!N||!C||C===D)&&(C=R.prototype,N))for(i in F)u[i]&&b(u[i].prototype,C);if(N&&y(L)!==C&&b(L,C),o&&!d(C,P))for(i in U=!0,m(C,P,{configurable:!0,get:function(){return c(this)?this[_]:void 0}}),F)u[i]&&p(u[i],_,i);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:N,TYPED_ARRAY_TAG:U&&_,aTypedArray:V,aTypedArrayConstructor:H,exportTypedArrayMethod:K,exportTypedArrayStaticMethod:W,getTypedArrayConstructor:$,isView:j,isTypedArray:G,TypedArray:R,TypedArrayPrototype:C}},4659:function(e,t,n){"use strict";var i=n(3724),r=n(4913),s=n(6980);e.exports=function(e,t,n){i?r.f(e,t,s(0,n)):e[t]=n}},4901:function(e){"use strict";var t="object"==typeof document&&document.all;e.exports="undefined"==typeof t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},4913:function(e,t,n){"use strict";var i=n(3724),r=n(5917),s=n(8686),a=n(8551),o=n(6969),u=TypeError,l=Object.defineProperty,c=Object.getOwnPropertyDescriptor,d="enumerable",h="configurable",f="writable";t.f=i?s?function(e,t,n){if(a(e),t=o(t),a(n),"function"===typeof e&&"prototype"===t&&"value"in n&&f in n&&!n[f]){var i=c(e,t);i&&i[f]&&(e[t]=n.value,n={configurable:h in n?n[h]:i[h],enumerable:d in n?n[d]:i[d],writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(a(e),t=o(t),a(n),r)try{return l(e,t,n)}catch(i){}if("get"in n||"set"in n)throw new u("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},4916:function(e,t,n){"use strict";var i=n(7751),r=function(e){return{size:e,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},s=function(e){return{size:e,has:function(){return!0},keys:function(){throw new Error("e")}}};e.exports=function(e,t){var n=i("Set");try{(new n)[e](r(0));try{return(new n)[e](r(-1)),!1}catch(o){if(!t)return!0;try{return(new n)[e](s(-1/0)),!1}catch(u){var a=new n;return a.add(1),a.add(2),t(a[e](s(1/0)))}}}catch(u){return!1}}},4979:function(e,t,n){"use strict";var i=n(6518),r=n(4576),s=n(7751),a=n(6980),o=n(4913).f,u=n(9297),l=n(679),c=n(3167),d=n(2603),h=n(5002),f=n(8574),p=n(3724),g=n(6395),m="DOMException",v=s("Error"),y=s(m),b=function(){l(this,T);var e=arguments.length,t=d(e<1?void 0:arguments[0]),n=d(e<2?void 0:arguments[1],"Error"),i=new y(t,n),r=new v(t);return r.name=m,o(i,"stack",a(1,f(r.stack,1))),c(i,this,b),i},T=b.prototype=y.prototype,S="stack"in new v(m),E="stack"in new y(1,2),w=y&&p&&Object.getOwnPropertyDescriptor(r,m),A=!!w&&!(w.writable&&w.configurable),x=S&&!A&&!E;i({global:!0,constructor:!0,forced:g||x},{DOMException:x?b:y});var I=s(m),k=I.prototype;if(k.constructor!==I)for(var L in g||o(k,"constructor",a(1,I)),h)if(u(h,L)){var R=h[L],C=R.s;u(I,C)||o(I,C,a(6,R.c))}},5002:function(e){"use strict";e.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},5024:function(e,t,n){"use strict";var i=n(6518),r=n(3650),s=n(9835),a=n(4916),o=!a("symmetricDifference")||!s("symmetricDifference");i({target:"Set",proto:!0,real:!0,forced:o},{symmetricDifference:r})},5031:function(e,t,n){"use strict";var i=n(7751),r=n(9504),s=n(8480),a=n(3717),o=n(8551),u=r([].concat);e.exports=i("Reflect","ownKeys")||function(e){var t=s.f(o(e)),n=a.f;return n?u(t,n(e)):t}},5130:function(e,t,n){"use strict";n.d(t,{D$:function(){return we},Ef:function(){return ke},Jo:function(){return pe},aG:function(){return U},eB:function(){return b},lH:function(){return ge},u1:function(){return ve}});n(4114),n(8111),n(2489),n(7588),n(1701),n(3579),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698);var i=n(6768),r=n(4232);n(144);
/**
* @vue/runtime-dom v3.5.16
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/
let s;const a="undefined"!==typeof window&&window.trustedTypes;if(a)try{s=a.createPolicy("vue",{createHTML:e=>e})}catch(Ce){}const o=s?e=>s.createHTML(e):e=>e,u="http://www.w3.org/2000/svg",l="http://www.w3.org/1998/Math/MathML",c="undefined"!==typeof document?document:null,d=c&&c.createElement("template"),h={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const r="svg"===t?c.createElementNS(u,e):"mathml"===t?c.createElementNS(l,e):n?c.createElement(e,{is:n}):c.createElement(e);return"select"===e&&i&&null!=i.multiple&&r.setAttribute("multiple",i.multiple),r},createText:e=>c.createTextNode(e),createComment:e=>c.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>c.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,i,r,s){const a=n?n.previousSibling:t.lastChild;if(r&&(r===s||r.nextSibling)){while(1)if(t.insertBefore(r.cloneNode(!0),n),r===s||!(r=r.nextSibling))break}else{d.innerHTML=o("svg"===i?`<svg>${e}</svg>`:"mathml"===i?`<math>${e}</math>`:e);const r=d.content;if("svg"===i||"mathml"===i){const e=r.firstChild;while(e.firstChild)r.appendChild(e.firstChild);r.removeChild(e)}t.insertBefore(r,n)}return[a?a.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},f="transition",p="animation",g=Symbol("_vtc"),m={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},v=(0,r.X$)({},i.QP,m),y=e=>(e.displayName="Transition",e.props=v,e),b=y((e,{slots:t})=>(0,i.h)(i.pR,E(e),t)),T=(e,t=[])=>{(0,r.cy)(e)?e.forEach(e=>e(...t)):e&&e(...t)},S=e=>!!e&&((0,r.cy)(e)?e.some(e=>e.length>1):e.length>1);function E(e){const t={};for(const r in e)r in m||(t[r]=e[r]);if(!1===e.css)return t;const{name:n="v",type:i,duration:s,enterFromClass:a=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:u=`${n}-enter-to`,appearFromClass:l=a,appearActiveClass:c=o,appearToClass:d=u,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:f=`${n}-leave-active`,leaveToClass:p=`${n}-leave-to`}=e,g=w(s),v=g&&g[0],y=g&&g[1],{onBeforeEnter:b,onEnter:E,onEnterCancelled:A,onLeave:L,onLeaveCancelled:C,onBeforeAppear:D=b,onAppear:M=E,onAppearCancelled:_=A}=t,O=(e,t,n,i)=>{e._enterCancelled=i,I(e,t?d:u),I(e,t?c:o),n&&n()},N=(e,t)=>{e._isLeaving=!1,I(e,h),I(e,p),I(e,f),t&&t()},U=e=>(t,n)=>{const r=e?M:E,s=()=>O(t,e,n);T(r,[t,s]),k(()=>{I(t,e?l:a),x(t,e?d:u),S(r)||R(t,i,v,s)})};return(0,r.X$)(t,{onBeforeEnter(e){T(b,[e]),x(e,a),x(e,o)},onBeforeAppear(e){T(D,[e]),x(e,l),x(e,c)},onEnter:U(!1),onAppear:U(!0),onLeave(e,t){e._isLeaving=!0;const n=()=>N(e,t);x(e,h),e._enterCancelled?(x(e,f),P()):(P(),x(e,f)),k(()=>{e._isLeaving&&(I(e,h),x(e,p),S(L)||R(e,i,y,n))}),T(L,[e,n])},onEnterCancelled(e){O(e,!1,void 0,!0),T(A,[e])},onAppearCancelled(e){O(e,!0,void 0,!0),T(_,[e])},onLeaveCancelled(e){N(e),T(C,[e])}})}function w(e){if(null==e)return null;if((0,r.Gv)(e))return[A(e.enter),A(e.leave)];{const t=A(e);return[t,t]}}function A(e){const t=(0,r.Ro)(e);return t}function x(e,t){t.split(/\s+/).forEach(t=>t&&e.classList.add(t)),(e[g]||(e[g]=new Set)).add(t)}function I(e,t){t.split(/\s+/).forEach(t=>t&&e.classList.remove(t));const n=e[g];n&&(n.delete(t),n.size||(e[g]=void 0))}function k(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let L=0;function R(e,t,n,i){const r=e._endId=++L,s=()=>{r===e._endId&&i()};if(null!=n)return setTimeout(s,n);const{type:a,timeout:o,propCount:u}=C(e,t);if(!a)return i();const l=a+"end";let c=0;const d=()=>{e.removeEventListener(l,h),s()},h=t=>{t.target===e&&++c>=u&&d()};setTimeout(()=>{c<u&&d()},o+1),e.addEventListener(l,h)}function C(e,t){const n=window.getComputedStyle(e),i=e=>(n[e]||"").split(", "),r=i(`${f}Delay`),s=i(`${f}Duration`),a=D(r,s),o=i(`${p}Delay`),u=i(`${p}Duration`),l=D(o,u);let c=null,d=0,h=0;t===f?a>0&&(c=f,d=a,h=s.length):t===p?l>0&&(c=p,d=l,h=u.length):(d=Math.max(a,l),c=d>0?a>l?f:p:null,h=c?c===f?s.length:u.length:0);const g=c===f&&/\b(transform|all)(,|$)/.test(i(`${f}Property`).toString());return{type:c,timeout:d,propCount:h,hasTransform:g}}function D(e,t){while(e.length<t.length)e=e.concat(e);return Math.max(...t.map((t,n)=>M(t)+M(e[n])))}function M(e){return"auto"===e?0:1e3*Number(e.slice(0,-1).replace(",","."))}function P(){return document.body.offsetHeight}function _(e,t,n){const i=e[g];i&&(t=(t?[t,...i]:[...i]).join(" ")),null==t?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const O=Symbol("_vod"),N=Symbol("_vsh"),U={beforeMount(e,{value:t},{transition:n}){e[O]="none"===e.style.display?"":e.style.display,n&&t?n.beforeEnter(e):F(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:i}){!t!==!n&&(i?t?(i.beforeEnter(e),F(e,!0),i.enter(e)):i.leave(e,()=>{F(e,!1)}):F(e,t))},beforeUnmount(e,{value:t}){F(e,t)}};function F(e,t){e.style.display=t?e[O]:"none",e[N]=!t}const B=Symbol("");const j=/(^|;)\s*display\s*:/;function $(e,t,n){const i=e.style,s=(0,r.Kg)(n);let a=!1;if(n&&!s){if(t)if((0,r.Kg)(t))for(const e of t.split(";")){const t=e.slice(0,e.indexOf(":")).trim();null==n[t]&&V(i,t,"")}else for(const e in t)null==n[e]&&V(i,e,"");for(const e in n)"display"===e&&(a=!0),V(i,e,n[e])}else if(s){if(t!==n){const e=i[B];e&&(n+=";"+e),i.cssText=n,a=j.test(n)}}else t&&e.removeAttribute("style");O in e&&(e[O]=a?i.display:"",e[N]&&(i.display="none"))}const G=/\s*!important$/;function V(e,t,n){if((0,r.cy)(n))n.forEach(n=>V(e,t,n));else if(null==n&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=W(e,t);G.test(n)?e.setProperty((0,r.Tg)(i),n.replace(G,""),"important"):e[i]=n}}const H=["Webkit","Moz","ms"],K={};function W(e,t){const n=K[t];if(n)return n;let i=(0,r.PT)(t);if("filter"!==i&&i in e)return K[t]=i;i=(0,r.ZH)(i);for(let r=0;r<H.length;r++){const n=H[r]+i;if(n in e)return K[t]=n}return t}const q="http://www.w3.org/1999/xlink";function Y(e,t,n,i,s,a=(0,r.J$)(t)){i&&t.startsWith("xlink:")?null==n?e.removeAttributeNS(q,t.slice(6,t.length)):e.setAttributeNS(q,t,n):null==n||a&&!(0,r.Y2)(n)?e.removeAttribute(t):e.setAttribute(t,a?"":(0,r.Bm)(n)?String(n):n)}function z(e,t,n,i,s){if("innerHTML"===t||"textContent"===t)return void(null!=n&&(e[t]="innerHTML"===t?o(n):n));const a=e.tagName;if("value"===t&&"PROGRESS"!==a&&!a.includes("-")){const i="OPTION"===a?e.getAttribute("value")||"":e.value,r=null==n?"checkbox"===e.type?"on":"":String(n);return i===r&&"_value"in e||(e.value=r),null==n&&e.removeAttribute(t),void(e._value=n)}let u=!1;if(""===n||null==n){const i=typeof e[t];"boolean"===i?n=(0,r.Y2)(n):null==n&&"string"===i?(n="",u=!0):"number"===i&&(n=0,u=!0)}try{e[t]=n}catch(Ce){0}u&&e.removeAttribute(s||t)}function X(e,t,n,i){e.addEventListener(t,n,i)}function Q(e,t,n,i){e.removeEventListener(t,n,i)}const J=Symbol("_vei");function Z(e,t,n,i,r=null){const s=e[J]||(e[J]={}),a=s[t];if(i&&a)a.value=i;else{const[n,o]=te(t);if(i){const a=s[t]=se(i,r);X(e,n,a,o)}else a&&(Q(e,n,a,o),s[t]=void 0)}}const ee=/(?:Once|Passive|Capture)$/;function te(e){let t;if(ee.test(e)){let n;t={};while(n=e.match(ee))e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}const n=":"===e[2]?e.slice(3):(0,r.Tg)(e.slice(2));return[n,t]}let ne=0;const ie=Promise.resolve(),re=()=>ne||(ie.then(()=>ne=0),ne=Date.now());function se(e,t){const n=e=>{if(e._vts){if(e._vts<=n.attached)return}else e._vts=Date.now();(0,i.qL)(ae(e,n.value),t,5,[e])};return n.value=e,n.attached=re(),n}function ae(e,t){if((0,r.cy)(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(e=>t=>!t._stopped&&e&&e(t))}return t}const oe=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,ue=(e,t,n,i,s,a)=>{const o="svg"===s;"class"===t?_(e,i,o):"style"===t?$(e,n,i):(0,r.Mp)(t)?(0,r.CP)(t)||Z(e,t,n,i,a):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):le(e,t,i,o))?(z(e,t,i),e.tagName.includes("-")||"value"!==t&&"checked"!==t&&"selected"!==t||Y(e,t,i,o,a,"value"!==t)):!e._isVueCE||!/[A-Z]/.test(t)&&(0,r.Kg)(i)?("true-value"===t?e._trueValue=i:"false-value"===t&&(e._falseValue=i),Y(e,t,i,o)):z(e,(0,r.PT)(t),i,a,t)};function le(e,t,n,i){if(i)return"innerHTML"===t||"textContent"===t||!!(t in e&&oe(t)&&(0,r.Tn)(n));if("spellcheck"===t||"draggable"===t||"translate"===t||"autocorrect"===t)return!1;if("form"===t)return!1;if("list"===t&&"INPUT"===e.tagName)return!1;if("type"===t&&"TEXTAREA"===e.tagName)return!1;if("width"===t||"height"===t){const t=e.tagName;if("IMG"===t||"VIDEO"===t||"CANVAS"===t||"SOURCE"===t)return!1}return(!oe(t)||!(0,r.Kg)(n))&&t in e}
/*! #__NO_SIDE_EFFECTS__ */
"undefined"!==typeof HTMLElement&&HTMLElement;Symbol("_moveCb"),Symbol("_enterCb");const ce=e=>{const t=e.props["onUpdate:modelValue"]||!1;return(0,r.cy)(t)?e=>(0,r.DY)(t,e):t};function de(e){e.target.composing=!0}function he(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const fe=Symbol("_assign"),pe={created(e,{modifiers:{lazy:t,trim:n,number:i}},s){e[fe]=ce(s);const a=i||s.props&&"number"===s.props.type;X(e,t?"change":"input",t=>{if(t.target.composing)return;let i=e.value;n&&(i=i.trim()),a&&(i=(0,r.bB)(i)),e[fe](i)}),n&&X(e,"change",()=>{e.value=e.value.trim()}),t||(X(e,"compositionstart",de),X(e,"compositionend",he),X(e,"change",he))},mounted(e,{value:t}){e.value=null==t?"":t},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:i,trim:s,number:a}},o){if(e[fe]=ce(o),e.composing)return;const u=!a&&"number"!==e.type||/^0\d/.test(e.value)?e.value:(0,r.bB)(e.value),l=null==t?"":t;if(u!==l){if(document.activeElement===e&&"range"!==e.type){if(i&&t===n)return;if(s&&e.value.trim()===l)return}e.value=l}}},ge={deep:!0,created(e,t,n){e[fe]=ce(n),X(e,"change",()=>{const t=e._modelValue,n=be(e),i=e.checked,s=e[fe];if((0,r.cy)(t)){const e=(0,r.u3)(t,n),a=-1!==e;if(i&&!a)s(t.concat(n));else if(!i&&a){const n=[...t];n.splice(e,1),s(n)}}else if((0,r.vM)(t)){const e=new Set(t);i?e.add(n):e.delete(n),s(e)}else s(Te(e,i))})},mounted:me,beforeUpdate(e,t,n){e[fe]=ce(n),me(e,t,n)}};function me(e,{value:t,oldValue:n},i){let s;if(e._modelValue=t,(0,r.cy)(t))s=(0,r.u3)(t,i.props.value)>-1;else if((0,r.vM)(t))s=t.has(i.props.value);else{if(t===n)return;s=(0,r.BX)(t,Te(e,!0))}e.checked!==s&&(e.checked=s)}const ve={deep:!0,created(e,{value:t,modifiers:{number:n}},s){const a=(0,r.vM)(t);X(e,"change",()=>{const t=Array.prototype.filter.call(e.options,e=>e.selected).map(e=>n?(0,r.bB)(be(e)):be(e));e[fe](e.multiple?a?new Set(t):t:t[0]),e._assigning=!0,(0,i.dY)(()=>{e._assigning=!1})}),e[fe]=ce(s)},mounted(e,{value:t}){ye(e,t)},beforeUpdate(e,t,n){e[fe]=ce(n)},updated(e,{value:t}){e._assigning||ye(e,t)}};function ye(e,t){const n=e.multiple,i=(0,r.cy)(t);if(!n||i||(0,r.vM)(t)){for(let s=0,a=e.options.length;s<a;s++){const a=e.options[s],o=be(a);if(n)if(i){const e=typeof o;a.selected="string"===e||"number"===e?t.some(e=>String(e)===String(o)):(0,r.u3)(t,o)>-1}else a.selected=t.has(o);else if((0,r.BX)(be(a),t))return void(e.selectedIndex!==s&&(e.selectedIndex=s))}n||-1===e.selectedIndex||(e.selectedIndex=-1)}}function be(e){return"_value"in e?e._value:e.value}function Te(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const Se=["ctrl","shift","alt","meta"],Ee={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>Se.some(n=>e[`${n}Key`]&&!t.includes(n))},we=(e,t)=>{const n=e._withMods||(e._withMods={}),i=t.join(".");return n[i]||(n[i]=(n,...i)=>{for(let e=0;e<t.length;e++){const i=Ee[t[e]];if(i&&i(n,t))return}return e(n,...i)})},Ae=(0,r.X$)({patchProp:ue},h);let xe;function Ie(){return xe||(xe=(0,i.K9)(Ae))}const ke=(...e)=>{const t=Ie().createApp(...e);const{mount:n}=t;return t.mount=e=>{const i=Re(e);if(!i)return;const s=t._component;(0,r.Tn)(s)||s.render||s.template||(s.template=i.innerHTML),1===i.nodeType&&(i.textContent="");const a=n(i,!1,Le(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),a},t};function Le(e){return e instanceof SVGElement?"svg":"function"===typeof MathMLElement&&e instanceof MathMLElement?"mathml":void 0}function Re(e){if((0,r.Kg)(e)){const t=document.querySelector(e);return t}return e}},5170:function(e,t,n){"use strict";var i=n(6706),r=n(4402);e.exports=i(r.proto,"size","get")||function(e){return e.size}},5397:function(e,t,n){"use strict";var i=n(7055),r=n(7750);e.exports=function(e){return i(r(e))}},5610:function(e,t,n){"use strict";var i=n(1291),r=Math.max,s=Math.min;e.exports=function(e,t){var n=i(e);return n<0?r(n+t,0):s(n,t)}},5745:function(e,t,n){"use strict";var i=n(7629);e.exports=function(e,t){return i[e]||(i[e]=t||{})}},5808:function(e,t,n){"use strict";n.d(t,{w:function(){return r}});var i=n(2436);function r(e,t){return"function"===typeof e?e(t):e&&"object"===typeof e&&i._P in e?e[i._P](t):e instanceof Date?new e.constructor(t):new Date(t)}},5854:function(e,t,n){"use strict";var i=n(2777),r=TypeError;e.exports=function(e){var t=i(e,"number");if("number"==typeof t)throw new r("Can't convert number to bigint");return BigInt(t)}},5876:function(e,t,n){"use strict";var i=n(6518),r=n(3838),s=n(4916),a=!s("isSubsetOf",function(e){return e});i({target:"Set",proto:!0,real:!0,forced:a},{isSubsetOf:r})},5917:function(e,t,n){"use strict";var i=n(3724),r=n(9039),s=n(4055);e.exports=!i&&!r(function(){return 7!==Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a})},5966:function(e,t,n){"use strict";var i=n(9306),r=n(4117);e.exports=function(e,t){var n=e[t];return r(n)?void 0:i(n)}},6080:function(e,t,n){"use strict";var i=n(7476),r=n(9306),s=n(616),a=i(i.bind);e.exports=function(e,t){return r(e),void 0===t?e:s?a(e,t):function(){return e.apply(t,arguments)}}},6119:function(e,t,n){"use strict";var i=n(5745),r=n(3392),s=i("keys");e.exports=function(e){return s[e]||(s[e]=r(e))}},6193:function(e,t,n){"use strict";var i=n(4215);e.exports="NODE"===i},6198:function(e,t,n){"use strict";var i=n(8014);e.exports=function(e){return i(e.length)}},6269:function(e){"use strict";e.exports={}},6279:function(e,t,n){"use strict";var i=n(6840);e.exports=function(e,t,n){for(var r in t)i(e,r,t[r],n);return e}},6319:function(e,t,n){"use strict";var i=n(8551),r=n(9539);e.exports=function(e,t,n,s){try{return s?t(i(n)[0],n[1]):t(n)}catch(a){r(e,"throw",a)}}},6368:function(e,t,n){"use strict";var i=n(6518),r=n(4576),s=n(9225).clear;i({global:!0,bind:!0,enumerable:!0,forced:r.clearImmediate!==s},{clearImmediate:s})},6395:function(e){"use strict";e.exports=!1},6518:function(e,t,n){"use strict";var i=n(4576),r=n(7347).f,s=n(6699),a=n(6840),o=n(9433),u=n(7740),l=n(2796);e.exports=function(e,t){var n,c,d,h,f,p,g=e.target,m=e.global,v=e.stat;if(c=m?i:v?i[g]||o(g,{}):i[g]&&i[g].prototype,c)for(d in t){if(f=t[d],e.dontCallGetSet?(p=r(c,d),h=p&&p.value):h=c[d],n=l(m?d:g+(v?".":"#")+d,e.forced),!n&&void 0!==h){if(typeof f==typeof h)continue;u(f,h)}(e.sham||h&&h.sham)&&s(f,"sham",!0),a(c,d,f,e)}}},6699:function(e,t,n){"use strict";var i=n(3724),r=n(4913),s=n(6980);e.exports=i?function(e,t,n){return r.f(e,t,s(1,n))}:function(e,t,n){return e[t]=n,e}},6706:function(e,t,n){"use strict";var i=n(9504),r=n(9306);e.exports=function(e,t,n){try{return i(r(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(s){}}},6768:function(e,t,n){"use strict";n.d(t,{$u:function(){return de},CE:function(){return en},Df:function(){return q},EW:function(){return Gn},FK:function(){return Vt},Fv:function(){return fn},Gt:function(){return Ye},Gy:function(){return O},K9:function(){return mt},Lk:function(){return on},MZ:function(){return W},OW:function(){return V},Q3:function(){return pn},QP:function(){return U},WQ:function(){return ze},Wv:function(){return tn},bF:function(){return un},bo:function(){return R},dY:function(){return m},eW:function(){return hn},g2:function(){return be},h:function(){return Vn},hi:function(){return fe},k6:function(){return L},nI:function(){return An},pI:function(){return we},pM:function(){return Y},pR:function(){return $},qL:function(){return a},sV:function(){return le},uX:function(){return zt},v6:function(){return yn},wB:function(){return kt}});n(4114),n(8111),n(1148),n(2489),n(7588),n(1701),n(8237),n(3579),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698);var i=n(144),r=n(4232);function s(e,t,n,i){try{return i?e(...i):e()}catch(r){o(r,t,n)}}function a(e,t,n,i){if((0,r.Tn)(e)){const a=s(e,t,n,i);return a&&(0,r.yL)(a)&&a.catch(e=>{o(e,t,n)}),a}if((0,r.cy)(e)){const r=[];for(let s=0;s<e.length;s++)r.push(a(e[s],t,n,i));return r}}function o(e,t,n,a=!0){const o=t?t.vnode:null,{errorHandler:l,throwUnhandledErrorInProduction:c}=t&&t.appContext.config||r.MZ;if(t){let r=t.parent;const a=t.proxy,o=`https://vuejs.org/error-reference/#runtime-${n}`;while(r){const t=r.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,a,o))return;r=r.parent}if(l)return(0,i.C4)(),s(l,null,10,[e,a,o]),void(0,i.bl)()}u(e,n,o,a,c)}function u(e,t,n,i=!0,r=!1){if(r)throw e;console.error(e)}const l=[];let c=-1;const d=[];let h=null,f=0;const p=Promise.resolve();let g=null;function m(e){const t=g||p;return e?t.then(this?e.bind(this):e):t}function v(e){let t=c+1,n=l.length;while(t<n){const i=t+n>>>1,r=l[i],s=w(r);s<e||s===e&&2&r.flags?t=i+1:n=i}return t}function y(e){if(!(1&e.flags)){const t=w(e),n=l[l.length-1];!n||!(2&e.flags)&&t>=w(n)?l.push(e):l.splice(v(t),0,e),e.flags|=1,b()}}function b(){g||(g=p.then(A))}function T(e){(0,r.cy)(e)?d.push(...e):h&&-1===e.id?h.splice(f+1,0,e):1&e.flags||(d.push(e),e.flags|=1),b()}function S(e,t,n=c+1){for(0;n<l.length;n++){const t=l[n];if(t&&2&t.flags){if(e&&t.id!==e.uid)continue;0,l.splice(n,1),n--,4&t.flags&&(t.flags&=-2),t(),4&t.flags||(t.flags&=-2)}}}function E(e){if(d.length){const e=[...new Set(d)].sort((e,t)=>w(e)-w(t));if(d.length=0,h)return void h.push(...e);for(h=e,f=0;f<h.length;f++){const e=h[f];0,4&e.flags&&(e.flags&=-2),8&e.flags||e(),e.flags&=-2}h=null,f=0}}const w=e=>null==e.id?2&e.flags?-1:1/0:e.id;function A(e){r.tE;try{for(c=0;c<l.length;c++){const e=l[c];!e||8&e.flags||(4&e.flags&&(e.flags&=-2),s(e,e.i,e.i?15:14),4&e.flags||(e.flags&=-2))}}finally{for(;c<l.length;c++){const e=l[c];e&&(e.flags&=-2)}c=-1,l.length=0,E(e),g=null,(l.length||d.length)&&A(e)}}let x=null,I=null;function k(e){const t=x;return x=e,I=e&&e.type.__scopeId||null,t}function L(e,t=x,n){if(!t)return e;if(e._n)return e;const i=(...n)=>{i._d&&Jt(-1);const r=k(t);let s;try{s=e(...n)}finally{k(r),i._d&&Jt(1)}return s};return i._n=!0,i._c=!0,i._d=!0,i}function R(e,t){if(null===x)return e;const n=Bn(x),s=e.dirs||(e.dirs=[]);for(let a=0;a<t.length;a++){let[e,o,u,l=r.MZ]=t[a];e&&((0,r.Tn)(e)&&(e={mounted:e,updated:e}),e.deep&&(0,i.hV)(o),s.push({dir:e,instance:n,value:o,oldValue:void 0,arg:u,modifiers:l}))}return e}function C(e,t,n,r){const s=e.dirs,o=t&&t.dirs;for(let u=0;u<s.length;u++){const l=s[u];o&&(l.oldValue=o[u].value);let c=l.dir[r];c&&((0,i.C4)(),a(c,n,8,[e.el,l,e,t]),(0,i.bl)())}}const D=Symbol("_vte"),M=e=>e.__isTeleport;const P=Symbol("_leaveCb"),_=Symbol("_enterCb");function O(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return le(()=>{e.isMounted=!0}),he(()=>{e.isUnmounting=!0}),e}const N=[Function,Array],U={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:N,onEnter:N,onAfterEnter:N,onEnterCancelled:N,onBeforeLeave:N,onLeave:N,onAfterLeave:N,onLeaveCancelled:N,onBeforeAppear:N,onAppear:N,onAfterAppear:N,onAppearCancelled:N},F=e=>{const t=e.subTree;return t.component?F(t.component):t},B={name:"BaseTransition",props:U,setup(e,{slots:t}){const n=An(),r=O();return()=>{const s=t.default&&q(t.default(),!0);if(!s||!s.length)return;const a=j(s),o=(0,i.ux)(e),{mode:u}=o;if(r.isLeaving)return H(a);const l=K(a);if(!l)return H(a);let c=V(l,o,r,n,e=>c=e);l.type!==Kt&&W(l,c);let d=n.subTree&&K(n.subTree);if(d&&d.type!==Kt&&!rn(l,d)&&F(n).type!==Kt){let e=V(d,o,r,n);if(W(d,e),"out-in"===u&&l.type!==Kt)return r.isLeaving=!0,e.afterLeave=()=>{r.isLeaving=!1,8&n.job.flags||n.update(),delete e.afterLeave,d=void 0},H(a);"in-out"===u&&l.type!==Kt?e.delayLeave=(e,t,n)=>{const i=G(r,d);i[String(d.key)]=d,e[P]=()=>{t(),e[P]=void 0,delete c.delayedLeave,d=void 0},c.delayedLeave=()=>{n(),delete c.delayedLeave,d=void 0}}:d=void 0}else d&&(d=void 0);return a}}};function j(e){let t=e[0];if(e.length>1){let n=!1;for(const i of e)if(i.type!==Kt){0,t=i,n=!0;break}}return t}const $=B;function G(e,t){const{leavingVNodes:n}=e;let i=n.get(t.type);return i||(i=Object.create(null),n.set(t.type,i)),i}function V(e,t,n,i,s){const{appear:o,mode:u,persisted:l=!1,onBeforeEnter:c,onEnter:d,onAfterEnter:h,onEnterCancelled:f,onBeforeLeave:p,onLeave:g,onAfterLeave:m,onLeaveCancelled:v,onBeforeAppear:y,onAppear:b,onAfterAppear:T,onAppearCancelled:S}=t,E=String(e.key),w=G(n,e),A=(e,t)=>{e&&a(e,i,9,t)},x=(e,t)=>{const n=t[1];A(e,t),(0,r.cy)(e)?e.every(e=>e.length<=1)&&n():e.length<=1&&n()},I={mode:u,persisted:l,beforeEnter(t){let i=c;if(!n.isMounted){if(!o)return;i=y||c}t[P]&&t[P](!0);const r=w[E];r&&rn(e,r)&&r.el[P]&&r.el[P](),A(i,[t])},enter(e){let t=d,i=h,r=f;if(!n.isMounted){if(!o)return;t=b||d,i=T||h,r=S||f}let s=!1;const a=e[_]=t=>{s||(s=!0,A(t?r:i,[e]),I.delayedLeave&&I.delayedLeave(),e[_]=void 0)};t?x(t,[e,a]):a()},leave(t,i){const r=String(e.key);if(t[_]&&t[_](!0),n.isUnmounting)return i();A(p,[t]);let s=!1;const a=t[P]=n=>{s||(s=!0,i(),A(n?v:m,[t]),t[P]=void 0,w[r]===e&&delete w[r])};w[r]=e,g?x(g,[t,a]):a()},clone(e){const r=V(e,t,n,i,s);return s&&s(r),r}};return I}function H(e){if(J(e))return e=dn(e),e.children=null,e}function K(e){if(!J(e))return M(e.type)&&e.children?j(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:n}=e;if(n){if(16&t)return n[0];if(32&t&&(0,r.Tn)(n.default))return n.default()}}function W(e,t){6&e.shapeFlag&&e.component?(e.transition=t,W(e.component.subTree,t)):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function q(e,t=!1,n){let i=[],r=0;for(let s=0;s<e.length;s++){let a=e[s];const o=null==n?a.key:String(n)+String(null!=a.key?a.key:s);a.type===Vt?(128&a.patchFlag&&r++,i=i.concat(q(a.children,t,o))):(t||a.type!==Kt)&&i.push(null!=o?dn(a,{key:o}):a)}if(r>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}
/*! #__NO_SIDE_EFFECTS__ */function Y(e,t){return(0,r.Tn)(e)?(()=>(0,r.X$)({name:e.name},t,{setup:e}))():e}function z(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function X(e,t,n,a,o=!1){if((0,r.cy)(e))return void e.forEach((e,i)=>X(e,t&&((0,r.cy)(t)?t[i]:t),n,a,o));if(Q(a)&&!o)return void(512&a.shapeFlag&&a.type.__asyncResolved&&a.component.subTree.component&&X(e,t,n,a.component.subTree));const u=4&a.shapeFlag?Bn(a.component):a.el,l=o?null:u,{i:c,r:d}=e;const h=t&&t.r,f=c.refs===r.MZ?c.refs={}:c.refs,p=c.setupState,g=(0,i.ux)(p),m=p===r.MZ?()=>!1:e=>(0,r.$3)(g,e);if(null!=h&&h!==d&&((0,r.Kg)(h)?(f[h]=null,m(h)&&(p[h]=null)):(0,i.i9)(h)&&(h.value=null)),(0,r.Tn)(d))s(d,c,12,[l,f]);else{const t=(0,r.Kg)(d),s=(0,i.i9)(d);if(t||s){const i=()=>{if(e.f){const n=t?m(d)?p[d]:f[d]:d.value;o?(0,r.cy)(n)&&(0,r.TF)(n,u):(0,r.cy)(n)?n.includes(u)||n.push(u):t?(f[d]=[u],m(d)&&(p[d]=f[d])):(d.value=[u],e.k&&(f[e.k]=d.value))}else t?(f[d]=l,m(d)&&(p[d]=l)):s&&(d.value=l,e.k&&(f[e.k]=l))};l?(i.id=-1,gt(i,n)):i()}else 0}}(0,r.We)().requestIdleCallback,(0,r.We)().cancelIdleCallback;const Q=e=>!!e.type.__asyncLoader;
/*! #__NO_SIDE_EFFECTS__ */const J=e=>e.type.__isKeepAlive;RegExp,RegExp;function Z(e,t){return(0,r.cy)(e)?e.some(e=>Z(e,t)):(0,r.Kg)(e)?e.split(",").includes(t):!!(0,r.gd)(e)&&(e.lastIndex=0,e.test(t))}function ee(e,t){ne(e,"a",t)}function te(e,t){ne(e,"da",t)}function ne(e,t,n=wn){const i=e.__wdc||(e.__wdc=()=>{let t=n;while(t){if(t.isDeactivated)return;t=t.parent}return e()});if(ae(t,i,n),n){let e=n.parent;while(e&&e.parent)J(e.parent.vnode)&&ie(i,t,n,e),e=e.parent}}function ie(e,t,n,i){const s=ae(t,e,i,!0);fe(()=>{(0,r.TF)(i[t],s)},n)}function re(e){e.shapeFlag&=-257,e.shapeFlag&=-513}function se(e){return 128&e.shapeFlag?e.ssContent:e}function ae(e,t,n=wn,r=!1){if(n){const s=n[e]||(n[e]=[]),o=t.__weh||(t.__weh=(...r)=>{(0,i.C4)();const s=kn(n),o=a(t,n,e,r);return s(),(0,i.bl)(),o});return r?s.unshift(o):s.push(o),o}}const oe=e=>(t,n=wn)=>{Mn&&"sp"!==e||ae(e,(...e)=>t(...e),n)},ue=oe("bm"),le=oe("m"),ce=oe("bu"),de=oe("u"),he=oe("bum"),fe=oe("um"),pe=oe("sp"),ge=oe("rtg"),me=oe("rtc");function ve(e,t=wn){ae("ec",e,t)}const ye="components";function be(e,t){return Se(ye,e,!0,t)||e}const Te=Symbol.for("v-ndc");function Se(e,t,n=!0,i=!1){const s=x||wn;if(s){const n=s.type;if(e===ye){const e=jn(n,!1);if(e&&(e===t||e===(0,r.PT)(t)||e===(0,r.ZH)((0,r.PT)(t))))return n}const a=Ee(s[e]||n[e],t)||Ee(s.appContext[e],t);return!a&&i?n:a}}function Ee(e,t){return e&&(e[t]||e[(0,r.PT)(t)]||e[(0,r.ZH)((0,r.PT)(t))])}function we(e,t,n,s){let a;const o=n&&n[s],u=(0,r.cy)(e);if(u||(0,r.Kg)(e)){const n=u&&(0,i.g8)(e);let r=!1,s=!1;n&&(r=!(0,i.fE)(e),s=(0,i.Tm)(e),e=(0,i.qA)(e)),a=new Array(e.length);for(let u=0,l=e.length;u<l;u++)a[u]=t(r?s?(0,i.a1)((0,i.lJ)(e[u])):(0,i.lJ)(e[u]):e[u],u,void 0,o&&o[u])}else if("number"===typeof e){0,a=new Array(e);for(let n=0;n<e;n++)a[n]=t(n+1,n,void 0,o&&o[n])}else if((0,r.Gv)(e))if(e[Symbol.iterator])a=Array.from(e,(e,n)=>t(e,n,void 0,o&&o[n]));else{const n=Object.keys(e);a=new Array(n.length);for(let i=0,r=n.length;i<r;i++){const r=n[i];a[i]=t(e[r],r,i,o&&o[i])}}else a=[];return n&&(n[s]=a),a}const Ae=e=>e?Rn(e)?Bn(e):Ae(e.parent):null,xe=(0,r.X$)(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ae(e.parent),$root:e=>Ae(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>_e(e),$forceUpdate:e=>e.f||(e.f=()=>{y(e.update)}),$nextTick:e=>e.n||(e.n=m.bind(e.proxy)),$watch:e=>Rt.bind(e)}),Ie=(e,t)=>e!==r.MZ&&!e.__isScriptSetup&&(0,r.$3)(e,t),ke={get({_:e},t){if("__v_skip"===t)return!0;const{ctx:n,setupState:s,data:a,props:o,accessCache:u,type:l,appContext:c}=e;let d;if("$"!==t[0]){const i=u[t];if(void 0!==i)switch(i){case 1:return s[t];case 2:return a[t];case 4:return n[t];case 3:return o[t]}else{if(Ie(s,t))return u[t]=1,s[t];if(a!==r.MZ&&(0,r.$3)(a,t))return u[t]=2,a[t];if((d=e.propsOptions[0])&&(0,r.$3)(d,t))return u[t]=3,o[t];if(n!==r.MZ&&(0,r.$3)(n,t))return u[t]=4,n[t];Re&&(u[t]=0)}}const h=xe[t];let f,p;return h?("$attrs"===t&&(0,i.u4)(e.attrs,"get",""),h(e)):(f=l.__cssModules)&&(f=f[t])?f:n!==r.MZ&&(0,r.$3)(n,t)?(u[t]=4,n[t]):(p=c.config.globalProperties,(0,r.$3)(p,t)?p[t]:void 0)},set({_:e},t,n){const{data:i,setupState:s,ctx:a}=e;return Ie(s,t)?(s[t]=n,!0):i!==r.MZ&&(0,r.$3)(i,t)?(i[t]=n,!0):!(0,r.$3)(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(a[t]=n,!0))},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:s,propsOptions:a}},o){let u;return!!n[o]||e!==r.MZ&&(0,r.$3)(e,o)||Ie(t,o)||(u=a[0])&&(0,r.$3)(u,o)||(0,r.$3)(i,o)||(0,r.$3)(xe,o)||(0,r.$3)(s.config.globalProperties,o)},defineProperty(e,t,n){return null!=n.get?e._.accessCache[t]=0:(0,r.$3)(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function Le(e){return(0,r.cy)(e)?e.reduce((e,t)=>(e[t]=null,e),{}):e}let Re=!0;function Ce(e){const t=_e(e),n=e.proxy,s=e.ctx;Re=!1,t.beforeCreate&&Me(t.beforeCreate,e,"bc");const{data:a,computed:o,methods:u,watch:l,provide:c,inject:d,created:h,beforeMount:f,mounted:p,beforeUpdate:g,updated:m,activated:v,deactivated:y,beforeDestroy:b,beforeUnmount:T,destroyed:S,unmounted:E,render:w,renderTracked:A,renderTriggered:x,errorCaptured:I,serverPrefetch:k,expose:L,inheritAttrs:R,components:C,directives:D,filters:M}=t,P=null;if(d&&De(d,s,P),u)for(const i in u){const e=u[i];(0,r.Tn)(e)&&(s[i]=e.bind(n))}if(a){0;const t=a.call(n,n);0,(0,r.Gv)(t)&&(e.data=(0,i.Kh)(t))}if(Re=!0,o)for(const i in o){const e=o[i],t=(0,r.Tn)(e)?e.bind(n,n):(0,r.Tn)(e.get)?e.get.bind(n,n):r.tE;0;const a=!(0,r.Tn)(e)&&(0,r.Tn)(e.set)?e.set.bind(n):r.tE,u=Gn({get:t,set:a});Object.defineProperty(s,i,{enumerable:!0,configurable:!0,get:()=>u.value,set:e=>u.value=e})}if(l)for(const i in l)Pe(l[i],s,n,i);if(c){const e=(0,r.Tn)(c)?c.call(n):c;Reflect.ownKeys(e).forEach(t=>{Ye(t,e[t])})}function _(e,t){(0,r.cy)(t)?t.forEach(t=>e(t.bind(n))):t&&e(t.bind(n))}if(h&&Me(h,e,"c"),_(ue,f),_(le,p),_(ce,g),_(de,m),_(ee,v),_(te,y),_(ve,I),_(me,A),_(ge,x),_(he,T),_(fe,E),_(pe,k),(0,r.cy)(L))if(L.length){const t=e.exposed||(e.exposed={});L.forEach(e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t})})}else e.exposed||(e.exposed={});w&&e.render===r.tE&&(e.render=w),null!=R&&(e.inheritAttrs=R),C&&(e.components=C),D&&(e.directives=D),k&&z(e)}function De(e,t,n=r.tE){(0,r.cy)(e)&&(e=Be(e));for(const s in e){const n=e[s];let a;a=(0,r.Gv)(n)?"default"in n?ze(n.from||s,n.default,!0):ze(n.from||s):ze(n),(0,i.i9)(a)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>a.value,set:e=>a.value=e}):t[s]=a}}function Me(e,t,n){a((0,r.cy)(e)?e.map(e=>e.bind(t.proxy)):e.bind(t.proxy),t,n)}function Pe(e,t,n,i){let s=i.includes(".")?Ct(n,i):()=>n[i];if((0,r.Kg)(e)){const n=t[e];(0,r.Tn)(n)&&kt(s,n)}else if((0,r.Tn)(e))kt(s,e.bind(n));else if((0,r.Gv)(e))if((0,r.cy)(e))e.forEach(e=>Pe(e,t,n,i));else{const i=(0,r.Tn)(e.handler)?e.handler.bind(n):t[e.handler];(0,r.Tn)(i)&&kt(s,i,e)}else 0}function _e(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:s,optionsCache:a,config:{optionMergeStrategies:o}}=e.appContext,u=a.get(t);let l;return u?l=u:s.length||n||i?(l={},s.length&&s.forEach(e=>Oe(l,e,o,!0)),Oe(l,t,o)):l=t,(0,r.Gv)(t)&&a.set(t,l),l}function Oe(e,t,n,i=!1){const{mixins:r,extends:s}=t;s&&Oe(e,s,n,!0),r&&r.forEach(t=>Oe(e,t,n,!0));for(const a in t)if(i&&"expose"===a);else{const i=Ne[a]||n&&n[a];e[a]=i?i(e[a],t[a]):t[a]}return e}const Ne={data:Ue,props:Ge,emits:Ge,methods:$e,computed:$e,beforeCreate:je,created:je,beforeMount:je,mounted:je,beforeUpdate:je,updated:je,beforeDestroy:je,beforeUnmount:je,destroyed:je,unmounted:je,activated:je,deactivated:je,errorCaptured:je,serverPrefetch:je,components:$e,directives:$e,watch:Ve,provide:Ue,inject:Fe};function Ue(e,t){return t?e?function(){return(0,r.X$)((0,r.Tn)(e)?e.call(this,this):e,(0,r.Tn)(t)?t.call(this,this):t)}:t:e}function Fe(e,t){return $e(Be(e),Be(t))}function Be(e){if((0,r.cy)(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function je(e,t){return e?[...new Set([].concat(e,t))]:t}function $e(e,t){return e?(0,r.X$)(Object.create(null),e,t):t}function Ge(e,t){return e?(0,r.cy)(e)&&(0,r.cy)(t)?[...new Set([...e,...t])]:(0,r.X$)(Object.create(null),Le(e),Le(null!=t?t:{})):t}function Ve(e,t){if(!e)return t;if(!t)return e;const n=(0,r.X$)(Object.create(null),e);for(const i in t)n[i]=je(e[i],t[i]);return n}function He(){return{app:null,config:{isNativeTag:r.NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ke=0;function We(e,t){return function(n,i=null){(0,r.Tn)(n)||(n=(0,r.X$)({},n)),null==i||(0,r.Gv)(i)||(i=null);const s=He(),o=new WeakSet,u=[];let l=!1;const c=s.app={_uid:Ke++,_component:n,_props:i,_container:null,_context:s,_instance:null,version:Hn,get config(){return s.config},set config(e){0},use(e,...t){return o.has(e)||(e&&(0,r.Tn)(e.install)?(o.add(e),e.install(c,...t)):(0,r.Tn)(e)&&(o.add(e),e(c,...t))),c},mixin(e){return s.mixins.includes(e)||s.mixins.push(e),c},component(e,t){return t?(s.components[e]=t,c):s.components[e]},directive(e,t){return t?(s.directives[e]=t,c):s.directives[e]},mount(r,a,o){if(!l){0;const u=c._ceVNode||un(n,i);return u.appContext=s,!0===o?o="svg":!1===o&&(o=void 0),a&&t?t(u,r):e(u,r,o),l=!0,c._container=r,r.__vue_app__=c,Bn(u.component)}},onUnmount(e){u.push(e)},unmount(){l&&(a(u,c._instance,16),e(null,c._container),delete c._container.__vue_app__)},provide(e,t){return s.provides[e]=t,c},runWithContext(e){const t=qe;qe=c;try{return e()}finally{qe=t}}};return c}}let qe=null;function Ye(e,t){if(wn){let n=wn.provides;const i=wn.parent&&wn.parent.provides;i===n&&(n=wn.provides=Object.create(i)),n[e]=t}else 0}function ze(e,t,n=!1){const i=wn||x;if(i||qe){let s=qe?qe._context.provides:i?null==i.parent||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return n&&(0,r.Tn)(t)?t.call(i&&i.proxy):t}else 0}const Xe={},Qe=()=>Object.create(Xe),Je=e=>Object.getPrototypeOf(e)===Xe;function Ze(e,t,n,r=!1){const s={},a=Qe();e.propsDefaults=Object.create(null),tt(e,t,s,a);for(const i in e.propsOptions[0])i in s||(s[i]=void 0);n?e.props=r?s:(0,i.Gc)(s):e.type.props?e.props=s:e.props=a,e.attrs=a}function et(e,t,n,s){const{props:a,attrs:o,vnode:{patchFlag:u}}=e,l=(0,i.ux)(a),[c]=e.propsOptions;let d=!1;if(!(s||u>0)||16&u){let i;tt(e,t,a,o)&&(d=!0);for(const s in l)t&&((0,r.$3)(t,s)||(i=(0,r.Tg)(s))!==s&&(0,r.$3)(t,i))||(c?!n||void 0===n[s]&&void 0===n[i]||(a[s]=nt(c,l,s,void 0,e,!0)):delete a[s]);if(o!==l)for(const e in o)t&&(0,r.$3)(t,e)||(delete o[e],d=!0)}else if(8&u){const n=e.vnode.dynamicProps;for(let i=0;i<n.length;i++){let s=n[i];if(_t(e.emitsOptions,s))continue;const u=t[s];if(c)if((0,r.$3)(o,s))u!==o[s]&&(o[s]=u,d=!0);else{const t=(0,r.PT)(s);a[t]=nt(c,l,t,u,e,!1)}else u!==o[s]&&(o[s]=u,d=!0)}}d&&(0,i.hZ)(e.attrs,"set","")}function tt(e,t,n,s){const[a,o]=e.propsOptions;let u,l=!1;if(t)for(let i in t){if((0,r.SU)(i))continue;const c=t[i];let d;a&&(0,r.$3)(a,d=(0,r.PT)(i))?o&&o.includes(d)?(u||(u={}))[d]=c:n[d]=c:_t(e.emitsOptions,i)||i in s&&c===s[i]||(s[i]=c,l=!0)}if(o){const t=(0,i.ux)(n),s=u||r.MZ;for(let i=0;i<o.length;i++){const u=o[i];n[u]=nt(a,t,u,s[u],e,!(0,r.$3)(s,u))}}return l}function nt(e,t,n,i,s,a){const o=e[n];if(null!=o){const e=(0,r.$3)(o,"default");if(e&&void 0===i){const e=o.default;if(o.type!==Function&&!o.skipFactory&&(0,r.Tn)(e)){const{propsDefaults:r}=s;if(n in r)i=r[n];else{const a=kn(s);i=r[n]=e.call(null,t),a()}}else i=e;s.ce&&s.ce._setProp(n,i)}o[0]&&(a&&!e?i=!1:!o[1]||""!==i&&i!==(0,r.Tg)(n)||(i=!0))}return i}const it=new WeakMap;function rt(e,t,n=!1){const i=n?it:t.propsCache,s=i.get(e);if(s)return s;const a=e.props,o={},u=[];let l=!1;if(!(0,r.Tn)(e)){const i=e=>{l=!0;const[n,i]=rt(e,t,!0);(0,r.X$)(o,n),i&&u.push(...i)};!n&&t.mixins.length&&t.mixins.forEach(i),e.extends&&i(e.extends),e.mixins&&e.mixins.forEach(i)}if(!a&&!l)return(0,r.Gv)(e)&&i.set(e,r.Oj),r.Oj;if((0,r.cy)(a))for(let d=0;d<a.length;d++){0;const e=(0,r.PT)(a[d]);st(e)&&(o[e]=r.MZ)}else if(a){0;for(const e in a){const t=(0,r.PT)(e);if(st(t)){const n=a[e],i=o[t]=(0,r.cy)(n)||(0,r.Tn)(n)?{type:n}:(0,r.X$)({},n),s=i.type;let l=!1,c=!0;if((0,r.cy)(s))for(let e=0;e<s.length;++e){const t=s[e],n=(0,r.Tn)(t)&&t.name;if("Boolean"===n){l=!0;break}"String"===n&&(c=!1)}else l=(0,r.Tn)(s)&&"Boolean"===s.name;i[0]=l,i[1]=c,(l||(0,r.$3)(i,"default"))&&u.push(t)}}}const c=[o,u];return(0,r.Gv)(e)&&i.set(e,c),c}function st(e){return"$"!==e[0]&&!(0,r.SU)(e)}const at=e=>"_"===e[0]||"$stable"===e,ot=e=>(0,r.cy)(e)?e.map(gn):[gn(e)],ut=(e,t,n)=>{if(t._n)return t;const i=L((...e)=>ot(t(...e)),n);return i._c=!1,i},lt=(e,t,n)=>{const i=e._ctx;for(const s in e){if(at(s))continue;const n=e[s];if((0,r.Tn)(n))t[s]=ut(s,n,i);else if(null!=n){0;const e=ot(n);t[s]=()=>e}}},ct=(e,t)=>{const n=ot(t);e.slots.default=()=>n},dt=(e,t,n)=>{for(const i in t)!n&&at(i)||(e[i]=t[i])},ht=(e,t,n)=>{const i=e.slots=Qe();if(32&e.vnode.shapeFlag){const e=t._;e?(dt(i,t,n),n&&(0,r.yQ)(i,"_",e,!0)):lt(t,i)}else t&&ct(e,t)},ft=(e,t,n)=>{const{vnode:i,slots:s}=e;let a=!0,o=r.MZ;if(32&i.shapeFlag){const e=t._;e?n&&1===e?a=!1:dt(s,t,n):(a=!t.$stable,lt(t,s)),o=t}else t&&(ct(e,t),o={default:1});if(a)for(const r in s)at(r)||null!=o[r]||delete s[r]};function pt(){"boolean"!==typeof __VUE_PROD_HYDRATION_MISMATCH_DETAILS__&&((0,r.We)().__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!1)}const gt=Gt;function mt(e){return vt(e)}function vt(e,t){pt();const n=(0,r.We)();n.__VUE__=!0;const{insert:s,remove:a,patchProp:o,createElement:u,createText:l,createComment:c,setText:d,setElementText:h,parentNode:f,nextSibling:p,setScopeId:g=r.tE,insertStaticContent:m}=e,v=(e,t,n,i=null,r=null,s=null,a=void 0,o=null,u=!!t.dynamicChildren)=>{if(e===t)return;e&&!rn(e,t)&&(i=Z(e),K(e,r,s,!0),e=null),-2===t.patchFlag&&(u=!1,t.dynamicChildren=null);const{type:l,ref:c,shapeFlag:d}=t;switch(l){case Ht:b(e,t,n,i);break;case Kt:T(e,t,n,i);break;case Wt:null==e&&w(t,n,i,a);break;case Vt:O(e,t,n,i,r,s,a,o,u);break;default:1&d?I(e,t,n,i,r,s,a,o,u):6&d?N(e,t,n,i,r,s,a,o,u):(64&d||128&d)&&l.process(e,t,n,i,r,s,a,o,u,ne)}null!=c&&r&&X(c,e&&e.ref,s,t||e,!t)},b=(e,t,n,i)=>{if(null==e)s(t.el=l(t.children),n,i);else{const n=t.el=e.el;t.children!==e.children&&d(n,t.children)}},T=(e,t,n,i)=>{null==e?s(t.el=c(t.children||""),n,i):t.el=e.el},w=(e,t,n,i)=>{[e.el,e.anchor]=m(e.children,t,n,i,e.el,e.anchor)},A=({el:e,anchor:t},n,i)=>{let r;while(e&&e!==t)r=p(e),s(e,n,i),e=r;s(t,n,i)},x=({el:e,anchor:t})=>{let n;while(e&&e!==t)n=p(e),a(e),e=n;a(t)},I=(e,t,n,i,r,s,a,o,u)=>{"svg"===t.type?a="svg":"math"===t.type&&(a="mathml"),null==e?k(t,n,i,r,s,a,o,u):M(e,t,r,s,a,o,u)},k=(e,t,n,i,a,l,c,d)=>{let f,p;const{props:g,shapeFlag:m,transition:v,dirs:y}=e;if(f=e.el=u(e.type,l,g&&g.is,g),8&m?h(f,e.children):16&m&&R(e.children,f,null,i,a,yt(e,l),c,d),y&&C(e,null,i,"created"),L(f,e,e.scopeId,c,i),g){for(const e in g)"value"===e||(0,r.SU)(e)||o(f,e,null,g[e],l,i);"value"in g&&o(f,"value",null,g.value,l),(p=g.onVnodeBeforeMount)&&bn(p,i,e)}y&&C(e,null,i,"beforeMount");const b=Tt(a,v);b&&v.beforeEnter(f),s(f,t,n),((p=g&&g.onVnodeMounted)||b||y)&&gt(()=>{p&&bn(p,i,e),b&&v.enter(f),y&&C(e,null,i,"mounted")},a)},L=(e,t,n,i,r)=>{if(n&&g(e,n),i)for(let s=0;s<i.length;s++)g(e,i[s]);if(r){let n=r.subTree;if(t===n||$t(n.type)&&(n.ssContent===t||n.ssFallback===t)){const t=r.vnode;L(e,t,t.scopeId,t.slotScopeIds,r.parent)}}},R=(e,t,n,i,r,s,a,o,u=0)=>{for(let l=u;l<e.length;l++){const u=e[l]=o?mn(e[l]):gn(e[l]);v(null,u,t,n,i,r,s,a,o)}},M=(e,t,n,i,s,a,u)=>{const l=t.el=e.el;let{patchFlag:c,dynamicChildren:d,dirs:f}=t;c|=16&e.patchFlag;const p=e.props||r.MZ,g=t.props||r.MZ;let m;if(n&&bt(n,!1),(m=g.onVnodeBeforeUpdate)&&bn(m,n,t,e),f&&C(t,e,n,"beforeUpdate"),n&&bt(n,!0),(p.innerHTML&&null==g.innerHTML||p.textContent&&null==g.textContent)&&h(l,""),d?P(e.dynamicChildren,d,l,n,i,yt(t,s),a):u||$(e,t,l,null,n,i,yt(t,s),a,!1),c>0){if(16&c)_(l,p,g,n,s);else if(2&c&&p.class!==g.class&&o(l,"class",null,g.class,s),4&c&&o(l,"style",p.style,g.style,s),8&c){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const i=e[t],r=p[i],a=g[i];a===r&&"value"!==i||o(l,i,r,a,s,n)}}1&c&&e.children!==t.children&&h(l,t.children)}else u||null!=d||_(l,p,g,n,s);((m=g.onVnodeUpdated)||f)&&gt(()=>{m&&bn(m,n,t,e),f&&C(t,e,n,"updated")},i)},P=(e,t,n,i,r,s,a)=>{for(let o=0;o<t.length;o++){const u=e[o],l=t[o],c=u.el&&(u.type===Vt||!rn(u,l)||198&u.shapeFlag)?f(u.el):n;v(u,l,c,null,i,r,s,a,!0)}},_=(e,t,n,i,s)=>{if(t!==n){if(t!==r.MZ)for(const a in t)(0,r.SU)(a)||a in n||o(e,a,t[a],null,s,i);for(const a in n){if((0,r.SU)(a))continue;const u=n[a],l=t[a];u!==l&&"value"!==a&&o(e,a,l,u,s,i)}"value"in n&&o(e,"value",t.value,n.value,s)}},O=(e,t,n,i,r,a,o,u,c)=>{const d=t.el=e?e.el:l(""),h=t.anchor=e?e.anchor:l("");let{patchFlag:f,dynamicChildren:p,slotScopeIds:g}=t;g&&(u=u?u.concat(g):g),null==e?(s(d,n,i),s(h,n,i),R(t.children||[],n,h,r,a,o,u,c)):f>0&&64&f&&p&&e.dynamicChildren?(P(e.dynamicChildren,p,n,r,a,o,u),(null!=t.key||r&&t===r.subTree)&&St(e,t,!0)):$(e,t,n,h,r,a,o,u,c)},N=(e,t,n,i,r,s,a,o,u)=>{t.slotScopeIds=o,null==e?512&t.shapeFlag?r.ctx.activate(t,n,i,a,u):U(t,n,i,r,s,a,u):F(e,t,u)},U=(e,t,n,i,r,s,a)=>{const o=e.component=En(e,i,r);if(J(e)&&(o.ctx.renderer=ne),Pn(o,!1,a),o.asyncDep){if(r&&r.registerDep(o,B,a),!e.el){const e=o.subTree=un(Kt);T(null,e,t,n)}}else B(o,e,t,n,r,s,a)},F=(e,t,n)=>{const i=t.component=e.component;if(Ft(e,t,n)){if(i.asyncDep&&!i.asyncResolved)return void j(i,t,n);i.next=t,i.update()}else t.el=e.el,i.vnode=t},B=(e,t,n,s,a,o,u)=>{const l=()=>{if(e.isMounted){let{next:t,bu:n,u:i,parent:s,vnode:c}=e;{const n=wt(e);if(n)return t&&(t.el=c.el,j(e,t,u)),void n.asyncDep.then(()=>{e.isUnmounted||l()})}let d,h=t;0,bt(e,!1),t?(t.el=c.el,j(e,t,u)):t=c,n&&(0,r.DY)(n),(d=t.props&&t.props.onVnodeBeforeUpdate)&&bn(d,s,t,c),bt(e,!0);const p=Ot(e);0;const g=e.subTree;e.subTree=p,v(g,p,f(g.el),Z(g),e,a,o),t.el=p.el,null===h&&jt(e,p.el),i&&gt(i,a),(d=t.props&&t.props.onVnodeUpdated)&&gt(()=>bn(d,s,t,c),a)}else{let i;const{el:u,props:l}=t,{bm:c,m:d,parent:h,root:f,type:p}=e,g=Q(t);if(bt(e,!1),c&&(0,r.DY)(c),!g&&(i=l&&l.onVnodeBeforeMount)&&bn(i,h,t),bt(e,!0),u&&re){const t=()=>{e.subTree=Ot(e),re(u,e.subTree,e,a,null)};g&&p.__asyncHydrate?p.__asyncHydrate(u,e,t):t()}else{f.ce&&f.ce._injectChildStyle(p);const i=e.subTree=Ot(e);0,v(null,i,n,s,e,a,o),t.el=i.el}if(d&&gt(d,a),!g&&(i=l&&l.onVnodeMounted)){const e=t;gt(()=>bn(i,h,e),a)}(256&t.shapeFlag||h&&Q(h.vnode)&&256&h.vnode.shapeFlag)&&e.a&&gt(e.a,a),e.isMounted=!0,t=n=s=null}};e.scope.on();const c=e.effect=new i.X2(l);e.scope.off();const d=e.update=c.run.bind(c),h=e.job=c.runIfDirty.bind(c);h.i=e,h.id=e.uid,c.scheduler=()=>y(h),bt(e,!0),d()},j=(e,t,n)=>{t.component=e;const r=e.vnode.props;e.vnode=t,e.next=null,et(e,t.props,r,n),ft(e,t.children,n),(0,i.C4)(),S(e),(0,i.bl)()},$=(e,t,n,i,r,s,a,o,u=!1)=>{const l=e&&e.children,c=e?e.shapeFlag:0,d=t.children,{patchFlag:f,shapeFlag:p}=t;if(f>0){if(128&f)return void V(l,d,n,i,r,s,a,o,u);if(256&f)return void G(l,d,n,i,r,s,a,o,u)}8&p?(16&c&&z(l,r,s),d!==l&&h(n,d)):16&c?16&p?V(l,d,n,i,r,s,a,o,u):z(l,r,s,!0):(8&c&&h(n,""),16&p&&R(d,n,i,r,s,a,o,u))},G=(e,t,n,i,s,a,o,u,l)=>{e=e||r.Oj,t=t||r.Oj;const c=e.length,d=t.length,h=Math.min(c,d);let f;for(f=0;f<h;f++){const i=t[f]=l?mn(t[f]):gn(t[f]);v(e[f],i,n,null,s,a,o,u,l)}c>d?z(e,s,a,!0,!1,h):R(t,n,i,s,a,o,u,l,h)},V=(e,t,n,i,s,a,o,u,l)=>{let c=0;const d=t.length;let h=e.length-1,f=d-1;while(c<=h&&c<=f){const i=e[c],r=t[c]=l?mn(t[c]):gn(t[c]);if(!rn(i,r))break;v(i,r,n,null,s,a,o,u,l),c++}while(c<=h&&c<=f){const i=e[h],r=t[f]=l?mn(t[f]):gn(t[f]);if(!rn(i,r))break;v(i,r,n,null,s,a,o,u,l),h--,f--}if(c>h){if(c<=f){const e=f+1,r=e<d?t[e].el:i;while(c<=f)v(null,t[c]=l?mn(t[c]):gn(t[c]),n,r,s,a,o,u,l),c++}}else if(c>f)while(c<=h)K(e[c],s,a,!0),c++;else{const p=c,g=c,m=new Map;for(c=g;c<=f;c++){const e=t[c]=l?mn(t[c]):gn(t[c]);null!=e.key&&m.set(e.key,c)}let y,b=0;const T=f-g+1;let S=!1,E=0;const w=new Array(T);for(c=0;c<T;c++)w[c]=0;for(c=p;c<=h;c++){const i=e[c];if(b>=T){K(i,s,a,!0);continue}let r;if(null!=i.key)r=m.get(i.key);else for(y=g;y<=f;y++)if(0===w[y-g]&&rn(i,t[y])){r=y;break}void 0===r?K(i,s,a,!0):(w[r-g]=c+1,r>=E?E=r:S=!0,v(i,t[r],n,null,s,a,o,u,l),b++)}const A=S?Et(w):r.Oj;for(y=A.length-1,c=T-1;c>=0;c--){const e=g+c,r=t[e],h=e+1<d?t[e+1].el:i;0===w[c]?v(null,r,n,h,s,a,o,u,l):S&&(y<0||c!==A[y]?H(r,n,h,2):y--)}}},H=(e,t,n,i,r=null)=>{const{el:o,type:u,transition:l,children:c,shapeFlag:d}=e;if(6&d)return void H(e.component.subTree,t,n,i);if(128&d)return void e.suspense.move(t,n,i);if(64&d)return void u.move(e,t,n,ne);if(u===Vt){s(o,t,n);for(let e=0;e<c.length;e++)H(c[e],t,n,i);return void s(e.anchor,t,n)}if(u===Wt)return void A(e,t,n);const h=2!==i&&1&d&&l;if(h)if(0===i)l.beforeEnter(o),s(o,t,n),gt(()=>l.enter(o),r);else{const{leave:i,delayLeave:r,afterLeave:u}=l,c=()=>{e.ctx.isUnmounted?a(o):s(o,t,n)},d=()=>{i(o,()=>{c(),u&&u()})};r?r(o,c,d):d()}else s(o,t,n)},K=(e,t,n,r=!1,s=!1)=>{const{type:a,props:o,ref:u,children:l,dynamicChildren:c,shapeFlag:d,patchFlag:h,dirs:f,cacheIndex:p}=e;if(-2===h&&(s=!1),null!=u&&((0,i.C4)(),X(u,null,n,e,!0),(0,i.bl)()),null!=p&&(t.renderCache[p]=void 0),256&d)return void t.ctx.deactivate(e);const g=1&d&&f,m=!Q(e);let v;if(m&&(v=o&&o.onVnodeBeforeUnmount)&&bn(v,t,e),6&d)Y(e.component,n,r);else{if(128&d)return void e.suspense.unmount(n,r);g&&C(e,null,t,"beforeUnmount"),64&d?e.type.remove(e,t,n,ne,r):c&&!c.hasOnce&&(a!==Vt||h>0&&64&h)?z(c,t,n,!1,!0):(a===Vt&&384&h||!s&&16&d)&&z(l,t,n),r&&W(e)}(m&&(v=o&&o.onVnodeUnmounted)||g)&&gt(()=>{v&&bn(v,t,e),g&&C(e,null,t,"unmounted")},n)},W=e=>{const{type:t,el:n,anchor:i,transition:r}=e;if(t===Vt)return void q(n,i);if(t===Wt)return void x(e);const s=()=>{a(n),r&&!r.persisted&&r.afterLeave&&r.afterLeave()};if(1&e.shapeFlag&&r&&!r.persisted){const{leave:t,delayLeave:i}=r,a=()=>t(n,s);i?i(e.el,s,a):a()}else s()},q=(e,t)=>{let n;while(e!==t)n=p(e),a(e),e=n;a(t)},Y=(e,t,n)=>{const{bum:i,scope:s,job:a,subTree:o,um:u,m:l,a:c,parent:d,slots:{__:h}}=e;At(l),At(c),i&&(0,r.DY)(i),d&&(0,r.cy)(h)&&h.forEach(e=>{d.renderCache[e]=void 0}),s.stop(),a&&(a.flags|=8,K(o,e,t,n)),u&&gt(u,t),gt(()=>{e.isUnmounted=!0},t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},z=(e,t,n,i=!1,r=!1,s=0)=>{for(let a=s;a<e.length;a++)K(e[a],t,n,i,r)},Z=e=>{if(6&e.shapeFlag)return Z(e.component.subTree);if(128&e.shapeFlag)return e.suspense.next();const t=p(e.anchor||e.el),n=t&&t[D];return n?p(n):t};let ee=!1;const te=(e,t,n)=>{null==e?t._vnode&&K(t._vnode,null,null,!0):v(t._vnode||null,e,t,null,null,null,n),t._vnode=e,ee||(ee=!0,S(),E(),ee=!1)},ne={p:v,um:K,m:H,r:W,mt:U,mc:R,pc:$,pbc:P,n:Z,o:e};let ie,re;return t&&([ie,re]=t(ne)),{render:te,hydrate:ie,createApp:We(te,ie)}}function yt({type:e,props:t},n){return"svg"===n&&"foreignObject"===e||"mathml"===n&&"annotation-xml"===e&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function bt({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Tt(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function St(e,t,n=!1){const i=e.children,s=t.children;if((0,r.cy)(i)&&(0,r.cy)(s))for(let r=0;r<i.length;r++){const e=i[r];let t=s[r];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=s[r]=mn(s[r]),t.el=e.el),n||-2===t.patchFlag||St(e,t)),t.type===Ht&&(t.el=e.el),t.type!==Kt||t.el||(t.el=e.el)}}function Et(e){const t=e.slice(),n=[0];let i,r,s,a,o;const u=e.length;for(i=0;i<u;i++){const u=e[i];if(0!==u){if(r=n[n.length-1],e[r]<u){t[i]=r,n.push(i);continue}s=0,a=n.length-1;while(s<a)o=s+a>>1,e[n[o]]<u?s=o+1:a=o;u<e[n[s]]&&(s>0&&(t[i]=n[s-1]),n[s]=i)}}s=n.length,a=n[s-1];while(s-- >0)n[s]=a,a=t[a];return n}function wt(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:wt(t)}function At(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const xt=Symbol.for("v-scx"),It=()=>{{const e=ze(xt);return e}};function kt(e,t,n){return Lt(e,t,n)}function Lt(e,t,n=r.MZ){const{immediate:s,deep:o,flush:u,once:l}=n;const c=(0,r.X$)({},n);const d=t&&s||!t&&"post"!==u;let h;if(Mn)if("sync"===u){const e=It();h=e.__watcherHandles||(e.__watcherHandles=[])}else if(!d){const e=()=>{};return e.stop=r.tE,e.resume=r.tE,e.pause=r.tE,e}const f=wn;c.call=(e,t,n)=>a(e,f,t,n);let p=!1;"post"===u?c.scheduler=e=>{gt(e,f&&f.suspense)}:"sync"!==u&&(p=!0,c.scheduler=(e,t)=>{t?e():y(e)}),c.augmentJob=e=>{t&&(e.flags|=4),p&&(e.flags|=2,f&&(e.id=f.uid,e.i=f))};const g=(0,i.wB)(e,t,c);return Mn&&(h?h.push(g):d&&g()),g}function Rt(e,t,n){const i=this.proxy,s=(0,r.Kg)(e)?e.includes(".")?Ct(i,e):()=>i[e]:e.bind(i,i);let a;(0,r.Tn)(t)?a=t:(a=t.handler,n=t);const o=kn(this),u=Lt(s,a.bind(i),n);return o(),u}function Ct(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}const Dt=(e,t)=>"modelValue"===t||"model-value"===t?e.modelModifiers:e[`${t}Modifiers`]||e[`${(0,r.PT)(t)}Modifiers`]||e[`${(0,r.Tg)(t)}Modifiers`];function Mt(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||r.MZ;let s=n;const o=t.startsWith("update:"),u=o&&Dt(i,t.slice(7));let l;u&&(u.trim&&(s=n.map(e=>(0,r.Kg)(e)?e.trim():e)),u.number&&(s=n.map(r.bB)));let c=i[l=(0,r.rU)(t)]||i[l=(0,r.rU)((0,r.PT)(t))];!c&&o&&(c=i[l=(0,r.rU)((0,r.Tg)(t))]),c&&a(c,e,6,s);const d=i[l+"Once"];if(d){if(e.emitted){if(e.emitted[l])return}else e.emitted={};e.emitted[l]=!0,a(d,e,6,s)}}function Pt(e,t,n=!1){const i=t.emitsCache,s=i.get(e);if(void 0!==s)return s;const a=e.emits;let o={},u=!1;if(!(0,r.Tn)(e)){const i=e=>{const n=Pt(e,t,!0);n&&(u=!0,(0,r.X$)(o,n))};!n&&t.mixins.length&&t.mixins.forEach(i),e.extends&&i(e.extends),e.mixins&&e.mixins.forEach(i)}return a||u?((0,r.cy)(a)?a.forEach(e=>o[e]=null):(0,r.X$)(o,a),(0,r.Gv)(e)&&i.set(e,o),o):((0,r.Gv)(e)&&i.set(e,null),null)}function _t(e,t){return!(!e||!(0,r.Mp)(t))&&(t=t.slice(2).replace(/Once$/,""),(0,r.$3)(e,t[0].toLowerCase()+t.slice(1))||(0,r.$3)(e,(0,r.Tg)(t))||(0,r.$3)(e,t))}function Ot(e){const{type:t,vnode:n,proxy:i,withProxy:s,propsOptions:[a],slots:u,attrs:l,emit:c,render:d,renderCache:h,props:f,data:p,setupState:g,ctx:m,inheritAttrs:v}=e,y=k(e);let b,T;try{if(4&n.shapeFlag){const e=s||i,t=e;b=gn(d.call(t,e,h,f,g,p,m)),T=l}else{const e=t;0,b=gn(e.length>1?e(f,{attrs:l,slots:u,emit:c}):e(f,null)),T=t.props?l:Nt(l)}}catch(E){qt.length=0,o(E,e,1),b=un(Kt)}let S=b;if(T&&!1!==v){const e=Object.keys(T),{shapeFlag:t}=S;e.length&&7&t&&(a&&e.some(r.CP)&&(T=Ut(T,a)),S=dn(S,T,!1,!0))}return n.dirs&&(S=dn(S,null,!1,!0),S.dirs=S.dirs?S.dirs.concat(n.dirs):n.dirs),n.transition&&W(S,n.transition),b=S,k(y),b}const Nt=e=>{let t;for(const n in e)("class"===n||"style"===n||(0,r.Mp)(n))&&((t||(t={}))[n]=e[n]);return t},Ut=(e,t)=>{const n={};for(const i in e)(0,r.CP)(i)&&i.slice(9)in t||(n[i]=e[i]);return n};function Ft(e,t,n){const{props:i,children:r,component:s}=e,{props:a,children:o,patchFlag:u}=t,l=s.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&u>=0))return!(!r&&!o||o&&o.$stable)||i!==a&&(i?!a||Bt(i,a,l):!!a);if(1024&u)return!0;if(16&u)return i?Bt(i,a,l):!!a;if(8&u){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(a[n]!==i[n]&&!_t(l,n))return!0}}return!1}function Bt(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(t[s]!==e[s]&&!_t(n,s))return!0}return!1}function jt({vnode:e,parent:t},n){while(t){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i!==e)break;(e=t.vnode).el=n,t=t.parent}}const $t=e=>e.__isSuspense;function Gt(e,t){t&&t.pendingBranch?(0,r.cy)(e)?t.effects.push(...e):t.effects.push(e):T(e)}const Vt=Symbol.for("v-fgt"),Ht=Symbol.for("v-txt"),Kt=Symbol.for("v-cmt"),Wt=Symbol.for("v-stc"),qt=[];let Yt=null;function zt(e=!1){qt.push(Yt=e?null:[])}function Xt(){qt.pop(),Yt=qt[qt.length-1]||null}let Qt=1;function Jt(e,t=!1){Qt+=e,e<0&&Yt&&t&&(Yt.hasOnce=!0)}function Zt(e){return e.dynamicChildren=Qt>0?Yt||r.Oj:null,Xt(),Qt>0&&Yt&&Yt.push(e),e}function en(e,t,n,i,r,s){return Zt(on(e,t,n,i,r,s,!0))}function tn(e,t,n,i,r){return Zt(un(e,t,n,i,r,!0))}function nn(e){return!!e&&!0===e.__v_isVNode}function rn(e,t){return e.type===t.type&&e.key===t.key}const sn=({key:e})=>null!=e?e:null,an=({ref:e,ref_key:t,ref_for:n})=>("number"===typeof e&&(e=""+e),null!=e?(0,r.Kg)(e)||(0,i.i9)(e)||(0,r.Tn)(e)?{i:x,r:e,k:t,f:!!n}:e:null);function on(e,t=null,n=null,i=0,s=null,a=(e===Vt?0:1),o=!1,u=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&sn(t),ref:t&&an(t),scopeId:I,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:x};return u?(vn(l,n),128&a&&e.normalize(l)):n&&(l.shapeFlag|=(0,r.Kg)(n)?8:16),Qt>0&&!o&&Yt&&(l.patchFlag>0||6&a)&&32!==l.patchFlag&&Yt.push(l),l}const un=ln;function ln(e,t=null,n=null,s=0,a=null,o=!1){if(e&&e!==Te||(e=Kt),nn(e)){const i=dn(e,t,!0);return n&&vn(i,n),Qt>0&&!o&&Yt&&(6&i.shapeFlag?Yt[Yt.indexOf(e)]=i:Yt.push(i)),i.patchFlag=-2,i}if($n(e)&&(e=e.__vccOpts),t){t=cn(t);let{class:e,style:n}=t;e&&!(0,r.Kg)(e)&&(t.class=(0,r.C4)(e)),(0,r.Gv)(n)&&((0,i.ju)(n)&&!(0,r.cy)(n)&&(n=(0,r.X$)({},n)),t.style=(0,r.Tr)(n))}const u=(0,r.Kg)(e)?1:$t(e)?128:M(e)?64:(0,r.Gv)(e)?4:(0,r.Tn)(e)?2:0;return on(e,t,n,s,a,u,o,!0)}function cn(e){return e?(0,i.ju)(e)||Je(e)?(0,r.X$)({},e):e:null}function dn(e,t,n=!1,i=!1){const{props:s,ref:a,patchFlag:o,children:u,transition:l}=e,c=t?yn(s||{},t):s,d={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&sn(c),ref:t&&t.ref?n&&a?(0,r.cy)(a)?a.concat(an(t)):[a,an(t)]:an(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Vt?-1===o?16:16|o:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&dn(e.ssContent),ssFallback:e.ssFallback&&dn(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&i&&W(d,l.clone(d)),d}function hn(e=" ",t=0){return un(Ht,null,e,t)}function fn(e,t){const n=un(Wt,null,e);return n.staticCount=t,n}function pn(e="",t=!1){return t?(zt(),tn(Kt,null,e)):un(Kt,null,e)}function gn(e){return null==e||"boolean"===typeof e?un(Kt):(0,r.cy)(e)?un(Vt,null,e.slice()):nn(e)?mn(e):un(Ht,null,String(e))}function mn(e){return null===e.el&&-1!==e.patchFlag||e.memo?e:dn(e)}function vn(e,t){let n=0;const{shapeFlag:i}=e;if(null==t)t=null;else if((0,r.cy)(t))n=16;else if("object"===typeof t){if(65&i){const n=t.default;return void(n&&(n._c&&(n._d=!1),vn(e,n()),n._c&&(n._d=!0)))}{n=32;const i=t._;i||Je(t)?3===i&&x&&(1===x.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=x}}else(0,r.Tn)(t)?(t={default:t,_ctx:x},n=32):(t=String(t),64&i?(n=16,t=[hn(t)]):n=8);e.children=t,e.shapeFlag|=n}function yn(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const e in i)if("class"===e)t.class!==i.class&&(t.class=(0,r.C4)([t.class,i.class]));else if("style"===e)t.style=(0,r.Tr)([t.style,i.style]);else if((0,r.Mp)(e)){const n=t[e],s=i[e];!s||n===s||(0,r.cy)(n)&&n.includes(s)||(t[e]=n?[].concat(n,s):s)}else""!==e&&(t[e]=i[e])}return t}function bn(e,t,n,i=null){a(e,t,7,[n,i])}const Tn=He();let Sn=0;function En(e,t,n){const s=e.type,a=(t?t.appContext:e.appContext)||Tn,o={uid:Sn++,vnode:e,type:s,parent:t,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new i.yC(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(a.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:rt(s,a),emitsOptions:Pt(s,a),emit:null,emitted:null,propsDefaults:r.MZ,inheritAttrs:s.inheritAttrs,ctx:r.MZ,data:r.MZ,props:r.MZ,attrs:r.MZ,slots:r.MZ,refs:r.MZ,setupState:r.MZ,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=t?t.root:o,o.emit=Mt.bind(null,o),e.ce&&e.ce(o),o}let wn=null;const An=()=>wn||x;let xn,In;{const e=(0,r.We)(),t=(t,n)=>{let i;return(i=e[t])||(i=e[t]=[]),i.push(n),e=>{i.length>1?i.forEach(t=>t(e)):i[0](e)}};xn=t("__VUE_INSTANCE_SETTERS__",e=>wn=e),In=t("__VUE_SSR_SETTERS__",e=>Mn=e)}const kn=e=>{const t=wn;return xn(e),e.scope.on(),()=>{e.scope.off(),xn(t)}},Ln=()=>{wn&&wn.scope.off(),xn(null)};function Rn(e){return 4&e.vnode.shapeFlag}let Cn,Dn,Mn=!1;function Pn(e,t=!1,n=!1){t&&In(t);const{props:i,children:r}=e.vnode,s=Rn(e);Ze(e,i,s,t),ht(e,r,n||t);const a=s?_n(e,t):void 0;return t&&In(!1),a}function _n(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,ke);const{setup:a}=n;if(a){(0,i.C4)();const n=e.setupContext=a.length>1?Fn(e):null,u=kn(e),l=s(a,e,0,[e.props,n]),c=(0,r.yL)(l);if((0,i.bl)(),u(),!c&&!e.sp||Q(e)||z(e),c){if(l.then(Ln,Ln),t)return l.then(n=>{On(e,n,t)}).catch(t=>{o(t,e,0)});e.asyncDep=l}else On(e,l,t)}else Nn(e,t)}function On(e,t,n){(0,r.Tn)(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:(0,r.Gv)(t)&&(e.setupState=(0,i.Pr)(t)),Nn(e,n)}function Nn(e,t,n){const s=e.type;if(!e.render){if(!t&&Cn&&!s.render){const t=s.template||_e(e).template;if(t){0;const{isCustomElement:n,compilerOptions:i}=e.appContext.config,{delimiters:a,compilerOptions:o}=s,u=(0,r.X$)((0,r.X$)({isCustomElement:n,delimiters:a},i),o);s.render=Cn(t,u)}}e.render=s.render||r.tE,Dn&&Dn(e)}{const t=kn(e);(0,i.C4)();try{Ce(e)}finally{(0,i.bl)(),t()}}}const Un={get(e,t){return(0,i.u4)(e,"get",""),e[t]}};function Fn(e){const t=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,Un),slots:e.slots,emit:e.emit,expose:t}}function Bn(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy((0,i.Pr)((0,i.IG)(e.exposed)),{get(t,n){return n in t?t[n]:n in xe?xe[n](e):void 0},has(e,t){return t in e||t in xe}})):e.proxy}function jn(e,t=!0){return(0,r.Tn)(e)?e.displayName||e.name:e.name||t&&e.__name}function $n(e){return(0,r.Tn)(e)&&"__vccOpts"in e}const Gn=(e,t)=>{const n=(0,i.EW)(e,t,Mn);return n};function Vn(e,t,n){const i=arguments.length;return 2===i?(0,r.Gv)(t)&&!(0,r.cy)(t)?nn(t)?un(e,null,[t]):un(e,t):un(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):3===i&&nn(n)&&(n=[n]),un(e,t,n))}const Hn="3.5.16"},6801:function(e,t,n){"use strict";var i=n(3724),r=n(8686),s=n(4913),a=n(8551),o=n(5397),u=n(1072);t.f=i&&!r?Object.defineProperties:function(e,t){a(e);var n,i=o(t),r=u(t),l=r.length,c=0;while(l>c)s.f(e,n=r[c++],i[n]);return e}},6823:function(e){"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(n){return"Object"}}},6837:function(e){"use strict";var t=TypeError,n=9007199254740991;e.exports=function(e){if(e>n)throw t("Maximum allowed index exceeded");return e}},6840:function(e,t,n){"use strict";var i=n(4901),r=n(4913),s=n(283),a=n(9433);e.exports=function(e,t,n,o){o||(o={});var u=o.enumerable,l=void 0!==o.name?o.name:t;if(i(n)&&s(n,l,o),o.global)u?e[t]=n:a(t,n);else{try{o.unsafe?e[t]&&(u=!0):delete e[t]}catch(c){}u?e[t]=n:r.f(e,t,{value:n,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return e}},6892:function(e,t,n){"use strict";n.d(t,{y$:function(){return te},L8:function(){return se},aH:function(){return re},Pj:function(){return v}});n(4114),n(8111),n(2489),n(7588),n(1701),n(8237);var i=n(6768),r=n(144);function s(){return a().__VUE_DEVTOOLS_GLOBAL_HOOK__}function a(){return"undefined"!==typeof navigator&&"undefined"!==typeof window?window:"undefined"!==typeof globalThis?globalThis:{}}const o="function"===typeof Proxy,u="devtools-plugin:setup",l="plugin:settings:set";let c,d;function h(){var e;return void 0!==c||("undefined"!==typeof window&&window.performance?(c=!0,d=window.performance):"undefined"!==typeof globalThis&&(null===(e=globalThis.perf_hooks)||void 0===e?void 0:e.performance)?(c=!0,d=globalThis.perf_hooks.performance):c=!1),c}function f(){return h()?d.now():Date.now()}class p{constructor(e,t){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=t;const n={};if(e.settings)for(const a in e.settings){const t=e.settings[a];n[a]=t.defaultValue}const i=`__vue-devtools-plugin-settings__${e.id}`;let r=Object.assign({},n);try{const e=localStorage.getItem(i),t=JSON.parse(e);Object.assign(r,t)}catch(s){}this.fallbacks={getSettings(){return r},setSettings(e){try{localStorage.setItem(i,JSON.stringify(e))}catch(s){}r=e},now(){return f()}},t&&t.on(l,(e,t)=>{e===this.plugin.id&&this.fallbacks.setSettings(t)}),this.proxiedOn=new Proxy({},{get:(e,t)=>this.target?this.target.on[t]:(...e)=>{this.onQueue.push({method:t,args:e})}}),this.proxiedTarget=new Proxy({},{get:(e,t)=>this.target?this.target[t]:"on"===t?this.proxiedOn:Object.keys(this.fallbacks).includes(t)?(...e)=>(this.targetQueue.push({method:t,args:e,resolve:()=>{}}),this.fallbacks[t](...e)):(...e)=>new Promise(n=>{this.targetQueue.push({method:t,args:e,resolve:n})})})}async setRealTarget(e){this.target=e;for(const t of this.onQueue)this.target.on[t.method](...t.args);for(const t of this.targetQueue)t.resolve(await this.target[t.method](...t.args))}}function g(e,t){const n=e,i=a(),r=s(),l=o&&n.enableEarlyProxy;if(!r||!i.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__&&l){const e=l?new p(n,r):null,s=i.__VUE_DEVTOOLS_PLUGINS__=i.__VUE_DEVTOOLS_PLUGINS__||[];s.push({pluginDescriptor:n,setupFn:t,proxy:e}),e&&t(e.proxiedTarget)}else r.emit(u,e,t)}
/*!
 * vuex v4.1.0
 * (c) 2022 Evan You
 * @license MIT
 */
var m="store";function v(e){return void 0===e&&(e=null),(0,i.WQ)(null!==e?e:m)}function y(e,t){Object.keys(e).forEach(function(n){return t(e[n],n)})}function b(e){return null!==e&&"object"===typeof e}function T(e){return e&&"function"===typeof e.then}function S(e,t){return function(){return e(t)}}function E(e,t,n){return t.indexOf(e)<0&&(n&&n.prepend?t.unshift(e):t.push(e)),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function w(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var n=e.state;x(e,n,[],e._modules.root,!0),A(e,n,t)}function A(e,t,n){var s=e._state,a=e._scope;e.getters={},e._makeLocalGettersCache=Object.create(null);var o=e._wrappedGetters,u={},l={},c=(0,r.uY)(!0);c.run(function(){y(o,function(t,n){u[n]=S(t,e),l[n]=(0,i.EW)(function(){return u[n]()}),Object.defineProperty(e.getters,n,{get:function(){return l[n].value},enumerable:!0})})}),e._state=(0,r.Kh)({data:t}),e._scope=c,e.strict&&D(e),s&&n&&e._withCommit(function(){s.data=null}),a&&a.stop()}function x(e,t,n,i,r){var s=!n.length,a=e._modules.getNamespace(n);if(i.namespaced&&(e._modulesNamespaceMap[a],e._modulesNamespaceMap[a]=i),!s&&!r){var o=M(t,n.slice(0,-1)),u=n[n.length-1];e._withCommit(function(){o[u]=i.state})}var l=i.context=I(e,a,n);i.forEachMutation(function(t,n){var i=a+n;L(e,i,t,l)}),i.forEachAction(function(t,n){var i=t.root?n:a+n,r=t.handler||t;R(e,i,r,l)}),i.forEachGetter(function(t,n){var i=a+n;C(e,i,t,l)}),i.forEachChild(function(i,s){x(e,t,n.concat(s),i,r)})}function I(e,t,n){var i=""===t,r={dispatch:i?e.dispatch:function(n,i,r){var s=P(n,i,r),a=s.payload,o=s.options,u=s.type;return o&&o.root||(u=t+u),e.dispatch(u,a)},commit:i?e.commit:function(n,i,r){var s=P(n,i,r),a=s.payload,o=s.options,u=s.type;o&&o.root||(u=t+u),e.commit(u,a,o)}};return Object.defineProperties(r,{getters:{get:i?function(){return e.getters}:function(){return k(e,t)}},state:{get:function(){return M(e.state,n)}}}),r}function k(e,t){if(!e._makeLocalGettersCache[t]){var n={},i=t.length;Object.keys(e.getters).forEach(function(r){if(r.slice(0,i)===t){var s=r.slice(i);Object.defineProperty(n,s,{get:function(){return e.getters[r]},enumerable:!0})}}),e._makeLocalGettersCache[t]=n}return e._makeLocalGettersCache[t]}function L(e,t,n,i){var r=e._mutations[t]||(e._mutations[t]=[]);r.push(function(t){n.call(e,i.state,t)})}function R(e,t,n,i){var r=e._actions[t]||(e._actions[t]=[]);r.push(function(t){var r=n.call(e,{dispatch:i.dispatch,commit:i.commit,getters:i.getters,state:i.state,rootGetters:e.getters,rootState:e.state},t);return T(r)||(r=Promise.resolve(r)),e._devtoolHook?r.catch(function(t){throw e._devtoolHook.emit("vuex:error",t),t}):r})}function C(e,t,n,i){e._wrappedGetters[t]||(e._wrappedGetters[t]=function(e){return n(i.state,i.getters,e.state,e.getters)})}function D(e){(0,i.wB)(function(){return e._state.data},function(){0},{deep:!0,flush:"sync"})}function M(e,t){return t.reduce(function(e,t){return e[t]},e)}function P(e,t,n){return b(e)&&e.type&&(n=t,t=e,e=e.type),{type:e,payload:t,options:n}}var _="vuex bindings",O="vuex:mutations",N="vuex:actions",U="vuex",F=0;function B(e,t){g({id:"org.vuejs.vuex",app:e,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[_]},function(n){n.addTimelineLayer({id:O,label:"Vuex Mutations",color:j}),n.addTimelineLayer({id:N,label:"Vuex Actions",color:j}),n.addInspector({id:U,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),n.on.getInspectorTree(function(n){if(n.app===e&&n.inspectorId===U)if(n.filter){var i=[];W(i,t._modules.root,n.filter,""),n.rootNodes=i}else n.rootNodes=[K(t._modules.root,"")]}),n.on.getInspectorState(function(n){if(n.app===e&&n.inspectorId===U){var i=n.nodeId;k(t,i),n.state=q(z(t._modules,i),"root"===i?t.getters:t._makeLocalGettersCache,i)}}),n.on.editInspectorState(function(n){if(n.app===e&&n.inspectorId===U){var i=n.nodeId,r=n.path;"root"!==i&&(r=i.split("/").filter(Boolean).concat(r)),t._withCommit(function(){n.set(t._state.data,r,n.state.value)})}}),t.subscribe(function(e,t){var i={};e.payload&&(i.payload=e.payload),i.state=t,n.notifyComponentUpdate(),n.sendInspectorTree(U),n.sendInspectorState(U),n.addTimelineEvent({layerId:O,event:{time:Date.now(),title:e.type,data:i}})}),t.subscribeAction({before:function(e,t){var i={};e.payload&&(i.payload=e.payload),e._id=F++,e._time=Date.now(),i.state=t,n.addTimelineEvent({layerId:N,event:{time:e._time,title:e.type,groupId:e._id,subtitle:"start",data:i}})},after:function(e,t){var i={},r=Date.now()-e._time;i.duration={_custom:{type:"duration",display:r+"ms",tooltip:"Action duration",value:r}},e.payload&&(i.payload=e.payload),i.state=t,n.addTimelineEvent({layerId:N,event:{time:Date.now(),title:e.type,groupId:e._id,subtitle:"end",data:i}})}})})}var j=8702998,$=6710886,G=16777215,V={label:"namespaced",textColor:G,backgroundColor:$};function H(e){return e&&"root"!==e?e.split("/").slice(-2,-1)[0]:"Root"}function K(e,t){return{id:t||"root",label:H(t),tags:e.namespaced?[V]:[],children:Object.keys(e._children).map(function(n){return K(e._children[n],t+n+"/")})}}function W(e,t,n,i){i.includes(n)&&e.push({id:i||"root",label:i.endsWith("/")?i.slice(0,i.length-1):i||"Root",tags:t.namespaced?[V]:[]}),Object.keys(t._children).forEach(function(r){W(e,t._children[r],n,i+r+"/")})}function q(e,t,n){t="root"===n?t:t[n];var i=Object.keys(t),r={state:Object.keys(e.state).map(function(t){return{key:t,editable:!0,value:e.state[t]}})};if(i.length){var s=Y(t);r.getters=Object.keys(s).map(function(e){return{key:e.endsWith("/")?H(e):e,editable:!1,value:X(function(){return s[e]})}})}return r}function Y(e){var t={};return Object.keys(e).forEach(function(n){var i=n.split("/");if(i.length>1){var r=t,s=i.pop();i.forEach(function(e){r[e]||(r[e]={_custom:{value:{},display:e,tooltip:"Module",abstract:!0}}),r=r[e]._custom.value}),r[s]=X(function(){return e[n]})}else t[n]=X(function(){return e[n]})}),t}function z(e,t){var n=t.split("/").filter(function(e){return e});return n.reduce(function(e,i,r){var s=e[i];if(!s)throw new Error('Missing module "'+i+'" for path "'+t+'".');return r===n.length-1?s:s._children},"root"===t?e:e.root._children)}function X(e){try{return e()}catch(t){return t}}var Q=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var n=e.state;this.state=("function"===typeof n?n():n)||{}},J={namespaced:{configurable:!0}};J.namespaced.get=function(){return!!this._rawModule.namespaced},Q.prototype.addChild=function(e,t){this._children[e]=t},Q.prototype.removeChild=function(e){delete this._children[e]},Q.prototype.getChild=function(e){return this._children[e]},Q.prototype.hasChild=function(e){return e in this._children},Q.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},Q.prototype.forEachChild=function(e){y(this._children,e)},Q.prototype.forEachGetter=function(e){this._rawModule.getters&&y(this._rawModule.getters,e)},Q.prototype.forEachAction=function(e){this._rawModule.actions&&y(this._rawModule.actions,e)},Q.prototype.forEachMutation=function(e){this._rawModule.mutations&&y(this._rawModule.mutations,e)},Object.defineProperties(Q.prototype,J);var Z=function(e){this.register([],e,!1)};function ee(e,t,n){if(t.update(n),n.modules)for(var i in n.modules){if(!t.getChild(i))return void 0;ee(e.concat(i),t.getChild(i),n.modules[i])}}Z.prototype.get=function(e){return e.reduce(function(e,t){return e.getChild(t)},this.root)},Z.prototype.getNamespace=function(e){var t=this.root;return e.reduce(function(e,n){return t=t.getChild(n),e+(t.namespaced?n+"/":"")},"")},Z.prototype.update=function(e){ee([],this.root,e)},Z.prototype.register=function(e,t,n){var i=this;void 0===n&&(n=!0);var r=new Q(t,n);if(0===e.length)this.root=r;else{var s=this.get(e.slice(0,-1));s.addChild(e[e.length-1],r)}t.modules&&y(t.modules,function(t,r){i.register(e.concat(r),t,n)})},Z.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1],i=t.getChild(n);i&&i.runtime&&t.removeChild(n)},Z.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1];return!!t&&t.hasChild(n)};function te(e){return new ne(e)}var ne=function(e){var t=this;void 0===e&&(e={});var n=e.plugins;void 0===n&&(n=[]);var i=e.strict;void 0===i&&(i=!1);var r=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new Z(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=r;var s=this,a=this,o=a.dispatch,u=a.commit;this.dispatch=function(e,t){return o.call(s,e,t)},this.commit=function(e,t,n){return u.call(s,e,t,n)},this.strict=i;var l=this._modules.root.state;x(this,l,[],this._modules.root),A(this,l),n.forEach(function(e){return e(t)})},ie={state:{configurable:!0}};ne.prototype.install=function(e,t){e.provide(t||m,this),e.config.globalProperties.$store=this;var n=void 0!==this._devtools&&this._devtools;n&&B(e,this)},ie.state.get=function(){return this._state.data},ie.state.set=function(e){0},ne.prototype.commit=function(e,t,n){var i=this,r=P(e,t,n),s=r.type,a=r.payload,o=(r.options,{type:s,payload:a}),u=this._mutations[s];u&&(this._withCommit(function(){u.forEach(function(e){e(a)})}),this._subscribers.slice().forEach(function(e){return e(o,i.state)}))},ne.prototype.dispatch=function(e,t){var n=this,i=P(e,t),r=i.type,s=i.payload,a={type:r,payload:s},o=this._actions[r];if(o){try{this._actionSubscribers.slice().filter(function(e){return e.before}).forEach(function(e){return e.before(a,n.state)})}catch(l){0}var u=o.length>1?Promise.all(o.map(function(e){return e(s)})):o[0](s);return new Promise(function(e,t){u.then(function(t){try{n._actionSubscribers.filter(function(e){return e.after}).forEach(function(e){return e.after(a,n.state)})}catch(l){0}e(t)},function(e){try{n._actionSubscribers.filter(function(e){return e.error}).forEach(function(t){return t.error(a,n.state,e)})}catch(l){0}t(e)})})}},ne.prototype.subscribe=function(e,t){return E(e,this._subscribers,t)},ne.prototype.subscribeAction=function(e,t){var n="function"===typeof e?{before:e}:e;return E(n,this._actionSubscribers,t)},ne.prototype.watch=function(e,t,n){var r=this;return(0,i.wB)(function(){return e(r.state,r.getters)},t,Object.assign({},n))},ne.prototype.replaceState=function(e){var t=this;this._withCommit(function(){t._state.data=e})},ne.prototype.registerModule=function(e,t,n){void 0===n&&(n={}),"string"===typeof e&&(e=[e]),this._modules.register(e,t),x(this,this.state,e,this._modules.get(e),n.preserveState),A(this,this.state)},ne.prototype.unregisterModule=function(e){var t=this;"string"===typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit(function(){var n=M(t.state,e.slice(0,-1));delete n[e[e.length-1]]}),w(this)},ne.prototype.hasModule=function(e){return"string"===typeof e&&(e=[e]),this._modules.isRegistered(e)},ne.prototype.hotUpdate=function(e){this._modules.update(e),w(this,!0)},ne.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(ne.prototype,ie);var re=ue(function(e,t){var n={};return ae(t).forEach(function(t){var i=t.key,r=t.val;n[i]=function(){var t=this.$store.state,n=this.$store.getters;if(e){var i=le(this.$store,"mapState",e);if(!i)return;t=i.context.state,n=i.context.getters}return"function"===typeof r?r.call(this,t,n):t[r]},n[i].vuex=!0}),n}),se=(ue(function(e,t){var n={};return ae(t).forEach(function(t){var i=t.key,r=t.val;n[i]=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];var i=this.$store.commit;if(e){var s=le(this.$store,"mapMutations",e);if(!s)return;i=s.context.commit}return"function"===typeof r?r.apply(this,[i].concat(t)):i.apply(this.$store,[r].concat(t))}}),n}),ue(function(e,t){var n={};return ae(t).forEach(function(t){var i=t.key,r=t.val;r=e+r,n[i]=function(){if(!e||le(this.$store,"mapGetters",e))return this.$store.getters[r]},n[i].vuex=!0}),n}));ue(function(e,t){var n={};return ae(t).forEach(function(t){var i=t.key,r=t.val;n[i]=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];var i=this.$store.dispatch;if(e){var s=le(this.$store,"mapActions",e);if(!s)return;i=s.context.dispatch}return"function"===typeof r?r.apply(this,[i].concat(t)):i.apply(this.$store,[r].concat(t))}}),n});function ae(e){return oe(e)?Array.isArray(e)?e.map(function(e){return{key:e,val:e}}):Object.keys(e).map(function(t){return{key:t,val:e[t]}}):[]}function oe(e){return Array.isArray(e)||b(e)}function ue(e){return function(t,n){return"string"!==typeof t?(n=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,n)}}function le(e,t,n){var i=e._modulesNamespaceMap[n];return i}},6955:function(e,t,n){"use strict";var i=n(2140),r=n(4901),s=n(2195),a=n(8227),o=a("toStringTag"),u=Object,l="Arguments"===s(function(){return arguments}()),c=function(e,t){try{return e[t]}catch(n){}};e.exports=i?s:function(e){var t,n,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=c(t=u(e),o))?n:l?s(t):"Object"===(i=s(t))&&r(t.callee)?"Arguments":i}},6969:function(e,t,n){"use strict";var i=n(2777),r=n(757);e.exports=function(e){var t=i(e,"string");return r(t)?t:t+""}},6980:function(e){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},7014:function(e,t,n){"use strict";n.d(t,{c:function(){return s}});var i=n(4156),r=n(1712);function s(e,t,n){const[s,o]=(0,i.x)(n?.in,e,t),u=a(s,o),l=Math.abs((0,r.m)(s,o));s.setDate(s.getDate()-u*l);const c=Number(a(s,o)===-u),d=u*(l-c);return 0===d?0:d}function a(e,t){const n=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return n<0?-1:n>0?1:n}},7040:function(e,t,n){"use strict";var i=n(4495);e.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7055:function(e,t,n){"use strict";var i=n(9504),r=n(9039),s=n(2195),a=Object,o=i("".split);e.exports=r(function(){return!a("z").propertyIsEnumerable(0)})?function(e){return"String"===s(e)?o(e,""):a(e)}:a},7080:function(e,t,n){"use strict";var i=n(4402).has;e.exports=function(e){return i(e),e}},7347:function(e,t,n){"use strict";var i=n(3724),r=n(9565),s=n(8773),a=n(6980),o=n(5397),u=n(6969),l=n(9297),c=n(5917),d=Object.getOwnPropertyDescriptor;t.f=i?d:function(e,t){if(e=o(e),t=u(t),c)try{return d(e,t)}catch(n){}if(l(e,t))return a(!r(s.f,e,t),e[t])}},7476:function(e,t,n){"use strict";var i=n(2195),r=n(9504);e.exports=function(e){if("Function"===i(e))return r(e)}},7588:function(e,t,n){"use strict";var i=n(6518),r=n(9565),s=n(2652),a=n(9306),o=n(8551),u=n(1767),l=n(9539),c=n(4549),d=c("forEach",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:d},{forEach:function(e){o(this);try{a(e)}catch(i){l(this,"throw",i)}if(d)return r(d,this,e);var t=u(this),n=0;s(t,function(t){e(t,n++)},{IS_RECORD:!0})}})},7629:function(e,t,n){"use strict";var i=n(6395),r=n(4576),s=n(9433),a="__core-js_shared__",o=e.exports=r[a]||s(a,{});(o.versions||(o.versions=[])).push({version:"3.43.0",mode:i?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"})},7642:function(e,t,n){"use strict";var i=n(6518),r=n(3440),s=n(9039),a=n(4916),o=!a("difference",function(e){return 0===e.size}),u=o||s(function(){var e={size:1,has:function(){return!0},keys:function(){var e=0;return{next:function(){var n=e++>1;return t.has(1)&&t.clear(),{done:n,value:2}}}}},t=new Set([1,2,3,4]);return 3!==t.difference(e).size});i({target:"Set",proto:!0,real:!0,forced:u},{difference:r})},7657:function(e,t,n){"use strict";var i,r,s,a=n(9039),o=n(4901),u=n(34),l=n(2360),c=n(2787),d=n(6840),h=n(8227),f=n(6395),p=h("iterator"),g=!1;[].keys&&(s=[].keys(),"next"in s?(r=c(c(s)),r!==Object.prototype&&(i=r)):g=!0);var m=!u(i)||a(function(){var e={};return i[p].call(e)!==e});m?i={}:f&&(i=l(i)),o(i[p])||d(i,p,function(){return this}),e.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:g}},7680:function(e,t,n){"use strict";var i=n(9504);e.exports=i([].slice)},7740:function(e,t,n){"use strict";var i=n(9297),r=n(5031),s=n(7347),a=n(4913);e.exports=function(e,t,n){for(var o=r(t),u=a.f,l=s.f,c=0;c<o.length;c++){var d=o[c];i(e,d)||n&&i(n,d)||u(e,d,l(t,d))}}},7750:function(e,t,n){"use strict";var i=n(4117),r=TypeError;e.exports=function(e){if(i(e))throw new r("Can't call method on "+e);return e}},7751:function(e,t,n){"use strict";var i=n(4576),r=n(4901),s=function(e){return r(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?s(i[e]):i[e]&&i[e][t]}},7811:function(e){"use strict";e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},8004:function(e,t,n){"use strict";var i=n(6518),r=n(9039),s=n(8750),a=n(4916),o=!a("intersection",function(e){return 2===e.size&&e.has(1)&&e.has(2)})||r(function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))});i({target:"Set",proto:!0,real:!0,forced:o},{intersection:s})},8014:function(e,t,n){"use strict";var i=n(1291),r=Math.min;e.exports=function(e){var t=i(e);return t>0?r(t,9007199254740991):0}},8111:function(e,t,n){"use strict";var i=n(6518),r=n(4576),s=n(679),a=n(8551),o=n(4901),u=n(2787),l=n(2106),c=n(4659),d=n(9039),h=n(9297),f=n(8227),p=n(7657).IteratorPrototype,g=n(3724),m=n(6395),v="constructor",y="Iterator",b=f("toStringTag"),T=TypeError,S=r[y],E=m||!o(S)||S.prototype!==p||!d(function(){S({})}),w=function(){if(s(this,p),u(this)===p)throw new T("Abstract class Iterator not directly constructable")},A=function(e,t){g?l(p,e,{configurable:!0,get:function(){return t},set:function(t){if(a(this),this===p)throw new T("You can't redefine this property");h(this,e)?this[e]=t:c(this,e,t)}}):p[e]=t};h(p,b)||A(b,y),!E&&h(p,v)&&p[v]!==Object||A(v,w),w.prototype=p,i({global:!0,constructor:!0,forced:E},{Iterator:w})},8227:function(e,t,n){"use strict";var i=n(4576),r=n(5745),s=n(9297),a=n(3392),o=n(4495),u=n(7040),l=i.Symbol,c=r("wks"),d=u?l["for"]||l:l&&l.withoutSetter||a;e.exports=function(e){return s(c,e)||(c[e]=o&&s(l,e)?l[e]:d("Symbol."+e)),c[e]}},8237:function(e,t,n){"use strict";var i=n(6518),r=n(2652),s=n(9306),a=n(8551),o=n(1767),u=n(9539),l=n(4549),c=n(8745),d=n(9039),h=TypeError,f=d(function(){[].keys().reduce(function(){},void 0)}),p=!f&&l("reduce",h);i({target:"Iterator",proto:!0,real:!0,forced:f||p},{reduce:function(e){a(this);try{s(e)}catch(d){u(this,"throw",d)}var t=arguments.length<2,n=t?void 0:arguments[1];if(p)return c(p,this,t?[e]:[e,n]);var i=o(this),l=0;if(r(i,function(i){t?(t=!1,n=i):n=e(n,i,l),l++},{IS_RECORD:!0}),t)throw new h("Reduce of empty iterator with no initial value");return n}})},8469:function(e,t,n){"use strict";var i=n(9504),r=n(507),s=n(4402),a=s.Set,o=s.proto,u=i(o.forEach),l=i(o.keys),c=l(new a).next;e.exports=function(e,t,n){return n?r({iterator:l(e),next:c},t):u(e,t)}},8480:function(e,t,n){"use strict";var i=n(1828),r=n(8727),s=r.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,s)}},8527:function(e,t,n){"use strict";var i=n(7080),r=n(4402).has,s=n(5170),a=n(3789),o=n(507),u=n(9539);e.exports=function(e){var t=i(this),n=a(e);if(s(t)<n.size)return!1;var l=n.getIterator();return!1!==o(l,function(e){if(!r(t,e))return u(l,"normal",!1)})}},8541:function(e,t,n){"use strict";n.d(t,{c:function(){return F}});const i={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},r=(e,t,n)=>{let r;const s=i[e];return r="string"===typeof s?s:1===t?s.one:s.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function s(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth,i=e.formats[n]||e.formats[e.defaultWidth];return i}}const a={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},o={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},u={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},l={date:s({formats:a,defaultWidth:"full"}),time:s({formats:o,defaultWidth:"full"}),dateTime:s({formats:u,defaultWidth:"full"})},c={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},d=(e,t,n,i)=>c[e];function h(e){return(t,n)=>{const i=n?.context?String(n.context):"standalone";let r;if("formatting"===i&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,i=n?.width?String(n.width):t;r=e.formattingValues[i]||e.formattingValues[t]}else{const t=e.defaultWidth,i=n?.width?String(n.width):e.defaultWidth;r=e.values[i]||e.values[t]}const s=e.argumentCallback?e.argumentCallback(t):t;return r[s]}}const f={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},p={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},g={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},m={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},v={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},y={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},b=(e,t)=>{const n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},T={ordinalNumber:b,era:h({values:f,defaultWidth:"wide"}),quarter:h({values:p,defaultWidth:"wide",argumentCallback:e=>e-1}),month:h({values:g,defaultWidth:"wide"}),day:h({values:m,defaultWidth:"wide"}),dayPeriod:h({values:v,defaultWidth:"wide",formattingValues:y,defaultFormattingWidth:"wide"})};function S(e){return(t,n={})=>{const i=n.width,r=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],s=t.match(r);if(!s)return null;const a=s[0],o=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(o)?w(o,e=>e.test(a)):E(o,e=>e.test(a));let l;l=e.valueCallback?e.valueCallback(u):u,l=n.valueCallback?n.valueCallback(l):l;const c=t.slice(a.length);return{value:l,rest:c}}}function E(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function w(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function A(e){return(t,n={})=>{const i=t.match(e.matchPattern);if(!i)return null;const r=i[0],s=t.match(e.parsePattern);if(!s)return null;let a=e.valueCallback?e.valueCallback(s[0]):s[0];a=n.valueCallback?n.valueCallback(a):a;const o=t.slice(r.length);return{value:a,rest:o}}}const x=/^(\d+)(th|st|nd|rd)?/i,I=/\d+/i,k={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},L={any:[/^b/i,/^(a|c)/i]},R={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},C={any:[/1/i,/2/i,/3/i,/4/i]},D={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},M={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},P={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},_={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},O={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},N={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},U={ordinalNumber:A({matchPattern:x,parsePattern:I,valueCallback:e=>parseInt(e,10)}),era:S({matchPatterns:k,defaultMatchWidth:"wide",parsePatterns:L,defaultParseWidth:"any"}),quarter:S({matchPatterns:R,defaultMatchWidth:"wide",parsePatterns:C,defaultParseWidth:"any",valueCallback:e=>e+1}),month:S({matchPatterns:D,defaultMatchWidth:"wide",parsePatterns:M,defaultParseWidth:"any"}),day:S({matchPatterns:P,defaultMatchWidth:"wide",parsePatterns:_,defaultParseWidth:"any"}),dayPeriod:S({matchPatterns:O,defaultMatchWidth:"any",parsePatterns:N,defaultParseWidth:"any"})},F={code:"en-US",formatDistance:r,formatLong:l,formatRelative:d,localize:T,match:U,options:{weekStartsOn:0,firstWeekContainsDate:1}}},8551:function(e,t,n){"use strict";var i=n(34),r=String,s=TypeError;e.exports=function(e){if(i(e))return e;throw new s(r(e)+" is not an object")}},8574:function(e,t,n){"use strict";var i=n(9504),r=Error,s=i("".replace),a=function(e){return String(new r(e).stack)}("zxcasd"),o=/\n\s*at [^:]*:[^\n]*/,u=o.test(a);e.exports=function(e,t){if(u&&"string"==typeof e&&!r.prepareStackTrace)while(t--)e=s(e,o,"");return e}},8622:function(e,t,n){"use strict";var i=n(4576),r=n(4901),s=i.WeakMap;e.exports=r(s)&&/native code/.test(String(s))},8646:function(e,t,n){"use strict";var i=n(9565),r=n(8551),s=n(1767),a=n(851);e.exports=function(e,t){t&&"string"===typeof e||r(e);var n=a(e);return s(r(void 0!==n?i(n,e):e))}},8686:function(e,t,n){"use strict";var i=n(3724),r=n(9039);e.exports=i&&r(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},8727:function(e){"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8745:function(e,t,n){"use strict";var i=n(616),r=Function.prototype,s=r.apply,a=r.call;e.exports="object"==typeof Reflect&&Reflect.apply||(i?a.bind(s):function(){return a.apply(s,arguments)})},8750:function(e,t,n){"use strict";var i=n(7080),r=n(4402),s=n(5170),a=n(3789),o=n(8469),u=n(507),l=r.Set,c=r.add,d=r.has;e.exports=function(e){var t=i(this),n=a(e),r=new l;return s(t)>n.size?u(n.getIterator(),function(e){d(t,e)&&c(r,e)}):o(t,function(e){n.includes(e)&&c(r,e)}),r}},8773:function(e,t){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,r=i&&!n.call({1:2},1);t.f=r?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},8981:function(e,t,n){"use strict";var i=n(7750),r=Object;e.exports=function(e){return r(i(e))}},9039:function(e){"use strict";e.exports=function(e){try{return!!e()}catch(t){return!0}}},9225:function(e,t,n){"use strict";var i,r,s,a,o=n(4576),u=n(8745),l=n(6080),c=n(4901),d=n(9297),h=n(9039),f=n(397),p=n(7680),g=n(4055),m=n(2812),v=n(9544),y=n(6193),b=o.setImmediate,T=o.clearImmediate,S=o.process,E=o.Dispatch,w=o.Function,A=o.MessageChannel,x=o.String,I=0,k={},L="onreadystatechange";h(function(){i=o.location});var R=function(e){if(d(k,e)){var t=k[e];delete k[e],t()}},C=function(e){return function(){R(e)}},D=function(e){R(e.data)},M=function(e){o.postMessage(x(e),i.protocol+"//"+i.host)};b&&T||(b=function(e){m(arguments.length,1);var t=c(e)?e:w(e),n=p(arguments,1);return k[++I]=function(){u(t,void 0,n)},r(I),I},T=function(e){delete k[e]},y?r=function(e){S.nextTick(C(e))}:E&&E.now?r=function(e){E.now(C(e))}:A&&!v?(s=new A,a=s.port2,s.port1.onmessage=D,r=l(a.postMessage,a)):o.addEventListener&&c(o.postMessage)&&!o.importScripts&&i&&"file:"!==i.protocol&&!h(M)?(r=M,o.addEventListener("message",D,!1)):r=L in g("script")?function(e){f.appendChild(g("script"))[L]=function(){f.removeChild(this),R(e)}}:function(e){setTimeout(C(e),0)}),e.exports={set:b,clear:T}},9286:function(e,t,n){"use strict";var i=n(4402),r=n(8469),s=i.Set,a=i.add;e.exports=function(e){var t=new s;return r(e,function(e){a(t,e)}),t}},9297:function(e,t,n){"use strict";var i=n(9504),r=n(8981),s=i({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(r(e),t)}},9306:function(e,t,n){"use strict";var i=n(4901),r=n(6823),s=TypeError;e.exports=function(e){if(i(e))return e;throw new s(r(e)+" is not a function")}},9309:function(e,t,n){"use strict";var i=n(6518),r=n(4576),s=n(9225).set,a=n(9472),o=r.setImmediate?a(s,!1):s;i({global:!0,bind:!0,enumerable:!0,forced:r.setImmediate!==o},{setImmediate:o})},9369:function(e,t,n){"use strict";n.d(t,{q:function(){return r}});let i={};function r(){return i}},9433:function(e,t,n){"use strict";var i=n(4576),r=Object.defineProperty;e.exports=function(e,t){try{r(i,e,{value:t,configurable:!0,writable:!0})}catch(n){i[e]=t}return t}},9462:function(e,t,n){"use strict";var i=n(9565),r=n(2360),s=n(6699),a=n(6279),o=n(8227),u=n(1181),l=n(5966),c=n(7657).IteratorPrototype,d=n(2529),h=n(9539),f=n(1385),p=o("toStringTag"),g="IteratorHelper",m="WrapForValidIterator",v="normal",y="throw",b=u.set,T=function(e){var t=u.getterFor(e?m:g);return a(r(c),{next:function(){var n=t(this);if(e)return n.nextHandler();if(n.done)return d(void 0,!0);try{var i=n.nextHandler();return n.returnHandlerResult?i:d(i,n.done)}catch(r){throw n.done=!0,r}},return:function(){var n=t(this),r=n.iterator;if(n.done=!0,e){var s=l(r,"return");return s?i(s,r):d(void 0,!0)}if(n.inner)try{h(n.inner.iterator,v)}catch(a){return h(r,y,a)}if(n.openIters)try{f(n.openIters,v)}catch(a){return h(r,y,a)}return r&&h(r,v),d(void 0,!0)}})},S=T(!0),E=T(!1);s(E,p,"Iterator Helper"),e.exports=function(e,t,n){var i=function(i,r){r?(r.iterator=i.iterator,r.next=i.next):r=i,r.type=t?m:g,r.returnHandlerResult=!!n,r.nextHandler=e,r.counter=0,r.done=!1,b(this,r)};return i.prototype=t?S:E,i}},9472:function(e,t,n){"use strict";var i=n(4576),r=n(8745),s=n(4901),a=n(4215),o=n(2839),u=n(7680),l=n(2812),c=i.Function,d=/MSIE .\./.test(o)||"BUN"===a&&function(){var e=i.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}();e.exports=function(e,t){var n=t?2:1;return d?function(i,a){var o=l(arguments.length,1)>n,d=s(i)?i:c(i),h=o?u(arguments,n):[],f=o?function(){r(d,this,h)}:d;return t?e(f,a):e(f)}:e}},9504:function(e,t,n){"use strict";var i=n(616),r=Function.prototype,s=r.call,a=i&&r.bind.bind(s,s);e.exports=i?a:function(e){return function(){return s.apply(e,arguments)}}},9519:function(e,t,n){"use strict";var i,r,s=n(4576),a=n(2839),o=s.process,u=s.Deno,l=o&&o.versions||u&&u.version,c=l&&l.v8;c&&(i=c.split("."),r=i[0]>0&&i[0]<4?1:+(i[0]+i[1])),!r&&a&&(i=a.match(/Edge\/(\d+)/),(!i||i[1]>=74)&&(i=a.match(/Chrome\/(\d+)/),i&&(r=+i[1]))),e.exports=r},9539:function(e,t,n){"use strict";var i=n(9565),r=n(8551),s=n(5966);e.exports=function(e,t,n){var a,o;r(e);try{if(a=s(e,"return"),!a){if("throw"===t)throw n;return n}a=i(a,e)}catch(u){o=!0,a=u}if("throw"===t)throw n;if(o)throw a;return r(a),n}},9544:function(e,t,n){"use strict";var i=n(2839);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)},9565:function(e,t,n){"use strict";var i=n(616),r=Function.prototype.call;e.exports=i?r.bind(r):function(){return r.apply(r,arguments)}},9577:function(e,t,n){"use strict";var i=n(9928),r=n(4644),s=n(1108),a=n(1291),o=n(5854),u=r.aTypedArray,l=r.getTypedArrayConstructor,c=r.exportTypedArrayMethod,d=function(){try{new Int8Array(1)["with"](2,{valueOf:function(){throw 8}})}catch(e){return 8===e}}(),h=d&&function(){try{new Int8Array(1)["with"](-.5,1)}catch(e){return!0}}();c("with",{with:function(e,t){var n=u(this),r=a(e),c=s(n)?o(t):+t;return i(n,l(n),r,c)}}["with"],!d||h)},9617:function(e,t,n){"use strict";var i=n(5397),r=n(5610),s=n(6198),a=function(e){return function(t,n,a){var o=i(t),u=s(o);if(0===u)return!e&&-1;var l,c=r(a,u);if(e&&n!==n){while(u>c)if(l=o[c++],l!==l)return!0}else for(;u>c;c++)if((e||c in o)&&o[c]===n)return e||c||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},9835:function(e){"use strict";e.exports=function(e){try{var t=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return t.clear(),t.add(4),function(){return{done:!0}}}})}},i=t[e](n);return 1!==i.size||4!==i.values().next().value}catch(r){return!1}}},9848:function(e,t,n){"use strict";n(6368),n(9309)},9928:function(e,t,n){"use strict";var i=n(6198),r=n(1291),s=RangeError;e.exports=function(e,t,n,a){var o=i(e),u=r(n),l=u<0?o+u:u;if(l>=o||l<0)throw new s("Incorrect index");for(var c=new t(o),d=0;d<o;d++)c[d]=d===l?a:e[d];return c}}}]);
//# sourceMappingURL=chunk-vendors.3e782248.js.map