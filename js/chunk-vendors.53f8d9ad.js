(self["webpackChunkno1ott_vujs"]=self["webpackChunkno1ott_vujs"]||[]).push([[504],{34:function(e,t,n){"use strict";var i=n(4901);e.exports=function(e){return"object"==typeof e?null!==e:i(e)}},81:function(e,t,n){"use strict";var i=n(9565),r=n(9306),s=n(8551),a=n(6823),o=n(851),u=TypeError;e.exports=function(e,t){var n=arguments.length<2?o(e):t;if(r(n))return s(i(n,e));throw new u(a(e)+" is not iterable")}},116:function(e,t,n){"use strict";var i=n(6518),r=n(9565),s=n(2652),a=n(9306),o=n(8551),u=n(1767),l=n(9539),c=n(4549),d=c("find",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:d},{find:function(e){o(this);try{a(e)}catch(i){l(this,"throw",i)}if(d)return r(d,this,e);var t=u(this),n=0;return s(t,(function(t,i){if(e(t,n++))return i(t)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}})},144:function(e,t,n){"use strict";n.d(t,{BA:function(){return Oe},C4:function(){return x},EW:function(){return Be},Gc:function(){return ye},IG:function(){return Ie},IJ:function(){return De},KR:function(){return Ce},Kh:function(){return ve},Pr:function(){return Ue},R1:function(){return _e},Tm:function(){return Ee},X2:function(){return c},a1:function(){return Le},bl:function(){return I},fE:function(){return we},g8:function(){return Se},hV:function(){return Ke},hZ:function(){return U},i9:function(){return Re},jr:function(){return u},ju:function(){return Ae},lJ:function(){return ke},o5:function(){return o},qA:function(){return B},u4:function(){return N},ux:function(){return xe},wB:function(){return He},yC:function(){return a}});n(4114),n(8111),n(2489),n(7588),n(1701),n(3579),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698);var i=n(4232);let r,s;class a{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=r,!e&&r&&(this.index=(r.scopes||(r.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){let e,t;if(this._isPaused=!0,this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){let e,t;if(this._isPaused=!1,this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=r;try{return r=this,e()}finally{r=t}}else 0}on(){1===++this._on&&(this.prevScope=r,r=this)}off(){this._on>0&&0===--this._on&&(r=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){let t,n;for(this._active=!1,t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0}}}function o(){return r}function u(e,t=!1){r&&r.cleanups.push(e)}const l=new WeakSet;class c{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,r&&r.active&&r.effects.push(this)}pause(){this.flags|=64}resume(){64&this.flags&&(this.flags&=-65,l.has(this)&&(l.delete(this),this.trigger()))}notify(){2&this.flags&&!(32&this.flags)||8&this.flags||p(this)}run(){if(!(1&this.flags))return this.fn();this.flags|=2,k(this),v(this);const e=s,t=w;s=this,w=!0;try{return this.fn()}finally{0,y(this),s=e,w=t,this.flags&=-3}}stop(){if(1&this.flags){for(let e=this.deps;e;e=e.nextDep)S(e);this.deps=this.depsTail=void 0,k(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){64&this.flags?l.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){b(this)&&this.run()}get dirty(){return b(this)}}let d,h,f=0;function p(e,t=!1){if(e.flags|=8,t)return e.next=h,void(h=e);e.next=d,d=e}function g(){f++}function m(){if(--f>0)return;if(h){let e=h;h=void 0;while(e){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let e;while(d){let n=d;d=void 0;while(n){const i=n.next;if(n.next=void 0,n.flags&=-9,1&n.flags)try{n.trigger()}catch(t){e||(e=t)}n=i}}if(e)throw e}function v(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function y(e){let t,n=e.depsTail,i=n;while(i){const e=i.prevDep;-1===i.version?(i===n&&(n=e),S(i),E(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=e}e.deps=t,e.depsTail=n}function b(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(T(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function T(e){if(4&e.flags&&!(16&e.flags))return;if(e.flags&=-17,e.globalVersion===L)return;if(e.globalVersion=L,!e.isSSR&&128&e.flags&&(!e.deps&&!e._dirty||!b(e)))return;e.flags|=2;const t=e.dep,n=s,r=w;s=e,w=!0;try{v(e);const n=e.fn(e._value);(0===t.version||(0,i.$H)(n,e._value))&&(e.flags|=128,e._value=n,t.version++)}catch(a){throw t.version++,a}finally{s=n,w=r,y(e),e.flags&=-3}}function S(e,t=!1){const{dep:n,prevSub:i,nextSub:r}=e;if(i&&(i.nextSub=r,e.prevSub=void 0),r&&(r.prevSub=i,e.nextSub=void 0),n.subs===e&&(n.subs=i,!i&&n.computed)){n.computed.flags&=-5;for(let e=n.computed.deps;e;e=e.nextDep)S(e,!0)}t||--n.sc||!n.map||n.map.delete(n.key)}function E(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let w=!0;const A=[];function x(){A.push(w),w=!1}function I(){const e=A.pop();w=void 0===e||e}function k(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const e=s;s=void 0;try{t()}finally{s=e}}}let L=0;class R{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class C{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!s||!w||s===this.computed)return;let t=this.activeLink;if(void 0===t||t.sub!==s)t=this.activeLink=new R(s,this),s.deps?(t.prevDep=s.depsTail,s.depsTail.nextDep=t,s.depsTail=t):s.deps=s.depsTail=t,D(t);else if(-1===t.version&&(t.version=this.version,t.nextDep)){const e=t.nextDep;e.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=e),t.prevDep=s.depsTail,t.nextDep=void 0,s.depsTail.nextDep=t,s.depsTail=t,s.deps===t&&(s.deps=e)}return t}trigger(e){this.version++,L++,this.notify(e)}notify(e){g();try{0;for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{m()}}}function D(e){if(e.dep.sc++,4&e.sub.flags){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let e=t.deps;e;e=e.nextDep)D(e)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const M=new WeakMap,P=Symbol(""),_=Symbol(""),O=Symbol("");function N(e,t,n){if(w&&s){let t=M.get(e);t||M.set(e,t=new Map);let i=t.get(n);i||(t.set(n,i=new C),i.map=t,i.key=n),i.track()}}function U(e,t,n,r,s,a){const o=M.get(e);if(!o)return void L++;const u=e=>{e&&e.trigger()};if(g(),"clear"===t)o.forEach(u);else{const s=(0,i.cy)(e),a=s&&(0,i.yI)(n);if(s&&"length"===n){const e=Number(r);o.forEach(((t,n)=>{("length"===n||n===O||!(0,i.Bm)(n)&&n>=e)&&u(t)}))}else switch((void 0!==n||o.has(void 0))&&u(o.get(n)),a&&u(o.get(O)),t){case"add":s?a&&u(o.get("length")):(u(o.get(P)),(0,i.CE)(e)&&u(o.get(_)));break;case"delete":s||(u(o.get(P)),(0,i.CE)(e)&&u(o.get(_)));break;case"set":(0,i.CE)(e)&&u(o.get(P));break}}m()}function F(e){const t=xe(e);return t===e?t:(N(t,"iterate",O),we(e)?t:t.map(ke))}function B(e){return N(e=xe(e),"iterate",O),e}const j={__proto__:null,[Symbol.iterator](){return $(this,Symbol.iterator,ke)},concat(...e){return F(this).concat(...e.map((e=>(0,i.cy)(e)?F(e):e)))},entries(){return $(this,"entries",(e=>(e[1]=ke(e[1]),e)))},every(e,t){return V(this,"every",e,t,void 0,arguments)},filter(e,t){return V(this,"filter",e,t,(e=>e.map(ke)),arguments)},find(e,t){return V(this,"find",e,t,ke,arguments)},findIndex(e,t){return V(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return V(this,"findLast",e,t,ke,arguments)},findLastIndex(e,t){return V(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return V(this,"forEach",e,t,void 0,arguments)},includes(...e){return K(this,"includes",e)},indexOf(...e){return K(this,"indexOf",e)},join(e){return F(this).join(e)},lastIndexOf(...e){return K(this,"lastIndexOf",e)},map(e,t){return V(this,"map",e,t,void 0,arguments)},pop(){return W(this,"pop")},push(...e){return W(this,"push",e)},reduce(e,...t){return H(this,"reduce",e,t)},reduceRight(e,...t){return H(this,"reduceRight",e,t)},shift(){return W(this,"shift")},some(e,t){return V(this,"some",e,t,void 0,arguments)},splice(...e){return W(this,"splice",e)},toReversed(){return F(this).toReversed()},toSorted(e){return F(this).toSorted(e)},toSpliced(...e){return F(this).toSpliced(...e)},unshift(...e){return W(this,"unshift",e)},values(){return $(this,"values",ke)}};function $(e,t,n){const i=B(e),r=i[t]();return i===e||we(e)||(r._next=r.next,r.next=()=>{const e=r._next();return e.value&&(e.value=n(e.value)),e}),r}const G=Array.prototype;function V(e,t,n,i,r,s){const a=B(e),o=a!==e&&!we(e),u=a[t];if(u!==G[t]){const t=u.apply(e,s);return o?ke(t):t}let l=n;a!==e&&(o?l=function(t,i){return n.call(this,ke(t),i,e)}:n.length>2&&(l=function(t,i){return n.call(this,t,i,e)}));const c=u.call(a,l,i);return o&&r?r(c):c}function H(e,t,n,i){const r=B(e);let s=n;return r!==e&&(we(e)?n.length>3&&(s=function(t,i,r){return n.call(this,t,i,r,e)}):s=function(t,i,r){return n.call(this,t,ke(i),r,e)}),r[t](s,...i)}function K(e,t,n){const i=xe(e);N(i,"iterate",O);const r=i[t](...n);return-1!==r&&!1!==r||!Ae(n[0])?r:(n[0]=xe(n[0]),i[t](...n))}function W(e,t,n=[]){x(),g();const i=xe(e)[t].apply(e,n);return m(),I(),i}const q=(0,i.pD)("__proto__,__v_isRef,__isVue"),Y=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(i.Bm));function X(e){(0,i.Bm)(e)||(e=String(e));const t=xe(this);return N(t,"has",e),t.hasOwnProperty(e)}class z{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if("__v_skip"===t)return e["__v_skip"];const r=this._isReadonly,s=this._isShallow;if("__v_isReactive"===t)return!r;if("__v_isReadonly"===t)return r;if("__v_isShallow"===t)return s;if("__v_raw"===t)return n===(r?s?pe:fe:s?he:de).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const a=(0,i.cy)(e);if(!r){let e;if(a&&(e=j[t]))return e;if("hasOwnProperty"===t)return X}const o=Reflect.get(e,t,Re(e)?e:n);return((0,i.Bm)(t)?Y.has(t):q(t))?o:(r||N(e,"get",t),s?o:Re(o)?a&&(0,i.yI)(t)?o:o.value:(0,i.Gv)(o)?r?be(o):ve(o):o)}}class Q extends z{constructor(e=!1){super(!1,e)}set(e,t,n,r){let s=e[t];if(!this._isShallow){const t=Ee(s);if(we(n)||Ee(n)||(s=xe(s),n=xe(n)),!(0,i.cy)(e)&&Re(s)&&!Re(n))return!t&&(s.value=n,!0)}const a=(0,i.cy)(e)&&(0,i.yI)(t)?Number(t)<e.length:(0,i.$3)(e,t),o=Reflect.set(e,t,n,Re(e)?e:r);return e===xe(r)&&(a?(0,i.$H)(n,s)&&U(e,"set",t,n,s):U(e,"add",t,n)),o}deleteProperty(e,t){const n=(0,i.$3)(e,t),r=e[t],s=Reflect.deleteProperty(e,t);return s&&n&&U(e,"delete",t,void 0,r),s}has(e,t){const n=Reflect.has(e,t);return(0,i.Bm)(t)&&Y.has(t)||N(e,"has",t),n}ownKeys(e){return N(e,"iterate",(0,i.cy)(e)?"length":P),Reflect.ownKeys(e)}}class J extends z{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const Z=new Q,ee=new J,te=new Q(!0),ne=e=>e,ie=e=>Reflect.getPrototypeOf(e);function re(e,t,n){return function(...r){const s=this["__v_raw"],a=xe(s),o=(0,i.CE)(a),u="entries"===e||e===Symbol.iterator&&o,l="keys"===e&&o,c=s[e](...r),d=n?ne:t?Le:ke;return!t&&N(a,"iterate",l?_:P),{next(){const{value:e,done:t}=c.next();return t?{value:e,done:t}:{value:u?[d(e[0]),d(e[1])]:d(e),done:t}},[Symbol.iterator](){return this}}}}function se(e){return function(...t){return"delete"!==e&&("clear"===e?void 0:this)}}function ae(e,t){const n={get(n){const r=this["__v_raw"],s=xe(r),a=xe(n);e||((0,i.$H)(n,a)&&N(s,"get",n),N(s,"get",a));const{has:o}=ie(s),u=t?ne:e?Le:ke;return o.call(s,n)?u(r.get(n)):o.call(s,a)?u(r.get(a)):void(r!==s&&r.get(n))},get size(){const t=this["__v_raw"];return!e&&N(xe(t),"iterate",P),Reflect.get(t,"size",t)},has(t){const n=this["__v_raw"],r=xe(n),s=xe(t);return e||((0,i.$H)(t,s)&&N(r,"has",t),N(r,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)},forEach(n,i){const r=this,s=r["__v_raw"],a=xe(s),o=t?ne:e?Le:ke;return!e&&N(a,"iterate",P),s.forEach(((e,t)=>n.call(i,o(e),o(t),r)))}};(0,i.X$)(n,e?{add:se("add"),set:se("set"),delete:se("delete"),clear:se("clear")}:{add(e){t||we(e)||Ee(e)||(e=xe(e));const n=xe(this),i=ie(n),r=i.has.call(n,e);return r||(n.add(e),U(n,"add",e,e)),this},set(e,n){t||we(n)||Ee(n)||(n=xe(n));const r=xe(this),{has:s,get:a}=ie(r);let o=s.call(r,e);o||(e=xe(e),o=s.call(r,e));const u=a.call(r,e);return r.set(e,n),o?(0,i.$H)(n,u)&&U(r,"set",e,n,u):U(r,"add",e,n),this},delete(e){const t=xe(this),{has:n,get:i}=ie(t);let r=n.call(t,e);r||(e=xe(e),r=n.call(t,e));const s=i?i.call(t,e):void 0,a=t.delete(e);return r&&U(t,"delete",e,void 0,s),a},clear(){const e=xe(this),t=0!==e.size,n=void 0,i=e.clear();return t&&U(e,"clear",void 0,void 0,n),i}});const r=["keys","values","entries",Symbol.iterator];return r.forEach((i=>{n[i]=re(i,e,t)})),n}function oe(e,t){const n=ae(e,t);return(t,r,s)=>"__v_isReactive"===r?!e:"__v_isReadonly"===r?e:"__v_raw"===r?t:Reflect.get((0,i.$3)(n,r)&&r in t?n:t,r,s)}const ue={get:oe(!1,!1)},le={get:oe(!1,!0)},ce={get:oe(!0,!1)};const de=new WeakMap,he=new WeakMap,fe=new WeakMap,pe=new WeakMap;function ge(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function me(e){return e["__v_skip"]||!Object.isExtensible(e)?0:ge((0,i.Zf)(e))}function ve(e){return Ee(e)?e:Te(e,!1,Z,ue,de)}function ye(e){return Te(e,!1,te,le,he)}function be(e){return Te(e,!0,ee,ce,fe)}function Te(e,t,n,r,s){if(!(0,i.Gv)(e))return e;if(e["__v_raw"]&&(!t||!e["__v_isReactive"]))return e;const a=me(e);if(0===a)return e;const o=s.get(e);if(o)return o;const u=new Proxy(e,2===a?r:n);return s.set(e,u),u}function Se(e){return Ee(e)?Se(e["__v_raw"]):!(!e||!e["__v_isReactive"])}function Ee(e){return!(!e||!e["__v_isReadonly"])}function we(e){return!(!e||!e["__v_isShallow"])}function Ae(e){return!!e&&!!e["__v_raw"]}function xe(e){const t=e&&e["__v_raw"];return t?xe(t):e}function Ie(e){return!(0,i.$3)(e,"__v_skip")&&Object.isExtensible(e)&&(0,i.yQ)(e,"__v_skip",!0),e}const ke=e=>(0,i.Gv)(e)?ve(e):e,Le=e=>(0,i.Gv)(e)?be(e):e;function Re(e){return!!e&&!0===e["__v_isRef"]}function Ce(e){return Me(e,!1)}function De(e){return Me(e,!0)}function Me(e,t){return Re(e)?e:new Pe(e,t)}class Pe{constructor(e,t){this.dep=new C,this["__v_isRef"]=!0,this["__v_isShallow"]=!1,this._rawValue=t?e:xe(e),this._value=t?e:ke(e),this["__v_isShallow"]=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,n=this["__v_isShallow"]||we(e)||Ee(e);e=n?e:xe(e),(0,i.$H)(e,t)&&(this._rawValue=e,this._value=n?e:ke(e),this.dep.trigger())}}function _e(e){return Re(e)?e.value:e}function Oe(e){return(0,i.Tn)(e)?e():_e(e)}const Ne={get:(e,t,n)=>"__v_raw"===t?e:_e(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const r=e[t];return Re(r)&&!Re(n)?(r.value=n,!0):Reflect.set(e,t,n,i)}};function Ue(e){return Se(e)?e:new Proxy(e,Ne)}class Fe{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new C(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=L-1,this.next=void 0,this.effect=this,this["__v_isReadonly"]=!t,this.isSSR=n}notify(){if(this.flags|=16,!(8&this.flags||s===this))return p(this,!0),!0}get value(){const e=this.dep.track();return T(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Be(e,t,n=!1){let r,s;(0,i.Tn)(e)?r=e:(r=e.get,s=e.set);const a=new Fe(r,s,n);return a}const je={},$e=new WeakMap;let Ge;function Ve(e,t=!1,n=Ge){if(n){let t=$e.get(n);t||$e.set(n,t=[]),t.push(e)}else 0}function He(e,t,n=i.MZ){const{immediate:r,deep:s,once:a,scheduler:u,augmentJob:l,call:d}=n,h=e=>s?e:we(e)||!1===s||0===s?Ke(e,1):Ke(e);let f,p,g,m,v=!1,y=!1;if(Re(e)?(p=()=>e.value,v=we(e)):Se(e)?(p=()=>h(e),v=!0):(0,i.cy)(e)?(y=!0,v=e.some((e=>Se(e)||we(e))),p=()=>e.map((e=>Re(e)?e.value:Se(e)?h(e):(0,i.Tn)(e)?d?d(e,2):e():void 0))):p=(0,i.Tn)(e)?t?d?()=>d(e,2):e:()=>{if(g){x();try{g()}finally{I()}}const t=Ge;Ge=f;try{return d?d(e,3,[m]):e(m)}finally{Ge=t}}:i.tE,t&&s){const e=p,t=!0===s?1/0:s;p=()=>Ke(e(),t)}const b=o(),T=()=>{f.stop(),b&&b.active&&(0,i.TF)(b.effects,f)};if(a&&t){const e=t;t=(...t)=>{e(...t),T()}}let S=y?new Array(e.length).fill(je):je;const E=e=>{if(1&f.flags&&(f.dirty||e))if(t){const e=f.run();if(s||v||(y?e.some(((e,t)=>(0,i.$H)(e,S[t]))):(0,i.$H)(e,S))){g&&g();const n=Ge;Ge=f;try{const n=[e,S===je?void 0:y&&S[0]===je?[]:S,m];d?d(t,3,n):t(...n),S=e}finally{Ge=n}}}else f.run()};return l&&l(E),f=new c(p),f.scheduler=u?()=>u(E,!1):E,m=e=>Ve(e,!1,f),g=f.onStop=()=>{const e=$e.get(f);if(e){if(d)d(e,4);else for(const t of e)t();$e.delete(f)}},t?r?E(!0):S=f.run():u?u(E.bind(null,!0),!0):f.run(),T.pause=f.pause.bind(f),T.resume=f.resume.bind(f),T.stop=T,T}function Ke(e,t=1/0,n){if(t<=0||!(0,i.Gv)(e)||e["__v_skip"])return e;if(n=n||new Set,n.has(e))return e;if(n.add(e),t--,Re(e))Ke(e.value,t,n);else if((0,i.cy)(e))for(let i=0;i<e.length;i++)Ke(e[i],t,n);else if((0,i.vM)(e)||(0,i.CE)(e))e.forEach((e=>{Ke(e,t,n)}));else if((0,i.Qd)(e)){for(const i in e)Ke(e[i],t,n);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&Ke(e[i],t,n)}return e}},283:function(e,t,n){"use strict";var i=n(9504),r=n(9039),s=n(4901),a=n(9297),o=n(3724),u=n(350).CONFIGURABLE,l=n(3706),c=n(1181),d=c.enforce,h=c.get,f=String,p=Object.defineProperty,g=i("".slice),m=i("".replace),v=i([].join),y=o&&!r((function(){return 8!==p((function(){}),"length",{value:8}).length})),b=String(String).split("String"),T=e.exports=function(e,t,n){"Symbol("===g(f(t),0,7)&&(t="["+m(f(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!a(e,"name")||u&&e.name!==t)&&(o?p(e,"name",{value:t,configurable:!0}):e.name=t),y&&n&&a(n,"arity")&&e.length!==n.arity&&p(e,"length",{value:n.arity});try{n&&a(n,"constructor")&&n.constructor?o&&p(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(r){}var i=d(e);return a(i,"source")||(i.source=v(b,"string"==typeof t?t:"")),e};Function.prototype.toString=T((function(){return s(this)&&h(this).source||l(this)}),"toString")},350:function(e,t,n){"use strict";var i=n(3724),r=n(9297),s=Function.prototype,a=i&&Object.getOwnPropertyDescriptor,o=r(s,"name"),u=o&&"something"===function(){}.name,l=o&&(!i||i&&a(s,"name").configurable);e.exports={EXISTS:o,PROPER:u,CONFIGURABLE:l}},397:function(e,t,n){"use strict";var i=n(7751);e.exports=i("document","documentElement")},421:function(e){"use strict";e.exports={}},507:function(e,t,n){"use strict";var i=n(9565);e.exports=function(e,t,n){var r,s,a=n?e:e.iterator,o=e.next;while(!(r=i(o,a)).done)if(s=t(r.value),void 0!==s)return s}},531:function(e,t,n){"use strict";var i=n(6518),r=n(9565),s=n(9306),a=n(8551),o=n(1767),u=n(8646),l=n(9462),c=n(9539),d=n(6395),h=n(4549),f=!d&&h("flatMap",TypeError),p=l((function(){var e,t,n=this.iterator,i=this.mapper;while(1){if(t=this.inner)try{if(e=a(r(t.next,t.iterator)),!e.done)return e.value;this.inner=null}catch(s){c(n,"throw",s)}if(e=a(r(this.next,n)),this.done=!!e.done)return;try{this.inner=u(i(e.value,this.counter++),!1)}catch(s){c(n,"throw",s)}}}));i({target:"Iterator",proto:!0,real:!0,forced:d||f},{flatMap:function(e){a(this);try{s(e)}catch(t){c(this,"throw",t)}return f?r(f,this,e):new p(o(this),{mapper:e,inner:null})}})},616:function(e,t,n){"use strict";var i=n(9039);e.exports=!i((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},655:function(e,t,n){"use strict";var i=n(6955),r=String;e.exports=function(e){if("Symbol"===i(e))throw new TypeError("Cannot convert a Symbol value to a string");return r(e)}},679:function(e,t,n){"use strict";var i=n(1625),r=TypeError;e.exports=function(e,t){if(i(t,e))return e;throw new r("Incorrect invocation")}},741:function(e){"use strict";var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var i=+e;return(i>0?n:t)(i)}},757:function(e,t,n){"use strict";var i=n(7751),r=n(4901),s=n(1625),a=n(7040),o=Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return r(t)&&s(t.prototype,o(e))}},782:function(e,t,n){"use strict";n.d(t,{y$:function(){return te},aH:function(){return re},Pj:function(){return v}});n(4114),n(8111),n(2489),n(7588),n(1701),n(8237);var i=n(6768),r=n(144);function s(){return a().__VUE_DEVTOOLS_GLOBAL_HOOK__}function a(){return"undefined"!==typeof navigator&&"undefined"!==typeof window?window:"undefined"!==typeof globalThis?globalThis:{}}const o="function"===typeof Proxy,u="devtools-plugin:setup",l="plugin:settings:set";let c,d;function h(){var e;return void 0!==c||("undefined"!==typeof window&&window.performance?(c=!0,d=window.performance):"undefined"!==typeof globalThis&&(null===(e=globalThis.perf_hooks)||void 0===e?void 0:e.performance)?(c=!0,d=globalThis.perf_hooks.performance):c=!1),c}function f(){return h()?d.now():Date.now()}class p{constructor(e,t){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=t;const n={};if(e.settings)for(const a in e.settings){const t=e.settings[a];n[a]=t.defaultValue}const i=`__vue-devtools-plugin-settings__${e.id}`;let r=Object.assign({},n);try{const e=localStorage.getItem(i),t=JSON.parse(e);Object.assign(r,t)}catch(s){}this.fallbacks={getSettings(){return r},setSettings(e){try{localStorage.setItem(i,JSON.stringify(e))}catch(s){}r=e},now(){return f()}},t&&t.on(l,((e,t)=>{e===this.plugin.id&&this.fallbacks.setSettings(t)})),this.proxiedOn=new Proxy({},{get:(e,t)=>this.target?this.target.on[t]:(...e)=>{this.onQueue.push({method:t,args:e})}}),this.proxiedTarget=new Proxy({},{get:(e,t)=>this.target?this.target[t]:"on"===t?this.proxiedOn:Object.keys(this.fallbacks).includes(t)?(...e)=>(this.targetQueue.push({method:t,args:e,resolve:()=>{}}),this.fallbacks[t](...e)):(...e)=>new Promise((n=>{this.targetQueue.push({method:t,args:e,resolve:n})}))})}async setRealTarget(e){this.target=e;for(const t of this.onQueue)this.target.on[t.method](...t.args);for(const t of this.targetQueue)t.resolve(await this.target[t.method](...t.args))}}function g(e,t){const n=e,i=a(),r=s(),l=o&&n.enableEarlyProxy;if(!r||!i.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__&&l){const e=l?new p(n,r):null,s=i.__VUE_DEVTOOLS_PLUGINS__=i.__VUE_DEVTOOLS_PLUGINS__||[];s.push({pluginDescriptor:n,setupFn:t,proxy:e}),e&&t(e.proxiedTarget)}else r.emit(u,e,t)}
/*!
 * vuex v4.0.2
 * (c) 2021 Evan You
 * @license MIT
 */
var m="store";function v(e){return void 0===e&&(e=null),(0,i.WQ)(null!==e?e:m)}function y(e,t){Object.keys(e).forEach((function(n){return t(e[n],n)}))}function b(e){return null!==e&&"object"===typeof e}function T(e){return e&&"function"===typeof e.then}function S(e,t){return function(){return e(t)}}function E(e,t,n){return t.indexOf(e)<0&&(n&&n.prepend?t.unshift(e):t.push(e)),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function w(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var n=e.state;x(e,n,[],e._modules.root,!0),A(e,n,t)}function A(e,t,n){var i=e._state;e.getters={},e._makeLocalGettersCache=Object.create(null);var s=e._wrappedGetters,a={};y(s,(function(t,n){a[n]=S(t,e),Object.defineProperty(e.getters,n,{get:function(){return a[n]()},enumerable:!0})})),e._state=(0,r.Kh)({data:t}),e.strict&&D(e),i&&n&&e._withCommit((function(){i.data=null}))}function x(e,t,n,i,r){var s=!n.length,a=e._modules.getNamespace(n);if(i.namespaced&&(e._modulesNamespaceMap[a],e._modulesNamespaceMap[a]=i),!s&&!r){var o=M(t,n.slice(0,-1)),u=n[n.length-1];e._withCommit((function(){o[u]=i.state}))}var l=i.context=I(e,a,n);i.forEachMutation((function(t,n){var i=a+n;L(e,i,t,l)})),i.forEachAction((function(t,n){var i=t.root?n:a+n,r=t.handler||t;R(e,i,r,l)})),i.forEachGetter((function(t,n){var i=a+n;C(e,i,t,l)})),i.forEachChild((function(i,s){x(e,t,n.concat(s),i,r)}))}function I(e,t,n){var i=""===t,r={dispatch:i?e.dispatch:function(n,i,r){var s=P(n,i,r),a=s.payload,o=s.options,u=s.type;return o&&o.root||(u=t+u),e.dispatch(u,a)},commit:i?e.commit:function(n,i,r){var s=P(n,i,r),a=s.payload,o=s.options,u=s.type;o&&o.root||(u=t+u),e.commit(u,a,o)}};return Object.defineProperties(r,{getters:{get:i?function(){return e.getters}:function(){return k(e,t)}},state:{get:function(){return M(e.state,n)}}}),r}function k(e,t){if(!e._makeLocalGettersCache[t]){var n={},i=t.length;Object.keys(e.getters).forEach((function(r){if(r.slice(0,i)===t){var s=r.slice(i);Object.defineProperty(n,s,{get:function(){return e.getters[r]},enumerable:!0})}})),e._makeLocalGettersCache[t]=n}return e._makeLocalGettersCache[t]}function L(e,t,n,i){var r=e._mutations[t]||(e._mutations[t]=[]);r.push((function(t){n.call(e,i.state,t)}))}function R(e,t,n,i){var r=e._actions[t]||(e._actions[t]=[]);r.push((function(t){var r=n.call(e,{dispatch:i.dispatch,commit:i.commit,getters:i.getters,state:i.state,rootGetters:e.getters,rootState:e.state},t);return T(r)||(r=Promise.resolve(r)),e._devtoolHook?r.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):r}))}function C(e,t,n,i){e._wrappedGetters[t]||(e._wrappedGetters[t]=function(e){return n(i.state,i.getters,e.state,e.getters)})}function D(e){(0,i.wB)((function(){return e._state.data}),(function(){0}),{deep:!0,flush:"sync"})}function M(e,t){return t.reduce((function(e,t){return e[t]}),e)}function P(e,t,n){return b(e)&&e.type&&(n=t,t=e,e=e.type),{type:e,payload:t,options:n}}var _="vuex bindings",O="vuex:mutations",N="vuex:actions",U="vuex",F=0;function B(e,t){g({id:"org.vuejs.vuex",app:e,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[_]},(function(n){n.addTimelineLayer({id:O,label:"Vuex Mutations",color:j}),n.addTimelineLayer({id:N,label:"Vuex Actions",color:j}),n.addInspector({id:U,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),n.on.getInspectorTree((function(n){if(n.app===e&&n.inspectorId===U)if(n.filter){var i=[];W(i,t._modules.root,n.filter,""),n.rootNodes=i}else n.rootNodes=[K(t._modules.root,"")]})),n.on.getInspectorState((function(n){if(n.app===e&&n.inspectorId===U){var i=n.nodeId;k(t,i),n.state=q(X(t._modules,i),"root"===i?t.getters:t._makeLocalGettersCache,i)}})),n.on.editInspectorState((function(n){if(n.app===e&&n.inspectorId===U){var i=n.nodeId,r=n.path;"root"!==i&&(r=i.split("/").filter(Boolean).concat(r)),t._withCommit((function(){n.set(t._state.data,r,n.state.value)}))}})),t.subscribe((function(e,t){var i={};e.payload&&(i.payload=e.payload),i.state=t,n.notifyComponentUpdate(),n.sendInspectorTree(U),n.sendInspectorState(U),n.addTimelineEvent({layerId:O,event:{time:Date.now(),title:e.type,data:i}})})),t.subscribeAction({before:function(e,t){var i={};e.payload&&(i.payload=e.payload),e._id=F++,e._time=Date.now(),i.state=t,n.addTimelineEvent({layerId:N,event:{time:e._time,title:e.type,groupId:e._id,subtitle:"start",data:i}})},after:function(e,t){var i={},r=Date.now()-e._time;i.duration={_custom:{type:"duration",display:r+"ms",tooltip:"Action duration",value:r}},e.payload&&(i.payload=e.payload),i.state=t,n.addTimelineEvent({layerId:N,event:{time:Date.now(),title:e.type,groupId:e._id,subtitle:"end",data:i}})}})}))}var j=8702998,$=6710886,G=16777215,V={label:"namespaced",textColor:G,backgroundColor:$};function H(e){return e&&"root"!==e?e.split("/").slice(-2,-1)[0]:"Root"}function K(e,t){return{id:t||"root",label:H(t),tags:e.namespaced?[V]:[],children:Object.keys(e._children).map((function(n){return K(e._children[n],t+n+"/")}))}}function W(e,t,n,i){i.includes(n)&&e.push({id:i||"root",label:i.endsWith("/")?i.slice(0,i.length-1):i||"Root",tags:t.namespaced?[V]:[]}),Object.keys(t._children).forEach((function(r){W(e,t._children[r],n,i+r+"/")}))}function q(e,t,n){t="root"===n?t:t[n];var i=Object.keys(t),r={state:Object.keys(e.state).map((function(t){return{key:t,editable:!0,value:e.state[t]}}))};if(i.length){var s=Y(t);r.getters=Object.keys(s).map((function(e){return{key:e.endsWith("/")?H(e):e,editable:!1,value:z((function(){return s[e]}))}}))}return r}function Y(e){var t={};return Object.keys(e).forEach((function(n){var i=n.split("/");if(i.length>1){var r=t,s=i.pop();i.forEach((function(e){r[e]||(r[e]={_custom:{value:{},display:e,tooltip:"Module",abstract:!0}}),r=r[e]._custom.value})),r[s]=z((function(){return e[n]}))}else t[n]=z((function(){return e[n]}))})),t}function X(e,t){var n=t.split("/").filter((function(e){return e}));return n.reduce((function(e,i,r){var s=e[i];if(!s)throw new Error('Missing module "'+i+'" for path "'+t+'".');return r===n.length-1?s:s._children}),"root"===t?e:e.root._children)}function z(e){try{return e()}catch(t){return t}}var Q=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var n=e.state;this.state=("function"===typeof n?n():n)||{}},J={namespaced:{configurable:!0}};J.namespaced.get=function(){return!!this._rawModule.namespaced},Q.prototype.addChild=function(e,t){this._children[e]=t},Q.prototype.removeChild=function(e){delete this._children[e]},Q.prototype.getChild=function(e){return this._children[e]},Q.prototype.hasChild=function(e){return e in this._children},Q.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},Q.prototype.forEachChild=function(e){y(this._children,e)},Q.prototype.forEachGetter=function(e){this._rawModule.getters&&y(this._rawModule.getters,e)},Q.prototype.forEachAction=function(e){this._rawModule.actions&&y(this._rawModule.actions,e)},Q.prototype.forEachMutation=function(e){this._rawModule.mutations&&y(this._rawModule.mutations,e)},Object.defineProperties(Q.prototype,J);var Z=function(e){this.register([],e,!1)};function ee(e,t,n){if(t.update(n),n.modules)for(var i in n.modules){if(!t.getChild(i))return void 0;ee(e.concat(i),t.getChild(i),n.modules[i])}}Z.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},Z.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,n){return t=t.getChild(n),e+(t.namespaced?n+"/":"")}),"")},Z.prototype.update=function(e){ee([],this.root,e)},Z.prototype.register=function(e,t,n){var i=this;void 0===n&&(n=!0);var r=new Q(t,n);if(0===e.length)this.root=r;else{var s=this.get(e.slice(0,-1));s.addChild(e[e.length-1],r)}t.modules&&y(t.modules,(function(t,r){i.register(e.concat(r),t,n)}))},Z.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1],i=t.getChild(n);i&&i.runtime&&t.removeChild(n)},Z.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1];return!!t&&t.hasChild(n)};function te(e){return new ne(e)}var ne=function(e){var t=this;void 0===e&&(e={});var n=e.plugins;void 0===n&&(n=[]);var i=e.strict;void 0===i&&(i=!1);var r=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new Z(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._devtools=r;var s=this,a=this,o=a.dispatch,u=a.commit;this.dispatch=function(e,t){return o.call(s,e,t)},this.commit=function(e,t,n){return u.call(s,e,t,n)},this.strict=i;var l=this._modules.root.state;x(this,l,[],this._modules.root),A(this,l),n.forEach((function(e){return e(t)}))},ie={state:{configurable:!0}};ne.prototype.install=function(e,t){e.provide(t||m,this),e.config.globalProperties.$store=this;var n=void 0!==this._devtools&&this._devtools;n&&B(e,this)},ie.state.get=function(){return this._state.data},ie.state.set=function(e){0},ne.prototype.commit=function(e,t,n){var i=this,r=P(e,t,n),s=r.type,a=r.payload,o=(r.options,{type:s,payload:a}),u=this._mutations[s];u&&(this._withCommit((function(){u.forEach((function(e){e(a)}))})),this._subscribers.slice().forEach((function(e){return e(o,i.state)})))},ne.prototype.dispatch=function(e,t){var n=this,i=P(e,t),r=i.type,s=i.payload,a={type:r,payload:s},o=this._actions[r];if(o){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(a,n.state)}))}catch(l){0}var u=o.length>1?Promise.all(o.map((function(e){return e(s)}))):o[0](s);return new Promise((function(e,t){u.then((function(t){try{n._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(a,n.state)}))}catch(l){0}e(t)}),(function(e){try{n._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(a,n.state,e)}))}catch(l){0}t(e)}))}))}},ne.prototype.subscribe=function(e,t){return E(e,this._subscribers,t)},ne.prototype.subscribeAction=function(e,t){var n="function"===typeof e?{before:e}:e;return E(n,this._actionSubscribers,t)},ne.prototype.watch=function(e,t,n){var r=this;return(0,i.wB)((function(){return e(r.state,r.getters)}),t,Object.assign({},n))},ne.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._state.data=e}))},ne.prototype.registerModule=function(e,t,n){void 0===n&&(n={}),"string"===typeof e&&(e=[e]),this._modules.register(e,t),x(this,this.state,e,this._modules.get(e),n.preserveState),A(this,this.state)},ne.prototype.unregisterModule=function(e){var t=this;"string"===typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){var n=M(t.state,e.slice(0,-1));delete n[e[e.length-1]]})),w(this)},ne.prototype.hasModule=function(e){return"string"===typeof e&&(e=[e]),this._modules.isRegistered(e)},ne.prototype.hotUpdate=function(e){this._modules.update(e),w(this,!0)},ne.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(ne.prototype,ie);var re=oe((function(e,t){var n={};return se(t).forEach((function(t){var i=t.key,r=t.val;n[i]=function(){var t=this.$store.state,n=this.$store.getters;if(e){var i=ue(this.$store,"mapState",e);if(!i)return;t=i.context.state,n=i.context.getters}return"function"===typeof r?r.call(this,t,n):t[r]},n[i].vuex=!0})),n}));oe((function(e,t){var n={};return se(t).forEach((function(t){var i=t.key,r=t.val;n[i]=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];var i=this.$store.commit;if(e){var s=ue(this.$store,"mapMutations",e);if(!s)return;i=s.context.commit}return"function"===typeof r?r.apply(this,[i].concat(t)):i.apply(this.$store,[r].concat(t))}})),n})),oe((function(e,t){var n={};return se(t).forEach((function(t){var i=t.key,r=t.val;r=e+r,n[i]=function(){if(!e||ue(this.$store,"mapGetters",e))return this.$store.getters[r]},n[i].vuex=!0})),n})),oe((function(e,t){var n={};return se(t).forEach((function(t){var i=t.key,r=t.val;n[i]=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];var i=this.$store.dispatch;if(e){var s=ue(this.$store,"mapActions",e);if(!s)return;i=s.context.dispatch}return"function"===typeof r?r.apply(this,[i].concat(t)):i.apply(this.$store,[r].concat(t))}})),n}));function se(e){return ae(e)?Array.isArray(e)?e.map((function(e){return{key:e,val:e}})):Object.keys(e).map((function(t){return{key:t,val:e[t]}})):[]}function ae(e){return Array.isArray(e)||b(e)}function oe(e){return function(t,n){return"string"!==typeof t?(n=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,n)}}function ue(e,t,n){var i=e._modulesNamespaceMap[n];return i}},814:function(e,t,n){n(4114),n(8111),n(1148),n(2489),n(116),n(7588),n(1701),n(8237),n(3579),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698),n(4979),
/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function(){var e="undefined"!=typeof window?window:n.g,i={};for(var r in function(e,t,n){var i;function s(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var a="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};function o(n){n=["object"==typeof globalThis&&globalThis,n,"object"==typeof e&&e,"object"==typeof self&&self,"object"==typeof t&&t];for(var i=0;i<n.length;++i){var r=n[i];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}var u=o(this);function l(e,t){if(t)e:{var n=u;e=e.split(".");for(var i=0;i<e.length-1;i++){var r=e[i];if(!(r in n))break e;n=n[r]}e=e[e.length-1],i=n[e],t=t(i),t!=i&&null!=t&&a(n,e,{configurable:!0,writable:!0,value:t})}}function c(e){return e={next:e},e[Symbol.iterator]=function(){return this},e}function d(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return{next:s(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}function h(e){if(!(e instanceof Array)){e=d(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}l("Symbol",(function(e){function t(e){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new n(i+(e||"")+"_"+r++,e)}function n(e,t){this.g=e,a(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;n.prototype.toString=function(){return this.g};var i="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return t})),l("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=u[t[n]];"function"===typeof i&&"function"!=typeof i.prototype[e]&&a(i.prototype,e,{configurable:!0,writable:!0,value:function(){return c(s(this))}})}return e}));var f,p="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)f=Object.setPrototypeOf;else{var g;e:{var m={a:!0},v={};try{v.__proto__=m,g=v.a;break e}catch(LL){}g=!1}f=g?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var y=f;function b(e,t){if(e.prototype=p(t.prototype),e.prototype.constructor=e,y)y(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var i=Object.getOwnPropertyDescriptor(t,n);i&&Object.defineProperty(e,n,i)}else e[n]=t[n];e.Tk=t.prototype}function T(){this.o=!1,this.l=null,this.h=void 0,this.g=1,this.j=this.m=0,this.A=this.i=null}function S(e){if(e.o)throw new TypeError("Generator is already running");e.o=!0}function E(e,t){e.i={Ng:t,Yg:!0},e.g=e.m||e.j}function w(e,t,n){return e.g=n,{value:t}}function A(e){e.g=0}function x(e,t,n){e.m=t,void 0!=n&&(e.j=n)}function I(e,t){e.m=0,e.j=t||0}function k(e,t,n){e.g=t,e.m=n||0}function L(e,t){return e.m=t||0,t=e.i.Ng,e.i=null,t}function R(e){e.A=[e.i],e.m=0,e.j=0}function C(e,t){var n=e.A.splice(0)[0];(n=e.i=e.i||n)?n.Yg?e.g=e.m||e.j:void 0!=n.s&&e.j<n.s?(e.g=n.s,e.i=null):e.g=e.j:e.g=t}function D(e){this.g=new T,this.h=e}function M(e,t){S(e.g);var n=e.g.l;return n?P(e,"return"in n?n["return"]:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),_(e))}function P(e,t,n,i){try{var r=t.call(e.g.l,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return e.g.o=!1,r;var s=r.value}catch(a){return e.g.l=null,E(e.g,a),_(e)}return e.g.l=null,i.call(e.g,s),_(e)}function _(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.o=!1,{value:t.value,done:!1}}catch(n){e.g.h=void 0,E(e.g,n)}if(e.g.o=!1,e.g.i){if(t=e.g.i,e.g.i=null,t.Yg)throw t.Ng;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function O(e){this.next=function(t){return S(e.g),e.g.l?t=P(e,e.g.l.next,t,e.g.u):(e.g.u(t),t=_(e)),t},this.throw=function(t){return S(e.g),e.g.l?t=P(e,e.g.l["throw"],t,e.g.u):(E(e.g,t),t=_(e)),t},this.return=function(t){return M(e,t)},this[Symbol.iterator]=function(){return this}}function N(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise((function(i,r){function s(e){e.done?i(e.value):Promise.resolve(e.value).then(t,n).then(s,r)}s(e.next())}))}function U(e){return N(new O(new D(e)))}function F(){for(var e=Number(this),t=[],n=e;n<arguments.length;n++)t[n-e]=arguments[n];return t}function B(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function j(e,t){e instanceof String&&(e+="");var n=0,i=!1,r={next:function(){if(!i&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}function $(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}function G(e,t,n){e instanceof String&&(e=String(e));for(var i=e.length,r=0;r<i;r++){var s=e[r];if(t.call(n,s,r,e))return{Wg:r,v:s}}return{Wg:-1,v:void 0}}T.prototype.u=function(e){this.h=e},T.prototype.return=function(e){this.i={return:e},this.g=this.j},T.prototype.s=function(e){this.g=e},l("Promise",(function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(r){t.reject(r)}}function n(){this.g=null}function i(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var s=u.setTimeout;n.prototype.i=function(e){s(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(i){this.j(i)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(i){n||(n=!0,e.call(t,i))}}var t=this,n=!1;return{resolve:e(this.F),reject:e(this.l)}},t.prototype.F=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.H(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.C(e):this.m(e)}},t.prototype.C=function(e){var t=void 0;try{t=e.then}catch(r){return void this.l(r)}"function"==typeof t?this.I(t,e):this.m(e)},t.prototype.l=function(e){this.u(2,e)},t.prototype.m=function(e){this.u(1,e)},t.prototype.u=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.G(),this.A()},t.prototype.G=function(){var e=this;s((function(){if(e.B()){var t=u.console;"undefined"!==typeof t&&t.error(e.i)}}),1)},t.prototype.B=function(){if(this.o)return!1;var e=u.CustomEvent,t=u.Event,n=u.dispatchEvent;return"undefined"===typeof n||("function"===typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"===typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=u.document.createEvent("CustomEvent"),e.initCustomEvent("unhandledrejection",!1,!0,e)),e.promise=this,e.reason=this.i,n(e))},t.prototype.A=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)a.h(this.g[e]);this.g=null}};var a=new n;return t.prototype.H=function(e){var t=this.j();e.Td(t.resolve,t.reject)},t.prototype.I=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(i){n.reject(i)}},t.prototype.then=function(e,n){function i(e,t){return"function"==typeof e?function(t){try{r(e(t))}catch(n){s(n)}}:t}var r,s,a=new t((function(e,t){r=e,s=t}));return this.Td(i(e,r),i(n,s)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.Td=function(e,t){function n(){switch(i.h){case 1:e(i.i);break;case 2:t(i.i);break;default:throw Error("Unexpected state: "+i.h)}}var i=this;null==this.g?a.h(n):this.g.push(n),this.o=!0},t.resolve=i,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var r=d(e),s=r.next();!s.done;s=r.next())i(s.value).Td(t,n)}))},t.all=function(e){var n=d(e),r=n.next();return r.done?i([]):new t((function(e,t){function s(t){return function(n){a[t]=n,o--,0==o&&e(a)}}var a=[],o=0;do{a.push(void 0),o++,i(r.value).Td(s(a.length-1),t),r=n.next()}while(!r.done)}))},t})),l("WeakMap",(function(e){function t(e){if(this.g=(u+=Math.random()+1).toString(),e){e=d(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function i(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function r(e){if(!B(e,o)){var t=new n;a(e,o,{value:t})}}function s(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&r(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([[t,2],[n,3]]);return 2==i.get(t)&&3==i.get(n)&&(i.delete(t),i.set(n,4),!i.has(t)&&4==i.get(n))}catch(r){return!1}}())return e;var o="$jscomp_hidden_"+Math.random();s("freeze"),s("preventExtensions"),s("seal");var u=0;return t.prototype.set=function(e,t){if(!i(e))throw Error("Invalid WeakMap key");if(r(e),!B(e,o))throw Error("WeakMap key fail: "+e);return e[o][this.g]=t,this},t.prototype.get=function(e){return i(e)&&B(e,o)?e[o][this.g]:void 0},t.prototype.has=function(e){return i(e)&&B(e,o)&&B(e[o],this.g)},t.prototype.delete=function(e){return!!(i(e)&&B(e,o)&&B(e[o],this.g))&&delete e[o][this.g]},t})),l("Map",(function(e){function t(){var e={};return e.Wb=e.next=e.head=e}function n(e,t){var n=e[1];return c((function(){if(n){for(;n.head!=e[1];)n=n.Wb;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))}function i(e,t){var n=t&&typeof t;"object"==n||"function"==n?s.has(t)?n=s.get(t):(n=""+ ++a,s.set(t,n)):n="p_"+t;var i=e[0][n];if(i&&B(e[0],n))for(e=0;e<i.length;e++){var r=i[e];if(t!==t&&r.key!==r.key||t===r.key)return{id:n,list:i,index:e,entry:r}}return{id:n,list:i,index:-1,entry:void 0}}function r(e){if(this[0]={},this[1]=t(),this.size=0,e){e=d(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(d([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&"s"==r.value[1]&&(r=i.next(),!(r.done||4!=r.value[0].x||"t"!=r.value[1]||!i.next().done))}catch(s){return!1}}())return e;var s=new WeakMap;r.prototype.set=function(e,t){e=0===e?0:e;var n=i(this,e);return n.list||(n.list=this[0][n.id]=[]),n.entry?n.entry.value=t:(n.entry={next:this[1],Wb:this[1].Wb,head:this[1],key:e,value:t},n.list.push(n.entry),this[1].Wb.next=n.entry,this[1].Wb=n.entry,this.size++),this},r.prototype.delete=function(e){return e=i(this,e),!(!e.entry||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this[0][e.id],e.entry.Wb.next=e.entry.next,e.entry.next.Wb=e.entry.Wb,e.entry.head=null,this.size--,!0)},r.prototype.clear=function(){this[0]={},this[1]=this[1].Wb=t(),this.size=0},r.prototype.has=function(e){return!!i(this,e).entry},r.prototype.get=function(e){return(e=i(this,e).entry)&&e.value},r.prototype.entries=function(){return n(this,(function(e){return[e.key,e.value]}))},r.prototype.keys=function(){return n(this,(function(e){return e.key}))},r.prototype.values=function(){return n(this,(function(e){return e.value}))},r.prototype.forEach=function(e,t){for(var n,i=this.entries();!(n=i.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},r.prototype[Symbol.iterator]=r.prototype.entries;var a=0;return r})),l("Set",(function(e){function t(e){if(this.g=new Map,e){e=d(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(d([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&r.value[1]==t&&(r=i.next(),!r.done&&r.value[0]!=t&&4==r.value[0].x&&r.value[1]==r.value[0]&&i.next().done)}catch(s){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.g.forEach((function(i){return e.call(t,i,i,n)}))},t)})),l("Array.prototype.values",(function(e){return e||function(){return j(this,(function(e,t){return t}))}})),l("Array.from",(function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var i=[],r="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof r){e=r.call(e);for(var s=0;!(r=e.next()).done;)i.push(t.call(n,r.value,s++))}else for(r=e.length,s=0;s<r;s++)i.push(t.call(n,e[s],s));return i}})),l("Array.prototype.keys",(function(e){return e||function(){return j(this,(function(e){return e}))}})),l("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}})),l("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var i=n.length;for(t=t||0,0>t&&(t=Math.max(t+i,0));t<i;t++){var r=n[t];if(r===e||Object.is(r,e))return!0}return!1}})),l("String.prototype.includes",(function(e){return e||function(e,t){return-1!==$(this,e,"includes").indexOf(e,t||0)}})),l("String.fromCodePoint",(function(e){return e||function(e){for(var t="",n=0;n<arguments.length;n++){var i=Number(arguments[n]);if(0>i||1114111<i||i!==Math.floor(i))throw new RangeError("invalid_code_point "+i);65535>=i?t+=String.fromCharCode(i):(i-=65536,t+=String.fromCharCode(i>>>10&1023|55296),t+=String.fromCharCode(1023&i|56320))}return t}})),l("Array.prototype.findIndex",(function(e){return e||function(e,t){return G(this,e,t).Wg}})),l("WeakSet",(function(e){function t(e){if(this.g=new WeakMap,e){e=d(e);for(var t;!(t=e.next()).done;)this.add(t.value)}}return function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([t]);return!(!i.has(t)||i.has(n))&&(i.delete(t),i.add(n),!i.has(t)&&i.has(n))}catch(r){return!1}}()?e:(t.prototype.add=function(e){return this.g.set(e,!0),this},t.prototype.has=function(e){return this.g.has(e)},t.prototype.delete=function(e){return this.g.delete(e)},t)})),l("Array.prototype.find",(function(e){return e||function(e,t){return G(this,e,t).v}})),l("String.prototype.startsWith",(function(e){return e||function(e,t){var n=$(this,e,"startsWith"),i=n.length,r=e.length;t=Math.max(0,Math.min(0|t,n.length));for(var s=0;s<r&&t<i;)if(n[t++]!=e[s++])return!1;return s>=r}})),l("Object.entries",(function(e){return e||function(e){var t,n=[];for(t in e)B(e,t)&&n.push([t,e[t]]);return n}}));var V="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)B(i,r)&&(e[r]=i[r])}return e};l("Object.assign",(function(e){return e||V})),l("Promise.prototype.finally",(function(e){return e||function(e){return this.then((function(t){return Promise.resolve(e()).then((function(){return t}))}),(function(t){return Promise.resolve(e()).then((function(){throw t}))}))}})),l("Array.prototype.entries",(function(e){return e||function(){return j(this,(function(e,t){return[e,t]}))}})),l("Number.isNaN",(function(e){return e||function(e){return"number"===typeof e&&isNaN(e)}})),l("String.prototype.repeat",(function(e){return e||function(e){var t=$(this,null,"repeat");if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var n="";e;)1&e&&(n+=t),(e>>>=1)&&(t+=t);return n}})),l("Number.EPSILON",(function(){return Math.pow(2,-52)})),l("Number.MAX_SAFE_INTEGER",(function(){return 9007199254740991})),l("Number.isFinite",(function(e){return e||function(e){return"number"===typeof e&&(!isNaN(e)&&1/0!==e&&-1/0!==e)}})),l("Object.values",(function(e){return e||function(e){var t,n=[];for(t in e)B(e,t)&&n.push(e[t]);return n}})),l("Math.log2",(function(e){return e||function(e){return Math.log(e)/Math.LN2}})),l("String.prototype.endsWith",(function(e){return e||function(e,t){var n=$(this,e,"endsWith");void 0===t&&(t=n.length),t=Math.max(0,Math.min(0|t,n.length));for(var i=e.length;0<i&&0<t;)if(n[--t]!=e[--i])return!1;return 0>=i}})),l("Math.trunc",(function(e){return e||function(e){if(e=Number(e),isNaN(e)||1/0===e||-1/0===e||0===e)return e;var t=Math.floor(Math.abs(e));return 0>e?-t:t}}));var H=this||self;function K(e,t){e=e.split(".");var n,i=H;e[0]in i||"undefined"==typeof i.execScript||i.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?i=i[n]&&i[n]!==Object.prototype[n]?i[n]:i[n]={}:i[n]=t}
/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function W(){}function q(){}function Y(e){this.g=Math.exp(Math.log(.5)/e),this.i=this.h=0}function X(e){return e.h/(1-Math.pow(e.g,e.i))}function z(){this.h=new Y(2),this.j=new Y(5),this.g=0,this.i=128e3,this.l=16e3}function Q(){}function J(){}function Z(){}function ee(e){var t=F.apply(1,arguments);re.has(e)||(re.add(e),Z.apply(Q,h(t)))}function te(){}function ne(){}function ie(){}Y.prototype.sample=function(e,t){var n=Math.pow(this.g,e);t=t*(1-n)+n*this.h,isNaN(t)||(this.h=t,this.i+=e)},z.prototype.configure=function(e){this.i=e.minTotalBytes,this.l=e.minBytes,this.h.g=Math.exp(Math.log(.5)/e.fastHalfLife),this.j.g=Math.exp(Math.log(.5)/e.slowHalfLife)},z.prototype.sample=function(e,t){if(!(t<this.l)){var n=8e3*t/e;e/=1e3,this.g+=t,this.h.sample(e,n),this.j.sample(e,n)}},z.prototype.getBandwidthEstimate=function(e){return this.g<this.i?e:Math.min(X(this.h),X(this.j))};var re=new Set;function se(){this.g=new Map}function ae(){this.g=new se}function oe(e,t,n,i){this.target=e,this.type=t,this.listener=n,this.g=ue(e,i),this.target.addEventListener(t,n,this.g)}function ue(e,t){if(void 0==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter((function(e){return!n.has(e)})),le(e)?t:t.capture||!1}function le(e){var t=ce;if(void 0==t){t=!1;try{var n={},i={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",i),Object.defineProperty(n,"capture",i),i=function(){},e.addEventListener("test",i,n),e.removeEventListener("test",i,n)}catch(r){t=!1}ce=t}return t||!1}e.console&&((new Map).set(1,(function(){return console.error.apply(console,h(F.apply(0,arguments)))})).set(2,(function(){return console.warn.apply(console,h(F.apply(0,arguments)))})).set(3,(function(){return console.info.apply(console,h(F.apply(0,arguments)))})).set(4,(function(){return console.log.apply(console,h(F.apply(0,arguments)))})).set(5,(function(){return console.debug.apply(console,h(F.apply(0,arguments)))})).set(6,(function(){return console.debug.apply(console,h(F.apply(0,arguments)))})),Z=function(){return console.warn.apply(console,h(F.apply(0,arguments)))},J=function(){console.error.apply(console,h(F.apply(0,arguments)))}),i=se.prototype,i.push=function(e,t){this.g.has(e)?this.g.get(e).push(t):this.g.set(e,[t])},i.get=function(e){return this.g.has(e)?this.g.get(e).slice():null},i.remove=function(e,t){if(this.g.has(e)){var n=this.g.get(e).filter((function(e){return e!=t}));this.g.set(e,n),n.length||this.g.delete(e)}},i.forEach=function(e){this.g.forEach((function(t,n){e(n,t)}))},i.size=function(){return this.g.size},i.keys=function(){return Array.from(this.g.keys())},i=ae.prototype,i.release=function(){this.Pa(),this.g=null},i.D=function(e,t,n,i){this.g&&(e=new oe(e,t,n,i),this.g.push(t,e))},i.qa=function(e,t,n,i){function r(i){s.Ia(e,t,r),n(i)}var s=this;this.D(e,t,r,i)},i.Ia=function(e,t,n){if(this.g){var i=this.g.get(t)||[];i=d(i);for(var r=i.next();!r.done;r=i.next())r=r.value,r.target!=e||n!=r.listener&&n||(r.Ia(),this.g.remove(t,r))}},i.Pa=function(){if(this.g){for(var e=[],t=d(this.g.g.values()),n=t.next();!n.done;n=t.next())e.push.apply(e,h(n.value));for(e=d(e),t=e.next();!t.done;t=e.next())t.value.Ia();this.g.g.clear()}},K("shaka.util.EventManager",ae),ae.prototype.removeAll=ae.prototype.Pa,ae.prototype.unlisten=ae.prototype.Ia,ae.prototype.listenOnce=ae.prototype.qa,ae.prototype.listen=ae.prototype.D,ae.prototype.release=ae.prototype.release,oe.prototype.Ia=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1};var ce=void 0;function de(e,t){this.g=e,this.h=t}function he(e,t){var n=new de(5,0),i=ge,r=i.g,s=n.h-r.h;(0<(n.g-r.g||s)?i.i:i.h)(i.g,n,e,t)}function fe(e,t,n,i){Z([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",i].join(" "))}function pe(e,t,n,i){J([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",i].join(" "))}K("shaka.config.AutoShowText",{NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3}),de.prototype.toString=function(){return"v"+this.g+"."+this.h};var ge=null,me=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");
/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
function ve(e){var t;e instanceof ve?(ye(this,e.Ib),this.Fc=e.Fc,be(this,e.lb),Te(this,e.Yc),this.Za=e.Za,Se(this,e.g.clone()),this.qc=e.qc):e&&(t=String(e).match(me))?(ye(this,t[1]||"",!0),this.Fc=Ee(t[2]||""),be(this,t[3]||"",!0),Te(this,t[4]),this.Za=Ee(t[5]||"",!0),Se(this,t[6]||"",!0),this.qc=Ee(t[7]||"")):this.g=new Ce(null)}function ye(e,t,n){e.Ib=n?Ee(t,!0):t,e.Ib&&(e.Ib=e.Ib.replace(/:$/,""))}function be(e,t,n){e.lb=n?Ee(t,!0):t}function Te(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.Yc=t}else e.Yc=null}function Se(e,t,n){t instanceof Ce?e.g=t:(n||(t=we(t,Le)),e.g=new Ce(t))}function Ee(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function we(e,t,n){return null!=e?(e=encodeURI(e).replace(t,Ae),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Ae(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(15&e).toString(16)}i=ve.prototype,i.Ib="",i.Fc="",i.lb="",i.Yc=null,i.Za="",i.qc="",i.toString=function(){var e=[],t=this.Ib;if(t&&e.push(we(t,xe,!0),":"),t=this.lb){e.push("//");var n=this.Fc;n&&e.push(we(n,xe,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.Yc,null!=t&&e.push(":",String(t))}return(t=this.Za)&&(this.lb&&"/"!=t.charAt(0)&&e.push("/"),e.push(we(t,"/"==t.charAt(0)?ke:Ie,!0))),(t=this.g.toString())&&e.push("?",t),(t=this.qc)&&e.push("#",we(t,Re)),e.join("")},i.resolve=function(e){var t=this.clone();"data"===t.Ib&&(t=new ve);var n=!!e.Ib;n?ye(t,e.Ib):n=!!e.Fc,n?t.Fc=e.Fc:n=!!e.lb,n?be(t,e.lb):n=null!=e.Yc;var i=e.Za;if(n)Te(t,e.Yc);else if(n=!!e.Za){if("/"!=i.charAt(0))if(this.lb&&!this.Za)i="/"+i;else{var r=t.Za.lastIndexOf("/");-1!=r&&(i=t.Za.substr(0,r+1)+i)}if(".."==i||"."==i)i="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var s=[],a=0;a<i.length;){var o=i[a++];"."==o?r&&a==i.length&&s.push(""):".."==o?((1<s.length||1==s.length&&""!=s[0])&&s.pop(),r&&a==i.length&&s.push("")):(s.push(o),r=!0)}i=s.join("/")}}return n?t.Za=i:n=""!==e.g.toString(),n?Se(t,e.g.clone()):n=!!e.qc,n&&(t.qc=e.qc),t},i.clone=function(){return new ve(this)};var xe=/[#\/\?@]/g,Ie=/[#\?:]/g,ke=/[#\?]/g,Le=/[#\?@]/g,Re=/#/g;function Ce(e){this.g=e||null}function De(e){if(!e.Sa&&(e.Sa=new Map,e.hd=0,e.g))for(var t=e.g.split("&"),n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];s=decodeURIComponent(s.replace(/\+/g," ")),r=r||"",e.add(s,decodeURIComponent(r.replace(/\+/g," ")))}}function Me(e){return De(e),e.hd}function Pe(){}function _e(e,t){if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if((ArrayBuffer.isView(e)?e.buffer:e)==(ArrayBuffer.isView(t)?t.buffer:t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;var n=Ne(e);t=Ne(t);for(var i=0;i<e.byteLength;i++)if(n[i]!=t[i])return!1;return!0}function Oe(e){return ArrayBuffer.isView(e)?0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer:e}function Ne(e,t,n){return n=void 0===n?1/0:n,Be(e,void 0===t?0:t,n,Uint8Array)}function Ue(e,t,n){return n=void 0===n?1/0:n,Be(e,void 0===t?0:t,n,Uint16Array)}function Fe(e,t,n){return n=void 0===n?1/0:n,Be(e,void 0===t?0:t,n,DataView)}function Be(e,t,n,i){var r=ArrayBuffer.isView(e)?e.buffer:e,s=1;"BYTES_PER_ELEMENT"in i&&(s=i.BYTES_PER_ELEMENT);var a=((e.byteOffset||0)+e.byteLength)/s;return e=Math.floor(Math.max(0,Math.min(((e.byteOffset||0)+t)/s,a))),new i(r,e,Math.floor(Math.min(e+Math.max(n,0),a))-e)}function je(e,t,n){var i=F.apply(3,arguments);if(this.severity=e,this.category=t,this.code=n,this.data=i,this.handled=!1,this.message="Shaka Error "+this.code,$e)try{throw Error(this.message||"Shaka Error")}catch(r){this.stack=r.stack}}i=Ce.prototype,i.Sa=null,i.hd=null,i.add=function(e,t){De(this),this.g=null;var n=this.Sa.has(e)?this.Sa.get(e):null;return n||this.Sa.set(e,n=[]),n.push(t),this.hd++,this},i.set=function(e,t){return De(this),this.g=null,this.Sa.has(e)?this.Sa.set(e,[t]):this.add(e,t),this},i.get=function(e){return De(this),this.Sa.get(e)||[]},i.toString=function(){if(this.g)return this.g;if(!this.Sa||!this.Sa.size)return"";for(var e=[],t=d(this.Sa.keys()),n=t.next();!n.done;n=t.next()){var i=n.value;n=encodeURIComponent(i),i=this.Sa.get(i);for(var r=0;r<i.length;r++){var s=n;""!==i[r]&&(s+="="+encodeURIComponent(i[r])),e.push(s)}}return this.g=e.join("&")},i.clone=function(){var e=new Ce;if(e.g=this.g,this.Sa){for(var t=new Map,n=d(this.Sa),i=n.next();!i.done;i=n.next()){var r=d(i.value);i=r.next().value,r=r.next().value,t.set(i,r.concat())}e.Sa=t,e.hd=this.hd}return e},K("shaka.util.BufferUtils",Pe),Pe.toDataView=Fe,Pe.toUint16=Ue,Pe.toUint8=Ne,Pe.toArrayBuffer=Oe,Pe.equal=_e,je.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},K("shaka.util.Error",je);var $e=!0;function Ge(e){this.h=e,this.g=void 0}function Ve(e,t){return!e.length||!t.length||e===t||0<He(e,t).length}function He(e,t){if(!e.length)return t;if(!t.length)return e;var n=[];e=d(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;for(var r=d(t),s=r.next();!s.done;s=r.next())if(s=s.value,i.keySystem==s.keySystem){r=new Map;for(var a=d((i.initData||[]).concat(s.initData||[])),o=a.next();!o.done;o=a.next())o=o.value,r.set(o.keyId,o);r=Array.from(r.values()),a=i.keyIds&&s.keyIds?new Set([].concat(h(i.keyIds),h(s.keyIds))):i.keyIds||s.keyIds,n.push({keySystem:i.keySystem,licenseServerUri:i.licenseServerUri||s.licenseServerUri,distinctiveIdentifierRequired:i.distinctiveIdentifierRequired||s.distinctiveIdentifierRequired,persistentStateRequired:i.persistentStateRequired||s.persistentStateRequired,videoRobustness:i.videoRobustness||s.videoRobustness,audioRobustness:i.audioRobustness||s.audioRobustness,serverCertificate:i.serverCertificate||s.serverCertificate,serverCertificateUri:i.serverCertificateUri||s.serverCertificateUri,initData:r,keyIds:a});break}}return n}function Ke(e){return!!e&&!!e.match(/^com\.(microsoft|chromecast)\.playready/)}function We(e){return!!e&&!!e.match(/^com\.apple\.fps/)}je.Severity={RECOVERABLE:1,CRITICAL:2},je.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},je.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,MSS_MISSING_DATA_FOR_TRANSMUXING:3020,MSS_TRANSMUXING_FAILED:3022,TRANSMUXING_NO_VIDEO_DATA:3023,STREAMING_NOT_ALLOWED:3024,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,MSS_INVALID_XML:4046,MSS_LIVE_CONTENT_NOT_SUPPORTED:4047,AES_128_INVALID_IV_LENGTH:4048,AES_128_INVALID_KEY_LENGTH:4049,DASH_CONFLICTING_AES_128:4050,DASH_UNSUPPORTED_AES_128:4051,DASH_INVALID_PATCH:4052,HLS_EMPTY_MEDIA_PLAYLIST:4053,DASH_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4054,CANNOT_ADD_EXTERNAL_CHAPTERS_TO_LIVE_STREAM:4054,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,MIN_HDCP_VERSION_NOT_MATCH:6018,ERROR_CHECKING_HDCP_VERSION:6019,MISSING_EME_SUPPORT:6020,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,SRC_EQUALS_PRELOAD_NOT_SUPPORTED:7005,PRELOAD_DESTROYED:7006,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004,MT_AD_MANAGER_NOT_INITIALIZED:10005,INTERSTITIAL_AD_MANAGER_NOT_INITIALIZED:10006,VAST_INVALID_XML:10007},Ge.prototype.value=function(){return void 0===this.g&&(this.g=this.h()),this.g};var qe=new Ge((function(){return Oe(new Uint8Array([0]))})),Ye=new Map;function Xe(e){this.h=e,this.g=null}function ze(e){this.h=e,this.g=null}function Qe(){var t=e.ManagedMediaSource||e.MediaSource;return!(!t||!t.isTypeSupported)}function Je(e){return""!=bt().canPlayType(e)}function Ze(){return!!navigator.userAgent.match(/Edge?\//)}function et(){return vt("Xbox One")}function tt(){return vt("Tizen")}function nt(){return vt("Tizen 3")}function it(){return vt("Web0S")}function rt(){return it()&&38===at()}function st(){return vt("CrKey")&&!dt()}function at(){if(!vt("Chrome")||navigator.userAgent.match(/Edge\//))return null;var e=navigator.userAgent.match(/Chrome\/(\d+)/);return e?parseInt(e[1],10):null}function ot(){return yt()&&((navigator.userAgentData&&navigator.userAgentData.platform?"macos"==navigator.userAgentData.platform.toLowerCase():!!navigator.platform&&navigator.platform.toLowerCase().includes("mac"))||!!/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||yt()&&1<navigator.maxTouchPoints)}function ut(){return vt("PlayStation 5")}function lt(){return vt("PlayStation 4")}function ct(){return vt("Hisense")||vt("VIDAA")}function dt(){return vt("VIZIO SmartCast")}function ht(){if(!ot()&&(!yt()||ot()))return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}function ft(){return navigator.userAgentData&&navigator.userAgentData.platform?"windows"==navigator.userAgentData.platform.toLowerCase():!!navigator.platform&&navigator.platform.toLowerCase().includes("win32")}function pt(){return navigator.userAgentData&&navigator.userAgentData.platform?"android"==navigator.userAgentData.platform.toLowerCase():vt("Android")}function gt(){return navigator.userAgentData&&navigator.userAgentData.platform?"fuchsia"==navigator.userAgentData.platform.toLowerCase():vt("Fuchsia")}function mt(){return!!(tt()||it()||et()||lt()||ut()||st()||ct()||dt()||yt()&&!ot())}function vt(e){return(navigator.userAgent||"").includes(e)}function yt(){return(navigator.vendor||"").includes("Apple")}function bt(){return At||(wt||(wt=new ze((function(){At=null}))),(At=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(At=document.createElement("video")),wt.da(1),At)}function Tt(){if(nt()||vt("Tizen 2")||rt()||lt()||ut())return!1;var e=ht();return!(yt()&&!ot()&&null!=e&&15>e)}function St(){var t,n,i,r,s,a,o,u,l,c,d,h,f,p,g,m,v;return U((function(y){switch(y.g){case 1:if(t={width:1/0,height:1/0},st()){if(p=e.cast&&cast.__platform__&&cast.__platform__.canDisplayType,t.width=1280,t.height=720,x(y,14),!(g=p)){y.s(16);break}return w(y,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160'),17)}if(tt()){n=e.devicePixelRatio,t.width=1920<e.screen.width*n?3840:1920,t.height=1080<e.screen.height*n?2160:1080;try{webapis.systeminfo&&webapis.systeminfo.getMaxVideoResolution?(i=webapis.systeminfo.getMaxVideoResolution(),t.width=i.width,t.height=i.height):webapis.productinfo.is8KPanelSupported&&webapis.productinfo.is8KPanelSupported()?(t.width=7680,t.height=4320):webapis.productinfo.isUdPanelSupported&&webapis.productinfo.isUdPanelSupported()&&(t.width=3840,t.height=2160)}catch(b){Z("Tizen: Error detecting screen size, default screen size 1920x1080.")}y.s(3);break}if(it()){try{r=JSON.parse(e.PalmSystem.deviceInfo),t.width=Math.max(1920,r.screenWidth),t.height=Math.max(1080,r.screenHeight)}catch(b){Z("WebOS: Error detecting screen size, default screen size 1920x1080."),t.width=1920,t.height=1080}y.s(3);break}if(ct()){if(s=null,e.Hisense_Get4KSupportState)try{s=e.Hisense_Get4KSupportState()}catch(b){}null==s&&(s=vt("UHD")),s?(t.width=3840,t.height=2160):(t.width=1920,t.height=1080),y.s(3);break}if(!lt()&&!ut()){a=void 0;try{a="undefined"!==typeof Windows?Windows:chrome.webview.hostObjects.sync.Windows}catch(b){}if(a){t.width=1920,t.height=1080;try{o=new a.Media.Protection.ProtectionCapabilities,u=a.Media.Protection.ProtectionCapabilityResult,l=null;do{l=o.isTypeSupported('video/mp4;codecs="hvc1,mp4a";features="decode-res-x=3840,decode-res-y=2160,decode-bitrate=20000,decode-fps=30,decode-bpc=10,display-res-x=3840,display-res-y=2160,display-bpc=8"',"com.microsoft.playready.recommendation")}while(l===u.maybe);l===u.probably&&(t.width=3840,t.height=2160)}catch(b){Z("Xbox: Error detecting screen size, default screen size 1920x1080.")}}else et()&&(t.width=1920,t.height=1080,Z("Xbox: Error detecting screen size, default screen size 1920x1080."));y.s(3);break}return c=!1,x(y,8),w(y,e.msdk.device.getDisplayInfo(),10);case 10:d=y.h,c="4K"===d.resolution,k(y,9);break;case 8:return L(y),x(y,11),w(y,e.msdk.device.getDisplayInfoImmediate(),13);case 13:h=y.h,c="4K"===h.resolution,k(y,9);break;case 11:f=L(y),Z("PlayStation: Failed to get the display info:",f);case 9:c?(t.width=3840,t.height=2160):(t.width=1920,t.height=1080),y.s(3);break;case 17:g=y.h;case 16:if(g){t.width=3840,t.height=2160,y.s(18);break}if(!(m=p)){y.s(19);break}return w(y,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=1920; height=1080'),20);case 20:m=y.h;case 19:m&&(t.width=1920,t.height=1080);case 18:k(y,3);break;case 14:v=L(y),J("Failed to check canDisplayType:",v);case 3:return y.return(t)}}))}function Et(t){return void 0!==e.matchMedia&&e.matchMedia("(color-gamut: p3)").matches?t?"HLG":"PQ":"SDR"}Xe.prototype.da=function(t){var n=this;this.stop();var i=!0,r=null;return this.g=function(){e.clearTimeout(r),i=!1},r=e.setTimeout((function(){i&&n.h()}),1e3*t),this},Xe.prototype.stop=function(){this.g&&(this.g(),this.g=null)},ze.prototype.qb=function(){return this.stop(),this.h(),this},ze.prototype.da=function(e){var t=this;return this.stop(),this.g=new Xe((function(){t.h()})).da(e),this},ze.prototype.ua=function(e){var t=this;return this.stop(),this.g=new Xe((function(){t.g.da(e),t.h()})).da(e),this},ze.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},K("shaka.util.Timer",ze),ze.prototype.stop=ze.prototype.stop,ze.prototype.tickEvery=ze.prototype.ua,ze.prototype.tickAfter=ze.prototype.da,ze.prototype.tickNow=ze.prototype.qb;var wt=null,At=null;function xt(){}function It(t){if(!t)return"";if(t=Ne(t),239==t[0]&&187==t[1]&&191==t[2]&&(t=t.subarray(3)),e.TextDecoder&&!lt())return t=(new TextDecoder).decode(t),t.includes("�")&&J('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),t;for(var n="",i=0;i<t.length;++i){var r=65533;if(0==(128&t[i])?r=t[i]:t.length>=i+2&&192==(224&t[i])&&128==(192&t[i+1])?(r=(31&t[i])<<6|63&t[i+1],i+=1):t.length>=i+3&&224==(240&t[i])&&128==(192&t[i+1])&&128==(192&t[i+2])?(r=(15&t[i])<<12|(63&t[i+1])<<6|63&t[i+2],i+=2):t.length>=i+4&&240==(241&t[i])&&128==(192&t[i+1])&&128==(192&t[i+2])&&128==(192&t[i+3])&&(r=(7&t[i])<<18|(63&t[i+1])<<12|(63&t[i+2])<<6|63&t[i+3],i+=3),65535>=r)n+=String.fromCharCode(r);else{r-=65536;var s=1023&r;n+=String.fromCharCode(55296+(r>>10)),n+=String.fromCharCode(56320+s)}}return n}function kt(e,t,n){if(!e)return"";if(!n&&0!=e.byteLength%2)throw new je(2,2,2004);n=Math.floor(e.byteLength/2);var i=new Uint16Array(n);e=Fe(e);for(var r=0;r<n;r++)i[r]=e.getUint16(2*r,t);return Dt(i)}function Lt(e){function t(e){return n.byteLength<=e||9<=n[e]&&126>=n[e]}if(!e)return"";var n=Ne(e);if(239==n[0]&&187==n[1]&&191==n[2])return It(n);if(254==n[0]&&255==n[1])return kt(n.subarray(2),!1);if(255==n[0]&&254==n[1])return kt(n.subarray(2),!0);if(0==n[0]&&0==n[2])return kt(e,!1);if(0==n[1]&&0==n[3])return kt(e,!0);if(t(0)&&t(1)&&t(2)&&t(3))return It(e);throw new je(2,2,2003)}function Rt(t){if(e.TextEncoder&&!lt()){var n=new TextEncoder;return Oe(n.encode(t))}t=encodeURIComponent(t),t=unescape(t),n=new Uint8Array(t.length);for(var i=0;i<t.length;i++)n[i]=t[i].charCodeAt(0);return Oe(n)}function Ct(e,t){for(var n=new ArrayBuffer(2*e.length),i=new DataView(n),r=0;r<e.length;++r)i.setUint16(2*r,e.charCodeAt(r),t);return n}function Dt(e){return Pt.value()(e)}function Mt(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&nbsp;":" ","&lrm;":"‎","&rlm;":"‏"},n=/&(?:amp|lt|gt|quot|apos|nbsp|lrm|rlm|#[xX]?[0-9a-fA-F]+);/g,i=RegExp(n.source);return e&&i.test(e)?e.replace(n,(function(e){return"#"==e[1]?(e="x"==e[2]||"X"==e[2]?parseInt(e.substring(3),16):parseInt(e.substring(2),10),0<=e&&1114111>=e?String.fromCodePoint(e):""):t[e]||"'"})):e||""}K("shaka.util.StringUtils",xt),xt.resetFromCharCode=function(){Pt.g=void 0},xt.toUTF16=Ct,xt.toUTF8=Rt,xt.fromBytesAutoDetect=Lt,xt.fromUTF16=kt,xt.fromUTF8=It;var Pt=new Ge((function(){function e(e){try{var t=new Uint8Array(e);return 0<String.fromCharCode.apply(null,t).length}catch(n){return!1}}for(var t={jc:65536};0<t.jc;t={jc:t.jc},t.jc/=2)if(e(t.jc))return function(e){return function(t){for(var n="",i=0;i<t.length;i+=e.jc)n+=String.fromCharCode.apply(null,t.subarray(i,i+e.jc));return n}}(t);return null}));function _t(){}function Ot(e){return e=Dt(Ne(e)),btoa(e)}function Nt(e,t){return t=void 0==t||t,e=Ot(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/[=]*$/,"")}function Ut(t){t=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));for(var n=new Uint8Array(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n}function Ft(t){for(var n=t.length/2,i=new Uint8Array(n),r=0;r<n;r++)i[r]=e.parseInt(t.substr(2*r,2),16);return i}function Bt(e){var t=Ne(e);e="",t=d(t);for(var n=t.next();!n.done;n=t.next())n=n.value,n=n.toString(16),1==n.length&&(n="0"+n),e+=n;return e}function jt(){for(var e=F.apply(0,arguments),t=0,n=0;n<e.length;++n)t+=e[n].byteLength;t=new Uint8Array(t);for(var i=n=0;i<e.length;++i){var r=e[i];ArrayBuffer.isView(r)&&1===r.BYTES_PER_ELEMENT?t.set(r,n):t.set(Ne(r),n),n+=r.byteLength}return t}function $t(e,t,n){if(n=void 0===n?"":n,0==t.length)return e;if(1==e.length&&1==t.length){var i=new ve(e[0]);return t=new ve(t[0]),t=i.resolve(t),n&&Se(t,n),[t.toString()]}t=t.map((function(e){return new ve(e)})),i=[],e=d(e);for(var r=e.next();!r.done;r=e.next()){r=new ve(r.value);for(var s=d(t),a=s.next();!a.done;a=s.next())a=r.resolve(a.value),n&&Se(a,n),i.push(a.toString())}return i}function Gt(e,t,n,i){return e={keySystem:e,encryptionScheme:t,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:n||[],keyIds:new Set},i&&(e.keySystemUris=new Set([i])),e}function Vt(t,n){n=void 0===n?"cenc":n;var i=[],r=[],s=[];t.forEach((function(e,t){var n=t;22!=n.length&&(n=Nt(Ft(t),!1));var a=e;22!=a.length&&(a=Nt(Ft(e),!1)),e={kty:"oct",kid:n,k:a},i.push(e),r.push(e.kid),s.push(t)})),t=JSON.stringify({keys:i});var a=JSON.stringify({kids:r});return a=[{initData:Ne(Rt(a)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",encryptionScheme:n,licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:a,keyIds:new Set(s)}}function Ht(e,t){if(1==t.length)return t[0];if(e=Kt(e,t),null!=e)return e;throw new je(2,4,4025,t)}function Kt(e,t){var n=zt.get(e);n=d(n);for(var i=n.next();!i.done;i=n.next()){i=i.value;for(var r=d(t),s=r.next();!s.done;s=r.next())if(s=s.value,i.test(s.trim()))return s.trim()}return e==qt?"":null}function Wt(e,t){var n=[];e=zt.get(e),e=d(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;for(var r=d(t),s=r.next();!s.done;s=r.next())s=s.value,i.test(s.trim())&&n.push(s.trim())}return n}K("shaka.util.Uint8ArrayUtils",_t),_t.concat=jt,_t.toHex=Bt,_t.fromHex=Ft,_t.fromBase64=Ut,_t.toBase64=Nt,_t.toStandardBase64=Ot;var qt="text",Yt={la:"video",V:"audio",va:qt,$e:"image",Mj:"application"},Xt=1/15,zt=(new Map).set("audio",[/^vorbis$/,/^Opus$/,/^opus$/,/^fLaC$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4/,/^dts[cex]$/,/^iamf/,/^mhm[12]/,/^ac3$/,/^eac3$/]).set("video",[/^avc/,/^hev/,/^hvc/,/^vvc/,/^vvi/,/^vp0?[89]/,/^av01/,/^dvh/,/^dva/,/^dav/]).set("text",[/^vtt$/,/^wvtt/,/^stpp/]);function Qt(e,t,n,i){this.g=null,this.l=e,this.i=t,this.m=n,this.o=i,this.j=!1;e:{if("undefined"===typeof libDPIModule&&Z("Could not find LCEVC Library dependencies on this page"),"undefined"!==typeof LCEVCdec)this.h=LCEVCdec;else{if("undefined"===typeof LcevcDil){Z("Could not find LCEVC Library on this page"),e=!1;break e}this.h=LcevcDil,this.j=!0,he("LcevcDil","lcevc_dil.js is deprecated, please use lcevc_dec.js instead")}"undefined"===typeof this.h.SupportObject?(Z("Could not find LCEVC Library on this page"),e=!1):(this.h.SupportObject.SupportStatus||Z(this.h.SupportObject.SupportError),e="undefined"!==typeof this.h&&"undefined"!==typeof libDPIModule&&this.i instanceof HTMLCanvasElement&&this.h.SupportObject.SupportStatus)}e&&!this.g&&this.h.SupportObject.webGLSupport(this.i)&&(this.i.classList.remove("shaka-hidden"),this.g=this.j?new this.h.LcevcDil(this.l,this.i,this.m):new this.h.LCEVCdec(this.l,this.i,this.m))}function Jt(e,t,n,i){"video"!==i.type||e.o&&!i.baseOriginalId||e.g&&e.g.appendBuffer(t,"video",i.id,-n,!e.o)}function Zt(e){e.g&&e.i.classList.add("shaka-hidden")}function en(e){return!(!e||"undefined"===typeof LCEVCdec)&&"lvc1"==e.codecs}function tn(t){if(sn.has(t))return sn.get(t);var n=e.ManagedMediaSource||e.MediaSource;return!!n&&(n=n.isTypeSupported(t),sn.set(t,n),n)}function nn(){var t=e.ManagedSourceBuffer||e.SourceBuffer;return!!t&&!!t.prototype&&!!t.prototype.changeType}function rn(){var t=e.ManagedMediaSource||e.MediaSource;return!(!t||!t.prototype)&&(!!t.prototype.setLiveSeekableRange&&!!t.prototype.clearLiveSeekableRange)}Qt.prototype.release=function(){this.g&&(this.g.close(),this.g=null)},K("shaka.lcevc.Dec",Qt),Qt.prototype.release=Qt.prototype.release;var sn=new Map;function an(){}function on(){}function un(){}function ln(e){this.l=new on,(e=dn(e.toLowerCase()))&&(this.l=e()),this.h=new an,(e=fn)&&(this.h=e())}function cn(e,t){hn.set(e,t)}function dn(e){return hn.get(e)}an.prototype.extract=function(){},an.prototype.decode=function(){return[]},an.prototype.clear=function(){},an.prototype.getStreams=function(){return[]},on.prototype.init=function(){},on.prototype.parse=function(){return[]},un.prototype.init=function(){},un.prototype.i=function(){},un.prototype.g=function(){},un.prototype.j=function(){},K("shaka.media.IClosedCaptionParser",un),ln.prototype.init=function(e,t){void 0!==t&&t||this.g(),this.l.init(e)},ln.prototype.i=function(e){e=this.l.parse(e),e=d(e);for(var t=e.next();!t.done;t=e.next()){t=t.value;var n=Ne(t.packet);0<n.length&&this.h.extract(n,t.pts)}return this.h.decode()},ln.prototype.g=function(){this.h.clear()},ln.prototype.j=function(){return this.h.getStreams()},K("shaka.media.ClosedCaptionParser",ln),ln.findDecoder=function(){return fn},ln.unregisterDecoder=function(){fn=null},ln.registerDecoder=function(e){fn=e},ln.findParser=dn,ln.unregisterParser=function(e){hn.delete(e)},ln.registerParser=cn;var hn=new Map,fn=null;function pn(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=gn,this.scroll=mn}K("shaka.text.CueRegion",pn);var gn=1;pn.units={PX:0,PERCENTAGE:gn,LINES:2};var mn="";function vn(e,t){return!("number"!==typeof e||"number"!==typeof t||!isNaN(e)||!isNaN(t))||e===t}function yn(e,t){t=e.indexOf(t),-1<t&&e.splice(t,1)}function bn(e,t,n){if(n||(n=vn),e.length!=t.length)return!1;t=t.slice(),e=d(e);for(var i=e.next(),r={};!i.done;r={$g:void 0},i=e.next()){if(r.$g=i.value,i=t.findIndex(function(e){return function(t){return n(e.$g,t)}}(r)),-1==i)return!1;t[i]=t[t.length-1],t.pop()}return 0==t.length}function Tn(e,t,n){if(e===t)return!0;if(!e||!t)return e==t;if(n||(n=vn),e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1;return!0}function Sn(e){this.h=e||"",this.g=0}function En(e){wn(e,/[ \t]+/gm)}function wn(e,t){return t.lastIndex=e.g,t=t.exec(e.h),t=null==t?null:{position:t.index,length:t[0].length,results:t},e.g==e.h.length||null==t||t.position!=e.g?null:(e.g+=t.length,t.results)}function An(e){return e.g==e.h.length?null:(e=wn(e,/[^ \t\n]*/gm))?e[0]:null}function xn(e){if(e=wn(e,kn),null==e)return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:(Number(e[6])||0)/1e3+n+60*t+3600*(Number(e[1])||0)}function In(e){return e?xn(new Sn(e)):null}pn.scrollMode={NONE:mn,UP:"up"};var kn=/(?:(\d{1,}):)?(\d{2}):(\d{2})((\.(\d{1,3})))?/g;function Ln(e){function t(e){switch(typeof e){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return e;default:if(!e||ArrayBuffer.isView(e))return e;if(n.has(e))return null;var i=e.constructor==Array;if(e.constructor!=Object&&!i)return null;n.add(e);var r,s=i?[]:{};for(r in e)s[r]=t(e[r]);return i&&(s.length=e.length),s}}var n=new WeakSet;return t(e)}function Rn(e){var t,n={};for(t in e)n[t]=e[t];return n}function Cn(e){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++){var i=n.toString(),r=e[n];void 0!==r&&(r=Cn(r))&&t.push(i+":"+r)}e="["+t.join(",")+"]"}else if("function"==typeof e)e="";else if(e instanceof Object){for(n=Object.keys(e),n.sort(),t=[],n=d(n),i=n.next();!i.done;i=n.next())r=i.value,i=JSON.stringify(r),r=e[r],void 0!==r&&(r=Cn(r))&&t.push(i+":"+r);e="{"+t.join(",")+"}"}else e=JSON.stringify(e);return e}
/*
 @license
 tXml
 Copyright 2015 Tobias Nickel
 SPDX-License-Identifier: MIT
*/
function Dn(e,t){var n=void 0!==n&&n;return e=Lt(e),Mn(e,t,n)}function Mn(e,t,n){return e=_n(e,void 0!==n&&n),!t&&e.length?e[0]:(e=e.find((function(e){return t.split(",").includes(e.tagName)})))?e:null}function Pn(e){return ui.has(e)?ui.get(e):""}function _n(e,t){function n(s,a){a=void 0!==a&&a;for(var o=[];e[r];)if(60==e.charCodeAt(r)){if(47===e.charCodeAt(r+1)){a=r+2,r=e.indexOf(">",r),a=e.substring(a,r);var u=a.indexOf(s);if(-1==u){var l=s.indexOf(".");0<l&&(u=a.indexOf(s.substring(0,l)))}if(-1==u)throw s=e.substring(0,r).split("\n"),Error("Unexpected close tag\nLine: "+(s.length-1)+"\nColumn: "+(s[s.length-1].length+1)+"\nChar: "+e[r]);r+1&&(r+=1);break}if(33===e.charCodeAt(r+1)){if(45==e.charCodeAt(r+2)){for(;-1!==r&&(62!==e.charCodeAt(r)||45!=e.charCodeAt(r-1)||45!=e.charCodeAt(r-2)||-1==r);)r=e.indexOf(">",r+1);-1===r&&(r=e.length)}else if(91===e.charCodeAt(r+2)&&91===e.charCodeAt(r+8)&&"cdata"===e.substr(r+3,5).toLowerCase()){u=e.indexOf("]]>",r),-1==u?(o.push(e.substr(r+9)),r=e.length):(o.push(e.substring(r+9,u)),r=u+3);continue}r++;continue}e:{l=a,r++;var c=i(),d={};for(u=[];62!==e.charCodeAt(r)&&e[r];){var f=e.charCodeAt(r);if(64<f&&91>f||96<f&&123>f){f=i();for(var p=e.charCodeAt(r);p&&39!==p&&34!==p&&!(64<p&&91>p||96<p&&123>p)&&62!==p;)r++,p=e.charCodeAt(r);var g=r+1;if(r=e.indexOf(e[r],g),g=e.slice(g,r),39===p||34===p){if(-1===r){if(l={tagName:c,attributes:d,children:u,parent:null},t)for(c=0;c<u.length;c++)"string"!==typeof u[c]&&(u[c].parent=l);u=l;break e}}else g=null,r--;if(f.startsWith("xmlns:")){p=g;var m=f.split(":")[1];ui.set(p,m),li.set(m,p)}"tt"===c&&"xml:space"===f&&"preserve"===g&&(l=!0),d[f]=g}r++}for(47!==e.charCodeAt(r-1)?(r++,u=n(c,l)):r++,l={tagName:c,attributes:d,children:u,parent:null},c=u.length,d=0;d<c;d++)f=u[d],"string"!==typeof f?t&&(f.parent=l):d==c-1&&"\n"==f&&u.pop();u=l}if(o.push(u),"string"===typeof u)break;"?"===u.tagName[0]&&u.children&&(o.push.apply(o,h(u.children)),u.children=[])}else u=r,r=e.indexOf("<",r)-1,-2===r&&(r=e.length),u=e.slice(u,r+1),a?0<u.length&&o.push(u):(o.length&&1==u.length&&"\n"==u[0]||0<u.trim().length)&&o.push(u),r++;return o}function i(){for(var t=r;-1==="\r\n\t>/= ".indexOf(e[r])&&e[r];)r++;return e.slice(t,r)}var r=0;return n("")}function On(e){return"string"===typeof e}function Nn(e){var t=[];if(!e.children)return[];e=d(e.children);for(var n=e.next();!n.done;n=e.next())n=n.value,"string"!==typeof n&&t.push(n);return t}function Un(e,t){var n=[];if(!e.children)return[];e=d(e.children);for(var i=e.next();!i.done;i=e.next())i=i.value,i.tagName===t&&n.push(i);return n}function Fn(e){return"string"===typeof e?Mt(e):(e=e.children.reduce((function(e,t){return"string"===typeof t?e+t:e}),""),""===e?null:Mt(e))}function Bn(e){return Array.from(e.children).every((function(e){return"string"===typeof e}))?((e=Fn(e))&&(e=e.trim()),e):null}function jn(e,t,n){if(n=void 0===n?[]:n,e.tagName===t&&n.push(e),e.children){e=d(e.children);for(var i=e.next();!i.done;i=e.next())jn(i.value,t,n)}return n}function $n(e,t){return e=Un(e,t),1!=e.length?null:e[0]}function Gn(e,t,n){return e=Kn(e,t,n),1!=e.length?null:e[0]}function Vn(e,t,n,i){i=void 0===i?null:i;var r=null;return e=e.attributes[t],null!=e&&(r=n(e)),null==r?i:r}function Hn(e,t,n){return t=Pn(t),e.attributes[t+":"+n]||null}function Kn(e,t,n){var i=Pn(t);if(t=[],e.children)for(n=i?i+":"+n:n,e=d(e.children),i=e.next();!i.done;i=e.next())(i=i.value)&&i.tagName===n&&t.push(i);return t}function Wn(e,t,n){t=d(t);for(var i=t.next();!i.done;i=t.next())if(i=Hn(e,i.value,n))return i;return null}function qn(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null}function Yn(e){return e?(e=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$","i").exec(e),e?(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null):null):null}function Xn(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null}function zn(e){return e=Number(e),0===e%1?e:null}function Qn(e){return e=Number(e),0===e%1&&0<e?e:null}function Jn(e){return e=Number(e),0===e%1&&0<=e?e:null}function Zn(e){return e=Number(e),isNaN(e)?null:e}function ei(e){return!!e&&"true"===e.toLowerCase()}function ti(e){var t,n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(n)?null:n}function ni(e){var t=[];e=Mt(e).split(/\/+(?=(?:[^'"]*['"][^'"]*['"])*[^'"]*$)/),e=d(e);for(var n=e.next();!n.done;n=e.next()){n=n.value;var i=n.match(/^([\w]+)/);if(i){var r=n.match(/(@id='(.*?)')/),s=n.match(/(@t='(\d+)')/),a=n.match(/(@n='(\d+)')/),o=n.match(/\[(\d+)\]/);t.push({name:i[0],id:r?r[0].match(/'(.*?)'/)[0].replace(/'/gm,""):null,t:s?Number(s[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,n:a?Number(a[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,position:o?Number(o[1])-1:null,Zb:n.split("/@")[1]||null})}else n.startsWith("@")&&t.length&&(t[t.length-1].Zb=n.slice(1))}return t}function ii(e,t){var n=ni(t.attributes.sel||"");if(n.length){var i=n[n.length-1],r=t.attributes.pos||null;n=i.position,null==n&&(null!==i.t&&(n=ri(e,"t",i.t)),null!==i.n&&(n=ri(e,"n",i.n))),null===n?n="prepend"===r?0:e.length:"prepend"===r?--n:"after"===r&&++n,r=t.tagName,(i=i.Zb)&&e[n]?si(e[n],r,i,Bn(t)||""):("remove"!==r&&"replace"!==r||e.splice(n,1),"add"!==r&&"replace"!==r||e.splice.apply(e,[n,0].concat(h(t.children))))}}function ri(e,t,n){var i=0;e=d(e);for(var r=e.next();!r.done;r=e.next()){if(Number(r.value.attributes[t])===n)return i;i++}return null}function si(e,t,n,i){"remove"===t?delete e.attributes[n]:"add"!==t&&"replace"!==t||(e.attributes[n]=i)}function ai(e){var t="",n=e.tagName.split(":");for(var i in 0<n.length&&(t=n[0],t=li.has(t)?li.get(t):""),t=document.createElementNS(t,e.tagName),e.attributes)t.setAttribute(i,e.attributes[i]);for(e=d(e.children),i=e.next();!i.done;i=e.next())i=i.value,n=void 0,n="string"==typeof i?new Text(i):ai(i),t.appendChild(n);return t}function oi(e){if(!e)return null;var t={tagName:e.tagName,attributes:Rn(e.attributes),children:[],parent:null};e=d(e.children);for(var n=e.next();!n.done;n=e.next())n=n.value,"string"===typeof n||(n=oi(n),n.parent=t),t.children.push(n);return t}var ui=new Map,li=new Map;function ci(e,t,n){this.startTime=e,this.endTime=t,this.payload=n,this.region=new pn,this.position=null,this.positionAlign=yi,this.size=0,this.textAlign=bi,this.direction=wi,this.writingMode=Ai,this.lineInterpretation=xi,this.line=null,this.lineHeight="",this.lineAlign=Ii,this.displayAlign=Si,this.fontSize=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=Ci,this.fontStyle=Mi,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textCombineUpright="",this.textDecoration=[],this.textStrokeWidth=this.textStrokeColor=this.textShadow="",this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.rubyTag=null,this.cellResolution={oc:32,rows:15}}function di(e,t){return e=new ci(e,t,""),e.lineBreak=!0,e}function hi(e,t){if(e.payload!=t.payload||!(.001>Math.abs(e.startTime-t.startTime)&&.001>Math.abs(e.endTime-t.endTime)))return!1;for(var n in e)if("startTime"!=n&&"endTime"!=n&&"payload"!=n)if("nestedCues"==n){if(!Tn(e.nestedCues,t.nestedCues,hi))return!1}else if("region"==n||"cellResolution"==n){for(var i in e[n])if(e[n][i]!=t[n][i])return!1}else if(Array.isArray(e[n])){if(!Tn(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}function fi(e,t){t=void 0===t?new Map:t;var n=e.payload;if(n.includes("<")){0===t.size&&pi(t);var i=n;n=[];for(var r=-1,s=0;s<i.length;s++)"<"===i[s]?r=s+1:">"===i[s]&&0<r&&(r=i.substr(r,s-r),r.match(Ni)&&n.push(r),r=-1);for(n=d(n),s=n.next();!s.done;s=n.next())s=s.value,i=i.replace("<"+s+">",'<div time="'+s+'">'),i+="</div>";e:{s=i,r=[];var a=-1;n="",i=!1;for(var o=0;o<s.length;o++)if("/"===s[o]){var u=s.indexOf(">",o);if(-1===u){n=s;break e}if((u=s.substring(o+1,u))&&"v"==u){i=!0;var l=null;if(r.length&&(l=r[r.length-1]),l){if(l===u)n+="/"+u+">";else{if(!l.startsWith("v")){n+=s[o];continue}n+="/"+l+">"}o+=u.length+1}else n+=s[o]}else n+=s[o]}else"<"===s[o]?(a=o+1,"v"!=s[a]&&(a=-1)):">"===s[o]&&0<a&&(r.push(s.substr(a,o-a)),a=-1),n+=s[o];for(s=d(r),r=s.next();!r.done;r=s.next())r=r.value,a=r.replace(" ",".voice-"),n=n.replace("<"+r+">","<"+a+">"),n=n.replace("</"+r+">","</"+a+">"),i||(n+="</"+a+">")}n=gi(n),e.payload="";try{var c=Mn("<span>"+n+"</span>","span")}catch(h){}if(c)if(c=c.children,1!=c.length||c[0].tagName)for(c=d(c),n=c.next();!n.done;n=c.next())mi(n.value,e,t);else e.payload=Mt(n);else e.payload=Mt(n)}else e.payload=Mt(n)}function pi(e){for(var t=d(Object.entries(Li)),n=t.next();!n.done;n=t.next()){var i=d(n.value);n=i.next().value,i=i.next().value;var r=new ci(0,0,"");r.color=i,e.set("."+n,r)}for(t=d(Object.entries(Ri)),n=t.next();!n.done;n=t.next())i=d(n.value),n=i.next().value,i=i.next().value,r=new ci(0,0,""),r.backgroundColor=i,e.set("."+n,r)}function gi(e){var t={"< ":""," >":" &gt;"},n=/(< +>|<\s|\s>)/g,i=RegExp(n.source);return e&&i.test(e)?e.replace(n,(function(e){return t[e]||""})):e||""}function mi(e,t,n){var i=t.clone();if(i.nestedCues=[],i.payload="",i.rubyTag="",i.line=null,i.region=new pn,i.position=null,i.size=0,i.textAlign=bi,e.tagName)for(var r=d(e.tagName.split(/(?=[ .])+/g)),s=r.next();!s.done;s=r.next()){var a=s=s.value;if(a.startsWith(".voice-")){var o=a.split("-").pop();a='v[voice="'+o+'"]',n.has(a)||(a="v[voice="+o+"]")}switch(n.has(a)&&(o=i,a=n.get(a))&&(o.backgroundColor=vi(a.backgroundColor,o.backgroundColor),o.color=vi(a.color,o.color),o.fontFamily=vi(a.fontFamily,o.fontFamily),o.fontSize=vi(a.fontSize,o.fontSize),o.textShadow=vi(a.textShadow,o.textShadow),o.fontWeight=a.fontWeight,o.fontStyle=a.fontStyle,o.opacity=a.opacity,o.rubyTag=a.rubyTag,o.textCombineUpright=a.textCombineUpright,o.wrapLine=a.wrapLine),s){case"br":return i=di(i.startTime,i.endTime),void t.nestedCues.push(i);case"b":i.fontWeight=Di;break;case"i":i.fontStyle=Pi;break;case"u":i.textDecoration.push(Oi);break;case"font":(s=e.attributes.color)&&(i.color=s);break;case"div":if(s=e.attributes.time,!s)break;(s=In(s))&&(i.startTime=s);break;case"ruby":case"rp":case"rt":i.rubyTag=s}}if(r=e.children,On(e)||1==r.length&&On(r[0]))for(n=Fn(e).split("\n"),e=!0,n=d(n),r=n.next();!r.done;r=n.next())r=r.value,e||(e=di(i.startTime,i.endTime),t.nestedCues.push(e)),0<r.length&&(e=i.clone(),e.payload=Mt(r),t.nestedCues.push(e)),e=!1;else for(t.nestedCues.push(i),t=d(r),e=t.next();!e.done;e=t.next())mi(e.value,i,n)}function vi(e,t){return e&&0<e.length?e:t}ci.prototype.clone=function(){var e,t=new ci(0,0,"");for(e in this)t[e]=this[e],t[e]&&t[e].constructor==Array&&(t[e]=t[e].slice());return t},K("shaka.text.Cue",ci),ci.parseCuePayload=fi,ci.equal=hi,ci.prototype.clone=ci.prototype.clone;var yi="auto";ci.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:yi};var bi="center",Ti={LEFT:"left",RIGHT:"right",CENTER:bi,START:"start",END:"end"};ci.textAlign=Ti;var Si="after",Ei={BEFORE:"before",CENTER:"center",AFTER:Si};ci.displayAlign=Ei;var wi="ltr";ci.direction={HORIZONTAL_LEFT_TO_RIGHT:wi,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var Ai="horizontal-tb";ci.writingMode={HORIZONTAL_TOP_TO_BOTTOM:Ai,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var xi=0;ci.lineInterpretation={LINE_NUMBER:xi,PERCENTAGE:1};var Ii="start",ki={CENTER:"center",START:Ii,END:"end"};ci.lineAlign=ki;var Li={white:"white",lime:"lime",cyan:"cyan",red:"red",yellow:"yellow",magenta:"magenta",blue:"blue",black:"black"};ci.defaultTextColor=Li;var Ri={bg_white:"white",bg_lime:"lime",bg_cyan:"cyan",bg_red:"red",bg_yellow:"yellow",bg_magenta:"magenta",bg_blue:"blue",bg_black:"black"};ci.defaultTextBackgroundColor=Ri;var Ci=400,Di=700;ci.fontWeight={NORMAL:Ci,BOLD:Di};var Mi="normal",Pi="italic",_i={NORMAL:Mi,ITALIC:Pi,OBLIQUE:"oblique"};ci.fontStyle=_i;var Oi="underline";ci.textDecoration={UNDERLINE:Oi,LINE_THROUGH:"lineThrough",OVERLINE:"overline"};var Ni=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g;function Ui(){}function Fi(e,t,n){ji.set(e.toLowerCase().split(";")[0]+"-"+n,{priority:n,ue:t})}function Bi(e,t){for(var n=e.toLowerCase().split(";")[0],i=d([Hi,Vi,Gi,$i]),r=i.next();!r.done;r=i.next())if(r=ji.get(n+"-"+r.value)){var s=r.ue(),a=s.isSupported(e,t);if(s.destroy(),a)return r.ue}return null}Ui.prototype.destroy=function(){},K("shaka.transmuxer.TransmuxerEngine",Ui),Ui.findTransmuxer=Bi,Ui.unregisterTransmuxer=function(e,t){ji.delete(e.toLowerCase().split(";")[0]+"-"+t)},Ui.registerTransmuxer=Fi,Ui.prototype.destroy=Ui.prototype.destroy;var ji=new Map,$i=1,Gi=2,Vi=3,Hi=4;function Ki(){}function Wi(e,t){var n=e;return t&&!rr.includes(e)&&(n+='; codecs="'+t+'"'),n}function qi(e,t){return t&&(e+='; codecs="'+t+'"'),e}function Yi(e,t,n){var i=Wi(e,t);return t=qi(e,t),Bi(t)?(e=Bi(t))?(e=e(),n=e.convertCodecs(n,t),e.destroy()):n=t:n="video/mp2t"!=e&&"audio"==n?i.replace("video","audio"):i,n}function Xi(e,t,n){var i=[t];return ir.forEach((function(t,r){var s=e[r];"codecs"==r?rr.includes(e.mimeType)||i.push('codecs="'+n+'"'):s&&i.push(t+'="'+s+'"')})),"PQ"==e.hdr&&i.push('eotf="smpte2084"'),i.join(";")}function zi(e){return e.split(";")[0].split("/")[1]}function Qi(e){var t=nr(e);switch(e=t[0].toLowerCase(),t=t[1].toLowerCase(),!0){case"mp4a"===e&&"69"===t:case"mp4a"===e&&"6b"===t:case"mp4a"===e&&"40.34"===t:return"mp3";case"mp4a"===e&&"66"===t:case"mp4a"===e&&"67"===t:case"mp4a"===e&&"68"===t:case"mp4a"===e&&"40.2"===t:case"mp4a"===e&&"40.02"===t:case"mp4a"===e&&"40.5"===t:case"mp4a"===e&&"40.05"===t:case"mp4a"===e&&"40.29"===t:case"mp4a"===e&&"40.42"===t:return"aac";case"mp4a"===e&&"a5"===t:case"ac3"===e:case"ac-3"===e:return"ac-3";case"mp4a"===e&&"a6"===t:case"eac3"===e:case"ec-3"===e:return"ec-3";case"ac-4"===e:return"ac-4";case"mp4a"===e&&"b2"===t:return"dtsx";case"mp4a"===e&&"a9"===t:return"dtsc";case"vp09"===e:case"vp9"===e:return"vp9";case"avc1"===e:case"avc3"===e:return"avc";case"hvc1"===e:case"hev1"===e:return"hevc";case"vvc1"===e:case"vvi1"===e:return"vvc";case"dvh1"===e:case"dvhe"===e:return t&&t.startsWith("05")?"dovi-p5":"dovi-hevc";case"dvav"===e:case"dva1"===e:return"dovi-avc";case"dav1"===e:return"dovi-av1";case"dvc1"===e:case"dvi1"===e:return"dovi-vvc"}return e}function Ji(e){var t=[];e=d(e.split(","));for(var n=e.next();!n.done;n=e.next())n=nr(n.value),t.push(n[0]);return t.sort().join(",")}function Zi(e){return e.split(";")[0]}function er(e){return e=e.split(/ *; */),e.shift(),(e=e.find((function(e){return e.startsWith("codecs=")})))?e.split("=")[1].replace(/^"|"$/g,""):""}function tr(e){return"application/x-mpegurl"===e||"application/vnd.apple.mpegurl"===e}function nr(e){e=e.split(".");var t=e[0];return e.shift(),[t,e.join(".")]}Ui.PluginPriority={FALLBACK:$i,PREFERRED_SECONDARY:Gi,PREFERRED:Vi,APPLICATION:Hi},K("shaka.util.MimeUtils",Ki),Ki.getFullTypeWithAllCodecs=qi,Ki.getFullType=Wi;var ir=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels"),rr=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"];function sr(e){this.i=null,this.j=e,this.B=!1,this.l=this.u=0,this.m=1/0,this.h=this.g=null,this.C="",this.A=function(){},this.o=new Map}function ar(e,t){pr.set(e,t)}function or(e){return pr.get(e)}function ur(e){return!!pr.has(e)||("application/cea-608"==e||"application/cea-708"==e)&&!!fn}function lr(e,t,n,i,r){var s,a,o,u,l,c,h;return U((function(f){if(1==f.g)return w(f,Promise.resolve(),2);if(!e.i||!e.j)return f.return();if(null==n||null==i)return e.i.parseInit(Ne(t)),f.return();for(s=e.B?n:e.u,a={periodStart:e.u,segmentStart:n,segmentEnd:i,vttOffset:s},o=e.i.parseMedia(Ne(t),a,r,[]),u=d(o),l=u.next();!l.done;l=u.next())c=l.value,e.A(c,r||null,a);h=o.filter((function(t){return t.startTime>=e.l&&t.startTime<e.m})),e.j.append(h),null==e.g&&(e.g=Math.max(n,e.l)),e.h=Math.min(i,e.m),A(f)}))}function cr(e,t,n){e.l=t,e.m=n}function dr(e,t,n){if(e.C=t,t=e.o.get(t))for(var i=d(t.keys()),r=i.next();!r.done;r=i.next())(r=t.get(r.value).filter((function(e){return e.endTime<=n})))&&e.j.append(r)}function hr(e,t,n){t.startTime+=n,t.endTime+=n,t=d(t.nestedCues);for(var i=t.next();!i.done;i=t.next())hr(e,i.value,n)}function fr(e,t,n,i,r){var s=n+" "+i,a=new Map;t=d(t);for(var o=t.next();!o.done;o=t.next()){var u=o.value;o=u.stream,u=u.cue,a.has(o)||a.set(o,new Map),a.get(o).has(s)||a.get(o).set(s,[]),hr(e,u,r),u.startTime>=e.l&&u.startTime<e.m&&(a.get(o).get(s).push(u),o==e.C&&e.j.append([u]))}for(r=d(a.keys()),s=r.next();!s.done;s=r.next())for(s=s.value,e.o.has(s)||e.o.set(s,new Map),t=d(a.get(s).keys()),o=t.next();!o.done;o=t.next())o=o.value,u=a.get(s).get(o),e.o.get(s).set(o,u);e.g=null==e.g?Math.max(n,e.l):Math.min(e.g,Math.max(n,e.l)),e.h=Math.max(e.h,Math.min(i,e.m))}sr.prototype.destroy=function(){return this.j=this.i=null,this.o.clear(),Promise.resolve()},sr.prototype.remove=function(e,t){var n=this;return U((function(i){if(1==i.g)return w(i,Promise.resolve(),2);!n.j||!n.j.remove(e,t)||null==n.g||t<=n.g||e>=n.h||(e<=n.g&&t>=n.h?n.g=n.h=null:e<=n.g&&t<n.h?n.g=t:e>n.g&&t>=n.h&&(n.h=e)),A(i)}))},K("shaka.text.TextEngine",sr),sr.prototype.destroy=sr.prototype.destroy,sr.findParser=or,sr.unregisterParser=function(e){pr.delete(e)},sr.registerParser=ar;var pr=new Map;function gr(e,t){return e.concat(t)}function mr(){}function vr(e){return null!=e}function yr(e,t){return Promise.race([t,new Promise((function(t,n){new ze(n).da(e)}))])}function br(){}function Tr(e,t){return e=wr(e),t=wr(t),e.split("-")[0]==t.split("-")[0]}function Sr(e,t){return e=wr(e),t=wr(t),e=e.split("-"),t=t.split("-"),e[0]==t[0]&&1==e.length&&2==t.length}function Er(e,t){return e=wr(e),t=wr(t),e=e.split("-"),t=t.split("-"),2==e.length&&2==t.length&&e[0]==t[0]}function wr(e){e=d(e.split("-x-"));var t=e.next().value;t=void 0===t?"":t,e=e.next().value,e=void 0===e?"":e;var n=d(t.split("-"));return t=n.next().value,t=void 0===t?"":t,n=n.next().value,n=void 0===n?"":n,e=e?"x-"+e:"",t=t.toLowerCase(),t=Lr.get(t)||t,n=n.toUpperCase(),(n?t+"-"+n:t)+(e?"-"+e:"")}function Ar(e,t){return e=wr(e),t=wr(t),t==e?4:Sr(t,e)?3:Er(t,e)?2:Sr(e,t)?1:0}function xr(e){var t=e.indexOf("-");return e=0<=t?e.substring(0,t):e,e=e.toLowerCase(),Lr.get(e)||e}function Ir(e){return e.language?wr(e.language):e.audio&&e.audio.language?wr(e.audio.language):e.video&&e.video.language?wr(e.video.language):"und"}function kr(e,t){e=wr(e);var n=new Set;t=d(t);for(var i=t.next();!i.done;i=t.next())n.add(wr(i.value));for(t=d(n),i=t.next();!i.done;i=t.next())if(i=i.value,i==e)return i;for(t=d(n),i=t.next();!i.done;i=t.next())if(i=i.value,Sr(i,e))return i;for(t=d(n),i=t.next();!i.done;i=t.next())if(i=i.value,Er(i,e))return i;for(n=d(n),t=n.next();!t.done;t=n.next())if(t=t.value,Sr(e,t))return t;return null}K("shaka.util.LanguageUtils",br),br.findClosestLocale=kr,br.getLocaleForVariant=Ir,br.getLocaleForText=function(e){return wr(e.language||"und")},br.getBase=xr,br.relatedness=Ar,br.areSiblings=function(e,t){var n=xr(e),i=xr(t);return e!=n&&t!=i&&n==i},br.normalize=wr,br.isSiblingOf=Er,br.isParentOf=Sr,br.areLanguageCompatible=Tr,br.areLocaleCompatible=function(e,t){return e=wr(e),t=wr(t),e==t};var Lr=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function Rr(){}function Cr(e,t,n,i,r){function s(e){var t=String(e.width||"")+String(e.height||"")+String(Math.round(e.frameRate||0))+(e.hdr||"")+e.fastSwitching;return e.dependencyStream&&(t+=e.dependencyStream.baseOriginalId||""),t}function a(e){var t=e.language+(e.channelsCount||0)+(e.audioSamplingRate||0)+e.roles.join(",")+e.label+e.groupId+e.fastSwitching;return e.dependencyStream&&(t+=e.dependencyStream.baseOriginalId||""),t}if(r.length){var o=e.textStreams;r=d(r);for(var u=r.next(),l={};!u.done;l={sg:void 0},u=r.next())if(l.sg=u.value,u=o.filter(function(e){return function(t){return!(!t.codecs.startsWith(e.sg)&&!t.mimeType.startsWith(e.sg))}}(l)),u.length){o=u;break}e.textStreams=o}if(o=e.variants,(t.length||n.length)&&(o=Dr(o,t,n)),i.length){for(t=new se,n=d(o),o=n.next();!o.done;o=n.next())o=o.value,t.push(String(o.video.width||0),o);var c=[];t.forEach((function(e,t){e=0;var n=[];t=d(t);for(var r=t.next(),s={};!r.done;s={Qe:void 0},r=t.next())s.Qe=r.value,r=i.filter(function(e){return function(t){return e.Qe.decodingInfos[0][t]}}(s)).length,r>e?(e=r,n=[s.Qe]):r==e&&n.push(s.Qe);c.push.apply(c,h(n))})),o=c}for(n=new Set,t=new Set,o=d(o),r=o.next();!r.done;r=o.next())r=r.value,r.audio&&n.add(r.audio),r.video&&t.add(r.video);o=Array.from(n).sort((function(e,t){return e.bandwidth-t.bandwidth}));var f=[];for(n=new Map,o=d(o),r=o.next();!r.done;r=o.next()){if(r=r.value,u=a(r),l=n.get(u)||[],l.length){var p=l[l.length-1],g=Qi(p.codecs),m=Qi(r.codecs);g!=m||r.bandwidth&&p.bandwidth&&!(r.bandwidth>p.bandwidth)||(l.push(r),f.push(r.id))}else l.push(r),f.push(r.id);n.set(u,l)}var v={vp8:1,avc:1,"dovi-avc":.95,vp9:.9,vp09:.9,hevc:.85,"dovi-hevc":.8,"dovi-p5":.75,av01:.7,"dovi-av1":.65,vvc:.6};o=Array.from(t).sort((function(e,t){if(!e.bandwidth||!t.bandwidth||e.bandwidth==t.bandwidth){if(e.codecs&&t.codecs&&e.codecs!=t.codecs&&e.width==t.width){var n=Qi(e.codecs),i=Qi(t.codecs);if(n!=i)return(v[n]||1)-(v[i]||1)}return e.width-t.width}return e.bandwidth-t.bandwidth})),t=nn();var y=[];for(n=new Map,o=d(o),r=o.next();!r.done;r=o.next()){if(r=r.value,u=s(r),l=n.get(u)||[],l.length){if(p=l[l.length-1],!t&&(g=Qi(p.codecs),m=Qi(r.codecs),g!==m))continue;g=Qi(p.codecs),m=Qi(r.codecs),g!=m||r.bandwidth&&p.bandwidth&&!(r.bandwidth>p.bandwidth)||(l.push(r),y.push(r.id))}else l.push(r),y.push(r.id);n.set(u,l)}e.variants=e.variants.filter((function(e){var t=e.audio;return e=e.video,!(t&&!f.includes(t.id)||e&&!y.includes(e.id))}))}function Dr(e,t,n){t=d(t);for(var i=t.next(),r={};!i.done;r={Kh:void 0},i=t.next())if(r.Kh=i.value,i=e.filter(function(e){return function(t){return t.video&&t.video.codecs.startsWith(e.Kh)}}(r)),i.length){e=i;break}for(n=d(n),t=n.next(),i={};!t.done;i={Cg:void 0},t=n.next())if(i.Cg=t.value,t=e.filter(function(e){return function(t){return t.audio&&t.audio.codecs.startsWith(e.Cg)}}(i)),t.length){e=t;break}return e}function Mr(e,t,n){e.variants=e.variants.filter((function(e){return Pr(e,t,n)}))}function Pr(e,t,n){function i(e,t,n){return e>=t&&e<=n}var r=e.video;if(r&&r.width&&r.height){var s=r.width,a=r.height;if(a>s&&(a=d([a,s]),s=a.next().value,a=a.next().value),!i(s,t.minWidth,Math.min(t.maxWidth,n.width))||!i(a,t.minHeight,Math.min(t.maxHeight,n.height))||!i(r.width*r.height,t.minPixels,t.maxPixels))return!1}return!(e&&e.video&&e.video.frameRate&&!i(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||e&&e.audio&&e.audio.channelsCount&&!i(e.audio.channelsCount,t.minChannelsCount,t.maxChannelsCount)||!i(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function _r(e,t,n,i){return n=void 0===n?[]:n,i=void 0===i?{}:i,U((function(r){return 1==r.g?w(r,Or(e,t,0<t.offlineSessionIds.length,n,i),2):(Hr(t),w(r,Kr(t),0))}))}function Or(e,t,n,i,r){var s,a;return U((function(o){if(1==o.g)return et()&&Nr(t.variants),w(o,jr(t.variants,n,!1,i),2);s=null,e&&(a=e.h)&&(s=a.keySystem),t.variants=t.variants.filter((function(e){var t=Ur(e,s,r);if(!t){var n=[];e.audio&&n.push(rs(e.audio)),e.video&&n.push(rs(e.video))}return t})),A(o)}))}function Nr(e){var t=(new Map).set("dvav","avc3").set("dva1","avc1").set("dvhe","hev1").set("dvh1","hvc1").set("dvc1","vvc1").set("dvi1","vvi1"),n=new Set;e=d(e);for(var i=e.next();!i.done;i=e.next())i=i.value,i.video&&n.add(i.video);for(n=d(n),e=n.next();!e.done;e=n.next()){e=e.value,i=d(t);for(var r=i.next();!r.done;r=i.next()){var s=d(r.value);if(r=s.next().value,s=s.next().value,e.codecs.includes(r)){e.codecs=e.codecs.replace(r,s);break}}}}function Ur(e,t,n){if(!e.decodingInfos.some((function(e){return!(!e.supported||t&&(e=e.keySystemAccess)&&(n[e.keySystem]||e.keySystem)!=t)})))return!1;var i=et(),r=vt("Firefox")&&pt(),s=e.video,a=s&&s.width||0,o=s&&s.height||0;return!(i&&s&&(1920<a||1080<o)&&(s.codecs.includes("avc1.")||s.codecs.includes("avc3."))||(i=s&&s.dependencyStream)&&!en(i))&&(e=e.audio,!(r&&e&&e.encrypted&&e.codecs.toLowerCase().includes("opus")||e&&e.dependencyStream))}function Fr(e,t){var n,i,r,s,a,o,u;return U((function(l){if(1==l.g){for(n=function(e,t){if(e){var n=Rn(e);return n.supported=e.supported&&t.supported,n.powerEfficient=e.powerEfficient&&t.powerEfficient,n.smooth=e.smooth&&t.smooth,t.keySystemAccess&&!n.keySystemAccess&&(n.keySystemAccess=t.keySystemAccess),n}return t},i=null,r=[],s=d(t),a=s.next(),o={};!a.done;o={cache:void 0,Sd:void 0},a=s.next())u=a.value,o.Sd=Cn(u),o.cache=as,o.cache.has(o.Sd)?i=n(i,o.cache.get(o.Sd)):r.push(Br(u).then(function(e){return function(t){var r=null;t=d(t||[]);for(var s=t.next();!s.done;s=t.next())r=n(r,s.value);r&&(e.cache.set(e.Sd,r),i=n(i,r))}}(o)));return w(l,Promise.all(r),2)}i&&e.decodingInfos.push(i),A(l)}))}function Br(e){var t=[""];e.video&&(t=er(e.video.contentType).split(","));var n=[""];e.audio&&(n=er(e.audio.contentType).split(","));var i=[];t=d(t);for(var r=t.next();!r.done;r=t.next()){r=r.value;for(var s=d(n),a=s.next(),o={};!a.done;o={pc:void 0},a=s.next())a=a.value,o.pc=Ln(e),e.video&&(o.pc.video.contentType=Wi(Zi(o.pc.video.contentType),r)),e.audio&&(o.pc.audio.contentType=Wi(Zi(o.pc.audio.contentType),a)),i.push(new Promise(function(e){return function(t,n){(pt()?yr(5,navigator.mediaCapabilities.decodingInfo(e.pc)):navigator.mediaCapabilities.decodingInfo(e.pc)).then((function(e){t(e)})).catch(n)}}(o)))}return Promise.all(i).catch((function(){return JSON.stringify(e),null}))}function jr(e,t,n,i){var r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E;return U((function(A){switch(A.g){case 1:if(e.some((function(e){return e.decodingInfos.length})))return A.return();r=d(i),s=r.next(),a={};case 2:if(s.done){A.s(4);break}a.lh=s.value,o=!1,u=d(e),l=u.next();case 5:if(l.done){A.s(7);break}c=l.value,h=$r(c,t,n).filter(function(e){return function(t){return t=t[0],(t.keySystemConfiguration&&t.keySystemConfiguration.keySystem)===e.lh}}(a)),f=d(h),p=f.next();case 8:if(p.done){A.s(10);break}return g=p.value,w(A,Fr(c,g),9);case 9:p=f.next(),A.s(8);break;case 10:c.decodingInfos.length&&(o=!0),l=u.next(),A.s(5);break;case 7:if(o)return A.return();a={lh:void 0},s=r.next(),A.s(2);break;case 4:m=d(e),v=m.next();case 12:if(v.done){A.s(0);break}y=v.value,b=$r(y,t,n).filter((function(e){return e=e[0],e=e.keySystemConfiguration&&e.keySystemConfiguration.keySystem,!e||!i.includes(e)})),T=d(b),S=T.next();case 15:if(S.done){v=m.next(),A.s(12);break}return E=S.value,w(A,Fr(y,E),16);case 16:S=T.next(),A.s(15)}}))}function $r(e,t,n){var i=e.audio,r=e.video,s=[],a=[];if(r)for(var o=d(r.fullMimeTypes),u=o.next();!u.done;u=o.next()){u=u.value;var l=er(u);if(l.includes(",")&&!i){var c=l.split(","),h=Zi(u);l=Ht("video",c),c=Ht("audio",c),c=Gr(c,h),h=Yi(h,c,"audio"),a.push({contentType:h,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1})}if(l=Vr(l),u={contentType:Yi(Zi(u),l,"video"),width:r.width||64,height:r.height||64,bitrate:r.bandwidth||e.bandwidth||1,framerate:r.frameRate||1},r.hdr)switch(r.hdr){case"SDR":u.transferFunction="srgb";break;case"PQ":u.transferFunction="pq";break;case"HLG":u.transferFunction="hlg"}r.colorGamut&&(u.colorGamut=r.colorGamut),s.push(u)}if(i)for(o=d(i.fullMimeTypes),u=o.next();!u.done;u=o.next())l=u.value,u=Zi(l),l=Gr(er(l),u),u=Yi(u,l,"audio"),a.push({contentType:u,channels:i.channelsCount||2,bitrate:i.bandwidth||e.bandwidth||1,samplerate:i.audioSamplingRate||1,spatialRendering:i.spatialAudio});for(o=[],0==s.length&&s.push(null),0==a.length&&a.push(null),s=d(s),u=s.next();!u.done;u=s.next())for(u=u.value,l=d(a),h=l.next();!h.done;h=l.next())h=h.value,c={type:n?"file":"media-source"},u&&(c.video=u),h&&(c.audio=h),o.push(c);if(a=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]),!a.length)return[o];for(e=[],n=new Map,a=d(a),s=a.next();!s.done;s=a.next())s=s.value,n.get(s.keySystem)||n.set(s.keySystem,[]),n.get(s.keySystem).push(s);for(a=t?"required":"optional",t=t?["persistent-license"]:["temporary"],s=d(n.keys()),u=s.next();!u.done;u=s.next()){for(u=u.value,h=n.get(u),l=new Map,h=d(h),c=h.next();!c.done;c=h.next()){c=c.value;var f=c.videoRobustness+","+c.audioRobustness;l.get(f)||l.set(f,[]),l.get(f).push(c)}for(l=d(l.values()),h=l.next();!h.done;h=l.next()){h=h.value,c=[],f=d(o);for(var p=f.next();!p.done;p=f.next()){p=Object.assign({},p.value);for(var g={keySystem:u,initDataType:"cenc",persistentState:a,distinctiveIdentifier:"optional",sessionTypes:t},m=d(h),v=m.next();!v.done;v=m.next()){if(v=v.value,v.initData&&v.initData.length){for(var y=new Set,b=d(v.initData),T=b.next();!T.done;T=b.next())y.add(T.value.initDataType);g.initDataType=v.initData[0].initDataType}v.distinctiveIdentifierRequired&&(g.distinctiveIdentifier="required"),v.persistentStateRequired&&(g.persistentState="required"),v.sessionType&&(g.sessionTypes=[v.sessionType]),i&&(g.audio?(v.encryptionScheme&&(g.audio.encryptionScheme=g.audio.encryptionScheme||v.encryptionScheme),g.audio.robustness=g.audio.robustness||v.audioRobustness):(g.audio={robustness:v.audioRobustness},v.encryptionScheme&&(g.audio.encryptionScheme=v.encryptionScheme)),""==g.audio.robustness&&delete g.audio.robustness),r&&(g.video?(v.encryptionScheme&&(g.video.encryptionScheme=g.video.encryptionScheme||v.encryptionScheme),g.video.robustness=g.video.robustness||v.videoRobustness):(g.video={robustness:v.videoRobustness},v.encryptionScheme&&(g.video.encryptionScheme=v.encryptionScheme)),""==g.video.robustness&&delete g.video.robustness)}p.keySystemConfiguration=g,c.push(p)}e.push(c)}}return e}function Gr(e,t){return"flac"==e.toLowerCase()?ot()?"fLaC":"flac":"opus"===e.toLowerCase()?ot()&&"mp4"==zi(t)?"Opus":"opus":"ac-3"==e.toLowerCase()&&nt()?"ec-3":e}function Vr(e){if(e.includes("avc1")){var t=e.split(".");if(3==t.length)return e=t.shift()+".",e+=parseInt(t.shift(),10).toString(16),e+("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}else if("vp9"==e)return"vp09.00.41.08";return e}function Hr(e){e.textStreams=e.textStreams.filter((function(e){return e=Wi(e.mimeType,e.codecs),ur(e)}))}function Kr(e){var t,n,i,r,s,a,o;return U((function(u){switch(u.g){case 1:t=[],n=d(e.imageStreams),i=n.next();case 2:if(i.done){u.s(4);break}if(r=i.value,s=r.mimeType,"application/mp4"==s&&"mjpg"==r.codecs&&(s="image/jpg"),us.has(s)){u.s(5);break}if(a=ls.get(s),!a){us.set(s,!1),u.s(5);break}return w(u,Wr(a),7);case 7:o=u.h,us.set(s,o);case 5:us.get(s)&&t.push(r),i=n.next(),u.s(2);break;case 4:e.imageStreams=t,A(u)}}))}function Wr(e){return new Promise((function(t){var n=new Image;n.src=e,"decode"in n?n.decode().then((function(){t(!0)})).catch((function(){t(!1)})):n.onload=n.onerror=function(){t(2===n.height)}}))}function qr(e){var t=e.audio,n=e.video,i=t?t.mimeType:null,r=n?n.mimeType:null,s=t?t.codecs:null,a=n?n.codecs:null,o=t?t.groupId:null,u=[];n&&u.push(n.mimeType),t&&u.push(t.mimeType),u=u[0]||null;var l=[];t&&l.push(t.kind),n&&l.push(n.kind),l=l[0]||null;var c=new Set;if(t)for(var h=d(t.roles),f=h.next();!f.done;f=h.next())c.add(f.value);if(n)for(h=d(n.roles),f=h.next();!f.done;f=h.next())c.add(f.value);if(e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:l,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:u,audioMimeType:i,videoMimeType:r,codecs:"",audioCodec:s,videoCodec:a,primary:e.primary,roles:Array.from(c),audioRoles:null,forced:!1,videoId:null,audioId:null,audioGroupId:o,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null,e.hdr=n.hdr||null,e.colorGamut=n.colorGamut||null,e.videoLayout=n.videoLayout||null,(i=n.dependencyStream)&&(e.width=i.width||e.width,e.height=i.height||e.height,e.videoCodec=i.codecs||e.videoCodec),a.includes(","))){e.channelsCount=n.channelsCount,e.audioSamplingRate=n.audioSamplingRate,e.spatialAudio=n.spatialAudio,e.originalLanguage=n.originalLanguage,e.audioMimeType=r,n=a.split(",");try{e.videoCodec=Ht("video",n),e.audioCodec=Ht("audio",n)}catch(p){}}return t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.spatialAudio=t.spatialAudio,e.label=t.label,e.audioRoles=t.roles,e.accessibilityPurpose=t.accessibilityPurpose,e.originalLanguage=t.originalLanguage,t=t.dependencyStream)&&(e.audioCodec=t.codecs||e.audioCodec),t=[],e.videoCodec&&t.push(e.videoCodec),e.audioCodec&&t.push(e.audioCodec),e.codecs=t.join(", "),e}function Yr(e){return{id:e.id,active:!1,type:qt,bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,forced:e.forced,videoId:null,audioId:null,audioGroupId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId,originalImageId:null,accessibilityPurpose:e.accessibilityPurpose,originalLanguage:e.originalLanguage}}function Xr(e){var t=e.width||null,n=e.height||null,i=null;e.segmentIndex&&(i=sc(e.segmentIndex));var r=e.tilesLayout;return i&&(r=i.tilesLayout||r),r&&null!=t&&(t/=Number(r.split("x")[0])),r&&null!=n&&(n/=Number(r.split("x")[1])),{id:e.id,active:!1,type:"image",bandwidth:e.bandwidth||0,language:"",label:null,kind:null,width:t,height:n,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,forced:!1,videoId:null,audioId:null,audioGroupId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:r||null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:e.originalId,accessibilityPurpose:null,originalLanguage:null}}function zr(e){return e.__shaka_id||(e.__shaka_id=os++),e.__shaka_id}function Qr(e){var t=Jr(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind],t.label=e.label),t}function Jr(e){var t=e.language;return{id:zr(e),active:!1,type:"",bandwidth:0,language:wr(t||"und"),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,audioGroupId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:t}}function Zr(e){return e.allowedByApplication&&e.allowedByKeySystem&&0==e.disabledUntilTime}function es(e){return e.filter((function(e){return Zr(e)}))}function ts(e,t,n,i){var r=e,s=e.filter((function(e){return e.primary}));s.length&&(r=s);var a=r.length?r[0].language:"";if(r=r.filter((function(e){return e.language==a})),t){var o=kr(wr(t),e.map((function(e){return e.language})));o&&(r=e.filter((function(e){return wr(e.language)==o})))}if(r=r.filter((function(e){return e.forced==i})),n){if(e=ns(r,n),e.length)return e}else if(e=r.filter((function(e){return 0==e.roles.length})),e.length)return e;return e=r.map((function(e){return e.roles})).reduce(gr,[]),e.length?ns(r,e[0]):r}function ns(e,t){return e.filter((function(e){return e.roles.includes(t)}))}function is(e,t){t.length&&(t=t.filter((function(t){return Qi(e.codecs)==Qi(t.codecs)})).sort((function(e,t){return e.bandwidth&&t.bandwidth&&e.bandwidth!=t.bandwidth?e.bandwidth-t.bandwidth:(e.width||0)-(t.width||0)})),e.trickModeVideo=t[0],1<t.length&&(t=t.find((function(t){return e.width==t.width&&e.height==t.height}))))&&(e.trickModeVideo=t)}function rs(e){return"audio"==e.type?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:"video"==e.type?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}function ss(e,t,n){if(0==n.autoShowText)return!1;if(1==n.autoShowText)return!0;var i=wr(n.preferredTextLanguage);return t=wr(t.language),2==n.autoShowText?Tr(t,i):3==n.autoShowText?!!e&&(e=wr(e.language),Tr(t,i)&&!Tr(e,t)):(Z("Invalid autoShowText setting!"),!1)}K("shaka.util.StreamUtils",Rr),Rr.meetsRestrictions=Pr;var as=new Map,os=0,us=(new Map).set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),ls=(new Map).set("image/webp","data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA").set("image/avif","data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=");function cs(){var t=this;this.G=null,this.o=!1,this.m=new z,this.j=new ae,navigator.connection&&navigator.connection.addEventListener&&this.j.D(navigator.connection,"change",(function(){if(t.o&&t.g.useNetworkInformation){t.m=new z,t.g&&t.m.configure(t.g.advanced);var e=t.chooseVariant();e&&navigator.onLine&&t.G(e,t.g.clearBufferSwitch,t.g.safeMarginSwitch)}})),this.F=[],this.H=1,this.I=!1,this.h=this.l=this.g=this.u=null,this.A=new ze((function(){if(t.o&&(t.g.restrictToElementSize||t.g.restrictToScreenSize)){var e=t.chooseVariant();e&&t.G(e,t.g.clearBufferSwitch,t.g.safeMarginSwitch)}})),this.B=e,"documentPictureInPicture"in e&&this.j.D(e.documentPictureInPicture,"enter",(function(){t.B=e.documentPictureInPicture.window,t.A&&t.A.qb(),t.j.qa(t.B,"pagehide",(function(){t.B=e,t.A&&t.A.qb()}))})),this.C=this.i=null}function ds(e){if(!e.I){var t=e.m;if(!(t.g>=t.i))return;e.I=!0,e.u-=1e3*(e.g.switchInterval-e.g.minTimeToSwitch)}Date.now()-e.u<1e3*e.g.switchInterval||(t=e.chooseVariant(),e.getBandwidthEstimate(),t&&e.G(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch))}function hs(e,t,n,i,r){if(e.C){var s=e.C.Tg();s&&(n=n.filter((function(e){return!e.bandwidth||!s||e.bandwidth<=s})))}return t&&(n=n.filter((function(e){return Pr(e,t,{width:r,height:i})}))),n.sort((function(e,t){return e.bandwidth-t.bandwidth}))}function fs(e){var t=[];e=d(e);for(var n=e.next();!n.done;n=e.next())(n=n.value.video)&&n.height&&n.width&&t.push({height:n.height,width:n.width});return t.sort((function(e,t){return e.width-t.width}))}i=cs.prototype,i.stop=function(){this.G=null,this.o=!1,this.F=[],this.H=1,this.l=this.u=null,this.h&&(this.h.disconnect(),this.h=null),this.A.stop(),this.C=this.i=null},i.release=function(){this.j.release(),this.A=null},i.init=function(e){this.G=e},i.chooseVariant=function(){var e=1/0,t=1/0;if(this.g.restrictToScreenSize){var n=this.g.ignoreDevicePixelRatio?1:this.B.devicePixelRatio;e=this.B.screen.height*n,t=this.B.screen.width*n}if(this.h&&this.g.restrictToElementSize){n=this.g.ignoreDevicePixelRatio?1:this.B.devicePixelRatio;var i=this.l.clientHeight,r=this.l.clientWidth;this.i&&document.pictureInPictureElement&&document.pictureInPictureElement==this.l&&(i=this.i.height,r=this.i.width),e=Math.min(e,i*n),t=Math.min(t,r*n)}if(n=this.F.filter((function(e){return e&&!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)})),n.length||(n=this.F),i=n,n.length!=this.F.length&&(i=this.F.filter((function(e){return e&&!!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)}))),n=hs(this,this.g.restrictions,i,1/0,1/0),1/0!=e||1/0!=t){for(n=fs(n),n=d(n),r=n.next();!r.done;r=n.next())if(r=r.value,r.height>=e&&r.width>=t){e=r.height,t=r.width;break}n=hs(this,this.g.restrictions,i,e,t)}for(e=this.getBandwidthEstimate(),i.length&&!n.length&&(n=hs(this,null,i,1/0,1/0),n=[n[0]]),t=n[0]||null,i=0;i<n.length;i++){r=n[i];for(var s=isNaN(this.H)?1:Math.abs(this.H),a=s*r.bandwidth/this.g.bandwidthDowngradeTarget,o={bandwidth:1/0},u=i+1;u<n.length;u++)if(r.bandwidth!=n[u].bandwidth){o=n[u];break}s=s*o.bandwidth/this.g.bandwidthUpgradeTarget,e>=a&&e<=s&&(t.bandwidth!=r.bandwidth||t.bandwidth==r.bandwidth&&t.video&&r.video&&(t.video.width<r.video.width||t.video.height<r.video.height))&&(t=r)}return this.u=Date.now(),t},i.enable=function(){this.o=!0},i.disable=function(){this.o=!1},i.segmentDownloaded=function(e,t,n){e<this.g.cacheLoadThreshold||(this.m.sample(e,t),n&&null!=this.u&&this.o&&ds(this))},i.trySuggestStreams=function(){null!=this.u&&this.o&&ds(this)},i.getBandwidthEstimate=function(){var e=this.g.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&(e=1e6*navigator.connection.downlink),navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&this.g.preferNetworkInformationBandwidth?e:(e=this.m.getBandwidthEstimate(e),this.C?this.C.getBandwidthEstimate(e):e)},i.setVariants=function(e){this.F=e},i.playbackRateChanged=function(e){this.H=e},i.setMediaElement=function(t){function n(){i.A.da(ps)}var i=this;this.l=t,this.h&&(this.h.disconnect(),this.h=null),this.l&&"ResizeObserver"in e&&(this.h=new ResizeObserver(n),this.h.observe(this.l)),this.j.D(t,"enterpictureinpicture",(function(e){e.pictureInPictureWindow&&(i.i=e.pictureInPictureWindow,i.j.D(i.i,"resize",n))})),this.j.D(t,"leavepictureinpicture",(function(){i.i&&i.j.Ia(i.i,"resize",n),i.i=null}))},i.setCmsdManager=function(e){this.C=e},i.configure=function(e){this.g=e,this.m&&this.g&&this.m.configure(this.g.advanced)},K("shaka.abr.SimpleAbrManager",cs),cs.prototype.configure=cs.prototype.configure,cs.prototype.setCmsdManager=cs.prototype.setCmsdManager,cs.prototype.setMediaElement=cs.prototype.setMediaElement,cs.prototype.playbackRateChanged=cs.prototype.playbackRateChanged,cs.prototype.setVariants=cs.prototype.setVariants,cs.prototype.getBandwidthEstimate=cs.prototype.getBandwidthEstimate,cs.prototype.trySuggestStreams=cs.prototype.trySuggestStreams,cs.prototype.segmentDownloaded=cs.prototype.segmentDownloaded,cs.prototype.disable=cs.prototype.disable,cs.prototype.enable=cs.prototype.enable,cs.prototype.chooseVariant=cs.prototype.chooseVariant,cs.prototype.init=cs.prototype.init,cs.prototype.release=cs.prototype.release,cs.prototype.stop=cs.prototype.stop;var ps=1;function gs(e,t){var n=vs();this.l=null==e.maxAttempts?n.maxAttempts:e.maxAttempts,this.j=null==e.baseDelay?n.baseDelay:e.baseDelay,this.o=null==e.fuzzFactor?n.fuzzFactor:e.fuzzFactor,this.m=null==e.backoffFactor?n.backoffFactor:e.backoffFactor,this.g=0,this.h=this.j,(this.i=void 0!==t&&t)&&(this.g=1)}function ms(e){var t,n;return U((function(i){if(1==i.g){if(e.g>=e.l){if(!e.i)throw new je(2,7,1010);e.g=1,e.h=e.j}return t=e.g,e.g++,0==t?i.return():(n=e.h*(1+(2*Math.random()-1)*e.o),w(i,new Promise((function(e){new ze(e).da(n/1e3)})),2))}e.h*=e.m,A(i)}))}function vs(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}}function ys(){var e,t,n=new Promise((function(n,i){e=n,t=i}));return n.resolve=e,n.reject=t,n}function bs(e,t){this.promise=e,this.i=t,this.g=null}function Ts(e){return new bs(Promise.reject(e),(function(){return Promise.resolve()}))}function Ss(){var e=Promise.reject(new je(2,7,7001));return e.catch((function(){})),new bs(e,(function(){return Promise.resolve()}))}function Es(e){return new bs(Promise.resolve(e),(function(){return Promise.resolve()}))}function ws(e){return new bs(e,(function(){return e.catch((function(){}))}))}function As(e){return new bs(Promise.all(e.map((function(e){return e.promise}))),(function(){return Promise.all(e.map((function(e){return e.abort()})))}))}function xs(e,t,n){try{var i=e(t);return i&&i.promise&&i.abort?(n.resolve(i.promise),function(){return i.abort()}):(n.resolve(i),function(){return Promise.resolve(i).then((function(){}),(function(){}))})}catch(r){return n.reject(r),function(){return Promise.resolve()}}}function Is(t,n){if(n)if(n instanceof Map)for(var i=d(n.keys()),r=i.next();!r.done;r=i.next())r=r.value,Object.defineProperty(this,r,{value:n.get(r),writable:!0,enumerable:!0});else for(i in n)Object.defineProperty(this,i,{value:n[i],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function ks(e){var t,n=new Is(e.type);for(t in e)Object.defineProperty(n,t,{value:e[t],writable:!0,enumerable:!0});return n}K("shaka.config.CrossBoundaryStrategy",{KEEP:"keep",RESET:"reset",RESET_TO_ENCRYPTED:"reset_to_encrypted",RESET_ON_ENCRYPTION_CHANGE:"RESET_ON_ENCRYPTION_CHANGE"}),ys.prototype.resolve=function(){},ys.prototype.reject=function(){},bs.prototype.abort=function(){return this.g||(this.g=this.i()),this.g},bs.prototype.finally=function(e){return this.promise.then((function(){return e(!0)}),(function(){return e(!1)})),this},bs.prototype.Ga=function(e,t){function n(n){return function(o){if(r.g&&n)s.reject(a);else{var u=n?e:t;u?i=xs(u,o,s):(n?s.resolve:s.reject)(o)}}}function i(){return s.reject(a),r.abort()}var r=this,s=new ys;s.catch((function(){}));var a=new je(2,7,7001);return this.promise.then(n(!0),n(!1)),new bs(s,(function(){return i()}))},u.Object.defineProperties(bs.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return null!==this.g}}}),K("shaka.util.AbortableOperation",bs),bs.prototype.chain=bs.prototype.Ga,bs.prototype["finally"]=bs.prototype.finally,bs.all=As,bs.prototype.abort=bs.prototype.abort,bs.notAbortable=ws,bs.completed=Es,bs.aborted=Ss,bs.failed=Ts,Is.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Is.prototype.stopImmediatePropagation=function(){this.g=!0},Is.prototype.stopPropagation=function(){},K("shaka.util.FakeEvent",Is);var Ls={Oj:"abrstatuschanged",Pj:"adaptation",Qj:"audiotrackchanged",Rj:"audiotrackschanged",Sj:"boundarycrossed",Tj:"buffering",Uj:"complete",Vj:"downloadcompleted",Wj:"downloadfailed",Xj:"downloadheadersreceived",Yj:"drmsessionupdate",$j:"emsg",uk:"prft",Error:"error",ak:"expirationupdated",bk:"firstquartile",ck:"gapjumped",fk:"keystatuschanged",jk:"loaded",kk:"loading",mk:"manifestparsed",nk:"manifestupdated",pk:"mediaqualitychanged",qk:"mediasourcerecovered",Metadata:"metadata",rk:"midpoint",sk:"nospatialvideoinfo",tk:"onstatechange",vk:"ratechange",xk:"segmentappended",yk:"sessiondata",zk:"spatialvideoinfo",Ak:"stalldetected",Bk:"started",Ck:"statechanged",Dk:"streaming",Ek:"textchanged",Fk:"texttrackvisibility",Gk:"thirdquartile",Hk:"timelineregionadded",Ik:"timelineregionenter",Jk:"timelineregionexit",Kk:"trackschanged",Mk:"unloading",Ok:"variantchanged"};function Rs(){this.Da=new se,this.Re=this}function Cs(){this.g=[]}function Ds(e,t){e.g.push(t.finally((function(){yn(e.g,t)})))}function Ms(e,t,n,i,r,s,a){Rs.call(this),this.i=!1,this.u=new Cs,this.g=new Set,this.h=new Set,this.m=e||null,this.l=t||null,this.C=n||null,this.F=i||null,this.G=r||null,this.I=s||null,this.H=a||null,this.A=this.B=!1,this.o=16e3,this.j=new Map}function Ps(e,t,n,i){i=void 0!==i&&i,n=n||Vs;var r=Hs.get(e);(!r||n>=r.priority)&&Hs.set(e,{priority:n,ue:t,ij:i})}function _s(e,t){for(var n=d(e.g),i=n.next();!i.done;i=n.next())t.g.add(i.value);for(e=d(e.h),n=e.next();!n.done;n=e.next())t.h.add(n.value)}function Os(e,t,n){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:void 0===n?null:n}}function Ns(e,t,n,i){function r(e){s=s.Ga((function(){return n.body&&(n.body=Oe(n.body)),e(t,n,i)}))}var s=Es(void 0);e.G&&r(e.G),e=d(e.g);for(var a=e.next();!a.done;a=e.next())r(a.value);return s.Ga(void 0,(function(e){if(e instanceof je&&7001==e.code)throw e;throw new je(2,1,1006,e)}))}function Us(e,t,n,i,r,s,a,o){e.B&&(n.uris[s]=n.uris[s].replace("https://","http://")),e.A&&(n.uris[s]=n.uris[s].replace("http://","https://")),0<s&&e.I&&e.I(t,i,n.uris[s],n.uris[s-1]);var u=new ve(n.uris[s]),l=u.Ib,c=!1;l||(l=location.protocol,l=l.slice(0,-1),ye(u,l),n.uris[s]=u.toString()),l=l.toLowerCase();var d=(l=Hs.get(l))?l.ue:null;if(!d)return Ts(new je(2,1,1e3,u));var h=l.ij;(u=e.j.get(u.lb))&&(n.headers["common-access-token"]=u);var f,p=null,g=null,m=!1,v=!1;return ws(ms(r)).Ga((function(){if(e.i)return Ss();f=Date.now();var r=0;n.requestStartTime=Date.now();var a=d(n.uris[s],n,t,(function(s,a,u){p&&p.stop(),g&&g.da(l/1e3),e.m&&t==Gs&&(r++,n.packetNumber=r,e.m(s,a,Bs(i),n),c=!0,o.g=u)}),(function(i){v=!0,n.timeToFirstByte=Date.now()-n.requestStartTime,e.l&&e.l(i,n,t)}),{minBytesForProgressEvents:e.o});if(!h)return a;var u=n.retryParameters.connectionTimeout;u&&(p=new ze((function(){m=!0,a.abort()})),p.da(u/1e3));var l=n.retryParameters.stallTimeout;return l&&(g=new ze((function(){m=!0,a.abort()}))),a})).Ga((function(i){p&&p.stop(),g&&g.stop(),void 0==i.timeMs&&(i.timeMs=Date.now()-f);var r=i.headers["common-access-token"];if(r){var s=new ve(i.uri);e.j.set(s.lb,r)}return r={response:i,Oi:c},!v&&e.l&&e.l(i.headers,n,t),e.C&&e.C(n,i),r}),(function(u){if(p&&p.stop(),g&&g.stop(),e.F){var l=null,c=0;u instanceof je&&(l=u,1001==u.code&&(c=u.data[1])),e.F(n,l,c,m)}if(e.i)return Ss();if(m&&(u=new je(1,1,1003,n.uris[s],t)),u instanceof je){if(7001==u.code)throw u;if(1010==u.code)throw a;if(1==u.severity){if(l=(new Map).set("error",u),l=new Is("retry",l),l.cancelable=!0,e.dispatchEvent(l),l.defaultPrevented)throw u;return s=(s+1)%n.uris.length,Us(e,t,n,i,r,s,u,o)}}throw u}))}function Fs(e,t,n,i){var r=Es(void 0);e=d(e.h);for(var s=e.next(),a={};!s.done;a={oh:void 0},s=e.next())a.oh=s.value,r=r.Ga(function(e){return function(){var r=n.response;return r.data&&(r.data=Oe(r.data)),(0,e.oh)(t,r,i)}}(a));return r.Ga((function(){return n}),(function(e){var t=2;if(e instanceof je){if(7001==e.code)throw e;t=e.severity}throw new je(t,1,1007,e)}))}function Bs(e){if(e){var t=e.segment;if(e=e.stream,t&&e&&e.fastSwitching&&t.o)return!1}return!0}function js(){this.g=0}function $s(e,t,n){bs.call(this,e,t),this.h=n}Rs.prototype.addEventListener=function(e,t){this.Da&&this.Da.push(e,t)},Rs.prototype.removeEventListener=function(e,t){this.Da&&this.Da.remove(e,t)},Rs.prototype.dispatchEvent=function(e){if(!this.Da)return!0;var t=this.Da.get(e.type)||[],n=this.Da.get("All");for(n&&(t=t.concat(n)),t=d(t),n=t.next();!n.done;n=t.next()){n=n.value,e.target=this.Re,e.currentTarget=this.Re;try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(i){}if(e.g)break}return e.defaultPrevented},Rs.prototype.release=function(){this.Da=null},Cs.prototype.destroy=function(){for(var e=[],t=d(this.g),n=t.next();!n.done;n=t.next())n=n.value,n.promise.catch((function(){})),e.push(n.abort());return this.g=[],Promise.all(e)},b(Ms,Rs),i=Ms.prototype,i.kg=function(e){this.B=e},i.lg=function(e){this.A=e},i.lj=function(e){this.g.add(e)},i.Hj=function(e){this.g.delete(e)},i.Zh=function(){this.g.clear()},i.mj=function(e){this.h.add(e)},i.Ij=function(e){this.h.delete(e)},i.$h=function(){this.h.clear()},i.Hg=function(){this.j.clear()},i.destroy=function(){return this.i=!0,this.g.clear(),this.h.clear(),this.j.clear(),Rs.prototype.release.call(this),this.u.destroy()},i.request=function(e,t,n){var i=this,r=new js;if(this.i){var s=Promise.reject(new je(2,7,7001));return s.catch((function(){})),new $s(s,(function(){return Promise.resolve()}),r)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?Ln(t.retryParameters):vs(),t.uris=Ln(t.uris),s=Ns(this,e,t,n);var a=s.Ga((function(){return Us(i,e,t,n,new gs(t.retryParameters,!1),0,null,r)})),o=a.Ga((function(t){return Fs(i,e,t,n)})),u=Date.now(),l=0;s.promise.then((function(){l=Date.now()-u}),(function(){}));var c=0;a.promise.then((function(){c=Date.now()}),(function(){}));var d=o.Ga((function(r){var s=Date.now()-c,a=r.response;return a.timeMs+=l,a.timeMs+=s,r.Oi||!i.m||a.fromCache||"HEAD"==t.method||e!=Gs||i.m(a.timeMs,a.data.byteLength,Bs(n)),i.H&&i.H(e,a,n),a}),(function(e){throw e&&(e.severity=2),e}));return s=new $s(d.promise,(function(){return d.abort()}),r),Ds(this.u,s),s},K("shaka.net.NetworkingEngine",Ms),Ms.prototype.request=Ms.prototype.request,Ms.prototype.destroy=Ms.prototype.destroy,Ms.makeRequest=Os,Ms.defaultRetryParameters=function(){return vs()},Ms.prototype.clearCommonAccessTokenMap=Ms.prototype.Hg,Ms.prototype.clearAllResponseFilters=Ms.prototype.$h,Ms.prototype.unregisterResponseFilter=Ms.prototype.Ij,Ms.prototype.registerResponseFilter=Ms.prototype.mj,Ms.prototype.clearAllRequestFilters=Ms.prototype.Zh,Ms.prototype.unregisterRequestFilter=Ms.prototype.Hj,Ms.prototype.registerRequestFilter=Ms.prototype.lj,Ms.unregisterScheme=function(e){Hs.delete(e)},Ms.registerScheme=Ps,Ms.prototype.setForceHTTPS=Ms.prototype.lg,Ms.prototype.setForceHTTP=Ms.prototype.kg,Ms.NumBytesRemainingClass=js,b($s,bs),Ms.PendingRequest=$s;var Gs=1;Ms.RequestType={MANIFEST:0,SEGMENT:Gs,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6,ADS:7,CONTENT_STEERING:8},Ms.AdvancedRequestType={INIT_SEGMENT:0,MEDIA_SEGMENT:1,MEDIA_PLAYLIST:2,MASTER_PLAYLIST:3,MPD:4,MSS:5,MPD_PATCH:6,MEDIATAILOR_SESSION_INFO:7,MEDIATAILOR_TRACKING_INFO:8,MEDIATAILOR_STATIC_RESOURCE:9,MEDIATAILOR_TRACKING_EVENT:10,INTERSTITIAL_ASSET_LIST:11,INTERSTITIAL_AD_URL:12};var Vs=3;Ms.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:Vs};var Hs=new Map;function Ks(e){this.g=!1,this.h=new ys,this.i=e}function Ws(e,t){if(e.g){if(t instanceof je&&7003==t.code)throw t;throw new je(2,7,7003,t)}}function qs(e,t){var n=[];e=d(e);for(var i=e.next();!i.done;i=e.next())n.push(t(i.value));return n}function Ys(e,t){e=d(e);for(var n=e.next();!n.done;n=e.next())if(!t(n.value))return!1;return!0}function Xs(e){for(var t=new Map,n=d(Object.keys(e)),i=n.next();!i.done;i=n.next())i=i.value,t.set(i,e[i]);return t}function zs(e){var t={};return e.forEach((function(e,n){t[n]=e})),t}function Qs(e,t){this.h=Fe(e),this.i=t==Zs,this.g=0}function Js(){return new je(2,3,3e3)}Ks.prototype.destroy=function(){var e=this;return this.g?this.h:(this.g=!0,this.i().then((function(){e.h.resolve()}),(function(){e.h.resolve()})))},i=Qs.prototype,i.ta=function(){return this.g<this.h.byteLength},i.Aa=function(){return this.g},i.getLength=function(){return this.h.byteLength},i.X=function(){try{var e=this.h.getUint8(this.g);return this.g+=1,e}catch(t){throw Js()}},i.ma=function(){try{var e=this.h.getUint16(this.g,this.i);return this.g+=2,e}catch(t){throw Js()}},i.S=function(){try{var e=this.h.getUint32(this.g,this.i);return this.g+=4,e}catch(t){throw Js()}},i.$f=function(){try{var e=this.h.getInt32(this.g,this.i);return this.g+=4,e}catch(t){throw Js()}},i.Zc=function(){try{if(this.i)var e=this.h.getUint32(this.g,!0),t=this.h.getUint32(this.g+4,!0);else t=this.h.getUint32(this.g,!1),e=this.h.getUint32(this.g+4,!1)}catch(n){throw Js()}if(2097151<t)throw new je(2,3,3001);return this.g+=8,t*Math.pow(2,32)+e},i.Cb=function(e){if(this.g+e>this.h.byteLength)throw Js();var t=Ne(this.h,this.g,e);return this.g+=e,t},i.skip=function(e){if(this.g+e>this.h.byteLength)throw Js();this.g+=e},i.ph=function(e){if(this.g<e)throw Js();this.g-=e},i.seek=function(e){if(0>e||e>this.h.byteLength)throw Js();this.g=e},i.Ac=function(){for(var e=this.g;this.ta()&&0!=this.h.getUint8(this.g);)this.g+=1;return e=Ne(this.h,e,this.g-e),this.g+=1,It(e)},K("shaka.util.DataViewReader",Qs),Qs.prototype.readTerminatedString=Qs.prototype.Ac,Qs.prototype.seek=Qs.prototype.seek,Qs.prototype.rewind=Qs.prototype.ph,Qs.prototype.skip=Qs.prototype.skip,Qs.prototype.readBytes=Qs.prototype.Cb,Qs.prototype.readUint64=Qs.prototype.Zc,Qs.prototype.readInt32=Qs.prototype.$f,Qs.prototype.readUint32=Qs.prototype.S,Qs.prototype.readUint16=Qs.prototype.ma,Qs.prototype.readUint8=Qs.prototype.X,Qs.prototype.getLength=Qs.prototype.getLength,Qs.prototype.getPosition=Qs.prototype.Aa,Qs.prototype.hasMoreData=Qs.prototype.ta;var Zs=1;function ea(){this.i=new Map,this.h=new Map,this.g=!1}function ta(e){for(var t=ua(e);e.reader.ta()&&!e.parser.g;)e.parser.Wc(e.start+t,e.reader,e.partialOkay)}function na(e){for(var t=ua(e),n=e.reader.S(),i=0;i<n&&(e.parser.Wc(e.start+t,e.reader,e.partialOkay),!e.parser.g);i++);}function ia(e){var t=ua(e);for(e.reader.skip(78);e.reader.ta()&&!e.parser.g;)e.parser.Wc(e.start+t,e.reader,e.partialOkay)}function ra(e){var t=ua(e);e.reader.skip(8);var n=e.reader.ma();for(e.reader.skip(6),2==n?e.reader.skip(48):e.reader.skip(12),1==n&&e.reader.skip(16);e.reader.ta()&&!e.parser.g;)e.parser.Wc(e.start+t,e.reader,e.partialOkay)}function sa(e){return function(t){e(t.reader.Cb(t.reader.getLength()-t.reader.Aa()))}}function aa(e){var t=0;e=d(e);for(var n=e.next();!n.done;n=e.next())t=t<<8|n.value.charCodeAt(0);return t}function oa(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function ua(e){return 8+(e.has64BitSize?8:0)+(null!=e.flags?4:0)}Qs.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:Zs},i=ea.prototype,i.box=function(e,t){return e=aa(e),this.i.set(e,la),this.h.set(e,t),this},i.R=function(e,t){return e=aa(e),this.i.set(e,ca),this.h.set(e,t),this},i.stop=function(){this.g=!0},i.parse=function(e,t,n){for(e=new Qs(e,0),this.g=!1;e.ta()&&!this.g;)this.Wc(0,e,t,n)},i.Wc=function(e,t,n,i){var r=t.Aa();if(i&&r+8>t.getLength())this.g=!0;else{var s=t.S(),a=t.S(),o=oa(a),u=!1;switch(s){case 0:s=t.getLength()-r;break;case 1:if(i&&t.Aa()+8>t.getLength())return void(this.g=!0);s=t.Zc(),u=!0}var l=this.h.get(a);if(l){var c=null,d=null;if(this.i.get(a)==ca){if(i&&t.Aa()+4>t.getLength())return void(this.g=!0);d=t.S(),c=d>>>24,d&=16777215}a=r+s,n&&a>t.getLength()&&(a=t.getLength()),i&&a>t.getLength()?this.g=!0:(i=a-t.Aa(),t=0<i?t.Cb(i):new Uint8Array(0),t=new Qs(t,0),l({name:o,parser:this,partialOkay:n||!1,version:c,flags:d,reader:t,size:s,start:r+e,has64BitSize:u}))}else t.skip(Math.min(r+s-t.Aa(),t.getLength()-t.Aa()))}},K("shaka.util.Mp4Parser",ea),ea.headerSize=ua,ea.typeToString=oa,ea.allData=sa,ea.audioSampleEntry=ra,ea.visualSampleEntry=ia,ea.sampleDescription=na,ea.children=ta,ea.prototype.parseNext=ea.prototype.Wc,ea.prototype.parse=ea.prototype.parse,ea.prototype.stop=ea.prototype.stop,ea.prototype.fullBox=ea.prototype.R,ea.prototype.box=ea.prototype.box;var la=0,ca=1;function da(e){var t=this;this.g=[],this.h=[],this.data=[],(new ea).box("moov",ta).box("moof",ta).R("pssh",(function(e){if(!(1<e.version)){var n=Ne(e.reader.h,-12,e.size);if(t.data.push(n),t.g.push(Bt(e.reader.Cb(16))),0<e.version){n=e.reader.S();for(var i=0;i<n;i++){var r=Bt(e.reader.Cb(16));t.h.push(r)}}}})).parse(e)}function ha(e,t,n,i){var r=e.length,s=t.length+16+r;0<i&&(s+=4+16*n.size);var a=new Uint8Array(s),o=Fe(a),u=0;if(o.setUint32(u,s),u+=4,o.setUint32(u,1886614376),u+=4,1>i?o.setUint32(u,0):o.setUint32(u,16777216),u+=4,a.set(t,u),u+=t.length,0<i)for(o.setUint32(u,n.size),u+=4,t=d(n),n=t.next();!n.done;n=t.next())n=Ft(n.value),a.set(n,u),u+=n.length;return o.setUint32(u,r),a.set(e,u+4),a}function fa(e){var t=this;this.C=e,this.j=this.A=null,this.ka=this.ea=!1,this.H=0,this.h=null,this.o=new ae,this.i=new Map,this.T=[],this.B=new Map,this.K=!1,this.m=new ys,this.g=null,this.u=function(n){2==n.severity&&t.m.reject(n),e.onError(n)},this.Z=new Map,this.fa=new Map,this.L=new ze((function(){return Na(t)})),this.O=!1,this.M=[],this.W=!1,this.I=new ze((function(){$a(t)})),this.m.catch((function(){})),this.l=new Ks((function(){return pa(t)})),this.$=!1,this.F=this.G=null,this.P=function(){return!1}}function pa(e){return U((function(t){switch(t.g){case 1:return e.o.release(),e.o=null,e.m.reject(),e.I.stop(),e.I=null,e.L.stop(),e.L=null,w(t,Ba(e),2);case 2:if(!e.j){t.s(3);break}return x(t,4),w(t,e.j.setMediaKeys(null),6);case 6:k(t,5);break;case 4:L(t);case 5:e.j=null;case 3:e.h=null,e.A=null,e.B=new Map,e.g=null,e.u=function(){},e.C=null,e.$=!1,e.G=null,A(t)}}))}function ga(e,t,n){return e.ka=!0,e.B=new Map,e.O=n,ya(e,t,!1)}function ma(e,t,n,i){i=void 0===i||i,e.B=new Map,n=d(n);for(var r=n.next();!r.done;r=n.next())e.B.set(r.value,{initData:null,initDataType:null});for(n=d(e.g.persistentSessionsMetadata),r=n.next();!r.done;r=n.next())r=r.value,e.B.set(r.sessionId,{initData:r.initData,initDataType:r.initDataType});return e.O=0<e.B.size,ya(e,t,i)}function va(e,t,n,i,r,s){var a=new Map;return r={audioCapabilities:r,videoCapabilities:s,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t},r.drmInfos=[{keySystem:t,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:i,serverCertificateUri:"",initData:null,keyIds:null}],a.set(t,r),Ia(e,a,[])}function ya(e,t,n){var i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,A;return U((function(x){if(1==x.g){for(qa(e.g.clearKeys,t),i=t.some((function(e){return!!(e.video&&e.video.drmInfos.length||e.audio&&e.audio.drmInfos.length)})),!i&&n&&(r=Xs(e.g.servers),Ha(t,r)),s=new Set,a=d(t),o=a.next();!o.done;o=a.next())for(u=o.value,l=ja(u),c=d(l),h=c.next();!h.done;h=c.next())f=h.value,s.add(f);for(p=d(s),g=p.next();!g.done;g=p.next())m=g.value,Wa(m,Xs(e.g.servers),Xs(e.g.advanced||{}),e.g.keySystemsMapping);for(v=function(t,n){var i=[];t=d(t);for(var r=t.next();!r.done;r=t.next()){r=r.value;var s,a=r[n]||e.g.advanced&&e.g.advanced[r.keySystem]&&e.g.advanced[r.keySystem][n]||"";if((s=""==a)&&(s=!!(s=r.keySystem)&&!!s.match(/^com\.widevine\.alpha/)),s&&("audioRobustness"==n?a=[e.g.defaultAudioRobustnessForWidevine]:"videoRobustness"==n&&(a=[e.g.defaultVideoRobustnessForWidevine])),"string"===typeof a)i.push(r);else if(Array.isArray(a))for(0===a.length&&(a=[""]),a=d(a),s=a.next();!s.done;s=a.next()){var o={};i.push(Object.assign({},r,(o[n]=s.value,o)))}}return i},y=new Set,b=d(t),T=b.next();!T.done;T=b.next())S=T.value,S.video&&!y.has(S.video)&&(S.video.drmInfos=v(S.video.drmInfos,"videoRobustness"),S.video.drmInfos=v(S.video.drmInfos,"audioRobustness"),y.add(S.video)),S.audio&&!y.has(S.audio)&&(S.audio.drmInfos=v(S.audio.drmInfos,"videoRobustness"),S.audio.drmInfos=v(S.audio.drmInfos,"audioRobustness"),y.add(S.audio));return y.clear(),w(x,jr(t,e.O,e.$,e.g.preferredKeySystems),2)}return Ws(e.l),E=i||Object.keys(e.g.servers).length,E?(A=Ia(e,void 0,t),x.return(i?A:A.catch((function(){})))):(e.ea=!0,x.return(Promise.resolve()))}))}function ba(e){var t;return U((function(n){switch(n.g){case 1:if(e.j.mediaKeys)return n.return();if(!e.G){n.s(2);break}return w(n,e.G,3);case 3:return Ws(e.l),n.return();case 2:return x(n,4),e.G=e.j.setMediaKeys(e.A),w(n,e.G,6);case 6:k(n,5);break;case 4:t=L(n),e.u(new je(2,6,6003,t.message));case 5:Ws(e.l),A(n)}}))}function Ta(e,t){return U((function(n){if(1==n.g)return w(n,ba(e),2);Aa(e,t.initDataType,Ne(t.initData)),A(n)}))}function Sa(e){var t,n,i,r,s;return U((function(a){switch(a.g){case 1:if(!e.A||!e.h)return a.return();if(!e.h.serverCertificateUri||e.h.serverCertificate&&e.h.serverCertificate.length){a.s(2);break}return t=Os([e.h.serverCertificateUri],e.g.retryParameters),x(a,3),n=e.C.Vb.request(5,t,{isPreload:e.P()}),w(a,n.promise,5);case 5:i=a.h,e.h.serverCertificate=Ne(i.data),k(a,4);break;case 3:throw r=L(a),new je(2,6,6017,r);case 4:if(e.l.g)return a.return();case 2:return e.h.serverCertificate&&e.h.serverCertificate.length?(x(a,6),w(a,e.A.setServerCertificate(e.h.serverCertificate),8)):a.return();case 8:k(a,0);break;case 6:throw s=L(a),new je(2,6,6004,s.message)}}))}function Ea(e,t){var n,i,r;return U((function(s){return 1==s.g?w(s,Da(e,t,{initData:null,initDataType:null}),2):3!=s.g?(n=s.h,n?(i=[],(r=e.i.get(n))&&(r.rb=new ys,i.push(r.rb)),i.push(n.remove()),w(s,Promise.all(i),3)):s.return()):(e.i.delete(n),void A(s))}))}function wa(e){var t,n,i,r,s;return U((function(a){if(1==a.g)return e.B.size?(e.B.forEach((function(t,n){Da(e,n,t)})),w(a,e.m,3)):a.s(2);if(2!=a.g){if(t=e.h&&e.h.keyIds||new Set([]),0<t.size&&Va(e))return a.return(e.m);e.K=!1,e.m=new ys,e.m.catch((function(){}))}for(n=(e.h?e.h.initData:[])||[],i=d(n),r=i.next();!r.done;r=i.next())s=r.value,Aa(e,s.initDataType,s.initData);return Ga(e)&&e.m.resolve(),a.return(e.m)}))}function Aa(e,t,n){if(n.length){if(e.g.ignoreDuplicateInitData){var i=e.i.values();i=d(i);for(var r=i.next();!r.done;r=i.next())if(_e(n,r.value.initData))return;var s=!1;if(e.B.forEach((function(e){!s&&_e(n,e.initData)&&(s=!0)})),s)return}e.K=!0,0<e.i.size&&Ga(e)&&(e.m.resolve(),e.K=!1,e.m=new ys,e.m.catch((function(){}))),Ma(e,t,n,e.h.sessionType)}}function xa(e){return e=e.i.keys(),e=qs(e,(function(e){return e.sessionId})),Array.from(e)}function Ia(e,t,n){var i,r,s,a,o,u,l,c;return U((function(h){switch(h.g){case 1:if(i=new Map,n.length){r=ka(e,n,i),h.s(2);break}return w(h,La(e,t),3);case 3:r=h.h;case 2:if(s=r,!s){if(!navigator.requestMediaKeySystemAccess)throw new je(2,6,6020);throw new je(2,6,6001)}if(Ws(e.l),x(h,4),s.getConfiguration(),a=e.g.keySystemsMapping[s.keySystem]||s.keySystem,n.length){var f=a,p=i.get(a),g=[],m=[],v=[],y=[],b=[],T=new Set,S=new Set;Ka(p,g,m,y,v,b,T,S);var E=e.O?"persistent-license":"temporary";for(f={keySystem:f,encryptionScheme:g[0],licenseServerUri:m[0],distinctiveIdentifierRequired:p[0].distinctiveIdentifierRequired,persistentStateRequired:p[0].persistentStateRequired,sessionType:p[0].sessionType||E,audioRobustness:p[0].audioRobustness||"",videoRobustness:p[0].videoRobustness||"",serverCertificate:y[0],serverCertificateUri:v[0],initData:b,keyIds:T},0<S.size&&(f.keySystemUris=S),p=d(p),S=p.next();!S.done;S=p.next())S=S.value,S.distinctiveIdentifierRequired&&(f.distinctiveIdentifierRequired=S.distinctiveIdentifierRequired),S.persistentStateRequired&&(f.persistentStateRequired=S.persistentStateRequired);p=f}else p=a,S=t.get(a),f=[],g=[],m=[],v=[],y=[],b=new Set,Ka(S.drmInfos,f,g,v,m,y,b),p={keySystem:p,encryptionScheme:f[0],licenseServerUri:g[0],distinctiveIdentifierRequired:"required"==S.distinctiveIdentifier,persistentStateRequired:"required"==S.persistentState,sessionType:S.sessionTypes[0]||"temporary",audioRobustness:(S.audioCapabilities?S.audioCapabilities[0].robustness:"")||"",videoRobustness:(S.videoCapabilities?S.videoCapabilities[0].robustness:"")||"",serverCertificate:v[0],serverCertificateUri:m[0],initData:y,keyIds:b};if(e.h=p,!e.h.licenseServerUri)throw new je(2,6,6012,e.h.keySystem);return w(h,s.createMediaKeys(),6);case 6:if(o=h.h,Ws(e.l),e.A=o,""==e.g.minHdcpVersion||!("getStatusForPolicy"in e.A)){h.s(7);break}return x(h,8),w(h,e.A.getStatusForPolicy({minHdcpVersion:e.g.minHdcpVersion}),10);case 10:if(u=h.h,"usable"!=u)throw new je(2,6,6018);Ws(e.l),k(h,7,4);break;case 8:if(l=L(h,4),l instanceof je)throw l;throw new je(2,6,6019,l.message);case 7:return e.ea=!0,w(h,Sa(e),11);case 11:Ws(e.l),k(h,0);break;case 4:if(c=L(h),Ws(e.l,c),e.h=null,c instanceof je)throw c;throw new je(2,6,6002,c.message)}}))}function ka(e,t,n){for(var i=d(t),r=i.next();!r.done;r=i.next()){r=d(ja(r.value));for(var s=r.next();!s.done;s=r.next())s=s.value,n.has(s.keySystem)||n.set(s.keySystem,[]),n.get(s.keySystem).push(s)}if(1==n.size&&n.has(""))throw new je(2,6,6e3);i=e.g.preferredKeySystems,i.length||(r=Xs(e.g.servers),1==r.size&&(i=Array.from(r.keys()))),r=d(i);var a=r.next();for(s={};!a.done;s={mh:void 0},a=r.next()){s.mh=a.value,a=d(t);for(var o=a.next();!o.done;o=a.next())if(o=o.value.decodingInfos.find(function(e){return function(t){return t.supported&&null!=t.keySystemAccess&&t.keySystemAccess.keySystem==e.mh}}(s)))return o.keySystemAccess}for(r=d([!0,!1]),s=r.next();!s.done;s=r.next())for(s=s.value,a=d(t),o=a.next();!o.done;o=a.next()){o=d(o.value.decodingInfos);for(var u=o.next();!u.done;u=o.next())if(u=u.value,u.supported&&u.keySystemAccess){var l=u.keySystemAccess.keySystem;if(!i.includes(l)){var c=n.get(l);for(!c&&e.g.keySystemsMapping[l]&&(c=n.get(e.g.keySystemsMapping[l])),l=d(c),c=l.next();!c.done;c=l.next())if(!!c.value.licenseServerUri==s)return u.keySystemAccess}}}return null}function La(e,t){var n,i,r,s,a,o,u,l,c,h,f,p,g,m,v,y;return U((function(b){switch(b.g){case 1:if(1==t.size&&t.has(""))throw new je(2,6,6e3);for(i=d(t.values()),r=i.next();!r.done;r=i.next())s=r.value,0==s.audioCapabilities.length&&delete s.audioCapabilities,0==s.videoCapabilities.length&&delete s.videoCapabilities;a=d(e.g.preferredKeySystems),o=a.next();case 2:if(o.done){b.s(4);break}if(u=o.value,!t.has(u)){b.s(3);break}return l=t.get(u),x(b,6),w(b,navigator.requestMediaKeySystemAccess(u,[l]),8);case 8:return n=b.h,b.return(n);case 6:L(b);case 7:Ws(e.l);case 3:o=a.next(),b.s(2);break;case 4:c=d([!0,!1]),h=c.next();case 9:if(h.done){b.s(11);break}f=h.value,p=d(t.keys()),g=p.next();case 12:if(g.done){h=c.next(),b.s(9);break}if(m=g.value,v=t.get(m),y=v.drmInfos.some((function(e){return!!e.licenseServerUri})),y!=f){b.s(13);break}return x(b,15),w(b,navigator.requestMediaKeySystemAccess(m,[v]),17);case 17:return n=b.h,b.return(n);case 15:L(b);case 16:Ws(e.l);case 13:g=p.next(),b.s(12);break;case 11:return b.return(n)}}))}function Ra(e){Ga(e)&&e.m.resolve()}function Ca(e,t){new ze((function(){t.loaded=!0,Ra(e)})).da(Xa)}function Da(e,t,n){var i,r,s,a,o,u,l;return U((function(c){switch(c.g){case 1:try{i=e.A.createSession("persistent-license")}catch(d){return r=new je(2,6,6005,d.message),e.u(r),c.return(Promise.reject(r))}return e.o.D(i,"message",(function(t){e.j&&e.g.delayLicenseRequestUntilPlayed&&e.j.paused&&!e.W?e.M.push(t):_a(e,t)})),e.o.D(i,"keystatuseschange",(function(t){return Oa(e,t)})),s={initData:n.initData,initDataType:n.initDataType,loaded:!1,Vf:1/0,rb:null,type:"persistent-license"},e.i.set(i,s),x(c,2),w(c,i.load(t),4);case 4:return a=c.h,Ws(e.l),a||(e.i.delete(i),o=e.g.persistentSessionOnlinePlayback?1:2,e.u(new je(o,6,6013)),s.loaded=!0),Ca(e,s),Ra(e),c.return(i);case 2:u=L(c),Ws(e.l,u),e.i.delete(i),l=e.g.persistentSessionOnlinePlayback?1:2,e.u(new je(l,6,6005,u.message)),s.loaded=!0,Ra(e);case 3:return c.return(Promise.resolve())}}))}function Ma(e,t,n,i){try{var r=e.A.createSession(i)}catch(s){return void e.u(new je(2,6,6005,s.message))}e.o.D(r,"message",(function(t){e.j&&e.g.delayLicenseRequestUntilPlayed&&e.j.paused&&!e.W?e.M.push(t):_a(e,t)})),e.o.D(r,"keystatuseschange",(function(t){return Oa(e,t)})),e.i.set(r,{initData:n,initDataType:t,loaded:!1,Vf:1/0,rb:null,type:i});try{n=e.g.initDataTransform(n,t,e.h)}catch(s){return t=s,s instanceof je||(t=new je(2,6,6016,s)),void e.u(t)}e.g.logLicenseExchange&&Nt(n),r.generateRequest(t,n).catch((function(t){if(!e.l.g){e.i.delete(r);var n=t.errorCode;if(n&&n.systemCode){var i=n.systemCode;0>i&&(i+=Math.pow(2,32)),i="0x"+i.toString(16)}e.u(new je(2,6,6006,t.message,t,i))}}))}function Pa(e){return U((function(t){return 1==t.g?e.K?w(t,e.m,3):t.s(0):w(t,Promise.all(e.T.map((function(e){return e.promise}))),0)}))}function _a(e,t){var n,i,r,s,a,o,u,l,c,h,f,p,g,m;U((function(v){switch(v.g){case 1:if(n=t.target,e.g.logLicenseExchange&&Nt(t.message),i=e.i.get(n),r=e.h.licenseServerUri,s=e.g.advanced[e.h.keySystem],"individualization-request"==t.messageType&&s&&s.individualizationServer&&(r=s.individualizationServer),a=Os([r],e.g.retryParameters),a.body=t.message,a.method="POST",a.licenseRequestType=t.messageType,a.sessionId=n.sessionId,a.drmInfo=e.h,i&&(a.initData=i.initData,a.initDataType=i.initDataType),s&&s.headers)for(o in s.headers)a.headers[o]=s.headers[o];if("org.w3.clearkey"===e.h.keySystem){var y=a,b=e.h;try{var T=Lt(y.body);if(T){var S=JSON.parse(T);S.type||(S.type=b.sessionType,y.body=Rt(JSON.stringify(S)))}}catch(E){}}if(Ke(e.h.keySystem))if(y=kt(a.body,!0,!0),y.includes("PlayReadyKeyMessage")){for(y=Mn(y,"PlayReadyKeyMessage"),b=jn(y,"HttpHeader"),b=d(b),T=b.next();!T.done;T=b.next())S=T.value,T=jn(S,"name")[0],S=jn(S,"value")[0],a.headers[Fn(T)]=Fn(S);y=jn(y,"Challenge")[0],a.body=Ut(Fn(y))}else a.headers["Content-Type"]="text/xml; charset=utf-8";return u=Date.now(),x(v,2),c=e.C.Vb.request(2,a,{isPreload:e.P()}),e.T.push(c),w(v,c.promise,4);case 4:l=v.h,yn(e.T,c),k(v,3);break;case 2:return h=L(v),e.l.g?v.return():(f=new je(2,6,6007,h),1==e.i.size?(e.u(f),i&&i.rb&&i.rb.reject(f)):(i&&i.rb&&i.rb.reject(f),e.i.delete(n),Ga(e)&&(e.m.resolve(),e.L.da(.1))),v.return());case 3:return e.l.g?v.return():(e.H+=(Date.now()-u)/1e3,e.g.logLicenseExchange&&Nt(l.data),x(v,5),w(v,n.update(l.data),7));case 7:k(v,6);break;case 5:return p=L(v),g=new je(2,6,6008,p.message),e.u(g),i&&i.rb&&i.rb.reject(g),v.return();case 6:if(e.l.g)return v.return();m=new Is("drmsessionupdate"),e.C.onEvent(m),i&&(i.rb&&i.rb.resolve(),Ca(e,i)),A(v)}}))}function Oa(e,t){t=t.target;var n=e.i.get(t),i=!1;t.keyStatuses.forEach((function(t,r){if("string"==typeof r){var s=r;r=t,t=s}if(Ke(e.h.keySystem)&&16==r.byteLength&&(Ze()||lt()||vt("sony.hbbtv.tv.G5"))){s=Fe(r);var a=s.getUint32(0,!0),o=s.getUint16(4,!0),u=s.getUint16(6,!0);s.setUint32(0,a,!1),s.setUint16(4,o,!1),s.setUint16(6,u,!1)}"status-pending"!=t&&(n.loaded=!0),"expired"==t&&(i=!0),r=Bt(r).slice(0,32),e.Z.set(r,t)}));var r=t.expiration-Date.now();(0>r||i&&1e3>r)&&n&&!n.rb&&(e.i.delete(t),Fa(t)),Ga(e)&&(e.m.resolve(),e.L.da(za))}function Na(e){var t=e.Z,n=e.fa;n.clear(),t.forEach((function(e,t){return n.set(t,e)})),t=Array.from(n.values()),t.length&&t.every((function(e){return"expired"==e}))&&e.u(new je(2,6,6014)),e.C.re(zs(n))}function Ua(){var t,n,i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,I,R,C,D,M,P,_,O,N,F,B,j,$;return U((function(G){if(1==G.g){if(t="org.w3.clearkey com.widevine.alpha com.widevine.alpha.experiment com.microsoft.playready com.microsoft.playready.hardware com.microsoft.playready.recommendation com.microsoft.playready.recommendation.3000 com.microsoft.playready.recommendation.3000.clearlead com.chromecast.playready com.apple.fps.1_0 com.apple.fps com.huawei.wiseplay".split(" "),!(e.MediaKeys&&e.navigator&&e.navigator.requestMediaKeySystemAccess&&e.MediaKeySystemAccess&&e.MediaKeySystemAccess.prototype.getConfiguration)){for(n={},i=d(t),r=i.next();!r.done;r=i.next())s=r.value,n[s]=null;return G.return(n)}for(a="1.0 1.1 1.2 1.3 1.4 2.0 2.1 2.2 2.3".split(" "),o=["SW_SECURE_CRYPTO","SW_SECURE_DECODE","HW_SECURE_CRYPTO","HW_SECURE_DECODE","HW_SECURE_ALL"],u=["150","2000","3000"],l={"com.widevine.alpha":o,"com.widevine.alpha.experiment":o,"com.microsoft.playready.recommendation":u},c=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],h=[{contentType:'audio/mp4; codecs="mp4a.40.2"'},{contentType:'audio/webm; codecs="opus"'}],f={videoCapabilities:c,audioCapabilities:h,initDataTypes:["cenc","sinf","skd","keyids"]},p=[null,"cenc","cbcs","cbcs-1-9"],g=new Map,m=function(e,t){var n,i,r,s,o,u,l,c,h,f,p,m,v;return U((function(y){switch(y.g){case 1:return x(y,2),w(y,t.createMediaKeys(),5);case 5:n=y.h;case 4:k(y,3);break;case 2:return L(y),y.return();case 3:if(r=!!(i=t.getConfiguration().sessionTypes)&&i.includes("persistent-license"),nt()&&(r=!1),s=t.getConfiguration().videoCapabilities,o=t.getConfiguration().audioCapabilities,u={persistentState:r,encryptionSchemes:[],videoRobustnessLevels:[],audioRobustnessLevels:[],minHdcpVersions:[]},g.has(e)&&g.get(e)?u=g.get(e):g.set(e,u),(l=s[0].encryptionScheme)&&!u.encryptionSchemes.includes(l)&&u.encryptionSchemes.push(l),(c=s[0].robustness)&&!u.videoRobustnessLevels.includes(c)&&u.videoRobustnessLevels.push(c),(h=o[0].robustness)&&!u.audioRobustnessLevels.includes(h)&&u.audioRobustnessLevels.push(h),"getStatusForPolicy"in n){for(f=[],p=d(a),m=p.next(),v={};!m.done;v={rd:void 0},m=p.next())v.rd=m.value,u.minHdcpVersions.includes(v.rd)||f.push(n.getStatusForPolicy({minHdcpVersion:v.rd}).then(function(e){return function(t){"usable"!=t||u.minHdcpVersions.includes(e.rd)||u.minHdcpVersions.push(e.rd)}}(v)));return w(y,Promise.all(f),0)}y.s(0)}}))},v=function(e,t,n,i){var r,s,a,o,u,l,c,h,p,g;return U((function(v){switch(v.g){case 1:for(x(v,2),r=Ln(f),s=d(r.videoCapabilities),a=s.next();!a.done;a=s.next())o=a.value,o.encryptionScheme=t,o.robustness=n;for(u=d(r.audioCapabilities),l=u.next();!l.done;l=u.next())c=l.value,c.encryptionScheme=t,c.robustness=i;return h=Ln(r),h.persistentState="required",h.sessionTypes=["persistent-license"],p=[h,r],pt()?w(v,yr(5,navigator.requestMediaKeySystemAccess(e,p)),7):w(v,navigator.requestMediaKeySystemAccess(e,p),6);case 6:g=v.h,v.s(5);break;case 7:g=v.h;case 5:return w(v,m(e,g),8);case 8:k(v,0);break;case 2:L(v),A(v)}}))},y=function(e,t,n,i){var r,s,a;return U((function(o){switch(o.g){case 1:return x(o,2),r={type:"media-source",video:{contentType:c[0].contentType,width:640,height:480,bitrate:1,framerate:1},audio:{contentType:h[0].contentType,channels:2,bitrate:1,samplerate:1},keySystemConfiguration:{keySystem:e,video:{encryptionScheme:t,robustness:n},audio:{encryptionScheme:t,robustness:i}}},pt()?w(o,yr(5,navigator.mediaCapabilities.decodingInfo(r)),7):w(o,navigator.mediaCapabilities.decodingInfo(r),6);case 6:s=o.h,o.s(5);break;case 7:s=o.h;case 5:return a=s.keySystemAccess,w(o,m(e,a),8);case 8:k(o,0);break;case 2:L(o),A(o)}}))},b=d(t),T=b.next();!T.done;T=b.next())S=T.value,g.set(S,null);for(E=function(e){return"org.w3.clearkey"!==e||!ot()},I=[],R=d(p),C=R.next();!C.done;C=R.next())for(D=C.value,M=d(t),P=M.next();!P.done;P=M.next())_=P.value,E(_)&&(I.push(v(_,D,"","")),I.push(y(_,D,"","")));for(O=d(t),N=O.next();!N.done;N=O.next())for(F=N.value,B=d(l[F]||[]),j=B.next();!j.done;j=B.next())$=j.value,E(F)&&(I.push(v(F,null,$,"")),I.push(v(F,null,"",$)),I.push(y(F,null,$,"")),I.push(y(F,null,"",$)));return w(G,Promise.all(I),2)}return G.return(zs(g))}))}function Fa(e){return U((function(t){return 1==t.g?(x(t,2),w(t,yr(Ya,Promise.all([e.close().catch((function(){})),e.closed])),4)):2!=t.g?k(t,0):(L(t),void A(t))}))}function Ba(e){var t;return U((function(n){return t=Array.from(e.i.entries()),e.i.clear(),w(n,Promise.all(t.map((function(t){t=d(t);var n=t.next().value,i=t.next().value;return U((function(t){return 1==t.g?(x(t,2),e.ka||e.B.has(n.sessionId)||"persistent-license"!==i.type||e.g.persistentSessionOnlinePlayback?w(t,Fa(n),5):w(t,n.remove(),5)):2!=t.g?k(t,0):(L(t),void A(t))}))}))),0)}))}function ja(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])}function $a(e){e.i.forEach((function(t,n){var i=t.Vf,r=n.expiration;isNaN(r)&&(r=1/0),r!=i&&(e.C.onExpirationUpdated(n.sessionId,r),t.Vf=r)}))}function Ga(e){return e=e.i.values(),Ys(e,(function(e){return e.loaded}))}function Va(e){for(var t=d(e.h&&e.h.keyIds||new Set([])),n=t.next();!n.done;n=t.next())if("usable"!==e.Z.get(n.value))return!1;return!0}function Ha(e,t){var n=[];for(t.forEach((function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})})),e=d(e),t=e.next();!t.done;t=e.next())t=t.value,t.video&&(t.video.drmInfos=n),t.audio&&(t.audio.drmInfos=n)}function Ka(t,n,i,r,s,a,o,u){var l=[];t=d(t);for(var c=t.next(),f={};!c.done;f={wa:void 0},c=t.next()){if(f.wa=c.value,n.includes(f.wa.encryptionScheme)||n.push(f.wa.encryptionScheme),"org.w3.clearkey"==f.wa.keySystem&&f.wa.licenseServerUri.startsWith("data:application/json;base64,")?l.includes(f.wa.licenseServerUri)||l.push(f.wa.licenseServerUri):i.includes(f.wa.licenseServerUri)||i.push(f.wa.licenseServerUri),s.includes(f.wa.serverCertificateUri)||s.push(f.wa.serverCertificateUri),f.wa.serverCertificate&&(r.some(function(e){return function(t){return _e(t,e.wa.serverCertificate)}}(f))||r.push(f.wa.serverCertificate)),f.wa.initData){c=d(f.wa.initData);for(var p=c.next(),g={};!p.done;g={Mf:void 0},p=c.next())g.Mf=p.value,a.some(function(e){return function(t){var n=e.Mf;return!(!t.keyId||t.keyId!=n.keyId)||t.initDataType==n.initDataType&&_e(t.initData,n.initData)}}(g))||a.push(g.Mf)}if(f.wa.keyIds)for(c=d(f.wa.keyIds),p=c.next();!p.done;p=c.next())o.add(p.value);if(f.wa.keySystemUris&&u)for(f=d(f.wa.keySystemUris),c=f.next();!c.done;c=f.next())u.add(c.value)}if(1==l.length)i.push(l[0]);else if(0<l.length){for(n=[],l=d(l),r=l.next();!r.done;r=l.next())r=e.atob(r.value.split("data:application/json;base64,").pop()),r=JSON.parse(r),n.push.apply(n,h(r.keys));l=JSON.stringify({keys:n}),i.push("data:application/json;base64,"+e.btoa(l))}}function Wa(t,n,i,r){var s=t.keySystem;!s||"org.w3.clearkey"==s&&t.licenseServerUri||(n.size&&n.get(s)&&(n=n.get(s),t.licenseServerUri=n),t.keyIds||(t.keyIds=new Set),(i=i.get(s))&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=i.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=i.persistentStateRequired),t.serverCertificate||(t.serverCertificate=i.serverCertificate),i.sessionType&&(t.sessionType=i.sessionType),t.serverCertificateUri||(t.serverCertificateUri=i.serverCertificateUri)),r[s]&&(t.keySystem=r[s]),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==s&&(t.keySystem="com.chromecast.playready"))}function qa(e,t){if(e=Xs(e),0!=e.size){e=Vt(e),t=d(t);for(var n=t.next();!n.done;n=t.next())n=n.value,n.video&&(n.video.drmInfos=[e]),n.audio&&(n.audio.drmInfos=[e])}}i=fa.prototype,i.destroy=function(){return this.l.destroy()},i.configure=function(e,t){this.g=e,t&&(this.P=t),this.I&&this.I.ua(this.g.updateExpirationTime)},i.Jb=function(e){var t,n=this;return U((function(i){if(1==i.g)return n.j===e?i.return():n.A?(n.j=e,n.o.qa(n.j,"play",(function(){for(var e=d(n.M),t=e.next();!t.done;t=e.next())_a(n,t.value);n.W=!0,n.M=[]})),n.j.remote?(n.o.D(n.j.remote,"connect",(function(){return Ba(n)})),n.o.D(n.j.remote,"connecting",(function(){return Ba(n)})),n.o.D(n.j.remote,"disconnect",(function(){return Ba(n)}))):"webkitCurrentPlaybackTargetIsWireless"in n.j&&n.o.D(n.j,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return Ba(n)})),n.F=n.h&&n.h.initData.find((function(e){return 0<e.initData.length}))||null,t=n.h.keySystem,t.startsWith("com.microsoft.playready.recommendation")||"com.apple.fps"==t||!(n.F||n.B.size||n.g.parseInbandPsshEnabled)?(n.o.D(n.j,"encrypted",(function(e){return Ta(n,e)})),i.s(2)):w(i,ba(n),2)):(n.o.qa(e,"encrypted",(function(){n.u(new je(2,6,6010))})),i.return());wa(n).catch((function(){})),A(i)}))},i.Gf=function(){var e=this,t=this.i.keys();return t=qs(t,(function(t){var n=e.i.get(t);return{sessionId:t.sessionId,sessionType:n.type,initData:n.initData,initDataType:n.initDataType}})),Array.from(t)},i.nd=function(){var e=1/0,t=this.i.keys();t=d(t);for(var n=t.next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},i.$d=function(){return zs(this.fa)};var Ya=1,Xa=5,za=.5;function Qa(e,t,n){for(n=void 0===n||n,this.h=e,this.g=new Set([e]),t=t||[],e=d(t),t=e.next();!t.done;t=e.next())this.add(t.value,n)}function Ja(e,t){if(e.mimeType!=t.mimeType)return!1;if(e=e.codecs.split(",").map((function(e){return Ji(e)})),t=t.codecs.split(",").map((function(e){return Ji(e)})),e.length!=t.length)return!1;e.sort(),t.sort();for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function Za(e,t){if(e=new Set(e),t=new Set(t),e.delete("main"),t.delete("main"),e.size!=t.size)return!1;e=d(e);for(var n=e.next();!n.done;n=e.next())if(!t.has(n.value))return!1;return!0}function eo(){}function to(){this.g=io,this.i=(new Map).set(io,2).set(no,1),this.h=0}Qa.prototype.add=function(e,t){var n,i=this.h;if(t=void 0===t||t,!(n=!!i.audio!=!!e.audio||!!i.video!=!!e.video||i.language!=e.language)&&(n=i.audio&&e.audio)){n=i.audio;var r=e.audio;n=!(!((!n.channelsCount||!r.channelsCount||2<n.channelsCount||2<r.channelsCount)&&n.channelsCount!=r.channelsCount||n.spatialAudio!==r.spatialAudio||t&&!Ja(n,r))&&Za(n.roles,r.roles)&&n.groupId===r.groupId)}return!n&&(n=i.video&&e.video)&&(i=i.video,n=e.video,n=!((!t||Ja(i,n))&&Za(i.roles,n.roles))),!n&&(this.g.add(e),!0)},Qa.prototype.values=function(){return this.g.values()},K("shaka.media.AdaptationSet",Qa),K("shaka.config.CodecSwitchingStrategy",{RELOAD:"reload",SMOOTH:"smooth"}),eo.prototype.create=function(){},eo.prototype.configure=function(){},K("shaka.media.AdaptationSetCriteria",eo);var no=0,io=1;
/*
 @license
 Shaka Player
 Copyright 2023 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function ro(e,t,n){this.g=e,this.i=t,this.h=n}function so(e,t){return U((function(n){if(1==n.g)return w(n,_r(e.h,t,e.g.drm.preferredKeySystems,e.g.drm.keySystemsMapping),2);if(e.g.streaming.dontChooseCodecs||Cr(t,e.g.preferredVideoCodecs,e.g.preferredAudioCodecs,e.g.preferredDecodingAttributes,e.g.preferredTextFormats),!t.variants.some(Zr))throw new je(2,4,4032);return n.return(oo(e,t))}))}function ao(e,t){var n=e.g.restrictions;e=e.i;var i=!1;t=d(t.variants);for(var r=t.next();!r.done;r=t.next()){r=r.value;var s=r.allowedByApplication;r.allowedByApplication=Pr(r,n,e),s!=r.allowedByApplication&&(i=!0)}return i}function oo(e,t){var n=ao(e,t);if(t){var i=e.h?e.h.h:null;if(i&&e.h.A){for(var r=new Set,s=d(t.variants),a=s.next();!a.done;a=s.next())a=a.value,a.audio&&r.add(a.audio),a.video&&r.add(a.video);for(r=d(r),s=r.next();!s.done;s=r.next())uo(e,i.keySystem,s.value)}lo(e,t)}return n}function uo(e,t,n){n=d(n.drmInfos);for(var i=n.next();!i.done;i=n.next())if(i=i.value,i.keySystem==t){i=d(i.initData||[]);for(var r=i.next();!r.done;r=i.next())r=r.value,Aa(e.h,r.initDataType,r.initData)}}function lo(e,t){e=e.h?e.h.$d():{};var n=Object.keys(e);n=n.length&&"00"==n[0];var i=!1,r=!1,s=new Set,a=new Set,o=new Set;t=d(t.variants);for(var u=t.next();!u.done;u=t.next())u=u.value,u.audio&&o.add(u.audio),u.video&&o.add(u.video),u.allowedByApplication?u.allowedByKeySystem&&(i=!0):r=!0;for(o=d(o),t=o.next();!t.done;t=o.next())if(t=t.value,t.keyIds.size)for(t=d(t.keyIds),u=t.next();!u.done;u=t.next()){u=u.value;var l=e[n?"00":u];l?co.includes(l)&&a.add(l):s.add(u)}if(!i)throw e={hasAppRestrictions:r,missingKeys:Array.from(s),restrictedKeyStatuses:Array.from(a)},new je(2,4,4012,e)}var co=["output-restricted","internal-error"];function ho(){}function fo(e,t){mo.set(e,t)}function po(){var e={};if(Qe())for(var t=d(mo.keys()),n=t.next();!n.done;n=t.next())e[n.value]=!0;for(t=d(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]),n=t.next();!n.done;n=t.next())n=n.value,e[n]=Qe()?mo.has(n):Je(n);return e}function go(e,t){if(t){var n=mo.get(t.toLowerCase());if(n)return n}throw new je(2,4,4e3,e,t)}K("shaka.media.ManifestParser",ho),ho.unregisterParserByMime=function(e){mo.delete(e)},ho.registerParserByMime=fo,ho.registerParserByExtension=function(){he("ManifestParser.registerParserByExtension","Please use an ManifestParser with registerParserByMime function.")},ho.AccessibilityPurpose={Nk:"visually impaired",dk:"hard of hearing"};var mo=new Map;function vo(e,t){var n=null,i=null,r=null,s=null,a=e.S();return 1&t&&(r=e.Zc()),2&t&&(s=e.S()),8&t&&(n=e.S()),16&t&&(i=e.S()),{trackId:a,jd:n,kd:i,Vh:r,qh:s}}function yo(e,t){return 1==t?(t=e.S(),e=e.S(),{baseMediaDecodeTime:t*Math.pow(2,32)+e}):{baseMediaDecodeTime:e.S()}}function bo(e,t){return 1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),t=e.S(),e.skip(4),e=e.ma(),{timescale:t,language:String.fromCharCode(96+(e>>10))+String.fromCharCode(96+((960&e)>>5))+String.fromCharCode(96+(31&e))}}function To(e,t,n){var i=e.S(),r=[],s=null;1&n&&(s=e.$f()),4&n&&e.skip(4);for(var a=0;a<i;a++){var o={gg:null,sampleSize:null,ze:null};256&n&&(o.gg=e.S()),512&n&&(o.sampleSize=e.S()),1024&n&&e.skip(4),2048&n&&(o.ze=0==t?e.S():e.$f()),r.push(o)}return{Sk:i,fg:r,nf:s}}function So(e){e.skip(6),e.skip(2),e.skip(8);var t=e.ma();return e.skip(2),e.skip(2),e.skip(2),e=e.ma()+e.ma()/65536,{channelCount:t,sampleRate:e}}function Eo(e){return e=e.S(),{codec:oa(e)}}function wo(e){var t=null,n=null,i=e.Cb(4),r=String.fromCharCode(i[0]);if(r+=String.fromCharCode(i[1]),r+=String.fromCharCode(i[2]),r+=String.fromCharCode(i[3]),"nclx"===r){switch(e.ma()){case 1:case 5:case 6:case 7:t="srgb";break;case 9:t="rec2020";break;case 11:case 12:t="p3"}switch(i=e.ma(),e.ma(),i){case 1:case 6:case 13:case 14:case 15:n="SDR";break;case 16:n="PQ";break;case 18:n="HLG"}}return{colorGamut:t,Md:n}}function Ao(e,t){return t=void 0!==t&&t,e=e.toString(16).toUpperCase(),t?e:("0"+e).slice(-2)}function xo(e){return(10>e?"0":"")+e}function Io(e){if(!Fo){Fo=!0;var t=new Uint8Array([105,115,111,109]),n=new Uint8Array([97,118,99,49]),i=new Uint8Array([0,0,0,1]);zo=Uo("ftyp",t,i,t,n),t=Uo("dref",Qo),Jo=Uo("dinf",t)}this.g=e}function ko(e){for(var t=[],n=d(e.g),i=n.next();!i.done;i=n.next()){var r=t,s=r.push,a=i.value;i=Uo;var o=a.id+1,u=a.stream.width||0,l=a.stream.height||0;"audio"==a.type&&(l=u=0);var c=a.duration*a.timescale,f=Math.floor(c/(Bo+1));switch(c=Math.floor(c%(Bo+1)),o=new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(h(_o(o,4)),[0,0,0,0],h(_o(f,4)),h(_o(c,4)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0],h(_o(u,2)),[0,0],h(_o(l,2)),[0,0])),o=Uo("tkhd",o),u=Uo,f=a.duration*a.timescale,l=Math.floor(f/(Bo+1)),f=Math.floor(f%(Bo+1)),c=a.stream.language,c=c.charCodeAt(0)-96<<10|c.charCodeAt(1)-96<<5|c.charCodeAt(2)-96,l=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(h(_o(a.timescale,4)),h(_o(l,4)),h(_o(f,4)),h(_o(c,2)),[0,0])),l=Uo("mdhd",l),f=a,c=new Uint8Array([]),f.type){case"video":c=$o;break;case"audio":c=Go}f=Uo("hdlr",c);e:{switch(a.type){case"video":a=Uo("minf",Uo("vmhd",qo),Jo,Lo(a));break e;case"audio":a=Uo("minf",Uo("smhd",Yo),Jo,Lo(a));break e}a=new Uint8Array([])}a=u("mdia",l,f,a),i=i("trak",o,a),s.call(r,i)}for(t=jt.apply(_t,h(t)),s=e.g[0],n=Uo,i=s.duration*s.timescale,r=Math.floor(i/(Bo+1)),i=Math.floor(i%(Bo+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(h(_o(s.timescale,4)),h(_o(r,4)),h(_o(i,4)),[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255])),r=Uo("mvhd",r),i=[],e=d(e.g),u=e.next();!u.done;u=e.next())a=i,o=a.push,u=new Uint8Array([0,0,0,0].concat(h(_o(u.value.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),u=Uo("trex",u),o.call(a,u);if(e=jt.apply(_t,h(i)),e=Uo("mvex",e),i=[],s.encrypted){for(s=d(s.stream.drmInfos),a=s.next();!a.done;a=s.next())if(a=a.value,a.initData)for(a=d(a.initData),o=a.next();!o.done;o=a.next())i.push(o.value.initData);s=jt.apply(_t,h(i))}else s=new Uint8Array([]);return e=n("moov",r,t,e,s),t=new Uint8Array(zo.byteLength+e.byteLength),t.set(zo),t.set(e,zo.byteLength),t}function Lo(e){var t=Uo,n="aac";e.codecs.includes("mp3")?n="mp3":e.codecs.includes("ac-3")?n=nt()?"ec-3":"ac-3":e.codecs.includes("ec-3")?n="ec-3":e.codecs.includes("opus")&&(n="opus");var i=new Uint8Array([]);switch(e.type){case"video":if(e.codecs.includes("avc1")){if(n=e.stream.width||0,i=e.stream.height||0,0<e.Ba.byteLength)var r=Uo("avcC",e.Ba);else{r=Uo;for(var s=7,a=[],o=[],u=0,l=0,c=0,d=0;d<e.jb.length;d++){var f=Oo(e.jb[d]);switch(31&f[0]){case 7:a.push(f),s+=f.length+2;break;case 8:o.push(f),s+=f.length+2}}for(0<a.length&&(u=a[0][1],c=a[0][2],l=a[0][3]),s=new Uint8Array(s),d=0,s[d++]=1,s[d++]=u,s[d++]=c,s[d++]=l,s[d++]=255,s[d++]=224|a.length,u=0;u<a.length;u++)s[d++]=(65280&a[u].length)>>8,s[d++]=255&a[u].length,s.set(a[u],d),d+=a[u].length;for(s[d++]=o.length,a=0;a<o.length;a++)s[d++]=(65280&o[a].length)>>8,s[d++]=255&o[a].length,s.set(o[a],d),d+=o[a].length;r=r("avcC",s)}n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(h(_o(n,2)),h(_o(i,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),i="avc1",o=Ro(e),a=new Uint8Array([]),e.encrypted&&(a=Do(0,e.stream,e.codecs),i="encv"),i=Uo(i,n,r,o,a)}else e.codecs.includes("hvc1")&&(i=e.stream.width||0,r=e.stream.height||0,n=new Uint8Array([]),0<e.Ba.byteLength&&(n=Uo("hvcC",e.Ba)),i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(h(_o(i,2)),h(_o(r,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),r="hvc1",o=Ro(e),a=new Uint8Array([]),e.encrypted&&(a=Do(0,e.stream,e.codecs),r="encv"),i=Uo(r,i,n,o,a));break;case"audio":"mp3"==n?e=Uo(".mp3",Co(e)):"ac-3"==n?(n=Uo("dac3",e.ra),i="ac-3",r=new Uint8Array([]),e.encrypted&&(r=Do(0,e.stream,e.codecs),i="enca"),e=Uo(i,Co(e),n,r)):"ec-3"==n?(n=Uo("dec3",e.ra),i="ec-3",r=new Uint8Array([]),e.encrypted&&(r=Do(0,e.stream,e.codecs),i="enca"),e=Uo(i,Co(e),n,r)):"opus"==n?(n=Uo("dOps",e.ra),i="Opus",r=new Uint8Array([]),e.encrypted&&(r=Do(0,e.stream,e.codecs),i="enca"),e=Uo(i,Co(e),n,r)):(0<e.ra.byteLength?n=Uo("esds",e.ra):(n=Uo,i=e.id+1,r=e.stream.channelsCount||2,a=e.stream.audioSamplingRate||44100,u=Ht("audio",e.codecs.split(",")),l={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},o=l[a],"mp4a.40.5"!==u&&"mp4a.40.29"!==u||(o=l[2*a]),a=parseInt(u.split(".").pop(),10),i=new Uint8Array([0,0,0,0,3,25].concat(h(_o(i,2)),[0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,a<<3|o>>>1,o<<7|r<<3,6,1,2])),n=n("esds",i)),i="mp4a",r=new Uint8Array([]),e.encrypted&&(r=Do(0,e.stream,e.codecs),i="enca"),e=Uo(i,Co(e),n,r)),i=e}return e=Uo("stsd",Xo,i),t("stbl",e,Uo("stts",Vo),Uo("stsc",Ho),Uo("stsz",Wo),Uo("stco",Ko))}function Ro(e){if(!e.Ha&&!e.Ja)return new Uint8Array([]);var t=e.Ja;return e=new Uint8Array([].concat(h(_o(e.Ha,4)),h(_o(t,4)))),Uo("pasp",e)}function Co(e){return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.stream.channelsCount||2,0,16,0,0,0,0].concat(h(_o(e.stream.audioSamplingRate||44100,2)),[0,0]))}function Do(e,t,n){e=Uo,n=new Uint8Array([].concat(h(_o(No(n.split(".")[0]),4)))),n=Uo("frma",n);var i="cenc",r=t.drmInfos[0];r&&r.encryptionScheme&&(i=r.encryptionScheme),i=new Uint8Array([0,0,0,0].concat(h(_o(No(i),4)),[0,1,0,0])),i=Uo("schm",i),r=Uo;var s=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);t=d(t.drmInfos);for(var a=t.next();!a.done;a=t.next())if((a=a.value)&&a.keyIds&&a.keyIds.size){a=d(a.keyIds);for(var o=a.next();!o.done;o=a.next())s=Oo(o.value)}return t=new Uint8Array([0,0,0,0,0,0,1,8]),t=Uo("tenc",t,s),e("sinf",n,i,r("schi",t))}function Mo(e){var t=[];e=d(e.g);for(var n=e.next();!n.done;n=e.next()){n=n.value;var i,r=t.push,s=r.apply,a=Uo,o=new Uint8Array([0,0,0,0].concat(h(_o(n.data?n.data.Db:0,4))));o=Uo("mfhd",o);var u=n.data?n.data.hb:[],l=new Uint8Array(4+u.length);for(i=0;i<u.length;i++){var c=u[i].flags;l[i+4]=c.Wa<<4|c.Ya<<2|c.Xa}u=Uo("sdtp",l);var f=u.length+92;l=Uo,i=new Uint8Array([0,0,0,58].concat(h(_o(n.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),i=Uo("tfhd",i),c=n.data?n.data.baseMediaDecodeTime:0;var p=Math.floor(c%(Bo+1));c=new Uint8Array([1,0,0,0].concat(h(_o(Math.floor(c/(Bo+1)),4)),h(_o(p,4)))),c=Uo("tfdt",c);var g=f;f=n.data?n.data.hb:[],p=f.length;var m=12+16*p,v=new Uint8Array(m);for(g+=8+m,v.set(["video"===n.type?1:0,0,15,1].concat(h(_o(p,4)),h(_o(g,4))),0),g=0;g<p;g++){var y=f[g];m=_o(y.duration,4);var b=_o(y.size,4),T=y.flags;y=_o(y.bb,4),v.set([].concat(h(m),h(b),[T.fb<<2|T.Wa,T.Ya<<6|T.Xa<<4|T.gb,61440&T.Va,15&T.Va],h(y)),12+16*g)}f=Uo("trun",v),u=l("traf",i,c,f,u),a=a("moof",o,u),s.call(r,t,[a,Po(n)])}return jt.apply(_t,h(t))}function Po(e){return e=(e.data?e.data.hb:[]).map((function(e){return e.data})),e=jt.apply(_t,h(e)),Uo("mdat",e)}function _o(e,t){var n=[];for(--t;0<=t;t--)n.push(e>>8*t&255);return n}function Oo(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length/2;n+=1)t[n]=parseInt(String(e[2*n]+e[2*n+1]),16);return t}function No(e){for(var t=0,n=0;n<e.length;n+=1)t|=e.charCodeAt(n)<<8*(e.length-n-1);return t}function Uo(e){var t=F.apply(1,arguments),n=jo.get(e);n||(n=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)],jo.set(e,n));for(var i=8,r=t.length-1;0<=r;r--)i+=t[r].byteLength;for(r=new Uint8Array(i),r[0]=i>>24&255,r[1]=i>>16&255,r[2]=i>>8&255,r[3]=255&i,r.set(n,4),n=0,i=8;n<t.length;n++)r.set(t[n],i),i+=t[n].byteLength;return r}var Fo=!1,Bo=Math.pow(2,32)-1,jo=new Map,$o=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Go=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),Vo=new Uint8Array([0,0,0,0,0,0,0,0]),Ho=new Uint8Array([0,0,0,0,0,0,0,0]),Ko=new Uint8Array([0,0,0,0,0,0,0,0]),Wo=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),qo=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Yo=new Uint8Array([0,0,0,0,0,0,0,0]),Xo=new Uint8Array([0,0,0,0,0,0,0,1]),zo=new Uint8Array([]),Qo=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Jo=new Uint8Array([]);function Zo(e){e=Ne(e);var t=null;return(new ea).box("moov",ta).box("trak",ta).box("mdia",ta).box("minf",ta).box("stbl",ta).R("stsd",na).box("enca",(function(e){return t=e.reader.h,ra(e)})).box("sinf",ta).box("frma",(function(e){e.parser.stop(),"ec-3"===Eo(e.reader).codec&&t&&2!==t.getUint16(16)&&t.setUint16(16,2)})).parse(e),e}function eu(e,t,n){function i(e){h.push({box:e,gh:1701733217})}function r(e){h.push({box:e,gh:1701733238})}function s(e){l=!0,e.parser.stop()}function a(e){c.push(e),ta(e)}var o,u=t=Ne(t),l=!1,c=[],h=[];if((new ea).box("moov",a).box("trak",a).box("mdia",a).box("minf",a).box("stbl",a).R("stsd",(function(e){o=e,c.push(e),na(e)})).R("encv",s).R("enca",s).R("dvav",r).R("dva1",r).R("dvh1",r).R("dvhe",r).R("dvc1",r).R("dvi1",r).R("hev1",r).R("hvc1",r).R("avc1",r).R("avc3",r).R("ac-3",i).R("ec-3",i).R("ac-4",i).R("Opus",i).R("fLaC",i).R("mp4a",i).parse(t),l)return t;if(0==h.length||!o)throw ie(Bt(t)),new je(2,3,3019,n);h.reverse(),n=d(h);for(var f=n.next();!f.done;f=n.next())f=f.value,u=iu(e,u,o,f.box,c,f.gh);return Ze()&&ft()&&!et()?(e=new Uint8Array(t.byteLength+u.byteLength),e.set(u),e.set(t,u.byteLength),e):u}function tu(e){e=Ne(e);var t=[];(new ea).box("mdat",(function(e){t.push(e)})).parse(e);for(var n=[],i=0;i<t.length;i++){var r=t[i-1],s=t[i];n.push(nu(e.subarray(r?r.start+r.size:0,s.start+s.size)))}return jt.apply(_t,h(n))}function nu(e){function t(e){a.push(e),ta(e)}var n,i,r,s,a=[];if((new ea).box("moof",t).box("traf",t).R("tfhd",(function(e){n=e,r=vo(e.reader,e.flags)})).R("trun",(function(e){i=e,s=To(e.reader,e.version,e.flags)})).parse(e),r&&2!==r.qh){var o=n.start+ua(n)+4+(null!==r.Vh?8:0),u=Fe(e);if(null!==r.qh)u.setUint32(o,2);else{ru(e,n.start,n.size+4);var l=u.getUint32(n.start+8);u.setUint32(n.start+8,2|l),s&&null!==s.nf&&u.setInt32(i.start+ua(i)+4,s.nf+4),l=e.subarray(0,o),u=e.subarray(o),e=new Uint8Array(e.byteLength+4),e.set(l),l=[];for(var c=3;0<=c;c--)l.push(2>>8*c&255);for(e.set(new Uint8Array(l),o),e.set(u,o+4),o=d(a),u=o.next();!u.done;u=o.next())u=u.value,ru(e,u.start,u.size+4)}}return e}function iu(e,t,n,i,r,s){var a=Do(new Io([]),e,i.name),o=t.subarray(i.start,i.start+i.size);for(e=new Uint8Array(i.size+a.byteLength),e.set(o,0),Fe(e).setUint32(4,s),e.set(a,i.size),ru(e,0,e.byteLength),s=new Uint8Array(t.byteLength+e.byteLength),i=ot()||et()||Ze()?i.start:i.start+i.size,a=t.subarray(i),s.set(t.subarray(0,i)),s.set(e,i),s.set(a,i+e.byteLength),t=d(r),r=t.next();!r.done;r=t.next())r=r.value,ru(s,r.start,r.size+e.byteLength);return e=Fe(s,n.start),n=ua(n),t=e.getUint32(n),e.setUint32(n,t+1),s}function ru(e,t,n){e=Fe(e,t),t=e.getUint32(0),0!=t&&(1==t?(e.setUint32(8,n>>32),e.setUint32(12,4294967295&n)):e.setUint32(0,n))}function su(e){function t(e){i.push({start:e.start,size:e.size}),ta(e)}var n=Ne(e),i=[];return(new ea).box("moov",t).box("trak",t).box("mdia",t).box("minf",t).box("stbl",t).box("stsd",(function(e){i.push({start:e.start,size:e.size});for(var t=Fe(n,e.start),r=0;r<e.size-3;r++){var s=t.getUint32(r);1633889587==s?t.setUint32(r,1700998451):1684103987==s&&t.setUint32(r,1684366131)}})).parse(n),n}function au(e,t,n,i,r,s,a,o){this.N=e,this.startByte=t,this.endByte=n,this.Uc=void 0===i?null:i,this.timescale=void 0===r?null:r,this.h=void 0===s?null:s,this.aesKey=void 0===a?null:a,this.g=this.mimeType=this.codecs=null,this.encrypted=void 0!==o&&o}function ou(e,t){return e===t||(e&&t?e.cc()==t.cc()&&e.ac()==t.ac()&&Tn(e.N().sort(),t.N().sort())&&_e(e.Gb(),t.Gb()):e==t)}function uu(e,t,n,i,r,s,a,o,u,l,c,h,f,p,g,m){for(l=void 0===l?[]:l,p=void 0===p?cu:p,this.startTime=e,this.j=this.endTime=t,this.C=n,this.startByte=i,this.endByte=r,this.Y=s,this.timestampOffset=a,this.appendWindowStart=o,this.appendWindowEnd=u,this.g=l,this.tilesLayout=void 0===c?"":c,this.B=void 0===h?null:h,this.h=void 0===f?null:f,this.status=p,this.preload=!1,this.l=!0,this.m=!1,this.aesKey=void 0===g?null:g,this.thumbnailSprite=null,this.i=-1,this.A=void 0!==m&&m,this.F=this.o=!1,e=d(this.g),t=e.next();!t.done;t=e.next())t.value.eh();this.A&&this.g.length&&this.g[this.g.length-1].dh(),this.u=this.bandwidth=this.mimeType=this.codecs=null,this.G=!1}function lu(e,t){e.Y=t,e=d(e.g);for(var n=e.next();!n.done;n=e.next())lu(n.value,t)}au.prototype.cc=function(){return this.startByte},au.prototype.ac=function(){return this.endByte},au.prototype.Jd=function(e){this.h=e},au.prototype.Gb=function(){return this.h},K("shaka.media.InitSegmentReference",au),au.prototype.getEndByte=au.prototype.ac,au.prototype.getStartByte=au.prototype.cc,i=uu.prototype,i.N=function(){return this.C()},i.getStartTime=function(){return this.startTime},i.mi=function(){return this.endTime},i.cc=function(){return this.startByte},i.ac=function(){return this.endByte},i.Ji=function(){return this.tilesLayout},i.Ii=function(){return this.B},i.dc=function(){return this.status},i.aj=function(){this.status=du},i.Sf=function(){this.preload=!0},i.isPreload=function(){return this.preload},i.Tc=function(){this.l=!1},i.Ti=function(){return this.l},i.eh=function(){this.o=!0},i.Vi=function(){return this.o},i.dh=function(){this.F=!0},i.Ui=function(){return this.F},i.bh=function(){this.m=!0},i.Pi=function(){return this.m},i.Ee=function(e){this.thumbnailSprite=e},i.Gi=function(){return this.thumbnailSprite},i.offset=function(e){this.startTime+=e,this.endTime+=e,this.j+=e;for(var t=d(this.g),n=t.next();!n.done;n=t.next())n=n.value,n.startTime+=e,n.endTime+=e,n.j+=e},i.qg=function(e){null==this.h?J("Sync attempted without sync time!"):(e=this.h-e-this.startTime,.001<=Math.abs(e)&&this.offset(e))},i.Jd=function(e,t){this.u=e,this.G=void 0!==t&&t},i.Gb=function(e){var t=this.u;return(void 0===e||e)&&this.G&&(this.u=null),t},K("shaka.media.SegmentReference",uu),uu.prototype.getSegmentData=uu.prototype.Gb,uu.prototype.setSegmentData=uu.prototype.Jd,uu.prototype.syncAgainst=uu.prototype.qg,uu.prototype.offset=uu.prototype.offset,uu.prototype.getThumbnailSprite=uu.prototype.Gi,uu.prototype.setThumbnailSprite=uu.prototype.Ee,uu.prototype.hasByterangeOptimization=uu.prototype.Pi,uu.prototype.markAsByterangeOptimization=uu.prototype.bh,uu.prototype.isLastPartial=uu.prototype.Ui,uu.prototype.markAsLastPartial=uu.prototype.dh,uu.prototype.isPartial=uu.prototype.Vi,uu.prototype.markAsPartial=uu.prototype.eh,uu.prototype.isIndependent=uu.prototype.Ti,uu.prototype.markAsNonIndependent=uu.prototype.Tc,uu.prototype.isPreload=uu.prototype.isPreload,uu.prototype.markAsPreload=uu.prototype.Sf,uu.prototype.markAsUnavailable=uu.prototype.aj,uu.prototype.getStatus=uu.prototype.dc,uu.prototype.getTileDuration=uu.prototype.Ii,uu.prototype.getTilesLayout=uu.prototype.Ji,uu.prototype.getEndByte=uu.prototype.ac,uu.prototype.getStartByte=uu.prototype.cc,uu.prototype.getEndTime=uu.prototype.mi,uu.prototype.getStartTime=uu.prototype.getStartTime,uu.prototype.getUris=uu.prototype.N;var cu=0,du=1;function hu(e){return 1==e.length&&1e-4>e.end(0)-e.start(0)}function fu(e){return!e||hu(e)?null:e.length?e.end(e.length-1):null}function pu(e,t){return!(!e||!e.length||hu(e)||t>e.end(e.length-1))&&t>=e.start(0)}function gu(e,t){if(!e||!e.length||hu(e))return 0;var n=0;e=d(vu(e));for(var i=e.next();!i.done;i=e.next()){var r=i.value;i=r.start,r=r.end,r>t&&(n+=r-Math.max(i,t))}return n}function mu(e,t,n){return e&&e.length&&!hu(e)?(e=vu(e).findIndex((function(e,i,r){return e.start>t&&(0==i||r[i-1].end-t<=n)})),0<=e?e:null):null}function vu(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function yu(){}function bu(e,t){var n=document.createElement("source");return n.src=e,n.type=void 0===t?"":t,n}function Tu(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function Su(t,n){var i,r,s,a,o;return U((function(u){if(1==u.g)return"fonts"in document&&"FontFace"in e?w(u,document.fonts.ready,2):u.return();if(!("entries"in document.fonts))return u.return();for(i=function(e){e=e.entries();for(var t=[],n=e.next();!1===n.done;)t.push(n.value),n=e.next();return t},r=d(i(document.fonts)),s=r.next();!s.done;s=r.next())if(a=s.value,a.family===t&&"swap"===a.display)return u.return();o=new FontFace(t,"url("+n+")",{display:"swap"}),document.fonts.add(o),A(u)}))}
/*
 @license
 Shaka Player
 Copyright 2022 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function Eu(){}function wu(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]}function Au(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]}function xu(e,t){var n=(127&e[t])<<21;return n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|127&e[t+3]}function Iu(e){var t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if("APIC"===e.type){if(2>e.size||3!==e.data[0])return null;var n=e.data.subarray(1).indexOf(0);if(-1===n)return null;var i=It(Ne(e.data,1,n)),r=e.data[2+n],s=e.data.subarray(3+n).indexOf(0);if(-1===s)return null;var a,o=It(Ne(e.data,3+n,s));return a="--\x3e"===i?It(Ne(e.data,4+n+s)):Oe(e.data.subarray(4+n+s)),t.mimeType=i,t.pictureType=r,t.description=o,t.data=a,t}return"TXXX"===e.type||"WXXX"===e.type?2>e.size||3!==e.data[0]?null:(i=e.data.subarray(1).indexOf(0),-1===i?null:(n=It(Ne(e.data,1,i)),e=It(Ne(e.data,2+i)).replace(/\0*$/,""),t.description=n,t.data=e,t)):"PRIV"===e.type?2>e.size?null:(n=e.data.indexOf(0),-1===n?null:(n=It(Ne(e.data,0,n)),t.description=n,"com.apple.streaming.transportStreamTimestamp"==n?(n=e.data.subarray(n.length+1),e=1&n[3],n=(n[4]<<23)+(n[5]<<15)+(n[6]<<7)+n[7],n/=45,e&&(n+=47721858.84),t.data=n):(e=Oe(e.data.subarray(n.length+1)),t.data=e),t)):"T"===e.type[0]?2>e.size||3!==e.data[0]?null:(e=It(e.data.subarray(1)).replace(/\0*$/,""),t.data=e,t):"W"===e.type[0]?(e=It(e.data).replace(/\0*$/,""),t.data=e,t):e.data?(t.data=Oe(e.data),t):null}function ku(e){for(var t=0,n=[];wu(e,t);){var i=xu(e,t+6);for(e[t+5]>>6&1&&(t+=10),t+=10,i=t+i;t+10<i;){var r=e.subarray(t),s=xu(r,4);r={type:String.fromCharCode(r[0],r[1],r[2],r[3]),size:s,data:r.subarray(10,10+s)},(s=Iu(r))&&n.push(s),t+=r.size+10}Au(e,t)&&(t+=10)}return n}function Lu(e,t){for(var n=t=void 0===t?0:t,i=0;wu(e,t);)e[t+5]>>6&1&&(i+=10),i+=10,i+=xu(e,t+6),Au(e,t+10)&&(i+=10),t+=i;return 0<i?e.subarray(n,n+i):new Uint8Array([])}function Ru(e,t){if(this.j=e,void 0!==t&&t){t=new Uint8Array(e.byteLength);for(var n=0,i=0;i<e.byteLength;i++)2<=i&&3==e[i]&&0==e[i-1]&&0==e[i-2]||(t[n]=e[i],n++);this.j=Ne(t,0,n)}this.i=this.j.byteLength,this.g=this.h=0}function Cu(e){var t=e.j.byteLength-e.i,n=new Uint8Array(4),i=Math.min(4,e.i);0!==i&&(n.set(e.j.subarray(t,t+i)),e.h=new Qs(n,0).S(),e.g=8*i,e.i-=i)}function Du(e,t){if(e.g<=t){t-=e.g;var n=Math.floor(t/8);t-=8*n,e.g-=n,Cu(e)}e.h<<=t,e.g-=t}function Mu(e,t){var n=Math.min(e.g,t),i=e.h>>>32-n;return e.g-=n,0<e.g?e.h<<=n:0<e.i&&Cu(e),n=t-n,0<n?i<<n|Mu(e,n):i}function Pu(e){var t;for(t=0;t<e.g;++t)if(0!==(e.h&2147483648>>>t))return e.h<<=t,e.g-=t,t;return Cu(e),t+Pu(e)}function _u(e){Du(e,1+Pu(e))}function Ou(e){var t=Pu(e);return Mu(e,t+1)-1}function Nu(e){return e=Ou(e),1&e?1+e>>>1:-1*(e>>>1)}function Uu(e){return 1===Mu(e,1)}function Fu(e){return Mu(e,8)}function Bu(e,t){for(var n=8,i=8,r=0;r<t;r++)0!==i&&(i=Nu(e),i=(n+i+256)%256),n=0===i?n:i}function ju(e){return Fu(e),Ou(e),Ou(e)}function $u(){this.G=null,this.H=!1,this.m=this.I=null,this.j=[],this.g=[],this.A=this.B=null,this.i=[],this.h=[],this.C=null,this.l=[],this.F=this.o=this.u=null}function Gu(e,t){if(1!==(t[0]<<16|t[1]<<8|t[2]))return null;var n={data:new Uint8Array(0),packetLength:t[4]<<8|t[5],pts:null,dts:null,nalus:[]};if(n.packetLength&&n.packetLength>t.byteLength-6)return null;var i=t[7];if(192&i){var r=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2;null==e.u&&(e.u=r),n.pts=Wu(r,e.u),e.u=n.pts,n.dts=n.pts,64&i&&(i=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,null==e.o&&(e.o=i),n.dts=Wu(i,e.o)),e.o=n.dts}return e=t[8]+9,t.byteLength<=e?null:(n.data=t.subarray(e),n)}function Vu(e){var t=e.uc();return 1<t.length&&(e=t[0].pts,t=t[1].pts,!isNaN(t-e))?String(1/(t-e)*9e4):null}function Hu(e){var t={height:null,width:null,codec:null,frameRate:null},n=e.de();if(!n.length)return t;if(n=n.find((function(e){return 7==e.type})),!n)return t;n=new Ru(n.data);var i=Fu(n),r=Fu(n),s=Fu(n);if(_u(n),Xu.includes(i)){var a=Ou(n);if(3===a&&Du(n,1),_u(n),_u(n),Du(n,1),Uu(n)){a=3!==a?8:12;for(var o=0;o<a;o++)Uu(n)&&Bu(n,6>o?16:64)}}if(_u(n),a=Ou(n),0===a)Ou(n);else if(1===a)for(Du(n,1),_u(n),_u(n),a=Ou(n),o=0;o<a;o++)_u(n);_u(n),Du(n,1),a=Ou(n),o=Ou(n);var u=Mu(n,1);0===u&&Du(n,1),Du(n,1);var l=0,c=0,d=0,h=0;return Uu(n)&&(l=Ou(n),c=Ou(n),d=Ou(n),h=Ou(n)),t.height=String((2-u)*(o+1)*16-2*d-2*h),t.width=String(16*(a+1)-2*l-2*c),t.codec="avc1."+("0"+i.toString(16).toUpperCase()).slice(-2)+("0"+r.toString(16).toUpperCase()).slice(-2)+("0"+s.toString(16).toUpperCase()).slice(-2),t.frameRate=Vu(e),t}function Ku(e){var t={height:null,width:null,codec:null,frameRate:null},n=e.de();if(!n.length)return t;if(n=n.find((function(e){return 33==e.type})),!n)return t;var i=new Ru(n.fullData,!0);Fu(i),Fu(i),Mu(i,4);var r=Mu(i,3);Uu(i);var s=Mu(i,2),a=Mu(i,1),o=Mu(i,5),u=Mu(i,32);n=Fu(i);for(var l=Fu(i),c=Fu(i),d=Fu(i),h=Fu(i),f=Fu(i),p=Fu(i),g=[],m=[],v=0;v<r;v++)g.push(Uu(i)),m.push(Uu(i));if(0<r)for(v=r;8>v;v++)Mu(i,2);for(v=0;v<r;v++)g[v]&&Mu(i,88),m[v]&&Fu(i);Ou(i),r=Ou(i),3==r&&Mu(i,1),g=Ou(i),m=Ou(i);var y=v=0,b=0,T=0;return Uu(i)&&(v+=Ou(i),y+=Ou(i),b+=Ou(i),T+=Ou(i)),t.width=String(g-(v+y)*(1===r||2===r?2:1)),t.height=String(m-(b+T)*(1===r?2:1)),i=function(e){for(var t=0,n=0;32>n;n++)t|=(e>>n&1)<<31-n;return t>>>0}(u),a=1==a?"H":"L",s="hvc1."+["","A","B","C"][s]+o,s+="."+i.toString(16).toUpperCase(),s+="."+a+p,f&&(s+="."+f.toString(16).toUpperCase()),h&&(s+="."+h.toString(16).toUpperCase()),d&&(s+="."+d.toString(16).toUpperCase()),c&&(s+="."+c.toString(16).toUpperCase()),l&&(s+="."+l.toString(16).toUpperCase()),n&&(s+="."+n.toString(16).toUpperCase()),t.codec=s,t.frameRate=Vu(e),t}function Wu(e,t){var n=1;for(e>t&&(n=-1);4294967296<Math.abs(t-e);)e+=8589934592*n;return e}function qu(e){return!(0>Yu(e))}function Yu(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(71==e[n]&&71==e[n+188]&&71==e[n+376])return n;n++}return-1}uu.Status={Nj:cu,Lk:du,lk:2},K("shaka.util.Dom",yu),yu.removeAllChildren=Tu,K("shaka.util.Id3Utils",Eu),Eu.getID3Data=Lu,Eu.getID3Frames=ku,K("shaka.util.ExpGolomb",Ru),i=$u.prototype,i.clearData=function(){this.j=[],this.g=[],this.i=[],this.h=[],this.l=[]},i.parse=function(e){if(564>e.length)return this;for(var t=Math.max(0,Yu(e)),n=e.length-(e.length+t)%188,i=!1,r=t;r<n;r+=188)if(71==e[r]){var s=!!(64&e[r+1]),a=((31&e[r+1])<<8)+e[r+2];if(1<(48&e[r+3])>>4){var o=r+5+e[r+4];if(o==r+188)continue}else o=r+4;switch(a){case 0:s&&(o+=e[o]+1),this.G=(31&e[o+10])<<8|e[o+11];break;case 17:case 8191:break;case this.G:s&&(o+=e[o]+1),s=e,a={audio:-1,video:-1,ee:-1,audioCodec:"",videoCodec:""};var u=o+3+((15&s[o+1])<<8|s[o+2])-4;for(o+=12+((15&s[o+10])<<8|s[o+11]);o<u;){var l=(31&s[o+1])<<8|s[o+2],c=(15&s[o+3])<<8|s[o+4];switch(s[o]){case 6:if(0<c)for(var d=o+5,h=c;2<h;){var f=s[d+1]+2;switch(s[d]){case 5:var p=Dt(s.subarray(d+2,d+f));-1==a.audio&&"Opus"===p?(a.audio=l,a.audioCodec="opus"):-1==a.video&&"AV01"===p&&(a.video=l,a.videoCodec="av1");break;case 106:-1==a.audio&&(a.audio=l,a.audioCodec="ac3");break;case 122:-1==a.audio&&(a.audio=l,a.audioCodec="ec3");break;case 124:-1==a.audio&&(a.audio=l,a.audioCodec="aac");break;case 127:"opus"==a.audioCodec&&(p=null,128===s[d+2]&&(p=s[d+3]),null!=p&&(this.F={channelCount:0===(15&p)?2:15&p,Yh:p,sampleRate:48e3}))}d+=f,h-=f}break;case 15:-1==a.audio&&(a.audio=l,a.audioCodec="aac");break;case 17:-1==a.audio&&(a.audio=l,a.audioCodec="aac-loas");break;case 21:-1==a.ee&&(a.ee=l);break;case 27:-1==a.video&&(a.video=l,a.videoCodec="avc");break;case 3:case 4:-1==a.audio&&(a.audio=l,a.audioCodec="mp3");break;case 36:-1==a.video&&(a.video=l,a.videoCodec="hvc");break;case 129:-1==a.audio&&(a.audio=l,a.audioCodec="ac3");break;case 132:case 135:-1==a.audio&&(a.audio=l,a.audioCodec="ec3")}o+=c+5}s=a,-1!=s.video&&(this.I=s.video,this.m=s.videoCodec),-1!=s.audio&&(this.B=s.audio,this.A=s.audioCodec),-1!=s.ee&&(this.C=s.ee),i&&!this.H&&(i=!1,r=t-188),this.H=!0;break;case this.I:o=e.subarray(o,r+188),s?this.j.push([o]):this.j.length&&this.j[this.j.length-1]&&this.j[this.j.length-1].push(o);break;case this.B:o=e.subarray(o,r+188),s?this.i.push([o]):this.i.length&&this.i[this.i.length-1]&&this.i[this.i.length-1].push(o);break;case this.C:o=e.subarray(o,r+188),s?this.l.push([o]):this.l.length&&this.l[this.l.length-1]&&this.l[this.l.length-1].push(o);break;default:i=!0}}return this},i.hj=function(e){return he("TsParser.parseAvcNalus","Please use parseNalus function instead."),this.Xf(e,{Bd:null,state:null})},i.Xf=function(e,t){var n=e.pts?e.pts/9e4:null;e=e.data;var i=e.byteLength,r=1;"hvc"==this.m&&(r=2);var s=t.state||0,a=s,o=0,u=[],l=-1,c=0;for(-1==s&&(l=0,c="hvc"==this.m?e[0]>>1&63:31&e[0],s=0,o=1);o<i;){var d=e[o++];s?1===s?s=d?0:2:d?1==d?(d=o-s-1,0<=l?u.push({data:e.subarray(l+r,d),fullData:e.subarray(l,d),type:c,time:n,state:null}):(s=u.length?u[u.length-1]:t.Bd)&&(a&&o<=4-a&&s.state&&(s.data=s.data.subarray(0,s.data.byteLength-a),s.fullData=s.fullData.subarray(0,s.fullData.byteLength-a)),0<d&&(d=e.subarray(0,d),s.data=jt(s.data,d),s.fullData=jt(s.fullData,d),s.state=0)),o<i?(c="hvc"==this.m?e[o]>>1&63:31&e[o],l=o,s=0):s=-1):s=0:s=3:s=d?0:1}return 0<=l&&0<=s&&u.push({data:e.subarray(l+r,i),fullData:e.subarray(l,i),type:c,time:n,state:s}),!u.length&&t.Bd&&(n=u.length?u[u.length-1]:t.Bd)&&(n.data=jt(n.data,e),n.fullData=jt(n.fullData,e)),t.state=s,u},i.getMetadata=function(){for(var e=[],t=d(this.l),n=t.next();!n.done;n=t.next())n=jt.apply(_t,h(n.value)),(n=Gu(this,n))&&e.push({cueTime:n.pts?n.pts/9e4:null,data:n.data,frames:ku(n.data),dts:n.dts,pts:n.pts});return e},i.cb=function(){if(this.i.length&&!this.h.length){for(var e=!1,t=d(this.i),n=t.next();!n.done;n=t.next()){var i=jt.apply(_t,h(n.value)),r=Gu(this,i);n=this.h.length?this.h[this.h.length-1]:null,r&&null!=r.pts&&null!=r.dts&&(!n||n.pts!=r.pts&&n.dts!=r.dts)?(this.h.length&&r.dts<(n.dts||0)&&(e=!0),this.h.push(r)):this.h.length&&(i=r?r.data:i)&&(n=this.h.pop(),n.data=jt(n.data,i),this.h.push(n))}e&&(this.h=this.h.sort((function(e,t){var n=(e.pts||0)-(t.pts||0);return(e.dts||0)-(t.dts||0)||n})))}return this.h},i.uc=function(e){if(e=void 0===e||e,this.j.length&&!this.g.length){for(var t=!1,n=d(this.j),i=n.next();!i.done;i=n.next()){var r=jt.apply(_t,h(i.value)),s=Gu(this,r);i=this.g.length?this.g[this.g.length-1]:null,s&&null!=s.pts&&null!=s.dts&&(!i||i.pts!=s.pts&&i.dts!=s.dts)?(this.g.length&&s.dts<(i.dts||0)&&(t=!0),this.g.push(s)):this.g.length&&(r=s?s.data:r)&&(i=this.g.pop(),i.data=jt(i.data,r),this.g.push(i))}if(e){for(n={Bd:null,state:null},i=[],r=d(this.g),s=r.next();!s.done;s=r.next())s=s.value,s.nalus=this.Xf(s,n),s.nalus.length&&(i.push(s),n.Bd=s.nalus[s.nalus.length-1]);this.g=i}t&&(this.g=this.g.sort((function(e,t){var n=(e.pts||0)-(t.pts||0);return(e.dts||0)-(t.dts||0)||n})))}return e?this.g:(e=this.g,this.g=[],e)},i.getStartTime=function(e){if("audio"==e){e=null;var t=this.cb();return t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e}return"video"==e?(e=null,t=this.uc(!1),t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e):null},i.md=function(){return{audio:this.A,video:this.m}},i.de=function(){for(var e=[],t=d(this.uc()),n=t.next();!n.done;n=t.next())e.push.apply(e,h(n.value.nalus));return e},i.Mi=function(){he("TsParser.getVideoResolution","Please use getVideoInfo function instead.");var e=this.Kf();return{height:e.height,width:e.width}},i.Kf=function(){return"hvc"==this.m?Ku(this):Hu(this)},K("shaka.util.TsParser",$u),$u.syncOffset=Yu,$u.probe=qu,$u.prototype.getVideoInfo=$u.prototype.Kf,$u.prototype.getVideoResolution=$u.prototype.Mi,$u.prototype.getVideoNalus=$u.prototype.de,$u.prototype.getCodecs=$u.prototype.md,$u.prototype.getStartTime=$u.prototype.getStartTime,$u.prototype.getVideoData=$u.prototype.uc,$u.prototype.getAudioData=$u.prototype.cb,$u.prototype.getMetadata=$u.prototype.getMetadata,$u.prototype.parseNalus=$u.prototype.Xf,$u.prototype.parseAvcNalus=$u.prototype.hj,$u.prototype.parse=$u.prototype.parse,$u.prototype.clearData=$u.prototype.clearData,$u.Timescale=9e4;var Xu=[100,110,122,244,44,83,86,118,128,138,139,134];function zu(e,t,n,i){var r=this;this.g=e,this.L=n,this.A=null,this.ea=t,this.l=new Map,this.B=new Map,this.za=new Map,this.h=null,this.Da=!1,this.K=i||null,this.o=new Map,this.u=new ae,this.j=new Map,this.O=null,this.I=new ys,this.Fa="",this.Ma=!1,this.sa=!0,this.M=!1,this.C=this.P=null,this.i=Qu(this,this.I),this.ya=this.G=!1,this.H=new Ks((function(){return tl(r)})),this.F=!1,this.T="UNKNOWN",this.Ka=this.La=!1,this.Ea=new ys,this.m=!1,this.oa=null,this.$=new Map,this.ka=this.W=this.na=this.Z=null,this.fa=new ys,this.g.remote&&(this.M="disconnected"!=this.g.remote.state,this.u.D(this.g.remote,"connect",(function(){r.M="disconnected"!=r.g.remote.state})),this.u.D(this.g.remote,"connecting",(function(){r.M="disconnected"!=r.g.remote.state})),this.u.D(this.g.remote,"disconnect",(function(){r.M="disconnected"!=r.g.remote.state})))}function Qu(t,n){if(t.sa=!0,e.ManagedMediaSource){t.C||(t.g.disableRemotePlayback=!0);var i=new ManagedMediaSource;t.u.D(i,"startstreaming",(function(){t.sa=!0})),t.u.D(i,"endstreaming",(function(){t.sa=!1}))}else i=new MediaSource;return t.u.qa(i,"sourceopen",(function(){URL.revokeObjectURL(t.Fa),n.resolve()})),t.u.qa(t.g,"playing",(function(){t.Ma=!0})),t.Fa=Ol(i),t.g.removeAttribute("src"),t.P&&t.g.removeChild(t.P),t.C&&t.g.removeChild(t.C),t.P=bu(t.Fa),t.g.appendChild(t.P),t.C&&t.g.appendChild(t.C),t.g.load(),i}function Ju(t,n,i){t.g&&e.ManagedMediaSource&&t.i&&(t.C&&t.g.removeChild(t.C),t.C=bu(n,i),t.g.appendChild(t.C),t.g.disableRemotePlayback=!1)}function Zu(e,t){var n,i,r,s,a,o,u,l,c,h,f;return U((function(p){if(1==p.g)return e.createSegmentIndex?w(p,e.createSegmentIndex(),2):p.s(2);if(!e.segmentIndex)return p.return(!1);if(0==e.segmentIndex.getNumReferences())return p.return(!0);for(n=Yt,i=new Set,r=d(e.segmentIndex),s=r.next();!s.done;s=r.next())if(a=s.value,o=a.mimeType||e.mimeType||"",u=a.codecs||e.codecs||"",(o!=e.mimeType||u!=e.codecs)&&(l=o+":"+u,!i.has(l)))if(i.add(l),t==n.va){if(c=Wi(o,u),!ur(c))return p.return(!1)}else if(t==n.la?u=Vr(u):t==n.V&&(u=Gr(u,o)),h=Xi(e,o,u),f=qi(o,u),!tn(h)&&!Bi(f))return p.return(!1);return p.return(!0)}))}function el(){var e='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",video/mp4; codecs="dvh1.05.01",video/mp4; codecs="dvh1.20.01",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="ac-4.02.01.01",audio/mp4; codecs="opus",audio/mp4; codecs="flac",audio/mp4; codecs="dtsc",audio/mp4; codecs="dtse",audio/mp4; codecs="dtsx",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat(h(rr)),t={};e=d(e);for(var n=e.next();!n.done;n=e.next()){n=n.value,ur(n)?t[n]=!0:t[n]=Qe()?tn(n)||!!Bi(n):Je(n);var i=n.split(";")[0];t[i]=t[i]||t[n]}return t}function tl(e){var t,n,i,r,s,a,o,u,l,c,h,f,p,g,m;return U((function(v){if(1==v.g){for(t=[],n=d(e.o),i=n.next();!i.done;i=n.next())for(r=i.value,s=d(r),a=s.next().value,o=s.next().value,u=o[0],l=a,e.o.set(l,o.slice(0,1)),u&&t.push(u.p.catch(mr)),c=d(o.slice(1)),h=c.next();!h.done;h=c.next())f=h.value,f.p.reject(new je(2,7,7003,void 0));return e.h&&t.push(e.h.destroy()),w(v,Promise.all(t),2)}for(p=d(e.j.values()),g=p.next();!g.done;g=p.next())m=g.value,m.destroy();e.u&&(e.u.release(),e.u=null),e.g&&e.C&&e.g.removeChild(e.C),e.g&&e.P&&(e.g.removeChild(e.P),e.g.load(),e.g.disableRemotePlayback=!1),e.g=null,e.P=null,e.C=null,e.A=null,e.i=null,e.h=null,e.ea=null,e.l.clear(),e.za.clear(),e.j.clear(),e.O=null,e.o.clear(),e.K=null,e.$.clear(),e.L=null,A(v)}))}function nl(e,t,n,i){var r,s,a,o,u,l,c,d,h,f,p,g;return U((function(m){switch(m.g){case 1:return r=Yt,s=W,a=q,w(m,Zu(n,t),2);case 2:if(a.call(s,m.h,"Type negotiation should happen before MediaSourceEngine.init!"),t==r.V&&i&&(i=Gr(i,n.mimeType)),o=Wi(n.mimeType,i),t==r.va){rl(e,o,e.F,n.external),m.s(0);break}if(u=e.A.forceTransmux,(!tn(o)||!e.F&&rr.includes(o))&&(u=!0),l=qi(n.mimeType,i),!u){m.s(4);break}if(c=Kt(r.V,(i||"").split(",")),d=Kt(r.la,(i||"").split(",")),!c||!d){m.s(5);break}return e.m=!0,w(m,nl(e,r.V,n,c),6);case 6:return w(m,nl(e,r.la,n,d),7);case 7:return m.return();case 5:(h=Bi(l))&&(f=h(),e.j.set(t,f),o=f.convertCodecs(t,l));case 4:p=o+e.A.addExtraFeaturesToSourceBuffer(o),Ws(e.H);try{g=e.i.addSourceBuffer(p)}catch(v){throw new je(2,3,3015,v,"The mediaSource_ status was "+e.i.readyState+" expected 'open'",null)}e.F&&(g.mode=Nl),e.u.D(g,"error",(function(){var n=e.o.get(t)[0];n.p.reject(new je(2,3,3014,e.g.error?e.g.error.code:0,n.uri))})),e.u.D(g,"updateend",(function(){return wl(e,t)})),e.l.set(t,g),e.B.set(t,o),e.za.set(t,!!n.drmInfos.length),A(m)}}))}function il(e){return e.sa&&!e.M&&!e.G}function rl(e,t,n,i){e.h||(e.h=new sr(e.ea),e.h&&(e.h.A=e.A.modifyCueCallback));var r=e.h;i=i||e.Da,e=e.T,"application/cea-608"==t||"application/cea-708"==t?r.i=null:(r.i=pr.get(t)(),r.i.setSequenceMode?r.i.setSequenceMode(n):he("Text parsers w/ setSequenceMode",'Text parsers should have a "setSequenceMode" method!'),r.i.setManifestType?r.i.setManifestType(e):he("Text parsers w/ setManifestType",'Text parsers should have a "setManifestType" method!'),r.B=i)}function sl(e){return!e.G&&(!e.i||"ended"==e.i.readyState)}function al(e){return!e.G&&(!e.i||"closed"==e.i.readyState)}function ol(e,t){return e.l.size?t==qt?e=e.h.g:(e=cl(e,t),e=!e||hu(e)?null:1==e.length&&0>e.start(0)?0:e.length?e.start(0):null):e=null,e}function ul(e,t){return e.l.size?t==qt?e.h.h:fu(cl(e,t)):null}function ll(e,t,n){return t==qt?(e=e.h,null==e.h||e.h<n?0:e.h-Math.max(n,e.g)):(e=cl(e,t),gu(e,n))}function cl(e,t){if(e.G||e.M)return null;try{return e.l.get(t).buffered}catch(n){return e.l.has(t),null}}function dl(e,t,n,i,r,s){var a=null,o=[],u=Ne(n);if(rr.includes(s))t=ku(u),t.length&&i&&((n=t.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(a=Math.round(n.data)/1e3),e.L.onMetadata([{cueTime:i.startTime,data:u,frames:t,dts:i.startTime,pts:i.startTime}],0,i.endTime));else if(s.includes("/mp4")&&i&&i.Y&&i.Y.timescale){var l=i.Y.timescale;if(!isNaN(l)){var c=null!=r.emsgSchemeIdUris&&0<r.emsgSchemeIdUris.length||e.A.dispatchAllEmsgBoxes,d=0,h=!1;u=new ea,c&&u.R("emsg",(function(t){var n=r.emsgSchemeIdUris;if(0===t.version)var s=t.reader.Ac(),a=t.reader.Ac(),o=t.reader.S(),u=t.reader.S(),l=t.reader.S(),c=t.reader.S(),d=i.startTime+u/o;else o=t.reader.S(),d=t.reader.Zc()/o+i.timestampOffset,u=d-i.startTime,l=t.reader.S(),c=t.reader.S(),s=t.reader.Ac(),a=t.reader.Ac();t=t.reader.Cb(t.reader.getLength()-t.reader.Aa()),(n&&n.includes(s)||e.A.dispatchAllEmsgBoxes)&&("urn:mpeg:dash:event:2012"==s?e.L.gj():(n=d+l/o,o={startTime:d,endTime:n,schemeIdUri:s,value:a,timescale:o,presentationTimeDelta:u,eventDuration:l,id:c,messageData:t},c=(new Map).set("detail",o),new Is("emsg",c).cancelable=!0,e.L.ej(o),("https://aomedia.org/emsg/ID3"==s||"https://developer.apple.com/streaming/emsg-id3"==s)&&(s=ku(t),s.length&&e.L.onMetadata([{cueTime:d,data:t,frames:s,dts:d,pts:d}],0,n))))})),u.R("prft",(function(t){var n=t.reader,i=t.version;n.S(),t=n.S();var r=n.S();t=1e3*t+r/Math.pow(2,32)*1e3,0===i?n=n.S():(i=n.S(),n=n.S(),n=i*Math.pow(2,32)+n),t=new Date(new Date(Date.UTC(1900,0,1,0,0,0)).getTime()+t).getTime(),n=(new Map).set("detail",{wallClockTime:t,programStartDate:new Date(t-n/l*1e3)}),n=new Is("prft",n),e.L.onEvent(n)})).box("moof",ta).box("traf",ta).R("tfdt",(function(e){h||(d=yo(e.reader,e.version).baseMediaDecodeTime/l,h=!0,c||e.parser.stop())})).parse(n,!0),h&&0==i.timestampOffset&&(a=d)}}else s.includes("/mp4")||s.includes("/webm")||!qu(u)||(e.$.has(t)?e.$.get(t).clearData():e.$.set(t,new $u),o=e.$.get(t).parse(u),u=o.getStartTime(t),null!=u&&(a=u),o=o.getMetadata());return{timestamp:a,metadata:o}}function hl(e,t,n,i,r,s,a,o,u,l){var c,d,h,f,p,g,m,v,y,b,T,S,E,x,I,k,L;return a=void 0!==a&&a,o=void 0!==o&&o,u=void 0!==u&&u,l=void 0!==l&&l,U((function(R){switch(R.g){case 1:if(c=Yt,t!=c.va){R.s(2);break}if("HLS"!=e.T){R.s(3);break}return w(R,e.Ea,4);case 4:d=R.h,e.h.u=d;case 3:return w(R,lr(e.h,n,i?i.startTime:null,i?i.endTime:null,i?i.N()[0]:null),5);case 5:return R.return();case 2:if(l||!e.m){R.s(6);break}return w(R,hl(e,c.V,n,i,r,s,a,o,u,!0),7);case 7:return w(R,hl(e,c.la,n,i,r,s,a,o,u,!0),8);case 8:return R.return();case 6:if(!e.l.has(t))return R.return();if(h=e.l.get(t).timestampOffset,f=e.B.get(t),e.j.has(t)&&(f=e.j.get(t).getOriginalMimeType()),i&&(p=dl(e,t,n,i,r,f),g=p.timestamp,m=p.metadata,null!=g&&(null==e.Z&&t==c.la&&(e.Z=g,e.na=i.startTime,null!=e.W&&(v=0,e.na==e.ka&&(v=e.Z-e.W),e.fa.resolve(v))),null==e.W&&t==c.V&&(e.W=g,e.ka=i.startTime,null!=e.Z&&(y=0,e.na==e.ka&&(y=e.Z-e.W),e.fa.resolve(y))),b=g,T=rr,!e.F&&T.includes(e.B.get(t))&&(b=0),S=i.startTime-b,E=Math.abs(h-S),(.001<=E||a||o)&&(!u||0<S||!h)&&(h=S,e.Ka&&(Al(e,t,(function(){return Sl(e,t)}),null),Al(e,t,(function(){return El(e,t,h)}),null))),(t==c.la||!e.l.has(c.la))&&e.Ea.resolve(h)),m.length)&&e.L.onMetadata(m,h,i?i.endTime:null),s&&t==c.la&&(e.h||rl(e,"application/cea-608",e.F,!1),e.O||(x=f.split(";",1)[0],e.O=new ln(x)),i?(I=e.O.i(n),I.length&&fr(e.h,I,i.startTime,i.endTime,h)):e.O.init(n,o)),!e.j.has(t)){R.s(9);break}return w(R,e.j.get(t).transmux(n,r,i,e.i.duration,t),10);case 10:n=R.h;case 9:if(n=Ll(e,r,n,i,t),!i||!e.F||t==c.va){R.s(11);break}if(!a&&!o){R.s(11);break}if(k=i.startTime,"HLS"!=e.T||e.m||t!=c.V||!e.l.has(c.la)){R.s(13);break}return w(R,e.fa,14);case 14:L=R.h,.15<Math.abs(L)&&(k-=L);case 13:Al(e,t,(function(){return Sl(e,t)}),null),Al(e,t,(function(){return El(e,t,k)}),null);case 11:return w(R,Al(e,t,(function(){var i=n;e.K&&Jt(e.K,i,h,r),e.l.get(t).appendBuffer(i)}),i?i.N()[0]:null),15);case 15:A(R)}}))}function fl(e,t){var n=ul(e,"video")||0;dr(e.h,t,n)}function pl(e){e.h&&dr(e.h,"",0)}function gl(e,t){var n;return U((function(i){return 1==i.g?(n=Yt,t==n.va?e.h?w(i,e.h.remove(0,1/0),0):i.return():w(i,Al(e,t,(function(){return Tl(e,t,0,e.i.duration)}),null),4)):e.m?w(i,Al(e,n.V,(function(){return Tl(e,n.V,0,e.i.duration)}),null),0):i.s(0)}))}function ml(e,t,n,i,r,s,a,o,u){var l,c,d;return U((function(h){return 1==h.g?(l=Yt,t==l.va?(s||(e.h.u=n),cr(e.h,i,r),h.return()):(c=[],w(h,Pl(e,t,a,o,u),2))):(d=h.h,d||(c.push(Al(e,t,(function(){return Sl(e,t)}),null)),e.m&&c.push(Al(e,l.V,(function(){return Sl(e,l.V)}),null))),s||(c.push(Al(e,t,(function(){return El(e,t,n)}),null)),e.m&&c.push(Al(e,l.V,(function(){return El(e,l.V,n)}),null))),0==i&&1/0==r||(c.push(Al(e,t,(function(){var n=e.l.get(t);n.appendWindowStart=0,n.appendWindowEnd=r,n.appendWindowStart=i,wl(e,t)}),null)),e.m&&c.push(Al(e,l.V,(function(){var t=l.V,n=e.l.get(t);n.appendWindowStart=0,n.appendWindowEnd=r,n.appendWindowStart=i,wl(e,t)}),null))),c.length?w(h,Promise.all(c),0):h.s(0))}))}function vl(e,t,n){var i,r;return U((function(s){return 1==s.g?(i=Yt,t==i.va?s.return():(t==i.la&&(e.Ea=new ys),!e.F||(r=ul(e,t))&&.1>Math.abs(r-n)?s.return():(Al(e,t,(function(){return Sl(e,t)}),null),e.m&&Al(e,i.V,(function(){return Sl(e,i.V)}),null),w(s,Al(e,t,(function(){return El(e,t,n)}),null),2)))):e.m?w(s,Al(e,i.V,(function(){return El(e,i.V,n)}),null),0):s.s(0)}))}function yl(e,t,n){U((function(i){return e.H.g||e.g.error||e.M||e.G||sl(e)||al(e)?i.return():w(i,xl(e,(function(){sl(e)||al(e)||e.i.setLiveSeekableRange(t,n)})),0)}))}function bl(e){U((function(t){return e.H.g||e.g.error||e.M||e.G||sl(e)||al(e)?t.return():w(t,xl(e,(function(){sl(e)||al(e)||e.i.clearLiveSeekableRange()})),0)}))}function Tl(e,t,n,i){i<=n?wl(e,t):e.l.get(t).remove(n,i)}function Sl(e,t){var n=e.l.get(t),i=n.appendWindowStart,r=n.appendWindowEnd;n.abort(),n.appendWindowStart=i,n.appendWindowEnd=r,wl(e,t)}function El(e,t,n){0>n&&(n+=.001);var i=!0;"HLS"==e.T&&(i=ul(e,t),i=!i||.15<Math.abs(i-n)),i&&(e.l.get(t).timestampOffset=n),wl(e,t)}function wl(e,t){if(e.G||e.H.g){var n=e.o.get(t);n&&n.length&&((n=n[0])&&n.p&&n.p.resolve(),e.o.set(t,[]))}else(n=e.o.get(t)[0])&&(n.p.resolve(),Il(e,t))}function Al(e,t,n,i){return Ws(e.H),n={start:n,p:new ys,uri:i},e.o.get(t).push(n),1==e.o.get(t).length&&kl(e,t),n.p}function xl(e,t){var n,i,r,s,a,o,u,l,c,h,f,p,g;return U((function(m){switch(m.g){case 1:for(Ws(e.H),n=[],i=Array.from(e.l.keys()),r=d(i),s=r.next(),a={};!s.done;a={ready:void 0},s=r.next())o=s.value,a.ready=new ys,u={start:function(e){return function(){return e.ready.resolve()}}(a),p:a.ready,uri:null},l=e.o.get(o),l.push(u),n.push(a.ready),1==l.length&&u.start();return x(m,2),w(m,Promise.all(n),4);case 4:k(m,3);break;case 2:throw c=L(m),c;case 3:return x(m,5,6),w(m,t(),6);case 6:for(R(m),h=d(i),f=h.next();!f.done;f=h.next())p=f.value,Il(e,p);C(m,0);break;case 5:throw g=L(m),new je(2,3,3015,g,e.g.error||"No error in the media element",null)}}))}function Il(e,t){e.o.get(t).shift(),kl(e,t)}function kl(e,t){var n=e.o.get(t)[0];if(n)try{n.start()}catch(i){"QuotaExceededError"==i.name?n.p.reject(new je(2,3,3017,t)):il(e)?n.p.reject(new je(2,3,3015,i,e.g.error||"No error in the media element",n.uri)):n.p.reject(new je(2,3,3024,t)),Il(e,t)}}function Ll(e,t,n,i,r){if("mp4"!=zi(e.B.get(r)))return n;var s=null===i,a=e.za.get(r),o=e.L.si(),u=!1;return i&&i.Y&&(u=i.Y.encrypted),i=i?i.N()[0]:null,e.A.correctEc3Enca&&s&&"audio"===r&&(n=Zo(n)),(e=e.A.insertFakeEncryptionInInit&&a)&&(o=Ke(o),e=ot()&&"audio"===r||tt()||et()||vt("SOPOpenBrowser")||Ze()&&ft()&&o),e&&(s?n=eu(t,n,i):((t=!u)&&(t=ot()&&"audio"===r),t&&(n=tu(n)))),s&&nt()&&(n=su(n)),n}function Rl(e,t,n,i){return Al(e,t,(function(){if(t!==qt){if(e.B.get(t),nn()){e.j.has(t)&&(e.j.get(t).destroy(),e.j.delete(t)),i&&e.j.set(t,i);var r=n+e.A.addExtraFeaturesToSourceBuffer(n);e.l.get(t).changeType(r),e.B.set(t,n)}wl(e,t)}}),null)}function Cl(e,t){var n,i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E;return U((function(A){switch(A.g){case 1:if(e.G)return A.return();for(n=Yt,e.G=!0,e.m=!1,i=e.g.currentTime,r=e.g.autoplay,e.g.paused||(e.ya=!0),e.Ma&&(e.g.autoplay=!1),I(A,2),e.u.Pa(),s=d(e.j.values()),a=s.next();!a.done;a=s.next())o=a.value,o.destroy();for(u=d(e.l.values()),l=u.next();!l.done;l=u.next()){c=l.value;try{e.i.removeSourceBuffer(c)}catch(x){}}return e.j.clear(),e.l.clear(),h=e.i.duration,e.I=new ys,e.i=Qu(e,e.I),w(A,e.I,4);case 4:!isNaN(h)&&h?e.i.duration=h:!isNaN(e.oa)&&e.oa&&(e.i.duration=e.oa),f=new ys,p=e.i.sourceBuffers,g=t.size,m=0,v=function(){m++,m===g&&(f.resolve(),e.u.Ia(p,"addsourcebuffer",v))},e.u.D(p,"addsourcebuffer",v),y=d(t.keys()),b=y.next();case 5:return b.done?((E=t.get(n.V))&&E.isAudioMuxedInVideo&&(e.m=!0),e.m&&!e.o.has(n.V)&&e.o.set(n.V,[]),e.g.currentTime=i,w(A,f,2)):(T=b.value,S=t.get(T),w(A,nl(e,T,S,S.codecs),6));case 6:b=y.next(),A.s(5);break;case 2:R(A),e.G=!1,Ws(e.H),e.u.qa(e.g,"canplaythrough",(function(){e.H.g||(e.g.autoplay=r,e.ya&&(e.ya=!1,e.g.play()))})),C(A,0)}}))}function Dl(e,t){return xl(e,(function(){return Cl(e,t)}))}function Ml(e,t,n,i){var r=!1,s=Kt("audio",(i||"").split(",")),a=Kt("video",(i||"").split(",")),o=a;"audio"==t&&(o=s),o||(o=i),i=Wi(n,o);var u=e.A.forceTransmux;if((!tn(i)||!e.F&&rr.includes(i))&&(u=!0),u&&(e=qi(n,o),n=Bi(e))){var l=n();s&&a&&(r=!0),i=l.convertCodecs(t,e)}return t=Qi(er(i)),{ug:l,Fj:r,Eg:Zi(i),codec:t,mimeType:i}}function Pl(e,t,n,i,r){var s,a,o,u,l,c,d,h,f,p,g,m,v,y;return U((function(b){return 1==b.g?(s=Yt,t==s.va?b.return(!1):(a=Qi(er(e.B.get(t))),o=Zi(e.B.get(t)),u=Ml(e,t,n,i),l=u.ug,c=u.Fj,d=u.Eg,h=u.codec,f=u.mimeType,p=!0,c&&e.B.has(s.V)&&(g=Ml(e,s.V,n,i),m=Qi(er(e.B.get(s.V))),v=Zi(e.B.get(s.V)),p=m==g.codec&&v==g.Eg,g.ug&&g.ug.destroy()),a===h&&o===d&&p?(e.j.has(t)&&!l?(e.j.get(t).destroy(),e.j.delete(t)):!e.j.has(t)&&l?e.j.set(t,l):l&&(e.j.has(t)&&e.j.get(t).transmux!=l.transmux?(e.j.get(t).destroy(),e.j.delete(t),e.j.set(t,l)):l.destroy()),b.return(!1)):(y=!0,(e.m||c&&l&&!e.j.has(t))&&(y=!1),y&&"smooth"===e.A.codecSwitchingStrategy&&nn()?w(b,Rl(e,t,f,l),3):(l&&l.destroy(),w(b,Dl(e,r),3))))):b.return(!0)}))}function _l(e,t,n,i){if(t==qt)var r=!1;else{r=Qi(er(e.B.get(t)));var s=Zi(e.B.get(t)),a=Wi(n,i),o=e.A.forceTransmux;(!tn(a)||!e.F&&rr.includes(a))&&(o=!0),n=qi(n,i),o&&(o=Bi(n))&&(o=o(),a=o.convertCodecs(t,n),o.destroy()),t=Qi(er(a)),a=Zi(a),r=r!==t||s!==a}return!!r&&("smooth"!==e.A.codecSwitchingStrategy||!nn()||e.m)}i=zu.prototype,i.destroy=function(){return this.H.destroy()},i.init=function(e,t,n,i){t=void 0!==t&&t,n=void 0===n?"UNKNOWN":n,i=void 0!==i&&i;var r,s,a,o,u,l,c=this;return U((function(h){switch(h.g){case 1:return r=Yt,w(h,c.I,2);case 2:if(!sl(c)&&!al(c)){h.s(3);break}return J("Expected MediaSource to be open during init(); reopening the media source."),c.I=new ys,c.i=Qu(c,c.I),w(h,c.I,3);case 3:c.F=t,c.T=n,c.La=i,c.Ka=!c.F&&"HLS"==c.T&&!c.La,c.$.clear(),c.Z=null,c.na=null,c.W=null,c.ka=null,c.fa=new ys,s=d(e.keys()),a=s.next();case 5:if(a.done){h.s(7);break}return o=a.value,u=e.get(o),w(h,nl(c,o,u,u.codecs),8);case 8:c.m?(c.o.set(r.V,[]),c.o.set(r.la,[])):c.o.set(o,[]),a=s.next(),h.s(5);break;case 7:(l=e.get(r.V))&&l.isAudioMuxedInVideo&&(c.m=!0),A(h)}}))},i.configure=function(e){this.A=e,this.h&&(this.h.A=e.modifyCueCallback)},i.wb=function(){var e={total:this.G?[]:vu(this.g.buffered),audio:vu(cl(this,"audio")),video:vu(cl(this,"video")),text:[]};if(this.h){var t=this.h.g,n=this.h.h;null!=t&&null!=n&&e.text.push({start:t,end:n})}return e},i.remove=function(e,t,n){var i,r=this;return U((function(s){return 1==s.g?(i=Yt,e==i.va?w(s,r.h.remove(t,n),0):n>t?w(s,Al(r,e,(function(){return Tl(r,e,t,n)}),null),5):s.s(0)):r.m?w(s,Al(r,i.V,(function(){return Tl(r,i.V,t,n)}),null),0):s.s(0)}))},i.flush=function(e){var t,n=this;return U((function(i){return 1==i.g?(t=Yt,e==t.va?i.return():w(i,Al(n,e,(function(){n.g.currentTime-=.001,wl(n,e)}),null),2)):n.m?w(i,Al(n,t.V,(function(){var e=t.V;n.g.currentTime-=.001,wl(n,e)}),null),0):i.s(0)}))},i.endOfStream=function(e){var t=this;return U((function(n){return w(n,xl(t,(function(){sl(t)||al(t)||(e?t.i.endOfStream(e):t.i.endOfStream())})),0)}))},i.$a=function(e){var t=this;return U((function(n){return w(n,xl(t,(function(){if(e<t.i.duration)for(var n=d(t.l.keys()),i=n.next();!i.done;i=n.next()){i=i.value;var r={start:function(){},p:new ys,uri:null};t.o.get(i).unshift(r)}t.i.duration=e,t.oa=e})),0)}))},i.getDuration=function(){return this.i.duration};var Ol=e.URL.createObjectURL,Nl="sequence";function Ul(e,t,n){this.i=e,this.C=t,this.o=this.l=1/0,this.h=1,this.g=this.j=null,this.A=0,this.B=!0,this.I=!1,this.H=0,this.F=void 0===n||n,this.G=0,this.u=!1,this.m=e}function Fl(e,t,n,i){var r=this;this.u=i,this.g=e,this.B=t,this.h=n,this.o=new ae,this.l=!1,this.F=e.readyState,this.G=this.C=this.j=0,this.m=jl(this),this.A=!1,this.o.D(e,"waiting",(function(){return Bl(r)})),this.i=new ze((function(){Bl(r)})).ua(this.h.gapJumpTimerTime)}function Bl(e){if(0!=e.g.readyState){if(e.g.seeking){if(!e.l)return}else e.l=!1;if(!e.g.paused||e.g.currentTime==e.j&&(e.g.autoplay||e.g.currentTime!=e.j)){var t;if(e.g.readyState!=e.F&&(e.F=e.g.readyState),!(t=!e.m)){t=e.m;var n=t.j,i=Vl(n),r=n.g.currentTime,s=Date.now()/1e3;t.g==r&&t.m==i||(t.l=s,t.g=r,t.m=i,t.h=!1),r=s-t.l,(i=r>=t.o&&i&&!t.h)&&(t.i&&t.i(t.g,r),t.h=!0,t.g=n.g.currentTime),t=!i}t&&(t=e.g.currentTime,n=e.g.buffered,i=mu(n,t,e.h.gapDetectionThreshold),null==i||0==i&&!e.A||(r=n.start(i),(s=e.h.gapPadding)&&(r=Math.ceil(100*(r+s))/100),r>=e.B.mb()||.001>r-t||(0!=i&&n.end(i-1),e.g.currentTime=r,t==e.j&&(e.j=r),e.C++,e.u(new Is("gapjumped")))))}}}function jl(e){if(!e.h.stallEnabled)return null;var t=e.h.stallSkip;return new $l(new Gl(e.g),e.h.stallThreshold,(function(){var n;return U((function(i){if(1==i.g)return n=vu(e.g.buffered),n.length?t?(e.g.currentTime+=t,i.s(2)):w(i,e.g.play(),3):i.return();if(2!=i.g){if(!e.g)return i.return();e.g.pause(),e.g.play()}e.G++,e.u(new Is("stalldetected")),A(i)}))}))}function $l(e,t,n){this.j=e,this.m=Vl(e),this.g=e.g.currentTime,this.l=Date.now()/1e3,this.h=!1,this.o=t,this.i=n}function Gl(e){this.g=e}function Vl(e){if(e.g.paused||0==e.g.playbackRate||0==e.g.buffered.length)var t=!1;else e:{t=e.g.currentTime,e=d(vu(e.g.buffered));for(var n=e.next();!n.done;n=e.next())if(n=n.value,!(t<n.start-.1||t>n.end-.5)){t=!0;break e}t=!1}return t}function Hl(e,t,n,i){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?i():(t=Kl.value().get(t),n.qa(e,t,i))}i=Ul.prototype,i.getDuration=function(){return this.l},i.vi=function(){return this.h},i.xh=function(e){this.i=e},i.$a=function(e){this.l=e},i.Bi=function(){return this.i},i.vh=function(e){this.A=e},i.Ec=function(e){e&&!this.B&&(this.I=!0),this.B=e},i.De=function(e){this.o=e},i.ce=function(){return this.o},i.jg=function(e){this.C=e},i.li=function(){return this.C},i.jh=function(e,t){if(0!=e.length){var n=(Date.now()+this.A)/1e3;if(e=e.filter((function(e){return e.start+t<n})),0!=e.length){var i=e[e.length-1].end+t;this.pe(e[0].start+t),this.h=e.reduce((function(e,t){return Math.max(e,t.end-t.start)}),this.h),this.g=Math.max(this.g,i),null!=this.i&&this.F&&!this.u&&(this.i=n-this.g-this.h)}}},i.Cd=function(e){if(0!=e.length){var t=e[0].startTime,n=e[0].endTime,i=(Date.now()+this.A)/1e3;e=d(e);for(var r=e.next();!r.done;r=e.next())r=r.value,i<r.startTime||(t=Math.min(t,r.startTime),n=Math.max(n,r.endTime),this.h=Math.max(this.h,r.endTime-r.startTime));this.pe(t),this.g=Math.max(this.g,n),null!=this.i&&this.F&&!this.u&&(this.i=i-this.g-this.h)}},i.ih=function(e,t){this.pe(e),1/0==t||this.U()||(this.g=Math.max(this.g,t))},i.wi=function(){return this.g},i.ke=function(){this.u=!0},i.Wi=function(){return this.u},i.wh=function(e){this.m=e},i.ri=function(){return this.m},i.pe=function(e){null==this.j?this.j=e:this.I||(this.j=Math.min(this.j,e))},i.Tf=function(e){this.h=Math.max(this.h,e)},i.offset=function(e){null!=this.j&&(this.j+=e),null!=this.g&&(this.g+=e)},i.U=function(){return 1/0==this.l&&!this.B},i.wc=function(){return 1/0!=this.l&&!this.B},i.nb=function(){return Math.max(this.H,this.bc()-this.o)},i.Ah=function(e){this.H=e},i.bc=function(){return this.U()||this.wc()?Math.min(Math.max(0,(Date.now()+this.A)/1e3-this.h-this.i)+this.G,this.l):this.g?Math.min(this.g,this.l):this.l},i.od=function(e){var t=Math.max(this.j,this.H);return 1/0==this.o?Math.ceil(1e3*t)/1e3:Math.max(t,Math.min(this.bc()-this.o+e,this.mb()))},i.Fb=function(){return this.od(0)},i.mb=function(){return Math.max(0,this.bc()-(this.U()||this.wc()?this.C:0))},i.Jh=function(){return!(null==this.i||null!=this.g&&this.F)},i.uh=function(e){this.G=e},i.hi=function(){return this.G},K("shaka.media.PresentationTimeline",Ul),Ul.prototype.getAvailabilityTimeOffset=Ul.prototype.hi,Ul.prototype.setAvailabilityTimeOffset=Ul.prototype.uh,Ul.prototype.usingPresentationStartTime=Ul.prototype.Jh,Ul.prototype.getSeekRangeEnd=Ul.prototype.mb,Ul.prototype.getSeekRangeStart=Ul.prototype.Fb,Ul.prototype.getSafeSeekRangeStart=Ul.prototype.od,Ul.prototype.getSegmentAvailabilityEnd=Ul.prototype.bc,Ul.prototype.setUserSeekStart=Ul.prototype.Ah,Ul.prototype.getSegmentAvailabilityStart=Ul.prototype.nb,Ul.prototype.isInProgress=Ul.prototype.wc,Ul.prototype.isLive=Ul.prototype.U,Ul.prototype.offset=Ul.prototype.offset,Ul.prototype.notifyMaxSegmentDuration=Ul.prototype.Tf,Ul.prototype.notifyMinSegmentStartTime=Ul.prototype.pe,Ul.prototype.getInitialProgramDateTime=Ul.prototype.ri,Ul.prototype.setInitialProgramDateTime=Ul.prototype.wh,Ul.prototype.isStartTimeLocked=Ul.prototype.Wi,Ul.prototype.lockStartTime=Ul.prototype.ke,Ul.prototype.getMaxSegmentEndTime=Ul.prototype.wi,Ul.prototype.notifyPeriodDuration=Ul.prototype.ih,Ul.prototype.notifySegments=Ul.prototype.Cd,Ul.prototype.notifyTimeRange=Ul.prototype.jh,Ul.prototype.getDelay=Ul.prototype.li,Ul.prototype.setDelay=Ul.prototype.jg,Ul.prototype.getSegmentAvailabilityDuration=Ul.prototype.ce,Ul.prototype.setSegmentAvailabilityDuration=Ul.prototype.De,Ul.prototype.setStatic=Ul.prototype.Ec,Ul.prototype.setClockOffset=Ul.prototype.vh,Ul.prototype.getPresentationStartTime=Ul.prototype.Bi,Ul.prototype.setDuration=Ul.prototype.$a,Ul.prototype.setPresentationStartTime=Ul.prototype.xh,Ul.prototype.getMaxSegmentDuration=Ul.prototype.vi,Ul.prototype.getDuration=Ul.prototype.getDuration,Fl.prototype.release=function(){this.o&&(this.o.release(),this.o=null),null!=this.i&&(this.i.stop(),this.i=null),this.m&&(this.m.release(),this.m=null),this.g=this.B=this.u=null},Fl.prototype.se=function(){this.A=!0,this.i&&this.i.ua(this.h.gapJumpTimerTime),Bl(this)},$l.prototype.release=function(){this.i=this.j=null};var Kl=new Ge((function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])}));function Wl(e,t,n,i){var r=this;this.g=e,this.m=t,this.u=n,this.l=null,this.j=function(){return null==r.l&&(r.l=i()),r.l},this.o=!1,this.h=new ae,this.i=new Ql(e),Hl(this.g,HTMLMediaElement.HAVE_METADATA,this.h,(function(){Xl(r,r.j())}))}function ql(e){return e.o?e.g.currentTime:e.j()}function Yl(e,t){0<e.g.readyState?Jl(e.i,t):Hl(e.g,HTMLMediaElement.HAVE_METADATA,e.h,(function(){Xl(e,e.j())}))}function Xl(e,t){.001>Math.abs(e.g.currentTime-t)?zl(e):(e.h.qa(e.g,"seeking",(function(){zl(e)})),Jl(e.i,e.g.currentTime&&0!=e.g.currentTime?e.g.currentTime:t))}function zl(e){e.o=!0,e.h.D(e.g,"seeking",(function(){return e.m()})),e.u(e.g.currentTime)}function Ql(e){var t=this;this.g=e,this.m=10,this.j=this.l=this.i=0,this.h=new ze((function(){0>=t.i||t.g.currentTime!=t.l||t.g.currentTime===t.j?t.h.stop():(t.g.currentTime=t.j,t.i--)}))}function Jl(e,t){e.l=e.g.currentTime,e.j=t,e.i=e.m,e.g.currentTime=t,e.h.ua(.1)}function Zl(e){this.h=e,this.j=!1,this.g=null,this.i=new ae}function ec(e,t,n,i,r,s){var a=this;this.i=e,this.g=t.presentationTimeline,this.l=n,this.u=r,this.o=null,this.j=new Fl(e,t.presentationTimeline,n,s),this.h=new Wl(e,(function(){e:{var e=a.j;e.l=!0,e.A=!1,e.i&&e.i.ua(e.h.gapJumpTimerTime),Bl(e);var t=ql(a.h);if(e=nc(a,t),!rn()&&.001<Math.abs(e-t)){if(t=!1,!st()||st()&&pt())t=!0;else{var n=Date.now()/1e3,i=st()&&gt()?3:1;(!a.o||a.o<n-i)&&(a.o=n,t=!0)}if(t){Yl(a.h,e),e=void 0;break e}}a.u(),e=void 0}return e}),(function(e){var t=a.j;t.g.seeking&&!t.l&&(t.l=!0,t.j=e),t.i&&t.i.ua(t.h.gapJumpTimerTime),Bl(t)}),(function(){var e=i;return null==e?e=1/0>a.g.getDuration()?a.g.Fb():a.g.mb():0>e&&(e=a.g.mb()+e),tc(a,ic(a,e))})),this.m=new ze((function(){if(0!=a.i.readyState&&!a.i.paused){var e=ql(a.h),t=a.g.Fb(),n=a.g.mb();3>n-t&&(t=n-3),e<t&&(e=nc(a,e),a.i.currentTime=e)}}))}function tc(e,t){var n=e.g.getDuration();return t>=n?n-e.l.durationBackoff:t}function nc(e,t){var n=e.l.rebufferingGoal,i=e.l.safeSeekOffset,r=e.g.Fb(),s=e.g.mb(),a=e.g.getDuration();3>s-r&&(r=s-3);var o=e.g.od(n),u=e.g.od(i);return n=e.g.od(n+i),t>=a?tc(e,t):t>s?s-e.l.safeSeekEndOffset:t<r?pu(e.i.buffered,u)?u:n:t>=o||pu(e.i.buffered,t)?t:n}function ic(e,t){var n=e.g.Fb();return t<n?n:(e=e.g.mb(),t>e?e:t)}function rc(e){this.g=e,this.m=null,this.i=0,this.o=!1}function sc(e){return e.g[0]||null}function ac(e,t,n){return e=new uu(e,e+t,(function(){return n}),0,null,null,e,e,e+t),new rc([e])}function oc(e,t,n,i){this.i=e,this.h=t,this.g=n,this.reverse=i}function uc(){rc.call(this,[]),this.h=[]}function lc(e){var t=this;this.g=e,this.j=!1,this.i=this.g.be(),this.h=new ze((function(){t.g.fh(.25*t.i)}))}function cc(e){e.h.stop();var t=e.j?0:e.i;if(0<=t)try{return void(e.g.be()!=t&&e.g.mg(t))}catch(n){}e.h.ua(.25),0!=e.g.be()&&e.g.mg(0)}function dc(e){var t=this;this.j=e,this.h=new ae,this.g=new Set,this.i=new ze((function(){hc(t,!1)})).qb(),e.paused||this.i.ua(.25),this.h.D(e,"playing",(function(){t.i.qb().ua(.25)})),this.h.D(e,"pause",(function(){t.i.stop()}))}function hc(e,t){var n=e.j.currentTime;e=d(e.g);for(var i=e.next();!i.done;i=e.next())i.value.j(n,t)}function fc(e){Rs.call(this),this.g=new Map,this.h=e}function pc(e,t){var n=e.g.get(t);return n||(n={Id:[],mf:null,contentType:t},e.g.set(t,n)),n}function gc(e,t,n){var i=pc(e,t.contentType);vc(e,i),e={Uc:t,position:n},i=i.Id,t=i.findIndex((function(e){return e.position>=n})),0<=t?i.splice(t,i[t].position==n?1:0,e):i.push(e)}function mc(e,t,n){return!!((e=e.h()[n])&&0<e.length&&(n=e[e.length-1].end,t>=e[0].start&&t<n))}function vc(e,t){if((e=e.h()[t.contentType])&&0<e.length){var n=e[0].start,i=e[e.length-1].end,r=t.Id;t.Id=r.filter((function(e,t){return!(e.position<=n&&t+1<r.length&&r[t+1].position<=n||e.position>=i)}))}else t.Id=[]}function yc(e){var t={bandwidth:e.bandwidth||0,audioSamplingRate:null,codecs:e.codecs,contentType:e.type,frameRate:null,height:null,mimeType:e.mimeType,channelsCount:null,pixelAspectRatio:null,width:null,label:null,roles:e.roles,language:null};return"video"==e.type&&(t.frameRate=e.frameRate||null,t.height=e.height||null,t.pixelAspectRatio=e.pixelAspectRatio||null,t.width=e.width||null),"audio"==e.type&&(t.audioSamplingRate=e.audioSamplingRate,t.channelsCount=e.channelsCount,t.label=e.label||null,t.language=e.language),t}function bc(e){Rs.call(this),this.h=new Map,this.i=e,this.g=null}function Tc(e,t){var n=t.schemeIdUri+"_"+t.id+"_"+t.startTime.toFixed(1)+"_"+t.endTime.toFixed(1);e.h.has(n)||(e.h.set(n,t),t=new Is("regionadd",new Map([["region",t]])),e.dispatchEvent(t),Sc(e))}function Sc(e){e.g||(e.g=new ze((function(){for(var t=e.i(),n=d(e.h),i=n.next();!i.done;i=n.next()){var r=d(i.value);i=r.next().value,r=r.next().value,r.endTime<t.start&&(e.h.delete(i),i=new Is("regionremove",new Map([["region",r]])),e.dispatchEvent(i))}!e.h.size&&e.g&&(e.g.stop(),e.g=null)})).ua(2))}function Ec(e,t,n,i){this.m=e,this.i=t,this.l=n,this.h=new Map,this.j=new Map,this.g=null,this.o=i}function wc(e,t){e.l=t,e=d(e.h.values());for(var n=e.next();!n.done;n=e.next())n.value.g=t}function Ac(e,t,n){if(n=void 0!==n&&n,!e.i.segmentIndex)return Promise.resolve();if(e.g||(e.g=e.i.segmentIndex.Eb(t,!0,e.o)),!e.g)return Promise.resolve();for(n&&e.g.next(),t=[];e.h.size<e.m;){if(n=e.g.next().value,!n)break;var i=!0;n.isPreload()&&null!=n.endByte&&(i=!1),2==n.dc()&&(i=!1),n.Gb(!1)&&(i=!1),i&&n.Y&&t.push(xc(e,n.Y)),i&&!e.h.has(n)&&(i=new Mc(e.l),t.push(Pc(i,n,e.i)),e.h.set(n,i))}return Lc(e),Promise.all(t)}function xc(e,t){if(!e.i.segmentIndex||t.Gb()||Array.from(e.j.keys()).some((function(e){return ou(e,t)})))return Promise.resolve();var n=new Mc(e.l),i=Pc(n,t,e.i);return e.j.set(t,n),i}function Ic(e,t){t=d(t.keys());for(var n=t.next();!n.done;n=t.next())(n=n.value)&&Dc(e,n)}function kc(e){Ic(e,e.h),Ic(e,e.j),e.g=null}function Lc(e){for(var t=Array.from(e.h.keys()),n=d(e.j.keys()),i=n.next(),r={};!i.done;r={Nf:void 0},i=n.next())r.Nf=i.value,t.some(function(e){return function(t){return ou(t.Y,e.Nf)}}(r))||Dc(e,r.Nf)}function Rc(e,t){e.m=t;for(var n=Array.from(e.h.keys());n.length>t;){var i=n.pop();i&&Dc(e,i)}Lc(e)}function Cc(e,t){t&&t!==e.i&&(kc(e),e.i=t)}function Dc(e,t){var n=e.h;t instanceof au&&(n=e.j),e=n.get(t),n.delete(t),e&&e.abort()}function Mc(e){this.g=e,this.Ed=this.pg=null}function Pc(e,t,n){var i=new Uint8Array(0);return e.Ed=e.g(t,n,(function(t){return U((function(n){if(1==n.g)return i=0<i.byteLength?jt(i,t):t,e.pg?w(n,e.pg(i),3):n.s(0);i=new Uint8Array(0),A(n)}))})),e.Ed.promise.catch((function(e){return e instanceof je&&7001==e.code?Promise.resolve():Promise.reject(e)}))}function _c(e){var t=Zi(e),n=t.split("/")[0];return e=er(e),{type:n,mimeType:t,codecs:e,language:null,height:null,width:null,channelCount:null,sampleRate:null,closedCaptions:new Map,Md:null,colorGamut:null,frameRate:null}}function Oc(e,t,n){function i(e){a=e.name;var t=e.reader;t.skip(24);var n=t.ma(),i=t.ma();t.skip(50),p=String(n),f=String(i),e.reader.ta()&&ta(e)}function r(e){var t=So(e.reader);g=t.channelCount,m=t.sampleRate,s(e.name)}function s(e){switch(e=e.toLowerCase(),e){case"avc1":case"avc3":u.push(e+".42E01E"),c=!0;break;case"hev1":case"hvc1":u.push(e+".1.6.L93.90"),c=!0;break;case"dvh1":case"dvhe":u.push(e+".05.04"),c=!0;break;case"vp09":u.push(e+".00.10.08"),c=!0;break;case"av01":u.push(e+".0.01M.08"),c=!0;break;case"mp4a":o.push("mp4a.40.2"),l=!0;break;case"ac-3":case"ec-3":case"ac-4":case"opus":case"flac":o.push(e),l=!0}}var a,o=[],u=[],l=!1,c=!1,h=null,f=null,p=null,g=null,m=null,v=null,y=null;if((new ea).box("moov",ta).box("trak",ta).box("mdia",ta).R("mdhd",(function(e){h=bo(e.reader,e.version).language})).box("minf",ta).box("stbl",ta).R("stsd",na).box("mp4a",(function(e){var t=So(e.reader);g=t.channelCount,m=t.sampleRate,e.reader.ta()?ta(e):s(e.name)})).box("esds",(function(e){e=e.reader;for(var t,n,i="mp4a";e.ta();){t=e.X();for(var r=e.X();128&r;)r=e.X();if(3==t)e.ma(),r=e.X(),128&r&&e.ma(),64&r&&e.skip(e.X()),32&r&&e.ma();else if(4==t)n=e.X(),e.skip(12);else if(5==t)break}n&&(i+="."+Ao(n),5==t&&e.ta()&&(t=e.X(),n=(248&t)>>3,31===n&&e.ta()&&(n=32+((7&t)<<3)+((224&e.X())>>5)),i+="."+n)),o.push(i),l=!0})).box("ac-3",r).box("ec-3",r).box("ac-4",r).box("Opus",r).box("fLaC",r).box("avc1",i).box("avc3",i).box("hev1",i).box("hvc1",i).box("dva1",i).box("dvav",i).box("dvh1",i).box("dvhe",i).box("vp09",i).box("av01",i).box("avcC",(function(e){var t=a||"";switch(a){case"dvav":t="avc3";break;case"dva1":t="avc1"}e=e.reader,e.skip(1),e=t+"."+Ao(e.X())+Ao(e.X())+Ao(e.X()),u.push(e),c=!0})).box("hvcC",(function(e){var t=a||"";switch(a){case"dvh1":t="hvc1";break;case"dvhe":t="hev1"}var n=e.reader;n.skip(1),e=n.X();var i=["","A","B","C"][e>>6],r=31&e,s=n.S(),o=(32&e)>>5?"H":"L";e=[n.X(),n.X(),n.X(),n.X(),n.X(),n.X()],n=n.X();for(var l=0,d=0;32>d;d++){if(l|=1&s,31==d)break;l<<=1,s>>=1}for(t=t+"."+i+r+"."+Ao(l,!0),t+="."+o+n,i="",r=e.length;r--;)((o=e[r])||i)&&(i="."+o.toString(16).toUpperCase()+i);t+=i,u.push(t),c=!0})).box("dvcC",(function(e){var t=a||"";switch(a){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav";break;case"av01":t="dav1"}var n=e.reader;n.skip(2),e=n.X(),n=n.X(),u.push(t+"."+xo(e>>1&127)+"."+xo(e<<5&32|n>>3&31)),c=!0})).box("dvvC",(function(e){var t=a||"";switch(a){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav";break;case"av01":t="dav1"}var n=e.reader;n.skip(2),e=n.X(),n=n.X(),u.push(t+"."+xo(e>>1&127)+"."+xo(e<<5&32|n>>3&31)),c=!0})).R("vpcC",(function(e){var t=a||"",n=e.reader;e=n.X();var i=n.X();n=n.X()>>4&15,u.push(t+"."+xo(e)+"."+xo(i)+"."+xo(n)),c=!0})).box("av1C",(function(e){var t=a||"";switch(a){case"dav1":t="av01"}var n=e.reader;n.skip(1),e=n.X(),n=n.X();var i=e>>>5,r=(64&n)>>6;u.push(t+"."+i+"."+xo(31&e)+(n>>>7?"H":"M")+"."+xo(2===i&&r?(32&n)>>5?12:10:r?10:8)+"."+((16&n)>>4)+"."+((8&n)>>3)+((4&n)>>2)+(3&n)+"."+xo(1)+"."+xo(1)+"."+xo(1)+".0"),c=!0})).box("enca",ra).box("encv",ia).box("sinf",ta).box("frma",(function(e){e=Eo(e.reader).codec,s(e)})).box("colr",(function(e){u=u.map((function(t){if(t.startsWith("av01.")){var n=e.reader,i=n.Aa(),r=n.Cb(4),s=String.fromCharCode(r[0]);if(s+=String.fromCharCode(r[1]),s+=String.fromCharCode(r[2]),s+=String.fromCharCode(r[3]),"nclx"===s){r=n.ma(),s=n.ma();var a=n.ma(),o=n.X()>>7,u=t.split(".");10==u.length&&(u[6]=xo(r),u[7]=xo(s),u[8]=xo(a),u[9]=String(o),t=u.join("."))}n.seek(i)}return t}));var t=wo(e.reader),n=t.colorGamut;v=t.Md,y=n})).parse(e||t,!0),!o.length&&!u.length)return null;var b=l&&!c,T=new Map;if(c&&!n){n=new ln("video/mp4"),e&&n.init(e);try{n.i(t);for(var S=d(n.j()),E=S.next();!E.done;E=S.next()){var w=E.value;T.set(w,w)}}catch(A){}n.g()}return{type:b?"audio":"video",mimeType:b?"audio/mp4":"video/mp4",codecs:Nc(o.concat(u)).join(", "),language:h,height:f,width:p,channelCount:g,sampleRate:m,closedCaptions:T,Md:v,colorGamut:y,frameRate:null}}function Nc(e){var t=new Set,n=[];e=d(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;var r=Ji(i);t.has(r)||(n.push(i),t.add(r))}return t=Wt("audio",n),i=Wt("video",n),e=Wt(qt,n),i=Uc(i),t=t.concat(i).concat(e),n.length&&!t.length?n:t}function Uc(e){if(1>=e.length)return e;var t=e.find((function(e){return e.startsWith("dvav.")||e.startsWith("dva1.")||e.startsWith("dvh1.")||e.startsWith("dvhe.")||e.startsWith("dav1.")||e.startsWith("dvc1.")||e.startsWith("dvi1.")}));return t?tn('video/mp4; codecs="'+t+'"')?[t]:e.filter((function(e){return e!=t})):e}function Fc(e){var t=null;return(new ea).box("moov",ta).box("trak",ta).box("mdia",ta).box("minf",ta).box("stbl",ta).R("stsd",na).box("encv",ia).box("enca",ra).box("sinf",ta).box("schi",ta).R("tenc",(function(e){e=e.reader,e.X(),e.X(),e.X(),e.X(),t=Bt(e.Cb(16))})).parse(e,!0),t}function Bc(t,n,i){var r,s,a,o,u;return U((function(l){if(1==l.g)return r=n,r.cryptoKey?l.s(2):w(l,r.fetchKey(),3);if(s=r.iv,!s)for(s=Ne(new ArrayBuffer(16)),a=r.firstMediaSequenceNumber+i,o=s.byteLength-1;0<=o;o--)s[o]=255&a,a>>=8;return u="CBC"==n.blockCipherMode?{name:"AES-CBC",iv:s}:{name:"AES-CTR",counter:s,length:64},l.return(e.crypto.subtle.decrypt(u,r.cryptoKey,t))}))}function jc(e,t,n,i,r){return e=Os(e,i,r),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function $c(e,t){var n=this;this.g=t,this.j=e,this.h=null,this.K=new Map,this.C=1,this.u=this.l=null,this.O=0,this.i=new Map,this.I=!1,this.P=null,this.B=!1,this.m=new Ks((function(){return Gc(n)})),this.L=Date.now()/1e3,this.o=new Map,this.M={projection:null,hfov:null},this.W=0,this.T=1/0,this.F=null,this.A=new ze((function(){if(n.j&&n.g)if(n.j.presentationTimeline.U()){var e=n.j.presentationTimeline.Fb(),t=n.j.presentationTimeline.mb();1<t-e?yl(n.g.aa,e,t):bl(n.g.aa)}else bl(n.g.aa),n.A&&n.A.stop();else n.A&&n.A.stop()})),this.G=null,this.H=new ze((function(){var e=n.g.video;!e.ended&&n.G&&(e.currentTime=n.G,n.G=null)}))}function Gc(e){var t,n,i,r,s,a,o;return U((function(u){if(1==u.g){for(e.A&&e.A.stop(),e.A=null,e.H&&e.H.stop(),e.H=null,t=[],n=d(e.i.values()),i=n.next();!i.done;i=n.next())r=i.value,bd(r),t.push(Td(r)),r.ba&&(kc(r.ba),r.ba=null);for(s=d(e.o.values()),a=s.next();!a.done;a=s.next())o=a.value,kc(o);return w(u,Promise.all(t),2)}e.i.clear(),e.o.clear(),e.g=null,e.j=null,e.h=null,e.G=null,A(u)}))}function Vc(e,t,n){e.j.presentationTimeline.U()||(e.W=t,e.T=n)}function Hc(e,t){var n,i,r,s,a,o;U((function(u){switch(u.g){case 1:return n=Yt,e.O++,i=e.O,x(u,2),w(u,gl(e.g.aa,n.va),4);case 4:k(u,3);break;case 2:r=L(u),e.g&&e.g.onError(r);case 3:s=Wi(t.mimeType,t.codecs),rl(e.g.aa,s,e.j.sequenceMode,t.external),a=e.g.aa.ea,(a.isTextVisible()||e.h.alwaysStreamText)&&e.O==i&&(o=ed(e,t),e.i.set(n.va,o),yd(e,o,0)),A(u)}}))}function Kc(e){var t=e.i.get(qt);t&&(bd(t),Td(t).catch((function(){})),e.F=e.i.get(qt),e.i.delete(qt)),e.u=null}function Wc(e,t){for(var n=0>e.g.eb(),i=d(e.i.values()),r=i.next();!r.done;r=i.next())r=r.value,r.ja&&r.ja.cd(n),r.ba&&r.ba.cd(n);for(i=d(e.o.values()),r=i.next();!r.done;r=i.next())r.value.cd(n);(n=e.i.get("video"))&&(i=n.stream)&&(t?(t=i.trickModeVideo)&&!n.fc&&(zc(e,t,!1,0,!1),n.fc=i):(t=n.fc)&&(n.fc=null,zc(e,t,!0,0,!1)))}function qc(e,t,n,i,r,s){n=void 0!==n&&n,i=void 0===i?0:i,r=void 0!==r&&r,s=void 0!==s&&s,e.l=t,e.I&&(t.video&&zc(e,t.video,n,i,r,s),t.audio&&zc(e,t.audio,n,i,r,s))}function Yc(e,t){U((function(n){if(1==n.g)return e.F=null,e.u=t,e.I?t.segmentIndex?n.s(2):w(n,t.createSegmentIndex(),2):n.return();zc(e,t,!0,0,!1),A(n)}))}function Xc(e,t){for(var n=d(e.K.entries()),i=n.next();!i.done;i=n.next()){var r=d(i.value);i=r.next().value,r=r.next().value,i.includes(t.type)&&(r(),e.K.delete(i))}}function zc(e,t,n,i,r,s){var a=e.i.get(t.type);a||t.type!=qt?a&&(a.fc&&(t.trickModeVideo?(a.fc=t,t=t.trickModeVideo):a.fc=null),a.stream!=t||r)&&(e.o.has(t)?a.ba=e.o.get(t):a.ba&&Cc(a.ba,t),t.type==qt&&(r=Wi(t.mimeType,t.codecs),rl(e.g.aa,r,e.j.sequenceMode,t.external)),!e.o.has(a.stream)&&a.stream.closeSegmentIndex&&(a.Ca?(r="("+a.type+":"+a.stream.id+")",e.K.has(r)||e.K.set(r,a.stream.closeSegmentIndex)):a.stream.closeSegmentIndex()),r=a.stream.isAudioMuxedInVideo!=t.isAudioMuxedInVideo,a.stream=t,a.ja=null,a.bf=!!s,t.dependencyStream?a.ld=ed(e,t.dependencyStream):a.ld=null,r?Ed(e,!0,!1):(n?a.nc?a.Se=!0:a.Ca?(a.lc=!0,a.Wd=i,a.Se=!0):(bd(a),vd(e,a,!0,i).catch((function(t){e.g&&e.g.onError(t)}))):a.Ca||a.ib||yd(e,a,0),Qc(e,a).catch((function(t){e.g&&e.g.onError(t)})))):Hc(e,t)}function Qc(e,t){var n,i;return U((function(r){if(1==r.g)return t.pb?(n=t.stream,i=t.pb,n.segmentIndex?r.s(2):w(r,n.createSegmentIndex(),2)):r.return();if(t.pb!=i||t.stream!=n)return r.return();var s=e.g.Pc(),a=ul(e.g.aa,t.type),o=t.stream.segmentIndex.find(t.xa?t.xa.endTime:s),u=null==o?null:t.stream.segmentIndex.get(o);o=u&&u.endByte?u.endByte-u.startByte:null,u&&!o&&(o=(u.endTime-u.getStartTime())*(t.stream.bandwidth||0)/8),o?((u=u.Y)&&(o+=(u.endByte?u.endByte-u.startByte:null)||0),u=e.g.getBandwidthEstimate(),s=8*o/u<(a||0)-s-e.h.rebufferingGoal||t.pb.h.g>o):s=!1,s&&t.pb.abort(),A(r)}))}function Jc(e,t){t.nc||t.lc||(t.Ca?(t.lc=!0,t.Wd=0):null==ol(e.g.aa,t.type)?null==t.ib&&yd(e,t,0):(bd(t),vd(e,t,!1,0).catch((function(t){e.g&&e.g.onError(t)}))))}function Zc(e,t){var n,i,r,s,a,o,u,l,c,h;return U((function(f){if(1==f.g){if(n=Yt,!e.l)throw new je(2,5,5006);return i=new Map,r=new Set,e.l.audio&&(i.set(n.V,e.l.audio),r.add(e.l.audio)),e.l.video&&(i.set(n.la,e.l.video),r.add(e.l.video)),e.u&&(i.set(n.va,e.u),r.add(e.u)),s=e.g.aa,w(f,s.init(i,e.j.sequenceMode,e.j.type,e.j.ignoreManifestTimestampsInSegmentsMode),2)}for(Ws(e.m),e.updateDuration(),a=d(i.keys()),o=a.next();!o.done;o=a.next())u=o.value,l=i.get(u),e.i.has(u)||(c=ed(e,l),t.has(l.id)&&(h=t.get(l.id),wc(h,(function(t,n,i){return md(t,n,i||null,e.h.retryParameters,e.g.Vb)})),c.ba=h),e.i.set(u,c),yd(e,c,0));A(f)}))}function ed(e,t){var n={stream:t,type:t.type,ja:null,ba:td(e,t),xa:null,yb:null,je:null,yc:null,xc:null,he:null,ie:null,fc:null,endOfStream:!1,Ca:!1,ib:null,lc:!1,Wd:0,Se:!1,nc:!1,Dc:!0,bf:!1,bg:!1,qd:!1,pb:null,ld:null};return t.dependencyStream&&(n.ld=ed(e,t.dependencyStream)),n}function td(e,t){if("video"===t.type&&e.h.disableVideoPrefetch||"audio"===t.type&&e.h.disableAudioPrefetch||t.type===qt&&("application/cea-608"==t.mimeType||"application/cea-708"==t.mimeType)||t.type===qt&&e.h.disableTextPrefetch)return null;if(e.o.has(t))return e.o.get(t);var n=e.i.get(t.type);return(n=n&&n.ba)&&t===n.i?n:0<e.h.segmentPrefetchLimit?new Ec(e.h.segmentPrefetchLimit,t,(function(t,n,i){return md(t,n,i||null,e.h.retryParameters,e.g.Vb)}),0>e.g.eb()):null}function nd(e){for(var t=e.h.segmentPrefetchLimit,n=e.h.prefetchAudioLanguages,i=d(e.j.variants),r=i.next(),s={};!r.done;s={ub:void 0},r=i.next())if(s.ub=r.value,s.ub.audio)if(e.o.has(s.ub.audio)){if(r=e.o.get(s.ub.audio),Rc(r,t),!(0<t&&n.some(function(e){return function(t){return Tr(e.ub.audio.language,t)}}(s)))){var a=e.i.get(s.ub.audio.type);r!==(a&&a.ba)&&kc(r),e.o.delete(s.ub.audio)}}else 0>=t||!n.some(function(e){return function(t){return Tr(e.ub.audio.language,t)}}(s))||!(r=td(e,s.ub.audio))||(s.ub.audio.segmentIndex||s.ub.audio.createSegmentIndex(),e.o.set(s.ub.audio,r))}function id(e,t){var n,i,r,s,a,o;return U((function(u){switch(u.g){case 1:if(Ws(e.m),t.Ca||null==t.ib||t.nc)return u.return();if(t.ib=null,!t.lc){u.s(2);break}return w(u,vd(e,t,t.Se,t.Wd),3);case 3:return u.return();case 2:if(Xc(e,t),t.stream.segmentIndex){u.s(4);break}return n=t.stream,x(u,5),w(u,t.stream.createSegmentIndex(),7);case 7:k(u,6);break;case 5:return i=L(u),w(u,Sd(e,t,i),8);case 8:return u.return();case 6:if(n!=t.stream)return n.closeSegmentIndex&&n.closeSegmentIndex(),t.Ca||t.ib||yd(e,t,0),u.return();case 4:x(u,9),r=rd(e,t),null!=r&&(yd(e,t,r),t.qd=!1),k(u,10);break;case 9:return s=L(u),w(u,Sd(e,t,s),11);case 11:return u.return();case 10:if(a=Array.from(e.i.values()),!e.I||!a.every((function(e){return e.endOfStream}))){u.s(0);break}return w(u,e.g.aa.endOfStream(),13);case 13:Ws(e.m),o=e.g.aa.getDuration(),0!=o&&o<e.j.presentationTimeline.getDuration()&&e.j.presentationTimeline.$a(o),A(u)}}))}function rd(e,t){if(pd(t))return fl(e.g.aa,t.stream.originalId||""),null;if(t.type==qt&&pl(e.g.aa),t.stream.isAudioMuxedInVideo)return null;var n=e.h.updateIntervalSeconds/Math.max(1,Math.abs(e.g.eb()));if(!il(e.g.aa)&&t.type!=qt)return n/2;var i=e.g.Pc();if("audio"===t.type)for(var r=d(e.o.keys()),s=r.next();!s.done;s=r.next())s=e.o.get(s.value),s.Na(i,!0),Ac(s,i);r=t.xa?t.xa.endTime:i;var a=ll(e.g.aa,t.type,i),o=Math.max(1,Math.max(e.h.rebufferingGoal,e.h.bufferingGoal)*e.C),u=e.j.presentationTimeline.getDuration()-r;if(s=ul(e.g.aa,t.type),1e-6>u&&s)return t.endOfStream=!0,"video"==t.type&&(e=e.i.get(qt))&&pd(e)&&(e.endOfStream=!0),null;if(t.endOfStream=!1,a>=o)return n/2;if(o=!t.ja,s=sd(e,t,i,s),!s)return n;a=!1,o&&t.bf&&(a=!0,t.bf=!1),o=1/0,u=Array.from(e.i.values()),u=d(u);for(var l=u.next();!l.done;l=u.next())l=l.value,pd(l)||l.ja&&!l.ja.current()||(o=Math.min(o,l.xa?l.xa.endTime:i));return r>=o+e.j.presentationTimeline.h?n:("keep"!==e.h.crossBoundaryStrategy&&xd(e,t,s)||(t.ba&&t.ja&&!e.o.has(t.stream)&&(t.ba.Na(s.startTime+.001),Ac(t.ba,s.startTime).catch((function(){}))),ad(e,t,i,s,a).catch((function(){})),t.ld&&od(e,t.ld,i)),null)}function sd(e,t,n,i){if(t.ja)return(n=t.ja.current())&&t.xa&&.001>Math.abs(t.xa.startTime-n.startTime)&&(n=t.ja.next().value),n;if(t.xa||i)return n=t.xa?t.xa.endTime:i,e=0>e.g.eb(),t.stream.segmentIndex&&(t.ja=t.stream.segmentIndex.Eb(n,!1,e)),t.ja&&t.ja.next().value;i=e.j.sequenceMode?0:e.h.inaccurateManifestTolerance;var r=Math.max(n-i,0);e=0>e.g.eb();var s=null;return i&&(t.stream.segmentIndex&&(t.ja=t.stream.segmentIndex.Eb(r,!1,e)),s=t.ja&&t.ja.next().value),s||(t.stream.segmentIndex&&(t.ja=t.stream.segmentIndex.Eb(n,!1,e)),s=t.ja&&t.ja.next().value),s}function ad(t,n,i,r,s){var a,o,u,l,c,d,h,f,p,g,m,v,y,b,T,S,E;return U((function(I){switch(I.g){case 1:if(a=Yt,o=n.stream,u=n.ja,n.Ca=!0,x(I,2),2==r.dc())throw new je(1,1,1011);return w(I,cd(t,n,r,s),4);case 4:return Ws(t.m),t.B?I.return():(l="video/mp4"==o.mimeType||"audio/mp4"==o.mimeType,c=e.ReadableStream,t.h.lowLatencyMode&&t.j.isLowLatency&&c&&l&&("HLS"!=t.j.type||r.m)?(f=new Uint8Array(0),g=p=!1,v=function(e){var a,u,l;return U((function(c){switch(c.g){case 1:if(p)return c.return();if(g=!0,Ws(t.m),t.B)return c.return();if(x(c,2),f=ud(f,e),a=!1,u=0,(new ea).box("mdat",(function(e){u=e.size+e.start,a=!0})).parse(f,!1,!0),!a){c.s(4);break}return l=f.subarray(0,u),f=f.subarray(u),w(c,hd(t,n,i,o,r,l,!0,s),5);case 5:n.ba&&n.ja&&Ac(n.ba,r.startTime,!0);case 4:k(c,0);break;case 2:m=L(c),A(c)}}))},w(I,gd(t,n,r,v),9)):(d=gd(t,n,r),w(I,d,7)));case 7:return h=I.h,Ws(t.m),t.B?I.return():(Ws(t.m),n.lc?(n.Ca=!1,yd(t,n,0),I.return()):w(I,hd(t,n,i,o,r,h,!1,s),6));case 9:if(y=I.h,m)throw m;if(g){I.s(10);break}return p=!0,Ws(t.m),t.B?I.return():n.lc?(n.Ca=!1,yd(t,n,0),I.return()):w(I,hd(t,n,i,o,r,y,!1,s),10);case 10:n.ba&&n.ja&&Ac(n.ba,r.startTime,!0);case 6:if(Ws(t.m),t.B)return I.return();n.xa=r,u.next(),n.Ca=!1,n.bg=!1,b=t.g.aa.wb(),T=b[n.type],ne(JSON.stringify(T)),n.lc||(S=null,n.type===a.la?S=t.i.get(a.V):n.type===a.V&&(S=t.i.get(a.la)),S&&S.type==a.V?t.g.se(r,n.stream,S.stream.isAudioMuxedInVideo):t.g.se(r,n.stream,n.stream.codecs.includes(","))),yd(t,n,0),k(I,0);break;case 2:if(E=L(I),Ws(t.m,E),t.B)return I.return();if(n.Ca=!1,7001==E.code)n.Ca=!1,bd(n),yd(t,n,0),I.s(0);else{if(n.type!=a.va||!t.h.ignoreTextStreamFailures)return 3017==E.code?w(I,ld(t,n,E),0):(n.qd=!0,1==E.category&&n.ba&&Dc(n.ba,r),E.severity=2,w(I,Sd(t,n,E),0));t.i.delete(a.va),I.s(0)}}}))}function od(e,t,n){var i,r,s,a,o,u,l,c;U((function(d){switch(d.g){case 1:if(i=t.stream,s=(r=i.segmentIndex.Eb(n))&&r.next().value,!s){d.s(0);break}if(a=s.Y,!a||ou(a,t.yb)){d.s(3);break}return t.yb=a,x(d,4),w(d,gd(e,t,a),6);case 6:o=d.h;var h=e.g.aa;h.K&&Jt(h.K,o,0,i),k(d,3);break;case 4:throw u=L(d),t.yb=null,u;case 3:if(t.xa&&t.xa==s){d.s(0);break}return t.xa=s,x(d,8),w(d,gd(e,t,s),10);case 10:l=d.h,h=e.g.aa,h.K&&Jt(h.K,l,0,i),k(d,0);break;case 8:throw c=L(d),t.xa=null,c}}))}function ud(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function ld(e,t,n){var i,r,s,a;return U((function(o){if(1==o.g){if(i=Array.from(e.i.values()),i.some((function(e){return e!=t&&e.bg})))return o.s(2);if(r=0===e.h.maxDisabledTime&&1011==n.code?1:e.h.maxDisabledTime,e.g.disableStream(t.stream,r))return o.return();if(e.h.avoidEvictionOnQuotaExceededError)return yd(e,t,4),o.return();if(s=Math.round(100*e.C),20<s)e.C-=.2;else{if(!(4<s))return t.qd=!0,e.B=!0,e.g.onError(n),o.return();e.C-=.04}return t.bg=!0,a=e.g.Pc(),w(o,fd(e,t,a),2)}yd(e,t,4),A(o)}))}function cd(e,t,n,i){var r,s,a,o,u,l,c,d,h,f,p,g,m,v,y,b;return U((function(T){switch(T.g){case 1:if(r=Yt,s=null==t.xa,a=[],o=Math.max(0,Math.max(n.appendWindowStart,e.W)-.1),u=Math.min(n.appendWindowEnd,e.T)+.01,l=n.codecs||t.stream.codecs,c=Ji(l),d=Zi(n.mimeType||t.stream.mimeType),h=n.timestampOffset,h==t.je&&o==t.yc&&u==t.xc&&c==t.he&&d==t.ie){T.s(2);break}if(f=t.he&&t.ie&&_l(e.g.aa,t.type,d,l),!f){T.s(3);break}if(p=null,t.type===r.la?p=e.i.get(r.V):t.type===r.V&&(p=e.i.get(r.la)),!p){T.s(3);break}return w(T,Td(p).catch((function(){})),5);case 5:p.yb=null,p.yc=null,p.xc=null,Jc(e,p);case 3:return w(T,dd(e,t,h,o,u,n,c,d),2);case 2:return ou(n.Y,t.yb)||(t.yb=n.Y,n.l&&n.Y&&(g=gd(e,t,n.Y),m=function(){var s,a,o,u,l,c,d;return U((function(h){switch(h.g){case 1:return x(h,2),w(h,g,4);case 4:return s=h.h,Ws(e.m),a=null,o=new Map,u={projection:null,hfov:null},l=new ea,l.box("moov",ta).box("trak",ta).box("mdia",ta).R("mdhd",(function(e){a=bo(e.reader,e.version).timescale})).box("hdlr",(function(e){switch(e=e.reader,e.skip(8),e.Ac()){case"soun":o.set(r.V,a);break;case"vide":o.set(r.la,a)}a=null})).box("minf",ta).box("stbl",ta).R("stsd",na).box("encv",ia).box("avc1",ia).box("avc3",ia).box("hev1",ia).box("hvc1",ia).box("dvav",ia).box("dva1",ia).box("dvh1",ia).box("dvhe",ia).box("dvc1",ia).box("dvi1",ia).box("vexu",ta).box("proj",ta).R("prji",(function(e){e=e.reader.Ac(),u.projection=e})).box("hfov",(function(e){e=e.reader.S()/1e3,u.hfov=e})).parse(s),t.type===r.la&&wd(e,u),o.has(t.type)?n.Y.timescale=o.get(t.type):null!=a&&(n.Y.timescale=a),c=t.stream.closedCaptions&&0<t.stream.closedCaptions.size,w(h,e.g.Fg(t.type,s),5);case 5:return w(h,hl(e.g.aa,t.type,s,null,t.stream,c,t.Dc,i),6);case 6:k(h,0);break;case 2:throw d=L(h),t.yb=null,d}}))},v=n.startTime,s&&(y=ul(e.g.aa,t.type),null!=y&&(v=y)),e.g.fj(v,n.Y),a.push(m()))),b=t.xa?t.xa.i:-1,n.i!=b&&a.push(vl(e.g.aa,t.type,n.startTime)),w(T,Promise.all(a),0)}}))}function dd(e,t,n,i,r,s,a,o){var u,l,c,d;return U((function(h){if(1==h.g)return u=Yt,l=new Map,e.l.audio&&l.set(u.V,e.l.audio),e.l.video&&l.set(u.la,e.l.video),x(h,2),t.yc=i,t.xc=r,a&&(t.he=a),o&&(t.ie=o),t.je=n,c=e.j.sequenceMode||"HLS"==e.j.type,w(h,ml(e.g.aa,t.type,n,i,r,c,s.mimeType||t.stream.mimeType,s.codecs||t.stream.codecs,l),4);if(2!=h.g)return k(h,0);throw d=L(h),t.yc=null,t.xc=null,t.he=null,t.ie=null,t.je=null,d}))}function hd(e,t,n,i,r,s,a,o){var u,l,c,d,h,f;return a=void 0!==a&&a,o=void 0!==o&&o,U((function(p){switch(p.g){case 1:return u=i.closedCaptions&&0<i.closedCaptions.size,e.h.shouldFixTimestampOffset&&(c="video/mp4"==i.mimeType||"audio/mp4"==i.mimeType,d=null,r.Y&&(d=r.Y.timescale),(h=c&&d&&"video"===i.type&&"DASH"==e.j.type)&&(l=new ea),h&&l.box("moof",ta).box("traf",ta).R("tfdt",(function(n){var i,s,a,o,u,l;return U((function(c){return i=yo(n.reader,n.version),s=i.baseMediaDecodeTime,s?(a=-s/d,o=Number(t.je)||0,o<a?(u=t.yc,l=t.xc,w(c,dd(e,t,a,u,l,r),0)):c.s(0)):c.return()}))})),h&&l.parse(s,!1,a)),w(p,fd(e,t,n),2);case 2:return Ws(e.m),f=t.Dc,t.Dc=!1,w(p,e.g.Fg(t.type,s),3);case 3:return w(p,hl(e.g.aa,t.type,s,r,i,u,f,o,a),4);case 4:Ws(e.m),A(p)}}))}function fd(e,t,n){var i,r,s,a,o,u,l,c;return U((function(d){return 1==d.g?(i=t.stream.segmentIndex,i instanceof uc&&i.Na(e.j.presentationTimeline.nb()),r=Math.max(e.h.bufferBehind*e.C,e.j.presentationTimeline.h),s=ol(e.g.aa,t.type),null==s?(e.F==t&&(e.F=null),d.return()):(a=n-s,o=e.h.evictionGoal,u=e.j.presentationTimeline.Fb(),l=e.j.presentationTimeline.mb(),c=a-r,l-u>o&&(c=Math.max(a-r,u-o-s)),c<=o?d.return():w(d,e.g.aa.remove(t.type,s,s+c),2))):4!=d.g?(Ws(e.m),e.F?w(d,fd(e,e.F,n),4):d.s(0)):(Ws(e.m),void A(d))}))}function pd(e){return e&&e.type==qt&&("application/cea-608"==e.stream.mimeType||"application/cea-708"==e.stream.mimeType)}function gd(e,t,n,i){var r,s,a,o,u;return U((function(l){switch(l.g){case 1:if(r=n.Gb())return l.return(r);if(s=null,t.ba){var c=t.ba,d=c.h;n instanceof au&&(d=c.j),d.has(n)?(c=d.get(n),i&&(c.pg=i),s=c.Ed):s=null}return s||(s=md(n,t.stream,i||null,e.h.retryParameters,e.g.Vb)),a=0,t.ja&&(a=t.ja.h),t.pb=s,w(l,s.promise,2);case 2:if(o=l.h,t.pb=null,u=o.data,!n.aesKey){l.s(3);break}return w(l,Bc(u,n.aesKey,a),4);case 4:u=l.h;case 3:return l.return(u)}}))}function md(e,t,n,i,r,s){s=void 0!==s&&s;var a=e instanceof uu?e:void 0,o=a?1:0;return e=jc(e.N(),e.startByte,e.endByte,i,n),e.contentType=t.type,r.request(Gs,e,{type:o,stream:t,segment:a,isPreload:s})}function vd(e,t,n,i){var r,s;return U((function(a){return 1==a.g?(t.lc=!1,t.Se=!1,t.Wd=0,t.nc=!0,t.xa=null,t.ja=null,t.ba&&!e.o.has(t.stream)&&kc(t.ba),i?(r=e.g.Pc(),s=e.g.aa.getDuration(),w(a,e.g.aa.remove(t.type,r+i,s),3)):w(a,gl(e.g.aa,t.type),4)):3!=a.g?(Ws(e.m),n?w(a,e.g.aa.flush(t.type),3):a.s(3)):(Ws(e.m),t.nc=!1,t.endOfStream=!1,t.Ca||t.ib||yd(e,t,0),void A(a))}))}function yd(e,t,n){var i=t.type;(i!=qt||e.i.has(i))&&(t.ib=new Xe((function(){var n;return U((function(i){return 1==i.g?(x(i,2),w(i,id(e,t),4)):2!=i.g?k(i,0):(n=L(i),e.g&&e.g.onError(n),void A(i))}))})).da(n))}function bd(e){null!=e.ib&&(e.ib.stop(),e.ib=null)}function Td(e){return U((function(t){return e.pb?w(t,e.pb.abort(),0):t.s(0)}))}function Sd(e,t,n){var i;return U((function(r){if(1==r.g)return 3024==n.code?(t.Ca=!1,bd(t),yd(e,t,0),r.return()):w(r,ms(e.P),2);if(Ws(e.m),1===n.category&&1003!=n.code){if(t.fc)return Wc(e,!1),r.return();i=0===e.h.maxDisabledTime&&1011==n.code?1:e.h.maxDisabledTime,n.handled=e.g.disableStream(t.stream,i),n.handled&&(n.severity=1)}n.handled&&1011==n.code||e.g.onError(n),n.handled||e.h.failureCallback(n),A(r)}))}function Ed(e,t,n){var i,r,s,a,o,u;return t=void 0!==t&&t,n=void 0===n||n,U((function(l){if(1==l.g){if(i=Date.now()/1e3,r=e.h.minTimeBetweenRecoveries,!t){if(!e.h.allowMediaSourceRecoveries||i-e.L<r)return l.return(!1);e.L=i}return s=Yt,(a=e.i.get(s.V))&&(a.yb=null,a.yc=null,a.xc=null,n&&Jc(e,a),Td(a).catch((function(){})),a.ja&&a.ja.dg()),(o=e.i.get(s.la))&&(o.yb=null,o.yc=null,o.xc=null,n&&Jc(e,o),Td(o).catch((function(){})),o.ja&&o.ja.dg()),u=new Map,e.l.audio&&u.set(s.V,e.l.audio),e.l.video&&u.set(s.la,e.l.video),w(l,Dl(e.g.aa,u),2)}return!o||o.nc||o.Ca||o.ib||yd(e,o,0),!a||a.nc||a.Ca||a.ib||yd(e,a,0),l.return(!0)}))}function wd(e,t){if(e.M.projection!=t.projection||e.M.hfov!=t.hfov){if(null!=t.projection||null!=t.hfov){var n=(new Map).set("detail",t);n=new Is("spatialvideoinfo",n)}else n=new Is("nospatialvideoinfo");n.cancelable=!0,e.g.onEvent(n),e.M=t}}function Ad(e){if("keep"!==e.h.crossBoundaryStrategy){e.H.stop();var t=e.g.Pc(),n=e.i.get("video")||e.i.get("audio");n&&(n=n.yb)&&null!==n.g&&(t=n.g-t,0>t||1<t||(e.G=n.g+.01,e.H.da(t)))}}function xd(e,t,n){if(t.type===qt)return!1;var i=t.yb;if(!i)return!1;n=n.Y;var r=i.g!==n.g;if("reset_to_encrypted"===e.h.crossBoundaryStrategy&&(i.encrypted||n.encrypted||(r=!1),i.encrypted&&(e.h.crossBoundaryStrategy="keep")),"RESET_ON_ENCRYPTION_CHANGE"===e.h.crossBoundaryStrategy&&i.encrypted==n.encrypted&&(r=!1),r&&t.Dc){var s=e.g.video,a=s.paused;Ed(e,!0).then((function(){e.g.onEvent(new Is("boundarycrossed")),a||s.play()}))}return r}function Id(){}function kd(e,t,n,i,r){var s,a=r in i,o=a?n.constructor==Object&&0==Object.keys(i).length:n.constructor==Object&&0==Object.keys(n).length,u=a||o,l=!0;for(s in t){var c=r+"."+s,d=a?i[r]:n[s];u||s in n?void 0===t[s]?void 0===d||u?delete e[s]:e[s]=Ln(d):o?e[s]=t[s]:d.constructor==Object&&t[s]&&t[s].constructor==Object?(e[s]||(e[s]=Ln(d)),c=kd(e[s],t[s],d,i,c),l=l&&c):typeof t[s]!=typeof d||null==t[s]||"function"!=typeof t[s]&&t[s].constructor!=d.constructor?(J("Invalid config, wrong type for "+c),l=!1):"function"==typeof n[s]&&n[s].length!=t[s].length?(Z("Unexpected number of arguments for "+c),e[s]=t[s]):e[s]=Array.isArray(e[s])?t[s].slice():t[s]:(J("Invalid config, unrecognized key "+c),l=!1)}return l}function Ld(e,t){for(var n={},i=n,r=0,s=0;;){if(r=e.indexOf(".",r),0>r)break;0!=r&&"\\"==e[r-1]||(s=e.substring(s,r).replace(/\\\./g,"."),i[s]={},i=i[s],s=r+1),r+=1}return i[e.substring(s).replace(/\\\./g,".")]=t,n}function Rd(e,t){return e&&t}function Cd(e,t){function n(e){for(var t=d(Object.keys(e)),i=t.next();!i.done;i=t.next())if(i=i.value,!(e[i]instanceof HTMLElement))if(r(e[i])&&0===Object.keys(e[i]).length)delete e[i];else{var s=e[i];Array.isArray(s)&&0===s.length||"function"==typeof e[i]?delete e[i]:r(e[i])&&(n(e[i]),0===Object.keys(e[i]).length&&delete e[i])}}function i(e,t){return Object.keys(e).reduce((function(n,s){var a=e[s];return t.hasOwnProperty(s)?a instanceof HTMLElement&&t[s]instanceof HTMLElement?a.isEqualNode(t[s])||(n[s]=a):r(a)&&r(t[s])?(a=i(a,t[s]),(0<Object.keys(a).length||!r(a))&&(n[s]=a)):Array.isArray(a)&&Array.isArray(t[s])?bn(a,t[s])||(n[s]=a):Number.isNaN(a)&&Number.isNaN(t[s])||a!==t[s]&&(n[s]=a):n[s]=a,n}),{})}function r(e){return e&&"object"===typeof e&&!Array.isArray(e)}return e=i(e,t),n(e),e}function Dd(){}function Md(e){return e=Lt(e),new ve(e).lb}function Pd(e,t,n){function i(e){Fe(s).setUint32(a,e.byteLength,!0),a+=4,s.set(Ne(e),a),a+=e.byteLength}if(!n||!n.byteLength)throw new je(2,6,6015);var r;r="string"==typeof t?Ct(t,!0):t,e=Lt(e),e=Ct(e,!0);var s=new Uint8Array(12+e.byteLength+r.byteLength+n.byteLength),a=0;return i(e),i(r),i(n),s}function _d(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,n=Lt(e).split("skd://").pop(),Pd(e,n,t))}function Od(e,t){2===e&&(e=t.drmInfo)&&We(e.keySystem)&&(t.headers["Content-Type"]="application/octet-stream")}function Nd(){this.g=null}function Ud(e,t){t=wr(t);var n=kr(t,e.map((function(e){return Ir(e)})));return n?e.filter((function(e){return n==Ir(e)})):[]}function Fd(e,t){return e.filter((function(e){return!!e.audio&&(t?e.audio.roles.includes(t):0==e.audio.roles.length)}))}function Bd(e,t){return e.filter((function(e){return!(!e.audio||!e.audio.label)&&e.audio.label.toLowerCase()==t.toLowerCase()}))}function jd(e,t){return e.filter((function(e){return!(!e.video||!e.video.label)&&e.video.label.toLowerCase()==t.toLowerCase()}))}function $d(e,t){return e.filter((function(e){return!(e.audio&&e.audio.channelsCount&&e.audio.channelsCount>t)})).sort((function(e,t){return e.audio||t.audio?e.audio?t.audio?(t.audio.channelsCount||0)-(e.audio.channelsCount||0):1:-1:0}))}function Gd(e,t){if("AUTO"==t){var n=e.some((function(e){return!(!e.video||!e.video.hdr||"HLG"!=e.video.hdr)}));t=Et(n)}return e.filter((function(e){return!e.video||!e.video.hdr||e.video.hdr==t}))}function Vd(e,t){return e.filter((function(e){return!e.video||!e.video.videoLayout||e.video.videoLayout==t}))}function Hd(e,t){return e.filter((function(e){return!e.audio||e.audio.spatialAudio==t}))}function Kd(e,t){return e.filter((function(e){return!e.audio||e.audio.codecs==t}))}function Wd(){}function qd(){var t=1/0;navigator.connection&&navigator.connection.saveData&&(t=360);var n={retryParameters:vs(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,persistentSessionOnlinePlayback:!1,persistentSessionsMetadata:[],initDataTransform:function(t,n,i){return"apple"===e.shakaMediaKeysPolyfill&&"skd"==n&&(n=i.serverCertificate,i=Md(t),t=Pd(t,i,n)),t},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:et(),minHdcpVersion:"",ignoreDuplicateInitData:!vt("Tizen 2"),defaultAudioRobustnessForWidevine:"SW_SECURE_CRYPTO",defaultVideoRobustnessForWidevine:"SW_SECURE_DECODE"};(et()||lt())&&n.preferredKeySystems.push("com.microsoft.playready"),ft()&&!Ze()&&(n.keySystemsMapping={"com.microsoft.playready":"com.microsoft.playready.recommendation"});var i="reload",r=!1;!nn()||tt()||lt()||ut()||it()&&79===at()||st()&&!pt()&&!gt()||ft()&&Ze()||(i="smooth",r=!0),r={retryParameters:vs(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,disableIFrames:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,raiseFatalErrorOnManifestUpdateRequestFailure:!1,continueLoadingWhenPaused:!0,ignoreSupplementalCodecs:!1,updatePeriod:-1,ignoreDrmInfo:!1,dash:{clockSyncUri:"",disableXlinkProcessing:!0,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:94ce86fb-07ff-4f43-adb8-93d2fa968ca2":"com.apple.fps","urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c":"com.huawei.wiseplay"},manifestPreprocessor:Qd,manifestPreprocessorTXml:Jd,sequenceMode:!1,multiTypeVariantsAllowed:r,useStreamOnceInPeriodFlattening:!1,enableFastSwitching:!0},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,ignoreManifestProgramDateTimeForTypes:[],mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',liveSegmentsDelay:3,sequenceMode:Tt(),ignoreManifestTimestampsInSegmentsMode:!1,disableCodecGuessing:!1,disableClosedCaptionsDetection:!1,allowLowLatencyByteRangeOptimization:!0,allowRangeRequestsToGuessMimeType:!1},mss:{manifestPreprocessor:Qd,manifestPreprocessorTXml:Jd,sequenceMode:!1,keySystemsBySystemId:{"9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"}}};var s={retryParameters:vs(),failureCallback:function(e){return Rd([e])},rebufferingGoal:0,bufferingGoal:10,bufferBehind:30,evictionGoal:1,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,gapPadding:0,gapJumpTimerTime:.25,durationBackoff:1,safeSeekOffset:5,safeSeekEndOffset:0,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsForFairPlay:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,forceHTTP:!1,forceHTTPS:!1,minBytesForProgressEvents:16e3,preferNativeDash:!1,preferNativeHls:!1,updateIntervalSeconds:1,observeQualityChanges:!1,maxDisabledTime:30,segmentPrefetchLimit:1,prefetchAudioLanguages:[],disableAudioPrefetch:!1,disableTextPrefetch:!1,disableVideoPrefetch:!1,liveSync:{enabled:!1,targetLatency:.5,targetLatencyTolerance:.5,maxPlaybackRate:1.1,minPlaybackRate:.95,panicMode:!1,panicThreshold:60,dynamicTargetLatency:{enabled:!1,stabilityThreshold:60,rebufferIncrement:.5,maxAttempts:10,maxLatency:4,minLatency:1}},allowMediaSourceRecoveries:!0,minTimeBetweenRecoveries:5,vodDynamicPlaybackRate:!1,vodDynamicPlaybackRateLowBufferRate:.95,vodDynamicPlaybackRateBufferRatio:.5,preloadNextUrlWindow:30,loadTimeout:30,clearDecodingCache:lt()||ut(),dontChooseCodecs:!1,shouldFixTimestampOffset:it()||tt(),avoidEvictionOnQuotaExceededError:!1,crossBoundaryStrategy:"keep"};(it()||tt()||st()||ct())&&(s.stallSkip=0),(navigator.userAgent.match(/Edge\//)||et())&&(s.gapPadding=.01),tt()&&(s.gapPadding=2),rt()&&(s.crossBoundaryStrategy="reset"),nt()&&(s.crossBoundaryStrategy="reset_to_encrypted");var a={trackSelectionCallback:function(e){return U((function(t){return t.return(e)}))},downloadSizeCallback:function(e){var t;return U((function(n){return 1==n.g?navigator.storage&&navigator.storage.estimate?w(n,navigator.storage.estimate(),3):n.return(!0):(t=n.h,n.return(t.usage+e<.95*t.quota))}))},progressCallback:function(e,t){return Rd([e,t])},usePersistentLicense:!0,numberOfParallelDownloads:5};t={enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1,clearBufferSwitch:!1,safeMarginSwitch:0,cacheLoadThreshold:20,minTimeToSwitch:ot()?.5:0,preferNetworkInformationBandwidth:!1},i={codecSwitchingStrategy:i,addExtraFeaturesToSourceBuffer:function(e){return Rd([e],"")},forceTransmux:!1,insertFakeEncryptionInInit:!0,correctEc3Enca:!1,modifyCueCallback:function(e,t){return Rd([e,t])},dispatchAllEmsgBoxes:!1};var o=!1,u=!1,l=!0;mt()&&(u=o=!0,l=!1);var c={drm:n,manifest:r,streaming:s,mediaSource:i,offline:a,abrFactory:function(){return new cs},adaptationSetCriteriaFactory:function(){return new(Function.prototype.bind.apply(Nd,[null].concat(h(F.apply(0,arguments)))))},abr:t,autoShowText:3,preferredAudioLanguage:"",preferredAudioLabel:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoHdrLevel:"AUTO",preferredVideoLayout:"",preferredVideoLabel:"",preferredVideoCodecs:[],preferredAudioCodecs:[],preferredTextFormats:[],preferForcedSubs:!1,preferSpatialAudio:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayer:{captionsUpdatePeriod:.25,fontScaleFactor:1},textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",rtpSafetyFactor:5,useHeaders:!1,includeKeys:[],version:1},cmsd:{enabled:!0,applyMaximumSuggestedBitrate:!0,estimatedThroughputWeightRatio:.5},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1,poster:!0},ads:{customPlayheadTracker:o,skipPlayDetection:u,supportsMultipleMediaElements:l,disableHLSInterstitial:!1,disableDASHInterstitial:!1,allowPreloadOnDomElements:!0},ignoreHardwareResolution:!1};return a.trackSelectionCallback=function(e){return U((function(t){return t.return(zd(e,c.preferredAudioLanguage,c.preferredVideoHdrLevel))}))},c}function Yd(){return{streaming:{inaccurateManifestTolerance:0,segmentPrefetchLimit:2,updateIntervalSeconds:.1,maxDisabledTime:1,retryParameters:{baseDelay:100}},manifest:{dash:{autoCorrectDrift:!1},retryParameters:{baseDelay:100}},drm:{retryParameters:{baseDelay:100}}}}function Xd(e,t,n){var i={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:[],audioRobustness:[],sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:"",headers:{}}};return kd(e,t,n||qd(),i,"")}function zd(e,t,n){var i=n;"AUTO"==i&&(n=e.some((function(e){return!(!e.hdr||"HLG"!=e.hdr)})),i=Et(n));var r=e.filter((function(e){return!("variant"!=e.type||e.hdr&&e.hdr!=i)}));n=[];var s=kr(t,r.map((function(e){return e.language})));s&&(n=r.filter((function(e){return wr(e.language)==s}))),0==n.length&&(n=r.filter((function(e){return e.primary}))),0==n.length&&(r.map((function(e){return e.language})),n=r);var a=n.filter((function(e){return e.height&&480>=e.height}));for(a.length&&(a.sort((function(e,t){return t.height-e.height})),n=a.filter((function(e){return e.height==a[0].height}))),t=[],n.length&&(r=Math.floor(n.length/2),n.sort((function(e,t){return e.bandwidth-t.bandwidth})),t.push(n[r])),e=d(e),n=e.next();!n.done;n=e.next())n=n.value,n.type!=qt&&"image"!=n.type||t.push(n);return t}function Qd(e){return Rd([e],e)}function Jd(e){return Rd([e],e)}function Zd(){this.g=null,this.h=[]}function eh(e,t){var n=0;e.g&&e.g.state==t&&(n+=e.g.duration),e=d(e.h);for(var i=e.next();!i.done;i=e.next())i=i.value,n+=i.state==t?i.duration:0;return n}function th(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],i=d(e.h),r=i.next();!r.done;r=i.next())n.push(t(r.value));return e.g&&n.push(t(e.g)),n}function nh(){this.i=this.h=null,this.g=[]}function ih(e,t,n){e.i!=t&&(e.i=t,e.g.push({timestamp:Date.now()/1e3,id:t.id,type:"text",fromAdaptation:n,bandwidth:null}))}function rh(){this.mc=this.ah=this.u=this.A=this.I=this.B=this.o=this.j=this.H=this.C=this.i=this.P=this.T=this.L=this.M=this.O=this.l=this.m=NaN,this.K=0,this.F=this.G=NaN,this.g=new Zd,this.h=new nh}function sh(e,t,n,i){Rs.call(this),this.O=e,this.Z=t,this.Ea=i.networkingEngine,this.B=n,this.o=null,this.ya=0,this.La=i.Jc,this.F=i.Zi,this.Ma=i.$i,this.g=i.config,this.l=this.G=this.h=null,this.oa=!1,this.H=i.kj,this.sa=!1,this.i=null,this.ka=!1,this.j=this.C=null,this.ea=!1,this.M=new Map,this.za=!1,this.Fa=i.jj,this.$=new rh,this.na=new ys,this.m=new ys,this.P=null,this.u=!1,this.fa=i.Th,this.W=this.K=null,this.Ka=i.Sh,this.T=!1,this.L=[],this.I=[],this.A=!0}function ah(e,t,n){(e=t?e.I:e.L)?e.push(n):n()}function oh(e){if(e.I)for(var t=d(e.I),n=t.next();!n.done;n=t.next())n=n.value,n();e.I=null}function uh(e,t){if(e.P=t,e.T=!0,e.L){t=d(e.L);for(var n=t.next();!n.done;n=t.next())n=n.value,n()}e.L=null}function lh(e){return e.ea=!0,e.j}function ch(e){return e.sa=!0,e.H}function dh(e){return e.ka=!0,e.i}function hh(e){return e.za=!0,e.M}function fh(e){if(e.u)throw new je(2,7,7003)}function ph(e,t){e.dispatchEvent(new Is("onstatechange",(new Map).set("state",t)))}function gh(e){var t,n,i,r,s,a,o,u,l;return U((function(c){switch(c.g){case 1:if(ph(e,"manifest-parser"),e.l||(e.G=go(e.O,e.Z),e.l=e.G(),e.l.configure(e.g.manifest,(function(){return e.A}))),t=Date.now()/1e3,ph(e,"manifest"),e.h){c.s(2);break}return w(c,e.l.start(e.O,e.Ma),3);case 3:if(e.h=c.h,1!=e.h.variants.length){c.s(2);break}for(n=[],i=e.h.variants[0],r=d([i.video,i.audio]),s=r.next();!s.done;s=r.next())(a=s.value)&&!a.segmentIndex&&n.push(a.createSegmentIndex());if(!(0<n.length)){c.s(2);break}return w(c,Promise.all(n),2);case 2:return e.na.resolve(),o=new Is("manifestparsed",void 0),w(c,Promise.resolve(),7);case 7:if(e.dispatchEvent(o),0==e.h.variants.length)throw new je(2,4,4036);bh(e.h),u=Date.now()/1e3,l=u-t,e.$.H=l,A(c)}}))}function mh(e,t){var n,i,r,s,a,o;return U((function(u){switch(u.g){case 1:if(!e.h||e.i)return u.return();if(ph(e,"drm-engine"),e.ya=Date.now()/1e3,e.i=e.La(),e.F.h=e.i,e.i.configure(e.g.drm,(function(){return e.A})),n=ao(e.F,e.h),!n){u.s(2);break}return i=new Is("trackschanged",void 0),w(u,Promise.resolve(),3);case 3:fh(e),e.dispatchEvent(i);case 2:return r=es(e.h.variants),s=!0,e.h&&e.h.presentationTimeline&&"HLS"!=e.h.type&&(s=e.h.presentationTimeline.U()),w(u,ma(e.i,r,e.h.offlineSessionIds,s),4);case 4:if(fh(e),!t){u.s(5);break}return w(u,e.i.Jb(t),6);case 6:fh(e);case 5:return w(u,so(e.F,e.h),7);case 7:if(a=u.h,!a){u.s(0);break}return o=new Is("trackschanged",void 0),w(u,Promise.resolve(),9);case 9:e.dispatchEvent(o),A(u)}}))}function vh(e){var t,n,i,r,s,a,o;return U((function(u){return e.o||(e.o=e.g.adaptationSetCriteriaFactory(),e.o.configure({language:e.g.preferredAudioLanguage,role:e.g.preferredVariantRole,channelCount:e.g.preferredAudioChannelCount,Qc:e.g.preferredVideoHdrLevel,spatialAudio:e.g.preferSpatialAudio,videoLayout:e.g.preferredVideoLayout,Ic:e.g.preferredAudioLabel,dd:e.g.preferredVideoLabel,codecSwitchingStrategy:e.g.mediaSource.codecSwitchingStrategy,audioCodec:""})),e.Ka&&(t=e.g.abrFactory,e.C=t,e.j=t(),e.j.configure(e.g.abr)),e.fa?(n=e.h.presentationTimeline.U(),i=es(e.h.variants),r=e.o.create(i),e.j.configure(e.g.abr),e.j.setVariants(Array.from(r.values())),s=e.j.chooseVariant(),s?(a=[],e.K=s,s.video&&a.push(yh(e,s.video,n)),s.audio&&a.push(yh(e,s.audio,n)),(o=ts(e.h.textStreams,e.g.preferredTextLanguage,e.g.preferredTextRole,e.g.preferForcedSubs)[0]||null)&&ss(s.audio,o,e.g)&&(a.push(yh(e,o,n)),e.W=o),w(u,Promise.all(a),0)):u.s(0)):u.s(0)}))}function yh(e,t,n){var i,r,s,a,o;return U((function(u){return 1==u.g?(i=e.g.streaming.segmentPrefetchLimit||2,r=new Ec(i,t,(function(t,n,i){return md(t,n,i||null,e.g.streaming.retryParameters,e.Ea,e.A)}),!1),e.M.set(t.id,r),t.segmentIndex?u.s(2):w(u,t.createSegmentIndex(),2)):(s=e.B||0,a=t.segmentIndex.Eb(s),o=null,a&&(o=a.current(),o||(o=a.next().value)),o||(o=sc(t.segmentIndex)),o?n?o.Y?w(u,xc(r,o.Y),0):u.s(0):w(u,Ac(r,o.startTime),0):u.s(0))}))}function bh(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.variants.some(t)&&(e.variants=e.variants.filter(t))}function Th(e,t){Rs.call(this);var n=this;this.i=e,this.l=t,this.g=new Map,this.m=[{Hc:null,Gc:wh,vc:function(e,t){return Sh(n,"enter",e,t)}},{Hc:Eh,Gc:wh,vc:function(e,t){return Sh(n,"enter",e,t)}},{Hc:Ah,Gc:wh,vc:function(e,t){return Sh(n,"enter",e,t)}},{Hc:wh,Gc:Eh,vc:function(e,t){return Sh(n,"exit",e,t)}},{Hc:wh,Gc:Ah,vc:function(e,t){return Sh(n,"exit",e,t)}},{Hc:Eh,Gc:Ah,vc:function(e,t){t?Sh(n,"skip",e,t):(Sh(n,"enter",e,t),Sh(n,"exit",e,t))}},{Hc:Ah,Gc:Eh,vc:function(e,t){return Sh(n,"skip",e,t)}}],this.h=new ae,this.h.D(this.i,"regionremove",(function(e){n.g.delete(e.region)}))}function Sh(e,t,n,i){t=new Is(t,new Map([["region",n],["seeking",i]])),e.dispatchEvent(t)}Wl.prototype.release=function(){this.h&&(this.h.release(),this.h=null),null!=this.i&&(this.i.release(),this.i=null),this.m=function(){},this.g=null},Ql.prototype.release=function(){this.h&&(this.h.stop(),this.h=null),this.g=null},i=Zl.prototype,i.ready=function(){function e(){if(null==t.g||0==t.g&&1/0!=t.h.duration)t.j=!0;else{var e=t.h.currentTime,n=t.g;0>t.g&&(n=Math.max(0,e+t.g)),e!=n?(t.i.qa(t.h,"seeking",(function(){t.j=!0})),t.h.currentTime=n):t.j=!0}}var t=this;Hl(this.h,HTMLMediaElement.HAVE_CURRENT_DATA,this.i,(function(){e()}))},i.release=function(){this.i&&(this.i.release(),this.i=null),this.h=null},i.af=function(e){this.g=this.j?this.g:e},i.Pd=function(){return(this.j?this.h.currentTime:this.g)||0},i.Ag=function(){return 0},i.zg=function(){return 0},i.hh=function(){},i=ec.prototype,i.ready=function(){this.m.ua(.25)},i.release=function(){this.h&&(this.h.release(),this.h=null),this.j&&(this.j.release(),this.j=null),this.m&&(this.m.stop(),this.m=null),this.i=this.h=this.g=this.l=null,this.u=function(){}},i.af=function(e){Yl(this.h,e)},i.Pd=function(){var e=ql(this.h);return 0<this.i.readyState&&!this.i.paused?ic(this,e):e},i.Ag=function(){return this.j.G},i.zg=function(){return this.j.C},i.hh=function(){this.j.se()},i=rc.prototype,i.getNumReferences=function(){return this.g.length},i.getNumEvicted=function(){return this.i},i.release=function(){this.o||(this.g=[],this.m&&this.m.stop(),this.m=null)},i.bj=function(){this.o=!0},i.vb=function(e){for(var t=d(this.g),n=t.next();!n.done;n=t.next())e(n.value)},i.find=function(e){for(var t=this.g.length-1,n=t;0<=n;--n){var i=this.g[n],r=n<t?this.g[n+1].startTime:i.endTime;if(e>=i.startTime&&e<r)return n+this.i}return this.g.length&&e<this.g[0].startTime?this.i:null},i.get=function(e){return 0==this.g.length?null:(e-=this.i,0>e||e>=this.g.length?null:this.g[e])},i.offset=function(e){if(!this.o)for(var t=d(this.g),n=t.next();!n.done;n=t.next())n.value.offset(e)},i.me=function(e){if(!this.o&&e.length){var t=Math.round(1e3*e[0].startTime)/1e3;this.g=this.g.filter((function(e){return Math.round(1e3*e.startTime)/1e3<t})),this.g.push.apply(this.g,h(e))}},i.yd=function(e,t){var n=this;e=e.filter((function(e){return e.endTime>t&&(0==n.g.length||e.endTime>n.g[0].startTime)})),this.me(e),this.Na(t)},i.Na=function(e){if(!this.o){var t=this.g.length;this.g=this.g.filter((function(t){return t.endTime>e})),this.i+=t-this.g.length}},i.Mc=function(e,t,n){if(n=void 0!==n&&n,!this.o){for(;this.g.length;){if(!(this.g[this.g.length-1].startTime>=t))break;this.g.pop()}for(;this.g.length;){if(!(this.g[0].endTime<=e))break;this.g.shift(),n||this.i++}0!=this.g.length&&(e=this.g[this.g.length-1],t=new uu(e.startTime,t,e.C,e.startByte,e.endByte,e.Y,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.g,e.tilesLayout,e.B,e.h,e.status,e.aesKey),t.mimeType=e.mimeType,t.codecs=e.codecs,t.i=e.i,this.g[this.g.length-1]=t)}},i.Je=function(e,t){var n=this;this.o||(this.m&&this.m.stop(),this.m=new ze((function(){var e=t();e?n.g.push.apply(n.g,h(e)):(n.m.stop(),n.m=null)})),this.m.ua(e))},rc.prototype[Symbol.iterator]=function(){return this.Eb(0)},rc.prototype.Eb=function(e,t,n){t=void 0!==t&&t,n=void 0!==n&&n;var i=this.find(e);if(null==i)return null;var r=this.get(i);n?i++:i--;var s=-1;if(r&&0<r.g.length)for(var a=r.g.length-1;0<=a;--a){var o=r.g[a];if(e>=o.startTime&&e<o.endTime){if(!t){for(;a&&!o.l;)a--,o=r.g[a];if(!o.l)return J("No independent partial segment found!"),null}n?i--:i++,s=a-1;break}}return new oc(this,i,s,n)},K("shaka.media.SegmentIndex",rc),rc.forSingleSegment=ac,rc.prototype.getIteratorForTime=rc.prototype.Eb,rc.prototype.updateEvery=rc.prototype.Je,rc.prototype.fit=rc.prototype.Mc,rc.prototype.evict=rc.prototype.Na,rc.prototype.mergeAndEvict=rc.prototype.yd,rc.prototype.offset=rc.prototype.offset,rc.prototype.get=rc.prototype.get,rc.prototype.find=rc.prototype.find,rc.prototype.markImmutable=rc.prototype.bj,rc.prototype.release=rc.prototype.release,rc.prototype.getNumEvicted=rc.prototype.getNumEvicted,rc.prototype.getNumReferences=rc.prototype.getNumReferences,i=oc.prototype,i.cd=function(e){this.reverse=e},i.ci=function(){return this.h},i.current=function(){var e=this.i.get(this.h);return e&&0<e.g.length&&e.A&&this.g>=e.g.length&&(this.h++,this.g=0,e=this.i.get(this.h)),e&&0<e.g.length?e.g[this.g]:e},i.next=function(){var e=this.i.get(this.h);return this.reverse?e&&0<e.g.length?(this.g--,0>this.g&&(this.h--,this.g=(e=this.i.get(this.h))&&0<e.g.length?e.g.length-1:0)):(this.h--,this.g=0):e&&0<e.g.length?(this.g++,e.A&&this.g==e.g.length&&(this.h++,this.g=0)):(this.h++,this.g=0),e=this.current(),{value:e,done:!e}},i.dg=function(){var e=this.current();if(e.o&&!e.l&&(e=this.i.get(this.h))&&0<e.g.length)for(var t=e.g[this.g];t.l&&!(0>=this.g);)this.g--,t=e.g[this.g]},K("shaka.media.SegmentIterator",oc),oc.prototype.resetToLastIndependent=oc.prototype.dg,oc.prototype.next=oc.prototype.next,oc.prototype.current=oc.prototype.current,oc.prototype.currentPosition=oc.prototype.ci,oc.prototype.setReverse=oc.prototype.cd,b(uc,rc),i=uc.prototype,i.clone=function(){var e=new uc;return e.h=this.h.slice(),e.i=this.i,e},i.release=function(){for(var e=d(this.h),t=e.next();!t.done;t=e.next())t.value.release();this.h=[]},i.vb=function(e){for(var t=d(this.h),n=t.next();!n.done;n=t.next())n.value.vb(e)},i.find=function(e){for(var t=this.i,n=d(this.h),i=n.next();!i.done;i=n.next()){i=i.value;var r=i.find(e);if(null!=r)return r+t;t+=i.getNumEvicted()+i.getNumReferences()}return null},i.get=function(e){for(var t=this.i,n=d(this.h),i=n.next();!i.done;i=n.next()){i=i.value;var r=i.get(e-t);if(r)return r;r=i.getNumReferences(),t+=i.getNumEvicted()+r}return null},i.offset=function(){},i.me=function(){},i.Na=function(e){for(var t=d(this.h),n=t.next();!n.done;n=t.next())n.value.Na(e);for(;1<this.h.length&&0==this.h[0].getNumReferences();)e=this.h.shift(),this.i+=e.getNumEvicted(),e.release()},i.yd=function(){},i.Mc=function(){},i.Je=function(){},K("shaka.media.MetaSegmentIndex",uc),uc.prototype.updateEvery=uc.prototype.Je,uc.prototype.fit=uc.prototype.Mc,uc.prototype.mergeAndEvict=uc.prototype.yd,uc.prototype.evict=uc.prototype.Na,uc.prototype.merge=uc.prototype.me,uc.prototype.offset=uc.prototype.offset,uc.prototype.get=uc.prototype.get,uc.prototype.find=uc.prototype.find,uc.prototype.forEachTopLevelReference=uc.prototype.vb,uc.prototype.release=uc.prototype.release,lc.prototype.release=function(){this.set(this.sc()),this.h&&(this.h.stop(),this.h=null),this.g=null},lc.prototype.set=function(e){this.i=e,cc(this)},lc.prototype.sc=function(){return this.g.sc()},dc.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.i.stop();for(var e=d(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g.clear()},b(fc,Rs),fc.prototype.release=function(){this.g.clear(),Rs.prototype.release.call(this)},fc.prototype.j=function(e){for(var t=d(this.g.values()),n=t.next();!n.done;n=t.next()){n=n.value;var i=n.mf;e:{for(var r=n.Id,s=r.length-1;0<=s;s--){var a=r[s];if(a.position<=e){r=a.Uc;break e}}r=null}s=r&&!(i===r||i&&r&&i.bandwidth==r.bandwidth&&i.audioSamplingRate==r.audioSamplingRate&&i.codecs==r.codecs&&i.contentType==r.contentType&&i.frameRate==r.frameRate&&i.height==r.height&&i.mimeType==r.mimeType&&i.channelsCount==r.channelsCount&&i.pixelAspectRatio==r.pixelAspectRatio&&i.width==r.width),a=r&&i&&r.label&&i.label&&i.label!==r.label;var o=r&&i&&r.language&&i.language&&i.language!==r.language;i=r&&i&&r.roles&&i.roles&&!Tn(i.roles,r.roles),(a||o||i)&&mc(this,e,r.contentType)&&(n.mf=r,i=new Is("audiotrackchange",new Map([["quality",r],["position",e]])),this.dispatchEvent(i)),s&&mc(this,e,r.contentType)&&(n.mf=r,JSON.stringify(r),n=new Is("qualitychange",new Map([["quality",r],["position",e]])),this.dispatchEvent(n))}},b(bc,Rs),bc.prototype.release=function(){this.h.clear(),this.g&&(this.g.stop(),this.g=null),Rs.prototype.release.call(this)},Ec.prototype.Na=function(e,t){t=void 0!==t&&t;for(var n=d(this.h.keys()),i=n.next();!i.done;i=n.next())i=i.value,e>i.endTime&&Dc(this,i);t&&Lc(this)},Ec.prototype.cd=function(e){this.o=e,this.g&&this.g.cd(e)},Mc.prototype.abort=function(){this.Ed&&this.Ed.abort()},i=$c.prototype,i.destroy=function(){return this.m.destroy()},i.configure=function(e){if(this.h=e,this.P=new gs({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0),e.disableAudioPrefetch){var t=this.i.get("audio");t&&t.ba&&(kc(t.ba),t.ba=null),t=d(this.o.keys());for(var n=t.next();!n.done;n=t.next())n=n.value,kc(this.o.get(n)),this.o.delete(n)}for(e.disableTextPrefetch&&(t=this.i.get(qt))&&t.ba&&(kc(t.ba),t.ba=null),e.disableVideoPrefetch&&(t=this.i.get("video"))&&t.ba&&(kc(t.ba),t.ba=null),t=d(this.i.keys()),n=t.next();!n.done;n=t.next())n=this.i.get(n.value),n.ba?(Rc(n.ba,e.segmentPrefetchLimit),0<e.segmentPrefetchLimit||(kc(n.ba),n.ba=null)):0<e.segmentPrefetchLimit&&(n.ba=td(this,n.stream));e.disableAudioPrefetch||nd(this)},i.start=function(e){var t=this;return U((function(n){if(1==n.g)return w(n,Zc(t,e||new Map),2);Ws(t.m),t.I=!0,A(n)}))},i.Dc=function(){if(this.g){for(var e=this.g.Pc(),t=d(this.i.keys()),n=t.next();!n.done;n=t.next()){var i=n.value;n=this.i.get(i);var r=this.g.aa;if(i==qt?(r=r.h,r=null!=r.g&&null!=r.h&&(e>=r.g&&e<r.h)):(r=cl(r,i),r=pu(r,e)),!r){if(this.L=0,n.ba&&(n.ba.g=null),"audio"===n.type){r=d(this.o.values());for(var s=r.next();!s.done;s=r.next())s.value.g=null}n.ja=null,(null!=ul(this.g.aa,i)||n.Ca)&&Jc(this,n),n.pb&&(n.pb.abort(),n.pb=null),i===qt&&(i=this.g.aa,i.O&&i.O.g()),n.Dc=!0}}"keep"!==this.h.crossBoundaryStrategy&&Ad(this)}},i.updateDuration=function(){var e=rn(),t=this.j.presentationTimeline.getDuration();1/0>t?(e&&(this.A&&this.A.stop(),bl(this.g.aa)),this.g.aa.$a(t)):e?(this.A&&this.A.ua(.5),this.g.aa.$a(1/0)):this.g.aa.$a(Math.pow(2,32))},K("shaka.util.ConfigUtils",Id),Id.getDifferenceFromConfigObjects=Cd,Id.convertToConfigObject=Ld,Id.mergeConfigObjects=kd,K("shaka.drm.FairPlay",Dd),Dd.commonFairPlayResponse=function(e,t){if(2===e&&(e=t.originalRequest.drmInfo)&&We(e.keySystem)){try{var n=It(t.data)}catch(r){return}if(e=!1,n=n.trim(),"<ckc>"===n.substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6),e=!0),!e)try{var i=JSON.parse(n);i.ckc&&(n=i.ckc,e=!0),i.CkcMessage&&(n=i.CkcMessage,e=!0),i.License&&(n=i.License,e=!0)}catch(r){}e&&(t.data=Oe(Ut(n)))}},Dd.muxFairPlayRequest=function(e,t){Od(e,t)},Dd.expressplayFairPlayRequest=function(e,t){if(2===e){var n=t.drmInfo;n&&We(n.keySystem)&&Od(e,t)}},Dd.conaxFairPlayRequest=function(e,t){Od(e,t)},Dd.ezdrmFairPlayRequest=function(e,t){Od(e,t)},Dd.verimatrixFairPlayRequest=function(e,t){2===e&&(e=t.drmInfo)&&We(e.keySystem)&&(e=Ne(t.body),e=Nt(e),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=Rt("spc="+e))},Dd.muxInitDataTransform=function(e,t,n){return _d(e,t,n)},Dd.expressplayInitDataTransform=function(e,t,n){return _d(e,t,n)},Dd.conaxInitDataTransform=function(t,n,i){if("skd"!==n)return t;n=i.serverCertificate,i=Lt(t).split("skd://").pop().split("?").shift(),i=e.atob(i);var r=new ArrayBuffer(2*i.length);r=Ue(r);for(var s=0,a=i.length;s<a;s++)r[s]=i.charCodeAt(s);return Pd(t,r,n)},Dd.ezdrmInitDataTransform=function(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,n=Lt(e).split(";").pop(),Pd(e,n,t))},Dd.verimatrixInitDataTransform=function(e,t,n){return _d(e,t,n)},Dd.initDataTransform=Pd,Dd.defaultGetContentId=Md,Dd.isFairPlaySupported=function(){var e;return U((function(t){return 1==t.g?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},x(t,2),w(t,navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):2!=t.g?t.return(!0):(L(t),t.return(!1))}))},Nd.prototype.configure=function(e){this.g=e},Nd.prototype.create=function(e){var t;if(this.g.language){var n=Ud(e,this.g.language);n.length&&(t=n)}return t||(t=e.filter((function(e){return e.primary})),t=t.length?t:e),e=Fd(t,this.g.role),e.length&&(t=e),this.g.videoLayout&&(e=Vd(t,this.g.videoLayout),e.length&&(t=e)),this.g.Qc&&(e=Gd(t,this.g.Qc),e.length&&(t=e)),this.g.channelCount&&(e=$d(t,this.g.channelCount),e.length&&(t=e)),this.g.Ic&&(e=Bd(t,this.g.Ic),e.length&&(t=e)),this.g.dd&&(e=jd(t,this.g.dd),e.length&&(t=e)),e=Hd(t,this.g.spatialAudio),e.length&&(t=e),this.g.audioCodec&&(e=Kd(t,this.g.audioCodec),e.length&&(t=e)),new Qa(t[0],t,!("smooth"==this.g.codecSwitchingStrategy&&nn()))},K("shaka.util.PlayerConfiguration",Wd),Wd.mergeConfigObjects=Xd,Wd.createDefaultForLL=Yd,Wd.createDefault=qd,b(sh,Rs),i=sh.prototype,i.getStartTime=function(){return this.B},i.Oc=function(){return this.O},i.Hf=function(){return this.h},i.getStats=function(){return this.$},i.Ai=function(){return this.K?qr(this.K):null},i.zi=function(){return this.W?Yr(this.W):null},i.start=function(){var t=this;(function(){var n;U((function(i){switch(i.g){case 1:return w(i,Promise.resolve(),2);case 2:return x(i,3),w(i,gh(t),5);case 5:if(fh(t),"webkit"===e.shakaMediaKeysPolyfill){i.s(6);break}return w(i,mh(t),7);case 7:fh(t);case 6:return w(i,vh(t),8);case 8:if(fh(t),!t.fa||!t.i){i.s(9);break}return w(i,Pa(t.i),10);case 10:fh(t);case 9:t.m.resolve(),k(i,0);break;case 3:n=L(i),n instanceof je&&(7001==n.code||7003==n.code)||t.m.reject(n),A(i)}}))})()},i.dispatchEvent=function(e){return this.P?this.P.dispatchEvent(e):Rs.prototype.dispatchEvent.call(this,e)},i.onError=function(e){2===e.severity&&(this.m.reject(e),this.destroy());var t=(new Map).set("detail",e);t=new Is("error",t),this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)},i.configure=function(e,t){e=Ld(e,t),Xd(this.g,e)},i.getConfiguration=function(){return Ln(this.g)},i.Lj=function(){return this.m},i.destroy=function(){var e,t,n,i=this;return U((function(r){switch(r.g){case 1:if(i.u=!0,!i.l||i.oa){r.s(2);break}return w(r,i.l.stop(),2);case 2:if(!i.j||i.ea){r.s(4);break}return w(r,i.j.stop(),4);case 4:if(i.H&&!i.sa&&i.H.release(),!i.i||i.ka){r.s(6);break}return w(r,i.i.destroy(),6);case 6:if(0<i.M.size&&!i.za)for(e=d(i.M.values()),t=e.next();!t.done;t=e.next())n=t.value,kc(n);A(r)}}))},K("shaka.media.PreloadManager",sh),sh.prototype.destroy=sh.prototype.destroy,sh.prototype.waitForFinish=sh.prototype.Lj,sh.prototype.getPrefetchedTextTrack=sh.prototype.zi,sh.prototype.getPrefetchedVariantTrack=sh.prototype.Ai,b(Th,Rs),Th.prototype.release=function(){this.i=null,this.g.clear(),this.h.release(),this.h=null,Rs.prototype.release.call(this)},Th.prototype.j=function(e,t){if(!this.l||0!=e){this.l=!1;for(var n=d(this.i.h.values()),i=n.next();!i.done;i=n.next()){i=i.value;var r=this.g.get(i),s=e<i.startTime?Eh:e>i.endTime?Ah:wh;this.g.set(i,s);for(var a=d(this.m),o=a.next();!o.done;o=a.next())o=o.value,o.Hc==r&&o.Gc==s&&o.vc(i,t)}}};var Eh=1,wh=2,Ah=3;function xh(e,t,n){var i,r,s,a,o,u,l;return U((function(c){switch(c.g){case 1:var d=new ve(e).Za.split("/").pop().split(".");return i=1==d.length?"":d.pop().toLowerCase(),(r=Ih.get(i))?c.return(r):(s=0,a=Os([e],n),x(c,2),a.method="HEAD",w(c,t.request(s,a).promise,4));case 4:o=c.h,r=o.headers["content-type"],k(c,3);break;case 2:if(u=L(c),!u||1002!=u.code&&1001!=u.code){c.s(3);break}return a.method="GET",w(c,t.request(s,a).promise,6);case 6:l=c.h,r=l.headers["content-type"];case 3:return c.return(r?r.toLowerCase().split(";").shift():"")}}))}var Ih=(new Map).set("mp4","video/mp4").set("m4v","video/mp4").set("m4a","audio/mp4").set("webm","video/webm").set("weba","audio/webm").set("mkv","video/webm").set("ts","video/mp2t").set("ogv","video/ogg").set("ogg","audio/ogg").set("mpg","video/mpeg").set("mpeg","video/mpeg").set("mov","video/quicktime").set("m3u8","application/x-mpegurl").set("mpd","application/dash+xml").set("ism","application/vnd.ms-sstr+xml").set("mp3","audio/mpeg").set("aac","audio/aac").set("flac","audio/flac").set("wav","audio/wav").set("sbv","text/x-subviewer").set("srt","text/srt").set("vtt","text/vtt").set("webvtt","text/vtt").set("ttml","application/ttml+xml").set("lrc","application/x-subtitle-lrc").set("ssa","text/x-ssa").set("ass","text/x-ssa").set("jpeg","image/jpeg").set("jpg","image/jpeg").set("png","image/png").set("svg","image/svg+xml").set("webp","image/webp").set("avif","image/avif").set("html","text/html").set("htm","text/html");function kh(e,t){if(e.lineBreak)return"\n";if(e.nestedCues.length)return e.nestedCues.map((function(t){return kh(t,e)})).join("");if(!e.payload)return e.payload;var n=[],i=e.fontWeight>=Di,r=e.fontStyle==Pi,s=e.textDecoration.includes(Oi);return i&&n.push(["b"]),r&&n.push(["i"]),s&&n.push(["u"]),r=e.color,""==r&&t&&(r=t.color),i="",(r=Lh(r))&&(i+="."+r),r=e.backgroundColor,""==r&&t&&(r=t.backgroundColor),(t=Lh(r))&&(i+=".bg_"+t),i&&n.push(["c",i]),n.reduceRight((function(e,t){var n=d(t);return t=n.next().value,n=n.next().value,"<"+t+(void 0===n?"":n)+">"+e+"</"+t+">"}),e.payload)}function Lh(e){e=e.toLowerCase();var t=e.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i);switch(t?e="#"+(256|parseInt(t[1],10)).toString(16).slice(1)+(256|parseInt(t[2],10)).toString(16).slice(1)+(256|parseInt(t[3],10)).toString(16).slice(1):e.startsWith("#")&&7<e.length&&(e=e.slice(0,7)),e){case"white":case"#fff":case"#ffffff":return"white";case"lime":case"#0f0":case"#00ff00":return"lime";case"cyan":case"#0ff":case"#00ffff":return"cyan";case"red":case"#f00":case"#ff0000":return"red";case"yellow":case"#ff0":case"#ffff00":return"yellow";case"magenta":case"#f0f":case"#ff00ff":return"magenta";case"blue":case"#00f":case"#0000ff":return"blue";case"black":case"#000":case"#000000":return"black"}return null}function Rh(e,t){var n=[];e=d(Ch(e));for(var i=e.next();!i.done;i=e.next())if(i=i.value,i.isContainer)n.push.apply(n,h(Rh(i.nestedCues,i)));else{var r=i.clone();r.nestedCues=[],r.payload=kh(i,t),n.push(r)}return n}function Ch(e){var t=[];e=d(e);for(var n=e.next(),i={};!n.done;i={jf:void 0},n=e.next())i.jf=n.value,t.some(function(e){return function(t){return hi(e.jf,t)}}(i))||t.push(i.jf);return t}function Dh(e){function t(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()}if(e.startTime>=e.endTime)return null;var n=new VTTCue(e.startTime,e.endTime,e.payload);n.id=t(e.startTime.toString())+t(e.endTime.toString())+t(e.payload),n.lineAlign=e.lineAlign,n.positionAlign=e.positionAlign,e.size&&(n.size=e.size);try{n.align=e.textAlign}catch(i){}return"center"==e.textAlign&&"center"!=n.align&&(n.align="middle"),"vertical-lr"==e.writingMode?n.vertical="lr":"vertical-rl"==e.writingMode&&(n.vertical="rl"),1==e.lineInterpretation&&(n.snapToLines=!1),null!=e.line&&(n.line=e.line),null!=e.position&&(n.position=e.position),n}function Mh(e,t){for(this.h=e,this.i=t,this.g=null,e=d(Array.from(this.h.textTracks)),t=e.next();!t.done;t=e.next())t=t.value,"metadata"!==t.kind&&"chapters"!==t.kind&&(t.mode="disabled",t.label==this.i&&(this.g=t));this.g&&(this.g.mode="hidden")}function Ph(e){e.h&&!e.g&&(e.g=e.h.addTextTrack("subtitles",e.i),e.g.mode="hidden")}function _h(e,t){var n=e.mode;e.mode="showing"==n?"showing":"hidden";for(var i=d(Array.from(e.cues)),r=i.next();!r.done;r=i.next())(r=r.value)&&t(r)&&e.removeCue(r);e.mode=n}function Oh(){}function Nh(t,n){var i=this;document.fullscreenEnabled||Z("Using UITextDisplayer in a browser without Fullscreen API support causes subtitles to not be rendered in fullscreen"),this.A=!1,this.h=[],this.j=t,this.C=n,this.u=this.m=null,this.g=document.createElement("div"),this.g.classList.add("shaka-text-container"),this.g.style.textAlign="center",this.g.style.display="flex",this.g.style.flexDirection="column",this.g.style.alignItems="center",this.g.style.justifyContent="flex-end",this.C.appendChild(this.g),this.o=new ze((function(){i.j.paused||jh(i)})),Uh(this),this.l=new Map,this.i=new ae,this.i.D(document,"fullscreenchange",(function(){jh(i,!0)})),this.i.D(this.j,"seeking",(function(){jh(i,!0)})),this.i.D(this.j,"ratechange",(function(){Uh(i)})),this.i.D(this.j,"resize",(function(){var e=i.j,t=e.videoWidth;e=e.videoHeight,i.m=t&&e?t/e:null})),this.B=null,"ResizeObserver"in e&&(this.B=new ResizeObserver((function(){jh(i,!0)})),this.B.observe(this.g)),this.F=new Map}function Uh(e){e.o&&(e.h.length?e.o.ua((e.u?e.u.captionsUpdatePeriod:.25)/Math.max(1,Math.abs(e.j.playbackRate))):e.o.stop())}function Fh(e,t){for(;null!=t;){if(t==e.g)return!0;t=t.parentElement}return!1}function Bh(e,t,n,i,r){var s=!1,a=[],o=[];t=d(t);for(var u=t.next();!u.done;u=t.next()){u=u.value,r.push(u);var l=e.l.get(u),c=u.startTime<=i&&u.endTime>i,h=l?l.Mh:null;l&&(a.push(l.lf),l.Cc&&a.push(l.Cc),c||(s=!0,e.l.delete(u),l=null)),c&&(o.push(u),l?Fh(e,h)||(s=!0):($h(e,u,r),l=e.l.get(u),h=l.Mh,s=!0)),0<u.nestedCues.length&&h&&Bh(e,u.nestedCues,h,i,r),r.pop()}if(s){for(i=d(a),r=i.next();!r.done;r=i.next())r=r.value,r.parentElement&&r.parentElement.removeChild(r);for(o.sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime})),o=d(o),i=o.next();!i.done;i=o.next())i=e.l.get(i.value),i.Cc?(i.Cc.contains(n)&&i.Cc.removeChild(n),n.appendChild(i.Cc),i.Cc.appendChild(i.lf)):n.appendChild(i.lf)}}function jh(e,t){if(e.g){var n=e.j.currentTime;if(!e.A||void 0!==t&&t){t=d(e.F.values());for(var i=t.next();!i.done;i=t.next())Tu(i.value);Tu(e.g),e.l.clear(),e.F.clear()}e.A&&Bh(e,e.h,e.g,n,[])}}function $h(e,t,n){var i=1<n.length,r=i?"span":"div";t.lineBreak&&(r="br"),t.rubyTag&&(r=t.rubyTag),i=!i&&0<t.nestedCues.length;var s=document.createElement(r);if("br"!=r&&Vh(e,s,t,n,i),n=null,t.region&&t.region.id){var a=t.region,o=e.m===4/3?2.5:1.9;if(n=a.id+"_"+a.width+"x"+a.height+(a.heightUnits==gn?"%":"px")+"-"+a.viewportAnchorX+"x"+a.viewportAnchorY+(a.viewportAnchorUnits==gn?"%":"px"),e.F.has(n))n=e.F.get(n);else{r=document.createElement("span");var u=a.heightUnits==gn?"%":"px",l=a.widthUnits==gn?"%":"px",c=a.viewportAnchorUnits==gn?"%":"px";r.id="shaka-text-region---"+n,r.classList.add("shaka-text-region"),r.style.position="absolute";var d=a.height,h=a.width;2===a.heightUnits&&(d=5.33*a.height,u="%"),2===a.widthUnits&&(h=a.width*o,l="%"),r.style.height=d+u,r.style.width=h+l,2===a.viewportAnchorUnits?(o=a.viewportAnchorY/75*100,u=a.viewportAnchorX/(e.m===4/3?160:210)*100,o-=a.regionAnchorY*d/100,u-=a.regionAnchorX*h/100,r.style.top=o+"%",r.style.left=u+"%"):(r.style.top=a.viewportAnchorY-a.regionAnchorY*d/100+c,r.style.left=a.viewportAnchorX-a.regionAnchorX*h/100+c),0!==a.heightUnits&&0!==a.widthUnits&&0!==a.viewportAnchorUnits&&(a=Math.max(0,Math.min(100-(parseInt(r.style.width.slice(0,-1),10)||0),parseInt(r.style.left.slice(0,-1),10)||0)),r.style.top=Math.max(0,Math.min(100-(parseInt(r.style.height.slice(0,-1),10)||0),parseInt(r.style.top.slice(0,-1),10)||0))+"%",r.style.left=a+"%"),r.style.display="flex",r.style.flexDirection="column",r.style.alignItems="center",r.style.justifyContent="before"==t.displayAlign?"flex-start":"center"==t.displayAlign?"center":"flex-end",e.F.set(n,r),n=r}}r=s,i&&(r=document.createElement("span"),r.classList.add("shaka-text-wrapper"),r.style.backgroundColor=t.backgroundColor,r.style.lineHeight="normal",s.appendChild(r)),e.l.set(t,{lf:s,Mh:r,Cc:n})}function Gh(e){var t=e.direction,n=e.positionAlign;return e=e.textAlign,n!==yi?n:"left"===e||"start"===e&&t===wi||"end"===e&&"rtl"===t?"line-left":"right"===e||"start"===e&&"rtl"===t||"end"===e&&t===wi?"line-right":"center"}function Vh(e,t,n,i,r){var s=t.style,a=0==n.nestedCues.length,o=1<i.length;s.whiteSpace="pre-wrap";var u=n.payload.replace(/\s+$/g,(function(e){return" ".repeat(e.length)}));if(s.webkitTextStrokeColor=n.textStrokeColor,s.webkitTextStrokeWidth=n.textStrokeWidth,s.color=n.color,s.direction=n.direction,s.opacity=n.opacity,s.paddingLeft=Hh(n.linePadding,n,e.C),s.paddingRight=Hh(n.linePadding,n,e.C),s.textCombineUpright=n.textCombineUpright,s.textShadow=n.textShadow,n.backgroundImage)s.backgroundImage="url('"+n.backgroundImage+"')",s.backgroundRepeat="no-repeat",s.backgroundSize="contain",s.backgroundPosition="center",n.backgroundColor&&(s.backgroundColor=n.backgroundColor),s.width="100%",s.height="100%";else{if(n.nestedCues.length)var l=t;else l=document.createElement("span"),t.appendChild(l);n.border&&(l.style.border=n.border),r||((t=Kh(i,(function(e){return e.backgroundColor})))?l.style.backgroundColor=t:u&&(l.style.backgroundColor="rgba(0, 0, 0, 0.8)")),u&&(l.textContent=u)}o&&!i[i.length-1].isContainer?s.display="inline":(s.display="flex",s.flexDirection="column",s.alignItems="center","left"==n.textAlign||"start"==n.textAlign?(s.width="100%",s.alignItems="start"):"right"!=n.textAlign&&"end"!=n.textAlign||(s.width="100%",s.alignItems="end"),s.justifyContent="before"==n.displayAlign?"flex-start":"center"==n.displayAlign?"center":"flex-end"),a||(s.margin="0"),s.fontFamily=n.fontFamily,s.fontWeight=n.fontWeight.toString(),s.fontStyle=n.fontStyle,s.letterSpacing=n.letterSpacing,s.fontSize=Hh(n.fontSize,n,e.C,e.u?e.u.fontScaleFactor:1),i=n.line,null!=i&&(a=n.lineInterpretation,a==xi&&(a=1,o=16,e.m&&1>e.m&&(o=32),i=0>i?100+i/o*100:i/o*100),1==a&&(s.position="absolute",n.writingMode==Ai?(s.width="100%",n.lineAlign==Ii?s.top=i+"%":"end"==n.lineAlign&&(s.bottom=100-i+"%")):"vertical-lr"==n.writingMode?(s.height="100%",n.lineAlign==Ii?s.left=i+"%":"end"==n.lineAlign&&(s.right=100-i+"%")):(s.height="100%",n.lineAlign==Ii?s.right=i+"%":"end"==n.lineAlign&&(s.left=100-i+"%")))),s.lineHeight=n.lineHeight,e=Gh(n),"line-left"==e?(s.cssFloat="left",null!==n.position&&(s.position="absolute",n.writingMode==Ai?(s.left=n.position+"%",s.width="auto"):s.top=n.position+"%")):"line-right"==e?(s.cssFloat="right",null!==n.position&&(s.position="absolute",n.writingMode==Ai?(s.right=100-n.position+"%",s.width="auto"):s.bottom=n.position+"%")):null!==n.position&&50!=n.position&&(s.position="absolute",n.writingMode==Ai?(s.left=n.position+"%",s.width="auto"):s.top=n.position+"%"),s.textAlign=n.textAlign,s.textDecoration=n.textDecoration.join(" "),s.writingMode=n.writingMode,"writingMode"in document.documentElement.style&&s.writingMode==n.writingMode||(s.webkitWritingMode=n.writingMode),n.size&&(n.writingMode==Ai?s.width=n.size+"%":s.height=n.size+"%")}function Hh(e,t,n,i){i=void 0===i?1:i;var r=(r=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(r[1]),unit:r[2]}:null;if(!r)return e;switch(e=r.unit,i*=r.value,e){case"%":return i/100*n.clientHeight/t.cellResolution.rows+"px";case"c":return n.clientHeight*i/t.cellResolution.rows+"px";default:return i+e}}function Kh(e,t){for(var n=e.length-1;0<=n;n--){var i=t(e[n]);if(i||0===i)return i}return null}function Wh(e,t){function n(e){for(var n=e,i=d(t),r=i.next();!r.done;r=i.next())r=r.value,r.end&&r.start<e&&(n+=r.end-r.start);return e=Math.floor(n/3600),i=Math.floor(n/60%60),r=Math.floor(n%60),n=Math.floor(1e3*n%1e3),(10>e?"0":"")+e+":"+(10>i?"0":"")+i+":"+(10>r?"0":"")+r+"."+(100>n?10>n?"00":"0":"")+n}var i=Rh(e);e="WEBVTT\n\n",i=d(i);for(var r=i.next();!r.done;r=i.next())r=r.value,e+=n(r.startTime)+" --\x3e "+n(r.endTime)+function(e){var t=[];switch(e.textAlign){case"left":t.push("align:left");break;case"right":t.push("align:right");break;case bi:t.push("align:middle");break;case"start":t.push("align:start");break;case"end":t.push("align:end")}switch(e.writingMode){case"vertical-lr":t.push("vertical:lr");break;case"vertical-rl":t.push("vertical:rl")}return t.length?" "+t.join(" "):""}(r)+"\n",e+=r.payload+"\n\n";return e}function qh(e,t){this.h=e,this.g=t,this.i=void 0,this.u=!1,this.F=!0,this.l=this.B=!1,this.o=this.m=void 0,this.A=0,this.G=!1,this.C=new ae,this.j=null}function Yh(e){e.u=!1,e.F=!0,e.B=!1,e.l=!1,e.m=0,e.o=0,e.A=0,e.G=!1,e.j=null,e.C.Pa()}function Xh(e,t){e.l=t,e.l?e.i==yf?e.i=bf:e.i==Tf&&(e.i=Sf):e.i==bf?e.i=yf:e.i==Sf&&(e.i=Tf)}function zh(e,t){if(e.g&&e.g.enabled&&e.g.version==vf&&e.j&&e.j.autoplay){var n=e.j.play();n&&n.then((function(){e.A=t})).catch((function(){e.A=0}))}}function Qh(e,t,n){try{if(!e.g.enabled)return t;var i=Zh(e);e:{switch(n.toLowerCase()){case"audio/mp4":case"audio/webm":case"audio/ogg":case"audio/mpeg":case"audio/aac":case"audio/flac":case"audio/wav":var r=df;break e;case"video/webm":case"video/mp4":case"video/mpeg":case"video/mp2t":r=ff;break e;case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"application/dash+xml":case"video/vnd.mpeg.dash.mpd":case"application/vnd.ms-sstr+xml":r=cf;break e}r=void 0}i.ot=r,i.su=!0;var s=of(i);return lf(t,s)}catch(a){return ee("CMCD_SRC_ERROR","Could not generate src CMCD data.",a),t}}function Jh(e){e.C.qa(e.j,"play",(function(){e.m||(e.m=Date.now())})),e.C.qa(e.j,"playing",(function(){e.o||(e.o=Date.now())}))}function Zh(t){return t.g.sessionId||(t.g.sessionId=e.crypto.randomUUID()),{v:t.g.version,sf:t.i,sid:t.g.sessionId,cid:t.g.contentId,mtp:t.h.getBandwidthEstimate()/1e3}}function ef(e,t,n){n=void 0===n?{}:n;var i=void 0===i?e.g.useHeaders:i;if(e.g.enabled){Object.assign(n,Zh(e)),n.pr=e.h.eb();var r=n.ot===hf||n.ot===ff;if(e.B&&r&&(n.bs=!0,n.su=!0,e.B=!1),null==n.su&&(n.su=e.F),n.v===vf&&(e.h.U()&&(n.ltc=e.h.ae()),r=!e.G&&e.o&&e.m?e.o-(e.A||e.m):void 0,void 0!=r&&(n.msd=r,e.G=!0)),e=tf(e,n),i)i=uf(e),Object.keys(i).length&&Object.assign(t.headers,i);else{var s=of(e);s&&(t.uris=t.uris.map((function(e){return lf(e,s)})))}}}function tf(e,t){var n=e.g.includeKeys;return n.length?Object.keys(t).reduce((function(e,i){return n.includes(i)&&(e[i]=t[i]),e}),{}):t}function nf(e){if(0===e.type)return pf;if(e=e.stream){var t=e.type;if("video"==t)return e.codecs&&e.codecs.includes(",")?ff:hf;if("audio"==t)return df;if("text"==t)return"application/mp4"===e.mimeType?mf:gf}}function rf(e,t){if(t=e.h.wb()[t],!t.length)return NaN;var n=e.h.getCurrentTime();return(e=t.find((function(e){return e.start<=n&&e.end>=n})))?1e3*(e.end-n):NaN}function sf(e,t){if(t=e.h.wb()[t],!t.length)return 0;var n=e.h.getCurrentTime();return(e=t.find((function(e){return e.start<=n&&e.end>=n})))?1e3*(e.end-n):0}function af(e,t){var n=e.h.Pb();if(!n.length)return NaN;e=n[0],n=d(n);for(var i=n.next();!i.done;i=n.next())i=i.value,"variant"===i.type&&i.bandwidth>e.bandwidth&&(e=i);switch(t){case hf:return e.videoBandwidth||NaN;case df:return e.audioBandwidth||NaN;default:return e.bandwidth}}function of(e){function t(e){return 100*n(e/100)}function n(e){return Math.round(e)}function i(e){return!Number.isNaN(e)&&null!=e&&""!==e&&!1!==e}var r=[],s={br:n,d:n,bl:t,dl:t,mtp:t,nor:function(e){return encodeURIComponent(e)},rtp:t,tb:n},a=Object.keys(e||{}).sort();a=d(a);for(var o=a.next();!o.done;o=a.next()){o=o.value;var u=e[o];if(i(u)&&("v"!==o||1!==u)&&("pr"!=o||1!==u)){var l=s[o];l&&(u=l(u)),l=typeof u;var c=void 0;c="string"===l&&"ot"!==o&&"sf"!==o&&"st"!==o?o+"="+JSON.stringify(u):"boolean"===l?o:"symbol"===l?o+"="+u.description:o+"="+u,r.push(c)}}return r.join(",")}function uf(e){var t=Object.keys(e),n={},i=["Object","Request","Session","Status"],r=[{},{},{},{}],s={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,ltc:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,msd:2,bs:3,rtp:3};t=d(t);for(var a=t.next();!a.done;a=t.next())a=a.value,r[null!=s[a]?s[a]:1][a]=e[a];for(e=0;e<r.length;e++)(s=of(r[e]))&&(n["CMCD-"+i[e]]=s);return n}function lf(e,t){return!t||e.includes("offline:")?e:(e=new ve(e),e.g.set("CMCD",t),e.toString())}i=Mh.prototype,i.configure=function(){},i.remove=function(e,t){return!!this.g&&(_h(this.g,(function(n){return n.startTime<t&&n.endTime>e})),!0)},i.append=function(e){if(this.g){var t=Rh(e),n=[];e=this.g.cues?Array.from(this.g.cues):[],t=d(t);for(var i=t.next(),r={};!i.done;r={Rc:void 0},i=t.next())r.Rc=i.value,!e.some(function(e){return function(t){return t.startTime==e.Rc.startTime&&t.endTime==e.Rc.endTime&&t.text==e.Rc.payload}}(r))&&r.Rc.payload&&(i=Dh(r.Rc))&&n.push(i);for(e=n.slice().sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?n.indexOf(t)-n.indexOf(e):n.indexOf(e)-n.indexOf(t)})),e=d(e),t=e.next();!t.done;t=e.next())this.g.addCue(t.value)}},i.destroy=function(){return this.g&&(_h(this.g,(function(){return!0})),this.g.mode="disabled"),this.g=this.h=null,Promise.resolve()},i.isTextVisible=function(){return!!this.g&&"showing"==this.g.mode},i.setTextVisibility=function(e){e&&!this.g&&Ph(this),this.g&&(this.g.mode=e?"showing":"hidden")},i.setTextLanguage=function(){},i.enableTextDisplayer=function(){Ph(this)},K("shaka.text.SimpleTextDisplayer",Mh),Mh.prototype.enableTextDisplayer=Mh.prototype.enableTextDisplayer,Mh.prototype.setTextLanguage=Mh.prototype.setTextLanguage,Mh.prototype.setTextVisibility=Mh.prototype.setTextVisibility,Mh.prototype.isTextVisible=Mh.prototype.isTextVisible,Mh.prototype.destroy=Mh.prototype.destroy,Mh.prototype.append=Mh.prototype.append,Mh.prototype.remove=Mh.prototype.remove,Mh.prototype.configure=Mh.prototype.configure,i=Oh.prototype,i.configure=function(){},i.remove=function(){},i.append=function(){},i.destroy=function(){},i.isTextVisible=function(){return!1},i.setTextVisibility=function(){},i.setTextLanguage=function(){},i.enableTextDisplayer=function(){},K("shaka.text.StubTextDisplayer",Oh),Oh.prototype.enableTextDisplayer=Oh.prototype.enableTextDisplayer,Oh.prototype.setTextLanguage=Oh.prototype.setTextLanguage,Oh.prototype.setTextVisibility=Oh.prototype.setTextVisibility,Oh.prototype.isTextVisible=Oh.prototype.isTextVisible,Oh.prototype.destroy=Oh.prototype.destroy,Oh.prototype.append=Oh.prototype.append,Oh.prototype.remove=Oh.prototype.remove,Oh.prototype.configure=Oh.prototype.configure,i=Nh.prototype,i.configure=function(e){this.u=e,Uh(this),jh(this,!0)},i.append=function(e){var t=[].concat(h(this.h));e=d(Ch(e));for(var n=e.next(),i={};!n.done;i={kf:void 0},n=e.next())i.kf=n.value,t.some(function(e){return function(t){return hi(t,e.kf)}}(i))||this.h.push(i.kf);this.h.length&&Uh(this),jh(this)},i.destroy=function(){return this.g?(this.C.removeChild(this.g),this.g=null,this.A=!1,this.h=[],this.o&&(this.o.stop(),this.o=null),this.l.clear(),this.i&&(this.i.release(),this.i=null),this.B&&(this.B.disconnect(),this.B=null),Promise.resolve()):Promise.resolve()},i.remove=function(e,t){if(!this.g)return!1;var n=this.h.length;return this.h=this.h.filter((function(n){return n.startTime<e||n.endTime>=t})),jh(this,n>this.h.length),this.h.length||Uh(this),!0},i.isTextVisible=function(){return this.A},i.setTextVisibility=function(e){this.A=e,jh(this,!0)},i.setTextLanguage=function(e){e&&"und"!=e?this.g.setAttribute("lang",e):this.g.setAttribute("lang","")},i.enableTextDisplayer=function(){},K("shaka.text.UITextDisplayer",Nh),Nh.prototype.enableTextDisplayer=Nh.prototype.enableTextDisplayer,Nh.prototype.setTextLanguage=Nh.prototype.setTextLanguage,Nh.prototype.setTextVisibility=Nh.prototype.setTextVisibility,Nh.prototype.isTextVisible=Nh.prototype.isTextVisible,Nh.prototype.remove=Nh.prototype.remove,Nh.prototype.destroy=Nh.prototype.destroy,Nh.prototype.append=Nh.prototype.append,Nh.prototype.configure=Nh.prototype.configure,K("shaka.text.WebVttGenerator",(function(){})),qh.prototype.setMediaElement=function(e){this.j=e,Jh(this)},qh.prototype.configure=function(e){this.g=e};var cf="m",df="a",hf="v",ff="av",pf="i",gf="c",mf="tt",vf=2,yf="d",bf="ld",Tf="h",Sf="lh";function Ef(e){this.h=e,this.g=null}function wf(e){return!e||"false"!==e.toLowerCase()&&(/^[-0-9]/.test(e)?parseInt(e,10):e.replace(/["]+/g,""))}K("shaka.util.CmcdManager.StreamingFormat",{DASH:yf,hk:bf,HLS:Tf,ik:Sf,wk:"s",OTHER:"o"}),i=Ef.prototype,i.configure=function(e){this.h=e},i.Tg=function(){return this.h.enabled&&this.h.applyMaximumSuggestedBitrate&&this.g&&this.g.has(xf)?1e3*this.g.get(xf):null},i.Rg=function(){return this.h.enabled&&this.g&&this.g.has(Af)?1e3*this.g.get(Af):null},i.Ci=function(){return this.h.enabled&&this.g&&this.g.has(If)?this.g.get(If):null},i.Di=function(){return this.h.enabled&&this.g&&this.g.has(kf)?this.g.get(kf):null},i.getBandwidthEstimate=function(e){var t=this.Rg();if(!t)return e;var n=this.h.estimatedThroughputWeightRatio;return 0<n&&1>=n?e*(1-n)+t*n:e},K("shaka.util.CmsdManager",Ef),Ef.prototype.getBandwidthEstimate=Ef.prototype.getBandwidthEstimate,Ef.prototype.getRoundTripTime=Ef.prototype.Di,Ef.prototype.getResponseDelay=Ef.prototype.Ci,Ef.prototype.getEstimatedThroughput=Ef.prototype.Rg,Ef.prototype.getMaxBitrate=Ef.prototype.Tg;var Af="etp",xf="mb",If="rd",kf="rtt";function Lf(){this.g=null,this.h=[]}function Rf(e,t){return U((function(n){if(1==n.g)return e.g?w(n,new Promise((function(t){return e.h.push(t)})),2):n.s(2);e.g=t,A(n)}))}function Cf(t,n,i){n=void 0===n?null:n,Rs.call(this);var r=this;this.m=Zp,this.h=null,this.Fe=n,this.na=!1,this.Ue=new ae,this.xd=new ae,this.l=new ae,this.Ma=new ae,this.Qb=new ae,this.G=this.I=this.C=this.F=null,this.Nd=0,this.$=new Lf,this.Z=this.Nb=this.T=this.i=this.Ob=this.H=this.j=this.vd=this.O=this.yg=this.fa=this.L=this.Fa=this.za=this.wd=this.M=this.oa=this.K=this.Ka=null,this.sa=!1,this.Ea=this.o=null,this.ye=1e9,this.Te=[],this.Hd=[],this.We=-1,this.g=wp(this),this.Xe=Yd(),this.P=null,this.Od=-1,this.La=null,this.ka={width:1/0,height:1/0},this.ve=new ro(this.g,this.ka,null),this.Pe=[],this.A=null,this.W=this.g.adaptationSetCriteriaFactory(),this.W.configure({language:this.g.preferredAudioLanguage,role:this.g.preferredVariantRole,channelCount:this.g.preferredAudioChannelCount,Qc:this.g.preferredVideoHdrLevel,spatialAudio:this.g.preferSpatialAudio,videoLayout:this.g.preferredVideoLayout,Ic:this.g.preferredAudioLabel,dd:this.g.preferredVideoLabel,codecSwitchingStrategy:this.g.mediaSource.codecSwitchingStrategy,audioCodec:""}),this.Rb=this.g.preferredTextLanguage,this.Fd=this.g.preferredTextRole,this.Dd=this.g.preferForcedSubs,this.zd=[],i&&i(this),this.L=lp(this),this.fa=new Ef(this.g.cmsd),this.F=tp(this),this.F.kg(this.g.streaming.forceHTTP),this.F.lg(this.g.streaming.forceHTTPS),this.F.o=this.g.streaming.minBytesForProgressEvents,this.Sb=this.ea=this.B=null,this.Ze=!1,this.Ye=new ze((function(){return U((function(e){return 1==e.g?r.ea?w(e,r.Jb(r.Sb,!0),3):e.s(0):4!=e.g?w(e,r.load(r.ea),4):(r.Ze?r.Sb.pause():r.Sb.play(),r.ea=null,r.Ze=!1,void A(e))}))})),rg&&(this.B=rg(),this.B.configure(this.g.ads),this.Qb.D(this.B,"ad-content-pause-requested",(function(e){var t;return U((function(n){if(1==n.g)return r.Ye.stop(),r.ea?n.s(0):(r.Sb=r.h,r.Ze=r.Sc(),t=e.saveLivePosition||!1,w(n,r.Lg(!0,t),3));r.ea=n.h,A(n)}))})),this.Qb.D(this.B,"ad-content-resume-requested",(function(e){if(e=e.offset||0,r.ea){var t=r.ea;t.B&&e&&(t.B+=e)}r.Ye.da(.1)})),this.Qb.D(this.B,"ad-content-attach-requested",(function(){return U((function(e){return r.h||!r.Sb?e.s(0):w(e,r.Jb(r.Sb,!0),0)}))}))),this.Ue.D(e,"online",(function(){Vp(r),r.eg()})),this.He=new ze((function(){for(var e=Date.now()/1e3,t=!1,n=!0,i=d(r.i.variants),s=i.next();!s.done;s=i.next())s=s.value,0<s.disabledUntilTime&&s.disabledUntilTime<=e&&(s.disabledUntilTime=0,t=!0),0<s.disabledUntilTime&&(n=!1);n&&r.He.stop(),t&&Mp(r,!1,void 0,!1,!1)})),this.ya=null,t&&(he("Player w/ mediaElement","Please migrate from initializing Player with a mediaElement; use the attach method instead."),this.Jb(t,!0)),this.u=null}function Df(e){null!=e.O&&(Zt(e.O),e.O.release(),e.O=null)}function Mf(e,t,n){n||t.lcevc.enabled?(Df(e),null==e.O&&(e.O=new Qt(e.h,e.yg,t.lcevc,n),e.I&&(e.I.K=e.O))):Df(e)}function Pf(e,t){return new Is(e,t)}function _f(e,t){ig.set(e,t)}function Of(e,t){e.dispatchEvent(Pf("onstatechange",(new Map).set("state",t)))}function Nf(e,t){var n;return U((function(i){return 1==i.g?(n=++e.Nd,w(i,Rf(e.$,t),2)):n!=e.Nd?(e.$.release(),i.return(!0)):i.return(!1)}))}function Uf(e){for(var t=d(e.i.variants),n=t.next();!n.done;n=t.next())n=n.value,n.video&&(n.video.closeSegmentIndex(),n.video=null),n.bandwidth=n.audio&&n.audio.bandwidth?n.audio.bandwidth:0;e.i.variants=e.i.variants.filter((function(e){return e.audio}))}function Ff(e,t){var n,i;return t=void 0!==t&&t,U((function(r){if(1==r.g)return n=null,e.i&&e.H&&e.Ob&&e.T?(i=e.h.currentTime,e.U()&&!t&&(i=null),w(r,jf(e,e.T,i,e.Nb,!0,!1,!1),3)):r.s(2);if(2!=r.g){n=r.h,e.Pe.push(n),e.H&&e.H.setMediaElement&&e.H.setMediaElement(null);var s=n,a=e.H,o=e.Ob;s.h=e.i,s.l=a,s.G=o,s=n,a=e.Ea,s.j=e.o,s.C=a,n.o=e.W,n.start(),e.i=null,e.H=null,e.Ob=null,e.o=null,e.Ea=null}return r.return(n)}))}function Bf(e,t,n,i,r){var s,a,o;return r=void 0!==r&&r,U((function(u){return 1==u.g?i?u.s(2):w(u,$f(e,t),3):(2!=u.g&&(i=u.h),Gf(e,i)?u.return(null):(s=!1,a=!0,r&&(e.o&&e.Ea==e.g.abrFactory&&(a=!1),e.h&&"AUDIO"===e.h.nodeName&&(s=!0)),o=jf(e,t,n,i||null,!r,s,a),o=r?o.then((function(e){return e.A=!1,e})):o.then((function(t){return e.Pe.push(t),t})),u.return(o)))}))}function jf(e,t,n,i,r,s,a){var o,u,l,c,h,f,p,g,m,v,y,b,T,S;return r=void 0===r||r,s=void 0!==s&&s,a=void 0===a||a,U((function(E){return 1==E.g?(o=null,u=Ln(e.g),s&&(u.manifest.disableVideo=!0),l=function(){return o.T&&o.u?null:o},c=function(){return l()?l().getConfiguration():e.g},1/0!=e.ka.width||1/0!=e.ka.height||e.g.ignoreHardwareResolution?E.s(2):w(E,St(),3)):(2!=E.g&&(h=E.h,e.ka.width=h.width,e.ka.height=h.height),f=new ro(u,e.ka,null),p={networkingEngine:e.F,filter:function(e){var t,n;return U((function(i){return 1==i.g?w(i,so(f,e),2):4!=i.g?(t=i.h,t?(n=Pf("trackschanged"),w(i,Promise.resolve(),4)):i.s(0)):(o.dispatchEvent(n),void A(i))}))},makeTextStreamsForClosedCaptions:function(t){return Ap(e,t)},onTimelineRegionAdded:function(e){Tc(o.H,e)},onEvent:function(e){return o.dispatchEvent(e)},onError:function(e){return o.onError(e)},isLowLatencyMode:function(){return c().streaming.lowLatencyMode},updateDuration:function(){e.j&&o.T&&e.j.updateDuration()},newDrmInfo:function(e){var t=o.i,n=t?t.h:null;n&&t.A&&uo(f,n.keySystem,e)},onManifestUpdated:function(){var t=(new Map).set("isLive",e.U());o.dispatchEvent(Pf("manifestupdated",t)),ah(o,!1,(function(){e.B&&e.B.onManifestUpdated(e.U())}))},getBandwidthEstimate:function(){return e.o.getBandwidthEstimate()},onMetadata:function(t,n,i,r){var s=t;"com.apple.hls.interstitial"==t&&(s="com.apple.quicktime.HLS",t={startTime:n,endTime:i,values:r},e.B)&&e.B.onHLSInterstitialMetadata(e,e.h,t),r=d(r),t=r.next();for(var a={};!t.done;a={Zf:void 0},t=r.next())a.Zf=t.value,"ID"!=a.Zf.name&&ah(o,!1,function(t){return function(){Zf(e,n,i,s,t.Zf)}}(a))},disableStream:function(t){return e.disableStream(t,e.g.streaming.maxDisabledTime)},addFont:function(t,n){return e.addFont(t,n)}},g=new bc((function(){return e.Ta()})),g.addEventListener("regionadd",(function(t){var n=t.region;Kp(e,"timelineregionadded",n,o),ah(o,!1,(function(){e.B&&(e.B.onDashTimedMetadata(n),e.B.onDASHInterstitialMetadata(e,e.h,n))}))})),m=null,u.streaming.observeQualityChanges&&(m=new fc((function(){return e.wb()})),m.addEventListener("qualitychange",(function(t){Wp(e,t.quality,t.position)})),m.addEventListener("audiotrackchange",(function(t){Wp(e,t.quality,t.position,!0)}))),v=!0,y={Vb:e.F,onError:function(e){return o.onError(e)},re:function(t){ah(o,!0,(function(){if(e.C){var n=t,i=Pf("keystatuschanged");e.dispatchEvent(i);var r=Object.keys(n);1==r.length&&""==r[0]&&(r=["00"],n={"00":n[""]}),i=1==r.length&&"00"==r[0];var s=!1;if(r.length){r=e.keySystem();for(var a=Xs(e.g.drm.clearKeys),o=d(e.i.variants),u=o.next();!u.done;u=o.next()){u=u.value;var l=[];u.audio&&l.push(u.audio),u.video&&l.push(u.video),l=d(l);for(var c=l.next();!c.done;c=l.next()){var h=c.value;if(c=u.allowedByKeySystem,h.keyIds.size)if(h.drmInfos.length&&!a.size){h=d(h.drmInfos);for(var f=h.next();!f.done;f=h.next())if(f=f.value,f.keyIds.size&&f.keySystem==r){u.allowedByKeySystem=!0,f=d(f.keyIds);for(var p=f.next();!p.done;p=f.next())p=p.value,((p=n[i?"00":p])||e.C.F)&&(u.allowedByKeySystem=u.allowedByKeySystem&&!!p&&!co.includes(p))}}else for(u.allowedByKeySystem=!0,h=d(h.keyIds),f=h.next();!f.done;f=h.next())f=f.value,((f=n[i?"00":f])||e.C.F)&&(u.allowedByKeySystem=u.allowedByKeySystem&&!!f&&!co.includes(f));c!=u.allowedByKeySystem&&(s=!0)}}}s&&(Op(e),!Dp(e))||(n=e.j.l)&&!n.allowedByKeySystem&&Mp(e)}}))},onExpirationUpdated:function(e,t){var n=Pf("expirationupdated");o.dispatchEvent(n),(n=o.l)&&n.onExpirationUpdated&&n.onExpirationUpdated(e,t)},onEvent:function(t){o.dispatchEvent(t),"drmsessionupdate"==t.type&&v&&(v=!1,t=Date.now()/1e3-o.ya,(e.A||o.getStats()).j=t,e.O&&Zt(e.O))}},b=tp(e,l),_s(e.F,b),T=function(){return e.Jc(y)},S={config:u,$i:p,kj:g,jj:m,Jc:T,Zi:f,networkingEngine:b,Th:r,Sh:a},o=new sh(t,i,n,S),E.return(o))}))}function $f(e,t){var n,i;return U((function(r){return 1==r.g?(n=e.g.manifest.retryParameters,w(r,xh(t,e.F,n),2)):(i=r.h,"application/x-mpegurl"==i&&ot()&&(i="application/vnd.apple.mpegurl"),r.return(i))}))}function Gf(e,t){if(!Qe())return!0;if(t){if(""==(e.h||bt()).canPlayType(t))return!1;if(!Qe()||!mo.has(t))return!0;if(tr(t))return ot()&&(e.g.drm.servers["com.apple.fps"]||e.g.drm.servers["com.apple.fps.1_0"])?e.g.streaming.useNativeHlsForFairPlay:e.g.streaming.preferNativeHls;if("application/dash+xml"===t||"video/vnd.mpeg.dash.mpd"===t)return e.g.streaming.preferNativeDash}return!1}function Vf(e){var t=e.g.textDisplayFactory;t!==e.Ve&&(e.u=t(),e.u.configure?e.u.configure(e.g.textDisplayer):he("Text displayer w/ configure",'Text displayer should have a "configure" method!'),e.Ve=t,e.u.setTextVisibility(e.na))}function Hf(e){var t,n,i;return U((function(r){if(1==r.g)return Of(e,"media-source"),e.h.removeAttribute("src"),Tu(e.h),Vf(e),t=up(e.h,e.u,{si:function(){return e.keySystem()},onMetadata:function(t,n,i){t=d(t);for(var r=t.next();!r.done;r=t.next())if(r=r.value,r.data&&"number"==typeof r.cueTime&&r.frames){var s=r.cueTime+n,a=i;a&&s>a&&(a=s);for(var o=d(r.frames),u=o.next();!u.done;u=o.next())Zf(e,s,a,"org.id3",u.value);e.B&&e.B.onHlsTimedMetadata(r,s)}},ej:function(t){e.Fa&&Tc(e.Fa,{schemeIdUri:t.schemeIdUri,startTime:t.startTime,endTime:t.endTime,id:String(t.id),emsg:t})},onEvent:function(t){return e.dispatchEvent(t)},gj:function(){e.H&&e.H.update&&e.H.update()}},e.O),t.configure(e.g.mediaSource),n=e.g.manifest,i=n.segmentRelativeVttTiming,t.Da=i,w(r,t.I,2);e.I=t,A(r)}))}function Kf(e,t,n){function i(){return Lp(e)}e.l.D(t,"playing",i),e.l.D(t,"pause",i),e.l.D(t,"ended",i),e.l.D(t,"ratechange",(function(){var t=e.h.playbackRate;0!=t&&(e.K&&(e.K.set(t),e.m==eg&&e.o.playbackRateChanged(t),kp(e,t)),t=Pf("ratechange"),e.dispatchEvent(t))})),t.remote&&(e.l.D(t.remote,"connect",(function(){return Op(e)})),e.l.D(t.remote,"connecting",(function(){return Op(e)})),e.l.D(t.remote,"disconnect",(function(){return U((function(n){if(1==n.g)return e.j&&"disconnected"==t.remote.state?w(n,Ed(e.j),2):n.s(2);Op(e),A(n)}))}))),t.audioTracks&&(e.l.D(t.audioTracks,"addtrack",(function(){return Op(e)})),e.l.D(t.audioTracks,"removetrack",(function(){return Op(e)})),e.l.D(t.audioTracks,"change",(function(){return Op(e)}))),t.textTracks&&(e.l.D(t.textTracks,"addtrack",(function(t){if(t.track)switch(t=t.track,t.kind){case"metadata":Qf(e,t);break;case"chapters":ep(e,t);break;default:Op(e)}})),e.l.D(t.textTracks,"removetrack",(function(){return Op(e)})),e.l.D(t.textTracks,"change",(function(){return Op(e)})),"keep"!==e.g.streaming.crossBoundaryStrategy&&(e.l.D(t,"waiting",(function(){e.j&&Ad(e.j)})),e.l.D(t,"timeupdate",(function(){e.j&&Ad(e.j)})))),"none"!=t.preload&&e.l.qa(t,"loadedmetadata",(function(){e.A.C=Date.now()/1e3-n}))}function Wf(e,t,n,i){var r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,x,I,k,L,R,C,D,M;return U((function(P){switch(P.g){case 1:for(Of(e,"load"),r=e.h,e.K=new lc({be:function(){return r.playbackRate},sc:function(){return r.defaultPlaybackRate},mg:function(e){r.playbackRate=e},fh:function(e){r.currentTime+=e}}),Kf(e,r,t),s=!1,a=d(e.i.variants),o=a.next();!o.done;o=a.next())u=o.value,(l=u.video&&u.video.dependencyStream)&&(s=en(l));Mf(e,e.g,s),e.Rb=e.g.preferredTextLanguage,e.Fd=e.g.preferredTextRole,e.Dd=e.g.preferForcedSubs,Yp(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.o.init((function(t,n,i){e.i&&e.j&&t!=e.j.l&&Pp(e,t,!0,void 0!==n&&n,void 0===i?0:i)})),e.o.setMediaElement(r),e.o.setCmsdManager(e.fa),e.j=cp(e),e.j.configure(e.g.streaming),e.m=eg,e.dispatchEvent(Pf("streaming")),c=n;case 2:for((f=e.j.l)||c||(c=Dp(e)?e.o.chooseVariant():null),p=[],h=f||c,g=d([h.video,h.audio]),m=g.next();!m.done;m=g.next())(v=m.value)&&!v.segmentIndex&&(p.push(v.createSegmentIndex()),v.dependencyStream&&p.push(v.dependencyStream.createSegmentIndex()));if(!(0<p.length)){P.s(4);break}return w(P,Promise.all(p),4);case 4:if(!h||0!=h.disabledUntilTime){P.s(2);break}if(e.H&&e.H.onInitialVariantChosen&&e.H.onInitialVariantChosen(h),e.i.isLowLatency&&(e.g.streaming.lowLatencyMode?e.configure(e.Xe):Z("Low-latency live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.")),e.L&&(Xh(e.L,e.i.isLowLatency&&e.g.streaming.lowLatencyMode),zh(e.L,1e3*t)),Yp(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),Vc(e.j,e.g.playRangeStart,e.g.playRangeEnd),y=function(t){e.G=np(e,t),e.Ka=ip(e,t),sp(e,r,!1)},e.g.streaming.startAtSegmentBoundary||(b=e.Z,null==b&&e.i.startTime&&(b=e.i.startTime),y(b)),f){P.s(7);break}if(!e.g.streaming.startAtSegmentBoundary){P.s(8);break}return T=e.i.presentationTimeline,S=e.Z||e.h.currentTime,null==e.Z&&e.i.startTime&&(S=e.i.startTime),E=T.Fb(),x=T.mb(),S<E?S=E:S>x&&(S=x),w(P,xp(c,S),9);case 9:I=P.h,y(I);case 8:Pp(e,c,!0,!1,0);case 7:return e.G.ready(),k=e.tc().find((function(e){return e.active})),k||((L=ts(e.i.textStreams,e.Rb,e.Fd,e.Dd)[0]||null)&&ih(e.A.h,L,!0),c&&(L?(ss(c.audio,L,e.g)&&(e.na=!0),e.na&&e.u.setTextVisibility(!0)):(e.na=!1,e.u.setTextVisibility(!1)),jp(e)),L&&(e.g.streaming.alwaysStreamText||e.Pf())&&(Yc(e.j,L),Gp(e))),w(P,e.j.start(i),10);case 10:e.g.abr.enabled&&(e.o.enable(),$p(e)),Op(e),Dp(e),e.i.variants.some((function(e){return e.primary})),((R=e.U())&&(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled||e.i.serviceDescription||e.g.streaming.liveSync.panicMode)||e.g.streaming.vodDynamicPlaybackRate)&&(C=function(){return Rp(e)},e.l.D(r,"timeupdate",C)),R||(D=function(){return Cp(e)},e.l.D(r,"timeupdate",D),Cp(e),e.i.nextUrl&&(0<e.g.streaming.preloadNextUrlWindow&&(M=function(){var t;return U((function(n){if(1==n.g)return t=e.Ta().end-e.h.currentTime,!isNaN(t)&&t<=e.g.streaming.preloadNextUrlWindow?(e.l.Ia(r,"timeupdate",M),w(n,e.preload(e.i.nextUrl),4)):n.s(0);e.ya=n.h,A(n)}))},e.l.D(r,"timeupdate",M)),e.l.D(r,"ended",(function(){e.load(e.ya||e.i.nextUrl)})))),e.B&&e.B.onManifestUpdated(R),e.sa=!0,A(P)}}))}function qf(e,t){var n,i,r,s,a;return U((function(o){return 1==o.g?(n=Yt,i=Date.now()/1e3,r=!0,e.C=e.Jc({Vb:e.F,onError:function(t){Hp(e,t)},re:function(){},onExpirationUpdated:function(){var t=Pf("expirationupdated");e.dispatchEvent(t)},onEvent:function(t){e.dispatchEvent(t),"drmsessionupdate"==t.type&&r&&(r=!1,e.A.j=Date.now()/1e3-i)}}),e.C.configure(e.g.drm),s={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},a={id:0,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:t?Zi(t):"",codecs:t?er(t):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:n.la,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null},a.fullMimeTypes.add(Wi(a.mimeType,a.codecs)),t.startsWith("audio/")?(a.type=n.V,s.audio=a):s.video=a,e.C.$=!0,w(o,ma(e.C,[s],[]),2)):w(o,e.C.Jb(e.h),0)}))}function Yf(e,t,n){var i,r,s,a,o,u,l,c,h,f,p,g;return U((function(m){switch(m.g){case 1:if(Of(e,"src-equals"),i=e.h,e.G=new Zl(i),r=!1,e.zd.push((function(){r=!0})),null!=e.Z&&e.G.af(e.Z),e.Ka=rp(e,e.Z||0),e.K=new lc({be:function(){return i.playbackRate},sc:function(){return i.defaultPlaybackRate},mg:function(e){i.playbackRate=e},fh:function(e){i.currentTime+=e}}),sp(e,i,!0),i.textTracks&&(Vf(e),s=function(){var t=mp(e).find((function(e){return"disabled"!==e.mode}));t&&(t.mode="showing"),(t=vp(e))&&(t.mode="hidden")},a=function(){var t=mp(e).find((function(e){return"disabled"!==e.mode}));t&&(t.mode="hidden"),t=vp(e);var n=e.u.isTextVisible();t&&n&&(t.mode="showing")},e.l.D(i,"enterpictureinpicture",(function(){return s()})),e.l.D(i,"leavepictureinpicture",(function(){return a()})),i.remote?(e.l.D(i.remote,"connect",(function(){return a()})),e.l.D(i.remote,"connecting",(function(){return a()})),e.l.D(i.remote,"disconnect",(function(){return a()}))):"webkitCurrentPlaybackTargetIsWireless"in i&&e.l.D(i,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return a()})),o=i,o.webkitSupportsFullscreen&&e.l.D(o,"webkitpresentationmodechanged",(function(){"inline"!=o.webkitPresentationMode?s():a()}))),Kf(e,i,t),u=Qh(e.L,e.T,n),!u.includes("#t=")&&(0<e.g.playRangeStart||isFinite(e.g.playRangeEnd))&&(u+="#t=",0<e.g.playRangeStart&&(u+=e.g.playRangeStart),isFinite(e.g.playRangeEnd)&&(u+=","+e.g.playRangeEnd)),!e.I){m.s(2);break}return w(m,e.I.destroy(),3);case 3:e.I=null;case 2:return Tu(i),i.src=u,(tt()||it())&&i.load(),"none"!=i.preload&&!i.autoplay&&tr(n)&&ot()&&i.load(),e.m=tg,e.dispatchEvent(Pf("streaming")),l=new ys,Hl(i,HTMLMediaElement.HAVE_METADATA,e.l,(function(){e.G.ready(),l.resolve()})),c=function(){return new Promise((function(t){var n=new ze(t);e.l.D(i.textTracks,"change",(function(){return n.da(.5)})),n.da(.5)}))},Hl(i,HTMLMediaElement.HAVE_CURRENT_DATA,e.l,(function(){var t,n,i,s,a;return U((function(o){if(1==o.g)return w(o,c(),2);if(r)return o.return();for(Xf(e),t=mp(e),t.some((function(e){return"showing"===e.mode}))&&(e.na=!0,e.u.setTextVisibility(!0)),t.length&&(e.u.enableTextDisplayer?e.u.enableTextDisplayer():he("Text displayer w/ enableTextDisplayer",'Text displayer should have a "enableTextDisplayer" method!')),n=!1,i=d(t),s=i.next();!s.done;s=i.next())a=s.value,"disabled"!==a.mode&&(n?(a.mode="disabled",Z("Found more than one enabled text track, disabling it",a)):(gp(e,a),n=!0));zf(e),A(o)}))})),i.error?l.reject(qp(e)):"none"==i.preload&&(Z('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),l.resolve()),e.l.qa(i,"error",(function(){l.reject(qp(e))})),w(m,yr(e.g.streaming.loadTimeout,l),4);case 4:((h=e.U())&&(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled||e.g.streaming.liveSync.panicMode)||e.g.streaming.vodDynamicPlaybackRate)&&(f=function(){return Rp(e)},e.l.D(i,"timeupdate",f)),h||(p=function(){return Cp(e)},e.l.D(i,"timeupdate",p),Cp(e)),e.B&&(e.B.onManifestUpdated(h),h&&(g=e.Ta().end,e.l.D(i,"progress",(function(){var t=e.Ta().end;g!=t&&(e.B.onManifestUpdated(e.U()),g=t)})))),e.sa=!0,A(m)}}))}function Xf(e){var t=e.g.preferredAudioLanguage;""!=t&&e.rh(t,e.g.preferredVariantRole)}function zf(e){var t=e.g.preferredTextLanguage;""!=t&&e.hg(t,e.g.preferredTextRole,e.g.preferForcedSubs)}function Qf(e,t){if("metadata"==t.kind){t.mode="hidden",e.l.D(t,"cuechange",(function(){if(t.activeCues)for(var n=d(t.activeCues),i=n.next();!i.done;i=n.next())i=i.value,Zf(e,i.startTime,i.endTime,i.type,i.value),e.B&&e.B.onCueMetadataChange(i.value);if(t.cues){n=[],i=d(t.cues);for(var r=i.next(),s={};!r.done;s={$b:void 0},r=i.next())s.$b=r.value,"com.apple.quicktime.HLS"==s.$b.type&&null!=s.$b.startTime&&(r=n.find(function(e){return function(t){return t.startTime==e.$b.startTime&&t.endTime==e.$b.endTime}}(s)),r||(r={startTime:s.$b.startTime,endTime:s.$b.endTime,values:[]},n.push(r)),r.values.push(s.$b.value));for(n=d(n),i=n.next();!i.done;i=n.next())i=i.value,i.values.some((function(e){return"X-ASSET-URI"==e.key||"X-ASSET-LIST"==e.key}))&&e.B&&(i.values.push({key:"CUE",description:"",data:0!=i.startTime||e.U()?"ONCE":"ONCE,PRE",mimeType:null,pictureType:null}),e.B.onHLSInterstitialMetadata(e,e.h,i))}}));var n=new ze((function(){var t=yp(e);t=d(t);for(var n=t.next();!n.done;n=t.next())n.value.mode="hidden"})).qb().da(.5);e.zd.push((function(){n.stop()}))}}function Jf(e,t){t=(new Map).set("startTime",t.startTime).set("endTime",t.endTime).set("metadataType",t.schemeIdUri).set("payload",t.payload),e.dispatchEvent(Pf("metadata",t))}function Zf(e,t,n,i,r){e.za&&(t={schemeIdUri:i,startTime:t,endTime:n||1/0,id:"",payload:r},t.id=JSON.stringify(t),Tc(e.za,t))}function ep(e,t){if(t&&"chapters"==t.kind){t.mode="hidden";var n=new ze((function(){t.mode="hidden"})).qb().da(.5);e.zd.push((function(){n.stop()}))}}function tp(e,t){function n(n){t()?t().dispatchEvent(n):e.dispatchEvent(n)}function i(e){t()?ah(t(),!0,e):e()}return t||(t=function(){return null}),new Ms((function(n,i,r,s){var a=t()?t().j:e.o;a&&a.segmentDownloaded(n,i,r,s)}),(function(t,r,s){r=(new Map).set("headers",t).set("request",r).set("requestType",s),n(Pf("downloadheadersreceived",r)),i((function(){if(e.fa){var n=e.fa;if(n.h.enabled){var i=t["cmsd-static"];if(i)try{var r=new Map,s=i.split(",");for(i=0;i<s.length;i++){var a=s[i].split("=");r.set(a[0],wf(a[1]))}}catch(d){}if(r=t["cmsd-dynamic"]){try{var o=new Map,u=r.split(";");for(r=1;r<u.length;r++){var l=u[r].split("=");o.set(l[0],wf(l[1]))}var c=o}catch(d){c=null}c&&(n.g=c)}}}}))}),(function(e,t){e=(new Map).set("request",e).set("response",t),n(Pf("downloadcompleted",e))}),(function(e,t,i,r){e=(new Map).set("request",e).set("error",t).set("httpResponseCode",i).set("aborted",r),n(Pf("downloadfailed",e))}),(function(t,n,r){i((function(){var i=e.L,s=r;if(s=void 0===s?{}:s,i.g.enabled)if("HEAD"===n.method)ef(i,n);else switch(t){case 0:try{if(i.g.enabled){if(s.type){e:{switch(s.type){case 4:var a=i.l?bf:yf;break e;case 3:case 2:a=i.l?Sf:Tf;break e;case 5:a="s";break e}a=void 0}i.i=a}ef(i,n,{ot:cf,su:!i.u})}}catch(k){ee("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",k)}break;case Gs:try{if(i.g.enabled){var o=s.segment;a=0,o&&(a=o.endTime-o.startTime);var u={d:1e3*a,st:i.h.U()?"l":"v"};u.ot=nf(s);var l=u.ot===hf||u.ot===df||u.ot===ff||u.ot===mf,c=s.stream;if(c){var d=i.h.eb();if(l&&(u.bl=rf(i,c.type),u.ot!==mf)){var h=sf(i,c.type);u.dl=d?h/Math.abs(d):h}if(c.bandwidth&&(u.br=c.bandwidth/1e3),c.segmentIndex&&o){var f=c.segmentIndex.Eb(o.endTime,!0,0>d);if(f){var p=f.next().value;if(p&&p!=o){if(!Tn(o.N(),p.N())){var g=p.N()[0],m=n.uris[0],v=new URL(g),y=new URL(m);if(v.origin!==y.origin)var b=g;else{for(var T=v.pathname.split("/").slice(1),S=y.pathname.split("/").slice(1,-1);T[0]===S[0];)T.shift(),S.shift();for(;S.length;)S.shift(),T.unshift("..");b=T.join("/")}u.nor=b}if((p.startByte||p.endByte)&&(o.startByte!=p.startByte||o.endByte!=p.endByte)){var E=p.startByte+"-";p.endByte&&(E+=p.endByte),u.nrr=E}}}var w=i.h.eb()||1,A=sf(i,c.type)||500,x=c.bandwidth,I=x?x*(o.endTime-o.startTime)/1e3/(A/w/1e3)*i.g.rtpSafetyFactor:NaN;isNaN(I)||(u.rtp=I)}}l&&u.ot!==mf&&(u.tb=af(i,u.ot)/1e3),ef(i,n,u)}}catch(k){ee("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",k)}break;case 2:case 5:case 6:ef(i,n,{ot:"k"});break;case 4:ef(i,n,{ot:"o"})}}))}),(function(n,i,r,s){(n=t()?t().l:e.H)&&n.banLocation&&n.banLocation(s)}),(function(n,i){if(i.data){i=i.data.byteLength;var r=t()?t().getStats():e.A;r&&(r.mc=isNaN(r.mc)?i:r.mc+i,0===n&&(r.ah=i))}}))}function np(e,t){return new ec(e.h,e.i,e.g.streaming,t,(function(){e.Ka&&hc(e.Ka,!0),e.j&&e.j.Dc(),e.M&&op(e)}),(function(t){return e.dispatchEvent(t)}))}function ip(e,t){var n=e.U()||0<t;t=new Th(e.wd,n),t.addEventListener("enter",(function(t){Kp(e,"timelineregionenter",t.region)})),t.addEventListener("exit",(function(t){Kp(e,"timelineregionexit",t.region)})),t.addEventListener("skip",(function(t){var n=t.region;t.seeking||(Kp(e,"timelineregionenter",n),Kp(e,"timelineregionexit",n))}));var i=new Th(e.za,n);i.addEventListener("enter",(function(t){Jf(e,t.region)})),n=new Th(e.Fa,n),n.addEventListener("enter",(function(t){t=(new Map).set("detail",t.region.emsg),e.dispatchEvent(Pf("emsg",t))}));var r=new dc(e.h);return r.g.add(t),r.g.add(i),r.g.add(n),e.vd&&r.g.add(e.vd),r}function rp(e,t){t=new Th(e.za,0<t),t.addEventListener("enter",(function(t){Jf(e,t.region)}));var n=new dc(e.h);return n.g.add(t),n}function sp(e,t,n){e.M=new to,e.M.g=no,ap(e),Ip(e),e.oa=new ze((function(){op(e)})),e.g.streaming.rebufferingGoal&&e.oa.ua(.25),e.l.D(t,"waiting",(function(){return op(e)})),e.l.D(t,"canplaythrough",(function(){return op(e)})),e.l.D(t,"playing",(function(){return op(e)})),e.l.D(t,"seeked",(function(){return op(e)})),n&&(e.l.D(t,"stalled",(function(){return op(e)})),e.l.D(t,"progress",(function(){return op(e)})),e.l.D(t,"timeupdate",(function(){return op(e)})))}function ap(e){var t=e.g.streaming.rebufferingGoal;e.M.i.set(io,Math.min(.5,t/2)).set(no,t)}function op(e){switch(e.m){case tg:if(e.Sc())var t=!0;else{var n=fu(e.h.buffered);t=null!=n&&n>=e.h.duration-1}break;case eg:e:if(e.Sc()||sl(e.I))t=!0;else{if(e.i.presentationTimeline.U()){n=e.i.presentationTimeline.bc();var i=fu(e.h.buffered);if(null!=i&&i>=n){t=!0;break e}}t=!1}break;default:t=!1}i=gu(e.h.buffered,e.h.currentTime),n=e.M;var r=t,s=n.i.get(n.g);t=n.g,i=r||i>=s&&0<i?io:no,n.g=i,(t=t!=i)&&i===io&&(n.h=Date.now()),t&&Ip(e)}function up(e,t,n,i){return new zu(e,t,n,i)}function lp(e){return new qh({getBandwidthEstimate:function(){return e.o?e.o.getBandwidthEstimate():NaN},wb:function(){return e.wb()},getCurrentTime:function(){return e.h?e.h.currentTime:0},eb:function(){return e.eb()},xb:function(){return e.xb()},Pb:function(){return e.Pb()},U:function(){return e.U()},ae:function(){return e.ae()}},e.g.cmcd)}function cp(e){return new $c(e.i,{Pc:function(){return e.G?e.G.Pd():0},getBandwidthEstimate:function(){return e.o.getBandwidthEstimate()},eb:function(){return e.eb()},video:e.h,aa:e.I,Vb:e.F,onError:function(t){return Hp(e,t)},onEvent:function(t){return e.dispatchEvent(t)},se:function(t,n,i){var r=t.startTime;if(t=t.endTime,n=n.type,n!=qt){if(e.G){e.G.hh();var s=ol(e.I,n);!e.U()&&e.h.paused&&!e.h.seeking&&null!=s&&0<s&&e.G.Pd()<s&&e.G.af(s)}op(e)}i=(new Map).set("start",r).set("end",t).set("contentType",n).set("isMuxed",i),e.dispatchEvent(Pf("segmentappended",i))},fj:function(t,n){(n=n.Uc)&&e.vd&&gc(e.vd,n,t)},Fg:function(t,n){var i=e.C;if(i.g.parseInbandPsshEnabled&&!i.F&&["audio","video"].includes(t)){t=new da(Ne(n)),n=0;for(var r=d(t.data),s=r.next();!s.done;s=r.next())n+=s.value.length;if(0==n)i=Promise.resolve();else{for(n=new Uint8Array(n),r=0,t=d(t.data),s=t.next();!s.done;s=t.next())s=s.value,n.set(s,r),r+=s.length;Aa(i,"cenc",n),i=i.m}}else i=Promise.resolve();return i},disableStream:function(t,n){return e.disableStream(t,n)}})}function dp(e){if(e.ve=new ro(e.g,e.ka,e.C),e.H){var t=Ln(e.g.manifest);e.h&&"AUDIO"===e.h.nodeName&&(t.disableVideo=!0),e.H.configure(t)}if(e.C&&e.C.configure(e.g.drm),e.j){e.j.configure(e.g.streaming);try{e.m!=Jp&&oo(e.ve,e.i)&&Op(e)}catch(r){Hp(e,r)}e.o&&Dp(e),t=e.j.l,!t||t.allowedByApplication&&t.allowedByKeySystem||Mp(e)}if(e.F&&(e.F.kg(e.g.streaming.forceHTTP),e.F.lg(e.g.streaming.forceHTTPS),e.F.o=e.g.streaming.minBytesForProgressEvents),e.I&&(e.I.configure(e.g.mediaSource),e.I.Da=e.g.manifest.segmentRelativeVttTiming),e.u)if(t=e.g.textDisplayFactory,e.Ve!=t){var n=e.u;if(e.u=t(),e.u.configure?e.u.configure(e.g.textDisplayer):he("Text displayer w/ configure",'Text displayer should have a "configure" method!'),e.u.setTextLanguage||he("Text displayer w/ setTextLanguage",'Text displayer should have a "setTextLanguage" method!'),e.u.setTextVisibility(n.isTextVisible()),n.destroy(),e.I){n=e.I;var i=e.u;n.ea=i,n.h&&(n.h.j=i)}e.Ve=t,e.j&&(t=e.j,(n=t.i.get(qt))&&zc(t,n.stream,!0,0,!0))}else e.u.configure&&e.u.configure(e.g.textDisplayer);e.o&&(e.o.configure(e.g.abr),e.g.abr.enabled?e.o.enable():e.o.disable(),$p(e)),e.M&&ap(e),e.oa&&(e.g.streaming.rebufferingGoal?e.oa.ua(.25):e.oa.stop()),e.i&&Yp(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.B&&e.B.configure(e.g.ads),e.L&&e.L.configure(e.g.cmcd),e.fa&&e.fa.configure(e.g.cmsd)}function hp(e){return e&&(e=/(\d+)x(\d+)/.exec(e))?{oc:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}function fp(e,t){var n,i;return U((function(r){return 1==r.g?e.m!=eg&&e.m!=tg?r.return(null):(n=e.Te,e.i&&(n=e.i.imageStreams),i=n[0],i?(null!=t&&(i=n.find((function(e){return e.id==t}))),i?i.segmentIndex?r.s(2):w(r,i.createSegmentIndex(),2):r.return(null)):r.return(null)):r.return(i)}))}function pp(e,t,n,i){var r=t.width||0,s=t.height||0,a=r/i.oc,o=s/i.rows,u=i.oc*i.rows,l=e.j-e.startTime;l=e.B||l/u;var c=e.startTime,d=0,h=0;return 1<u&&(h=Math.floor((n-e.startTime)/l),c=e.startTime+h*l,d=h%i.oc*a,h=Math.floor(h/i.oc)*o),i=!1,(n=e.thumbnailSprite)&&(i=!0,o=n.height,d=n.positionX,h=n.positionY,a=n.width),{segment:e,imageHeight:s,imageWidth:r,height:o,positionX:d,positionY:h,startTime:c,duration:l,uris:e.N(),startByte:e.cc(),endByte:e.ac(),width:a,sprite:i,mimeType:e.mimeType||t.mimeType,codecs:e.codecs||t.codecs}}function gp(e,t){e.l.D(t,"cuechange",(function(){e.u.remove(0,Math.max(0,e.h.currentTime-e.g.streaming.bufferBehind));var n={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},i=[],r=Array.from(t.activeCues||[]);r=d(r);for(var s=r.next();!s.done;s=r.next()){if(s=s.value,1/0===s.endTime||s.endTime<s.startTime)s=null;else{var a=new ci(s.startTime,s.endTime,s.text);a.line="number"===typeof s.line?s.line:null,s.lineAlign&&(a.lineAlign=s.lineAlign),a.lineInterpretation=s.snapToLines?xi:1,a.position="number"===typeof s.position?s.position:null,s.positionAlign&&(a.positionAlign=s.positionAlign),a.size=s.size,a.textAlign=s.align,"lr"===s.vertical?a.writingMode="vertical-lr":"rl"===s.vertical&&(a.writingMode="vertical-rl"),s.region&&(a.region.id=s.region.id,a.region.height=s.region.lines,a.region.heightUnits=2,a.region.regionAnchorX=s.region.regionAnchorX,a.region.regionAnchorY=s.region.regionAnchorY,a.region.scroll=s.region.scroll,a.region.viewportAnchorX=s.region.viewportAnchorX,a.region.viewportAnchorY=s.region.viewportAnchorY,a.region.viewportAnchorUnits=gn,a.region.width=s.region.width,a.region.widthUnits=gn),fi(a),s=a}s&&((a=e.g.mediaSource.modifyCueCallback)&&a(s,null,n),i.push(s))}e.u.append(i)})),t.mode=document.pictureInPictureElement?"showing":"hidden"}function mp(e){return Array.from(e.h.textTracks).filter((function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&"Shaka Player TextTrack"!=e.label}))}function vp(e){return Array.from(e.h.textTracks).find((function(e){return"Shaka Player TextTrack"==e.label}))}function yp(e){return Array.from(e.h.textTracks).filter((function(e){return"metadata"==e.kind}))}function bp(e,t){var n;return U((function(i){switch(i.g){case 1:return x(i,2),w(i,xh(t,e.F,e.g.streaming.retryParameters),4);case 4:n=i.h,k(i,3);break;case 2:L(i);case 3:if(n)return i.return(n);throw new je(1,2,2011,t)}}))}function Tp(e,t,n,i,r,s,a){var o,u,l,c;return U((function(d){if(1==d.g)return"text/vtt"!=r||a.length?w(d,Sp(e,t,e.F,e.g.streaming.retryParameters),3):d.s(2);2!=d.g&&(o=d.h,u=Ep(e,o,r,a),l=new Blob([u],{type:"text/vtt"}),t=Ol(l),r="text/vtt"),c=document.createElement("track");var h=e.L,f=t;try{if(h.g.enabled){var p=Zh(h);p.ot=gf,p.su=!0;var g=of(p),m=lf(f,g)}else m=f}catch(v){ee("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",v),m=f}return c.src=m,c.label=s,c.kind=i,c.srclang=n,e.h.getAttribute("crossorigin")||e.h.setAttribute("crossorigin","anonymous"),e.h.appendChild(c),d.return(c)}))}function Sp(e,t,n,i){var r,s,a;return U((function(o){if(1==o.g){r=Gs,s=Os([t],i),s.method="GET";var u=e.L;try{u.g.enabled&&ef(u,s,{ot:gf,su:!0})}catch(l){ee("CMCD_TEXT_ERROR","Could not generate text CMCD data.",l)}return w(o,n.request(r,s).promise,2)}return a=o.h,o.return(a.data)}))}function Ep(e,t,n,i){var r=or(n);if(r)return n=r(),e={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},t=Ne(t),t=n.parseMedia(t,e,null,[]),Wh(t,i);throw new je(2,2,2014,n)}function wp(e){var t=qd();return t.streaming.failureCallback=function(t){if(e.U()){var n=null;1001==t.code||1002==t.code?(n=1,e.g.streaming.lowLatencyMode&&(n=.1)):1003==t.code&&(n=.1),null!=n&&(t.severity=1,e.eg(n))}},t.textDisplayFactory=function(){return!e.Fe||ot()&&!document.fullscreenEnabled?"addTextTrack"in e.h?new Mh(e.h,"Shaka Player TextTrack"):new Oh:new Nh(e.h,e.Fe)},t}function Ap(e,t){for(var n=new Set,i=d(t.textStreams),r=i.next();!r.done;r=i.next())r=r.value,"application/cea-608"!=r.mimeType&&"application/cea-708"!=r.mimeType||n.add(r.originalId);for(i=d(t.variants),r=i.next();!r.done;r=i.next())if((r=r.value.video)&&r.closedCaptions)for(var s=d(r.closedCaptions.keys()),a=s.next();!a.done;a=s.next())if(a=a.value,!n.has(a)){var o=a.startsWith("CC")?"application/cea-608":"application/cea-708",u=new uc,l=r.closedCaptions.get(a);o={id:e.ye++,originalId:a,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:u,mimeType:o,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:l,originalLanguage:l,label:null,type:qt,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:r.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set([Wi(o,"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},t.textStreams.push(o),n.add(a)}}function xp(e,t){var n,i,r,s,a;return U((function(o){return 1==o.g?(n=e.audio,i=e.video,r=function(e,t){var n,i,r;return U((function(s){return 1==s.g?e?e.segmentIndex?s.s(2):w(s,e.createSegmentIndex(),2):s.return(null):(i=(n=e.segmentIndex.Eb(t))?n.next().value:null,i?(r=i.startTime,s.return(r)):s.return(null))}))},w(o,r(n,t),2)):3!=o.g?(s=o.h,w(o,r(i,t),3)):(a=o.h,null!=a&&null!=s?o.return(Math.max(a,s)):null!=a?o.return(a):null!=s?o.return(s):o.return(t))}))}function Ip(e){var t=e.Of();if(e.A&&e.M&&e.G){if(0==e.g.streaming.rebufferingGoal){var n=e.K;n.j=!1,cc(n)}else n=e.K,n.j=t,cc(n);if(e.L&&(n=e.L,t||n.u||(n.u=!0),n.u&&t&&(n.B=!0),n.F=t),Lp(e),n=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts,e.g.streaming.liveSync.dynamicTargetLatency.enabled&&t&&e.Od<n){n=e.g.streaming.liveSync.dynamicTargetLatency.maxLatency;var i=e.g.streaming.liveSync.targetLatencyTolerance,r=e.g.streaming.liveSync.dynamicTargetLatency.rebufferIncrement;e.P&&(e.P=Math.min(e.P+ ++e.Od*r,n-i))}}t=(new Map).set("buffering",t),e.dispatchEvent(Pf("buffering",t))}function kp(e,t){e.Ma.Pa(),e.Ma.D(e.h,"timeupdate",(function(){var n=e.h.currentTime,i=e.Ta(),r=e.U()?e.g.streaming.safeSeekOffset:0;0<t?Math.floor(n)>=Math.floor(i.end)&&e.ed():Math.floor(n)<=Math.floor(i.start+r)&&e.ed()}))}function Lp(e){if(e.A&&e.M){var t=e.A.g,n="playing";e.M.g==no?n="buffering":e.Sc()?n="ended":e.h.paused&&(n="paused");var i=n;if(null==t.g)t.g={timestamp:Date.now()/1e3,state:i,duration:0},t=!0;else{var r=Date.now()/1e3;t.g.duration=r-t.g.timestamp,t.g.state==i?t=!1:(t.h.push(t.g),t.g={timestamp:r,state:i,duration:0},t=!0)}t&&(n=(new Map).set("newstate",n),e.dispatchEvent(Pf("statechanged",n)))}}function Rp(e){var t=e.h.playbackRate,n=e.U();if(e.g.streaming.vodDynamicPlaybackRate&&!n){var i=e.g.streaming.vodDynamicPlaybackRateLowBufferRate,r=e.Qg();r<=e.g.streaming.vodDynamicPlaybackRateBufferRatio?t!=i&&e.Ld(i,!1):1==r&&t!==e.K.sc()&&e.ed()}if(n&&(n=e.Ta(),Number.isFinite(n.end)&&!(e.h.currentTime<n.start||e.h.paused))){i=e.g.streaming.liveSync.targetLatencyTolerance,r=e.g.streaming.liveSync.dynamicTargetLatency.enabled;var s=e.g.streaming.liveSync.dynamicTargetLatency.stabilityThreshold;if(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled)var a=e.g.streaming.liveSync.targetLatency,o=a+i,u=Math.max(0,a-i),l=e.g.streaming.liveSync.maxPlaybackRate,c=e.g.streaming.liveSync.minPlaybackRate;else e.i&&e.i.serviceDescription&&(a=e.i.serviceDescription.targetLatency,null!=e.i.serviceDescription.targetLatency?o=e.i.serviceDescription.targetLatency+i:null!=e.i.serviceDescription.maxLatency&&(o=e.i.serviceDescription.maxLatency),null!=e.i.serviceDescription.targetLatency?u=Math.max(0,e.i.serviceDescription.targetLatency-i):null!=e.i.serviceDescription.minLatency&&(u=e.i.serviceDescription.minLatency),l=e.i.serviceDescription.maxPlaybackRate||e.g.streaming.liveSync.maxPlaybackRate,c=e.i.serviceDescription.minPlaybackRate||e.g.streaming.liveSync.minPlaybackRate);e.P||"number"!==typeof a||(e.P=a);var d=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts;r&&e.La&&null!==e.P&&"number"===typeof a&&e.Od<d&&Date.now()-e.La>1e3*s&&(s=e.g.streaming.liveSync.dynamicTargetLatency.minLatency,e.P=Math.max(e.P-(a-s)/2,s+i),e.La=Date.now()),r&&null!==e.P&&(o=e.P+i,u=e.P-i),a=n.end-e.h.currentTime,i=0,e.m==tg&&(r=e.h.buffered,0<r.length&&(i=r.end(r.length-1),i=Math.max(l,i-n.end))),n=e.g.streaming.liveSync.panicMode,r=1e3*e.g.streaming.liveSync.panicThreshold,s=Date.now()-e.M.h,n&&!c&&(c=e.g.streaming.liveSync.minPlaybackRate),n&&c&&s<=r?t!=c&&e.Ld(c,!1):void 0!=o&&l&&a-i>o?(t!=l&&e.Ld(l,!1),e.La=null):void 0!=u&&c&&a-i<u?(t!=c&&e.Ld(c,!1),e.La=null):t!==e.K.sc()&&(e.ed(),e.La=Date.now())}}function Cp(e){if(e.h){var t=function(t,n){var i=void 0===i?Number.EPSILON:i;if(t===n)i=!0;else{var r=Math.abs(t-n);i=r<=i||i!==Number.EPSILON&&Math.abs(r-i)<=Number.EPSILON}return!!((i||n>t)&&e.We<t)&&(e.We=t,!0)},n=e.Ta();if(n=n.end-n.start,n=0<n?e.h.currentTime/n:0,!isNaN(n)){if(n*=100,t(0,n))var i=Pf("started");else t(25,n)?i=Pf("firstquartile"):t(50,n)?i=Pf("midpoint"):t(75,n)?i=Pf("thirdquartile"):(t(100,n)&&(i=Pf("complete")),e.g&&1/0!=e.g.playRangeEnd&&e.Sc()&&e.h.pause());i&&e.dispatchEvent(i)}}}function Dp(e){try{lo(e.ve,e.i)}catch(n){return Hp(e,n),!1}var t=es(e.i.variants);return t=e.W.create(t),e.o.setVariants(Array.from(t.values())),!0}function Mp(e,t,n,i,r){var s;t=void 0===t||t,n=void 0===n?0:n,i=void 0!==i&&i,r=void 0===r||r,(s=Dp(e)?e.o.chooseVariant():null)&&Pp(e,s,r,t,n,i)}function Pp(e,t,n,i,r,s){s=void 0!==s&&s;var a=e.j.l;if(t==a)i&&qc(e.j,t,i,r,!0);else{var o=e.A.h;if(o.h!=t&&(o.h=t,o.g.push({timestamp:Date.now()/1e3,id:t.id,type:"variant",fromAdaptation:n,bandwidth:t.bandwidth})),qc(e.j,t,i,r,s,n),i=null,a&&(i=qr(a)),a=qr(t),a.active=!0,e.O&&(r=e.O,t=t.video)){switch(t.dependencyStream&&(t=t.dependencyStream),s=0,o=-1,t.mimeType){case"video/webm":s=1;break;case"video/mp4":s=2}switch(e.Sg()){case"DASH":o=1;break;case"HLS":o=0}r.g&&(r.g.setLevelSwitching(t.id,!0),r.g.setContainerFormat(s),r.j||r.g.setStreamingFormat(o))}n?(n=(new Map).set("oldTrack",i).set("newTrack",a),n=Pf("adaptation",n),Xp(e,n)):Np(e,i,a),Up(e,i,a)}}function _p(e,t){var n=Array.from(e.h.audioTracks).find((function(e){return e.enabled}));t.enabled=!0,n&&(t.id!==n.id&&(n.enabled=!1),n=Qr(n),t=Qr(t),Np(e,n,t),Up(e,n,t))}function Op(e){var t=Pf("trackschanged");Xp(e,t),Fp(e)}function Np(e,t,n){t=(new Map).set("oldTrack",t).set("newTrack",n),t=Pf("variantchanged",t),Xp(e,t)}function Up(e,t,n){var i=!1;t&&t.audioId==n.audioId&&t.audioGroupId==n.audioGroupId||(i=!0),i&&Fp(e)}function Fp(e){var t=Pf("audiotrackschanged");Xp(e,t)}function Bp(e){var t=Pf("textchanged");Xp(e,t)}function jp(e){var t=Pf("texttrackvisibility");Xp(e,t)}function $p(e){e.g.abr.enabled||Vp(e);var t=(new Map).set("newStatus",e.g.abr.enabled);Xp(e,Pf("abrstatuschanged",t))}function Gp(e){var t=e.tc().find((function(e){return e.active}));t&&e.u&&e.u.setTextLanguage&&e.u.setTextLanguage(t.language)}function Vp(e,t){if(t=void 0===t||t,e.m==eg){e.He.stop();for(var n=d(e.i.variants),i=n.next();!i.done;i=n.next())i.value.disabledUntilTime=0;t&&Dp(e)}}function Hp(e,t){var n,i,r,s;return U((function(a){switch(a.g){case 1:if(e.m==Jp)return a.return();if(1===t.severity&&e.A.K++,n=!0,!(e.sa&&e.i&&e.j)||3016!=t.code&&3014!=t.code&&3015!=t.code&&3018!=t.code){a.s(2);break}return ot()&&3016==t.code?a.return():(x(a,3),w(a,Ed(e.j),5));case 5:i=a.h,n=!i,i&&(r=Pf("mediasourcerecovered"),e.dispatchEvent(r)),k(a,2);break;case 3:L(a),n=!0;case 2:if(!n)return a.return();2===t.severity&&Vp(e,!1),s=Pf("error",(new Map).set("detail",t)),e.dispatchEvent(s),s.defaultPrevented&&(t.handled=!0),A(a)}}))}function Kp(e,t,n,i){i=void 0===i?e:i,e=(new Map).set("detail",{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,timescale:n.timescale,eventElement:n.eventElement,eventNode:n.eventNode}),i.dispatchEvent(Pf(t,e))}function Wp(e,t,n,i){i=void 0!==i&&i,t=(new Map).set("mediaQuality",{bandwidth:t.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate,height:t.height,mimeType:t.mimeType,channelsCount:t.channelsCount,pixelAspectRatio:t.pixelAspectRatio,width:t.width,label:t.label,roles:t.roles,language:t.language}).set("position",n),e.dispatchEvent(Pf(i?"audiotrackchanged":"mediaqualitychanged",t))}function qp(e,t){if(t=void 0===t||t,!e.h.error)return t?new je(2,3,3016):null;var n=e.h.error.code;return t||1!=n?((t=e.h.error.msExtendedCode)&&(0>t&&(t+=Math.pow(2,32)),t=t.toString(16)),new je(2,3,3016,n,t,e.h.error.message)):null}function Yp(e,t,n){0<t&&(e.U()||e.Ah(t)),t=e.getDuration(),n<t&&(e.U()||e.$a(n))}function Xp(e,t){U((function(n){if(1==n.g)return w(n,Promise.resolve(),2);e.m!=Jp&&e.dispatchEvent(t),A(n)}))}function zp(e){var t=new Set;e=d(e);for(var n=e.next();!n.done;n=e.next())n=n.value,n.language?t.add(wr(n.language)):t.add("und");return t}function Qp(e){var t=new Map,n=new Map;e=d(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;var r="und",s=[];i.language&&(r=wr(i.language)),s="variant"==i.type?i.audioRoles:i.roles,s&&s.length||(s=[""]),t.has(r)||t.set(r,new Set),s=d(s);for(var a=s.next();!a.done;a=s.next())a=a.value,t.get(r).add(a),i.label&&(n.has(r)||n.set(r,new Map),n.get(r).set(a,i.label))}var o=[];return t.forEach((function(e,t){e=d(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;var r=null;n.has(t)&&n.get(t).has(i)&&(r=n.get(t).get(i)),o.push({language:t,role:i,label:r})}})),o}Lf.prototype.release=function(){0<this.h.length?this.h.shift()():this.g=null},b(Cf,Rs),i=Cf.prototype,i.destroy=function(){var e,t=this;return U((function(n){switch(n.g){case 1:return t.m==Jp?n.return():(Df(t),e=t.detach(),t.m=Jp,w(n,e,2));case 2:return w(n,t.pf(),3);case 3:if(t.Ue&&(t.Ue.release(),t.Ue=null),t.xd&&(t.xd.release(),t.xd=null),t.l&&(t.l.release(),t.l=null),t.Ma&&(t.Ma.release(),t.Ma=null),t.Qb&&(t.Qb.release(),t.Qb=null),t.Ea=null,t.g=null,t.A=null,t.Fe=null,t.L=null,t.fa=null,!t.F){n.s(4);break}return w(n,t.F.destroy(),5);case 5:t.F=null;case 4:t.o&&(t.o.release(),t.o=null),Rs.prototype.release.call(t),A(n)}}))},i.Jb=function(e,t){t=void 0===t||t;var n,i,r,s=this;return U((function(a){switch(a.g){case 1:if(s.m==Jp)throw new je(2,7,7e3);if(n=s.h&&s.h==e,!s.h||s.h==e){a.s(2);break}return w(a,s.detach(),2);case 2:return w(a,Nf(s,"attach"),4);case 4:if(a.h)return a.return();if(x(a,5,6),n||(Of(s,"attach"),i=function(){var e=qp(s,!1);e&&Hp(s,e)},s.xd.D(e,"error",i),s.h=e,s.L&&s.L.setMediaElement(e)),!t||!Qe()||s.I){a.s(6);break}return w(a,Hf(s),6);case 6:R(a),s.$.release(),C(a,0);break;case 5:return r=L(a),w(a,s.detach(),10);case 10:throw r}}))},i.Uh=function(e){this.yg=e},i.detach=function(e){e=void 0!==e&&e;var t=this;return U((function(n){if(1==n.g){if(t.m==Jp)throw new je(2,7,7e3);return w(n,t.kc(!1,e),2)}if(3!=n.g)return w(n,Nf(t,"detach"),3);if(n.h)return n.return();try{t.h&&(t.xd.Pa(),t.h=null),Of(t,"detach"),t.B&&!e&&t.B.release()}finally{t.$.release()}A(n)}))},i.kc=function(t,n){t=void 0===t||t,n=void 0!==n&&n;var i,r,s,a,o,u,l,c,h,f,p=this;return U((function(g){switch(g.g){case 1:return p.m!=Jp&&(p.m=Zp),w(g,Nf(p,"unload"),2);case 2:return g.h?g.return():(I(g,3),p.sa=!1,Of(p,"unload"),Df(p),i=p.zd.map((function(e){return e()})),p.zd=[],w(g,Promise.all(i),5));case 5:if(p.dispatchEvent(Pf("unloading")),p.wd&&(p.wd.release(),p.wd=null),p.za&&(p.za.release(),p.za=null),p.Fa&&(p.Fa.release(),p.Fa=null),p.h&&(p.l.Pa(),p.Ma.Pa()),p.He.stop(),p.Ka&&(p.Ka.release(),p.Ka=null),p.oa&&(p.oa.stop(),p.oa=null),!p.H){g.s(6);break}return w(g,p.H.stop(),7);case 7:p.H=null,p.Ob=null;case 6:if(!p.o){g.s(8);break}return w(g,p.o.stop(),8);case 8:if(!p.j){g.s(10);break}return w(g,p.j.destroy(),11);case 11:p.j=null;case 10:if(p.K&&(p.K.release(),p.K=null),p.G&&(p.G.release(),p.G=null),"webkit"!==e.shakaMediaKeysPolyfill||!p.C){g.s(12);break}return w(g,p.C.destroy(),13);case 13:p.C=null;case 12:if(!p.I){g.s(14);break}return w(g,p.I.destroy(),15);case 15:p.I=null;case 14:if(p.B&&!n&&p.B.onAssetUnload(),p.ea&&!n&&(p.ea.destroy(),p.ea=null),n||p.Ye.stop(),p.L&&Yh(p.L),p.fa&&(p.fa.g=null),!p.u){g.s(16);break}return w(g,p.u.destroy(),17);case 17:p.u=null;case 16:if(p.h&&(Tu(p.h),p.h.src&&(p.h.removeAttribute("src"),p.h.load())),!p.C){g.s(18);break}return w(g,p.C.destroy(),19);case 19:p.C=null;case 18:if(p.ya&&p.T!=p.ya.Oc()&&(p.ya.u||p.ya.destroy(),p.ya=null),p.T=null,p.Nb=null,p.M=null,p.i){for(r=d(p.i.variants),s=r.next();!s.done;s=r.next())for(a=s.value,o=d([a.audio,a.video]),u=o.next();!u.done;u=o.next())(l=u.value)&&l.segmentIndex&&l.segmentIndex.release();for(c=d(p.i.textStreams),h=c.next();!h.done;h=c.next())f=h.value,f.segmentIndex&&f.segmentIndex.release()}p.g&&p.g.streaming.clearDecodingCache&&(as.clear(),Ye.clear()),p.i=null,p.A=new rh,p.Ve=null,p.La=null,p.P=null,p.Od=-1,p.Te=[],p.Hd=[],p.We=-1,p.F&&p.F.Hg(),Ip(p);case 3:R(g),p.$.release(),C(g,4);break;case 4:if(t&&Qe()&&!p.I&&p.h)return w(g,Hf(p),0);g.s(0)}}))},i.Kj=function(e){this.Z=e},i.load=function(e,t,n){t=void 0===t?null:t;var i,r,s,a,o,u,l,c,h,f,p,g,m,v,y=this;return U((function(b){switch(b.g){case 1:if(y.m==Jp)throw new je(2,7,7e3);if(i=null,r="",e instanceof sh){if(e.u)throw new je(2,7,7006);i=e,r=i.Oc()||""}else r=e||"";return w(b,Rf(y.$,"load"),2);case 2:if(y.$.release(),!y.h)throw new je(2,7,7002);if(!y.T){b.s(3);break}return y.T=r,w(b,y.kc(!1),3);case 3:if(s=++y.Nd,a=function(){return U((function(e){if(1==e.g)return y.Nd==s?e.s(0):i?w(e,i.destroy(),3):e.s(3);throw new je(2,7,7e3)}))},o=function(e,t){return U((function(n){switch(n.g){case 1:return I(n,2),w(n,Rf(y.$,t),4);case 4:return w(n,a(),5);case 5:return w(n,e(),6);case 6:return w(n,a(),7);case 7:i&&y.g&&(i.g=y.g);case 2:R(n),y.$.release(),C(n,0)}}))},x(b,5,6),null==t&&i&&(t=i.getStartTime()),y.Z=t,y.sa=!1,y.dispatchEvent(Pf("loading")),i){n=i.Z,b.s(8);break}if(n){b.s(8);break}return w(b,o((function(){return U((function(e){if(1==e.g)return w(e,$f(y,r),2);n=e.h,A(e)}))}),"guessMimeType_"),8);case 8:if(u=!!i,i){uh(i,y),y.A=i.getStats(),b.s(11);break}return w(b,Bf(y,r,t,n,!0),12);case 12:(i=b.h)?(i.A=!1,uh(i,y),y.A=i.getStats(),i.start(),i.m.catch((function(){}))):y.A=new rh;case 11:return l=!i,c=Date.now()/1e3,y.A=i?i.getStats():new rh,y.T=r,y.Nb=n||null,Ip(y),h=function(){var e=y.wb(),t={start:0,end:0};if(e.total.length){t.start=1/0,e=d(e.total);for(var n=e.next();!n.done;n=e.next())n=n.value,n.start<t.start&&(t.start=n.start),n.end>t.end&&(t.end=n.end)}return t},y.za=new bc(h),l?w(b,o((function(){return U((function(e){return w(e,qf(y,n),0)}))}),"initializeSrcEqualsDrmInner_"),23):(y.Fa=new bc(h),w(b,o((function(){return U((function(e){if(1==e.g)return w(e,Promise.race([i.na,i.m]),2);y.Ob=i.G;var t=i;t.oa=!0,y.H=t.l,y.i=i.Hf(),A(e)}))}),"waitForFinish"),15));case 15:if(y.I){b.s(16);break}return w(b,o((function(){return U((function(e){return w(e,Hf(y),0)}))}),"initializeMediaSourceEngineInner_"),16);case 16:return y.i&&y.i.textStreams.length&&(y.u.enableTextDisplayer?y.u.enableTextDisplayer():he("Text displayer w/ enableTextDisplayer",'Text displayer should have a "enableTextDisplayer" method!')),w(b,o((function(){return U((function(e){return w(e,i.m,0)}))}),"waitForFinish"),18);case 18:if(y.g=i.getConfiguration(),y.ve=i.F,y.H&&y.H.setMediaElement&&y.h&&y.H.setMediaElement(y.h),y.wd=ch(i),y.vd=i.Fa,(f=i.o)&&(y.W=f),u&&y.h&&"AUDIO"===y.h.nodeName&&(Uf(y),y.configure("manifest.disableVideo",!0)),i.i){b.s(19);break}return w(b,o((function(){return U((function(e){return w(e,mh(i,y.h),0)}))}),"drmEngine_.init"),19);case 19:return y.C=dh(i),w(b,o((function(){return U((function(e){return w(e,y.C.Jb(y.h),0)}))}),"drmEngine_.attach"),21);case 21:return!(p=i.C)||y.Ea&&y.Ea==p||(y.o=lh(i),y.Ea=i.C,"function"!=typeof y.o.setMediaElement&&(he("AbrManager w/o setMediaElement","Please use an AbrManager with setMediaElement function."),y.o.setMediaElement=function(){}),"function"!=typeof y.o.setCmsdManager&&(he("AbrManager w/o setCmsdManager","Please use an AbrManager with setCmsdManager function."),y.o.setCmsdManager=function(){}),"function"!=typeof y.o.trySuggestStreams&&(he("AbrManager w/o trySuggestStreams","Please use an AbrManager with trySuggestStreams function."),y.o.trySuggestStreams=function(){})),g=hh(i),m=i.K,w(b,o((function(){return U((function(e){return w(e,Wf(y,c,m,g),0)}))}),"loadInner_"),22);case 22:oh(i),y.Nb&&ot()&&tr(y.Nb)&&Ju(y.I,y.T,y.Nb),b.s(14);break;case 23:return w(b,o((function(){return U((function(e){return w(e,Yf(y,c,n),0)}))}),"srcEqualsInner_"),14);case 14:y.dispatchEvent(Pf("loaded"));case 6:if(R(b),!i){b.s(25);break}return w(b,i.destroy(),25);case 25:y.ya=null,C(b,0);break;case 5:if(v=L(b),!v||7e3==v.code){b.s(27);break}return w(b,y.kc(!1),27);case 27:throw v}}))},i.Gj=function(e,t){e=void 0===e||e,t=void 0!==t&&t;var n,i=this;return U((function(r){return 1==r.g?w(r,Ff(i),2):3!=r.g?(n=r.h,w(r,i.kc(e,t),3)):r.return(n)}))},i.Lg=function(e,t){e=void 0!==e&&e,t=void 0!==t&&t;var n,i=this;return U((function(r){return 1==r.g?w(r,Ff(i,t),2):3!=r.g?(n=r.h,w(r,i.detach(e),3)):r.return(n)}))},i.preload=function(e,t,n){t=void 0===t?null:t;var i,r=this;return U((function(s){return 1==s.g?w(s,Bf(r,e,t,n),2):((i=s.h)?i.start():Hp(r,new je(2,7,7005)),s.return(i))}))},i.pf=function(){var e,t,n,i,r=this;return U((function(s){for(e=[],t=d(r.Pe),n=t.next();!n.done;n=t.next())i=n.value,i.u||e.push(i.destroy());return r.Pe=[],w(s,Promise.all(e),0)}))},i.oj=function(){for(var e=this.$;e.g;)e.release()},i.Jc=function(e){return new fa(e)},i.configure=function(e,t){if(2==arguments.length&&"string"==typeof e&&(e=Ld(e,t)),e.streaming&&"forceTransmuxTS"in e.streaming&&(he("streaming.forceTransmuxTS configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&"forceTransmux"in e.streaming&&(he("streaming.forceTransmux configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmux,delete e.streaming.forceTransmux),e.streaming&&"useNativeHlsOnSafari"in e.streaming&&(he("streaming.useNativeHlsOnSafari configuration","Please Use streaming.useNativeHlsForFairPlay or streaming.preferNativeHls instead."),e.streaming.preferNativeHls=e.streaming.useNativeHlsOnSafari&&ot(),delete e.streaming.useNativeHlsOnSafari),e.streaming&&"boolean"==typeof e.streaming.liveSync){he("streaming.liveSync","Please Use streaming.liveSync.enabled instead.");var n=e.streaming.liveSync;e.streaming.liveSync={},e.streaming.liveSync.enabled=n}if(e.streaming&&(!e.streaming.liveSync||!("targetLatency"in e.streaming.liveSync))&&("liveSyncMinLatency"in e.streaming||"liveSyncMaxLatency"in e.streaming)){n=e.streaming.liveSyncMinLatency||0;var i=Math.abs((e.streaming.liveSyncMaxLatency||1)-n)/2;e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=n+i,e.streaming.liveSync.targetLatencyTolerance=i}if(e.streaming&&"liveSyncMaxLatency"in e.streaming&&(he("streaming.liveSyncMaxLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMaxLatency),e.streaming&&"liveSyncMinLatency"in e.streaming&&(he("streaming.liveSyncMinLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMinLatency),e.streaming&&"liveSyncTargetLatency"in e.streaming&&(he("streaming.liveSyncTargetLatency","Please Use streaming.liveSync.targetLatency instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=e.streaming.liveSyncTargetLatency,delete e.streaming.liveSyncTargetLatency),e.streaming&&"liveSyncTargetLatencyTolerance"in e.streaming&&(he("streaming.liveSyncTargetLatencyTolerance","Please Use streaming.liveSync.targetLatencyTolerance instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatencyTolerance=e.streaming.liveSyncTargetLatencyTolerance,delete e.streaming.liveSyncTargetLatencyTolerance),e.streaming&&"liveSyncPlaybackRate"in e.streaming&&(he("streaming.liveSyncPlaybackRate","Please Use streaming.liveSync.maxPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.maxPlaybackRate=e.streaming.liveSyncPlaybackRate,delete e.streaming.liveSyncPlaybackRate),e.streaming&&"liveSyncMinPlaybackRate"in e.streaming&&(he("streaming.liveSyncMinPlaybackRate","Please Use streaming.liveSync.minPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.minPlaybackRate=e.streaming.liveSyncMinPlaybackRate,delete e.streaming.liveSyncMinPlaybackRate),e.streaming&&"liveSyncPanicMode"in e.streaming&&(he("streaming.liveSyncPanicMode","Please Use streaming.liveSync.panicMode instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicMode=e.streaming.liveSyncPanicMode,delete e.streaming.liveSyncPanicMode),e.streaming&&"liveSyncPanicThreshold"in e.streaming&&(he("streaming.liveSyncPanicThreshold","Please Use streaming.liveSync.panicThreshold instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicThreshold=e.streaming.liveSyncPanicThreshold,delete e.streaming.liveSyncPanicThreshold),e.mediaSource&&"sourceBufferExtraFeatures"in e.mediaSource){he("mediaSource.sourceBufferExtraFeatures configuration","Please Use mediaSource.addExtraFeaturesToSourceBuffer() instead.");var r=e.mediaSource.sourceBufferExtraFeatures;e.mediaSource.addExtraFeaturesToSourceBuffer=function(){return r},delete e.mediaSource.sourceBufferExtraFeatures}if(e.manifest&&e.manifest.hls&&"useSafariBehaviorForLive"in e.manifest.hls&&(he("manifest.hls.useSafariBehaviorForLive configuration","Please Use liveSync config to keep on live Edge instead."),delete e.manifest.hls.useSafariBehaviorForLive),e.streaming&&"parsePrftBox"in e.streaming&&(he("streaming.parsePrftBox configuration","Now fired without needing a configuration."),delete e.streaming.parsePrftBox),e.manifest&&e.manifest.dash&&"enableAudioGroups"in e.manifest.dash&&(he("manifest.dash.enableAudioGroups configuration","It is now enabled by default and cannot be disabled."),delete e.manifest.dash.enableAudioGroups),e.streaming&&"dispatchAllEmsgBoxes"in e.streaming&&(he("streaming.dispatchAllEmsgBoxes configuration","Please Use mediaSource.dispatchAllEmsgBoxes instead."),e.mediaSource.dispatchAllEmsgBoxes=e.streaming.dispatchAllEmsgBoxes,delete e.streaming.dispatchAllEmsgBoxes),e.streaming&&"autoLowLatencyMode"in e.streaming&&(he("streaming.autoLowLatencyMode configuration","Please Use streaming.lowLatencyMode instead."),e.streaming.lowLatencyMode=e.streaming.autoLowLatencyMode,delete e.streaming.autoLowLatencyMode),e.manifest&&e.manifest.dash&&"ignoreSupplementalCodecs"in e.manifest.dash&&(he("manifest.dash.ignoreSupplementalCodecs configuration","Please Use manifest.ignoreSupplementalCodecs instead."),e.manifest.ignoreSupplementalCodecs=e.manifest.dash.ignoreSupplementalCodecs,delete e.manifest.dash.ignoreSupplementalCodecs),e.manifest&&e.manifest.hls&&"ignoreSupplementalCodecs"in e.manifest.hls&&(he("manifest.hls.ignoreSupplementalCodecs configuration","Please Use manifest.ignoreSupplementalCodecs instead."),e.manifest.ignoreSupplementalCodecs=e.manifest.hls.ignoreSupplementalCodecs,delete e.manifest.hls.ignoreSupplementalCodecs),e.manifest&&e.manifest.dash&&"updatePeriod"in e.manifest.dash&&(he("manifest.dash.updatePeriod configuration","Please Use manifest.updatePeriod instead."),e.manifest.updatePeriod=e.manifest.dash.updatePeriod,delete e.manifest.dash.updatePeriod),e.manifest&&e.manifest.hls&&"updatePeriod"in e.manifest.hls&&(he("manifest.hls.updatePeriod configuration","Please Use manifest.updatePeriod instead."),e.manifest.updatePeriod=e.manifest.hls.updatePeriod,delete e.manifest.hls.updatePeriod),e.manifest&&e.manifest.dash&&"ignoreDrmInfo"in e.manifest.dash&&(he("manifest.dash.ignoreDrmInfo configuration","Please Use manifest.ignoreDrmInfo instead."),e.manifest.ignoreDrmInfo=e.manifest.dash.ignoreDrmInfo,delete e.manifest.dash.ignoreDrmInfo),e.drm&&e.drm.advanced){for(var s in n=!1,e.drm.advanced){var a=e.drm.advanced[s];i=a.videoRobustness,a=a.audioRobustness,"videoRobustness"in e.drm.advanced[s]&&!Array.isArray(e.drm.advanced[s].videoRobustness)&&(e.drm.advanced[s].videoRobustness=[i],n=!0),"audioRobustness"in e.drm.advanced[s]&&!Array.isArray(e.drm.advanced[s].audioRobustness)&&(e.drm.advanced[s].audioRobustness=[a],n=!0)}n&&he("AdvancedDrmConfiguration's videoRobustness and audioRobustness","These properties are no longer strings but array of strings, please update your usage of these properties.")}return e.streaming&&"crossBoundaryStrategy"in e.streaming&&"keep"!=e.streaming.crossBoundaryStrategy&&(e.streaming.inaccurateManifestTolerance=0),s=Xd(this.g,e,wp(this)),dp(this),s},i.bi=function(e){this.Xe=e},i.getConfiguration=function(){var e=wp(this);return Xd(e,this.g,wp(this)),e},i.ki=function(){return this.Xe},i.Ug=function(){var e=wp(this);return Xd(e,this.g,wp(this)),Cd(this.g,wp(this))},i.Qg=function(){if(this.h){var e=this.h.buffered.length;e=e?this.h.buffered.end(e-1):0;var t=this.getConfiguration().streaming.bufferingGoal;if(t=Math.min(this.h.currentTime+t,this.Ta().end),e>=t)return 1;if(!(e<=this.h.currentTime)&&e<t)return(e-this.h.currentTime)/(t-this.h.currentTime)}return 0},i.sj=function(){for(var e in this.g)delete this.g[e];Xd(this.g,wp(this),wp(this)),dp(this)},i.ti=function(){return this.m},i.Sg=function(){return this.i?this.i.type:null},i.xi=function(){return this.h},i.xb=function(){return this.F},i.Oc=function(){return this.T},i.Pg=function(){return this.B?this.B:null},i.U=function(){return this.i&&!this.Oa()?this.i.presentationTimeline.U():!(!this.h||!this.h.src)&&1/0==this.h.duration},i.wc=function(){return!!this.i&&this.i.presentationTimeline.wc()},i.Qi=function(){if(this.i&&!this.Oa()){var e=this.i.variants;return!!e.length&&!e[0].video}return!(!this.h||!this.h.src)&&(this.h.videoTracks?0==this.h.videoTracks.length:0==this.h.videoHeight)},i.Ta=function(){if(this.i&&!this.Oa()){if(!this.sa&&"HLS"==this.i.type)return{start:0,end:0};var e=this.i.presentationTimeline;return{start:e.Fb(),end:e.mb()}}if(this.h&&this.h.src&&(e=this.h.seekable)&&e.length){var t=this.g?this.g.playRangeStart:0;t=Math.max(e.start(0),t);var n=this.g?this.g.playRangeEnd:1/0;return e=Math.min(e.end(e.length-1),n),{start:t,end:e}}return{start:0,end:0}},i.Ni=function(){this.U()&&(this.h.currentTime=this.Ta().end)},i.Ri=function(){return this.sa},i.keySystem=function(){var e=this.drmInfo();return e?e.keySystem:""},i.drmInfo=function(){return this.C?this.C.h:null},i.nd=function(){return this.C?this.C.nd():1/0},i.Gf=function(){return this.C?this.C.Gf():[]},i.$d=function(){return this.C?this.C.$d():{}},i.Of=function(){return this.M?this.M.g==no:!!this.T},i.eb=function(){return this.h?this.K?this.K.i:1:0},i.Ld=function(e,t){t=void 0===t||t,0==e?Z("A trick play rate of 0 is unsupported!"):(this.K.set(e),this.m==eg&&(this.o.playbackRateChanged(e),Wc(this.j,t&&1<Math.abs(e))),kp(this,e))},i.ed=function(){var e=this.K.sc();this.m==tg&&this.K.set(e),this.m==eg&&(this.K.set(e),this.o.playbackRateChanged(e),Wc(this.j,!1)),this.Ma.Pa()},i.Pb=function(){if(this.i&&!this.Oa()){for(var e=this.j?this.j.l:null,t=[],n=0,i=d(this.i.variants),r=i.next();!r.done;r=i.next())if(r=r.value,Zr(r)){var s=qr(r);s.active=r==e,s.active||1==n||null==e||r.video!=e.video||r.audio!=e.audio||(s.active=!0),s.active&&n++,t.push(s)}return t}return this.h&&this.h.audioTracks?Array.from(this.h.audioTracks).map((function(e){return Qr(e)})):[]},i.tc=function(){if(this.i&&!this.Oa()){for(var e=this.j?this.j.u:null,t=[],n=d(this.i.textStreams),i=n.next();!i.done;i=n.next()){i=i.value;var r=Yr(i);r.active=i==e,t.push(r)}return t}return this.h&&this.h.src&&this.h.textTracks?mp(this).map((function(e){var t=Jr(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="unknown"),"subtitles"==e.kind&&(t.mimeType="text/vtt"),e.kind&&(t.roles=[e.kind]),"forced"==e.kind&&(t.forced=!0),t})):[]},i.pi=function(){var e=this.Te;return this.i&&(e=this.i.imageStreams),e.map((function(e){return Xr(e)}))},i.ei=function(e){var t,n,i=this;return U((function(r){return 1==r.g?w(r,fp(i,e),2):(t=r.h,t?(n=[],t.segmentIndex.vb((function(e){var i=hp(e.tilesLayout||t.tilesLayout);if(i)for(var r=i.rows*i.oc,s=e.j-e.startTime,a=0;a<r;a++){var o=pp(e,t,e.startTime+s*a/r,i);n.push(o)}})),t.closeSegmentIndex&&t.closeSegmentIndex(),r.return(n)):r.return(null))}))},i.Hi=function(e,t){var n,i,r,s,a=this;return U((function(o){return 1==o.g?w(o,fp(a,e),2):(n=o.h,n?(i=n.segmentIndex.find(t),null==i?o.return(null):(r=n.segmentIndex.get(i),(s=hp(r.tilesLayout||n.tilesLayout))?o.return(pp(r,n,t,s)):o.return(null))):o.return(null))}))},i.sh=function(e){function t(){var t=n.i.textStreams.find((function(t){return t.id==e.id}));t&&t!=n.j.u&&(ih(n.A.h,t,!1),Yc(n.j,t),Bp(n),Gp(n),n.Rb=t.language)}var n=this;this.i&&this.G&&(t(),!this.Oa())||function(){if(n.h&&n.h.textTracks){var t=mp(n),i=t.find((function(e){return"disabled"!==e.mode}));(t=t.find((function(t){return zr(t)===e.id})))&&(i!==t&&(i&&(i.mode="disabled",n.l.Ia(i,"cuechange"),n.u.remove(0,1/0)),t&&gp(n,t)),Bp(n),Gp(n))}}()},i.Ce=function(e,t,n){function i(){var i=r.i.variants.find((function(t){return t.id==e.id}));if(i&&Zr(i)){var s=r.j.l;r.g.abr.enabled&&(s.video!=i.video||s.audio&&i.audio&&s.audio.language==i.audio.language&&s.audio.channelsCount==i.audio.channelsCount&&s.audio.label==i.audio.label)&&Z("Changing tracks while abr manager is enabled will likely result in the selected track being overridden. Consider disabling abr before calling selectVariantTrack()."),r.Oa()?Pp(r,i,!1,!1,0):Pp(r,i,!1,t||!1,n||0),r.W.configure({language:i.language,role:i.audio&&i.audio.roles&&i.audio.roles[0]||"",channelCount:i.audio&&i.audio.channelsCount?i.audio.channelsCount:0,Qc:i.video&&i.video.hdr?i.video.hdr:"",spatialAudio:!(!i.audio||!i.audio.spatialAudio)&&i.audio.spatialAudio,videoLayout:i.video&&i.video.videoLayout?i.video.videoLayout:"",Ic:i.audio&&i.audio.label?i.audio.label:"",dd:"",codecSwitchingStrategy:r.g.mediaSource.codecSwitchingStrategy,audioCodec:i.audio&&i.audio.codecs?i.audio.codecs:""}),Dp(r)}}var r=this;t=void 0!==t&&t,n=void 0===n?0:n,this.i&&this.G&&(i(),!this.Oa())||function(){if(r.h&&r.h.audioTracks){var t=Array.from(r.h.audioTracks);t=d(t);for(var n=t.next();!n.done;n=t.next())if(n=n.value,zr(n)==e.id){_p(r,n);break}}}()},i.xj=function(e,t){t=void 0===t?0:t;var n=this.Pb();if(n.length){var i=n.find((function(e){return e.active}));i&&(n=n.find((function(t){return t.videoId===i.videoId&&t.language==e.language&&t.label==e.label&&t.audioMimeType==e.mimeType&&t.audioCodec==e.codecs&&t.primary==e.primary&&Tn(t.audioRoles,e.roles)&&t.accessibilityPurpose==e.accessibilityPurpose&&t.channelsCount==e.channelsCount&&t.audioSamplingRate==e.audioSamplingRate&&t.spatialAudio==e.spatialAudio})))&&!n.active&&this.Ce(n,!0,t)}},i.getAudioTracks=function(){var e=this.Pb();if(!e.length)return[];var t=e.find((function(e){return e.active}));if(!t)return[];var n=e;if(this.m==eg&&(n=e.filter((function(e){return e.originalVideoId===t.originalVideoId&&e.audioCodec}))),!n.length)return[];e=new Map,n=d(n);for(var i=n.next();!i.done;i=n.next()){i=i.value;var r=i.originalAudioId;r||null==i.audioId||(r=String(i.audioId)),r&&e.set(r,{active:i.active,language:i.language,label:i.label,mimeType:i.audioMimeType,codecs:i.audioCodec,primary:i.primary,roles:i.audioRoles||[],accessibilityPurpose:i.accessibilityPurpose,channelsCount:i.channelsCount,audioSamplingRate:i.audioSamplingRate,spatialAudio:i.spatialAudio,originalLanguage:i.originalLanguage})}return Array.from(e.values())},i.gi=function(){return Qp(this.Pb())},i.Fi=function(){return Qp(this.tc())},i.fi=function(){return Array.from(zp(this.Pb()))},i.Ei=function(){return Array.from(zp(this.tc()))},i.rh=function(e,t,n,i,r,s,a){function o(){function o(e,t){return e.video||t.video?e.video&&t.video?Math.abs((e.video.height||0)-(t.video.height||0))+Math.abs((e.video.width||0)-(t.video.width||0)):1/0:0}u.W=u.g.adaptationSetCriteriaFactory(),u.W.configure({language:e,role:t||"",channelCount:n||0,Qc:"",spatialAudio:s||!1,videoLayout:"",Ic:a||"",dd:"",codecSwitchingStrategy:u.g.mediaSource.codecSwitchingStrategy,audioCodec:r||""});var l=u.j.l,c=u.W.create(u.i.variants),h=null;c=d(c.values());for(var f=c.next();!f.done;f=c.next())f=f.value,Zr(f)&&(!h||o(h,l)>o(f,l))&&(h=f);h!=l&&(h?(l=qr(h),u.Ce(l,!0,i||0)):Mp(u))}var u=this;n=void 0===n?0:n,i=void 0===i?0:i,r=void 0===r?"":r,s=void 0!==s&&s,a=void 0===a?"":a,this.i&&this.G&&(o(),!this.Oa())||function(){if(u.h&&u.h.audioTracks){var n=ts(u.Pb(),e,t||"",!1)[0];n&&u.Ce(n)}}()},i.hg=function(e,t,n){function i(){r.Rb=e,r.Fd=t||"",r.Dd=n||!1;var i=ts(r.i.textStreams,r.Rb,r.Fd,r.Dd)[0]||null;i&&i!=r.j.u&&(ih(r.A.h,i,!1),r.g.streaming.alwaysStreamText||r.Pf())&&(Yc(r.j,i),Bp(r),Gp(r))}var r=this;n=void 0!==n&&n,this.i&&this.G&&(i(),!this.Oa())||function(){var i=ts(r.tc(),e,t||"",n||!1)[0];i&&r.sh(i)}()},i.yj=function(e,t,n){function i(){for(var i=null,s=d(r.i.variants),a=s.next();!a.done;a=s.next())if(a=a.value,a.audio.label==e){i=a;break}null!=i&&(r.W=r.g.adaptationSetCriteriaFactory(),r.W.configure({language:i.language,role:"",channelCount:0,Qc:"",spatialAudio:!1,videoLayout:"",dd:"",Ic:e,codecSwitchingStrategy:r.g.mediaSource.codecSwitchingStrategy,audioCodec:""}),Mp(r,t,n))}var r=this;t=void 0===t||t,n=void 0===n?0:n,this.i&&this.G&&(i(),!this.Oa())||function(){if(r.h&&r.h.audioTracks){var t=Array.from(r.h.audioTracks),n=null;t=d(t);for(var i=t.next();!i.done;i=t.next())i=i.value,i.label==e&&(n=i);n&&_p(r,n)}}()},i.Pf=function(){var e=this.na;return this.u?this.u.isTextVisible():e},i.ji=function(){return this.Hd.map((function(e){return Yr(e)}))},i.ii=function(e){if(!this.Hd.length)return[];var t=wr(e);if(e=this.Hd.filter((function(e){return wr(e.language)==t})),!e.length)return[];var n=[],i=new Set;e=d(e);for(var r=e.next();!r.done;r=e.next())r=r.value,r.segmentIndex&&r.segmentIndex.vb((function(e){var t=e.N()[0],r=e.startTime+"-"+e.endTime+"-"+t;e={id:r,title:t,startTime:e.startTime,endTime:e.endTime},i.has(r)||(n.push(e),i.add(r))}));return n},i.yh=function(e){e=!!e,this.na!=e&&(this.na=e,this.m==eg?(this.u.setTextVisibility(e),this.g.streaming.alwaysStreamText||(e?this.j.u||(e=ts(this.i.textStreams,this.Rb,this.Fd,this.Dd),0<e.length&&(Yc(this.j,e[0]),Bp(this),Gp(this))):Kc(this.j))):this.h&&this.h.src&&this.h.textTracks&&this.u.setTextVisibility(e),jp(this))},i.yi=function(){if(this.G)var e=this.G.Pd();else{if(null==this.Z)return new Date;e=this.Z}if(this.i&&!this.Oa()){var t=this.i.presentationTimeline;return new Date(1e3*((t.m||t.i)+e))}return this.h&&this.h.getStartDate?(t=this.h.getStartDate(),isNaN(t.getTime())?null:new Date(t.getTime()+1e3*e)):null},i.Vg=function(){if(this.i&&!this.Oa()){var e=this.i.presentationTimeline;return new Date(1e3*(e.m||e.i))}return this.h&&this.h.getStartDate?(e=this.h.getStartDate(),isNaN(e.getTime())?null:e):null},i.ce=function(){return this.U()&&this.i?this.i.presentationTimeline.ce():null},i.wb=function(){if(this.m==eg)return this.I.wb();var e={total:[],audio:[],video:[],text:[]};return this.m==tg&&(e.total=vu(this.h.buffered)),e},i.ae=function(){if(!this.h||!this.h.currentTime)return null;var e=this.Vg().getTime()+1e3*this.h.currentTime;return Math.floor(Date.now()-e)},i.getStats=function(){if(this.m!=eg&&this.m!=tg)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,manifestSizeBytes:NaN,bytesDownloaded:NaN,nonFatalErrorCount:NaN,manifestPeriodCount:NaN,manifestGapCount:NaN,switchHistory:[],stateHistory:[]};Lp(this);var e=this.h,t=e.currentTime/e.duration;if(!isNaN(t)&&!this.U()){var n=this.A;t=Math.round(100*t),n.i=isNaN(n.i)?t:Math.max(n.i,t)}if(this.G&&(this.A.P=this.G.zg(),this.A.T=this.G.Ag()),e.getVideoPlaybackQuality){n=e.getVideoPlaybackQuality(),t=this.A;var i=Number(n.totalVideoFrames);t.O=Number(n.droppedVideoFrames),t.M=i,this.A.L=Number(n.corruptedVideoFrames)}if(this.C?(n=this.C,n=n.H?n.H:NaN):n=NaN,this.A.o=n,this.m==eg){if(n=this.j.l,t=this.j.u,n){i=this.K?this.K.i:1;var r=i*n.bandwidth;t&&t.bandwidth&&(r+=i*t.bandwidth),this.A.A=r}n&&n.video&&(t=this.A,i=n.video.height||NaN,t.m=n.video.width||NaN,t.l=i),this.U()&&(n=this.ae()||0,this.A.B=n/1e3),this.i&&(this.A.G=this.i.periodCount,this.A.F=this.i.gapCount,this.i.presentationTimeline&&(this.A.I=this.i.presentationTimeline.h)),n=this.o.getBandwidthEstimate(),this.A.u=n}this.m==tg&&(n=this.A,n.mc=isNaN(n.mc)?NaN:n.mc+NaN,n=this.A,t=e.videoHeight||NaN,n.m=e.videoWidth||NaN,n.l=t);var s=this.A;e=s.m,n=s.l,t=s.A,i=s.M,r=s.O;var a=s.L,o=s.T,u=s.P,l=s.u,c=s.i,h=s.C,f=s.H,p=s.j,g=eh(s.g,"playing"),m=eh(s.g,"paused"),v=eh(s.g,"buffering"),y=s.o,b=s.B,T=s.I,S=s.ah,E=s.mc,w=s.K,A=s.G,x=s.F,I=th(s.g),k=[];s=d(s.h.g);for(var L=s.next();!L.done;L=s.next())L=L.value,k.push({timestamp:L.timestamp,id:L.id,type:L.type,fromAdaptation:L.fromAdaptation,bandwidth:L.bandwidth});return{width:e,height:n,streamBandwidth:t,decodedFrames:i,droppedFrames:r,corruptedFrames:a,stallsDetected:o,gapsJumped:u,estimatedBandwidth:l,completionPercent:c,loadLatency:h,manifestTimeSeconds:f,drmTimeSeconds:p,playTime:g,pauseTime:m,bufferingTime:v,licenseTime:y,liveLatency:b,maxSegmentDuration:T,manifestSizeBytes:S,bytesDownloaded:E,nonFatalErrorCount:w,manifestPeriodCount:A,manifestGapCount:x,stateHistory:I,switchHistory:k}},i.Qh=function(e,t,n,i,r,s,a){a=void 0!==a&&a;var o,u,l,c,d,h,f,p,g,m,v,y,b,T=this;return U((function(S){switch(S.g){case 1:if(T.m!=eg&&T.m!=tg)throw new je(1,7,7004);if("subtitles"!=n&&"captions"!=n&&Z("Using a kind value different of `subtitles` or `captions` can cause unwanted issues."),i){S.s(2);break}return w(S,bp(T,e),3);case 3:i=S.h;case 2:if(o=[],T.B&&(o=T.B.getCuePoints()),T.m!=tg){S.s(4);break}return a&&(n="forced"),w(S,Tp(T,e,t,n,i,s||"",o),5);case 5:if(u=wr(t),l=T.tc(),c=l.find((function(e){return wr(e.language)==u&&e.label==(s||"")&&e.kind==n})))return Op(T),S.return(c);throw new je(1,2,2012);case 4:if(d=Yt,h=T.Ta(),f=h.end-h.start,T.i&&(f=T.i.presentationTimeline.getDuration()),1/0==f)throw new je(1,4,4033);if(!o.length){S.s(6);break}return w(S,Sp(T,e,T.F,T.g.streaming.retryParameters),7);case 7:p=S.h,g=Ep(T,p,i,o),m=new Blob([g],{type:"text/vtt"}),e=Ol(m),i="text/vtt";case 6:if(v={id:T.ye++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:ac(0,f,[e]),mimeType:i||"",codecs:r||"",kind:n,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:s||null,type:d.va,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!!a,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([Wi(i||"",r||"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},y=Wi(v.mimeType,v.codecs),b=ur(y),!b)throw new je(2,2,2014,i);return T.i.textStreams.push(v),Op(T),S.return(Yr(v))}}))},i.Rh=function(e,t){var n,i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S=this;return U((function(E){switch(E.g){case 1:if(S.m!=eg&&S.m!=tg)throw new je(1,7,7004);if(t){E.s(2);break}return w(E,bp(S,e),3);case 3:t=E.h;case 2:if("text/vtt"!=t)throw new je(1,2,2017,e);if(n=Yt,i=S.Ta(),r=i.end-i.start,S.i&&(r=S.i.presentationTimeline.getDuration()),1/0==r)throw new je(1,4,4045);return w(E,Sp(S,e,S.F,S.g.streaming.retryParameters),4);case 4:if(s=E.h,a=or(t),!a)throw new je(2,2,2014,t);for(o=a(),u={periodStart:0,segmentStart:0,segmentEnd:r,vttOffset:0},l=Ne(s),c=o.parseMedia(l,u,e,[]),h=[],f=d(c),p=f.next(),g={};!p.done;g={Oe:void 0,Kc:void 0},p=f.next())g.Kc=p.value,g.Oe=null,m=function(t){return function(){return null==t.Oe&&(t.Oe=$t([e],[t.Kc.payload])),t.Oe||[]}}(g),v=new uu(g.Kc.startTime,g.Kc.endTime,m,0,null,null,0,0,1/0),g.Kc.payload.includes("#xywh")&&(y=g.Kc.payload.split("#xywh=")[1].split(","),4===y.length&&v.Ee({height:parseInt(y[3],10),positionX:parseInt(y[0],10),positionY:parseInt(y[1],10),width:parseInt(y[2],10)})),h.push(v);if(b=t,!h.length){E.s(5);break}return w(E,xh(h[0].N()[0],S.F,S.g.manifest.retryParameters),6);case 6:b=E.h;case 5:return T={id:S.ye++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new rc(h),mimeType:b||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:n.$e,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([Wi(b||"","")]),isAudioMuxedInVideo:!1,baseOriginalId:null},S.m==tg?S.Te.push(T):S.i.imageStreams.push(T),Op(S),E.return(Xr(T))}}))},i.Ph=function(e,t,n){var i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b=this;return U((function(T){switch(T.g){case 1:if(b.m!=eg&&b.m!=tg)throw new je(1,7,7004);if(n){T.s(2);break}return w(T,bp(b,e),3);case 3:n=T.h;case 2:if(i=Yt,r=b.Ta(),s=r.end-r.start,b.i&&(s=b.i.presentationTimeline.getDuration()),1/0==s)throw new je(1,4,4054);return w(T,Sp(b,e,b.F,b.g.streaming.retryParameters),4);case 4:if(a=T.h,o=or(n),!o)throw new je(2,2,2014,n);for(u=o(),l={periodStart:0,segmentStart:0,segmentEnd:s,vttOffset:0},c=Ne(a),h=u.parseMedia(c,l,e,[]),f=[],p=d(h),g=p.next(),m={};!g.done;m={Xd:void 0},g=p.next())m.Xd=g.value,v=new uu(m.Xd.startTime,m.Xd.endTime,function(e){return function(){return[e.Xd.payload]}}(m),0,null,null,0,0,1/0),f.push(v);return y={id:b.ye++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new rc(f),mimeType:"text/plain",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:null,type:i.va,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([Wi("text/plain","")]),isAudioMuxedInVideo:!1,baseOriginalId:null},b.Hd.push(y),Op(b),T.return(Yr(y))}}))},i.Dj=function(e,t){this.ka.width=e,this.ka.height=t},i.eg=function(e){if(this.m==eg){var t=this.j;if(e=void 0===e?.1:e,t.m.g)t=!1;else if(t.B)t=!1;else{for(var n=d(t.i.values()),i=n.next();!i.done;i=n.next())i=i.value,!i.qd||i.Ca||i.ib||(i.qd=!1,yd(t,i,e));t=!0}}else t=!1;return t},i.Hf=function(){return Z("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.i},i.ui=function(){return this.Ob},i.ni=function(){var e={video:null,audio:null,text:null};if(this.m!=eg)return e;var t=this.j.l,n=this.h.currentTime;t=d([t.video,t.audio,this.j.u]);for(var i=t.next();!i.done;i=t.next())if((i=i.value)&&i.segmentIndex){var r=i.segmentIndex.find(n);r=i.segmentIndex.get(r),r={codecs:r.codecs||i.codecs,mimeType:r.mimeType||i.mimeType,bandwidth:r.bandwidth||i.bandwidth},"video"==i.type?(r.width=i.width,r.height=i.height,e.video=r):"audio"==i.type?e.audio=r:i.type==qt&&(e.text=r)}return e},i.Bh=function(e){this.Fe=e},i.disableStream=function(e,t){if(!this.g.abr.enabled||this.m===Jp||!navigator.onLine||0==t||!this.i)return!1;if(this.i.variants.some((function(t){var n=t[e.type];return!(!n||n.id===e.id||t.disabledUntilTime)&&("audio"!=e.type||e.language===n.language)}))){for(var n=!1,i=!1,r=d(this.i.variants),s=r.next();!s.done;s=r.next()){s=s.value;var a=s[e.type];a&&(a.id===e.id?(s.disabledUntilTime=Date.now()/1e3+t,n=!0):a.trickModeVideo&&a.trickModeVideo.id==e.id&&(i=!0))}return!(!n&&i)&&(this.He.ua(1),t=this.wb().video.reduce((function(e,t){return e+t.end-t.start}),0),Mp(this,!1,t,!0,!1),!0)}return!1},i.addFont=function(e,t){return Su(e,t)},i.Oa=function(){return!(!this.h||!this.h.remote)&&"disconnected"!=this.h.remote.state},i.Sc=function(){return!(this.h&&!this.h.ended)||this.sa&&!this.U()&&this.h.currentTime>=this.Ta().end},K("shaka.Player",Cf),Cf.prototype.isEnded=Cf.prototype.Sc,Cf.prototype.isRemotePlayback=Cf.prototype.Oa,Cf.prototype.addFont=Cf.prototype.addFont,Cf.prototype.setVideoContainer=Cf.prototype.Bh,Cf.prototype.getFetchedPlaybackInfo=Cf.prototype.ni,Cf.prototype.getManifestParserFactory=Cf.prototype.ui,Cf.prototype.getManifest=Cf.prototype.Hf,Cf.prototype.retryStreaming=Cf.prototype.eg,Cf.prototype.setMaxHardwareResolution=Cf.prototype.Dj,Cf.prototype.addChaptersTrack=Cf.prototype.Ph,Cf.prototype.addThumbnailsTrack=Cf.prototype.Rh,Cf.prototype.addTextTrackAsync=Cf.prototype.Qh,Cf.prototype.getStats=Cf.prototype.getStats,Cf.prototype.getBufferedInfo=Cf.prototype.wb,Cf.prototype.getSegmentAvailabilityDuration=Cf.prototype.ce,Cf.prototype.getPresentationStartTimeAsDate=Cf.prototype.Vg,Cf.prototype.getPlayheadTimeAsDate=Cf.prototype.yi,Cf.prototype.setTextTrackVisibility=Cf.prototype.yh,Cf.prototype.getChapters=Cf.prototype.ii,Cf.prototype.getChaptersTracks=Cf.prototype.ji,Cf.prototype.isTextTrackVisible=Cf.prototype.Pf,Cf.prototype.selectVariantsByLabel=Cf.prototype.yj,Cf.prototype.selectTextLanguage=Cf.prototype.hg,Cf.prototype.selectAudioLanguage=Cf.prototype.rh,Cf.prototype.getTextLanguages=Cf.prototype.Ei,Cf.prototype.getAudioLanguages=Cf.prototype.fi,Cf.prototype.getTextLanguagesAndRoles=Cf.prototype.Fi,Cf.prototype.getAudioLanguagesAndRoles=Cf.prototype.gi,Cf.prototype.getAudioTracks=Cf.prototype.getAudioTracks,Cf.prototype.selectAudioTrack=Cf.prototype.xj,Cf.prototype.selectVariantTrack=Cf.prototype.Ce,Cf.prototype.selectTextTrack=Cf.prototype.sh,Cf.prototype.getThumbnails=Cf.prototype.Hi,Cf.prototype.getAllThumbnails=Cf.prototype.ei,Cf.prototype.getImageTracks=Cf.prototype.pi,Cf.prototype.getTextTracks=Cf.prototype.tc,Cf.prototype.getVariantTracks=Cf.prototype.Pb,Cf.prototype.cancelTrickPlay=Cf.prototype.ed,Cf.prototype.trickPlay=Cf.prototype.Ld,Cf.prototype.getPlaybackRate=Cf.prototype.eb,Cf.prototype.isBuffering=Cf.prototype.Of,Cf.prototype.getKeyStatuses=Cf.prototype.$d,Cf.prototype.getActiveSessionsMetadata=Cf.prototype.Gf,Cf.prototype.getExpiration=Cf.prototype.nd,Cf.prototype.drmInfo=Cf.prototype.drmInfo,Cf.prototype.keySystem=Cf.prototype.keySystem,Cf.prototype.isFullyLoaded=Cf.prototype.Ri,Cf.prototype.goToLive=Cf.prototype.Ni,Cf.prototype.seekRange=Cf.prototype.Ta,Cf.prototype.isAudioOnly=Cf.prototype.Qi,Cf.prototype.isInProgress=Cf.prototype.wc,Cf.prototype.isLive=Cf.prototype.U,Cf.prototype.getAdManager=Cf.prototype.Pg,Cf.prototype.getAssetUri=Cf.prototype.Oc,Cf.prototype.getNetworkingEngine=Cf.prototype.xb,Cf.prototype.getMediaElement=Cf.prototype.xi,Cf.prototype.getManifestType=Cf.prototype.Sg,Cf.prototype.getLoadMode=Cf.prototype.ti,Cf.prototype.resetConfiguration=Cf.prototype.sj,Cf.prototype.getBufferFullness=Cf.prototype.Qg,Cf.prototype.getNonDefaultConfiguration=Cf.prototype.Ug,Cf.prototype.getConfigurationForLowLatency=Cf.prototype.ki,Cf.prototype.getConfiguration=Cf.prototype.getConfiguration,Cf.prototype.configurationForLowLatency=Cf.prototype.bi,Cf.prototype.configure=Cf.prototype.configure,Cf.prototype.releaseAllMutexes=Cf.prototype.oj,Cf.prototype.destroyAllPreloads=Cf.prototype.pf,Cf.prototype.preload=Cf.prototype.preload,Cf.prototype.detachAndSavePreload=Cf.prototype.Lg,Cf.prototype.unloadAndSavePreload=Cf.prototype.Gj,Cf.prototype.load=Cf.prototype.load,Cf.prototype.updateStartTime=Cf.prototype.Kj,Cf.prototype.unload=Cf.prototype.kc,Cf.prototype.detach=Cf.prototype.detach,Cf.prototype.attachCanvas=Cf.prototype.Uh,Cf.prototype.attach=Cf.prototype.Jb,Cf.probeSupport=function(e){var t,n,i,r,s,a;return e=void 0===e||e,U((function(o){switch(o.g){case 1:if(t={},!e){o.s(2);break}return w(o,Ua(),3);case 3:t=o.h;case 2:return n=po(),i=el(),w(o,St(),4);case 4:return r=o.h,s={manifest:n,media:i,drm:t,hardwareResolution:r},a=ig,a.forEach((function(e,t){s[t]=e()})),o.return(s)}}))},Cf.isBrowserSupported=function(){return e.Promise||Z("A Promise implementation or polyfill is required"),!(!(e.Promise&&e.Uint8Array&&Array.prototype.forEach)||vt("Trident/"))&&(!!Qe()||Je("application/x-mpegurl"))},Cf.setAdManagerFactory=function(e){rg=e},Cf.registerSupportPlugin=_f,Cf.prototype.destroy=Cf.prototype.destroy;var Jp=0,Zp=1,eg=2,tg=3;Cf.LoadMode={DESTROYED:Jp,NOT_LOADED:Zp,MEDIA_SOURCE:eg,SRC_EQUALS:tg},Cf.version="v4.14.12";var ng=["4","14"];ge=new function(e){this.g=e,this.i=fe,this.h=pe}(new de(Number(ng[0]),Number(ng[1])));var ig=new Map,rg=null;function sg(){this.g=[],this.i=this.m=this.l=this.j=this.h=0}function ag(e){return e.g.length?e.g.reduce((function(e,t){return e+t}),0)/e.g.length:0}function og(e,t,n){var i=this;this.g=e,this.h=t,this.m=n,this.i=!1,this.j=this.h.getVolume(),this.l=new ae,this.l.D(this.h,google.ima.AdEvent.Type.PAUSED,(function(){i.i=!0})),this.l.D(this.h,google.ima.AdEvent.Type.RESUMED,(function(){i.i=!1}))}function ug(){}function lg(e,t){var n=[];e=d(Un(e,"Ad"));for(var i=e.next();!i.done;i=e.next())if((i=$n(i.value,"InLine"))&&(i=$n(i,"Creatives"))){i=d(Un(i,"Creative"));for(var r=i.next();!r.done;r=i.next()){r=r.value;var s=$n(r,"Linear");if(s&&cg(n,t,s),r=$n(r,"NonLinearAds")){r=Un(r,"NonLinear"),r=d(r);for(var a=r.next();!a.done;a=r.next())e:{s=n;var o=t,u=a.value,l=$n(u,"StaticResource");if(l)a=l.attributes.creativeType;else{if(l=$n(u,"HTMLResource"),!l)break e;a="text/html"}if(l=Bn(l)){"text/html"===a&&(l="data:text/html;charset=UTF-8,"+encodeURIComponent(l));var c=Vn(u,"width",zn)||Vn(u,"expandedWidth",zn),h=Vn(u,"height",zn)||Vn(u,"expandedHeight",zn);if(c||h){var f=null;(u=u.attributes.minSuggestedDuration)&&(f=In(u)),u=0,null!=o&&(u=o),s.push({id:null,groupId:null,startTime:u,endTime:null,uri:l,mimeType:a,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!1,resumeOffset:0,playoutLimit:f,once:!0,pre:null==o,post:1/0==o,timelineRange:!1,loop:!1,overlay:{viewport:{x:0,y:0},topLeft:{x:0,y:0},size:{x:c||0,y:h||0}},displayOnBackground:!1,currentVideo:null,background:null})}}}}}}return n}function cg(e,t,n){var i=0;null!=t&&(i=t);var r=null;if(n.attributes.skipoffset&&(r=In(n.attributes.skipoffset),isNaN(r)&&(r=null)),n=$n(n,"MediaFiles")){var s=Un(n,"MediaFile");for(n=s,s=s.filter((function(e){return"streaming"==e.attributes.delivery})),s.length&&(n=s),n=n.sort((function(e,t){return(parseInt(t.attributes.height,10)||0)-(parseInt(e.attributes.height,10)||0)})),n=d(n),s=n.next();!s.done;s=n.next())if(s=s.value,!s.attributes.apiFramework){var a=Bn(s);if(a){e.push({id:null,groupId:null,startTime:i,endTime:null,uri:a,mimeType:s.attributes.type||null,isSkippable:null!=r,skipOffset:r,skipFor:null,canJump:!1,resumeOffset:0,playoutLimit:null,once:!0,pre:null==t,post:1/0==t,timelineRange:!1,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null});break}}}}function dg(e,t,n,i,r){var s=this;this.u=e,this.i=t,this.F=!1,this.A=this.o=null,this.G=NaN,this.l=r,this.j=null,this.h=new ae,google.ima.settings.setLocale(n),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this.C=new google.ima.AdDisplayContainer(this.u,this.i),this.C.initialize(),this.m=new google.ima.AdsLoader(this.C),this.m.getSettings().setPlayerType("shaka-player"),this.m.getSettings().setPlayerVersion("v4.14.12"),this.g=null,this.B=i||new google.ima.AdsRenderingSettings,this.h.D(this.m,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(function(e){fg(s,e)})),this.h.D(this.m,google.ima.AdErrorEvent.Type.AD_ERROR,(function(e){hg(s,e)})),this.h.D(this.i,"ended",(function(){s.m.contentComplete()})),this.h.qa(this.i,"play",(function(){s.F=!0}))}function hg(e,t){t.getError(),t=(new Map).set("originalEvent",t),e.l(new Is("ad-error",t)),mg(e,null),e.l(new Is("ad-cue-points-changed",(new Map).set("cuepoints",[])))}function fg(t,n){if(t.l(new Is("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-t.G))),t.o.customPlayheadTracker){var i={currentTime:t.i.currentTime};t.g=n.getAdsManager(i,t.B),t.i.muted?t.g.setVolume(0):t.g.setVolume(t.i.volume),t.h.D(t.i,"timeupdate",(function(){t.i.duration&&(i.currentTime=t.i.currentTime)})),t.h.D(t.i,"volumechange",(function(){t.j&&(t.j.setVolume(t.i.volume),t.i.muted&&t.j.setMuted(!0))}))}else t.g=n.getAdsManager(t.i,t.B);t.l(new Is("ima-ad-manager-loaded",(new Map).set("imaAdManager",t.g)));var r=t.g.getCuePoints();if(r.length){n=[],r=d(r);for(var s=r.next();!s.done;s=r.next())n.push({start:s.value,end:null});t.l(new Is("ad-cue-points-changed",(new Map).set("cuepoints",n)))}pg(t);try{t.g.init(t.i.offsetWidth,t.i.offsetHeight),t.h.D(t.i,"loadeddata",(function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight)})),"ResizeObserver"in e?(t.A=new ResizeObserver((function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight)})),t.A.observe(t.i)):t.h.D(document,"fullscreenchange",(function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight)})),t.F||t.o.skipPlayDetection?t.g.start():t.h.qa(t.i,"play",(function(){t.F=!0,t.g.start()}))}catch(a){mg(t,null)}}function pg(e){function t(t,n){t=(new Map).set("originalEvent",t),e.l(new Is(n,t))}e.h.D(e.g,google.ima.AdErrorEvent.Type.AD_ERROR,(function(t){hg(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,(function(t){gg(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.STARTED,(function(t){gg(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.FIRST_QUARTILE,(function(e){t(e,"ad-first-quartile")})),e.h.D(e.g,google.ima.AdEvent.Type.MIDPOINT,(function(e){t(e,"ad-midpoint")})),e.h.D(e.g,google.ima.AdEvent.Type.THIRD_QUARTILE,(function(e){t(e,"ad-third-quartile")})),e.h.D(e.g,google.ima.AdEvent.Type.COMPLETE,(function(e){t(e,"ad-complete")})),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,(function(t){mg(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(t){mg(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPED,(function(e){t(e,"ad-skipped")})),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_CHANGED,(function(e){t(e,"ad-volume-changed")})),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_MUTED,(function(e){t(e,"ad-muted")})),e.h.D(e.g,google.ima.AdEvent.Type.PAUSED,(function(n){e.j&&(e.j.i=!0,t(n,"ad-paused"))})),e.h.D(e.g,google.ima.AdEvent.Type.RESUMED,(function(n){e.j&&(e.j.i=!1,t(n,"ad-resumed"))})),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,(function(n){e.j&&t(n,"ad-skip-state-changed")})),e.h.D(e.g,google.ima.AdEvent.Type.CLICK,(function(e){t(e,"ad-clicked")})),e.h.D(e.g,google.ima.AdEvent.Type.AD_PROGRESS,(function(e){t(e,"ad-progress")})),e.h.D(e.g,google.ima.AdEvent.Type.AD_BUFFERING,(function(e){t(e,"ad-buffering")})),e.h.D(e.g,google.ima.AdEvent.Type.IMPRESSION,(function(e){t(e,"ad-impression")})),e.h.D(e.g,google.ima.AdEvent.Type.DURATION_CHANGE,(function(e){t(e,"ad-duration-changed")})),e.h.D(e.g,google.ima.AdEvent.Type.USER_CLOSE,(function(e){t(e,"ad-closed")})),e.h.D(e.g,google.ima.AdEvent.Type.LOADED,(function(e){t(e,"ad-loaded")})),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(e){t(e,"all-ads-completed")})),e.h.D(e.g,google.ima.AdEvent.Type.LINEAR_CHANGED,(function(e){t(e,"ad-linear-changed")})),e.h.D(e.g,google.ima.AdEvent.Type.AD_METADATA,(function(e){t(e,"ad-metadata")})),e.h.D(e.g,google.ima.AdEvent.Type.LOG,(function(e){t(e,"ad-recoverable-error")})),e.h.D(e.g,google.ima.AdEvent.Type.AD_BREAK_READY,(function(e){t(e,"ad-break-ready")})),e.h.D(e.g,google.ima.AdEvent.Type.INTERACTION,(function(e){t(e,"ad-interaction")}))}function gg(e,t){var n=t.getAd();n?(e.j=new og(n,e.g,e.i),t.type!=google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED||e.o.supportsMultipleMediaElements||e.l(new Is("ad-content-pause-requested")),t=(new Map).set("ad",e.j).set("sdkAdObject",n).set("originalEvent",t),e.l(new Is("ad-started",t)),e.j.isLinear()&&(e.u.setAttribute("ad-active","true"),e.o.customPlayheadTracker||e.i.pause(),e.i.muted?(t=e.j,t.j=e.i.volume,t.h.setVolume(0)):e.j.setVolume(e.i.volume))):Z("The IMA SDK fired a "+t.type+" event with no associated ad. Unable to play ad!")}function mg(e,t){t&&t.type==google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED&&!e.o.supportsMultipleMediaElements&&e.l(new Is("ad-content-resume-requested")),e.l(new Is("ad-stopped",(new Map).set("originalEvent",t))),e.j&&e.j.isLinear()&&(e.u.removeAttribute("ad-active"),e.o.customPlayheadTracker||e.i.ended||e.i.play())}function vg(e,t,n,i,r,s){this.g=e,this.i=t,this.j=(this.h=t.isSkippable)?t.skipOffset||0:t.skipOffset,this.l=t.skipFor,this.A=n,this.o=i,this.m=r,this.u=s,this.B=t.overlay}function yg(e,t,n){this.g=e,this.j=t,this.h=n,this.i=null==e.overlay}function bg(e,t,n,i){var r=this;this.T=null,this.A=e,this.H=t,this.g=n,this.F=null,this.B=!0,this.h=this.g,this.i=i,this.W=new Set,this.G=new Set,this.C=new Map,this.L=new Map,this.j=new Cf,_g(this),this.I=new ae,this.l=new ae,this.K=!1,this.ea=this.m=this.u=this.o=null,this.fa=!1,this.O=-1,this.$=function(){if(!r.K&&r.o&&!r.H.Oa()){r.o=r.g.currentTime,r.u&&!r.u.pre&&!r.u.post&&r.o<r.u.startTime&&(r.u=null);var e=Ig(r);e&&kg(r,e,1,1,Date.now())}},this.Z=function(){if(!(r.K||r.o||r.H.Oa())){r.o=r.g.currentTime;var e=Ig(r,!0);e&&kg(r,e,1,1,Date.now())}},this.P=new ze(this.$),this.M=new ze((function(){var e,t,n,i,s,a,o,u,l,c,h;return U((function(f){switch(f.g){case 1:if(!r.G.size||null==r.o){f.s(0);break}if(e=r.H.m,e==Jp||e==Zp)return f.return();t=!1,n=Array.from(r.G),i=r.H.Ta(),s=d(n),a=s.next();case 3:if(a.done){f.s(5);break}if(o=a.value,o==r.u){f.s(4);break}if(u=o.endTime||o.startTime,!(1<=i.start-u)){l=o.startTime-r.o,0<l&&10>=l&&(!r.C.has(o)&&Ng(o)&&r.C.set(o,r.j.preload(o.uri,null,o.mimeType||void 0)),Ug(r,o)),f.s(4);break}if(!r.C.has(o)){f.s(7);break}return w(f,r.C.get(o),8);case 8:(c=f.h)&&c.destroy(),r.C.delete(o);case 7:Fg(r,o),h=JSON.stringify(o),r.W.has(h)&&r.W.delete(h),r.G.delete(o),Sg(r),o.overlay||(t=!0);case 4:a=s.next(),f.s(3);break;case 5:t&&Pg(r),A(f)}}))}))}function Tg(e){if(!e.fa&&e.G.size){if(e.I.D(e.g,"playing",e.Z),e.I.D(e.g,"timeupdate",e.Z),e.I.D(e.g,"ended",e.$),"requestVideoFrameCallback"in e.g&&!mt()){var t=e.g,n=function(){-1!=e.O&&(e.$(),-1!=e.O&&(e.O=t.requestVideoFrameCallback(n)))};e.O=t.requestVideoFrameCallback(n)}else e.P.ua(.025);e.M&&e.M.ua(1),e.fa=!0}}function Sg(e){e.fa&&!e.G.size&&(e.I.Ia(e.g,"playing",e.Z),e.I.Ia(e.g,"timeupdate",e.Z),e.I.Ia(e.g,"ended",e.$),-1!=e.O&&(e.g.cancelVideoFrameCallback(e.O),e.O=-1),e.P&&e.P.stop(),e.M&&e.M.stop(),e.fa=!1)}function Eg(e){if(e.A&&e.T&&!e.K){var t=e.T.supportsMultipleMediaElements,n=e.g;n.webkitSupportsFullscreen&&n.webkitDisplayingFullscreen&&(t=!1),e.B==t&&(e.B=!t,e.B?(e.h=e.g,e.F&&(e.F.parentElement&&e.A.removeChild(e.F),e.F=null)):(e.F||(t=document.createElement(e.g.tagName),t.autoplay=!0,t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.display="none",t.setAttribute("playsinline",""),e.F=t),e.h=e.F))}}function wg(e,t){var n;U((function(i){if(1==i.g)return _g(e),w(i,Mg(e,t),2);n=i.h,n.length?xg(e,n):Z("Unsupported HLS interstitial",t),A(i)}))}function Ag(e,t){var n=$n(t.eventNode,"OverlayEvent"),i=n.attributes.uri,r=n.attributes.mimeType,s="true"==n.attributes.loop,a=Vn(n,"z",zn);if(i&&0!=a){var o={viewport:{x:1920,y:1080},topLeft:{x:0,y:0},size:{x:1920,y:1080}},u=$n(n,"Viewport"),l=$n(n,"TopLeft"),c=$n(n,"Size");if(u&&l&&c){if(o=Vn(u,"x",zn),null==o)return;if(u=Vn(u,"y",zn),null==u)return;var d=Vn(l,"x",zn);if(null==d)return;if(l=Vn(l,"y",zn),null==l)return;var h=Vn(c,"x",zn);if(null==h)return;if(c=Vn(c,"y",zn),null==c)return;o={viewport:{x:o,y:u},topLeft:{x:d,y:l},size:{x:h,y:c}}}c=$n(n,"SqueezeCurrent"),n=null,c&&(c=Vn(c,"percentage",Zn))&&(n={viewport:{x:1920,y:1080},topLeft:{x:0,y:0},size:{x:1920*c,y:1080*c}}),xg(e,[{id:t.id,groupId:null,startTime:t.startTime,endTime:t.endTime,uri:i,mimeType:r,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:null,playoutLimit:null,once:!1,pre:!1,post:!1,timelineRange:!0,loop:s,overlay:o,displayOnBackground:-1==a,currentVideo:n,background:null}])}}function xg(e,t){var n,i,r,s,a,o,u,l;U((function(c){switch(c.g){case 1:n=!1,i=d(t),r=i.next();case 2:if(r.done){c.s(4);break}if(s=r.value,!s.uri){Z("Missing URL in interstitial",s),c.s(3);break}if(s.mimeType){c.s(5);break}return x(c,6),a=e.j.xb(),w(c,xh(s.uri,a,e.H.getConfiguration().streaming.retryParameters),8);case 8:s.mimeType=c.h,k(c,5);break;case 6:L(c);case 5:if(o=s.id||JSON.stringify(s),e.W.has(o)){c.s(3);break}s.loop&&!s.overlay&&Z("Loop is only supported in overlay interstitials",s),s.overlay||(n=!0),e.W.add(o),e.G.add(s),u=!1,s.pre&&null==e.o?u=!0:0!=s.startTime||s.canJump?null!=e.o&&(l=s.startTime-e.o,0<l&&10>=l&&(u=!0)):u=!0,u&&(!e.C.has(s)&&Ng(s)&&e.C.set(s,e.j.preload(s.uri,null,s.mimeType||void 0)),Ug(e,s));case 3:r=i.next(),c.s(2);break;case 4:n&&Pg(e),Tg(e),A(c)}}))}function Ig(e,t,n){t=void 0!==t&&t,n=void 0===n?null:n;var i=0,r=null;if(e.G.size&&null!=e.o){var s=e.g.ended,a=Array.from(e.G).sort((function(e,t){return t.startTime-e.startTime})),o=a;for(o=t?a.filter((function(e){return e.pre})):s?a.filter((function(e){return e.post})):a.filter((function(e){return!e.pre&&!e.post})),a=d(o),o=a.next();!o.done;o=a.next()){o=o.value;var u=!1;if(t)u=o.pre;else if(s)u=o.post;else if(!o.pre&&!o.post){var l=e.o-Math.round(1e3*o.startTime)/1e3;0<l&&(1>=l||!o.canJump)&&(u=!(null==n&&e.u&&!e.u.pre&&!e.u.post&&e.u.startTime>=o.startTime))}u&&(!e.u||o.startTime>=e.u.startTime)&&(i==(n||0)?r=o:r&&!o.canJump&&.001<Math.round(1e3*o.startTime)/1e3-Math.round(1e3*r.startTime)/1e3&&(r=o,i=0),i++)}}return r}function kg(e,t,n,i,r,s){s=void 0===s?0:s,e.u=t,Eg(e),!e.h.parentElement&&e.A&&e.A.appendChild(e.h),1==i&&1==n&&(n=Array.from(e.G).filter((function(e){return t.pre?e.pre==t.pre:t.post?e.post==t.post:.001>Math.abs(e.startTime-t.startTime)})).length),t.once&&(s++,e.G.delete(t),Sg(e),t.overlay||Pg(e)),t.mimeType&&(t.mimeType.startsWith("image/")||"text/html"===t.mimeType)?t.overlay?Lg(e,t,n,i,s):Z("Unsupported interstitial",t):e.B&&t.overlay?Z("Unsupported interstitial",t):Rg(e,t,n,i,r,s)}function Lg(e,t,n,i,r){function s(){e.m&&(e.m.stop(),e.m=null),e.A.removeChild(u),Dg(e,t),e.i(new Is("ad-stopped"));var s=Ig(e,t.pre,i-r);s?(e.l.Pa(),kg(e,s,n,++i,Date.now(),r)):e.K=!1}var a=t.overlay,o="text/html"==t.mimeType?"iframe":"img",u=document.createElement(o);u.style.objectFit="contain",u.style.position="absolute",u.style.border="none",Cg(e,t),e.i(new Is("ad-started",(new Map).set("ad",new yg(t,n,i)))),"iframe"==o?u.src=t.uri:(u.src=t.uri,u.onerror=function(t){e.i(new Is("ad-error",(new Map).set("originalEvent",t))),s()});var l=a.viewport,c=a.topLeft;a=a.size,0==l.x&&0==l.y?(u.width=t.overlay.size.x,u.height=t.overlay.size.y,u.style.bottom="10%",u.style.left="0",u.style.right="0",u.style.width="100%",t.overlay.size.y||"iframe"!=o||(u.style.height="auto")):(u.style.height=a.y/l.y*100+"%",u.style.left=c.x/l.x*100+"%",u.style.top=c.y/l.y*100+"%",u.style.width=a.x/l.x*100+"%"),e.A.appendChild(u);var d=Date.now();e.m&&e.m.stop(),e.m=new ze((function(){t.playoutLimit&&(Date.now()-d)/1e3>t.playoutLimit||t.endTime&&e.g.currentTime>t.endTime?(e.i(new Is("ad-complete")),s()):e.g.currentTime<t.startTime&&(e.i(new Is("ad-skipped")),s())})),t.playoutLimit&&!t.endTime?e.m.da(t.playoutLimit):t.endTime&&e.m.ua(.025),e.l.D(e.g,"seeked",(function(){var n=e.g.currentTime;(n<t.startTime||t.endTime&&n>t.endTime)&&(e.m&&e.m.stop(),e.i(new Is("ad-skipped")),s())}))}function Rg(e,t,n,i,r,s){var a,o,u,l,c,d,h,f,p,g,m,v,y,b,T,S,E;U((function(I){switch(I.g){case 1:if(a=Date.now(),e.K=!0,!e.B||1!=i){I.s(2);break}return e.i(new Is("ad-content-pause-requested",(new Map).set("saveLivePosition",!0))),o=new ys,u=function(t){return U((function(n){if(1==n.g)return"detach"!=t.state?n.s(0):mt()?w(n,new Promise((function(e){return new ze(e).da(.1)})),3):n.s(3);o.resolve(),e.l.Ia(e.H,"onstatechange",u),A(n)}))},e.l.D(e.H,"onstatechange",u),w(I,o,2);case 2:return Cg(e,t),e.B||(e.h.style.display="",t.overlay?(e.h.loop=t.loop,l=t.overlay.viewport,c=t.overlay.topLeft,d=t.overlay.size,e.h.style.height=d.y/l.y*100+"%",e.h.style.left=c.x/l.x*100+"%",e.h.style.top=c.y/l.y*100+"%",e.h.style.width=d.x/l.x*100+"%"):(e.g.pause(),null!=t.resumeOffset&&0!=t.resumeOffset&&(e.g.currentTime+=t.resumeOffset),e.h.loop=!1,e.h.style.height="100%",e.h.style.left="0",e.h.style.top="0",e.h.style.width="100%")),h=!1,f=function(){if(!e.B&&!t.overlay&&null==t.resumeOffset)if(t.timelineRange&&t.endTime&&1/0!=t.endTime)e.g.currentTime!=t.endTime&&(e.g.currentTime=t.endTime);else{var n=Date.now();e.g.currentTime+=(n-r)/1e3,r=n}},p=function(a){var o,u;return U((function(l){if(1==l.g){if(f(),o=Ig(e,t.pre,i-s),a&&t.groupId)for(;o&&o.groupId==t.groupId;)i++,o=Ig(e,t.pre,i-s);return e.m&&(!t.groupId||o&&o.groupId!=t.groupId)&&(e.m.stop(),e.m=null),Dg(e,t),o&&!o.overlay?l.s(2):(t.post&&(e.o=null,e.u=null),e.B?w(l,e.j.detach(),4):w(l,e.j.kc(),4))}2!=l.g&&(e.B&&(u=t.resumeOffset,null==u&&(u=t.timelineRange&&t.endTime&&1/0!=t.endTime?t.endTime-(e.o||0):(Date.now()-r)/1e3),e.i(new Is("ad-content-resume-requested",(new Map).set("offset",u)))),e.i(new Is("ad-stopped")),e.l.Pa(),e.K=!1,e.B?Pg(e):(e.h.style.display="none",f(),e.g.ended||e.g.play())),Eg(e),o&&(e.i(new Is("ad-stopped")),e.l.Pa(),kg(e,o,n,++i,r,s)),A(l)}))},g=function(t){return U((function(n){return h?n.return():(h=!0,e.i(new Is("ad-error",(new Map).set("originalEvent",t))),w(n,p(!1),0))}))},m=function(){return U((function(t){if(1==t.g)return h?t.return():(h=!0,w(t,p(!1),2));e.i(new Is("ad-complete")),A(t)}))},e.ea=function(){return U((function(t){return h?t.return():(h=!0,e.i(new Is("ad-skipped")),w(t,p(!0),0))}))},v=new vg(e.h,t,e.ea,n,i,!e.B),e.B||(v.setMuted(e.g.muted),v.setVolume(e.g.volume)),e.i(new Is("ad-started",(new Map).set("ad",v))),(y=v.canSkipNow())&&e.i(new Is("ad-skip-state-changed")),e.l.qa(e.j,"error",g),e.l.D(e.h,"timeupdate",(function(){if(e.h.duration){var t=v.canSkipNow();y!=t&&0<v.getRemainingTime()&&0<v.getDuration()&&e.i(new Is("ad-skip-state-changed")),y=t}})),e.l.qa(e.j,"firstquartile",(function(){f(),e.i(new Is("ad-first-quartile"))})),e.l.qa(e.j,"midpoint",(function(){f(),e.i(new Is("ad-midpoint"))})),e.l.qa(e.j,"thirdquartile",(function(){f(),e.i(new Is("ad-third-quartile"))})),e.l.qa(e.j,"complete",m),e.l.D(e.h,"play",(function(){e.i(new Is("ad-resumed"))})),e.l.D(e.h,"pause",(function(){var t=e.j.getConfiguration();e.h.currentTime>=t.playRangeEnd?m():e.i(new Is("ad-paused"))})),e.l.D(e.h,"volumechange",(function(){e.h.muted?e.i(new Is("ad-muted")):e.i(new Is("ad-volume-changed"))})),x(I,4),_g(e),t.startTime&&t.endTime&&1/0!=t.endTime&&t.startTime!=t.endTime&&(b=t.endTime-t.startTime,0<b&&e.j.configure("playRangeEnd",b)),t.playoutLimit&&!e.m&&(e.m=new ze((function(){e.ea()})).da(t.playoutLimit),e.j.configure("playRangeEnd",t.playoutLimit)),w(I,e.j.Jb(e.h),6);case 6:return e.C.has(t)?w(I,e.C.get(t),10):w(I,e.j.load(t.uri,null,t.mimeType||void 0),8);case 10:return T=I.h,e.C.delete(t),w(I,T?e.j.load(T):e.j.load(t.uri,null,t.mimeType||void 0),8);case 8:e.h.play(),S=(Date.now()-a)/1e3,e.i(new Is("ads-loaded",(new Map).set("loadTime",S))),e.B&&e.g.play(),t.overlay&&(e.l.D(e.g,"seeking",(function(){var n=e.g.currentTime-t.startTime;.1<Math.abs(n-e.h.currentTime)&&(e.h.currentTime=n)})),e.l.D(e.g,"seeked",(function(){var n=e.g.currentTime;(n<t.startTime||t.endTime&&n>t.endTime)&&e.ea()}))),k(I,0);break;case 4:if(E=L(I),!e.K)return I.return();g(E),A(I)}}))}function Cg(e,t){if(t.displayOnBackground&&(e.g.style.zIndex="1"),null!=t.currentVideo){var n=t.currentVideo;e.g.style.transformOrigin="top left";var i=!0,r=[],s=n.topLeft.x/n.viewport.x*100;0<s&&100>=s&&(r.push("translateX("+s+"%)"),i=!1),s=n.topLeft.y/n.viewport.y*100,0<s&&100>=s&&(r.push("translateY("+s+"%)"),i=!1),s=n.size.x/n.viewport.x,1>s&&r.push("scaleX("+s+")"),n=n.size.y/n.viewport.y,1>s&&r.push("scaleY("+n+")"),r.length&&(e.g.style.transform=r.join(" ")),i&&(e.g.style.transition="transform 250ms")}e.A&&(e.A.style.pointerEvents="none",t.background&&(e.A.style.background=t.background)),e.F&&(e.F.style.background=t.overlay?"":"rgb(0, 0, 0)")}function Dg(e,t){t&&!t.displayOnBackground||(e.g.style.zIndex=""),t&&null==t.currentVideo||(e.g.style.transformOrigin="",e.g.style.transition="",e.g.style.transform=""),e.A&&(e.A.style.pointerEvents="",!t||t.background)&&(e.A.style.background=""),e.F&&(e.F.style.background="")}function Mg(e,t){var n,i,r,s,a,o,u,l,c,d,h,f,p,g,m,v,y,b,T,S,E,A,I,R,C,D,M,P,_,O,N,F,B,j,$,G,V,H,K,W,q,Y;return U((function(U){switch(U.g){case 1:if(n=[],!t)return U.return(n);if(i=t.values.find((function(e){return"X-ASSET-URI"==e.key})),r=t.values.find((function(e){return"X-ASSET-LIST"==e.key})),!i&&!r)return U.return(n);if(s=null,(a=t.values.find((function(e){return"ID"==e.key})))&&(s=a.data),o=null==s?Math.floor(10*t.startTime)/10:t.startTime,(u=t.endTime)&&1/0!=t.endTime&&"number"==typeof t.endTime&&(u=null==s?Math.floor(10*t.endTime)/10:t.endTime),l=t.values.find((function(e){return"X-RESTRICT"==e.key})),d=c=!0,l&&l.data&&(h=l.data,c=!h.includes("SKIP"),d=!h.includes("JUMP")),f=c?0:null,(p=t.values.find((function(e){return"X-ENABLE-SKIP-AFTER"==e.key})))&&(g=p.data,f=parseFloat(g),isNaN(f)&&(f=c?0:null)),m=null,(v=t.values.find((function(e){return"X-ENABLE-SKIP-FOR"==e.key})))&&(y=v.data,m=parseFloat(y),isNaN(f)&&(m=null)),b=null,(T=t.values.find((function(e){return"X-RESUME-OFFSET"==e.key})))&&(S=T.data,b=parseFloat(S),isNaN(b)&&(b=null)),E=null,(A=t.values.find((function(e){return"X-PLAYOUT-LIMIT"==e.key})))&&(I=A.data,E=parseFloat(I),isNaN(E)&&(E=null)),D=C=R=!1,(M=t.values.find((function(e){return"CUE"==e.key})))&&(P=M.data,R=P.includes("ONCE"),C=P.includes("PRE"),D=P.includes("POST")),_=!1,(O=t.values.find((function(e){return"X-TIMELINE-OCCUPIES"==e.key})))?(N=O.data,_=N.includes("RANGE")):!T&&e.H.U()&&(_=!C&&!D),i){if(F=i.data,!F)return U.return(n);n.push({id:s,groupId:null,startTime:o,endTime:u,uri:F,mimeType:null,isSkippable:c,skipOffset:f,skipFor:m,canJump:d,resumeOffset:b,playoutLimit:E,once:R,pre:C,post:D,timelineRange:_,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null}),U.s(2);break}if(!r){U.s(2);break}return B=r.data,B?(x(U,4),j={type:11},w(U,Og(e,B,j),6)):U.return(n);case 6:for($=U.h,G=It($),V=JSON.parse(G),(H=V["SKIP-CONTROL"])&&(K=H["ENABLE-SKIP-AFTER"],"number"==typeof K&&(f=parseFloat(K),isNaN(K)&&(f=c?0:null)),W=H["ENABLE-SKIP-FOR"],"number"==typeof W&&(m=parseFloat(W),isNaN(W)&&(m=null))),q=0;q<V.ASSETS.length;q++)Y=V.ASSETS[q],Y.URI&&n.push({id:s+"_shaka_asset_"+q,groupId:s,startTime:o,endTime:u,uri:Y.URI,mimeType:null,isSkippable:c,skipOffset:f,skipFor:m,canJump:d,resumeOffset:b,playoutLimit:E,once:R,pre:C,post:D,timelineRange:_,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null});k(U,2);break;case 4:L(U);case 2:return U.return(n)}}))}function Pg(e){for(var t=[],n=d(e.G),i=n.next(),r={};!i.done;r={Yb:void 0},i=n.next())i=i.value,i.overlay||(r.Yb={start:i.startTime,end:null},i.pre?(r.Yb.start=0,r.Yb.end=null):i.post?(r.Yb.start=-1,r.Yb.end=null):i.timelineRange&&(r.Yb.end=i.endTime),t.find(function(e){return function(t){return e.Yb.start==t.start&&e.Yb.end==t.end}}(r))||t.push(r.Yb));e.i(new Is("ad-cue-points-changed",(new Map).set("cuepoints",t)))}function _g(e){e.j.configure(e.H.Ug()),e.j.configure("ads.disableHLSInterstitial",!0),e.j.configure("ads.disableDASHInterstitial",!0),e.j.configure("playRangeEnd",1/0),_s(e.H.xb(),e.j.xb())}function Og(e,t,n){var i,r,s;return U((function(a){return 1==a.g?(i=Os([t],vs()),r=e.H.xb().request(7,i,n),w(a,r.promise,2)):(s=a.h,a.return(s.data))}))}function Ng(e){return!(e=e.mimeType)||!e.startsWith("image/")&&"text/html"!==e}function Ug(e,t){if(!(e.L.has(t)||e.T&&!e.T.allowPreloadOnDomElements)){var n=function(e){var t=document.createElement("link");return t.rel="preload",t.href=e,t.as="image",document.head.appendChild(t),t},i=[];if(t.background){var r=t.background.match(/url\(('|")?([^'"()]+)('|")\)?/);r&&i.push(n(r[2]))}t.mimeType.startsWith("image/")&&i.push(n(t.uri)),e.L.set(t,i)}}function Fg(e,t){if(e.L.has(t)){var n=e.L.get(t);n=d(n);for(var i=n.next();!i.done;i=n.next())i=i.value,i.parentNode.removeChild(i);e.L.delete(t)}}function Bg(e,t,n,i,r){this.h=e,this.j=In(this.h.skipOffset),this.g=r,this.i=t,this.l=n,this.o=i,this.m=!1}function jg(e,t,n,i){this.B=e,this.K=t,this.h=n,this.l=null,this.P=NaN,this.i=i,this.I=!1,this.A=null,this.j=[],this.M=[],this.L=this.C=this.g=null,this.F=new Map,this.m=[],this.u=[],this.G="",this.O=!0,this.H="",this.o=new ae}function $g(e,t,n){var i,r,s,a,o,u,l,c,d,h,f,p;U((function(g){if(1==g.g)return i={type:7},r=Os([t],vs()),r.method="POST",n&&(s=JSON.stringify(n),r.body=Rt(s)),a=e.K.request(7,r,i),x(g,2),w(g,a.promise,4);if(2!=g.g){if(o=g.h,u=It(o.data),l=JSON.parse(u),!l.manifestUrl||!l.trackingUrl)throw Error("Insufficient data from MediaTailor.");return c=new ve(t),d=new ve(l.trackingUrl),e.G=c.resolve(d).toString(),h=Date.now()/1e3,f=h-e.P,e.i(new Is("ads-loaded",(new Map).set("loadTime",f))),p=new ve(l.manifestUrl),e.l.resolve(c.resolve(p).toString()),e.l=null,k(g,0)}if(L(g),!e.H.length)return e.l.reject("MediaTailor request returned an error and there was no backup asset uri provided."),e.l=null,g.return();e.l.resolve(e.H),e.l=null,A(g)}))}function Gg(e,t,n){var i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b;U((function(T){if(1==T.g)return i={type:8},r=Os([t],vs()),s=e.K.request(7,r,i),x(T,2),w(T,s.promise,4);if(2!=T.g){if(a=T.h,o=[],u=It(a.data),l=JSON.parse(u),0<l.avails.length){if(JSON.stringify(e.j)!=JSON.stringify(l.avails)){for(e.j=l.avails,c=d(e.j),h=c.next();!h.done;h=c.next())for(f=h.value,p=d(f.nonLinearAdsList),g=p.next();!g.done;g=p.next())for(m=g.value,v=d(m.nonLinearAdList),y=v.next();!y.done;y=v.next())b=y.value,Vg(e,b);o=e.getCuePoints(),e.i(new Is("ad-cue-points-changed",(new Map).set("cuepoints",o)))}}else e.j.length&&e.i(new Is("ad-cue-points-changed",(new Map).set("cuepoints",o))),Yg(e),e.j=[];return n&&(e.I||0<o.length)&&Kg(e),k(T,0)}L(T),A(T)}))}function Vg(e,t){var n,i,r,s,a,o,u,l;U((function(c){return 1==c.g?t.staticResource?(n=Hg(t),e.F.get(n)?c.return():(i={type:9},r=Os([t.staticResource],vs()),s=e.K.request(7,r,i),x(c,2),e.F.set(n,[]),w(c,s.promise,4))):c.return():2!=c.g?(a=c.h,o=It(a.data),u=JSON.parse(o),l=u.apps,e.F.set(n,l),k(c,0)):(L(c),e.F.delete(n),void A(c))}))}function Hg(e){return[e.adId,e.adParameters,e.adSystem,e.adTitle,e.creativeAdId,e.creativeId,e.creativeSequence,e.height,e.width,e.staticResource].join("")}function Kg(e){qg(e),e.I||(Wg(e),e.o.D(e.h,"seeked",(function(){Wg(e)})),e.o.D(e.h,"ended",(function(){Yg(e)}))),e.o.D(e.h,"timeupdate",(function(){qg(e)}))}function Wg(e){var t=e.h.currentTime;if(0!=t&&null==e.A){for(var n,i,r=d(e.j),s=r.next();!s.done;s=r.next()){s=s.value;for(var a=d(s.ads),o=a.next();!o.done;o=a.next())if(o=o.value,i){if(o.startTimeInSeconds<t&&o.startTimeInSeconds>i.startTimeInSeconds+i.durationInSeconds){i=o,n=s;break}}else o.startTimeInSeconds<t&&(i=o,n=s)}n&&i&&!e.M.includes(i.adId)&&(e.A=t,e.h.currentTime=n.startTimeInSeconds)}}function qg(e){if(e.h.duration&&(e.g||e.j.length)){var t=e.h.currentTime,n=!1;if(e.g){n=!0;var i=e.C,r=i.startTimeInSeconds+.5*i.durationInSeconds,s=i.startTimeInSeconds+.75*i.durationInSeconds;t>=i.startTimeInSeconds+.25*i.durationInSeconds&&!e.u.includes("firstQuartile")?(e.u.push("firstQuartile"),zg(e,"firstQuartile")):t>=r&&!e.u.includes("midpoint")?(e.u.push("midpoint"),zg(e,"midpoint")):t>=s&&!e.u.includes("thirdQuartile")&&(e.u.push("thirdQuartile"),zg(e,"thirdQuartile")),i=e.g.getRemainingTime(),r=e.g.getDuration(),e.g.canSkipNow()&&0<i&&0<r&&zg(e,"skipStateChanged"),0<r&&(0>=i||i>r)&&Yg(e)}if(!e.g||!e.g.isLinear()){e:for(i=d(e.j),r=i.next();!r.done;r=i.next()){if(r=r.value,e.g&&e.g.isLinear())break;for(s=0;s<r.ads.length;s++){var a=r.ads[s],o=a.startTimeInSeconds+a.durationInSeconds;if(a.startTimeInSeconds<=t&&o>t){if(e.M.includes(a.adId)){if(e.h.ended)continue;e.h.currentTime=o;break e}Yg(e),e.L=r,e.g=new Bg(a,s+1,r.ads.length,!0,e.h),e.C=a,0===s&&zg(e,"breakStart"),Xg(e);break}}}if(!e.g)for(i=d(e.j),r=i.next();!r.done;r=i.next()){if(r=r.value,e.g)break;for(s=0;s<r.nonLinearAdsList.length;s++)if(a=r.nonLinearAdsList[s],a.nonLinearAdList.length){o=r.startTimeInSeconds;var u=e.F.get(Hg(a.nonLinearAdList[0]));if(o<=t&&u&&u.length){Yg(e),o=e,u=d(u);for(var l=u.next();!l.done;l=u.next())if(l=l.value,l.data.source.length){var c=document.createElement("img");c.src=l.data.source[0].url,c.style.top=(l.placeholder.top||0)+"%",c.style.height=100-(l.placeholder.top||0)+"%",c.style.left=(l.placeholder.left||0)+"%",c.style.maxWidth=100-(l.placeholder.left||0)+"%",c.style.objectFit="contain",c.style.position="absolute",o.B.appendChild(c)}e.L=r,e.g=new Bg(a,s+1,r.ads.length,!1,e.h),e.C=a,0===s&&zg(e,"breakStart"),Xg(e);break}}}n&&!e.g&&(t=e.h.currentTime,e.A&&e.A>t&&(e.h.currentTime=e.A),e.A=null)}}}function Yg(e){if(e.g){for(;e.B.lastChild;)e.B.removeChild(e.B.firstChild);e.I||e.M.push(e.C.adId);var t=e.g.m;zg(e,void 0!==t&&t?"skip":"complete"),t=d(e.m);for(var n=t.next();!n.done;n=t.next())n=n.value,e.o.Ia(n.target,n.type,n.listener);e.m=[],e.u=[],t=e.g.getPositionInSequence(),n=e.g.getSequenceLength(),t===n&&zg(e,"breakEnd"),e.g=null,e.C=null,e.L=null}}function Xg(e){var t=!1;e.h.paused?t=!0:(zg(e,"impression"),zg(e,"start")),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted&&zg(e,"mute")}}),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted||zg(e,"unmute")}}),e.m.push({target:e.h,type:"play",listener:function(){t?(zg(e,"impression"),zg(e,"start"),t=!1):zg(e,"resume")}}),e.m.push({target:e.h,type:"pause",listener:function(){zg(e,"pause")}});for(var n=d(e.m),i=n.next();!i.done;i=n.next())i=i.value,e.o.D(i.target,i.type,i.listener)}function zg(e,t){var n=e.C.trackingEvents.find((function(e){return e.eventType==t}));if(n||(n=e.L.adBreakTrackingEvents.find((function(e){return e.eventType==t}))),n){var i={type:10};n=d(n.beaconUrls);for(var r=n.next();!r.done;r=n.next())(r=r.value)&&""!=r&&(r=Os([r],vs()),r.method="POST",e.K.request(7,r,i))}switch(t){case"impression":e.i(new Is("ad-impression"));break;case"start":e.i(new Is("ad-started",(new Map).set("ad",e.g)));break;case"mute":e.i(new Is("ad-muted"));break;case"unmute":e.i(new Is("ad-volume-changed"));break;case"resume":e.i(new Is("ad-resumed"));break;case"pause":e.i(new Is("ad-paused"));break;case"firstQuartile":e.i(new Is("ad-first-quartile"));break;case"midpoint":e.i(new Is("ad-midpoint"));break;case"thirdQuartile":e.i(new Is("ad-third-quartile"));break;case"complete":e.i(new Is("ad-complete")),e.i(new Is("ad-stopped"));break;case"skip":e.i(new Is("ad-skipped")),e.i(new Is("ad-stopped"));break;case"breakStart":e.B.setAttribute("ad-active","true");break;case"breakEnd":e.B.removeAttribute("ad-active");break;case"skipStateChanged":e.i(new Is("ad-skip-state-changed"))}}function Qg(e,t){this.g=e,this.i=null,this.h=t}function Jg(e,t,n,i){var r=this;this.u=e,this.l=t,this.j=null,this.F=NaN,this.i=i,this.G=!1,this.A=this.m=this.o=null,this.B="",this.C=[],this.h=new ae,e=new google.ima.dai.api.UiSettings,e.setLocale(n),this.g=new google.ima.dai.api.StreamManager(this.l,this.u,e),this.i(new Is("ima-stream-manager-loaded",(new Map).set("imaStreamManager",this.g))),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.LOADED,(function(e){Zg(r,e)})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.ERROR,(function(){r.B.length?r.j.resolve(r.B):r.j.reject("IMA Stream request returned an error and there was no backup asset uri provided."),r.j=null})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,(function(){})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.STARTED,(function(e){e=e.getAd(),r.m=new Qg(e,r.l),r.A&&(r.m.i=r.A),r.i(new Is("ad-started",(new Map).set("ad",r.m))),r.u.setAttribute("ad-active","true")})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,(function(){r.u.removeAttribute("ad-active");var e=r.l.currentTime;r.o&&r.o>e&&(r.l.currentTime=r.o,r.o=null)})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,(function(e){r.A=e.getStreamData().adProgressData,r.m&&(r.m.i=r.A)})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,(function(){r.i(new Is("ad-first-quartile"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.MIDPOINT,(function(){r.i(new Is("ad-midpoint"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,(function(){r.i(new Is("ad-third-quartile"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.COMPLETE,(function(){r.i(new Is("ad-complete")),r.i(new Is("ad-stopped")),r.u.removeAttribute("ad-active"),r.m=null})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.SKIPPED,(function(){r.i(new Is("ad-skipped")),r.i(new Is("ad-stopped"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,(function(e){var t=e.getStreamData();e=[],t=d(t.cuepoints);for(var n=t.next();!n.done;n=t.next())n=n.value,e.push({start:n.start,end:n.end});r.C=e,r.i(new Is("ad-cue-points-changed",(new Map).set("cuepoints",e)))}))}function Zg(e,t){e.i(new Is("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-e.F))),t=t.getStreamData().url,e.j.resolve(t),e.j=null,e.G||e.h.D(e.l,"seeked",(function(){var t=e.l.currentTime;if(0!=t){e.g.streamTimeForContentTime(t);var n=e.g.previousCuePointForStreamTime(t);n&&!n.played&&(e.o=t,e.l.currentTime=n.start)}}))}function em(){Rs.call(this),this.h=this.i=this.j=this.g=null,this.m=new sg,this.o=navigator.language,this.l=null}function tm(e,t){if(t&&t.type)switch(t.type){case"ads-loaded":e.m.g.push(t.loadTime);break;case"ad-started":e.m.h++;var n=t.ad;n&&!n.isLinear()&&e.m.j++;break;case"ad-complete":e.m.l++;break;case"ad-skipped":e.m.m++;break;case"ad-error":e.m.i++}e.dispatchEvent(t)}function nm(e){return JSON.stringify(e,(function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Is){var n={};for(i in t)(e=t[i])&&"object"==typeof e?"detail"==i&&(n[i]=e):i in Event||(n[i]=e);return n}if(t instanceof Error){var i=new Set(["name","message","stack"]);for(n in t)i.add(n);for(n=d(Object.getOwnPropertyNames(t)),e=n.next();!e.done;e=n.next())i.add(e.value);for(n={},i=d(i),e=i.next();!e.done;e=i.next())e=e.value,n[e]=t[e];t={__type__:"Error",contents:n}}else if(t instanceof TimeRanges){for(i={__type__:"TimeRanges",length:t.length,start:[],end:[]},t=d(vu(t)),n=t.next();!n.done;n=t.next())n=n.value,e=n.end,i.start.push(n.start),i.end.push(e);t=i}else t=ArrayBuffer.isView(t)&&1===t.BYTES_PER_ELEMENT?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t;return t}}))}function im(e){return JSON.parse(e,(function(e,t){if("NaN"==t)var n=NaN;else if("-Infinity"==t)n=-1/0;else if("Infinity"==t)n=1/0;else if(t&&"object"==typeof t&&"TimeRanges"==t.__type__)n=rm(t);else if(t&&"object"==typeof t&&"Uint8Array"==t.__type__)n=new Uint8Array(t.entries);else if(t&&"object"==typeof t&&"Error"==t.__type__){for(n in e=t.contents,t=Error(e.message),e)t[n]=e[n];n=t}else n=t;return n}))}function rm(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}i=og.prototype,i.needsSkipUI=function(){return!1},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return!0},i.isUsingAnotherMediaElement=function(){return!0},i.getDuration=function(){return this.g.getDuration()},i.getMinSuggestedDuration=function(){return this.g.getMinSuggestedDuration()},i.getRemainingTime=function(){return this.h.getRemainingTime()},i.isPaused=function(){return this.i},i.isSkippable=function(){return 0<=this.g.getSkipTimeOffset()},i.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},i.canSkipNow=function(){return this.h.getAdSkippableState()},i.skip=function(){return this.h.skip()},i.pause=function(){return this.h.pause()},i.play=function(){return this.h.resume()},i.getVolume=function(){return this.h.getVolume()},i.setVolume=function(e){return this.m.volume=e,this.h.setVolume(e)},i.isMuted=function(){return 0==this.h.getVolume()},i.isLinear=function(){return this.g.isLinear()},i.resize=function(e,t){this.h.resize(e,t)},i.setMuted=function(e){(this.m.muted=e)?(this.j=this.getVolume(),this.h.setVolume(0)):this.h.setVolume(this.j)},i.getSequenceLength=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getTotalAds()},i.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getAdPosition()},i.getTitle=function(){return this.g.getTitle()},i.getDescription=function(){return this.g.getDescription()},i.getVastMediaBitrate=function(){return this.g.getVastMediaBitrate()},i.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},i.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},i.getAdId=function(){return this.g.getAdId()},i.getCreativeAdId=function(){return this.g.getCreativeAdId()},i.getAdvertiserName=function(){return this.g.getAdvertiserName()},i.getMediaUrl=function(){return this.g.getMediaUrl()},i.getTimeOffset=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getTimeOffset()},i.getPodIndex=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getPodIndex()},i.release=function(){this.h=this.g=null},K("shaka.ads.ClientSideAd",og),og.prototype.release=og.prototype.release,og.prototype.getPodIndex=og.prototype.getPodIndex,og.prototype.getTimeOffset=og.prototype.getTimeOffset,og.prototype.getMediaUrl=og.prototype.getMediaUrl,og.prototype.getAdvertiserName=og.prototype.getAdvertiserName,og.prototype.getCreativeAdId=og.prototype.getCreativeAdId,og.prototype.getAdId=og.prototype.getAdId,og.prototype.getVastMediaWidth=og.prototype.getVastMediaWidth,og.prototype.getVastMediaHeight=og.prototype.getVastMediaHeight,og.prototype.getVastMediaBitrate=og.prototype.getVastMediaBitrate,og.prototype.getDescription=og.prototype.getDescription,og.prototype.getTitle=og.prototype.getTitle,og.prototype.getPositionInSequence=og.prototype.getPositionInSequence,og.prototype.getSequenceLength=og.prototype.getSequenceLength,og.prototype.setMuted=og.prototype.setMuted,og.prototype.resize=og.prototype.resize,og.prototype.isLinear=og.prototype.isLinear,og.prototype.isMuted=og.prototype.isMuted,og.prototype.setVolume=og.prototype.setVolume,og.prototype.getVolume=og.prototype.getVolume,og.prototype.play=og.prototype.play,og.prototype.pause=og.prototype.pause,og.prototype.skip=og.prototype.skip,og.prototype.canSkipNow=og.prototype.canSkipNow,og.prototype.getTimeUntilSkippable=og.prototype.getTimeUntilSkippable,og.prototype.isSkippable=og.prototype.isSkippable,og.prototype.isPaused=og.prototype.isPaused,og.prototype.getRemainingTime=og.prototype.getRemainingTime,og.prototype.getMinSuggestedDuration=og.prototype.getMinSuggestedDuration,og.prototype.getDuration=og.prototype.getDuration,og.prototype.isUsingAnotherMediaElement=og.prototype.isUsingAnotherMediaElement,og.prototype.hasCustomClick=og.prototype.hasCustomClick,og.prototype.isClientRendering=og.prototype.isClientRendering,og.prototype.needsSkipUI=og.prototype.needsSkipUI,K("shaka.ads.Utils",ug),ug.ADS_LOADED="ads-loaded",ug.AD_STARTED="ad-started",ug.AD_FIRST_QUARTILE="ad-first-quartile",ug.AD_MIDPOINT="ad-midpoint",ug.AD_THIRD_QUARTILE="ad-third-quartile",ug.AD_COMPLETE="ad-complete",ug.AD_STOPPED="ad-stopped",ug.AD_SKIPPED="ad-skipped",ug.AD_VOLUME_CHANGED="ad-volume-changed",ug.AD_MUTED="ad-muted",ug.AD_PAUSED="ad-paused",ug.AD_RESUMED="ad-resumed",ug.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",ug.CUEPOINTS_CHANGED="ad-cue-points-changed",ug.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",ug.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",ug.AD_CLICKED="ad-clicked",ug.AD_PROGRESS="ad-progress",ug.AD_BUFFERING="ad-buffering",ug.AD_IMPRESSION="ad-impression",ug.AD_DURATION_CHANGED="ad-duration-changed",ug.AD_CLOSED="ad-closed",ug.AD_LOADED="ad-loaded",ug.ALL_ADS_COMPLETED="all-ads-completed",ug.AD_LINEAR_CHANGED="ad-linear-changed",ug.AD_METADATA="ad-metadata",ug.AD_RECOVERABLE_ERROR="ad-recoverable-error",ug.AD_ERROR="ad-error",ug.AD_BREAK_READY="ad-break-ready",ug.AD_INTERACTION="ad-interaction",ug.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",ug.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",ug.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",dg.prototype.configure=function(e){this.o=e},dg.prototype.stop=function(){this.g&&this.g.stop(),this.u&&Tu(this.u)},dg.prototype.release=function(){this.stop(),this.A&&this.A.disconnect(),this.h&&this.h.release(),this.g&&this.g.destroy(),this.m.destroy(),this.C.destroy()},i=vg.prototype,i.needsSkipUI=function(){return!0},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return!1},i.isUsingAnotherMediaElement=function(){return this.u},i.getDuration=function(){var e=this.g.duration;return isNaN(e)?-1:e},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){var e=this.g.duration;return isNaN(e)?-1:e-this.g.currentTime},i.isPaused=function(){return this.g.paused},i.isSkippable=function(){return this.h&&null!=this.l?this.getDuration()-this.getRemainingTime()<this.j+this.l:this.h},i.getTimeUntilSkippable=function(){if(this.isSkippable()){var e=this.getRemainingTime()+this.j-this.getDuration();return Math.max(e,0)}return Math.max(this.getRemainingTime(),0)},i.canSkipNow=function(){return this.h&&0==this.getTimeUntilSkippable()},i.skip=function(){this.canSkipNow()&&this.A()},i.pause=function(){return this.g.pause()},i.play=function(){return this.g.play()},i.getVolume=function(){return this.g.volume},i.setVolume=function(e){this.g.volume=e},i.isMuted=function(){return this.g.muted},i.isLinear=function(){return null==this.B},i.resize=function(){},i.setMuted=function(e){this.g.muted=e},i.getSequenceLength=function(){return this.o},i.getPositionInSequence=function(){return this.m},i.getTitle=function(){return""},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getAdId=function(){return this.i.id||""},i.getCreativeAdId=function(){return""},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return this.i.uri},i.getTimeOffset=function(){return 0},i.getPodIndex=function(){return 0},i.release=function(){this.g=null},K("shaka.ads.InterstitialAd",vg),vg.prototype.release=vg.prototype.release,vg.prototype.getPodIndex=vg.prototype.getPodIndex,vg.prototype.getTimeOffset=vg.prototype.getTimeOffset,vg.prototype.getMediaUrl=vg.prototype.getMediaUrl,vg.prototype.getAdvertiserName=vg.prototype.getAdvertiserName,vg.prototype.getCreativeAdId=vg.prototype.getCreativeAdId,vg.prototype.getAdId=vg.prototype.getAdId,vg.prototype.getVastMediaWidth=vg.prototype.getVastMediaWidth,vg.prototype.getVastMediaHeight=vg.prototype.getVastMediaHeight,vg.prototype.getVastMediaBitrate=vg.prototype.getVastMediaBitrate,vg.prototype.getDescription=vg.prototype.getDescription,vg.prototype.getTitle=vg.prototype.getTitle,vg.prototype.getPositionInSequence=vg.prototype.getPositionInSequence,vg.prototype.getSequenceLength=vg.prototype.getSequenceLength,vg.prototype.setMuted=vg.prototype.setMuted,vg.prototype.resize=vg.prototype.resize,vg.prototype.isLinear=vg.prototype.isLinear,vg.prototype.isMuted=vg.prototype.isMuted,vg.prototype.setVolume=vg.prototype.setVolume,vg.prototype.getVolume=vg.prototype.getVolume,vg.prototype.play=vg.prototype.play,vg.prototype.pause=vg.prototype.pause,vg.prototype.skip=vg.prototype.skip,vg.prototype.canSkipNow=vg.prototype.canSkipNow,vg.prototype.getTimeUntilSkippable=vg.prototype.getTimeUntilSkippable,vg.prototype.isSkippable=vg.prototype.isSkippable,vg.prototype.isPaused=vg.prototype.isPaused,vg.prototype.getRemainingTime=vg.prototype.getRemainingTime,vg.prototype.getMinSuggestedDuration=vg.prototype.getMinSuggestedDuration,vg.prototype.getDuration=vg.prototype.getDuration,vg.prototype.isUsingAnotherMediaElement=vg.prototype.isUsingAnotherMediaElement,vg.prototype.hasCustomClick=vg.prototype.hasCustomClick,vg.prototype.isClientRendering=vg.prototype.isClientRendering,vg.prototype.needsSkipUI=vg.prototype.needsSkipUI,i=yg.prototype,i.needsSkipUI=function(){return!0},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return!1},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return-1},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return-1},i.isPaused=function(){return!1},i.isSkippable=function(){return!1},i.getTimeUntilSkippable=function(){return 0},i.canSkipNow=function(){return!1},i.skip=function(){},i.pause=function(){},i.play=function(){},i.getVolume=function(){return 1},i.setVolume=function(){},i.isMuted=function(){return!1},i.isLinear=function(){return this.i},i.resize=function(){},i.setMuted=function(){},i.getSequenceLength=function(){return this.j},i.getPositionInSequence=function(){return this.h},i.getTitle=function(){return""},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getAdId=function(){return this.g.id||""},i.getCreativeAdId=function(){return""},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return this.g.uri},i.getTimeOffset=function(){return 0},i.getPodIndex=function(){return 0},i.release=function(){},K("shaka.ads.InterstitialStaticAd",yg),yg.prototype.release=yg.prototype.release,yg.prototype.getPodIndex=yg.prototype.getPodIndex,yg.prototype.getTimeOffset=yg.prototype.getTimeOffset,yg.prototype.getMediaUrl=yg.prototype.getMediaUrl,yg.prototype.getAdvertiserName=yg.prototype.getAdvertiserName,yg.prototype.getCreativeAdId=yg.prototype.getCreativeAdId,yg.prototype.getAdId=yg.prototype.getAdId,yg.prototype.getVastMediaWidth=yg.prototype.getVastMediaWidth,yg.prototype.getVastMediaHeight=yg.prototype.getVastMediaHeight,yg.prototype.getVastMediaBitrate=yg.prototype.getVastMediaBitrate,yg.prototype.getDescription=yg.prototype.getDescription,yg.prototype.getTitle=yg.prototype.getTitle,yg.prototype.getPositionInSequence=yg.prototype.getPositionInSequence,yg.prototype.getSequenceLength=yg.prototype.getSequenceLength,yg.prototype.setMuted=yg.prototype.setMuted,yg.prototype.resize=yg.prototype.resize,yg.prototype.isLinear=yg.prototype.isLinear,yg.prototype.isMuted=yg.prototype.isMuted,yg.prototype.setVolume=yg.prototype.setVolume,yg.prototype.getVolume=yg.prototype.getVolume,yg.prototype.play=yg.prototype.play,yg.prototype.pause=yg.prototype.pause,yg.prototype.skip=yg.prototype.skip,yg.prototype.canSkipNow=yg.prototype.canSkipNow,yg.prototype.getTimeUntilSkippable=yg.prototype.getTimeUntilSkippable,yg.prototype.isSkippable=yg.prototype.isSkippable,yg.prototype.isPaused=yg.prototype.isPaused,yg.prototype.getRemainingTime=yg.prototype.getRemainingTime,yg.prototype.getMinSuggestedDuration=yg.prototype.getMinSuggestedDuration,yg.prototype.getDuration=yg.prototype.getDuration,yg.prototype.isUsingAnotherMediaElement=yg.prototype.isUsingAnotherMediaElement,yg.prototype.hasCustomClick=yg.prototype.hasCustomClick,yg.prototype.isClientRendering=yg.prototype.isClientRendering,yg.prototype.needsSkipUI=yg.prototype.needsSkipUI,i=bg.prototype,i.configure=function(e){this.T=e,Eg(this)},i.stop=function(){if(this.l&&this.l.Pa(),this.W.clear(),this.G.clear(),this.j.pf(),this.C.size){var e=Array.from(this.C.values());e=d(e);for(var t=e.next();!t.done;t=e.next())(t=t.value)&&t.then((function(e){e&&e.destroy()}))}if(this.C.clear(),this.L.size)for(e=Array.from(this.L.keys()),e=d(e),t=e.next();!t.done;t=e.next())Fg(this,t.value);this.L.clear(),this.j.detach(),this.K=!1,this.u=this.o=null,this.B=!0,this.h=this.g,this.F=null,Dg(this),Sg(this),this.A&&Tu(this.A),this.m&&(this.m.stop(),this.m=null)},i.release=function(){this.stop(),this.I&&this.I.release(),this.l&&this.l.release(),this.P&&(this.P.stop(),this.P=null),this.M&&(this.M.stop(),this.M=null),this.j.destroy()},i.If=function(){return this.j},i.addAdUrlInterstitial=function(e){var t,n,i,r,s,a,o,u,l,c=this;return U((function(f){switch(f.g){case 1:return t={type:12},w(f,Og(c,e,t),2);case 2:if(n=f.h,i=Dn(n,"VAST,vmap:VMAP"),!i)throw new je(2,10,10007);if(r=[],"VAST"==i.tagName){r=lg(i,c.o),f.s(3);break}if("vmap:VMAP"!=i.tagName){f.s(3);break}for(var p=[],g=d(Un(i,"vmap:AdBreak")),m=g.next();!m.done;m=g.next()){var v=m.value,y=v.attributes.timeOffset;y&&(m=null,m="start"==y?0:"end"==y?1/0:In(y),(v=$n(v,"vmap:AdSource"))&&(v=$n(v,"vmap:AdTagURI"))&&(v=Fn(v))&&p.push({time:m,uri:v}))}s=d(p),a=s.next();case 5:if(a.done){f.s(3);break}return o=a.value,w(f,Og(c,o.uri,t),8);case 8:if(u=f.h,l=Dn(u,"VAST"),!l)throw new je(2,10,10007);r.push.apply(r,h(lg(l,o.time))),a=s.next(),f.s(5);break;case 3:xg(c,r),A(f)}}))},i=Bg.prototype,i.needsSkipUI=function(){return!0},i.isClientRendering=function(){return!1},i.hasCustomClick=function(){return!1},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return this.h.durationInSeconds},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return this.h.startTimeInSeconds+this.h.durationInSeconds-this.g.currentTime},i.isPaused=function(){return this.g.paused},i.isSkippable=function(){return"number"==typeof this.j},i.getTimeUntilSkippable=function(){if("number"!=typeof this.j)return this.getRemainingTime();var e=this.getRemainingTime()+this.j-this.getDuration();return Math.max(e,0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.m=!0,this.g.currentTime+=this.getRemainingTime()},i.pause=function(){return this.g.pause()},i.play=function(){return this.g.play()},i.getVolume=function(){return this.g.volume},i.setVolume=function(e){this.g.volume=e},i.isMuted=function(){return this.g.muted},i.isLinear=function(){return this.o},i.resize=function(){},i.setMuted=function(e){this.g.muted=e},i.getSequenceLength=function(){return this.l?this.l:1},i.getPositionInSequence=function(){return this.i?this.i:1},i.getTitle=function(){return this.h.adTitle},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getAdId=function(){return this.h.adId},i.getCreativeAdId=function(){return this.h.creativeId},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){return 0},i.getPodIndex=function(){return 0},i.release=function(){this.l=this.i=this.g=this.h=null},K("shaka.ads.MediaTailorAd",Bg),Bg.prototype.release=Bg.prototype.release,Bg.prototype.getPodIndex=Bg.prototype.getPodIndex,Bg.prototype.getTimeOffset=Bg.prototype.getTimeOffset,Bg.prototype.getMediaUrl=Bg.prototype.getMediaUrl,Bg.prototype.getAdvertiserName=Bg.prototype.getAdvertiserName,Bg.prototype.getCreativeAdId=Bg.prototype.getCreativeAdId,Bg.prototype.getAdId=Bg.prototype.getAdId,Bg.prototype.getVastMediaWidth=Bg.prototype.getVastMediaWidth,Bg.prototype.getVastMediaHeight=Bg.prototype.getVastMediaHeight,Bg.prototype.getVastMediaBitrate=Bg.prototype.getVastMediaBitrate,Bg.prototype.getDescription=Bg.prototype.getDescription,Bg.prototype.getTitle=Bg.prototype.getTitle,Bg.prototype.getPositionInSequence=Bg.prototype.getPositionInSequence,Bg.prototype.getSequenceLength=Bg.prototype.getSequenceLength,Bg.prototype.setMuted=Bg.prototype.setMuted,Bg.prototype.resize=Bg.prototype.resize,Bg.prototype.isLinear=Bg.prototype.isLinear,Bg.prototype.isMuted=Bg.prototype.isMuted,Bg.prototype.setVolume=Bg.prototype.setVolume,Bg.prototype.getVolume=Bg.prototype.getVolume,Bg.prototype.play=Bg.prototype.play,Bg.prototype.pause=Bg.prototype.pause,Bg.prototype.skip=Bg.prototype.skip,Bg.prototype.canSkipNow=Bg.prototype.canSkipNow,Bg.prototype.getTimeUntilSkippable=Bg.prototype.getTimeUntilSkippable,Bg.prototype.isSkippable=Bg.prototype.isSkippable,Bg.prototype.isPaused=Bg.prototype.isPaused,Bg.prototype.getRemainingTime=Bg.prototype.getRemainingTime,Bg.prototype.getMinSuggestedDuration=Bg.prototype.getMinSuggestedDuration,Bg.prototype.getDuration=Bg.prototype.getDuration,Bg.prototype.isUsingAnotherMediaElement=Bg.prototype.isUsingAnotherMediaElement,Bg.prototype.hasCustomClick=Bg.prototype.hasCustomClick,Bg.prototype.isClientRendering=Bg.prototype.isClientRendering,Bg.prototype.needsSkipUI=Bg.prototype.needsSkipUI,jg.prototype.stop=function(){for(var e=d(this.m),t=e.next();!t.done;t=e.next())t=t.value,this.o.Ia(t.target,t.type,t.listener);Yg(this),this.m=[],this.u=[],this.G="",this.O=!0,this.H="",this.A=null,this.j=[],this.M=[],this.F.clear()},jg.prototype.release=function(){this.stop(),this.o&&this.o.release()},jg.prototype.onManifestUpdated=function(e){this.I=e,""!=this.G&&(Gg(this,this.G,this.O),this.O=!1)},jg.prototype.getCuePoints=function(){for(var e=[],t=d(this.j),n=t.next();!n.done;n=t.next()){n=d(n.value.ads);for(var i=n.next();!i.done;i=n.next())i=i.value,e.push({start:i.startTimeInSeconds,end:i.startTimeInSeconds+i.durationInSeconds})}return e},i=Qg.prototype,i.needsSkipUI=function(){return!0},i.isClientRendering=function(){return!1},i.hasCustomClick=function(){return!0},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return this.i?this.i.duration:-1},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return this.i?this.i.duration-this.i.currentTime:-1},i.isPaused=function(){return this.h.paused},i.isSkippable=function(){return this.g.isSkippable()},i.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.h.currentTime+=this.getRemainingTime()},i.pause=function(){return this.h.pause()},i.play=function(){return this.h.play()},i.getVolume=function(){return this.h.volume},i.setVolume=function(e){this.h.volume=e},i.isMuted=function(){return this.h.muted},i.isLinear=function(){return!0},i.resize=function(){},i.setMuted=function(e){this.h.muted=e},i.getSequenceLength=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getTotalAds()},i.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getAdPosition()},i.getTitle=function(){return this.g.getTitle()},i.getDescription=function(){return this.g.getDescription()},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},i.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},i.getAdId=function(){return this.g.getAdId()},i.getCreativeAdId=function(){return this.g.getCreativeAdId()},i.getAdvertiserName=function(){return this.g.getAdvertiserName()},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getTimeOffset()},i.getPodIndex=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getPodIndex()},i.release=function(){this.h=this.i=this.g=null},K("shaka.ads.ServerSideAd",Qg),Qg.prototype.release=Qg.prototype.release,Qg.prototype.getPodIndex=Qg.prototype.getPodIndex,Qg.prototype.getTimeOffset=Qg.prototype.getTimeOffset,Qg.prototype.getMediaUrl=Qg.prototype.getMediaUrl,Qg.prototype.getAdvertiserName=Qg.prototype.getAdvertiserName,Qg.prototype.getCreativeAdId=Qg.prototype.getCreativeAdId,Qg.prototype.getAdId=Qg.prototype.getAdId,Qg.prototype.getVastMediaWidth=Qg.prototype.getVastMediaWidth,Qg.prototype.getVastMediaHeight=Qg.prototype.getVastMediaHeight,Qg.prototype.getVastMediaBitrate=Qg.prototype.getVastMediaBitrate,Qg.prototype.getDescription=Qg.prototype.getDescription,Qg.prototype.getTitle=Qg.prototype.getTitle,Qg.prototype.getPositionInSequence=Qg.prototype.getPositionInSequence,Qg.prototype.getSequenceLength=Qg.prototype.getSequenceLength,Qg.prototype.setMuted=Qg.prototype.setMuted,Qg.prototype.resize=Qg.prototype.resize,Qg.prototype.isLinear=Qg.prototype.isLinear,Qg.prototype.isMuted=Qg.prototype.isMuted,Qg.prototype.setVolume=Qg.prototype.setVolume,Qg.prototype.getVolume=Qg.prototype.getVolume,Qg.prototype.play=Qg.prototype.play,Qg.prototype.pause=Qg.prototype.pause,Qg.prototype.skip=Qg.prototype.skip,Qg.prototype.canSkipNow=Qg.prototype.canSkipNow,Qg.prototype.getTimeUntilSkippable=Qg.prototype.getTimeUntilSkippable,Qg.prototype.isSkippable=Qg.prototype.isSkippable,Qg.prototype.isPaused=Qg.prototype.isPaused,Qg.prototype.getRemainingTime=Qg.prototype.getRemainingTime,Qg.prototype.getMinSuggestedDuration=Qg.prototype.getMinSuggestedDuration,Qg.prototype.getDuration=Qg.prototype.getDuration,Qg.prototype.isUsingAnotherMediaElement=Qg.prototype.isUsingAnotherMediaElement,Qg.prototype.hasCustomClick=Qg.prototype.hasCustomClick,Qg.prototype.isClientRendering=Qg.prototype.isClientRendering,Qg.prototype.needsSkipUI=Qg.prototype.needsSkipUI,i=Jg.prototype,i.configure=function(){},i.stop=function(){this.B="",this.o=null,this.C=[]},i.release=function(){this.stop(),this.h&&this.h.release()},i.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.g.onTimedMetadata(t)}},i.getCuePoints=function(){return this.C},b(em,Rs),i=em.prototype,i.setLocale=function(e){this.o=e},i.configure=function(e){this.l=e,this.g&&this.g.configure(this.l),this.j&&this.j.configure(this.l),this.h&&this.h.configure(this.l)},i.initInterstitial=function(e,t,n){var i=this;this.g&&this.g.release(),this.g=new bg(e,t,n,(function(e){return tm(i,e)})),this.g.configure(this.l)},i.initClientSide=function(t,n,i){var r=this;if(!e.google||!google.ima||!google.ima.AdsLoader)throw new je(2,10,1e4);this.j&&this.j.release(),this.j=new dg(t,n,this.o,i,(function(e){return tm(r,e)})),this.j.configure(this.l)},i.release=function(){this.g&&(this.g.release(),this.g=null),this.j&&(this.j.release(),this.j=null),this.i&&(this.i.release(),this.i=null),this.h&&(this.h.release(),this.h=null),Rs.prototype.release.call(this)},i.onAssetUnload=function(){this.g&&this.g.stop(),this.j&&this.j.stop(),this.i&&this.i.stop(),this.h&&this.h.stop(),this.dispatchEvent(new Is("ad-stopped")),this.dispatchEvent(new Is("ad-content-attach-requested")),this.m=new sg},i.requestClientSideAds=function(e){if(!this.j)throw new je(1,10,10001);var t=this.j;t.g&&t.g.destroy(),t.m&&t.m.contentComplete(),t.G=Date.now()/1e3,t.m.requestAds(e)},i.updateClientSideAdsRenderingSettings=function(e){if(!this.j)throw new je(1,10,10001);var t=this.j;t.B=e,t.g&&t.g.updateAdsRenderingSettings(t.B)},i.initMediaTailor=function(e,t,n){var i=this;this.i&&this.i.release(),this.i=new jg(e,t,n,(function(e){return tm(i,e)}))},i.requestMediaTailorStream=function(e,t,n){if(!this.i)throw new je(1,10,10005);var i=this.i;return n=void 0===n?"":n,i.l?e=Promise.reject(new je(1,10,10004)):(i.l=new ys,$g(i,e,t),i.H=n||"",i.P=Date.now()/1e3,e=i.l),e},i.addMediaTailorTrackingUrl=function(e){if(!this.i)throw new je(1,10,10005);var t=this.i;t.G=e,t.i(new Is("ads-loaded",(new Map).set("loadTime",0)))},i.initServerSide=function(t,n){var i=this;if(!e.google||!google.ima||!google.ima.dai)throw new je(2,10,10002);this.h&&this.h.release(),this.h=new Jg(t,n,this.o,(function(e){return tm(i,e)})),this.h.configure(this.l)},i.requestServerSideStream=function(e,t){if(t=void 0===t?"":t,!this.h)throw new je(1,10,10003);e.adTagParameters||(e.adTagParameters={});var n=e.adTagParameters;return(n.mpt||n.mpv)&&Z('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv="v4.14.12",n=this.h,n.j?e=Promise.reject(new je(1,10,10004)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(n.G=!0),n.j=new ys,n.g.requestStream(e),n.B=t||"",n.F=Date.now()/1e3,e=n.j),e},i.replaceServerSideAdTagParameters=function(e){if(!this.h)throw new je(1,10,10003);(e.mpt||e.mpv)&&Z('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.'),e.mpt="Shaka Player",e.mpv="v4.14.12",this.h.g.replaceAdTagParameters(e)},i.getServerSideCuePoints=function(){return he("AdManager.getServerSideCuePoints","Please use getCuePoints function."),this.getCuePoints()},i.getCuePoints=function(){var e=[];return this.h&&(e=e.concat(this.h.getCuePoints())),this.i&&(e=e.concat(this.i.getCuePoints())),e},i.getStats=function(){var e=this.m;return{loadTimes:e.g,averageLoadTime:ag(e),started:e.h,overlayAds:e.j,playedCompletely:e.l,skipped:e.m,errors:e.i}},i.onManifestUpdated=function(e){this.i&&this.i.onManifestUpdated(e)},i.onDashTimedMetadata=function(e){this.h&&"urn:google:dai:2018"==e.schemeIdUri&&this.h.g.processMetadata(e.schemeIdUri,e.eventNode?e.eventNode.attributes.messageData:null,e.startTime)},i.onHlsTimedMetadata=function(e,t){this.h&&this.h.g.processMetadata("ID3",e.data,t)},i.onCueMetadataChange=function(e){this.h&&this.h.onCueMetadataChange(e)},i.onHLSInterstitialMetadata=function(e,t,n){this.l&&this.l.disableHLSInterstitial||(this.g||this.initInterstitial(null,e,t),this.g&&wg(this.g,n))},i.onDASHInterstitialMetadata=function(e,t,n){if(!this.l||!this.l.disableDASHInterstitial){var i=n.schemeIdUri;if("urn:mpeg:dash:event:alternativeMPD:insert:2025"==i||"urn:mpeg:dash:event:alternativeMPD:replace:2025"==i){if(this.g||this.initInterstitial(null,e,t),this.g&&(e=this.g,t="urn:mpeg:dash:event:alternativeMPD:replace:2025"==n.schemeIdUri,i="urn:mpeg:dash:event:alternativeMPD:insert:2025"==n.schemeIdUri,t||i)){for(var r,s=n.startTime,a=n.endTime,o=null,u=0,l=d(n.eventNode.children),c=l.next();!c.done;c=l.next())if(c=c.value,"AlternativeMPD"==c.tagName){if(c=c.attributes.uri){r=c;break}}else if("InsertPresentation"==c.tagName||"ReplacePresentation"==c.tagName){var h=c.attributes.url;if(h){r=h,(l=Vn(c,"maxDuration",zn))&&(o=l/n.timescale),(l=Vn(c,"returnOffset",zn))&&(u=l/n.timescale),t&&u&&(a=s+u);break}}r&&xg(e,[{id:n.id,groupId:null,startTime:s,endTime:a,uri:r,mimeType:null,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:i?u:null,playoutLimit:o,once:!1,pre:!1,post:!1,timelineRange:t&&!i,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null}])}}else("urn:mpeg:dash:event:2012"==i||"urn:scte:dash:scte214-events"==i)&&n.eventNode&&$n(n.eventNode,"OverlayEvent")&&(this.g||this.initInterstitial(null,e,t),this.g&&Ag(this.g,n))}},i.addCustomInterstitial=function(e){if(!this.g)throw new je(1,10,10006);xg(this.g,[e])},i.addAdUrlInterstitial=function(e){if(!this.g)throw new je(1,10,10006);return this.g.addAdUrlInterstitial(e)},i.getInterstitialPlayer=function(){if(!this.g)throw new je(1,10,10006);return this.g.If()},K("shaka.ads.AdManager",em),em.prototype.getInterstitialPlayer=em.prototype.getInterstitialPlayer,em.prototype.addAdUrlInterstitial=em.prototype.addAdUrlInterstitial,em.prototype.addCustomInterstitial=em.prototype.addCustomInterstitial,em.prototype.onDASHInterstitialMetadata=em.prototype.onDASHInterstitialMetadata,em.prototype.onHLSInterstitialMetadata=em.prototype.onHLSInterstitialMetadata,em.prototype.onCueMetadataChange=em.prototype.onCueMetadataChange,em.prototype.onHlsTimedMetadata=em.prototype.onHlsTimedMetadata,em.prototype.onDashTimedMetadata=em.prototype.onDashTimedMetadata,em.prototype.onManifestUpdated=em.prototype.onManifestUpdated,em.prototype.getStats=em.prototype.getStats,em.prototype.getCuePoints=em.prototype.getCuePoints,em.prototype.getServerSideCuePoints=em.prototype.getServerSideCuePoints,em.prototype.replaceServerSideAdTagParameters=em.prototype.replaceServerSideAdTagParameters,em.prototype.requestServerSideStream=em.prototype.requestServerSideStream,em.prototype.initServerSide=em.prototype.initServerSide,em.prototype.addMediaTailorTrackingUrl=em.prototype.addMediaTailorTrackingUrl,em.prototype.requestMediaTailorStream=em.prototype.requestMediaTailorStream,em.prototype.initMediaTailor=em.prototype.initMediaTailor,em.prototype.updateClientSideAdsRenderingSettings=em.prototype.updateClientSideAdsRenderingSettings,em.prototype.requestClientSideAds=em.prototype.requestClientSideAds,em.prototype.onAssetUnload=em.prototype.onAssetUnload,em.prototype.release=em.prototype.release,em.prototype.initClientSide=em.prototype.initClientSide,em.prototype.initInterstitial=em.prototype.initInterstitial,em.prototype.configure=em.prototype.configure,em.prototype.setLocale=em.prototype.setLocale,em.ADS_LOADED="ads-loaded",em.AD_STARTED="ad-started",em.AD_FIRST_QUARTILE="ad-first-quartile",em.AD_MIDPOINT="ad-midpoint",em.AD_THIRD_QUARTILE="ad-third-quartile",em.AD_COMPLETE="ad-complete",em.AD_STOPPED="ad-stopped",em.AD_SKIPPED="ad-skipped",em.AD_VOLUME_CHANGED="ad-volume-changed",em.AD_MUTED="ad-muted",em.AD_PAUSED="ad-paused",em.AD_RESUMED="ad-resumed",em.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",em.CUEPOINTS_CHANGED="ad-cue-points-changed",em.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",em.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",em.AD_CLICKED="ad-clicked",em.AD_PROGRESS="ad-progress",em.AD_BUFFERING="ad-buffering",em.AD_IMPRESSION="ad-impression",em.AD_DURATION_CHANGED="ad-duration-changed",em.AD_CLOSED="ad-closed",em.AD_LOADED="ad-loaded",em.ALL_ADS_COMPLETED="all-ads-completed",em.AD_LINEAR_CHANGED="ad-linear-changed",em.AD_METADATA="ad-metadata",em.AD_RECOVERABLE_ERROR="ad-recoverable-error",em.AD_ERROR="ad-error",em.AD_BREAK_READY="ad-break-ready",em.AD_INTERACTION="ad-interaction",em.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",em.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",em.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",rg=function(){return new em};var sm="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),am="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),om=["loop","playbackRate"],um=["pause","play"],lm=(new Map).set("getAssetUri",2).set("getAudioLanguages",4).set("getAudioLanguagesAndRoles",4).set("getBufferFullness",1).set("getBufferedInfo",2).set("getExpiration",2).set("getKeyStatuses",2).set("getPlaybackRate",2).set("getTextLanguages",4).set("getTextLanguagesAndRoles",4).set("getImageTracks",2).set("getThumbnails",2).set("isAudioOnly",10).set("isBuffering",1).set("isInProgress",1).set("isLive",10).set("isTextTrackVisible",1).set("keySystem",10).set("seekRange",1).set("getLoadMode",10).set("getManifestType",10).set("isFullyLoaded",1).set("isEnded",1),cm=(new Map).set("getConfiguration",4).set("getConfigurationForLowLatency",4).set("getStats",5).set("getAudioTracks",2).set("getTextTracks",2).set("getVariantTracks",2),dm=(new Map).set("getPlayheadTimeAsDate",1).set("getPresentationStartTimeAsDate",20).set("getSegmentAvailabilityDuration",20),hm=[["getConfiguration","configure","getConfigurationForLowLatency","configurationForLowLatency"]],fm=[["isTextTrackVisible","setTextTrackVisibility"]],pm="addChaptersTrack addTextTrackAsync addThumbnailsTrack cancelTrickPlay configure configurationForLowLatency getChapters getChaptersTracks resetConfiguration retryStreaming selectAudioLanguage selectAudioTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay updateStartTime goToLive".split(" "),gm=["attach","attachCanvas","detach","load","unload"];function mm(e,t,n,i,r,s,a){var o=this;this.G=e,this.K=a,this.l=new ze(t),this.L=n,this.u=!1,this.A=i,this.F=r,this.M=s,this.i=this.m=!1,this.I="",this.o=null,this.B=function(){return Sm(o)},this.C=function(e,t){switch(e=im(t),e.type){case"event":var n=e.targetName,i=ks(e.event);o.A(n,i);break;case"update":for(i in n=e.update,n)for(var r in e=o.g[i]||{},n[i])e[r]=n[i][r];o.u&&(o.L(),o.u=!1);break;case"asyncComplete":if(r=e.id,i=e.error,t=e.res,e=o.h.get(r),o.h.delete(r),e)if(i){for(n in r=new je(i.severity,i.category,i.code),i)r[n]=i[n];e.reject(r)}else e.resolve(t)}},this.g={video:{},player:{}},this.H=0,this.h=new Map,this.j=null,Lm.add(this)}function vm(e){e.i&&chrome.cast.requestSession((function(t){return ym(e,t)}),(function(t){return bm(e,t)}))}function ym(e,t){var n=e.M();Im=t,t.addUpdateListener(e.B),t.addMessageListener("urn:x-cast:com.google.shaka.v2",e.C),Sm(e),wm(e,{type:"init",initState:n,appData:e.o}),e.j.resolve()}function bm(e,t){var n=8003;switch(t.code){case"cancel":n=8004;break;case"timeout":n=8005;break;case"receiver_unavailable":n=8006}e.j.reject(new je(2,8,n,t))}function Tm(e){var t=Im;t.removeUpdateListener(e.B),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.C)}function Sm(e){var t=!!Im&&"connected"==Im.status;if(e.i&&!t){for(var n in e.F(),e.g)e.g[n]={};Em(e)}e.i=t,e.I=t?Im.receiver.friendlyName:"",e.l.qb()}function Em(e){if(e.h)for(var t=d(e.h.keys()),n=t.next();!n.done;n=t.next()){n=n.value;var i=e.h.get(n);e.h.delete(n),i.reject(new je(1,7,7e3))}}function wm(e,t){t=nm(t);var n=Im;try{n.sendMessage("urn:x-cast:com.google.shaka.v2",t,(function(){}),te)}catch(i){throw t=new je(2,8,8005,i),n=new Is("error",(new Map).set("detail",t)),e.A("player",n),e.Nc(),t}}i=mm.prototype,i.destroy=function(){return Lm.delete(this),Em(this),Im&&Tm(this),this.l&&(this.l.stop(),this.l=null),this.F=this.A=null,this.i=this.m=!1,this.C=this.B=this.j=this.h=this.g=this.o=null,Promise.resolve()},i.ob=function(){return this.i},i.ag=function(){return this.I},i.init=function(){if(this.G.length)if(e.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.l.qb();var t=new chrome.cast.SessionRequest(this.G,[],null,this.K,null);t=new chrome.cast.ApiConfig(t,(function(e){for(var t=d(Lm),n=t.next();!n.done;n=t.next()){n=n.value;var i=e;n.j=new ys,n.u=!0,ym(n,i)}}),(function(e){for(var t=d(Lm),n=t.next();!n.done;n=t.next())n=n.value,xm="available"==e,n.l.qb()}),"origin_scoped"),chrome.cast.initialize(t,(function(){}),(function(){})),xm&&this.l.da(Am),(t=Im)&&t.status!=chrome.cast.SessionStatus.STOPPED?(this.j=new ys,this.u=!0,ym(this,t)):Im=null}else e.__onGCastApiAvailable!==Rm&&(km=e.__onGCastApiAvailable||null,e.__onGCastApiAvailable=Rm)},i.ig=function(e){this.o=e,this.i&&wm(this,{type:"appData",appData:this.o})},i.cast=function(){var e=this;return U((function(t){if(!e.m)throw new je(1,8,8e3);if(!xm)throw new je(1,8,8001);if(e.i)throw new je(1,8,8002);return e.j=new ys,chrome.cast.requestSession((function(t){return ym(e,t)}),(function(t){return bm(e,t)})),w(t,e.j,0)}))},i.Nc=function(){if(this.i){if(Em(this),Im){Tm(this);try{Im.stop((function(){}),(function(){}))}catch(LL){}Im=null}Sm(this)}},i.get=function(e,t){var n=this;if("video"==e){if(um.includes(t))return function(){return n.nh.apply(n,[e,t].concat(h(F.apply(0,arguments))))}}else if("player"==e){if(dm.has(t)&&!this.get("player","isLive")())return function(){};if(pm.includes(t))return function(){return n.nh.apply(n,[e,t].concat(h(F.apply(0,arguments))))};if(gm.includes(t))return function(){return n.pj.apply(n,[e,t].concat(h(F.apply(0,arguments))))};if(lm.has(t)||cm.has(t))return function(){return n.g[e][t]}}return this.g[e][t]},i.set=function(e,t,n){this.g[e][t]=n,wm(this,{type:"set",targetName:e,property:t,value:n})},i.nh=function(e,t){wm(this,{type:"call",targetName:e,methodName:t,args:F.apply(2,arguments)})},i.pj=function(e,t){var n=F.apply(2,arguments),i=new ys,r=this.H.toString();this.H++,this.h.set(r,i);try{wm(this,{type:"asyncCall",targetName:e,methodName:t,args:n,id:r})}catch(s){i.reject(s)}return i};var Am=.02,xm=!1,Im=null,km=null,Lm=new Set;function Rm(t){if(km?e.__onGCastApiAvailable=km:delete e.__onGCastApiAvailable,km=null,t)for(var n=d(Lm),i=n.next();!i.done;i=n.next())i.value.init();"function"===typeof e.__onGCastApiAvailable&&e.__onGCastApiAvailable(t)}function Cm(t,n,i,r){r=void 0!==r&&r,Rs.call(this);var s=this;this.i=t,this.h=n,this.m=this.o=this.l=this.u=this.j=null,this.C=i,this.B=r,this.A=new Map,this.g=null,e.chrome?(this.g=new mm(i,(function(){return Om(s)}),(function(){return Nm(s)}),(function(e,t){return jm(s,e,t)}),(function(){return Um(s)}),(function(){return _m(s)}),r),Dm(this)):(this.j=this.i,this.u=this.h)}function Dm(e){e.g.init(),e.m=new ae;for(var t=d(sm),n=t.next();!n.done;n=t.next())e.m.D(e.i,n.value,(function(t){e.g.ob()||(t=ks(t),e.l.dispatchEvent(t))}));for(var i in Ls)e.m.D(e.h,Ls[i],(function(t){e.g.ob()||e.o.dispatchEvent(t)}));for(var r in e.j={},t={},e.i)t={ud:t.ud},t.ud=r,Object.defineProperty(e.j,t.ud,{configurable:!1,enumerable:!0,get:function(t){return function(){return Fm(e,t.ud)}}(t),set:function(t){return function(n){var i=t.ud;e.g.ob()?e.g.set("video",i,n):e.i[i]=n}}(t)});e.u={},Pm(e,(function(t){Object.defineProperty(e.u,t,{configurable:!1,enumerable:!0,get:function(){return Bm(e,t)}})})),Mm(e),e.l=new Rs,e.l.Re=e.j,e.o=new Rs,e.o.Re=e.u}function Mm(e){var t=new Map;Pm(e,(function(n,i){t.has(i)?(i=t.get(i),n.length<i.length?e.A.set(n,i):e.A.set(i,n)):t.set(i,n)}))}function Pm(e,t){function n(e){return"constructor"!=e&&"function"==typeof r[e]&&!s.has(e)}var i,r=e.h,s=new Set;for(i in r)n(i)&&(s.add(i),t(i,r[i]));for(e=Object.getPrototypeOf(r),i=Object.getPrototypeOf({});e&&e!=i;){for(var a=d(Object.getOwnPropertyNames(e)),o=a.next();!o.done;o=a.next())o=o.value,n(o)&&(s.add(o),t(o,r[o]));e=Object.getPrototypeOf(e)}}function _m(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.h.Oc(),startTime:null};e.i.pause();for(var n=d(om),i=n.next();!i.done;i=n.next())i=i.value,t.video[i]=e.i[i];for(e.i.ended||(t.startTime=e.i.currentTime),n=d(hm),i=n.next();!i.done;i=n.next()){var r=i.value;i=r[1],r=e.h[r[0]](),t.player[i]=r}for(n=d(fm),i=n.next();!i.done;i=n.next())r=i.value,i=r[1],r=e.h[r[0]](),t.playerAfterLoad[i]=r;return t}function Om(e){var t=new Is("caststatuschanged");e.dispatchEvent(t)}function Nm(e){var t=new Is(e.j.paused?"pause":"play");e.l.dispatchEvent(t)}function Um(e){for(var t=d(hm),n=t.next();!n.done;n=t.next()){var i=n.value;n=i[1],i=e.g.get("player",i[0])(),e.h[n](i)}var r=e.g.get("player","getAssetUri")();i=e.g.get("video","ended"),t=Promise.resolve();var s,a=e.i.autoplay;n=null,i||(n=e.g.get("video","currentTime")),(i=e.g.get("player","getTextTracks")())&&i.length&&(s=i.find((function(e){return e.active})));var o=e.g.get("player","isTextTrackVisible")();r&&(e.i.autoplay=!1,t=e.h.load(r,n));var u={};for(n=d(om),i=n.next();!i.done;i=n.next())i=i.value,u[i]=e.g.get("video",i);t.then((function(){if(e.i){for(var t=d(om),n=t.next();!n.done;n=t.next())n=n.value,e.i[n]=u[n];for(t=d(fm),n=t.next();!n.done;n=t.next()){var i=n.value;n=i[1],i=e.g.get("player",i[0])(),e.h[n](i)}e.h.yh(o),s&&e.h.hg(s.language,s.roles,s.forced),e.i.autoplay=a,r&&e.i.play()}}),(function(t){t=(new Map).set("detail",t),t=new Is("error",t),e.h.dispatchEvent(t)}))}function Fm(e,t){if("addEventListener"==t)return function(t,n,i){return e.l.addEventListener(t,n,i)};if("removeEventListener"==t)return function(t,n,i){return e.l.removeEventListener(t,n,i)};if(e.g.ob()&&0==Object.keys(e.g.g.video).length){var n=e.i[t];if("function"!=typeof n)return n}return e.g.ob()?e.g.get("video",t):(t=e.i[t],"function"==typeof t&&(t=t.bind(e.i)),t)}function Bm(e,t){if(e.A.has(t)&&(t=e.A.get(t)),"addEventListener"==t)return function(t,n,i){return e.o.addEventListener(t,n,i)};if("removeEventListener"==t)return function(t,n,i){return e.o.removeEventListener(t,n,i)};if("getMediaElement"==t)return function(){return e.j};if("getSharedConfiguration"==t)return e.g.get("player","getConfiguration");if("getNetworkingEngine"==t)return function(){return e.h.xb()};if("getDrmEngine"==t)return function(){return e.h.C};if("getAdManager"==t)return function(){return e.h.Pg()};if("setVideoContainer"==t)return function(t){return e.h.Bh(t)};if(e.g.ob()){if("getManifest"==t||"drmInfo"==t)return function(){return Z(t+"() does not work while casting!"),null};if("attach"==t||"detach"==t)return function(){return Z(t+"() does not work while casting!"),Promise.resolve()};if("getChapters"==t)return function(){return Z(t+"() does not work while casting!"),[]}}return e.g.ob()&&0==Object.keys(e.g.g.video).length&&(lm.has(t)||cm.has(t))||!e.g.ob()?e.h[t].bind(e.h):e.g.get("player",t)}function jm(e,t,n){e.g.ob()&&("video"==t?e.l.dispatchEvent(n):"player"==t&&e.o.dispatchEvent(n))}function $m(e,t,n,i){Rs.call(this);var r=this;this.g=e,this.h=t,this.j=new ae,this.H={video:e,player:t},this.F=n||function(){},this.I=i||function(e){return e},this.i=null,this.G=!1,this.o=!0,this.m=0,this.B=!1,this.A=!0,this.u=this.l=null,this.C=new ze((function(){qm(r)})),Gm(this)}function Gm(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return Vm(e)},t.onSenderDisconnected=function(){return Vm(e)},t.onSystemVolumeChanged=function(){var t=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();t&&Zm(e,{type:"update",update:{video:{volume:t.level,muted:t.muted}}},e.l),Zm(e,{type:"event",targetName:"video",event:{type:"volumechange"}},e.l)},e.u=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.u.onMessage=function(t){return Qm(e,t)},e.l=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.l.onMessage=function(t){return zm(e,t)},t.start(),t=d(sm);for(var n=t.next();!n.done;n=t.next())e.j.D(e.g,n.value,(function(t){return Wm(e,"video",t)}));for(var i in Ls)e.j.D(e.h,Ls[i],(function(t){return Wm(e,"player",t)}));e.j.D(e.g,"loadeddata",(function(){e.B=!0})),e.j.D(e.h,"loading",(function(){e.o=!1,Hm(e)})),e.j.D(e.g,"playing",(function(){e.o=!1,Hm(e)})),e.j.D(e.g,"pause",(function(){Hm(e)})),e.j.D(e.h,"unloading",(function(){e.o=!0,Hm(e)})),e.j.D(e.g,"ended",(function(){new ze((function(){e.g&&e.g.ended&&(e.o=!0,Hm(e))})).da(nv)}))}function Vm(e){e.m=0,e.A=!0,e.G=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,Hm(e)}function Hm(e){var t;U((function(n){return 1==n.g?w(n,Promise.resolve(),2):e.h?(t=new Is("caststatuschanged"),e.dispatchEvent(t),Ym(e)||ev(e),void A(n)):n.return()}))}function Km(e,t,n){var i,r,s,a,o,u,l,c,d,h;U((function(f){switch(f.g){case 1:for(i in t.player)r=t.player[i],e.h[i](r);return e.F(n),s=e.g.autoplay,t.manifest?(e.g.autoplay=!1,x(f,5),w(f,e.h.load(t.manifest,t.startTime),7)):w(f,Promise.resolve(),3);case 7:k(f,3);break;case 5:return a=L(f),o=(new Map).set("detail",a),u=new Is("error",o),e.h&&e.h.dispatchEvent(u),f.return();case 3:if(!e.h)return f.return();for(l in t.video)c=t.video[l],e.g[l]=c;for(d in t.playerAfterLoad)h=t.playerAfterLoad[d],e.h[d](h);e.g.autoplay=s,t.manifest&&(e.g.play(),ev(e)),A(f)}}))}function Wm(e,t,n){e.h&&(qm(e),Zm(e,{type:"event",targetName:t,event:n},e.l))}function qm(e){e.C.da(tv);for(var t={video:{},player:{}},n=d(am),i=n.next();!i.done;i=n.next())i=i.value,t.video[i]=e.g[i];e.h.U()&&dm.forEach((function(n,i){0==e.m%n&&(t.player[i]=e.h[i]())})),lm.forEach((function(n,i){0==e.m%n&&(t.player[i]=e.h[i]())})),(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),Zm(e,{type:"update",update:t},e.l),cm.forEach((function(t,n){0==e.m%t&&(t={player:{}},t.player[n]=e.h[n](),Zm(e,{type:"update",update:t},e.l))})),e.B&&(e.m+=1),Ym(e)}function Ym(e){return!(!e.A||!e.g.duration&&!e.h.U())&&(Xm(e),e.A=!1,!0)}function Xm(e,t){var n={contentId:e.h.Oc(),streamType:e.h.U()?"LIVE":"BUFFERED",contentType:""};e.h.U()||(n.duration=e.g.duration),e.i&&(n.metadata=e.i),ev(e,void 0===t?0:t,n)}function zm(e,t){var n=im(t.data);switch(n.type){case"init":e.m=0,e.B=!1,e.A=!0,Km(e,n.initState,n.appData),qm(e);break;case"appData":e.F(n.appData);break;case"set":var i=n.targetName,r=n.property;if(n=n.value,"video"==i){if(t=cast.receiver.CastReceiverManager.getInstance(),"volume"==r){t.setSystemVolumeLevel(n);break}if("muted"==r){t.setSystemVolumeMuted(n);break}}e.H[i][r]=n;break;case"call":i=e.H[n.targetName],i[n.methodName].apply(i,n.args);break;case"asyncCall":i=n.targetName,r=n.methodName,"player"==i&&"load"==r&&(e.m=0,e.B=!1);var s=n.id,a=t.senderId;t=e.H[i],n=t[r].apply(t,n.args),"player"==i&&"load"==r&&(n=n.then((function(){e.A=!0}))),n.then((function(t){return Jm(e,a,s,null,t)}),(function(t){return Jm(e,a,s,t,null)}))}}function Qm(e,t){var n=im(t.data);switch(n.type){case"PLAY":e.g.play(),ev(e);break;case"PAUSE":e.g.pause(),ev(e);break;case"SEEK":t=n.currentTime;var i=n.resumeState;null!=t&&(e.g.currentTime=Number(t)),i&&"PLAYBACK_START"==i?(e.g.play(),ev(e)):i&&"PLAYBACK_PAUSE"==i&&(e.g.pause(),ev(e));break;case"STOP":e.h.kc().then((function(){e.h&&ev(e)}));break;case"GET_STATUS":Xm(e,Number(n.requestId));break;case"VOLUME":i=n.volume,t=i.level,i=i.muted;var r=e.g.volume,s=e.g.muted;null!=t&&(e.g.volume=Number(t)),null!=i&&(e.g.muted=i),r==e.g.volume&&s==e.g.muted||ev(e);break;case"LOAD":e.m=0,e.B=!1,e.A=!1,t=n.media,i=n.currentTime,r=e.I(t.contentId),s=n.autoplay||!0,e.F(t.customData),s&&(e.g.autoplay=!0),e.h.load(r,i).then((function(){e.h&&Xm(e)})).catch((function(t){var i="LOAD_FAILED";7==t.category&&7e3==t.code&&(i="LOAD_CANCELLED"),Zm(e,{requestId:Number(n.requestId),type:i},e.u)}));break;default:Zm(e,{requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},e.u)}}function Jm(e,t,n,i,r){e.h&&Zm(e,{type:"asyncComplete",id:n,error:i,res:r},e.l,t)}function Zm(e,t,n,i){e.G&&(e=nm(t),i?n.getCastChannel(i).send(e):n.broadcast(e))}function ev(e,t,n){n=void 0===n?null:n;var i={mediaSessionId:0,playbackRate:e.g.playbackRate,playerState:e.o?iv:e.h.Of()?sv:e.g.paused?av:rv,currentTime:e.g.currentTime,supportedMediaCommands:63,volume:{level:e.g.volume,muted:e.g.muted}};n&&(i.media=n),Zm(e,{requestId:void 0===t?0:t,type:"MEDIA_STATUS",status:[i]},e.u)}b(Cm,Rs),i=Cm.prototype,i.destroy=function(e){return this.g&&e&&this.g.Nc(),this.m&&(this.m.release(),this.m=null),e=[],this.h&&(e.push(this.h.destroy()),this.h=null),this.g&&(e.push(this.g.destroy()),this.g=null),this.u=this.j=this.i=null,Rs.prototype.release.call(this),Promise.all(e)},i.Li=function(){return this.j},i.If=function(){return this.u},i.Wh=function(){return!!this.g&&(this.g.m&&xm)},i.ob=function(){return!!this.g&&this.g.ob()},i.ag=function(){return this.g?this.g.ag():""},i.cast=function(){var e=this;return U((function(t){return 1==t.g?e.g?w(t,e.g.cast(),2):t.return():e.h?w(t,e.h.kc(),0):t.return()}))},i.ig=function(e){this.g&&this.g.ig(e)},i.Ej=function(){this.g&&vm(this.g)},i.Nc=function(){this.g&&this.g.Nc()},i.Xh=function(e,t){t=void 0!==t&&t;var n=this;return U((function(i){if(1==i.g)return e==n.C&&t==n.B?i.return():(n.C=e,n.B=t,n.g?(n.g.Nc(),w(i,n.g.destroy(),2)):i.return());n.g=null,n.g=new mm(e,(function(){return Om(n)}),(function(){return Nm(n)}),(function(e,t){return jm(n,e,t)}),(function(){return Um(n)}),(function(){return _m(n)}),t),n.g.init(),A(i)}))},K("shaka.cast.CastProxy",Cm),Cm.prototype.changeReceiverId=Cm.prototype.Xh,Cm.prototype.forceDisconnect=Cm.prototype.Nc,Cm.prototype.suggestDisconnect=Cm.prototype.Ej,Cm.prototype.setAppData=Cm.prototype.ig,Cm.prototype.cast=Cm.prototype.cast,Cm.prototype.receiverName=Cm.prototype.ag,Cm.prototype.isCasting=Cm.prototype.ob,Cm.prototype.canCast=Cm.prototype.Wh,Cm.prototype.getPlayer=Cm.prototype.If,Cm.prototype.getVideo=Cm.prototype.Li,Cm.prototype.destroy=Cm.prototype.destroy,b($m,Rs),i=$m.prototype,i.isConnected=function(){return this.G},i.Si=function(){return this.o},i.Bj=function(e){this.i=e},i.ai=function(){this.i=null},i.Cj=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.title=e},i.Aj=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.images=[{url:e}]},i.zj=function(e){this.i||(this.i={}),this.i.artist=e,this.i.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},i.destroy=function(){var e,t,n=this;return U((function(i){if(1==i.g)return n.j&&(n.j.release(),n.j=null),e=[],n.h&&(e.push(n.h.destroy()),n.h=null),n.C&&(n.C.stop(),n.C=null),n.g=null,n.H=null,n.F=null,n.G=!1,n.o=!0,n.l=null,n.u=null,Rs.prototype.release.call(n),w(i,Promise.all(e),2);t=cast.receiver.CastReceiverManager.getInstance(),t.stop(),A(i)}))},K("shaka.cast.CastReceiver",$m),$m.prototype.destroy=$m.prototype.destroy,$m.prototype.setContentArtist=$m.prototype.zj,$m.prototype.setContentImage=$m.prototype.Aj,$m.prototype.setContentTitle=$m.prototype.Cj,$m.prototype.clearContentMetadata=$m.prototype.ai,$m.prototype.setContentMetadata=$m.prototype.Bj,$m.prototype.isIdle=$m.prototype.Si,$m.prototype.isConnected=$m.prototype.isConnected;var tv=.5,nv=5,iv="IDLE",rv="PLAYING",sv="BUFFERING",av="PAUSED";function ov(e,t,n,i,r){if(i>=r)return null;for(var s=-1,a=-1,o=0;o<n.length;o++)if(n[o].some((function(e){return null!=e&&""!=e.g.trim()}))){s=o;break}for(o=n.length-1;0<=o;o--)if(n[o].some((function(e){return null!=e&&""!=e.g.trim()}))){a=o;break}if(-1===s||-1===a)return null;for(var u=o=!1,l="white",c="black",d=uv(i,r,o,u,l,c);s<=a;s++){for(var h=n[s],f=-1,p=-1,g=0;g<h.length;g++)if(null!=h[g]&&""!==h[g].g.trim()){f=g;break}for(g=h.length-1;0<=g;g--)if(null!=h[g]&&""!==h[g].g.trim()){p=g;break}if(-1===f||-1===p)h=lv(i,r),e.nestedCues.push(h);else{for(;f<=p;f++)if(g=h[f]){var m=g.l,v=g.i,y=g.j,b=g.h;m==o&&v==u&&y==l&&b==c||(d.payload&&e.nestedCues.push(d),d=uv(i,r,m,v,y,b),o=m,u=v,l=y,c=b),d.payload+=g.g}else d.payload+=" ";d.payload&&e.nestedCues.push(d),s!==a&&(d=lv(i,r),e.nestedCues.push(d)),d=uv(i,r,o,u,l,c)}}return e.nestedCues.length?{cue:e,stream:t}:null}function uv(e,t,n,i,r,s){return e=new ci(e,t,""),n&&e.textDecoration.push(Oi),i&&(e.fontStyle=Pi),e.color=r,e.backgroundColor=s,e}function lv(e,t){return e=new ci(e,t,""),e.lineBreak=!0,e}function cv(e,t,n,i,r){this.g=e,this.l=t,this.i=n,this.h=i,this.j=r}function dv(e,t){this.i=[],this.g=1,this.h=0,this.C=e,this.B=t,this.j=this.m=!1,this.l="white",this.o="black",this.u=this.A=null,fv(this)}function hv(e,t,n){var i="CC"+(1+(e.C<<1|e.B)),r=new ci(t,n,"");r.lineInterpretation=1;var s=Sv.get(e.g);return s&&(r.line=s),null!=e.u&&null!=e.A&&(r.position=10+Math.min(70,10*e.u)+2.5*e.A),(t=ov(r,i,e.i,t,n))&&15<e.g+t.cue.nestedCues.length-3&&(s=Sv.get(e.g+3-t.cue.nestedCues.length))&&(r.line=s),t}function fv(e){mv(e,0,15),e.g=1}function pv(e,t,n){if(!(32>n||127<n)){var i="";switch(t){case 0:i=vv.has(n)?vv.get(n):String.fromCharCode(n);break;case 1:i=yv.get(n);break;case 2:e.i[e.g].pop(),i=bv.get(n);break;case 3:e.i[e.g].pop(),i=Tv.get(n)}i&&e.i[e.g].push(new cv(i,e.m,e.j,e.o,e.l))}}function gv(e,t,n,i){if(!(0>n||0>t))if(t>=n)for(--i;0<=i;i--)e.i[t+i]=e.i[n+i].map((function(e){return e}));else for(var r=0;r<i;r++)e.i[t+r]=e.i[n+r].map((function(e){return e}))}function mv(e,t,n){for(var i=0;i<=n;i++)e.i[t+i]=[]}var vv=new Map([[39,"’"],[42,"á"],[92,"é"],[92,"é"],[94,"í"],[95,"ó"],[96,"ú"],[123,"ç"],[124,"÷"],[125,"Ñ"],[126,"ñ"],[127,"█"]]),yv=new Map([[48,"®"],[49,"°"],[50,"½"],[51,"¿"],[52,"™"],[53,"¢"],[54,"£"],[55,"♪"],[56,"à"],[57," "],[58,"è"],[59,"â"],[60,"ê"],[61,"î"],[62,"ô"],[63,"û"]]),bv=new Map([[32,"Á"],[33,"É"],[34,"Ó"],[35,"Ú"],[36,"Ü"],[37,"ü"],[38,"‘"],[39,"¡"],[40,"*"],[41,"'"],[42,"─"],[43,"©"],[44,"℠"],[45,"·"],[46,"“"],[47,"”"],[48,"À"],[49,"Â"],[50,"Ç"],[51,"È"],[52,"Ê"],[53,"Ë"],[54,"ë"],[55,"Î"],[56,"Ï"],[57,"ï"],[58,"Ô"],[59,"Ù"],[60,"ù"],[61,"Û"],[62,"«"],[63,"»"]]),Tv=new Map([[32,"Ã"],[33,"ã"],[34,"Í"],[35,"Ì"],[36,"ì"],[37,"Ò"],[38,"ò"],[39,"Õ"],[40,"õ"],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,"Ä"],[49,"ä"],[50,"Ö"],[51,"ö"],[52,"ß"],[53,"¥"],[54,"¤"],[55,"│"],[56,"Å"],[57,"å"],[58,"Ø"],[59,"ø"],[60,"┌"],[61,"┐"],[62,"└"],[63,"┘"]]),Sv=new Map([[1,10],[2,15.33],[3,20.66],[4,26],[5,31.33],[6,36.66],[7,42],[8,47.33],[9,52.66],[10,58],[11,63.33],[12,68.66],[13,74],[14,79.33],[15,84.66]]);function Ev(e,t){this.h=0,this.o=new dv(e,t),this.i=new dv(e,t),this.g=this.j=new dv(e,t),this.l=0,this.m=null}function wv(e,t,n){e.g=e.i;var i=e.g,r=null;return 3!==e.h&&4!==e.h&&(r=hv(i,e.l,n),n=e.i,n.g=0<n.h?n.h:0,mv(n,0,15),n=e.j,n.g=0<n.h?n.h:0,mv(n,0,15),i.g=15),e.h=3,i.h=t,r}function Av(e){e.h=1,e.g=e.j,e.g.h=0}function xv(e){ee("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),e.g=e.o,e.h=4}var Iv="black green blue cyan red yellow magenta black".split(" "),kv="white green blue cyan red yellow magenta white_italics".split(" ");function Lv(e,t){this.I=t,this.M=e,this.K=this.l=!1,this.m=this.o=this.G=this.L=this.H=0,this.F=2,this.i=[],this.g=this.h=this.j=0,this.C=this.A=!1,this.B="white",this.u="black",Rv(this)}function Rv(e){e.i=[];for(var t=0;16>t;t++)e.i.push(Cv())}function Cv(){for(var e=[],t=0;42>t;t++)e.push(null);return e}function Dv(e,t){Mv(e)&&(e.i[e.h][e.g]=new cv(t,e.C,e.A,e.u,e.B),e.g++)}function Mv(e){var t=e.g<e.m&&0<=e.g;return e.h<e.o&&0<=e.h&&t}function Pv(e){for(var t=0,n=1;16>n;n++,t++)e.i[t]=e.i[n];for(n=0;1>n;n++,t++)e.i[t]=Cv()}function _v(e,t,n){var i=new ci(e.j,t,"");i.textAlign=0===e.F?"left":1===e.F?"right":bi;var r=i.region;switch(e.I&&(r.id+="svc"+e.I),r.id+="win"+e.M,r.height=e.o,r.width=e.m,r.heightUnits=2,r.widthUnits=2,r.viewportAnchorX=e.H,r.viewportAnchorY=e.L,r.viewportAnchorUnits=e.K?gn:2,e.G){case 0:r.regionAnchorX=0,r.regionAnchorY=0;break;case 1:r.regionAnchorX=50,r.regionAnchorY=0;break;case 2:r.regionAnchorX=100,r.regionAnchorY=0;break;case 3:r.regionAnchorX=0,r.regionAnchorY=50;break;case 4:r.regionAnchorX=50,r.regionAnchorY=50;break;case 5:r.regionAnchorX=100,r.regionAnchorY=50;break;case 6:r.regionAnchorX=0,r.regionAnchorY=100;break;case 7:r.regionAnchorX=50,r.regionAnchorY=100;break;case 8:r.regionAnchorX=100,r.regionAnchorY=100}return(n=ov(i,"svc"+n,e.i,e.j,t))&&(e.j=t),n}function Ov(){this.i=[],this.h=null,this.g=0}function Nv(e,t){3===t.type?(e.g=2*(63&t.value)-1,e.h=[]):e.h&&(0<e.g&&(e.h.push(t),e.g--),0===e.g&&(e.i.push(new Uv(e.h)),e.h=null,e.g=0))}function Uv(e){this.g=0,this.h=e}function Fv(e){if(!e.ta())throw new je(2,2,3e3);return e.h[e.g++]}function Bv(e){this.i=e,this.h=[null,null,null,null,null,null,null,null],this.g=null}function jv(e,t,n,i){if(!e.g)return[];if(24==n)return n=Fv(t).value,i=Fv(t).value,n=function(e){return e.map((function(e){return("0"+(255&e).toString(16)).slice(-2)})).join("")}([n,i]),Dv(e.g,String.fromCharCode(parseInt(n,16))),[];t=e.g;var r=null;switch(n){case 8:!Mv(t)||0>=t.g&&0>=t.h||(0>=t.g?(t.g=t.m-1,t.h--):t.g--,t.i[t.h][t.g]=null);break;case 13:t.isVisible()&&(r=_v(t,i,e.i)),t.h+1>=t.o?Pv(t):t.h++,t.g=0;break;case 14:t.isVisible()&&(r=_v(t,i,e.i)),t.i[t.h]=Cv(),t.g=0;break;case 12:t.isVisible()&&(r=_v(t,i,e.i)),Rv(t),t.h=0,t.g=0}return r?[r]:[]}function $v(e,t,n,i){if(128<=n&&135>=n)i=7&n,e.h[i]&&(e.g=e.h[i]);else{if(136===n){n=Fv(t).value,t=[],n=d(Gv(e,n));for(var r=n.next();!r.done;r=n.next()){if(r=e.h[r.value],r.isVisible()){var s=_v(r,i,e.i);s&&t.push(s)}Rv(r)}return t}if(137===n)for(t=Fv(t).value,t=d(Gv(e,t)),n=t.next();!n.done;n=t.next())n=e.h[n.value],n.isVisible()||(n.j=i),n.display();else{if(138===n){for(n=Fv(t).value,t=null,n=d(Gv(e,n)),r=n.next();!r.done;r=n.next())r=e.h[r.value],r.isVisible()&&(t=_v(r,i,e.i)),r.l=!1;return t?[t]:[]}if(139===n){for(n=Fv(t).value,t=null,n=d(Gv(e,n)),r=n.next();!r.done;r=n.next())r=e.h[r.value],r.isVisible()?t=_v(r,i,e.i):r.j=i,r.l=!r.l;return t?[t]:[]}if(140===n)return t=Fv(t).value,Vv(e,t,i);if(143===n)return i=Vv(e,255,i),Hv(e),i;if(144===n)t.skip(1),i=Fv(t).value,e.g&&(e.g.A=0<(128&i),e.g.C=0<(64&i));else if(145===n)i=Fv(t).value,n=Fv(t).value,t.skip(1),e.g&&(t=Kv((48&n)>>4,(12&n)>>2,3&n),e.g.B=Kv((48&i)>>4,(12&i)>>2,3&i),e.g.u=t);else if(146===n)i=Fv(t).value,t=Fv(t).value,e.g&&(e=e.g,e.h=15&i,e.g=63&t);else if(151===n)t.skip(1),t.skip(1),i=Fv(t).value,t.skip(1),e.g&&(e.g.F=3&i);else if(152<=n&&159>=n){n=(15&n)-8,r=null!==e.h[n],r||(s=new Lv(n,e.i),s.j=i,e.h[n]=s),i=Fv(t).value,s=Fv(t).value;var a=Fv(t).value,o=Fv(t).value,u=Fv(t).value;t=Fv(t).value,r&&0===(7&t)||(t=e.h[n],t.h=0,t.g=0,t.C=!1,t.A=!1,t.B="white",t.u="black"),t=e.h[n],t.l=0<(32&i),t.L=127&s,t.H=a,t.G=(240&o)>>4,t.K=0<(128&s),t.o=1+(15&o),t.m=1+(63&u),e.g=e.h[n]}}}return[]}function Gv(e,t){for(var n=[],i=0;8>i;i++)1===(1&t)&&e.h[i]&&n.push(i),t>>=1;return n}function Vv(e,t,n){var i=[];t=d(Gv(e,t));for(var r=t.next();!r.done;r=t.next()){r=r.value;var s=e.h[r];s.isVisible()&&(s=_v(s,n,e.i))&&i.push(s),e.h[r]=null}return i}function Hv(e){e.g=null,e.h=[null,null,null,null,null,null,null,null]}function Kv(e,t,n){var i={0:0,1:0,2:1,3:1};return e=i[e],t=i[t],n=i[n],qv[e<<2|t<<1|n]}Lv.prototype.isVisible=function(){return this.l},Lv.prototype.display=function(){this.l=!0},Uv.prototype.ta=function(){return this.g<this.h.length},Uv.prototype.Aa=function(){return this.g},Uv.prototype.skip=function(e){if(this.g+e>this.h.length)throw new je(2,2,3e3);this.g+=e},Uv.prototype.ph=function(e){if(0>this.g-e)throw new je(2,2,3e3);this.g-=e};var Wv=new Map([[32," "],[33," "],[37,"…"],[42,"Š"],[44,"Œ"],[48,"█"],[49,"‘"],[50,"’"],[51,"“"],[52,"”"],[53,"•"],[57,"™"],[58,"š"],[60,"œ"],[61,"℠"],[63,"Ÿ"],[118,"⅛"],[119,"⅜"],[120,"⅝"],[121,"⅞"],[122,"│"],[123,"┐"],[124,"└"],[125,"─"],[126,"┘"],[127,"┌"]]),qv="black blue green cyan red magenta yellow white".split(" ");function Yv(){this.h=[],this.g=[],this.i=new Ov,this.l=0,this.m=new Map([["CC1",new Ev(0,0)],["CC2",new Ev(0,1)],["CC3",new Ev(1,0)],["CC4",new Ev(1,1)]]),this.u=this.o=0,this.j=new Map,this.B=!0,this.A=new Set,Xv(this)}function Xv(e){e.o=0,e.u=0;for(var t=d(e.m.values()),n=t.next();!n.done;n=t.next())n=n.value,n.h=0,n.g=n.j,n.m=null,fv(n.i),fv(n.j),fv(n.o);e.B=!0}function zv(e,t){var n=t.type;if(16===(112&t.kb)){var i=t.kb>>3&1;0===n?e.o=i:e.u=i}if(i="CC"+(1+(n<<1|(n?e.u:e.o))),n=e.m.get(i),255===t.kb&&255===t.Kb||!t.kb&&!t.Kb||!Jv(t.kb)||!Jv(t.Kb))return 45<=++e.l&&Xv(e),null;e.l=0,t.kb&=127,t.Kb&=127;var r=t.kb;if(1<=r&&15>=r||!t.kb&&!t.Kb)return null;if(r=null,16===(112&t.kb))e:{if(e.A.add(i),i=t.kb,e=t.Kb,n.m===(i<<8|e))n.m=null;else if(n.m=i<<8|e,16===(240&i)&&64===(192&e)){t=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(7&i)<<1|e>>5&1],i="white",r=!1;var s=null,a=95<e?e-96:e-64;13>=a?i=kv[Math.floor(a/2)]:15>=a?r=!0:s=Math.floor((a-16)/2),e=1===(1&e),4!==n.h&&(a=n.g,3===n.h&&t!==a.g&&(n=1+t-a.h,gv(a,n,1+a.g-a.h,a.h),mv(a,0,n-1),mv(a,t+1,15-t)),a.g=t,a.m=e,a.j=r,a.l=i,a.u=s,a.o="black")}else if(17===(247&i)&&32===(240&e))n.g.m=!1,n.g.j=!1,n.g.l="white",pv(n.g,0,32),i=!1,t=kv[(14&e)>>1],"white_italics"===t&&(t="white",i=!0),n.g.m=1===(1&e),n.g.j=i,n.g.l=t;else if(16===(247&i)&&32===(240&e)||23===(247&i)&&45===(255&e))t="black",0===(7&i)&&(t=Iv[(14&e)>>1]),n.g.o=t;else if(17===(247&i)&&48===(240&e))pv(n.g,1,e);else if(18===(246&i)&&32===(224&e))pv(n.g,1&i?3:2,e);else{if(20===(246&i)&&32===(240&e)){switch(e=t.pts,i=null,t.Kb){case 32:Av(n);break;case 33:n=n.g,n.i[n.g].pop();break;case 37:i=wv(n,2,e);break;case 38:i=wv(n,3,e);break;case 39:i=wv(n,4,e);break;case 40:pv(n.g,0,32);break;case 41:n.h=2,n.g=n.i,n.g.h=0,n.l=e;break;case 42:fv(n.o),xv(n);break;case 43:xv(n);break;case 44:t=n.i,i=null,4!==n.h&&(i=hv(t,n.l,e)),mv(t,0,15);break;case 45:t=n.g,3!==n.h?i=null:(i=hv(t,n.l,e),r=t.g-t.h+1,gv(t,r-1,r,t.h),mv(t,0,r-1),mv(t,t.g,15-t.g),n.l=e);break;case 46:mv(n.j,0,15);break;case 47:t=null,4!==n.h&&(t=hv(n.i,n.l,e)),i=n.j,n.j=n.i,n.i=i,Av(n),n.l=e,i=t}r=i;break e}(23==i||31==i)&&33<=e&&35>=e&&(n.g.A=e-32)}r=null}else e=t.Kb,pv(n.g,0,t.kb),pv(n.g,0,e);return r}function Qv(e,t){var n=[];try{for(;t.ta();){var i=Fv(t).value,r=(224&i)>>5,s=31&i;if(7===r&&0!=s&&(r=63&Fv(t).value),0!=r){e.A.add("svc"+r),e.j.has(r)||e.j.set(r,new Bv(r));for(var a=e.j.get(r),o=t.Aa();t.Aa()-o<s;){r=a;var u=t,l=Fv(u),c=l.value,d=l.pts;if(16===c){var f=Fv(u);c=c<<16|f.value}if(0<=c&&31>=c)var p=jv(r,u,c,d);else if(128<=c&&159>=c)p=$v(r,u,c,d);else{if(4096<=c&&4127>=c)r=u,u=255&c,8<=u&&15>=u?r.skip(1):16<=u&&23>=u?r.skip(2):24<=u&&31>=u&&r.skip(3);else if(4224<=c&&4255>=c)r=u,u=255&c,128<=u&&135>=u?r.skip(4):136<=u&&143>=u&&r.skip(5);else if(32<=c&&127>=c)u=c,r.g&&Dv(r.g,127===u?"♪":String.fromCharCode(u));else if(160<=c&&255>=c)r.g&&Dv(r.g,String.fromCharCode(c));else if(4128<=c&&4223>=c){if(u=255&c,r.g)if(Wv.has(u)){var g=Wv.get(u);Dv(r.g,g)}else Dv(r.g,"_")}else 4256<=c&&4351>=c&&r.g&&Dv(r.g,160!=(255&c)?"_":"[CC]");p=[]}n.push.apply(n,h(p))}}}}catch(m){if(!(m instanceof je&&3e3===m.code))throw m;ee("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.")}return n}function Jv(e){for(var t=0;e;)t^=1&e,e>>=1;return 1===t}function Zv(e){for(var t=[],n=e,i=e=0;i<n.length;)2==e&&3==n[i]?(e=0,n=[].concat(h(n)),n.splice(i,1),n=new Uint8Array(n)):0==n[i]?e++:e=0,i++;for(e=n,i=0;i<e.length;){for(n=0;255==e[i];)n+=255,i++;n+=e[i++];for(var r=0;255==e[i];)r+=255,i++;r+=e[i++],4==n&&t.push(e.subarray(i,i+r)),i+=r}return t}function ey(){this.j=new Map,this.i=this.h=0,this.g=ny}function ty(e,t,n,i,r,s,a,o,u){var l=0,c=s,f=o.map((function(e){return e.fg}));for(f=[].concat.apply([],h(f)),f.length&&(c=f[0].sampleSize||s),t.skip(a+o[0].nf);t.ta();){a=t.S();var p=t.X(),g=null;switch(g=!1,o=1,e.g){case iy:g=31&p,g=6==g;break;case ry:o=2,t.skip(1),g=p>>1&63,g=39==g||40==g;break;case sy:o=2,t.skip(1),g=p>>1&63,g=23==g||24==g;break;default:return}if(g)for(p=0,l<f.length&&(p=f[l].ze||0),p=(n+p)/i,o=d(Zv(t.Cb(a-o))),g=o.next();!g.done;g=o.next())u.push({packet:g.value,pts:p});else try{t.skip(a-o)}catch(m){break}c-=a+4,0==c&&(n=l<f.length?n+(f[l].gg||r):n+r,l++,c=l<f.length&&f[l].sampleSize||s)}}Yv.prototype.clear=function(){this.l=0,this.h=[],this.g=[];var e=this.i;e.i=[],e.h=[],e.g=0,Xv(this),e=d(this.j.values());for(var t=e.next();!t.done;t=e.next())Hv(t.value)},Yv.prototype.extract=function(e,t){if(this.B){for(var n=d(this.m.values()),i=n.next();!i.done;i=n.next())i.value.l=t;this.B=!1}if(e=new Qs(e,0),!(8>e.getLength())&&181===e.X()&&49===e.ma()&&1195456820===e.S()&&3===e.X()&&(n=e.X(),0!==(64&n)))for(n&=31,e.skip(1),i=0;i<n;i++){var r=e.X(),s=(4&r)>>2,a=e.X(),o=e.X();s&&(r&=3,0===r||1===r?this.h.push({pts:t,type:r,kb:a,Kb:o,order:this.h.length}):(this.g.push({pts:t,type:r,value:a,order:this.g.length}),this.g.push({pts:t,type:2,value:o,order:this.g.length})))}},Yv.prototype.decode=function(){function e(e,t){return e.pts-t.pts||e.order-t.order}var t=[];this.h.sort(e),this.g.sort(e);for(var n=d(this.h),i=n.next();!i.done;i=n.next())(i=zv(this,i.value))&&t.push(i);for(n=d(this.g),i=n.next();!i.done;i=n.next())Nv(this.i,i.value);for(n=d(this.i.i),i=n.next();!i.done;i=n.next())i=Qv(this,i.value),t.push.apply(t,h(i));return this.i.i=[],this.h=[],this.g=[],t},Yv.prototype.getStreams=function(){return Array.from(this.A)},K("shaka.cea.CeaDecoder",Yv),fn=function(){return new Yv},ey.prototype.init=function(e){function t(e){e=e.name,ay.has(e)&&(n.g=ay.get(e))}var n=this,i=[],r=[];if((new ea).box("moov",ta).box("mvex",ta).R("trex",(function(e){var t=e.reader;t.skip(4),t.skip(4),e=t.S(),t=t.S(),n.h=e,n.i=t})).box("trak",ta).R("tkhd",(function(e){var t=e.reader;e=e.version,1==e?(t.skip(8),t.skip(8)):(t.skip(4),t.skip(4));var n=t.S();1==e?t.skip(8):t.skip(4),t.skip(4),t.skip(8),t.skip(2),t.skip(2),t.skip(2),t.skip(2),t.skip(36),t.ma(),t.ma(),t.ma(),t.ma(),i.push(n)})).box("mdia",ta).R("mdhd",(function(e){e=bo(e.reader,e.version),r.push(e.timescale)})).box("minf",ta).box("stbl",ta).R("stsd",na).box("avc1",t).box("avc3",t).box("dvav",t).box("dva1",t).box("hev1",t).box("hvc1",t).box("dvh1",t).box("dvhe",t).box("vvc1",t).box("vvi1",t).box("dvc1",t).box("dvi1",t).box("encv",ia).box("sinf",ta).box("frma",(function(e){e=Eo(e.reader).codec,ay.has(e)&&(n.g=ay.get(e))})).parse(e,!0),!i.length||!r.length||i.length!=r.length)throw new je(2,2,2010);this.g==ny&&Z("Unable to determine bitstream format for CEA parsing!"),i.forEach((function(e,t){n.j.set(e,r[t])}))},ey.prototype.parse=function(e){var t=this;if(this.g==ny)return[];var n=[],i=0,r=[];return(new ea).box("moof",(function(e){i=e.start,r=[],ta(e)})).box("traf",(function(e){r.push({baseMediaDecodeTime:null,jd:t.h,kd:t.i,kh:[],timescale:9e4}),ta(e)})).R("trun",(function(e){var t=r[r.length-1];e=To(e.reader,e.version,e.flags),t.kh.push(e)})).R("tfhd",(function(e){var n=r[r.length-1];e=vo(e.reader,e.flags),n.jd=e.jd||t.h,n.kd=e.kd||t.i,e=e.trackId,t.j.has(e)&&(n.timescale=t.j.get(e))})).R("tfdt",(function(e){var t=r[r.length-1];e=yo(e.reader,e.version),t.baseMediaDecodeTime=e.baseMediaDecodeTime})).box("mdat",(function(e){for(var s=i-e.start-8,a=e.reader.Aa(),o=d(r),u=o.next();!u.done;u=o.next()){if(u=u.value,null===u.baseMediaDecodeTime)throw Z("Unable to find base media decode time for CEA captions!"),new je(2,2,2010);e.reader.seek(a),ty(t,e.reader,u.baseMediaDecodeTime,u.timescale,u.jd,u.kd,s,u.kh,n)}})).parse(e,!1),n},K("shaka.cea.Mp4CeaParser",ey);var ny=0,iy=1,ry=2,sy=3,ay=(new Map).set("avc1",iy).set("avc3",iy).set("dvav",iy).set("dva1",iy).set("hev1",ry).set("hvc1",ry).set("dvh1",ry).set("dvhe",ry).set("vvc1",sy).set("vvi1",sy).set("dvc1",sy).set("dvi1",sy);function oy(){this.g=null}function uy(e){var t=0,n=Fe(e),i=n.getUint32(t,!0);if(i!=e.byteLength)return[];e:{for(e=t+6,t=[];e<n.byteLength-1;){i=n.getUint16(e,!0),e+=2;var r=n.getUint16(e,!0);if(e+=2,0!=(1&r)||r+e>n.byteLength){n=[];break e}var s=Ne(n,e,r);t.push({type:i,value:s}),e+=r}n=t}return n}function ly(e){return e=Ut(Fn(e)),e=uy(e).filter((function(e){return e.type===dy}))[0],e?(e=kt(e.value,!0),(e=Mn(e,"WRMHEADER"))?e:null):null}function cy(e){try{var t=ly(e);if(t)e:{for(var n=d(jn(t,"DATA")),i=n.next();!i.done;i=n.next()){var r=i.value;if(r.children)for(var s=d(r.children),a=s.next();!a.done;a=s.next()){var o=a.value;if("LA_URL"==o.tagName){var u=Fn(o);break e}}}u=""}else u="";return u}catch(l){return""}}cn("video/mp4",(function(){return new ey})),oy.prototype.init=function(){},oy.prototype.parse=function(e){this.g?this.g.clearData():this.g=new $u;var t=[];if(e=Ne(e),!qu(e))return t;e=this.g.parse(e);var n=e.md(),i=e.de();switch(e=[],n.video){case"avc":e.push(6);break;case"hvc":e.push(39),e.push(40)}if(!e.length)return t;for(n=d(i),i=n.next();!i.done;i=n.next())if(i=i.value,e.includes(i.type)&&null!=i.time)for(var r=d(Zv(i.data)),s=r.next();!s.done;s=r.next())t.push({packet:s.value,pts:i.time});return t},K("shaka.cea.TsCeaParser",oy),cn("video/mp2t",(function(){return new oy}));var dy=1;function hy(e,t,n){var i=my(e),r=null;e=[];var s=[],a=null,o=new Set(i.map((function(e){return e.keyId})));o.delete(null);var u="cenc";if(1<o.size)throw new je(2,4,4010);if(!t){if(s=i.filter((function(e){return"urn:mpeg:dash:sea:2012"==e.$c})),1<s.length)throw new je(2,4,4050);s.length&&(a=yy(s[0])),(s=i.find((function(e){return"urn:mpeg:dash:mp4protection:2011"==e.$c})))&&s.encryptionScheme&&(u=s.encryptionScheme),s=i.filter((function(e){return"urn:mpeg:dash:mp4protection:2011"==e.$c?(r=e.init||r,!1):"urn:mpeg:dash:sea:2012"!=e.$c})),s.length&&(e=gy(r,u,s,n,o),0==e.length&&(e=[Gt("",u,r)]))}if(i.length&&!a&&(t||!s.length))for(e=[],t=d(Object.values(n)),n=t.next();!n.done;n=t.next())n=n.value,"org.w3.clearkey"!=n&&e.push(Gt(n,u,r));if(o=Array.from(o)[0]||null)for(u=d(e),t=u.next();!t.done;t=u.next())for(t=d(t.value.initData),n=t.next();!n.done;n=t.next())n.value.keyId=o;return{Jg:o,Pk:r,drmInfos:e,cf:a,Og:!0}}function fy(e,t,n,i){var r=hy(e,n,i);if(t.Og)e=1==t.drmInfos.length&&!t.drmInfos[0].keySystem,n=0==r.drmInfos.length,(0==t.drmInfos.length||e&&!n)&&(t.drmInfos=r.drmInfos),t.Og=!1;else if(0<r.drmInfos.length&&(t.drmInfos=t.drmInfos.filter((function(e){return r.drmInfos.some((function(t){return t.keySystem==e.keySystem}))})),0==t.drmInfos.length))throw new je(2,4,4008);return r.Jg||t.Jg}function py(e){var t=Gn(e.node,"https://dashif.org/CPS","Laurl");if(t&&(t=Fn(t)))return t;if((t=Gn(e.node,"urn:microsoft:playready","pro"))&&Fn(t))return cy(t);if((e=Gn(e.node,"urn:mpeg:cenc:2013","pssh"))&&(e=Fn(e))){t=Ut(e),e=8,t=Fe(t);var n=t.getUint8(e);return e+=20,0<n&&(e+=4+16*t.getUint32(e)),e=Ne(t,e+4),e=Ot(e),e=Mn("<pro>"+e+"</pro>"),cy(e)}return""}function gy(e,t,n,i,r){var s=[];n=d(n);for(var a=n.next();!a.done;a=n.next()){a=a.value;var o=i[a.$c];if(o){var u;if((u=Gn(a.node,"urn:microsoft:playready","pro"))&&Fn(u)){u=Fn(u),u=Ut(u);var l=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);u=[{initData:ha(u,l,new Set,0),initDataType:"cenc",keyId:a.keyId}]}else u=null;if(l=null,"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e"===a.$c){l=a;var c=r;if(0==c.size)l=null;else{var h=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]),f=new Uint8Array([]);l=[{initData:ha(f,h,c,1),initDataType:"cenc",keyId:l.keyId}]}}u=Gt(o,t,a.init||e||u||l),(o=by.get(o))&&(u.licenseServerUri=o(a)),s.push(u)}}return s}function my(e){var t=[];e=d(e);for(var n=e.next();!n.done;n=e.next())(n=vy(n.value))&&t.push(n);return t}function vy(e){var t=e.attributes.schemeIdUri,n=Hn(e,"urn:mpeg:cenc:2013","default_KID"),i=Kn(e,"urn:mpeg:cenc:2013","pssh").map(Bn),r=e.attributes.value;if(!t)return null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase(),n.includes(" ")))throw new je(2,4,4009);var s=[];try{s=i.map((function(e){return{initDataType:"cenc",initData:Ut(e),keyId:null}}))}catch(a){throw new je(2,4,4007)}return{node:e,$c:t,keyId:n,init:0<s.length?s:null,encryptionScheme:r}}function yy(t){if(!e.crypto||!e.crypto.subtle)throw Z("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new je(2,4,4042);var n=Gn(t.node,"urn:mpeg:dash:schema:sea:2012","SegmentEncryption");if(!n)throw new je(2,4,4051);if("urn:mpeg:dash:sea:aes128-cbc:2013"!=n.attributes.schemeIdUri)throw new je(2,4,4051);if(n=Gn(t.node,"urn:mpeg:dash:schema:sea:2012","CryptoPeriod"),!n)throw new je(2,4,4051);if(t=n.attributes.IV,n=Mt(n.attributes.keyUriTemplate),!t||!n)throw new je(2,4,4051);if(t=Ft(t.substr(2)),16!=t.byteLength)throw new je(2,4,4048);return{Xi:n,iv:t}}var by=(new Map).set("com.apple.fps",(function(t){if("apple"===e.shakaMediaKeysPolyfill)throw new je(2,4,4054);return(t=Gn(t.node,"https://dashif.org/CPS","Laurl"))&&(t=Fn(t))?t:""})).set("com.widevine.alpha",(function(e){var t=Gn(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=Fn(t))?t:(e=Gn(e.node,"urn:microsoft","laurl"))&&Mt(e.attributes.licenseUrl)||""})).set("com.microsoft.playready",py).set("com.microsoft.playready.recommendation",py).set("com.microsoft.playready.software",py).set("com.microsoft.playready.hardware",py).set("org.w3.clearkey",(function(e){var t=Gn(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=Fn(t))?t:(e=Gn(e.node,"http://dashif.org/guidelines/clearKey","Laurl"))&&"EME-1.0"===e.attributes.Lic_type&&e&&(e=Fn(e))?e:""}));function Ty(t,n,i,r,s,a){var o=(new Map).set("RepresentationID",n).set("Number",i).set("SubNumber",r).set("Bandwidth",s).set("Time",a);return t.replace(/\$(RepresentationID|Number|SubNumber|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,(function(t,n,i,r){if("$$"==t)return"$";var s=o.get(n);if(null==s)return t;switch("RepresentationID"==n&&i&&(i=void 0),"Time"==n&&"bigint"!=typeof s&&(.2<=Math.abs(s-Math.round(s))&&Z("Calculated $Time$ values must be close to integers"),s=Math.round(s)),r){case void 0:case"d":case"i":case"u":t=s.toString();break;case"o":t=s.toString(8);break;case"x":t=s.toString(16);break;case"X":t=s.toString(16).toUpperCase();break;default:t=s.toString()}return i=e.parseInt(i,10)||1,Array(Math.max(0,i-t.length)+1).join("0")+t}))}function Sy(e,t){var n=wy(e,t,"timescale"),i=1;n&&(i=Qn(n)||1),n=wy(e,t,"duration");var r=(n=Qn(n||""))?n/i:null,s=wy(e,t,"startNumber"),a=Number(wy(e,t,"presentationTimeOffset"))||0,o=Jn(s||"");if(null!=s&&null!=o||(o=1),s=null,t=Ay(e,t,"SegmentTimeline")){t=Un(t,"S"),s=i,e=e.ha.duration||1/0;for(var u=o,l=[],c=-a,d=0;d<t.length;++d){var h=t[d],f=t[d+1],p=Vn(h,"t",Jn),g=Vn(h,"d",Jn),m=Vn(h,"r",zn);if(h=Vn(h,"k",zn)||0,null!=p&&(p-=a),g){if(p=null!=p?p:c,m=m||0,0>m)if(f){if(f=Vn(f,"t",Jn),null==f)break;if(p>=f)break;m=Math.ceil((f-p)/g)-1}else{if(1/0==e)break;if(p/s>=e)break;m=Math.ceil((e*s-p)/g)-1}for(0<l.length&&p!=c&&(l[l.length-1].end=p/s),f=0;f<=m;++f)c=p+g,l.push({start:p/s,end:c/s,xg:p,Hb:h,wj:l.length+u}),p=c}}s=l}return{timescale:i,Ie:n,Ua:r,Kd:o,hc:a/i||0,wg:a,timeline:s}}function Ey(e,t){return[t(e.J),t(e.ga),t(e.pa)].filter(vr)}function wy(e,t,n){t=Ey(e,t),e=null,t=d(t);for(var i=t.next();!i.done&&!(e=i.value.attributes[n]);i=t.next());return e}function Ay(e,t,n){t=Ey(e,t),e=null,t=d(t);for(var i=t.next();!i.done&&!(e=$n(i.value,n));i=t.next());return e}function xy(e,t,n,i,r,s){for(var a=Hn(e,"http://www.w3.org/1999/xlink","href"),o=Hn(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",u=d(Object.keys(e.attributes)),l=u.next();!l.done;l=u.next()){l=l.value;var c=l.split(":"),h=Pn("http://www.w3.org/1999/xlink");c[0]==h&&delete e.attributes[l]}if(5<=s)return Ts(new je(2,4,4028));if("onLoad"!=o)return Ts(new je(2,4,4027));var f=$t([i],[a]);return r.request(0,Os(f,t)).Ga((function(i){if(i=Dn(i.data,e.tagName),!i)return Ts(new je(2,4,4001,a));for(e.children=[];i.children.length;){var o=i.children.shift();e.children.push(o)}o=d(Object.keys(i.attributes));for(var u=o.next();!u.done;u=o.next())u=u.value,e.attributes[u]=i.attributes[u];return Iy(e,t,n,f[0],r,s+1)}))}function Iy(e,t,n,i,r,s){if(s=void 0===s?0:s,Hn(e,"http://www.w3.org/1999/xlink","href")){var a=xy(e,t,n,i,r,s);return n&&(a=a.Ga(void 0,(function(){return Iy(e,t,n,i,r,s)}))),a}a=[];for(var o=d(Nn(e)),u=o.next(),l={};!u.done;l={fd:void 0},u=o.next())l.fd=u.value,"urn:mpeg:dash:resolve-to-zero:2013"==Hn(l.fd,"http://www.w3.org/1999/xlink","href")?e.children=e.children.filter(function(e){return function(t){return t!==e.fd}}(l)):"SegmentTimeline"!=l.fd.tagName&&a.push(Iy(l.fd,t,n,i,r,s));return As(a).Ga((function(){return e}))}function ky(e,t,n,i,r,s,a){var o,u=(new ea).R("sidx",(function(e){o=Ly(t,i,r,s,a,n,e)}));if(e&&u.parse(e),o)return o;throw new je(2,3,3004)}function Ly(e,t,n,i,r,s,a){var o=[];a.reader.skip(4);var u=a.reader.S();if(0==u)throw new je(2,3,3005);if(0==a.version)var l=a.reader.S(),c=a.reader.S();else l=a.reader.Zc(),c=a.reader.Zc();a.reader.skip(2);var d=a.reader.ma();for(e=e+a.size+c,c=0;c<d;c++){var h=a.reader.S(),f=(2147483648&h)>>>31;h&=2147483647;var p=a.reader.S();if(a.reader.skip(4),1==f)throw new je(2,3,3006);o.push(new uu(l/u+n,(l+p)/u+n,(function(){return s}),e,e+h-1,t,n,i,r)),l+=p,e+=h}return a.parser.stop(),o}function Ry(e){this.h=Fe(e),this.g=new Qs(this.h,0)}function Cy(e){var t=Dy(e);if(7<t.length)throw new je(2,3,3002);var n=0;t=d(t);for(var i=t.next();!i.done;i=t.next())n=256*n+i.value;t=Dy(e);e:{i=d(My);for(var r=i.next();!r.done;r=i.next())if(_e(t,new Uint8Array(r.value))){i=!0;break e}i=!1}if(i)t=e.h.byteLength-e.g.Aa();else{if(8==t.length&&224&t[1])throw new je(2,3,3001);for(r=i=0;r<t.length;r++){var s=t[r];i=0==r?s&(1<<8-t.length)-1:256*i+s}t=i}return t=e.g.Aa()+t<=e.h.byteLength?t:e.h.byteLength-e.g.Aa(),i=Fe(e.h,e.g.Aa(),t),e.g.skip(t),new Py(n,i)}function Dy(e){var t=e.g.Aa(),n=e.g.X();if(0==n)throw new je(2,3,3002);return n=8-Math.floor(Math.log2(n)),e.g.skip(n-1),Ne(e.h,t,n)}Ry.prototype.ta=function(){return this.g.ta()};var My=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function Py(e,t){this.id=e,this.g=t}function _y(e){if(8<e.g.byteLength)throw new je(2,3,3002);if(8==e.g.byteLength&&224&e.g.getUint8(0))throw new je(2,3,3001);for(var t=0,n=0;n<e.g.byteLength;n++){var i=e.g.getUint8(n);t=256*t+i}return t}function Oy(e,t,n,i,r,s,a,o,u){function l(){return r}var c=[];e=new Ry(e.g);for(var d=null,h=null;e.ta();){var f=Cy(e);if(187==f.id){var p=Ny(f);p&&(f=n*p.Jj,p=t+p.nj,null!=d&&c.push(new uu(d+a,f+a,l,h,p-1,s,a,o,u)),d=f,h=p)}}return null!=d&&c.push(new uu(d+a,i+a,l,h,null,s,a,o,u)),c}function Ny(e){var t=new Ry(e.g);if(e=Cy(t),179!=e.id)throw new je(2,3,3013);if(e=_y(e),t=Cy(t),183!=t.id)throw new je(2,3,3012);t=new Ry(t.g);for(var n=0;t.ta();){var i=Cy(t);if(241==i.id){n=_y(i);break}}return{Jj:e,nj:n}}function Uy(e,t,n){if(t=Ay(e,t,"Initialization"),!t)return null;var i=e.J.Ra(),r=t.attributes.sourceURL;r&&(i=$t(i,[Mt(r)],e.sb())),r=0;var s=null;return(t=Vn(t,"range",Xn))&&(r=t.start,s=t.end),n=new au((function(){return i}),r,s,Hy(e),null,null,n,e.ga.encrypted),n.codecs=e.J.codecs,n.mimeType=e.J.mimeType,e.ha&&(n.g=e.ha.start+e.ha.duration),n}function Fy(e,t,n){var i=Number(wy(e,jy,"presentationTimeOffset"))||0,r=wy(e,jy,"timescale"),s=1;r&&(s=Qn(r)||1);var a=i/s||0,o=Uy(e,jy,n);Gy(e,o);var u=Rn(e);return{rc:function(){var e=Ay(u,jy,"RepresentationIndex"),n=u.J.Ra();return e&&(e=Mt(e.attributes.sourceURL))&&(n=$t(n,[e],u.sb())),e=$y(u),By(u,t,o,n,e.start,e.end,a)}}}function By(e,t,n,i,r,s,a){var o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,A,x,I;return U((function(k){if(1==k.g)return o=e.presentationTimeline,u=!e.Mb||!e.ha.Zg,l=e.ha.start,c=e.ha.duration,h=e.J.mimeType.split("/")[1],f=t,p=null,g=[f(i,r,s,!1),"webm"==h?f(n.N(),n.startByte,n.endByte,!0):null],f=null,w(k,Promise.all(g),2);if(m=k.h,v=m[0],y=m[1]||null,b=null,T=l-a,S=l,E=c?l+c:1/0,"mp4"==h)var L=ky(v,r,i,n,T,S,E);else{L=v;var R=new Ry(y);if(440786851!=Cy(R).id)throw new je(2,3,3008);var C=Cy(R);if(408125543!=C.id)throw new je(2,3,3009);R=C.g.byteOffset,C=new Ry(C.g);for(var D=null;C.ta();){var M=Cy(C);if(357149030==M.id){D=M;break}}if(!D)throw new je(2,3,3010);for(D=new Ry(D.g),M=1e6,C=null;D.ta();){var P=Cy(D);if(2807729==P.id)M=_y(P);else if(17545==P.id)if(4==P.g.byteLength)C=P.g.getFloat32(0);else{if(8!=P.g.byteLength)throw new je(2,3,3003);C=P.g.getFloat64(0)}}if(null==C)throw new je(2,3,3011);if(D=M/1e9,C*=D,L=Cy(new Ry(L)),475249515!=L.id)throw new je(2,3,3007);L=Oy(L,R,D,C,i,n,T,S,E)}for(b=L,A=d(b),x=A.next();!x.done;x=A.next())I=x.value,I.codecs=e.J.codecs,I.mimeType=e.J.mimeType,I.bandwidth=e.bandwidth;return o.Cd(b),p=new rc(b),u&&p.Mc(S,E,!0),k.return(p)}))}function jy(e){return e.bd}function $y(e){var t=Ay(e,jy,"RepresentationIndex");return e=wy(e,jy,"indexRange"),e=Xn(e||""),t&&(e=Vn(t,"range",Xn,e)),e}function Gy(e,t){if(Vy(e,t),!$y(e))throw new je(2,4,4002)}function Vy(e,t){var n=e.J.mimeType.split("/")[1];if(e.J.contentType!=qt&&"mp4"!=n&&"webm"!=n)throw new je(2,4,4006);if("webm"==n&&!t)throw new je(2,4,4005)}function Hy(e){var t=e.J;return{bandwidth:e.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate||null,height:t.height||null,mimeType:t.mimeType,channelsCount:t.qe,pixelAspectRatio:t.pixelAspectRatio||null,width:t.width||null,label:e.ga.label||null,roles:e.roles||null,language:e.ga.language||null}}function Ky(e,t,n){var i=Uy(e,Wy,n),r=qy(e);if(!r.Ua&&!r.timeline&&1<r.Vc.length)throw new je(2,4,4002);if(!r.Ua&&!e.ha.duration&&!r.timeline&&1==r.Vc.length)throw new je(2,4,4002);if(r.timeline&&0==r.timeline.length)throw new je(2,4,4002);var s=null,a=null;e.pa.id&&e.J.id&&(a=t.get(e.pa.id+","+e.J.id))&&(s=a.segmentIndex);var o=Yy(e.ha.start,e.ha.duration,e.J.Ra,r,i,n,e.J.mimeType,e.J.codecs,e.bandwidth,e.sb);return t=!s,s?s.yd(o,e.presentationTimeline.nb()):s=new rc(o),e.presentationTimeline.Cd(o),e.Mb&&e.ha.Zg||s.Mc(e.ha.start,e.ha.duration?e.ha.start+e.ha.duration:1/0,t),a&&(a.segmentIndex=s),{rc:function(){return s&&0!=s.getNumReferences()||s.me(o),Promise.resolve(s)}}}function Wy(e){return e.Xb}function qy(e){var t=Xy(e);e=Sy(e,Wy);var n=e.Kd;0==n&&(n=1);var i=0;return e.Ua?i=e.Ua*(n-1):e.timeline&&0<e.timeline.length&&(i=e.timeline[0].start),{Ua:e.Ua,startTime:i,Kd:n,hc:e.hc,timeline:e.timeline,Vc:t}}function Yy(e,t,n,i,r,s,a,o,u,l){var c=i.Vc.length;i.timeline&&i.timeline.length!=i.Vc.length&&(c=Math.min(i.timeline.length,i.Vc.length));for(var d=e-i.hc,h=t?e+t:1/0,f=[],p=i.startTime,g={},m=0;m<c;g={Ke:void 0,Ae:void 0},m++){g.Ae=i.Vc[m];var v=p;p=void 0,p=null!=i.Ua?v+i.Ua:i.timeline?i.timeline[m].end:v+t,g.Ke=null,g=new uu(e+v,e+p,function(e){return function(){return null==e.Ke&&(e.Ke=$t(n(),[e.Ae.cj],l())),e.Ke}}(g),g.Ae.start,g.Ae.end,r,d,e,h,[],"",null,null,cu,s),g.codecs=o,g.mimeType=a,g.bandwidth=u,f.push(g)}return f}function Xy(e){return[e.J.Xb,e.ga.Xb,e.pa.Xb].filter(vr).map((function(e){return Un(e,"SegmentURL")})).reduce((function(e,t){return 0<e.length?e:t})).map((function(t){t.attributes.indexRange&&!e.Lf&&(e.Lf=!0);var n=Mt(t.attributes.media);return t=Vn(t,"mediaRange",Xn,{start:0,end:null}),{cj:n,start:t.start,end:t.end}}))}function zy(e,t,n,i,r,s,a,o,u){u||e.J.fe||(e.J.fe=wy(e,Qy,"initialization"));var l=e.J.fe?tb(e,a):null,c=Jy(e);Zy(c);var d=Rn(e);if(c.td)return Vy(e,l),{rc:function(){var e=Ty(c.td,d.J.originalId,null,null,d.bandwidth||null,null);return e=$t(d.J.Ra(),[e]),By(d,t,l,e,0,null,c.hc)}};if(c.Ua)return i||"image"===e.ga.contentType||"text"===e.ga.contentType||(n=e.ha.start,i=e.pa.id,u=e.ha.duration,i=(i=null!=i&&s.get(i)||u)?n+i:1/0,e.presentationTimeline.Tf(c.Ua),e.presentationTimeline.ih(n,i)),{rc:function(){return eb(d,c,r,l,s,a,o,e.J.Be)}};var h=null;i=i=null,e.pa.id&&e.J.id&&(i=e.pa.id+","+e.J.id,i=n.get(i))&&(h=i.segmentIndex);var f=e.ha.start,p=e.ha.duration?f+e.ha.duration:1/0;return h?(n=h,ib(n,c,f,p,l),n.Na(e.presentationTimeline.nb())):h=new nb(c,e.J.originalId,e.bandwidth,e.J.Ra,e.sb,f,p,l,a,e.J.Be),c.timeline&&"image"!==e.ga.contentType&&"text"!==e.ga.contentType&&e.presentationTimeline.jh(h.h?h.h.timeline:[],f),i&&e.Mb&&(i.segmentIndex=h),{rc:function(){return h instanceof nb&&0==h.getNumReferences()&&ib(h,c,f,p,l),Promise.resolve(h)}}}function Qy(e){return e.ic}function Jy(e){var t=Sy(e,Qy),n=wy(e,Qy,"media"),i=wy(e,Qy,"index"),r=wy(e,Qy,"k"),s=0;return r&&(s=parseInt(r,10)),{Ie:t.Ie,Ua:t.Ua,timescale:t.timescale,Kd:t.Kd,hc:t.hc,wg:t.wg,timeline:t.timeline,ec:n&&Mt(n),td:i,mimeType:e.J.mimeType,codecs:e.J.codecs,bandwidth:e.bandwidth,dj:s}}function Zy(e){var t=e.td?1:0;if(t+=e.timeline?1:0,t+=e.Ua?1:0,0==t)throw new je(2,4,4002);if(1!=t&&(e.td&&(e.timeline=null),e.Ie=null,e.Ua=null),!e.td&&!e.ec)throw new je(2,4,4002)}function eb(t,n,i,r,s,a,o,u){function l(i){var s=i-y,o=s*v,l=n.Ie,c=s*l;"BigInt"in e&&c>Number.MAX_SAFE_INTEGER&&(c=BigInt(s)*BigInt(l)),o+=p,s=o+v,l=Math.min(s,h());var d=[],f=n.dj;if(f)for(var g=(l-o)/f,m={},x=0;x<f;m={Dh:void 0},x++){var I=o+g*x,k=I+g;m.Dh=x+1,m=new uu(I,k,function(e){return function(){var t=Ty(b,S,i,e.Dh,T,c);return $t(E(),[t],w())}}(m),0,null,r,A,p,h(),[],"",null,null,cu,a),m.codecs=t.J.codecs,m.mimeType=t.J.mimeType,0==u?0<x&&m.Tc():0!=x%u&&m.Tc(),d.push(m)}return o=new uu(o,l,(function(){if(f)return[];var e=Ty(b,S,i,null,T,c);return $t(E(),[e],w())}),0,null,r,A,p,h(),d,"",null,null,cu,a,0<d.length),o.codecs=t.J.codecs,o.mimeType=t.J.mimeType,o.bandwidth=t.bandwidth,o.j=s,o}function c(){var e=[Math.max(f.nb(),p),Math.min(f.bc(),h())].map((function(e){return e-p}));return e=[Math.ceil(e[0]/v),Math.ceil(e[1]/v)-1],t.J.ab&&e[1]++,e.map((function(e){return e+y}))}function h(){var e=null!=g&&s.get(g)||m;return e?p+e:1/0}var f=t.presentationTimeline,p=t.ha.start,g=t.pa.id,m=t.ha.duration,v=n.Ua,y=n.Kd,b=n.ec,T=t.bandwidth||null,S=t.J.id,E=t.J.Ra,w=t.sb,A=p-n.hc,x=c();i=t.Mb?Math.max(x[0],x[1]-i+1):x[0],o=o||x[1],x=[];for(var I=i;I<=o;++I){var k=l(I);x.push(k)}var L=new rc(x);if(x=f.bc()<h(),I=f.U(),x||I){var R=Math.max(i,o+1);i=v,t.J.ab&&(i=.1),L.Je(i,(function(){var e=f.nb();L.Na(e);var t=d(c());t.next(),t=t.next().value;for(var n=[];R<=t;){var i=l(R);n.push(i),R++}return e>h()&&!n.length?null:n}))}return Promise.resolve(L)}function tb(e,t){var n=e.J.fe;if(n||(n=wy(e,Qy,"initialization")),!n)return null;n=Mt(n);var i=e.J.originalId,r=e.bandwidth||null,s=e.J.Ra,a=e.sb;return t=new au((function(){var e=Ty(n,i,null,null,r,null);return $t(s(),[e],a())}),0,null,Hy(e),null,null,t,e.ga.encrypted),t.codecs=e.J.codecs,t.mimeType=e.J.mimeType,e.ha&&(t.g=e.ha.start+e.ha.duration),t}function nb(e,t,n,i,r,s,a,o,u,l){rc.call(this,[]),this.h=e,this.F=t,this.B=n,this.C=i,this.H=r,this.j=s,this.l=a,this.u=o,this.A=u,this.G=l,sb(this)}function ib(e,t,n,i,r){if(rb(e,r),e.h){if(n=e.h.timeline,e.h.ec!==t.ec&&(e.h.ec=t.ec),n.length){var s=n[n.length-1];t=t.timeline.filter((function(e){return e.end>s.end}))}else t=t.timeline.slice();0<t.length&&e.h.timeline.push.apply(e.h.timeline,h(t)),e.l!==i&&(e.l=i)}else e.h=t,e.j=n,e.l=i;sb(e)}function rb(e,t){if(e.u!==t){e.u=t,e=d(e.g);for(var n=e.next();!n.done;n=e.next())(n=n.value)&&lu(n,t)}}function sb(e){if(e.h&&!e.o){for(var t=[],n=d(e.h.timeline),i=n.next();!i.done;i=n.next())i=i.value,i.start>=e.l||0>=i.end||t.push(i);e.h.timeline=t,e.Na(e.j)}}function ab(e,t,n,i,r,s,a,o){return e=Ty(e,t,n,s,i||null,r),$t(a(),[e],o()).map((function(e){return e.toString()}))}function ob(e){this.o=null,this.A=e,this.G=new Cs,this.i=[],this.h=null,this.m=[],this.B=null,this.F=[],this.C=300,this.l=new Map,this.j=new Map,this.g=null,this.u="UNKNOWN"}function ub(e,t){var n,i,r,s,a,o,u;return U((function(l){return 1==l.g?(n=$t(e.i,[lb(e,t)]),i=Os(n,e.o.retryParameters),r=e.A.networkingEngine.request(8,i),Ds(e.G,r),x(l,2),w(l,r.promise,4)):2!=l.g?(s=l.h,a=It(s.data),o=JSON.parse(a),1==o.VERSION&&cb(e,o,s.uri),k(l,0)):(u=L(l))&&7001==u.code?l.return():(null!=e.g&&(e.g.stop(),e.g=null),e.g=new ze((function(){ub(e,t)})),e.g.da(e.C),void A(l))}))}function lb(e,t){if(!e.m.length)return t;t=new ve(t);var n=e.B||e.m[0],i=Math.round(e.A.getBandwidthEstimate()),r=t.g;return"DASH"==e.u?(r.add("_DASH_pathway",n),r.add("_DASH_throughput",String(i))):"HLS"==e.u&&(r.add("_HLS_pathway",n),r.add("_HLS_throughput",String(i))),Me(r)&&Se(t,r),t.toString()}function cb(e,t,n){null!=e.g&&(e.g.stop(),e.g=null);var i=t["RELOAD-URI"]||n;e.g=new ze((function(){ub(e,i)})),(n=t.TTL)&&(e.C=n),e.g.da(e.C),e.m=t["PATHWAY-PRIORITY"]||[],e.F=t["PATHWAY-CLONES"]||[]}function db(e,t,n,i){var r=e.l.get(t);r||(r=new Map),r.set(n,i),e.l.set(t,r)}function hb(e,t,n){n=void 0!==n&&n,t=e.l.get(t)||new Map;for(var i=[],r=d(e.m),s=r.next(),a={};!s.done;a={Xc:void 0},s=r.next())if(a.Xc=s.value,s=t.get(a.Xc))i.push({Yf:a.Xc,location:s});else if(s=e.F.find(function(e){return function(t){return t.ek==e.Xc}}(a))){var o=t.get(s["BASE-ID"]);o&&(s["URI-REPLACEMENT"].Nh?(o=new ve(o),be(o,s["URI-REPLACEMENT"].Nh),i.push({Yf:a.Xc,location:o.toString()})):i.push({Yf:a.Xc,location:o}))}for(r=Date.now(),a=d(e.j.keys()),s=a.next();!s.done;s=a.next())s=s.value,o=e.j.get(s),r>o&&e.j.delete(s);if(i=i.filter((function(t){for(var n=d(e.j.keys()),i=n.next();!i.done;i=n.next())if(i.value.includes(new ve(t.location).lb))return!1;return!0})),i.length&&(e.B=i[0].Yf),i=i.map((function(e){return e.location})),!i.length&&e.h)for(r=d(e.h.split(",")),a=r.next();!a.done;a=r.next())(a=t.get(a.value))&&(e.B=e.h,i.push(a));if(!i.length)for(t=d(t.values()),r=t.next();!r.done;r=t.next())i.push(r.value);return n?i:$t(e.i,i)}function fb(){this.l=[],this.h=[],this.g=[],this.j=[],this.i=[],this.u=this.o=!1,this.m=new Set}function pb(e,t){var n=[],i=[],r=[],s=[];e=d(e);for(var a=e.next();!a.done;a=e.next()){var o=a.value;a=new Map(o.audioStreams.map((function(e){return[$b(e),e]})));var u=new Map(o.videoStreams.map((function(e){return[jb(e),e]}))),l=new Map(o.textStreams.map((function(e){return[Gb(e),e]})));if(o=new Map(o.imageStreams.map((function(e){return[Vb(e),e]}))),t){var c=Nb(qt);l.set(Gb(c),c),c=Nb("image"),o.set(Vb(c),c)}n.push(a),i.push(u),r.push(l),s.push(o)}return{Dg:n,Lh:i,Hh:r,Xg:s}}function gb(e){var t,n,i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,A,x,I,k,L,R,C,D,M;return U((function(P){switch(P.g){case 1:if(t=Yt,1==e.length)return P.return(e[0]);for(n=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.V})).map((function(e){return[$b(e),e]})))})),i=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.la})).map((function(e){return[jb(e),e]})))})),r=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.va})).map((function(e){return[Gb(e),e]})))})),s=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.$e})).map((function(e){return[Vb(e),e]})))})),a=d(r),o=a.next();!o.done;o=a.next())u=o.value,l=Ob(t.va),u.set(Gb(l),l);for(c=d(s),h=c.next();!h.done;h=c.next())f=h.value,p=Ob(t.$e),f.set(Vb(p),p);return g=new fb,w(P,mb(g,[],n,0,Eb,Ab,0),2);case 2:return m=P.h,w(P,mb(g,[],i,0,Eb,Ab,0),3);case 3:return v=P.h,w(P,mb(g,[],r,0,Eb,Ab,0),4);case 4:return y=P.h,w(P,mb(g,[],s,0,Eb,Ab,0),5);case 5:if(b=P.h,T=0,v.length&&m.length)for(I=d(m),k=I.next();!k.done;k=I.next())for(L=k.value,R=d(v),C=R.next();!C.done;C=R.next())D=C.value,M=T++,D.variantIds.push(M),L.variantIds.push(M);else for(S=v.concat(m),E=d(S),A=E.next();!A.done;A=E.next())x=A.value,x.variantIds=[T++];return P.return(v.concat(m).concat(y).concat(b))}}))}function mb(e,t,n,i,r,s,a){var o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,A,x,I,k;return U((function(L){switch(L.g){case 1:for(o=[],u=0;u<n.length;u++)u>=i?o.push(new Set(n[u].values())):o.push(new Set);l=d(t),c=l.next();case 2:if(c.done){L.s(4);break}return h=c.value,w(L,vb(e,h,n,i,s,o,a),5);case 5:if(f=L.h,!f)throw new je(2,4,4037);c=l.next(),L.s(2);break;case 4:for(p=d(o),g=p.next();!g.done;g=p.next())for(m=g.value,v=d(m),y=v.next();!y.done;y=v.next())b=y.value,(T=bb(e,b,n,r,s,o))&&t.push(T);for(S=d(o),E=S.next();!E.done;E=S.next())for(A=E.value,x=d(A),I=x.next(),k={};!I.done;k={ng:void 0},I=x.next())if(k.ng=I.value,!Bb(k.ng)&&t.some(function(t){return function(n){return Lb(e,t.ng,n)}}(k)))throw new je(2,4,4037);return L.return(t)}}))}function vb(e,t,n,i,r,s,a){return U((function(o){return 1==o.g?(xb(e,n,t,0<a),t.matchedStreams?t.segmentIndex?w(o,yb(t,i+a),2):o.s(2):o.return(!1)):(Tb(t,i,r,s,a),o.return(!0))}))}function yb(e,t){var n,i,r,s,a,o;return U((function(u){if(1==u.g){for(n=[],i=e.matchedStreams,r=t;r<i.length;r++)s=i[r],n.push(s.createSegmentIndex()),s.trickModeVideo&&!s.trickModeVideo.segmentIndex&&n.push(s.trickModeVideo.createSegmentIndex()),s.dependencyStream&&!s.dependencyStream.segmentIndex&&n.push(s.dependencyStream.createSegmentIndex());return w(u,Promise.all(n),2)}if(e.segmentIndex instanceof uc)for(a=t;a<i.length;a++)o=i[a],o.segmentIndex&&e.segmentIndex.h.push(o.segmentIndex);A(u)}))}function bb(e,t,n,i,r,s){if(Bb(t))return null;var a=i(t);return xb(e,n,a),a.createSegmentIndex&&(a.createSegmentIndex=function(){return U((function(e){return a.segmentIndex?e.s(0):(a.segmentIndex=new uc,w(e,yb(a,0),0))}))}),a.matchedStreams&&a.matchedStreams.length?(Tb(a,0,r,s,0),a):null}function Tb(e,t,n,i,r){var s=e.matchedStreams;for(t+=r;t<s.length;t++){var a=s[t];n(e,a);var o=!0;if("audio"==e.type&&0==Ar(e.language,a.language)&&(o=!1),o&&(i[t-r].delete(a),a.fullMimeTypes))for(a=d(a.fullMimeTypes.values()),o=a.next();!o.done;o=a.next())e.fullMimeTypes.add(o.value)}}function Sb(e){var t=Object.assign({},e);return t.originalId=null,t.createSegmentIndex=function(){return Promise.resolve()},t.closeSegmentIndex=function(){if(t.segmentIndex&&(t.segmentIndex.release(),t.segmentIndex=null),t.matchedStreams)for(var e=d(t.matchedStreams),n=e.next();!n.done;n=e.next())n=n.value,n.segmentIndex&&(n.segmentIndex.release(),n.segmentIndex=null)},t.roles=t.roles.slice(),t.segmentIndex=null,t.emsgSchemeIdUris=[],t.keyIds=new Set(e.keyIds),t.closedCaptions=e.closedCaptions?new Map(e.closedCaptions):null,t.trickModeVideo=null,t.dependencyStream=null,t}function Eb(e){var t=Object.assign({},e);return t.roles=t.roles.slice(),t.keyIds=new Set(e.keyIds),t.segments=[],t.variantIds=[],t.closedCaptions=e.closedCaptions?new Map(e.closedCaptions):null,t}function wb(e,t){function n(e,t){e||(e=[]),t=d(t);for(var n=t.next();!n.done;n=t.next())n=n.value,e.includes(n)||e.push(n);return e}e.roles=n(e.roles,t.roles),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=n(e.emsgSchemeIdUris,t.emsgSchemeIdUris));for(var i=d(t.keyIds),r=i.next();!r.done;r=i.next())e.keyIds.add(r.value);if(null==e.originalId?e.originalId=t.originalId:(i=t.originalId||"")&&!e.originalId.endsWith(i)&&(e.originalId+=","+i),i=He(e.drmInfos,t.drmInfos),t.drmInfos.length&&e.drmInfos.length&&!i.length)throw new je(2,4,4038);if(e.drmInfos=i,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),i=d(t.closedCaptions),r=i.next();!r.done;r=i.next()){var s=d(r.value);r=s.next().value,s=s.next().value,e.closedCaptions.set(r,s)}e.bandwidth&&t.bandwidth&&(e.bandwidth=Math.max(e.bandwidth,t.bandwidth)),t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=Sb(t.trickModeVideo),e.trickModeVideo.matchedStreams=[],e.trickModeVideo.createSegmentIndex=function(){if(e.trickModeVideo.segmentIndex)return Promise.resolve();for(var t=new uc,n=d(e.trickModeVideo.matchedStreams),i=n.next();!i.done;i=n.next())t.h.push(i.value.segmentIndex);return e.trickModeVideo.segmentIndex=t,Promise.resolve()}),e.trickModeVideo.matchedStreams.push(t.trickModeVideo),wb(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&(e.trickModeVideo.matchedStreams.push(t),wb(e.trickModeVideo,t)),t.dependencyStream?(e.dependencyStream||(e.dependencyStream=Sb(t.dependencyStream),e.dependencyStream.matchedStreams=[],e.dependencyStream.createSegmentIndex=function(){if(e.dependencyStream.segmentIndex)return Promise.resolve();for(var t=new uc,n=d(e.dependencyStream.matchedStreams),i=n.next();!i.done;i=n.next())t.h.push(i.value.segmentIndex);return e.dependencyStream.segmentIndex=t,Promise.resolve()}),e.dependencyStream.matchedStreams.push(t.dependencyStream),wb(e.dependencyStream,t.dependencyStream)):e.dependencyStream&&(e.dependencyStream.matchedStreams.push(t),wb(e.dependencyStream,t))}function Ab(e,t){var n=e.roles;n||(n=[]);for(var i=d(t.roles),r=i.next();!r.done;r=i.next())r=r.value,n.includes(r)||n.push(r);for(e.roles=n,n=d(t.keyIds),i=n.next();!i.done;i=n.next())e.keyIds.add(i.value);if(e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,h(t.segments)),t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),t=d(t.closedCaptions),n=t.next();!n.done;n=t.next())i=d(n.value),n=i.next().value,i=i.next().value,e.closedCaptions.set(n,i)}function xb(e,t,n,i){i=void 0!==i&&i?n.matchedStreams:[],t=d(t);for(var r=t.next();!r.done;r=t.next()){if(r=Ib(e,r.value,n),!r)return;i.push(r)}n.matchedStreams=i}function Ib(e,t,n){var i={audio:$b,video:jb,text:Gb,image:Vb}[n.type],r=null,s=i(n);if(t.has(s))r=t.get(s);else{s={audio:function(t,n){return Lb(e,t,n)},video:function(t,n){return Lb(e,t,n)},text:Rb,image:Cb}[n.type];for(var a={audio:Db,video:Mb,text:Pb,image:_b}[n.type],o=d(t.values()),u=o.next();!u.done;u=o.next())u=u.value,!s(n,u)||n.fastSwitching!=u.fastSwitching||r&&!a(n,r,u)||(r=u)}return e.u&&!Bb(r)&&t.delete(i(r)),r}function kb(e,t){return e.mimeType==t.mimeType&&Hb(e.codecs)===Hb(t.codecs)}function Lb(e,t,n){return!(!kb(t,n)&&!e.o||t.drmInfos&&!Ve(t.drmInfos,n.drmInfos))}function Rb(e,t){return!t.language||e.forced===t.forced&&0!=Ar(e.language,t.language)&&t.kind==e.kind}function Cb(){return!0}function Db(e,t,n){var i=kb(e,t),r=kb(e,n);if(i&&!r)return!1;if(!i&&r)return!0;if(i=Ar(e.language,t.language),r=Ar(e.language,n.language),r>i)return!0;if(r<i)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(i=t.roles.filter((function(t){return e.roles.includes(t)})),r=n.roles.filter((function(t){return e.roles.includes(t)})),r.length>i.length)return!0;if(r.length<i.length)return!1;if(n.roles.length!==t.roles.length)return n.roles.length<t.roles.length}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return!(t.primary||!n.primary)||!(t.primary&&!n.primary)&&(i=Ub(e.channelsCount,t.channelsCount,n.channelsCount),i==Kb||i!=qb&&(i=Ub(e.audioSamplingRate,t.audioSamplingRate,n.audioSamplingRate),i==Kb||i!=qb&&!(!e.bandwidth||Fb(e.bandwidth,t.bandwidth,n.bandwidth)!=Kb)))}function Mb(e,t,n){var i=kb(e,t),r=kb(e,n);if(i&&!r)return!1;if(!i&&r)return!0;if(i=Ub(e.width*e.height,t.width*t.height,n.width*n.height),i==Kb)return!0;if(i==qb)return!1;if(e.frameRate){if(i=Ub(e.frameRate,t.frameRate,n.frameRate),i==Kb)return!0;if(i==qb)return!1}return!(!e.bandwidth||Fb(e.bandwidth,t.bandwidth,n.bandwidth)!=Kb)}function Pb(e,t,n){var i=Ar(e.language,t.language),r=Ar(e.language,n.language);if(r>i)return!0;if(r<i)return!1;if(!t.primary&&n.primary)return!0;if(t.primary&&!n.primary)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(i=t.roles.filter((function(t){return e.roles.includes(t)})),r=n.roles.filter((function(t){return e.roles.includes(t)})),r.length>i.length)return!0;if(r.length<i.length)return!1}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return n.mimeType==e.mimeType&&n.codecs==e.codecs&&(t.mimeType!=e.mimeType||t.codecs!=e.codecs)}function _b(e,t,n){return Ub(e.width*e.height,t.width*t.height,n.width*n.height)==Kb}function Ob(e){return{id:0,originalId:"",groupId:null,primary:!1,type:e,mimeType:"",codecs:"",language:"",originalLanguage:null,label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1,baseOriginalId:null}}function Nb(e){return{id:0,originalId:"",groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new rc([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",originalLanguage:null,label:null,type:e,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null}}function Ub(e,t,n){if(t==e&&e!=n)return qb;if(n==e&&e!=t)return Kb;if(t>e){if(n<=e||n-e<t-e)return Kb;if(n-e>t-e)return qb}else{if(n>e)return qb;if(e-n<e-t)return Kb;if(e-n>e-t)return qb}return Wb}function Fb(e,t,n){return t=Math.abs(e-t),e=Math.abs(e-n),e<t?Kb:t<e?qb:Wb}function Bb(e){switch(e.type){case qt:return!e.language;case"image":return!e.tilesLayout;default:return!1}}function jb(e){return JSON.stringify([e.fastSwitching,e.width,e.frameRate,Hb(e.codecs),e.mimeType,e.label,e.roles,e.closedCaptions?Array.from(e.closedCaptions.entries()):null,e.bandwidth,e.dependencyStream?e.dependencyStream.baseOriginalId:null,Array.from(e.keyIds)])}function $b(e){return JSON.stringify([e.fastSwitching,e.channelsCount,e.language,e.bandwidth,e.label,Hb(e.codecs),e.mimeType,e.roles,e.audioSamplingRate,e.primary,e.dependencyStream?e.dependencyStream.baseOriginalId:null,Array.from(e.keyIds)])}function Gb(e){return JSON.stringify([e.language,e.label,e.codecs,e.mimeType,e.bandwidth,e.roles])}function Vb(e){return JSON.stringify([e.width,e.codecs,e.mimeType])}function Hb(e){if(!Yb.has(e)){var t=Qi(e);Yb.set(e,t)}return Yb.get(e)}b(nb,rc),i=nb.prototype,i.getNumReferences=function(){return this.h?this.h.timeline.length:0},i.release=function(){rc.prototype.release.call(this),this.h=null},i.Na=function(e){if(this.h){for(var t=0,n=this.h.timeline,i=0;i<n.length;i+=1){if(!(n[i].end+this.j<=e))break;t+=1}0<t&&(this.h.timeline=n.slice(t),this.g.length>=t&&(this.g=this.g.slice(t)),this.i+=t,0===this.getNumReferences()&&this.release())}},i.find=function(e){if(this.h&&this.h.timeline&&this.h.timeline.length&&e<this.h.timeline[0].start+this.j)return this.i;if(!this.h)return null;var t=this.h.timeline;if(e<this.j||e>=this.l)return null;for(var n=t.length-1,i=0;i<t.length;i++){var r=t[i],s=r.start+this.j;if(r=i<n?t[i+1].start+this.j:1/0===this.l?r.end+this.j:this.l,e>=s&&e<r)return i+this.i}return null},i.get=function(e){var t=this;if(e-=this.i,0>e||e>=this.getNumReferences()||!this.h)return null;var n=this.g[e];if(!n){var i=this.h.timeline[e],r=i.wj,s=i.xg+this.h.wg;n=this.j-this.h.hc;var a=this.j+i.end,o=a;e===this.getNumReferences()-1&&1/0!==this.l&&(o=Math.min(o,this.l));for(var u=this.h.codecs,l=this.h.mimeType,c=this.h.bandwidth,d=[],h=(i.end-i.start)/i.Hb,f={},p=0;p<i.Hb;f={Le:void 0,Eh:void 0},p++){var g=i.start+h*p,m=g+h;f.Eh=p+1,f.Le=null,f=new uu(this.j+g,this.j+m,function(e){return function(){return t.h?(null==e.Le&&(e.Le=ab(t.h.ec,t.F,r,t.B,s,e.Eh,t.C,t.H)),e.Le):[]}}(f),0,null,this.u,n,this.j,this.l,[],"",null,null,cu,this.A),f.codecs=u,f.mimeType=l,f.bandwidth=c,0==this.G?0<p&&f.Tc():0!=p%this.G&&f.Tc(),d.push(f)}n=new uu(this.j+i.start,o,(function(){return 0<i.Hb||!t.h?[]:ab(t.h.ec,t.F,r,t.B,s,null,t.C,t.H)}),0,null,this.u,n,this.j,this.l,d,"",null,null,cu,this.A,0<i.Hb),n.codecs=u,n.mimeType=l,n.j=a,n.bandwidth=c,this.g[e]=n}return n},i.vb=function(e){sb(this);for(var t=0;t<this.getNumReferences();t++){var n=this.get(t+this.i);n&&e(n)}},ob.prototype.configure=function(e){this.o=e},ob.prototype.destroy=function(){return this.A=this.o=null,this.i=[],this.h=null,this.m=[],this.F=[],this.l.clear(),null!=this.g&&(this.g.stop(),this.g=null),this.G.destroy()},ob.prototype.setManifestType=function(e){this.u=e},ob.prototype.banLocation=function(e){this.j.set(e,Date.now()+6e4)},i=fb.prototype,i.release=function(){for(var e=d(this.h.concat(this.g,this.j,this.i)),t=e.next();!t.done;t=e.next())t=t.value,t.segmentIndex&&t.segmentIndex.release();this.h=[],this.g=[],this.j=[],this.i=[],this.l=[],this.u=this.o=!1,this.m.clear()},i.Ki=function(){return this.l},i.Jf=function(){return this.j.slice()},i.oi=function(){return this.i},i.Kg=function(e,t){if(e){if("audio"==e.type)for(var n=d(this.h),i=n.next();!i.done;i=n.next())i=i.value,i.matchedStreams=i.matchedStreams.filter((function(t){return t!==e}));else if("video"==e.type)for(n=d(this.g),i=n.next();!i.done;i=n.next())i=i.value,i.matchedStreams=i.matchedStreams.filter((function(t){return t!==e})),i.trickModeVideo&&(i.trickModeVideo.matchedStreams=i.trickModeVideo.matchedStreams.filter((function(t){return t!==e}))),i.dependencyStream&&(i.dependencyStream.matchedStreams=i.dependencyStream.matchedStreams.filter((function(t){return t!==e})));else if(e.type==qt)for(n=d(this.j),i=n.next();!i.done;i=n.next())i=i.value,i.matchedStreams=i.matchedStreams.filter((function(t){return t!==e}));else if("image"==e.type)for(n=d(this.i),i=n.next();!i.done;i=n.next())i=i.value,i.matchedStreams=i.matchedStreams.filter((function(t){return t!==e}));e.segmentIndex&&e.closeSegmentIndex(),this.m.delete(t)}},i.gf=function(e,t,n){n=void 0!==n&&n;var i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,x,I,k,L,R,C,D,M,P,_,O,N,F,B=this;return U((function(U){if(1==U.g){if(i=Yt,!t&&1==e.length)return r=pb(e,!1),s=r.Dg,a=r.Lh,o=r.Hh,u=r.Xg,B.h=Array.from(s[0].values()),B.g=Array.from(a[0].values()),B.j=Array.from(o[0].values()),B.i=Array.from(u[0].values()),U.s(2);for(l=n?B.m.size:0,c=-1,h=0;h<e.length;h++)f=e[h],B.m.has(f.id)||(B.m.add(f.id),-1==c&&(c=h));return-1==c?U.return():(p=pb(e,!0),g=p.Dg,m=p.Lh,v=p.Hh,y=p.Xg,w(U,Promise.all([mb(B,B.h,g,c,Sb,wb,l),mb(B,B.g,m,c,Sb,wb,l),mb(B,B.j,v,c,Sb,wb,l),mb(B,B.i,y,c,Sb,wb,l)]),2))}if(b=0,T=[],B.g.length&&B.h.length)for(R=d(B.h),C=R.next();!C.done;C=R.next())for(D=C.value,M=d(B.g),P=M.next();!P.done;P=M.next())_=P.value,O=He(D.drmInfos,_.drmInfos),D.drmInfos.length&&_.drmInfos.length&&!O.length||(N=(D.bandwidth||0)+(_.bandwidth||0),D.dependencyStream&&(N+=D.dependencyStream.bandwidth||0),_.dependencyStream&&(N+=_.dependencyStream.bandwidth||0),F=b++,T.push({id:F,language:D.language,disabledUntilTime:0,primary:D.primary,audio:D,video:_,bandwidth:N,drmInfos:O,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(S=B.g.length?B.g:B.h,E=d(S),x=E.next();!x.done;x=E.next())I=x.value,k=b++,L=I.bandwidth||0,I.dependencyStream&&(L+=I.dependencyStream.bandwidth||0),T.push({id:k,language:I.language,disabledUntilTime:0,primary:I.primary,audio:I.type==i.V?I:null,video:I.type==i.la?I:null,bandwidth:L,drmInfos:I.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});B.l=T,A(U)}))},i.th=function(e){this.o=e},i.zh=function(e){this.u=e},K("shaka.util.PeriodCombiner",fb),fb.prototype.setUseStreamOnce=fb.prototype.zh,fb.prototype.setAllowMultiTypeVariants=fb.prototype.th,fb.prototype.combinePeriods=fb.prototype.gf,fb.prototype.deleteStream=fb.prototype.Kg,fb.prototype.getImageStreams=fb.prototype.oi,fb.prototype.getTextStreams=fb.prototype.Jf,fb.prototype.getVariants=fb.prototype.Ki;var Kb=1,Wb=0,qb=-1,Yb=new Map;function Xb(e,t){var n=new DOMParser,i=Qb.value()(e);e=null;try{e=n.parseFromString(i,"text/xml")}catch(r){return null}if(n=e.documentElement,!n||n.getElementsByTagName("parsererror").length||n.tagName!=t)return null;if(!("createNodeIterator"in document))return n;for(t=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=t.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return null;return n}function zb(e,t){try{var n=Lt(e);return Xb(n,t)}catch(i){return null}}var Qb=new Ge((function(){if("undefined"!==typeof trustedTypes){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(e){return e}});return function(t){return e.createHTML(t)}}return function(e){return e}}));function Jb(){var e=this;this.j=this.g=null,this.A=[],this.i=null,this.oa=1,this.F=[],this.l={oe:"",type:"",profiles:[],Ub:null,ab:0,Ra:null,Gd:0},this.u=new Map,this.o=new Map,this.B=new Map,this.ka=new Map,this.m=new fb,this.I=0,this.na=new Y(5),this.K=new ze((function(){e.H&&!e.g.continueLoadingWhenPaused&&(e.G.Ia(e.H,"timeupdate"),e.H.paused)?e.G.qa(e.H,"timeupdate",(function(){return yT(e)})):yT(e)})),this.O=new Cs,this.M=null,this.C=[],this.$=1/0,this.fa=!1,this.h=null,this.L=0,this.P=!1,this.G=new ae,this.H=null,this.T=!1,this.Z="",this.ea=function(){return!1},this.W=[]}function Zb(e){var t,n,i,r,s,a,o,u,l,c,d;return U((function(h){return 1==h.g?(t=4,n="MPD",i=CT(e),r=e.A,i.length?(r=i,n="Patch",t=6):1<e.A.length&&e.h&&(s=hb(e.h,"Location",!0),s.length&&(r=s)),a=Os(r,e.g.retryParameters),o=Date.now(),w(h,RT(e,a,0,{type:t}),2)):3!=h.g?(u=h.h,e.j?(u.uri&&u.uri!=u.originalUri&&!e.A.includes(u.uri)&&e.A.unshift(u.uri),l=new ve(u.uri),e.Z=l.g.toString(),w(h,eT(e,u.data,u.uri,n),3)):h.return(0)):(c=Date.now(),d=(c-o)/1e3,e.na.sample(1,d),h.return(d))}))}function eT(e,t,n,i){var r,s,a,o,u,l,c,d,h,f;return U((function(p){if(1==p.g){if(r=t,s=e.g.dash.manifestPreprocessor,a=Qd,s!=a){if(he("manifest.dash.manifestPreprocessor configuration","Please Use manifest.dash.manifestPreprocessorTXml instead."),o=zb(r,i),!o)throw new je(2,4,4001,n);s(o),r=Rt(o.outerHTML)}if(u=Dn(r,i),!u)throw new je(2,4,4001,n);return l=e.g.dash.manifestPreprocessorTXml,c=Jd,l!=c&&l(u),"Patch"===i?p.return(iT(e,u)):e.g.dash.disableXlinkProcessing?p.return(tT(e,u,n)):(d=e.g.dash.xlinkFailGracefully,h=Iy(u,e.g.retryParameters,d,n,e.j.networkingEngine),Ds(e.O,h),w(p,h.promise,2))}return f=p.h,p.return(tT(e,f,n))}))}function tT(e,t,n){var i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,x,I,k,L,R,C,D,M,P,_,O,N,F,B,j,$,G,V,H,K,W,q,Y,X,z,Q,J,Z,ee,te,ne,ie,re;return U((function(U){switch(U.g){case 1:for(e.h&&e.h.l.clear(),i=[n],r=[],s=new Map,a=Un(t,"Location"),o=d(a),u=o.next();!u.done;u=o.next())l=u.value,c=l.attributes.serviceLocation,(h=Bn(l))&&(f=$t(i,[h])[0],c&&(e.h?db(e.h,"Location",c,f):s.set(c,f)),r.push(f));if(e.h?(p=hb(e.h,"Location",!0),0<p.length&&(i=e.A=p)):r.length&&(i=e.A=r),e.l.oe=t.attributes.id||"",e.l.Gd=Vn(t,"publishTime",qn)||0,e.F=Un(t,"PatchLocation"),g=Promise.resolve(),(m=$n(t,"ContentSteering"))&&e.j)for(v=m.attributes.defaultServiceLocation,e.h?(e.h.i=i,e.h.h=v):(e.h=new ob(e.j),e.h.configure(e.g),e.h.setManifestType("DASH"),e.h.i=i,e.h.h=v,(y=Bn(m))&&(Vn(m,"queryBeforeStart",ei,!1)?g=ub(e.h,y):ub(e.h,y))),b=d(s.keys()),T=b.next();!T.done;T=b.next())S=T.value,E=s.get(S),db(e.h,"Location",S,E);if(x=Un(t,"BaseURL"),I=!1,e.h)for(k=d(x),L=k.next();!L.done;L=k.next())R=L.value,C=R.attributes.serviceLocation,D=Bn(R),C&&D&&(db(e.h,"BaseURL",C,D),I=!0);if(e.W=null,I&&e.h||(M=x.map(Bn),e.W=$t(i,M)),P=function(){return e.h&&I?hb(e.h,"BaseURL"):e.W?e.W:[]},e.l.Ra=P,_=0,x&&x.length&&(_=Vn(x[0],"availabilityTimeOffset",Zn)||0),e.l.ab=_,e.I=Vn(t,"minimumUpdatePeriod",Yn,-1),O=Vn(t,"availabilityStartTime",qn),N=Vn(t,"timeShiftBufferDepth",Yn),F=e.g.dash.ignoreSuggestedPresentationDelay,B=null,F||(B=Vn(t,"suggestedPresentationDelay",Yn)),j=e.g.dash.ignoreMaxSegmentDuration,$=null,j||($=Vn(t,"maxSegmentDuration",Yn)),G=t.attributes.type||"static",e.i&&e.i.presentationTimeline&&(e.T=e.i.presentationTimeline.U()&&"static"==G),e.l.type=G,e.i)for(V=e.i.presentationTimeline,H=V.nb(),K=d(e.o.values()),W=K.next();!W.done;W=K.next())q=W.value,q.segmentIndex&&q.segmentIndex.Na(H);else Y=e.g.dash.ignoreMinBufferTime,X=0,Y||(X=Vn(t,"minBufferTime",Yn)||0),z=0,z=null!=B?Math.min(B,N||1/0):0<e.g.defaultPresentationDelay?e.g.defaultPresentationDelay:Math.min(1.5*X,N||1/0),V=new Ul(O,z,e.g.dash.autoCorrectDrift);return V.Ec("static"==G),V.U()&&!isNaN(e.g.availabilityWindowOverride)&&(N=e.g.availabilityWindowOverride),null==N&&(N=1/0),V.De(N),Q=t.attributes.profiles||"",e.l.profiles=Q.split(","),J={Mb:"static"!=G,presentationTimeline:V,pa:null,ha:null,ga:null,J:null,bandwidth:0,Lf:!1,ab:_,Ub:null,profiles:Q.split(","),roles:null,sb:function(){return""}},w(U,g,2);case 2:return e.L=0,Z=cT(e,J,P,t,!1),ee=Z.duration,te=Z.periods,("static"!=G||e.T)&&Z.Mg||V.$a(ee||1/0),e.P&&e.fa&&V.uh(e.$),V.Tf($||1),e.P&&e.fa&&(ne=null!=B?B:e.g.defaultPresentationDelay,V.jg(ne)),e.i?(e.i.periodCount=te.length,e.i.gapCount=e.L,w(U,nT(e,te,!1),4)):w(U,e.m.gf(te,J.Mb),6);case 6:if(e.i={presentationTimeline:V,variants:e.m.l,textStreams:e.m.Jf(),imageStreams:e.m.i,offlineSessionIds:[],sequenceMode:e.g.dash.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"DASH",serviceDescription:uT(t),nextUrl:lT(t),periodCount:te.length,gapCount:e.L,isLowLatency:e.P,startTime:null},!V.Jh()){U.s(7);break}return ie=Un(t,"UTCTiming"),w(U,xT(e,P,ie),8);case 8:if(re=U.h,!e.j)return U.return();V.vh(re);case 7:V.ke(),e.m&&!e.i.presentationTimeline.U()&&e.m.release();case 4:e.j.makeTextStreamsForClosedCaptions(e.i),dT(e),A(U)}}))}function nT(e,t,n){var i;return U((function(r){if(1==r.g)return w(r,e.m.gf(t,!0,n),2);e.i.variants=e.m.l,i=e.m.Jf(),0<i.length&&(e.i.textStreams=i),e.i.imageStreams=e.m.i,e.j.filter(e.i),A(r)}))}function iT(e,t){var n,i,r,s,a,o,u,l,c,f,p,g,m,v,y,b,T,S,E,x,I,k,L,R,C,D,M;return U((function(P){if(1==P.g){if(n=t.attributes.mpdId,i=Vn(t,"originalPublishTime",qn),!n||n!==e.l.oe||i!==e.l.Gd)throw e.F=[],new je(1,4,4052);for(r=[],s=[],a=new Set,o=d(Nn(t)),u=o.next();!u.done;u=o.next())if(l=u.value,c=ni(l.attributes.sel||""),f=c[c.length-1],p=Bn(l)||"","MPD"===f.name)if("mediaPresentationDuration"===f.Zb){g=Bn(l)||"";var _=Yn(g);if(null!=_){e.l.Ub=_;for(var O=d(e.u.values()),N=O.next();!N.done;N=O.next())N.value.Ub=_}}else if("type"===f.Zb){for(e.i.presentationTimeline.Ec("static"==p),e.l.type=p,_=d(e.u.values()),O=_.next();!O.done;O=_.next())O.value.Mb="dynamic"==p;"static"==p&&(e.I=-1)}else"publishTime"===f.Zb?e.l.Gd=qn(p)||0:null===f.Zb&&"add"===l.tagName&&s.push(l);else if("PatchLocation"===f.name)ii(e.F,l);else if("Period"===f.name)"add"===l.tagName?s.push(l):"remove"===l.tagName&&f.id&&sT(e,f.id);else if("SegmentTemplate"===f.name){if(O=ni(l.attributes.sel||""),_=O[O.length-1],_.Zb){O=aT(e,O),N=Bn(l)||"";for(var U=d(O),F=U.next();!F.done;F=U.next())F=e.u.get(F.value),si(F.J.ic,l.tagName,_.Zb,N);_=O}else _=[];for(m=_,v=d(m),y=v.next();!y.done;y=v.next())b=y.value,a.add(b)}else if("SegmentTimeline"===f.name||"S"===f.name){for(_=ni(l.attributes.sel||""),_=aT(e,_),O=d(_),N=O.next();!N.done;N=O.next())N=e.u.get(N.value),N=Ay(N,Qy,"SegmentTimeline"),U=Un(N,"S"),ii(U,l),N.children=U;for(T=_,S=d(T),E=S.next();!E.done;E=S.next())x=E.value,a.add(x)}for(I=d(a),k=I.next();!k.done;k=I.next())L=k.value,oT(e,L);for(R=d(s),C=R.next();!C.done;C=R.next())D=C.value,r.push.apply(r,h(rT(e,D)));return r.length?(e.i.periodCount+=r.length,e.i.gapCount=e.L,w(P,nT(e,r,!0),2)):P.s(2)}"static"==e.l.type&&(M=e.l.Ub,e.i.presentationTimeline.$a(M||1/0)),A(P)}))}function rT(e,t){return cT(e,{Mb:"dynamic"==e.l.type,presentationTimeline:e.i.presentationTimeline,pa:null,ha:null,ga:null,J:null,bandwidth:0,Lf:!1,ab:e.l.ab,profiles:e.l.profiles,Ub:e.l.Ub,roles:null,sb:function(){return""}},e.l.Ra,t,!0).periods}function sT(e,t){e.i.periodCount--;for(var n=d(e.u.keys()),i=n.next();!i.done;i=n.next())if(i=i.value,i.startsWith(t)){var r=e.u.get(i);Ay(r,Qy,"SegmentTimeline").children=[],oT(e,i),e.u.delete(i)}e.C=e.C.filter((function(e){return e!==t}))}function aT(e,t){var n="",i="",r=-1,s="";t=d(t);for(var a=t.next();!a.done;a=t.next())a=a.value,"Period"===a.name?n=a.id:"AdaptationSet"===a.name?(i=a.id,null!==a.position&&(r=a.position)):"Representation"===a.name&&(s=a.id);if(t=[],s)t.push(n+","+s);else if(i)for(r=d(e.u.values()),e=r.next();!e.done;e=r.next())e=e.value,e.pa.id===n&&e.ga.id===i&&e.J.id&&t.push(n+","+e.J.id);else if(-1<r)for(i=d(e.u.values()),e=i.next();!e.done;e=i.next())e=e.value,e.pa.id===n&&e.ga.position===r&&e.J.id&&t.push(n+","+e.J.id);return t}function oT(e,t){var n=e.u.get(t),i=e.o.get(t);i.segmentIndex&&i.segmentIndex.Na(e.i.presentationTimeline.nb());try{var r=zy(n,(function(t,n,i,r){return kT(e,t,n,i,r)}),e.o,!0,e.g.dash.initialSegmentLimit,e.ka,n.J.aesKey,null,!0);i.createSegmentIndex=function(){return U((function(e){if(1==e.g)return i.segmentIndex?e.s(0):w(e,r.rc(),3);i.segmentIndex=e.h,A(e)}))}}catch(s){if(t=n.J.contentType,t!=qt&&"application"!=t&&"image"!=t||4002!=s.code)throw s}}function uT(e){var t=$n(e,"ServiceDescription");if(!t)return null;if(e=$n(t,"Latency"),t=$n(t,"PlaybackRate"),!e&&!t)return null;var n={};return e&&("target"in e.attributes&&(n.targetLatency=parseInt(e.attributes.target,10)/1e3),"max"in e.attributes&&(n.maxLatency=parseInt(e.attributes.max,10)/1e3),"min"in e.attributes&&(n.minLatency=parseInt(e.attributes.min,10)/1e3)),t&&("max"in t.attributes&&(n.maxPlaybackRate=parseFloat(t.attributes.max)),"min"in t.attributes&&(n.minPlaybackRate=parseFloat(t.attributes.min))),n}function lT(e){if(e=Un(e,"SupplementalProperty"),!e.length)return null;e=d(e);for(var t=e.next();!t.done;t=e.next())if(t=t.value,"urn:mpeg:dash:chaining:2016"==t.attributes.schemeIdUri)return t.attributes.value;return null}function cT(e,t,n,i,r){var s=t.Ub;s||(s=Vn(i,"mediaPresentationDuration",Yn),e.l.Ub=s);var a=0;e.i&&e.i.presentationTimeline&&e.T&&(a=e.i.presentationTimeline.Fb());var o=[],u=a;i=Un(i,"Period");for(var l=0;l<i.length;l++){var c=i[l],h=i[l+1],f=Vn(c,"start",Yn,u),p=c.attributes.id,g=Vn(c,"duration",Yn);f=0==l&&0==f&&e.T?a:f;var m=null;if(h){var v=Vn(h,"start",Yn);null!=v&&(m=v-f+a)}else null!=s&&(m=s-f+a);if(v=Xt,m&&g&&Math.abs(m-g)>v&&m>g&&e.L++,null==m&&(m=g),!(null!==e.M&&null!==p&&null!==f&&f<e.M)||e.C.includes(p)||l+1==i.length){if(null!==f&&(null===e.M||f>e.M)&&(e.M=f),u=hT(e,t,n,{start:f,duration:m,node:c,Zg:null==m||!h}),o.push(u),t.pa.id&&m&&e.ka.set(t.pa.id,m),null==m){u=null;break}u=f+m}}if(r)for(t=d(o),n=t.next();!n.done;n=t.next())n=n.value.id,e.C.includes(n)||e.C.push(n);else e.C=o.map((function(e){return e.id}));return null!=s?{periods:o,duration:s+a,Mg:!1}:{periods:o,duration:u,Mg:!0}}function dT(e){var t=Array.from(e.B.keys()).filter((function(t){return!e.C.includes(t)}));t=d(t);for(var n=t.next();!n.done;n=t.next()){n=n.value;for(var i=!0,r=d(e.B.get(n)),s=r.next();!s.done;s=r.next()){s=s.value;var a=e.o.get(s);a&&(a.segmentIndex&&0!=a.segmentIndex.getNumReferences()?i=!1:(e.m&&e.m.Kg(a,n),e.o.delete(s)))}i&&e.B.delete(n)}}function hT(e,t,n,i){t.pa=TT(e,i.node,null,n),t.ha=i,t.pa.ab=t.ab,t.pa.id||(t.pa.id="__shaka_period_"+i.start);var r=Un(i.node,"EventStream");n=t.presentationTimeline.nb(),r=d(r);for(var s=r.next();!s.done;s=r.next())IT(e,i.start,i.duration,s.value,n);for(n=Un(i.node,"SupplementalProperty"),n=d(n),r=n.next();!r.done;r=n.next())r=r.value,"urn:mpeg:dash:urlparam:2014"==r.attributes.schemeIdUri&&(r=gT(e,r))&&(t.sb=r);if(n=Un(i.node,"AdaptationSet").map((function(n,i){return pT(e,t,i,n)})).filter(vr),t.Mb){r=[],s=d(n);for(var a=s.next();!a.done;a=s.next()){a=d(a.value.rj);for(var o=a.next();!o.done;o=a.next())r.push(o.value)}if(r.length!=new Set(r).size)throw new je(2,4,4018)}for(r=new Map,s=d(n),a=s.next();!a.done;a=s.next())for(a=d(a.value.di),o=a.next();!o.done;o=a.next()){var u=d(o.value);o=u.next().value,u=u.next().value,r.set(o,u)}if(r.size)for(s=null,a=d(n),o=a.next();!o.done;o=a.next()){o=o.value,u=[];for(var l=d(o.streams),c=l.next(),f={};!c.done;f={og:void 0},c=l.next())if(f.og=c.value,r.has(f.og.originalId)){s||(s=Un(i.node,"AdaptationSet").map((function(n,i){return pT(e,t,i,n)})).filter(vr)),c=d(s);for(var p=c.next();!p.done;p=c.next())(p=p.value.streams.find(function(e){return function(t){return t.originalId==e.og.originalId}}(f)))&&(p.dependencyStream=r.get(p.originalId),p.originalId+=p.dependencyStream.originalId,u.push(p))}u.length&&o.streams.push.apply(o.streams,h(u))}if(i=n.filter((function(e){return!e.vg})),n=n.filter((function(e){return e.vg})),!e.g.disableIFrames)for(n=d(n),r=n.next();!r.done;r=n.next())for(r=r.value,s=r.vg.split(" "),a=d(i),o=a.next();!o.done;o=a.next())if(o=o.value,s.includes(o.id))for(o=d(o.streams),u=o.next();!u.done;u=o.next())is(u.value,r.streams);if(n=fT(e.g.disableAudio,i,"audio"),r=fT(e.g.disableVideo,i,"video"),s=fT(e.g.disableText,i,qt),i=fT(e.g.disableThumbnails,i,"image"),0===r.length&&0===n.length)throw new je(2,4,4004);return{id:t.pa.id,audioStreams:n,videoStreams:r,textStreams:s,imageStreams:i}}function fT(e,t,n){return e||!t.length?[]:t.reduce((function(e,t){return t.contentType!=n||e.push.apply(e,h(t.streams)),e}),[])}function pT(e,t,n,i){function r(n){var i=n.attributes["dvb:fontFamily"];n=n.attributes["dvb:url"],i&&n&&(n=$t(t.ga.Ra(),[n],t.sb()),e.j.addFont(i,n[0]))}function s(e){switch(e){case 1:case 5:case 6:case 7:return"srgb";case 9:return"rec2020";case 11:case 12:return"p3"}}function a(e){switch(e){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}}t.ga=TT(e,i,t.pa,null),t.ga.position=n;var o=!1;n=Un(i,"Role");var u=n.map((function(e){return e.attributes.value})).filter(vr),l=void 0,c=t.ga.contentType==qt;c&&(l="subtitle"),n=d(n);for(var f=n.next();!f.done;f=n.next()){f=f.value;var p=f.attributes.schemeIdUri;if(null==p||"urn:mpeg:dash:role:2011"==p)switch(f=f.attributes.value,f){case"main":o=!0;break;case"caption":case"subtitle":l=f}}var g=Un(i,"EssentialProperty");n=null;var m=!1;f=null,p=!1,g=d(g);for(var v=g.next();!v.done;v=g.next()){v=v.value;var y=v.attributes.schemeIdUri;if("http://dashif.org/guidelines/trickmode"==y)n=v.attributes.value;else if("urn:mpeg:mpegB:cicp:TransferCharacteristics"==y)var b=a(parseInt(v.attributes.value,10));else if("urn:mpeg:mpegB:cicp:ColourPrimaries"==y)var T=s(parseInt(v.attributes.value,10));else"urn:mpeg:mpegB:cicp:MatrixCoefficients"!=y&&("urn:mpeg:dash:ssr:2023"==y&&e.g.dash.enableFastSwitching?m=!0:"urn:dvb:dash:fontdownload:2014"==y?r(v):"urn:mpeg:dash:urlparam:2014"==y&&(f=gT(e,v))||(p=!0))}if(p)return null;var S=null;for(p=Un(i,"SupplementalProperty"),p=d(p),g=p.next();!g.done;g=p.next())g=g.value,v=g.attributes.schemeIdUri,"http://dashif.org/guidelines/last-segment-number"==v?S=parseInt(g.attributes.value,10)-1:"urn:mpeg:mpegB:cicp:TransferCharacteristics"==v?b=a(parseInt(g.attributes.value,10)):"urn:mpeg:mpegB:cicp:ColourPrimaries"==v?T=s(parseInt(g.attributes.value,10)):"urn:dvb:dash:fontdownload:2014"==v?r(g):"urn:mpeg:dash:urlparam:2014"==v&&(f=gT(e,g));f&&(t.sb=f),f=Un(i,"Accessibility");var E,w=new Map;for(f=d(f),p=f.next();!p.done;p=f.next())if(g=p.value,p=g.attributes.schemeIdUri,g=g.attributes.value,"urn:scte:dash:cc:cea-608:2015"!=p||e.g.disableText)if("urn:scte:dash:cc:cea-708:2015"!=p||e.g.disableText)"urn:mpeg:dash:role:2011"==p?null!=g&&(u.push(g),"captions"==g&&(l="caption")):"urn:tva:metadata:cs:AudioPurposeCS:2007"==p&&("1"==g?E="visually impaired":"2"==g&&(E="hard of hearing"));else if(p=1,null!=g)for(g=d(g.split(";")),v=g.next();!v.done;v=g.next()){y=v.value;var A=v=void 0;y.includes("=")?(y=y.split("="),v="svc"+y[0],A=y[1].split(",")[0].split(":").pop()):(v="svc"+p,p++,A=y),w.set(v,wr(A))}else w.set("svc1","und");else if(p=1,null!=g)for(g=g.split(";"),v=d(g),y=v.next();!y.done;y=v.next()){A=y.value;var x=y=void 0;A.includes("=")?(A=A.split("="),y=A[0].startsWith("CC")?A[0]:"CC"+A[0],x=A[1]||"und"):(y="CC"+p,2==g.length?p+=2:p++,x=A),w.set(y,wr(x))}else w.set("CC1","und");f=Un(i,"ContentProtection");var I=hy(f,e.g.ignoreDrmInfo,e.g.dash.keySystemsByURI);t.ga.encrypted=0<f.length;var k=wr(t.ga.language||"und"),L=t.ga.label,R=new Map;if(i=Un(i,"Representation"),!e.g.ignoreSupplementalCodecs){for(f=[],p=d(i),g=p.next();!g.done;g=p.next())v=g.value,(g=Hn(v,"urn:scte:dash:scte214-extensions","supplementalCodecs"))&&(v=Ln(v),v.attributes.codecs=g.split(" ").join(","),v.attributes.id&&(v.attributes.supplementalId=v.attributes.id+"_supplementalCodecs"),f.push(v));i.push.apply(i,h(f))}if(f=i.map((function(n){var i=mT(e,t,I,l,k,L,o,u,w,n,E,S);return i&&(i.hdr=i.hdr||b,i.colorGamut=i.colorGamut||T,i.fastSwitching=m,n=n.attributes.dependencyId)?(i.baseOriginalId=n,R.set(n,i),null):i})).filter((function(e){return!!e})),0==f.length&&0==R.size){if(n="image"==t.ga.contentType,e.g.dash.ignoreEmptyAdaptationSet||c||n)return null;throw new je(2,4,4003)}if(!t.ga.contentType||"application"==t.ga.contentType)for(t.ga.contentType=LT(f[0].mimeType,f[0].codecs),c=d(f),p=c.next();!p.done;p=c.next())p.value.type=t.ga.contentType;for(c=t.ga.id||"__fake__"+e.oa++,p=d(f),g=p.next();!g.done;g=p.next()){for(g=g.value,v=d(I.drmInfos),y=v.next();!y.done;y=v.next())y=y.value,y.keyIds=y.keyIds&&g.keyIds?new Set([].concat(h(y.keyIds),h(g.keyIds))):y.keyIds||g.keyIds;g.groupId=c}return i=i.map((function(e){return e.attributes.supplementalId||e.attributes.id})).filter(vr),{id:c,contentType:t.ga.contentType,language:k,Qk:o,streams:f,drmInfos:I.drmInfos,vg:n,rj:i,di:R}}function gT(e,t){if((t=Gn(t,"urn:mpeg:dash:schema:urlparam:2014","UrlQueryInfo"))&&Vn(t,"useMPDUrlQuery",ei,!1)){var n=t.attributes.queryTemplate;if(n)return function(){return"$querypart$"==n?e.Z:n.split("&").map((function(t){if("$querypart$"==t)return e.Z;var n=/\$query:(.*?)\$/g.exec(t);if(n&&2==n.length){n=n[1];var i=new Ce(e.Z).get(n);if(i.length)return n+"="+i[0]}return t})).join("&")}}return null}function mT(t,n,i,r,s,a,o,u,l,c,d,h){n.J=TT(t,c,n.ga,null);var f=n.J.id;if(t.$=Math.min(t.$,n.J.ab),t.P=0<t.$,!wT(n.J))return null;var p=n.ha.start;n.bandwidth=Vn(c,"bandwidth",Qn)||0,n.roles=u;var g=Un(c,"SupplementalProperty"),m=Un(c,"EssentialProperty"),v=Un(c,"ContentProtection");c=null;var y,b,T=m.find((function(e){return"urn:mpeg:dash:urlparam:2014"==e.attributes.schemeIdUri}));(T||(T=g.find((function(e){return"urn:mpeg:dash:urlparam:2014"==e.attributes.schemeIdUri}))))&&(c=gT(t,T)),c&&(n.sb=c),T=n.J.contentType,c=T==qt||"application"==T,T="image"==T,v.length&&(n.ga.encrypted=!0);try{var S=void 0;if(i.cf){var E=n.J.Ra,x=n.sb,I=$t(E(),[i.cf.Xi],x()),k=Os(I,t.g.retryParameters);S={bitsKey:128,blockCipherMode:"CBC",iv:i.cf.iv,firstMediaSequenceNumber:0,fetchKey:function(){var n,i,r;return U((function(s){if(1==s.g)return w(s,RT(t,k,6),2);if(3!=s.g){if(n=s.h,!n.data||16!=n.data.byteLength)throw new je(2,4,4049);return i={name:"AES-CBC"},r=S,w(s,e.crypto.subtle.importKey("raw",n.data,i,!0,["decrypt"]),3)}r.cryptoKey=s.h,S.fetchKey=void 0,A(s)}))}}}if(n.J.aesKey=S,E=function(e,n,i,r){return kT(t,e,n,i,r)},n.J.bd)var L=Fy(n,E,S);else if(n.J.Xb)L=Ky(n,t.o,S);else if(n.J.ic)L=zy(n,E,t.o,!!t.i,t.g.dash.initialSegmentLimit,t.ka,S,h,!1);else{var R=n.ha.duration||0,C=n.J.Ra,D=n.J.mimeType,M=n.J.codecs;L={rc:function(){var e=ac(p,R,C());return e.vb((function(e){e.mimeType=D,e.codecs=M})),Promise.resolve(e)}}}}catch(_){if((c||T)&&4002==_.code)return null;throw _}if(h=fy(v,i,t.g.ignoreDrmInfo,t.g.dash.keySystemsByURI),h=new Set(h?[h]:[]),v=!1,g.some((function(e){return"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"==e.attributes.schemeIdUri&&"JOC"==e.attributes.value}))&&(v=!0),g=!1,c&&(g=u.includes("forced_subtitle")||u.includes("forced-subtitle")),T&&((m=m.find((function(e){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(e.attributes.schemeIdUri)})))&&(y=m.attributes.value),!y))return null;c=n.J.codecs,n.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(c.includes("hvc1.2.4.L153.B0")||c.includes("hev1.2.4.L153.B0"))&&(b="PQ"),m=n.J.id?n.pa.id+","+n.J.id:"",t.F.length&&f&&t.u.set(n.pa.id+","+f,vT(n));var P=m&&t.o.has(m)?t.o.get(m):{id:t.oa++,originalId:n.J.id,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){P.segmentIndex&&(P.segmentIndex.release(),P.segmentIndex=null)},segmentIndex:null,mimeType:n.J.mimeType,codecs:c,frameRate:n.J.frameRate,pixelAspectRatio:n.J.pixelAspectRatio,bandwidth:n.bandwidth,width:n.J.width,height:n.J.height,kind:r,encrypted:0<i.drmInfos.length,drmInfos:i.drmInfos,keyIds:h,language:s,originalLanguage:n.ga.language,label:a,type:n.ga.contentType,primary:o,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:n.J.emsgSchemeIdUris,roles:u,forced:g,channelsCount:n.J.qe,audioSamplingRate:n.J.audioSamplingRate,spatialAudio:v,closedCaptions:l,hdr:b,colorGamut:void 0,videoLayout:void 0,tilesLayout:y,accessibilityPurpose:d,external:!1,fastSwitching:!1,fullMimeTypes:new Set([Wi(n.J.mimeType,n.J.codecs)]),isAudioMuxedInVideo:!1,baseOriginalId:null};return P.createSegmentIndex=function(){var e;return U((function(t){if(1==t.g)return P.segmentIndex?t.s(0):(e=P,w(t,L.rc(),3));e.segmentIndex=t.h,A(t)}))},m&&n.Mb&&!t.o.has(m)&&(n=n.pa.id||"",t.B.has(n)||t.B.set(n,[]),t.o.set(m,P),t.B.get(n).push(m)),P}function vT(e){function t(e){return e?(e=Rn(e),e.bd=null,e.Xb=null,e.ic=oi(e.ic),e):null}return e=Rn(e),e.pa=t(e.pa),e.ga=t(e.ga),e.J=t(e.J),e.ha&&(e.ha=Rn(e.ha),e.ha.node=null),e}function yT(e){var t,n;return U((function(i){switch(i.g){case 1:return t=0,x(i,2),w(i,Zb(e),4);case 4:t=i.h,k(i,3);break;case 2:if(n=L(i),e.j){if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.j.onError(n),i.return();n.severity=1,e.j.onError(n)}case 3:if(!e.j)return i.return();e.j.onManifestUpdated(),bT(e,t),A(i)}}))}function bT(e,t){if(!(0>e.I)){var n=e.I;0<=e.g.updatePeriod&&(n=e.g.updatePeriod),e.K.da(Math.max(n-t,X(e.na)))}}function TT(e,t,n,i){n=n||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,qe:null,audioSamplingRate:null,ab:0,Be:0,encrypted:!1},i=i||n.Ra;var r,s=t.attributes.id,a=t.attributes.supplementalId,o=Un(t,"BaseURL"),u=!1;if(e.h)for(var l=d(o),c=l.next();!c.done;c=l.next()){var h=c.value;c=h.attributes.serviceLocation,h=Bn(h),c&&h&&(db(e.h,s,c,h),u=!0)}u&&e.h||(r=o.map(Bn)),l=t.attributes.contentType||n.contentType,c=t.attributes.mimeType||n.mimeType,h=Nc([t.attributes.codecs||n.codecs]).join(",");var f=Vn(t,"frameRate",ti)||n.frameRate,p=t.attributes.sar||n.pixelAspectRatio,g=ST(Un(t,"InbandEventStream"),n.emsgSchemeIdUris),m=Un(t,"AudioChannelConfiguration");m=ET(m)||n.qe;var v=Vn(t,"audioSamplingRate",Jn)||n.audioSamplingRate;l||(l=LT(c,h));var y=$n(t,"SegmentBase"),b=$n(t,"SegmentTemplate"),T=y&&Vn(y,"availabilityTimeOffset",Zn)||0,S=b&&Vn(b,"availabilityTimeOffset",Zn)||0,E=o&&o.length&&Vn(o[0],"availabilityTimeOffset",Zn)||0;T=n.ab+E+T+S,S=null,(E=$n(t,"SegmentSequenceProperties"))&&(E=$n(E,"SAP"))&&(S=Vn(E,"cadence",zn)),E=t.attributes.label;var w=Un(t,"Label");return w&&w.length&&(w=w[0],Fn(w)&&(E=Fn(w))),{Ra:function(){return $t(i(),o.length?e.h&&u?hb(e.h,s):r||[]:[])},bd:y||n.bd,Xb:$n(t,"SegmentList")||n.Xb,ic:b||n.ic,width:Vn(t,"width",Jn)||n.width,height:Vn(t,"height",Jn)||n.height,contentType:l,mimeType:c,codecs:h,frameRate:f,pixelAspectRatio:p,emsgSchemeIdUris:g,id:a||s,originalId:s,language:t.attributes.lang,qe:m,audioSamplingRate:v,ab:T,fe:null,Be:S||n.Be,label:E||null,encrypted:!1}}function ST(e,t){t=t.slice(),e=d(e);for(var n=e.next();!n.done;n=e.next())n=n.value.attributes.schemeIdUri,t.includes(n)||t.push(n);return t}function ET(e){e=d(e);for(var t=e.next();!t.done;t=e.next()){t=t.value;var n=t.attributes.schemeIdUri;if(n&&(t=t.attributes.value))switch(n){case"urn:mpeg:dash:outputChannelPositionList:2012":return t.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(t=parseInt(t,10),!t)continue;return t;case"tag:dolby.com,2015:dash:audio_channel_configuration:2015":if(n=[2,1,2,2,2,2,1,2,2,1,1,1,1,2,1,1,2,2],t=parseInt(t,16),!t)continue;for(var i=0,r=0;r<n.length;r++)t&1<<r&&(i+=n[r]);if(i)return i;continue;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(n=[1,1,1,1,1,2,2,1,1,2,2,2,1,2,1,1].reverse(),t=parseInt(t,16),!t)continue;for(r=i=0;r<n.length;r++)t&1<<r&&(i+=n[r]);if(i)return i;continue;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(n=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(t=parseInt(t,10))&&0<t&&t<n.length)return n[t]}}return null}function wT(e){var t=e.bd?1:0;return t+=e.Xb?1:0,t+=e.ic?1:0,0==t?e.contentType==qt||"application"==e.contentType:(1!=t&&(e.bd&&(e.Xb=null),e.ic=null),!0)}function AT(e,t,n,i){var r,s,a,o,u,l,c;return U((function(d){if(1==d.g)return r=[Mt(n)],s=$t(t(),r),a=Os(s,e.g.retryParameters),a.method=i,o=e.j.networkingEngine.request(4,a,{isPreload:e.ea()}),Ds(e.O,o),w(d,o.promise,2);if(u=d.h,"HEAD"==i){if(!u.headers||!u.headers.date)return d.return(0);l=u.headers.date}else l=It(u.data);return c=Date.parse(l),isNaN(c)?d.return(0):d.return(c-Date.now())}))}function xT(e,t,n){var i,r,s,a,o,u,l,c;return U((function(h){switch(h.g){case 1:i=n.map((function(e){return{scheme:e.attributes.schemeIdUri,value:e.attributes.value}})),r=e.g.dash.clockSyncUri,!i.length&&r&&i.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:r}),s=d(i),a=s.next();case 2:if(a.done){h.s(4);break}switch(o=a.value,x(h,5),u=o.scheme,l=o.value,u){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return h.s(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return h.s(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return c=Date.parse(l),h.return(isNaN(c)?0:c-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":Z("NTP UTCTiming scheme is not supported");break;default:Z("Unrecognized scheme in UTCTiming element",u)}h.s(9);break;case 7:return w(h,AT(e,t,l,"HEAD"),10);case 10:return h.return(h.h);case 8:return w(h,AT(e,t,l,"GET"),11);case 11:return h.return(h.h);case 9:k(h,3);break;case 5:L(h);case 3:a=s.next(),h.s(2);break;case 4:return Z("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),h.return(0)}}))}function IT(e,t,n,i,r){var s=i.attributes.schemeIdUri||"",a=i.attributes.value||"",o=Vn(i,"timescale",Jn)||1,u=Vn(i,"presentationTimeOffset",Jn)||0;i=d(Un(i,"Event"));for(var l=i.next();!l.done;l=i.next()){l=l.value;var c=Vn(l,"presentationTime",Jn)||0,h=Vn(l,"duration",Jn)||0;c=Math.max((c-u)/o+t,t),h=c+h/o,null!=n&&(c=Math.min(c,t+n),h=Math.min(h,t+n)),h<r||(l={schemeIdUri:s,value:a,startTime:c,endTime:h,id:l.attributes.id||"",timescale:o,eventElement:ai(l),eventNode:oi(l)},e.j.onTimelineRegionAdded(l))}}function kT(e,t,n,i,r){var s,a,o,u;return U((function(l){return 1==l.g?(s=Gs,a=r?0:1,o=jc(t,n,i,e.g.retryParameters),w(l,RT(e,o,s,{type:a}),2)):(u=l.h,l.return(u.data))}))}function LT(e,t){return t=Wi(e,t),ur(t)?qt:e.split("/")[0]}function RT(e,t,n,i){return i||(i={}),i.isPreload=e.ea(),t=e.j.networkingEngine.request(n,t,i),Ds(e.O,t),t.promise}function CT(e){var t=e.l.Gd;if(!e.l.oe||!t||!e.F.length)return[];var n=Date.now()/1e3,i=e.F.filter((function(e){return e=Jn(e.attributes.ttl),!e||t+e>n})).map(Bn).filter(vr);return i.length?$t(e.A,i):[]}function DT(){}i=Jb.prototype,i.configure=function(e,t){var n=this.j&&e.updatePeriod!=this.g.updatePeriod&&0<=e.updatePeriod;this.g=e,t&&(this.ea=t),n&&this.i&&this.i.presentationTimeline.U()&&this.K.qb(),this.h&&this.h.configure(this.g),this.m&&(this.m.th(this.g.dash.multiTypeVariantsAllowed&&nn()),this.m.zh(this.g.dash.useStreamOnceInPeriodFlattening))},i.start=function(e,t){var n,i=this;return U((function(r){if(1==r.g)return i.fa=t.isLowLatencyMode(),i.A=[e],i.j=t,w(r,Zb(i),2);if(n=r.h,i.j&&bT(i,n),!i.j)throw new je(2,7,7001);return r.return(i.i)}))},i.stop=function(){for(var e=d(this.o.values()),t=e.next();!t.done;t=e.next())t=t.value,t.segmentIndex&&t.segmentIndex.release();return this.m&&this.m.release(),this.g=this.j=null,this.A=[],this.i=null,this.o.clear(),this.B.clear(),this.u.clear(),this.l={oe:"",type:"",profiles:[],Ub:null,ab:0,Ra:null,Gd:0},this.m=null,null!=this.K&&(this.K.stop(),this.K=null),this.h&&this.h.destroy(),this.G&&(this.G.release(),this.G=null),this.O.destroy()},i.update=function(){var e,t=this;return U((function(n){return 1==n.g?(x(n,2),w(n,Zb(t),4)):2!=n.g?k(n,0):(e=L(n),t.j&&e?(t.j.onError(e),void A(n)):n.return())}))},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(e){if(this.i&&this.i.presentationTimeline.U()){var t=e.video||e.audio;if(t&&t.segmentIndex){e=this.i.presentationTimeline.bc();var n=t.segmentIndex.find(e);null!=n&&(t=t.segmentIndex.get(n))&&(this.I=t.endTime-e,bT(this,0))}}},i.banLocation=function(e){this.h&&this.h.banLocation(e)},i.setMediaElement=function(e){this.H=e},K("shaka.dash.DashParser",Jb),fo("application/dash+xml",(function(){return new Jb})),fo("video/vnd.mpeg.dash.mpd",(function(){return new Jb})),K("shaka.dependencies",DT),DT.has=function(e){return _T.has(e)},DT.add=function(e,t){if(!PT[e])throw Error(e+" is not supported");e==MT?he("mux.js","mux.js is no longer used in Shaka Player."):_T.set(e,(function(){return t}))};var MT="muxjs",PT={Rk:MT,ISOBoxer:"ISOBoxer"};DT.Allowed=PT;var _T=new Map([["ISOBoxer",function(){return e.ISOBoxer}]]);function OT(e,t,n){this.type=e,this.ca=t,this.segments=n||null}function NT(e,t,n,i){this.id=e,this.name=t,this.attributes=n,this.value=void 0===i?null:i}function UT(e,t){return t?e.toString():(t=(new Set).add("AUDIO").add("VIDEO").add("SUBTITLES").add("PATHWAY-ID").add("GROUP-ID").add("URI"),e.toString(t))}function FT(e,t){return e=e.attributes.filter((function(e){return e.name==t})),e.length?e[0]:null}function BT(e,t,n){return(e=FT(e,t))?e.value:n||null}function jT(e,t){if(e=FT(e,t),!e)throw new je(2,4,4023,t);return e.value}function $T(e,t,n){n=void 0===n?[]:n,this.ca=t,this.g=e,this.Hb=n}function GT(e,t){this.name=e,this.value=t}function VT(e,t){return e.filter((function(e){return e.name==t}))}function HT(e,t){return e.filter((function(e){return jT(e,"TYPE")==t}))}function KT(e,t){e=d(e);for(var n=e.next();!n.done;n=e.next())if(n=n.value,n.name===t)return n;return null}function WT(e,t,n){return n=void 0===n?0:n,(e=KT(e,t))?Number(e.value):n}function qT(e,t,n){return t?YT(e,[t],n):[]}function YT(e,t,n){if(!t.length)return[];var i=t;return n&&n.size&&(i=t.map((function(e){return XT(e,n)}))),$t(e,i)}function XT(e,t){if(!t||!t.size)return e;e=String(e).replace(/%7B/g,"{").replace(/%7D/g,"}");var n=e.match(/{\$\w*}/g);if(n){n=d(n);for(var i=n.next();!i.done;i=n.next()){i=i.value;var r=i.slice(2,i.length-1),s=t.get(r);if(!s)throw new je(2,4,4039,r);e=e.replace(i,s)}}return e}function zT(){this.g=0}function QT(e,t){t=It(t),t=t.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim();var n=t.split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(n[0]))throw new je(2,4,4015);t=0;for(var i=!0,r=d(n),s=r.next();!s.done;s=r.next())if(s=s.value,/^#(?!EXT)/m.test(s)||i)i=!1;else{if(s=JT(e,s),--e.g,ZT.includes(s.name)){t=1;break}"EXT-X-STREAM-INF"==s.name&&(i=!0)}for(r=[],i=!0,s=0;s<n.length;s++){var a=n[s],o=n[s+1];if(/^#(?!EXT)/m.test(a)||i)i=!1;else{if(a=JT(e,a),eS.includes(a.name)){if(1!=t)throw new je(2,4,4017);a=n.splice(s,n.length-s),n=[],i=[],s=[],o=null,a=d(a);for(var u=a.next();!u.done;u=a.next())u=u.value,/^(#EXT)/.test(u)?(u=JT(e,u),ZT.includes(u.name)?r.push(u):"EXT-X-MAP"==u.name?o=u:"EXT-X-PART"==u.name?s.push(u):"EXT-X-PRELOAD-HINT"==u.name?"PART"==BT(u,"TYPE")?s.push(u):"MAP"==BT(u,"TYPE")&&(u.name="EXT-X-MAP",o=u):i.push(u)):/^#(?!EXT)/m.test(u)||(u=u.trim(),o&&i.push(o),n.push(new $T(u,i,s)),i=[],s=[]);return s.length&&(o&&i.push(o),n.push(new $T("",i,s))),new OT(t,r,n)}r.push(a),"EXT-X-STREAM-INF"==a.name&&(a.attributes.push(new GT("URI",o)),i=!0)}}return new OT(t,r)}function JT(e,t){e=e.g++;var n=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!n)throw new je(2,4,4016,t);t=n[1];var i,r=n[2];if(n=[],r){var s;r=new Sn(r),(s=wn(r,/^([^,=]+)(?:,|$)/g))&&(i=s[1]);for(var a=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;s=wn(r,a);)n.push(new GT(s[1],s[2]||s[3])),En(r)}return new NT(e,t,n,i)}NT.prototype.toString=function(e){function t(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)}var n="#"+this.name,i=this.attributes?this.attributes.filter((function(t){return!e||!e.has(t.name)})).map(t):[];return this.value&&i.unshift(this.value),0<i.length&&(n+=":"+i.join(",")),n};var ZT="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP EXT-X-PART-INF EXT-X-DATERANGE".split(" "),eS="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP EXT-X-GAP EXT-X-TILES".split(" ");function tS(){}function nS(e,t){try{var n=iS(e);return Es({uri:e,originalUri:e,data:n.data,headers:{"content-type":n.contentType},originalRequest:t})}catch(i){return Ts(i)}}function iS(t){var n=t.split(":");if(2>n.length||"data"!=n[0])throw new je(2,1,1004,t);if(n=n.slice(1).join(":").split(","),2>n.length)throw new je(2,1,1004,t);var i=n[0];t=e.decodeURIComponent(n.slice(1).join(",")),n=i.split(";"),i=n[0];var r,s=!1;return 1<n.length&&"base64"==n[n.length-1]&&(s=!0,n.pop()),r=s?Ut(t):Rt(t),{data:r,contentType:i}}function rS(){var e=this;this.g=this.h=null,this.F=1,this.A=new Map,this.I=new Map,this.M=new Map,this.M.set("video",new Map),this.M.set("audio",new Map),this.M.set(qt,new Map),this.M.set("image",new Map),this.Qb=(new Map).set("com.apple.streamingkeydelivery",(function(t,n,i){return dE(e,t,n,i)})).set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",(function(e){var t=jT(e,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)){var n="cenc";"SAMPLE-AES"==t&&(n="cbcs"),t=jT(e,"URI"),t=iS(t.split("?")[0]),t=Ne(t.data),n=Gt("com.widevine.alpha",n,[{initDataType:"cenc",initData:t}]),(e=BT(e,"KEYID"))&&n.keyIds.add(e.toLowerCase().substr(2)),e=Promise.resolve(n)}else e=Promise.resolve(null);return e})).set("com.microsoft.playready",(function(e){var t=jT(e,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)){var n="cenc";"SAMPLE-AES"==t&&(n="cbcs"),e=jT(e,"URI"),e=iS(e.split("?")[0]),e=Ne(e.data),t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),t=ha(e,t,new Set,0),n=Gt("com.microsoft.playready",n,[{initDataType:"cenc",initData:t}]),(e=Mn(["<PLAYREADY>",Nt(e),"</PLAYREADY>"].join("\n")))&&(n.licenseServerUri=cy(e)),n=Promise.resolve(n)}else n=Promise.resolve(null);return n})).set("urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c",(function(e){var t=jT(e,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)){var n="cenc";"SAMPLE-AES"==t&&(n="cbcs"),t=jT(e,"URI"),t=iS(t.split("?")[0]),t=Ne(t.data),n=Gt("com.huawei.wiseplay",n,[{initDataType:"cenc",initData:t}]),(e=BT(e,"KEYID"))&&n.keyIds.add(e.toLowerCase().substr(2)),e=Promise.resolve(n)}else e=Promise.resolve(null);return e})),this.Ma=new Set,this.i=new Map,this.l=null,this.C="",this.Fa=new zT,this.K=-1,this.ea=1/0,this.$=this.Sb=this.La=!1,this.B=new ze((function(){e.W&&!e.g.continueLoadingWhenPaused&&(e.T.Ia(e.W,"timeupdate"),e.W.paused)?e.T.qa(e.W,"timeupdate",(function(){return aE(e)})):aE(e)})),this.Da=SE,this.m=null,this.Ka=0,this.o=1/0,this.Ea=this.za=this.P=0,this.Z=new Cs,this.G=new Map,this.H=new Map,this.sa=new Map,this.ka=new Map,this.L=new Map,this.na=new Map,this.oa=new Map,this.Rb=this.fa=!1,this.Nb=new Y(5),this.j=null,this.O=!0,this.ya=new Set,this.T=new ae,this.u=this.W=null,this.Ob=function(){return!1}}function sS(e,t){return oE(e)?e.M.get(t.type):t.le}function aS(e,t){var n,i,r,s,a,o,u,l,c,f,p,g,m,v,y,b,T,S,E,I,R,C,D,M,P,_,O,N,F,B,j,$,G,V,H,K;return U((function(U){switch(U.g){case 1:if(t.stream.isAudioMuxedInVideo)return U.return();for(n=[],i=d(t.N()),r=i.next();!r.done;r=i.next())s=r.value,a=new ve(s),o=a.g,t.Ud&&(0<=t.Ab&&o.add("_HLS_msn",String(t.Ab)),0<=t.Bb&&o.add("_HLS_part",String(t.Bb))),t.Vd&&o.add("_HLS_skip","YES"),Me(o)&&Se(a,Ee(o.toString())),n.push(a.toString());return x(U,2),w(U,sE(e,n,!0).promise,4);case 4:u=U.h,k(U,3);break;case 2:throw l=L(U),e.h&&e.h.disableStream(t.stream),l;case 3:if(!t.stream.segmentIndex)return U.return();if(c=QT(e.Fa,u.data),1!=c.type)throw new je(2,4,4017);return f=u.uri,f==u.originalUri||t.N().includes(f)||t.we.push(f),p=VT(c.ca,"EXT-X-DEFINE"),g=gS(e,p,f),m=t.stream,v=sS(e,t),w(U,GS(e,c,m.mimeType,t.N,g),5);case 5:for(y=U.h,b=y.keyIds,T=y.drmInfos,S=y.encrypted,E=y.Bg,m.encrypted||!S||E||(m.encrypted=!0),I=function(e,t){return e.size===t.size&&[].concat(h(e)).every((function(e){return t.has(e)}))},I(m.keyIds,b)||(m.keyIds=b,m.drmInfos=T,e.h.newDrmInfo(m)),R=ZS(e,c,v,g,t.N,t.type),C=R.segments,(D=R.bandwidth)&&(m.bandwidth=D),M=yc(m),P=d(C),_=P.next();!_.done;_=P.next())O=_.value,O.Y&&(O.Y.Uc=M);m.segmentIndex.yd(C,e.l.nb()),C.length&&(N=WT(c.ca,"EXT-X-MEDIA-SEQUENCE",0),B=(F=KT(c.ca,"EXT-X-SKIP"))?Number(BT(F,"SKIPPED-SEGMENTS")):0,j=jS(N,C),$=j.Ab,G=j.Bb,t.Ab=$+B,t.Bb=G,V=v.get(N),m.segmentIndex.Na(V)),(H=sc(m.segmentIndex))&&(t.zc=H.startTime,K=C[C.length-1],t.Tb=K.endTime),KT(c.ca,"EXT-X-ENDLIST")&&(t.pd=!0),WS(e,c),JS(e,c.ca,m.type,g,t.N),A(U)}}))}function oS(e,t,n){n=void 0!==n&&n;for(var i=-1==e.K,r=d(t),s=r.next();!s.done;s=r.next()){s=s.value;var a=s.stream.segmentIndex,o=sS(e,s);if(a=sc(a)){o=d(o);for(var u=o.next();!u.done;u=o.next()){u=d(u.value);var l=u.next().value;if(u.next().value==a.startTime){i&&(e.K=Math.max(e.K,l)),s.qf=l;break}}}}if(!(0>e.K))for(t=d(t),i=t.next();!i.done;i=t.next())i=i.value,(US(e,i.type)||n)&&(r=i.stream.segmentIndex)&&(s=e.K-i.qf,0<s&&(r.g.splice(0,s),r=sc(r))&&(r=-r.startTime,i.stream.segmentIndex.offset(r),lS(e,i,r)))}function uS(e,t){if(1/0==e.ea){t=d(t);for(var n=t.next();!n.done;n=t.next())n=sc(n.value.stream.segmentIndex),null!=n&&null!=n.h&&(e.ea=Math.min(e.ea,n.h))}if(t=e.ea,1/0!=t){n=d(e.i.values());for(var i=n.next();!i.done;i=n.next())if(i=i.value,!US(e,i.type)){var r=i.stream.segmentIndex;if(null!=r){var s=sc(r);if(s)if(null==s.h)J("Missing EXT-X-PROGRAM-DATE-TIME for stream",i.N(),"Expect AV sync issues!");else for(lS(e,i,s.h-t-s.startTime),i=d(r),r=i.next();!r.done;r=i.next())r.value.qg(t)}}}}function lS(e,t,n){if(!(.001>Math.abs(n))){t.zc+=n,t.Tb+=n,e=sS(e,t);for(var i=d(e),r=i.next();!r.done;r=i.next()){var s=d(r.value);r=s.next().value,s=s.next().value,e.set(r,s+n)}t.N()}}function cS(e,t){var n,i,r,s,a,o,u,l,c,f,p,g,m,v,y,b,T,S,E,x,I,k,L,R,C,D,M,P,_,O,N,F,B,j,$,G,V,H,K,W,q,Y;return U((function(U){switch(U.g){case 1:return n=Yt,i=QT(e.Fa,t),r=VT(i.ca,"EXT-X-DEFINE"),s=[],a=[],o=[],e.l=new Ul(null,0),e.l.Ec(!0),u=function(){return[e.C]},l=null,c=new Map,1==i.type?(e.O=!1,F=VT(i.ca,"EXT-X-DEFINE"),c=gS(e,F,e.C),l=n.la,B="",j=new Map,w(U,BS(e,e.F++,c,i,u,"",l,B,!0,"Media Playlist",null,j,null,!1,null,!1),7)):(pS(e,r),f=VT(i.ca,"EXT-X-MEDIA"),p=VT(i.ca,"EXT-X-STREAM-INF"),g=VT(i.ca,"EXT-X-IMAGE-STREAM-INF"),m=VT(i.ca,"EXT-X-I-FRAME-STREAM-INF"),v=VT(i.ca,"EXT-X-SESSION-KEY"),y=VT(i.ca,"EXT-X-SESSION-DATA"),b=VT(i.ca,"EXT-X-CONTENT-STEERING"),vS(e,y),w(U,yS(e,b),4));case 4:if(!e.g.ignoreSupplementalCodecs){for(T=[],S=d(p),E=S.next(),x={};!E.done;x={Fh:void 0},E=S.next())I=E.value,(k=BT(I,"SUPPLEMENTAL-CODECS"))&&(x.Fh=k.split(/\s*,\s*/).map((function(e){return e.split("/")[0]})),L=I.attributes.map(function(e){return function(t){var n=t.name,i=t.value;return"CODECS"==n&&(i=e.Fh.join(","),t=t.value.split(","),1<t.length&&(t=Kt("audio",t))&&(i+=","+t)),new GT(n,i)}}(x)),T.push(new NT(I.id,I.name,L,null)));for(p.push.apply(p,h(T)),R=[],C=d(m),D=C.next(),M={};!D.done;M={Gh:void 0},D=C.next())P=D.value,(_=BT(P,"SUPPLEMENTAL-CODECS"))&&(M.Gh=_.split(/\s*,\s*/).map((function(e){return e.split("/")[0]})),O=P.attributes.map(function(e){return function(t){var n=t.name;return t=t.value,"CODECS"==n&&(t=e.Gh.join(",")),new GT(n,t)}}(M)),R.push(new NT(P.id,P.name,O,null)));m.push.apply(m,h(R))}return mS(e,p),LS(e,f),N=wS(e,m),w(U,AS(e,p,v,f,u,e.A,N),5);case 5:return s=U.h,a=bS(e,f),w(U,SS(e,g,m),6);case 6:o=U.h,U.s(3);break;case 7:$=U.h,e.i.set(e.C,$),$.stream&&(G=yc($.stream),$.stream.segmentIndex.vb((function(e){e.Y&&(e.Y.Uc=G)}))),l=$.stream.type,s.push({id:0,language:wr(B||"und"),disabledUntilTime:0,primary:!0,audio:"audio"==l?$.stream:null,video:"video"==l?$.stream:null,bandwidth:$.stream.bandwidth||0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!e.h)throw new je(2,7,7001);if(HS(e,i),1==i.type&&(oE(e)&&(qS(e,i),V=e.o,e.B.da(V)),H=Array.from(e.i.values()),NS(e,H),fS(e),JS(e,i.ca,l,c,u)),e.m={presentationTimeline:e.l,variants:s,textStreams:a,imageStreams:o,offlineSessionIds:[],sequenceMode:e.g.hls.sequenceMode,ignoreManifestTimestampsInSegmentsMode:e.g.hls.ignoreManifestTimestampsInSegmentsMode,type:"HLS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:e.u},e.$||!e.g.hls.disableCodecGuessing){U.s(8);break}for(K=[],W=d(e.m.variants),q=W.next();!q.done;q=W.next())Y=q.value,Y.audio&&""===Y.audio.codecs&&K.push(Y.audio.createSegmentIndex()),Y.video&&""===Y.video.codecs&&K.push(Y.video.createSegmentIndex());return w(U,Promise.all(K),8);case 8:e.h.makeTextStreamsForClosedCaptions(e.m),A(U)}}))}function dS(e,t){var n,i,r,s,a,o,u,l,c,h,f,p,g,m,v,y,b;return U((function(T){if(1==T.g)return n=_c(e.g.hls.mediaPlaylistFullMimeType),t.length?(i=nE(e,t),r=i.segment,s=i.segmentIndex,a=r.N(),o=a[0],u=new ve(o),l=u.Za.split(".").pop(),(c=pE.get(l))?T.return(_c(c)):w(T,Promise.all([hS(e,r.Y,0),hS(e,r,s)]),2)):T.return(n);if(h=T.h,f=h[1].mimeType,p=h[0].data,g=h[1].data,m="mp4 mp4a m4s m4i m4a m4f cmfa mp4v m4v cmfv fmp4".split(" "),v=["audio/mp4","video/mp4","video/iso.segment"],qu(Ne(g))){var S=g,E=e.g.disableAudio,A=e.g.disableVideo,x=e.g.disableText,I=Ne(S),k=(new $u).parse(I),L=k.md();I=k.Kf();var R=[],C=!1,D=!1;if(!E)switch(L.audio){case"aac":case"aac-loas":k.cb().length&&(R.push("mp4a.40.2"),C=!0);break;case"mp3":k.cb().length&&(R.push("mp4a.40.34"),C=!0);break;case"ac3":k.cb().length&&(R.push("ac-3"),C=!0);break;case"ec3":k.cb().length&&(R.push("ec-3"),C=!0);break;case"opus":k.cb().length&&(R.push("opus"),C=!0)}if(!A)switch(L.video){case"avc":I.codec?R.push(I.codec):R.push("avc1.42E01E"),D=!0;break;case"hvc":I.codec?R.push(I.codec):R.push("hvc1.1.6.L93.90"),D=!0;break;case"av1":R.push("av01.0.01M.08"),D=!0}if(R.length){if(E=C&&!D,A=new Map,D&&!x){for(x=new ln("video/mp2t"),x.i(S),S=d(x.j()),D=S.next();!D.done;D=S.next())D=D.value,A.set(D,D);x.g()}I={type:E?"audio":"video",mimeType:"video/mp2t",codecs:R.join(", "),language:null,height:I.height,width:I.width,channelCount:null,sampleRate:null,closedCaptions:A,Md:null,colorGamut:null,frameRate:I.frameRate}}else I=null;if(y=I)return T.return(y)}else if((r.Y||m.includes(l)||v.includes(f))&&(b=Oc(p,g,e.g.disableText)))return T.return(b);return f?T.return(_c(f)):T.return(n)}))}function hS(e,t,n){var i,r,s,a,o,u;return U((function(l){switch(l.g){case 1:return t?(i=Gs,r=jc(t.N(),t.cc(),t.ac(),e.g.retryParameters),s=t instanceof uu?1:0,w(l,lE(e,r,i,{type:s}).promise,2)):l.return({mimeType:null,data:null});case 2:if(a=l.h,o=a.data,!t.aesKey){l.s(3);break}return w(l,Bc(o,t.aesKey,n),4);case 4:o=l.h;case 3:return t instanceof uu?t.Jd(o,!0):t.Jd(o),(u=a.headers["content-type"])&&(u=u.split(";")[0].toLowerCase()),l.return({mimeType:u,data:o})}}))}function fS(e){if(oE(e)){if(e.Da==wE){for(var t=1/0,n=1/0,i=d(e.i.values()),r=i.next();!r.done;r=i.next())r=r.value,r.stream.segmentIndex&&"text"!=r.stream.type&&!r.stream.isAudioMuxedInVideo&&(t=Math.min(t,r.Tb),n=Math.min(n,r.zc));t=t-n||0,isNaN(e.g.availabilityWindowOverride)||(t=e.g.availabilityWindowOverride),e.l.De(t)}}else e.l.$a(_S(e));if(!e.l.u)for(t=d(e.i.values()),n=t.next();!n.done;n=t.next())n=n.value,!n.stream.segmentIndex||"audio"!=n.type&&"video"!=n.type||(n=sc(n.stream.segmentIndex))&&n.h&&e.l.wh(n.h);e.l.ke()}function pS(e,t){var n=new ve(e.C).g;t=d(t);for(var i=t.next();!i.done;i=t.next()){var r=i.value;i=BT(r,"NAME");var s=BT(r,"VALUE");r=BT(r,"QUERYPARAM"),i&&s&&(e.A.has(i)||e.A.set(i,s)),r&&(i=n.get(r)[0])&&!e.A.has(i)&&e.A.set(r,i)}}function gS(e,t,n){n=new ve(n).g;var i=new Map;t=d(t);for(var r=t.next();!r.done;r=t.next()){var s=r.value,a=BT(s,"NAME"),o=BT(s,"VALUE");r=BT(s,"QUERYPARAM"),s=BT(s,"IMPORT"),a&&o&&(i.has(a)||i.set(a,o)),r&&(a=n.get(r)[0])&&!i.has(a)&&i.set(r,a),s&&(r=e.A.get(s))&&i.set(s,r)}return i}function mS(e,t){t=d(t);for(var n=t.next();!n.done;n=t.next()){var i=n.value,r=BT(i,"AUDIO");n=BT(i,"VIDEO");var s=BT(i,"SUBTITLES");if(i=IS(e,i),s){var a=Kt(qt,i);e.H.set(s,a),yn(i,a)}r&&(s=Kt("audio",i),s||(s=e.g.hls.defaultAudioCodec),e.H.set(r,s)),n&&(r=Kt("video",i),r||(r=e.g.hls.defaultVideoCodec),e.H.set(n,r))}}function vS(e,t){t=d(t);for(var n=t.next();!n.done;n=t.next()){var i=n.value,r=BT(i,"DATA-ID");n=BT(i,"URI");var s=BT(i,"LANGUAGE");i=BT(i,"VALUE"),r=(new Map).set("id",r),n&&r.set("uri",qT([e.C],n,e.A)[0]),s&&r.set("language",s),i&&r.set("value",i),n=new Is("sessiondata",r),e.h&&e.h.onEvent(n)}}function yS(e,t){var n,i,r,s,a,o;return U((function(u){if(!e.h||!e.g)return u.return();for(i=d(t),r=i.next();!r.done;r=i.next())if(s=r.value,a=BT(s,"PATHWAY-ID"),o=BT(s,"SERVER-URI"),a&&o){e.j=new ob(e.h),e.j.configure(e.g),e.j.i=[e.C],e.j.setManifestType("HLS"),e.j.h=a,n=ub(e.j,o);break}return w(u,n,0)}))}function bS(e,t){var n=HT(t,"SUBTITLES");t=n.map((function(t){if(e.g.disableText)return null;try{return RS(e,[t],new Map).stream}catch(n){if(e.g.hls.ignoreTextStreamFailures)return null;throw n}})),n=d(n);for(var i=n.next();!i.done;i=n.next()){var r=jT(i.value,"GROUP-ID");if((i=e.H.get(r))&&(r=e.I.get(r))){r=d(r);for(var s=r.next();!s.done;s=r.next())s=s.value,s.stream.codecs=i,s.stream.mimeType=eE(qt,i)||tE(qt),TS(s.stream)}}return t.filter((function(e){return e}))}function TS(e){var t=new Set([Wi(e.mimeType,e.codecs)]);e.segmentIndex&&e.segmentIndex.vb((function(n){n.mimeType&&t.add(Wi(n.mimeType,e.codecs))})),e.fullMimeTypes=t}function SS(e,t,n){var i,s;return U((function(a){return 1==a.g?(i=t.map((function(t){var n,i;return U((function(r){if(1==r.g)return e.g.disableThumbnails?r.return(null):(x(r,2),w(r,CS(e,t),4));if(2!=r.g)return n=r.h,r.return(n.stream);if(i=L(r),e.g.hls.ignoreImageStreamFailures)return r.return(null);throw i}))})).concat(n.map((function(t){if(e.g.disableThumbnails)return null;try{var n=DS(e,t);return"image"!==n.stream.type?null:n.stream}catch(r){if(e.g.hls.ignoreImageStreamFailures)return null;throw r}}))),w(a,Promise.all(i),2)):(s=a.h,a.return(s.filter((function(e){return e}))))}))}function ES(e,t,n){t=t.filter((function(e){var t=BT(e,"URI")||"";return e=BT(e,"TYPE"),"SUBTITLES"!=e&&(""!=t||"AUDIO"==e)}));var i={};t=d(t);for(var r=t.next();!r.done;r=t.next()){r=r.value;var s=UT(r,!e.j);i[s]?i[s].push(r):i[s]=[r]}for(var a in i)RS(e,i[a],n,!1)}function wS(e,t){return t.map((function(t){return t=DS(e,t),"video"!==t.stream.type?null:t.stream})).filter((function(e){return e}))}function AS(e,t,n,i,r,s,a){var o,u,l,c,f,p,g,m,v,y,b,T,S,E,A,x,I,k,L,R,C,D,M,P,_,O,N,F,B,j,$,G,V,H,K,W;return U((function(U){switch(U.g){case 1:if(o=[],u=new Set,e.g.ignoreDrmInfo||!(0<n.length)){U.s(2);break}l=d(n),c=l.next();case 3:if(c.done){U.s(2);break}if(f=c.value,p=jT(f,"METHOD"),g=BT(f,"KEYFORMAT")||"identity",m=null,"NONE"==p){U.s(4);break}if(cE(p)){v=qT(r(),jT(f,"URI"),s),y=v.sort().join(""),e.L.has(y)||(b=Os(v,e.g.retryParameters),T=lE(e,b,6).promise,e.L.set(y,T)),U.s(4);break}if("identity"==g)return w(U,hE(e,f,"",r,null,s),12);if(S=e.Qb.get(g),!S){E=null,U.s(10);break}return w(U,S(f,"",null),11);case 11:E=U.h;case 10:m=E,U.s(6);break;case 12:m=U.h;case 6:if(m){if(m.keyIds)for(A=d(m.keyIds),x=A.next();!x.done;x=A.next())I=x.value,u.add(I);o.push(m)}case 4:c=l.next(),U.s(3);break;case 2:for(k={},L=d(t),R=L.next();!R.done;R=L.next())C=R.value,D=UT(C,!e.j),k[D]?k[D].push(C):k[D]=[C];for(P in M=[],k)_=k[P],O=_[0],N=BT(O,"FRAME-RATE"),F=Number(BT(O,"AVERAGE-BANDWIDTH"))||Number(jT(O,"BANDWIDTH")),B=BT(O,"RESOLUTION"),j=d(B?B.split("x"):[null,null]),$=j.next().value,G=j.next().value,V=BT(O,"VIDEO-RANGE"),(H=BT(O,"REQ-VIDEO-LAYOUT"))&&H.includes(",")&&(K=H.split(",").filter((function(e){return"CH-STEREO"==e||"CH-MONO"==e})),H=K[0]),H=H||"CH-MONO",W=xS(e,_,i),M.push.apply(M,h(kS(e,W.audio,W.video,F,$,G,N,V,H,o,u,a)));return U.return(M.filter((function(e){return null!=e})))}}))}function xS(e,t,n){for(var i={audio:[],video:[]},r=new Map,s=[],a=!1,o=!1,u=d(t),l=u.next();!l.done;l=u.next()){var c=l.value;l=BT(c,"AUDIO");var f=BT(c,"VIDEO"),p=l||f;p&&(s.includes(p)||s.push(p),(c=BT(c,"PATHWAY-ID"))&&r.set(p,c),l?a=!0:f&&(o=!0))}s.length&&n.length&&(n=n.filter((function(e){return s.includes(jT(e,"GROUP-ID"))})),ES(e,n,r)),n=(r=s.sort().join(","))&&e.I.has(r)?e.I.get(r):[],a?i.audio.push.apply(i.audio,h(n)):o&&i.video.push.apply(i.video,h(n)),a=!1;var g=t.map((function(e){return jT(e,"URI")}));return l=i.audio.find((function(e){return e&&e.N().find((function(e){return g.includes(e)}))})),o=IS(e,t[0]),n=Kt("video",o),(u=Kt("audio",o))&&!n?(l="audio",a=0<i.audio.length):!i.audio.length&&!i.video.length&&u&&n?(l="video",o=[[n,u].join()]):i.audio.length&&l?(l="audio",a=!0):l=i.video.length&&!i.audio.length?"audio":"video",a||(e=MS(e,t,o,l),r&&(e.stream.groupId=r),i[e.stream.type]=[e]),i}function IS(e,t){return t=BT(t,"CODECS")||"",e.$=0<t.length,e.$||e.g.hls.disableCodecGuessing||(t=[],e.g.disableVideo||t.push(e.g.hls.defaultVideoCodec),e.g.disableAudio||t.push(e.g.hls.defaultAudioCodec),t=t.join(",")),Nc(t.split(/\s*,\s*/))}function kS(e,t,n,i,r,s,a,o,u,l,c,h){for(var f=d(n),p=f.next();!p.done;p=f.next())rE(p.value.stream,r,s,a,o,u,null);for(r=e.g.disableAudio,t.length&&!r||(t=[null]),r=e.g.disableVideo,n.length&&!r||(n=[null]),r=[],t=d(t),s=t.next();!s.done;s=t.next())for(s=s.value,a=d(n),o=a.next();!o.done;o=a.next()){var g=o.value;(o=s?s.stream:null)&&(o.drmInfos=l,o.keyIds=c),(u=g?g.stream:null)&&(u.drmInfos=l,u.keyIds=c,e.g.disableIFrames||is(u,h)),u&&!o&&(u.bandwidth=i),!u&&o&&(o.bandwidth=i),f=s?s.stream.drmInfos:null,p=g?g.stream.drmInfos:null,g=g?g.N().sort().join(","):"";var m=s?s.N().sort().join(","):"",v=[];o&&o.codecs&&v.push(o.codecs),u&&u.codecs&&v.push(u.codecs),g=[g,m,v.sort()].join("-"),o&&u&&!Ve(f,p)||e.Ma.has(g)||(o={id:e.F++,language:o?o.language:"und",disabledUntilTime:0,primary:!!o&&o.primary||!!u&&u.primary,audio:o,video:u,bandwidth:i,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},r.push(o),e.Ma.add(g))}return r}function LS(e,t){t=HT(t,"CLOSED-CAPTIONS"),e.O=0==t.length,t=d(t);for(var n=t.next();!n.done;n=t.next()){var i=n.value,r=BT(i,"LANGUAGE");n=wr(r||"und"),r||(r=BT(i,"NAME"))&&(n=r),r=jT(i,"GROUP-ID"),i=jT(i,"INSTREAM-ID").replace("SERVICE","svc"),e.G.get(r)||e.G.set(r,new Map),e.G.get(r).set(i,n)}}function RS(e,t,n,i){i=void 0===i||i;for(var r=[],s=[],a=new Map,o=d(t),u=o.next();!u.done;u=o.next()){var l=u.value;u=i?jT(l,"URI"):BT(l,"URI")||"shaka://hls-muxed",l=jT(l,"GROUP-ID"),r.push(u),s.push(l),a.set(l,u)}if(i=s.sort().join(","),u=t[0],t="",o=jT(u,"TYPE").toLowerCase(),"subtitles"==o&&(o=qt),o==qt)t=BT(u,"CODECS")||"";else for(s=d(s),l=s.next();!l.done;l=s.next())if(l=l.value,e.H.has(l)){t=e.H.get(l);break}if(s=r.sort().join(","),e.i.has(s))return e.i.get(s);if(l=e.F++,e.j){a=d(a);for(var c=a.next();!c.done;c=a.next()){var h=d(c.value);c=h.next().value,h=h.next().value,(c=n.get(c))&&db(e.j,l,c,h)}}var f;n=BT(u,"LANGUAGE"),a=BT(u,"NAME"),c="YES"==BT(u,"DEFAULT"),h="audio"==o&&(h=BT(u,"CHANNELS"))?parseInt(h.split("/")[0],10):null,"audio"==o&&(f=BT(u,"CHANNELS"))?(f=f.split("/"),f=2==f.length&&("JOC"===f[1]||f[1].includes("ATMOS"))):f=!1;var p=BT(u,"CHARACTERISTICS"),g="YES"==BT(u,"FORCED");return u="audio"==o&&(u=BT(u,"SAMPLE-RATE"))?parseInt(u,10):null,r=PS(e,l,r,t,o,n,c,a,h,null,p,g,u,f),r.stream&&(r.stream.groupId=i),e.I.has(i)?e.I.get(i).push(r):e.I.set(i,[r]),e.i.set(s,r),r}function CS(e,t){var n,i,r,s,a,o,u,l,c,d;return U((function(h){return 1==h.g?(n=jT(t,"URI"),i=BT(t,"CODECS","jpeg")||"",e.i.has(n)?h.return(e.i.get(n)):(r=BT(t,"LANGUAGE"),s=BT(t,"NAME"),a=BT(t,"CHARACTERISTICS"),o=PS(e,e.F++,[n],i,"image",r,!1,s,null,null,a,!1,null,!1),(u=BT(t,"RESOLUTION"))?w(h,o.stream.createSegmentIndex(),3):h.s(2))):(2!=h.g&&(l=sc(o.stream.segmentIndex),c=l.tilesLayout)&&(o.stream.width=Number(u.split("x")[0])*Number(c.split("x")[0]),o.stream.height=Number(u.split("x")[1])*Number(c.split("x")[1])),(d=BT(t,"BANDWIDTH"))&&(o.stream.bandwidth=Number(d)),e.i.set(n,o),h.return(o))}))}function DS(e,t){var n="video",i=jT(t,"URI"),r=BT(t,"CODECS")||"";if("mjpg"==r&&(n="image"),e.i.has(i))return e.i.get(i);var s=BT(t,"LANGUAGE"),a=BT(t,"NAME"),o=BT(t,"CHARACTERISTICS");return n=PS(e,e.F++,[i],r,n,s,!1,a,null,null,o,!1,null,!1),r=BT(t,"RESOLUTION"),s=d(r?r.split("x"):[null,null]),r=s.next().value,s=s.next().value,n.stream.width=Number(r)||void 0,n.stream.height=Number(s)||void 0,(t=BT(t,"BANDWIDTH"))&&(n.stream.bandwidth=Number(t)),e.i.set(i,n),n}function MS(e,t,n,i){for(var r=e.F++,s=[],a=d(t),o=a.next();!o.done;o=a.next()){var u=o.value;o=jT(u,"URI"),u=BT(u,"PATHWAY-ID"),e.j&&u&&db(e.j,r,u,o),s.push(o)}if(a=s.sort().join(",")+n.sort().join(","),e.i.has(a))return e.i.get(a);o=s.join(",");e:{if(t=BT(t[0],"CLOSED-CAPTIONS"),"video"==i){if(e.g.disableText){e.O=!1,t=null;break e}if(t){if("NONE"!=t){t=e.G.get(t);break e}e.O=!1}else if(!t&&e.G.size)for(t=d(e.G.keys()).next();!t.done;){t=e.G.get(t.value);break e}}t=null}return n=Ht(i,n),i=PS(e,r,s,n,i,null,!1,o,null,t,null,!1,null,!1),e.i.set(a,i),i}function PS(e,t,n,i,r,s,a,o,u,l,c,h,f,p){function g(t){var n,g,y,T,S,E,I,R,C,D,M,P,_,O,N,F,B,j,$,G,V,H,K;return U((function(U){switch(U.g){case 1:return n=Yt,x(U,2),w(U,t.promise,4);case 4:if(g=U.h,t.aborted)return U.return();if(y=g.uri,y!=g.originalUri&&(T=b.N(),T.includes(y)||b.we.push(y)),S=QT(e.Fa,g.data),1!=S.type)throw new je(2,4,4017);return E=VT(S.ca,"EXT-X-DEFINE"),I=gS(e,E,y),R=!1,(!e.$&&e.g.hls.disableCodecGuessing||e.O&&r==n.la&&!e.g.hls.disableClosedCaptionsDetection)&&0<S.segments.length&&(e.O=!1,R=!0),C=!e.$&&e.g.hls.disableCodecGuessing,D=oE(e),w(U,BS(e,0,I,S,m,i,r,s,a,o,u,l,c,h,f,p,void 0,R,C),5);case 5:if(M=U.h,t.aborted)return U.return();if(P=M.stream,HS(e,S),oE(e)&&!D&&qS(e,S),b.zc=M.zc,b.Tb=M.Tb,b.Vd=M.Vd,b.Ud=M.Ud,b.pd=M.pd,b.le=M.le,b.Ab=M.Ab,b.Bb=M.Bb,b.Rf=!0,v.segmentIndex=P.segmentIndex,v.encrypted=P.encrypted,v.drmInfos=P.drmInfos,v.keyIds=P.keyIds,v.mimeType=P.mimeType,v.bandwidth=v.bandwidth||P.bandwidth,v.codecs=v.codecs||P.codecs,v.closedCaptions=v.closedCaptions||P.closedCaptions,v.width=v.width||P.width,v.height=v.height||P.height,v.hdr=v.hdr||P.hdr,v.colorGamut=v.colorGamut||P.colorGamut,v.frameRate=v.frameRate||P.frameRate,"und"==v.language&&"und"!=P.language&&(v.language=P.language),v.language=v.language||P.language,v.channelsCount=v.channelsCount||P.channelsCount,v.audioSamplingRate=v.audioSamplingRate||P.audioSamplingRate,TS(v),v.drmInfos.length&&e.h.newDrmInfo(v),_=!1,(!l&&v.closedCaptions||l&&v.closedCaptions&&l.size!=v.closedCaptions.size)&&(_=!0),e.m&&_&&e.h.makeTextStreamsForClosedCaptions(e.m),r==n.la||r==n.V)for(O=d(e.i.values()),N=O.next();!N.done;N=O.next())F=N.value,F.Rf||F.type!=r||(F.stream.mimeType=P.mimeType,TS(F.stream));r==n.va&&(B=sc(P.segmentIndex))&&B.Y&&(v.mimeType="application/mp4",TS(v)),j=yc(v),v.segmentIndex.vb((function(e){e.Y&&(e.Y.Uc=j)})),FS(e)&&(e.Sb?NS(e,[b]):(e.Sb=!0,$=Array.from(e.i.values()),G=$.filter((function(e){return e.stream.segmentIndex})),NS(e,G),fS(e),V=e.o,0<V&&e.B.da(V))),JS(e,S.ca,v.type,I,m),e.m&&(e.m.startTime=e.u),k(U,0);break;case 2:if(H=L(U),v.closeSegmentIndex(),7001===H.code)return U.return();if(K=e.h.disableStream(v),!K)throw H;A(U)}}))}function m(){return e.j&&1<n.length?hb(e.j,t):b.we.concat(YT([e.C],n,e.A))}var v=$S(e,i,r,s,a,o,u,l,c,h,f,p);n.includes("shaka://hls-muxed")&&(v.isAudioMuxedInVideo=!0,v.mimeType="video/mp2t",TS(v));var y,b={stream:v,type:r,we:[],zc:0,Tb:0,le:new Map,Vd:!1,Ud:!1,pd:!1,qf:-1,Ab:-1,Bb:-1,Rf:!1,N:m},T=null;return v.createSegmentIndex=function(){return T||(v.isAudioMuxedInVideo?(v.segmentIndex=new rc([]),Promise.resolve()):(y=sE(e,b.N(),!0),T=new Promise((function(e){e(g(y))}))))},v.closeSegmentIndex=function(){T&&!v.segmentIndex&&y.abort(),v.segmentIndex&&(v.segmentIndex.release(),v.segmentIndex=null),T=null},b}function _S(e){var t=1/0;e=d(e.i.values());for(var n=e.next();!n.done;n=e.next())n=n.value,n.stream.segmentIndex&&"text"!=n.stream.type&&!n.stream.isAudioMuxedInVideo&&(t=Math.min(t,n.Tb));return t}function OS(e,t){var n=[];t=d(t);for(var i=t.next();!i.done;i=t.next())i=i.value,i.segmentIndex&&i.segmentIndex.vb((function(e){n.push(e)}));e.l.Cd(n)}function NS(e,t){if(!oE(e))for(var n=_S(e),i=d(t),r=i.next();!r.done;r=i.next())r.value.stream.segmentIndex.Mc(0,n);OS(e,t.map((function(e){return e.stream}))),i=Array.from(e.i.values()).filter((function(e){return e.stream.segmentIndex})),n=i.some((function(e){return"audio"==e.stream.type})),r=i.some((function(e){return"video"==e.stream.type})),i=oE(e)&&!e.La,n=!oE(e)&&e.La&&!(n&&r),e.g.hls.ignoreManifestProgramDateTime||i||n?oS(e,t,i):(uS(e,t),0<e.g.hls.ignoreManifestProgramDateTimeForTypes.length&&oS(e,t))}function US(e,t){return!!e.g.hls.ignoreManifestProgramDateTime||e.g.hls.ignoreManifestProgramDateTimeForTypes.includes(t)}function FS(e){if(!e.m)return!1;var t=[],n=[];e=d(e.m.variants);for(var i=e.next();!i.done;i=e.next())i=i.value,i.video&&t.push(i.video),i.audio&&n.push(i.audio);return!(0<t.length&&!t.some((function(e){return e.segmentIndex}))||0<n.length&&!n.some((function(e){return e.segmentIndex})))}function BS(e,t,n,i,r,s,a,o,u,l,c,d,h,f,p,g,m,v,y){var b,T,S,E,A,x,I,k,L,R,C,D,M,P,_,O,N,F,B,j,$,G,V,H,K,W,q,Y,X;return v=void 0===v||v,y=void 0===y||y,U((function(t){switch(t.g){case 1:if(b=i.segments||[],T=b.every((function(e){return!!KT(e.ca,"EXT-X-GAP")})),!b.length||T)throw new je(2,4,4053);if(KS(e,i),oE(e)&&WS(e,i),S=oE(e)?e.M.get(a):new Map,E=ZS(e,i,S,n,r,a),A=E.segments,x=E.bandwidth,C=R=L=k=I=null,!(0<A.length&&v)){t.s(2);break}return w(t,dS(e,A),3);case 3:D=t.h,a=D.type,o=D.language,c=D.channelCount,p=D.sampleRate,e.g.disableText||(d=D.closedCaptions),k=D.height,I=D.width,L=D.Md,R=D.colorGamut,C=D.frameRate,y&&(m=D.mimeType,s=D.codecs);case 2:if(m){t.s(4);break}return w(t,iE(e,a,s,A),5);case 5:m=t.h,a!=qt||s||"application/mp4"!=m||!A[0]||A[0].Y||(m="text/vtt");case 4:return w(t,GS(e,i,m,r,n),6);case 6:if(M=t.h,P=M.drmInfos,_=M.keyIds,O=M.encrypted,N=M.Bg,O&&!P.length&&!N)throw new je(2,4,4026);return F=$S(e,s,a,o,u,l,c,d,h,f,p,g),F.encrypted=O&&!N,F.drmInfos=P,F.keyIds=_,F.mimeType=m,x&&(F.bandwidth=x),TS(F),"video"==a&&(I||k||L||R)&&rE(F,I,k,C,L,null,R),oE(e)&&WS(e,i),B=A[0].startTime,j=A[A.length-1],$=j.endTime,G=new rc(A),F.segmentIndex=G,H=!!(V=KT(i.ca,"EXT-X-SERVER-CONTROL"))&&null!=FT(V,"CAN-SKIP-UNTIL"),K=!!V&&null!=FT(V,"CAN-BLOCK-RELOAD"),W=WT(i.ca,"EXT-X-MEDIA-SEQUENCE",0),q=jS(W,A),Y=q.Ab,X=q.Bb,t.return({stream:F,type:a,we:[],N:r,zc:B,Tb:$,Vd:H,Ud:K,pd:!1,qf:-1,Ab:Y,Bb:X,le:S,Rf:!1})}}))}function jS(e,t){e=e+t.length-1;var n=-1;if(!t.length)return e++,{Ab:e,Bb:n};t=t[t.length-1];var i=t.g;return t.g.length?(n=i.length-1,i[i.length-1].isPreload()||(e++,n=0),{Ab:e,Bb:n}):(e++,t.m&&(n=0),{Ab:e,Bb:n})}function $S(e,t,n,i,r,s,a,o,u,l,c,h){var f=eE(n,t)||tE(n),p=[];if(u){u=d(u.split(","));for(var g=u.next();!g.done;g=u.next())p.push(g.value)}return u=void 0,g=null,n==qt?u=p.includes("public.accessibility.transcribes-spoken-dialog")&&p.includes("public.accessibility.describes-music-and-sound")?"caption":"subtitle":p.includes("public.accessibility.describes-video")&&(g="visually impaired"),p.length||"subtitle"!==u||p.push("subtitle"),e={id:e.F++,originalId:s,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:f,codecs:t,kind:n==qt?"subtitle":void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:wr(i||"und"),originalLanguage:i,label:s,type:n,primary:r,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:p,forced:l,channelsCount:a,audioSamplingRate:c,spatialAudio:h,closedCaptions:o,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,accessibilityPurpose:g,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null},TS(e),e}function GS(e,t,n,i,r){var s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,A,x,I,k,L,R,C,D,M,P,_,O;return U((function(N){switch(N.g){case 1:if(s=new Map,!e.g.ignoreDrmInfo&&t.segments)for(a=d(t.segments),o=a.next();!o.done;o=a.next())if(u=o.value,l=VT(u.ca,"EXT-X-KEY"),c=null,l.length)for(c=YS(e,t,u.ca,i,r),h=d(l),f=h.next();!f.done;f=h.next())p=f.value,s.set(p,c);m=g=!1,v=[],y=new Set,b=d(s),T=b.next();case 2:if(T.done){N.s(4);break}if(S=T.value,E=d(S),A=E.next().value,x=E.next().value,I=A,k=x,L=jT(I,"METHOD"),"NONE"==L){N.s(3);break}if(g=!0,R=BT(I,"KEYFORMAT")||"identity",C=null,cE(L)){m=!0,N.s(3);break}if("identity"==R)return w(N,hE(e,I,n,i,k,r),11);if(D=e.Qb.get(R),!D){M=null,N.s(9);break}return w(N,D(I,n,k),10);case 10:M=N.h;case 9:C=M,N.s(6);break;case 11:C=N.h;case 6:if(C){if(C.keyIds)for(P=d(C.keyIds),_=P.next();!_.done;_=P.next())O=_.value,y.add(O);v.push(C)}case 3:T=b.next(),N.s(2);break;case 4:return N.return({drmInfos:v,keyIds:y,encrypted:g,Bg:m})}}))}function VS(t,n,i,r,s){if(!e.crypto||!e.crypto.subtle)throw Z("Web Crypto API is not available to decrypt AES. (Web Crypto only exists in secure origins like https)"),new je(2,4,4042);var a=0,o=BT(n,"IV","");if(o){var u=Ft(o.substr(2));if(16!=u.byteLength)throw new je(2,4,4048)}else a=WT(i.ca,"EXT-X-MEDIA-SEQUENCE",0);var l=qT(r(),jT(n,"URI"),s),c=l.sort().join("");if(i=n.toString()+"-"+a+"-"+c,!t.ka.has(i)){var d={bitsKey:128,blockCipherMode:"CBC",iv:u,firstMediaSequenceNumber:a};switch(jT(n,"METHOD")){case"AES-256":d.bitsKey=256;break;case"AES-256-CTR":d.bitsKey=256,d.blockCipherMode="CTR"}d.fetchKey=function(){var n,i,r,s;return U((function(a){if(1==a.g)return t.L.has(c)||(n=Os(l,t.g.retryParameters),i=lE(t,n,6).promise,t.L.set(c,i)),w(a,t.L.get(c),2);if(3!=a.g){if(r=a.h,!r.data||r.data.byteLength!=d.bitsKey/8)throw new je(2,4,4049);return s={name:"CTR"==d.blockCipherMode?"AES-CTR":"AES-CBC",length:d.bitsKey},w(a,e.crypto.subtle.importKey("raw",r.data,s,!0,["decrypt"]),3)}d.cryptoKey=a.h,d.fetchKey=void 0,A(a)}))},t.ka.set(i,d)}return t.ka.get(i)}function HS(e,t){null==e.u&&(t=KT(t.ca,"EXT-X-START"))&&(e.u=Number(jT(t,"TIME-OFFSET")))}function KS(e,t){var n=KT(t.ca,"EXT-X-PLAYLIST-TYPE");t=KT(t.ca,"EXT-X-ENDLIST"),t=n&&"VOD"==n.value||t,n=n&&"EVENT"==n.value&&!t,n=!t&&!n,uE(e,t?SE:n?wE:EE)}function WS(e,t){var n=1/0,i=t.segments;if(i.length)for(var r=i.length-1;0<=r;){var s=KT(i[r].ca,"EXTINF");if(s){n=Number(s.value.split(",")[0]);break}r--}if(i=KT(t.ca,"EXT-X-TARGETDURATION"),!i)throw new je(2,4,4024,"EXT-X-TARGETDURATION");i=Number(i.value),(r=KT(t.ca,"EXT-X-PART-INF"))&&(e.P=Number(jT(r,"PART-TARGET"))),t=KT(t.ca,"EXT-X-SERVER-CONTROL"),e.fa&&e.P?(e.o=e.Rb?5*e.P<=n?Math.min(e.P,e.o):Math.min(n,e.o):Math.min(e.P,e.o),e.Ea=t?Number(jT(t,"PART-HOLD-BACK")):0):(e.o=Math.min(n,e.o),n=t?FT(t,"HOLD-BACK"):null,e.za=n?Number(n.value):0),e.Ka=Math.max(i,e.Ka)}function qS(e,t){var n=0;if(e.g.defaultPresentationDelay)n=e.g.defaultPresentationDelay;else if(e.Ea)n=e.Ea;else if(e.za)n=e.za;else{var i=t.segments.length,r=e.g.hls.liveSegmentsDelay;for(r>i-2&&(r=Math.max(1,i-2)),r=i-r;r<i;r++){var s=KT(t.segments[r].ca,"EXTINF");n=s?n+Math.ceil(Number(s.value.split(",")[0])):n+e.Ka}}e.u&&0>e.u&&(n=Math.min(-e.u,n),e.u+=n),e.l.xh(0),e.l.jg(n),e.l.Ec(!1)}function YS(e,t,n,i,r){var s=KT(n,"EXT-X-MAP");if(!s)return null;var a=jT(s,"URI"),o=qT(i(),a,r);if(a=[o.toString(),BT(s,"BYTERANGE","")].join("-"),!e.sa.has(a)){var u=void 0,l=null,c=!1;n=d(n);for(var h=n.next();!h.done;h=n.next())h=h.value,"EXT-X-KEY"==h.name?(c=jT(h,"METHOD"),cE(c)&&h.id<s.id?(c=!1,u=VS(e,h,t,i,r)):c="NONE"!=c):"EXT-X-BYTERANGE"==h.name&&h.id<s.id&&(l=h);t=XS(o,s,l,u,c),e.sa.set(a,t)}return e.sa.get(a)}function XS(e,t,n,i,r){var s=0,a=null;return t=BT(t,"BYTERANGE"),!t&&n&&(t=n.value),t&&(s=t.split("@"),a=Number(s[0]),s=Number(s[1]),a=s+a-1,i&&(n=a+1-s,n%16&&(a+=16-n%16))),new au((function(){return e}),s,a,null,null,null,i,r)}function zS(t,n,i,r,s,a,o,u,l){function c(e){e=new ve(e).Za.split(".").pop();var t=bE.get(o).get(e);return t||(t=pE.get(e)),t}var h=r.ca,f=KT(h,"EXTINF"),p=0,g=0,m=null;r.Hb.length&&(t.m.isLowLatency=!0);var v=null;if(!t.g.hls.ignoreManifestProgramDateTime){var y=KT(h,"EXT-X-PROGRAM-DATE-TIME");y&&y.value&&(v=qn(y.value),t.La=!0)}var b=cu;if(KT(h,"EXT-X-GAP")&&(t.m.gapCount++,b=2),!f){if(0==r.Hb.length)throw new je(2,4,4024,"EXTINF");if(!t.fa)return null}var T=[];y=!1;var S=null,E=!1,w=!1;if(t.fa&&r.Hb.length){p=n&&e.ReadableStream&&t.g.hls.allowLowLatencyByteRangeOptimization;for(var A=v,x={},I=0;I<r.Hb.length;x={Me:void 0,te:void 0},I++){var k=r.Hb[I],L=0==I?i:T[T.length-1],R=0==I?s:L.endTime,C=Number(BT(k,"DURATION"))||t.P;if(C){var D=R+C,M=0,P=null;if("EXT-X-PRELOAD-HINT"==k.name?(M=(M=BT(k,"BYTERANGE-START"))?Number(M):0,(L=BT(k,"BYTERANGE-LENGTH"))?P=M+Number(L)-1:M&&(P=Number.MAX_SAFE_INTEGER)):(M=BT(k,"BYTERANGE"),P=d(QS(L,M)),M=P.next().value,P=P.next().value),x.te=BT(k,"URI"),x.te){L=cu,"YES"==BT(k,"GAP")&&(t.m.gapCount++,L=2,E=!0),x.Me=null;var _=function(e){return function(){return null==e.Me&&(e.Me=qT(u(),e.te,a)),e.Me}}(x);p&&0<=M&&null!=P&&(S=_,y=!0),R=new uu(R,D,_,M,P,n,0,0,1/0,[],"",null,A,L,l),"EXT-X-PRELOAD-HINT"==k.name&&(R.Sf(),w=!0),"YES"!=BT(k,"INDEPENDENT")&&0<I&&R.Tc(),(x=c(x.te))&&(R.mimeType=x,TE.has(x)&&(R.Y=null)),T.push(R),A&&(A+=C)}}}}if(f){if(f=Number(f.value.split(",")[0]),0==f)return null;p=s+f}else{if(!T.length)return null;p=T[T.length-1].endTime}y&&(E||0!=T[0].startByte?(y=!1,S=null):T=[]),(f=KT(h,"EXT-X-BYTERANGE"))?(m=d(QS(i,f.value)),g=m.next().value,m=m.next().value):T.length&&(g=T[0].startByte,m=T[T.length-1].endByte),i="",f=null,"image"==o&&(i="1x1",h=KT(h,"EXT-X-TILES"))&&(i=jT(h,"LAYOUT"),(h=BT(h,"DURATION"))&&(f=Number(h)));var O=null;return n=new uu(s,p,(function(){return S?S():(null==O&&(O=qT(u(),r.g,a)),O||[])}),g,m,n,0,0,1/0,T,i,f,v,b,l,0<T.length&&!!r.g),(s=c(r.g))&&(n.mimeType=s,TE.has(s)&&(n.Y=null)),y&&(t.Rb=!0,n.bh(),w&&n.Sf()),n}function QS(e,t){var n=0,i=null;return t&&(n=t.split("@"),t=Number(n[0]),n=n[1]?Number(n[1]):e.endByte+1,i=n+t-1),[n,i]}function JS(e,t,n,i,r){if("video"==n||"audio"==n){var s=e.l.m;if(s&&!US(e,n))for(t=VT(t,"EXT-X-DATERANGE"),t=t.filter((function(e){return null!=FT(e,"START-DATE")})).sort((function(e,t){return e=jT(e,"START-DATE"),t=jT(t,"START-DATE"),e<t?-1:e>t?1:0})),n=0;n<t.length;n++){var a=t[n];try{var o=jT(a,"ID");if(!e.ya.has(o)){var u=jT(a,"START-DATE"),l=qn(u);if(!isNaN(l)){var c=Math.max(0,l-s),h=null,f=BT(a,"END-DATE");if(f){var p=qn(f);if(!isNaN(p)&&(h=p-s,0>h))continue}if(null==h){var g=BT(a,"DURATION")||BT(a,"PLANNED-DURATION");if(g){var m=parseFloat(g);if(isNaN(m)||(h=c+m),0>l-s+m)continue}}var v=BT(a,"CLASS")||"com.apple.quicktime.HLS",y="YES"==BT(a,"END-ON-NEXT");if(null==h&&y){for(var b=n+1;b<t.length;b++){var T=BT(t[b],"CLASS")||"com.apple.quicktime.HLS";if(v==T){var S=jT(t[b],"START-DATE"),E=qn(S);if(!isNaN(E)&&E&&E>l){h=Math.max(0,E-s);break}}}if(null==h)continue}b=["CLASS","START-DATE","END-DATE","DURATION","END-ON-NEXT"];for(var w=[],A=d(a.attributes),x=A.next();!x.done;x=A.next()){var I=x.value;if(!b.includes(I.name)){var k=XT(I.value,i);"X-ASSET-URI"!=I.name&&"X-ASSET-LIST"!=I.name||(k=qT(r(),I.value,i)[0]),w.push({key:I.name,description:"",data:k,mimeType:null,pictureType:null})}}1<w.length&&e.h.onMetadata(v,c,h,w),e.ya.add(o)}}}catch(L){}}}}function ZS(e,t,n,i,r,s){var a=t.segments,o=void 0,u=WT(t.ca,"EXT-X-DISCONTINUITY-SEQUENCE",-1),l=WT(t.ca,"EXT-X-MEDIA-SEQUENCE",0),c=KT(t.ca,"EXT-X-SKIP"),h=c?Number(BT(c,"SKIPPED-SEGMENTS")):0,f=l+h,p=0;oE(e)&&n.has(f)&&(p=n.get(f)),0===p&&e.Da==wE&&0<n.size&&!n.has(f)&&null!=e.l.i&&(p=e.l.nb());var g=[],m=null;c=[];for(var v=0;v<a.length;v++){var y=a[v],b=0==v?p:m.endTime;f=l+h+v,KT(y.ca,"EXT-X-DISCONTINUITY")&&(u++,m&&m.Y&&(m.Y.g=b));for(var T=d(y.ca),S=T.next();!S.done;S=T.next())S=S.value,"EXT-X-KEY"==S.name&&(o=cE(jT(S,"METHOD"))?VS(e,S,t,r,i):void 0);n.set(f,b),T=YS(e,t,y.ca,r,i),(b=zS(e,T,m,y,b,i,s,r,o))&&((m=WT(y.ca,"EXT-X-BITRATE"))?c.push({bitrate:m,duration:b.endTime-b.startTime}):c.length&&(m=c.pop(),m.duration+=b.endTime-b.startTime,c.push(m)),m=b,b.i=u,US(e,s)&&null!=e.K&&f<e.K||g.push(b))}if(t=void 0,c.length&&(t=c.reduce((function(e,t){return e+t.duration}),0),t=Math.round(c.reduce((function(e,t){return e+t.bitrate*t.duration}),0)/t*1e3)),c=g.some((function(e){return null!=e.h})))for(n={},i=0;i<g.length;n={Zd:void 0,Yd:void 0,Rd:void 0,Bc:void 0,Qd:void 0},i++)if(n.Bc=g[i],null==n.Bc.h)for(n.Yd=0,n.Zd=i,r=function(e){return function(){var t=g[e.Zd];if(t){if(null!=t.h)return t.h+e.Yd;e.Yd-=t.endTime-t.startTime,e.Zd+=1}return null}}(n),n.Qd=0,n.Rd=i,a=function(e){return function(){var t=g[e.Rd];if(t){if(t!=e.Bc&&(e.Qd+=t.endTime-t.startTime),null!=t.h)return t.h+e.Qd;--e.Rd}return null}}(n);null==n.Bc.h;)n.Bc.h=a(),null==n.Bc.h&&(n.Bc.h=r());if(c)for(n=d(g),i=n.next();!i.done;i=n.next())for(r=i.value,i=r.h,r=d(r.g),a=r.next();!a.done;a=r.next())a=a.value,a.h=i,i+=a.endTime-a.startTime;if(n=e.ea,c&&1/0!=n&&!US(e,s))for(e=d(g),s=e.next();!s.done;s=e.next())s.value.qg(n);return{segments:g,bandwidth:t}}function eE(e,t){if(e==qt){if("vtt"==t||"wvtt"==t)return"text/vtt";if(t&&""!==t)return"application/mp4"}return"image"!=e||t&&"jpeg"!=t?"audio"==e&&"mp4a.40.34"==t?"audio/mpeg":"mjpg"==t?"application/mp4":null:"image/jpeg"}function tE(e){return e==qt?"text/vtt":bE.get(e).get("mp4")}function nE(e,t){e=oE(e)?Math.trunc((t.length-1)/2):0;for(var n=t[e];2==n.dc()&&e+1<t.length;)e++,n=t[e];return{segment:n,segmentIndex:e}}function iE(e,t,n,i){var r,s,a,o,u,l,c,d,h,f,p,g,m;return U((function(v){switch(v.g){case 1:return r=Gs,s=nE(e,i),a=s.segment,2==a.status?v.return(tE(t)):(o=a.N(),u=new ve(o[0]),l=u.Za.split(".").pop(),c=bE.get(t),(d=c.get(l))||(d=pE.get(l))||(d=eE(t,n))?v.return(d):(f=1,p=Os(o,e.g.retryParameters),x(v,2),p.method="HEAD",w(v,lE(e,p,r,{type:f}).promise,4)));case 4:g=v.h,h=g.headers["content-type"],k(v,3);break;case 2:if(m=L(v),!m||1002!=m.code&&1001!=m.code){v.s(3);break}return p.method="GET",e.g.hls.allowRangeRequestsToGuessMimeType&&(p.headers.Range="bytes=0-0"),w(v,lE(e,p,r,{type:f}).promise,6);case 6:g=v.h,h=g.headers["content-type"];case 3:if(!h){v.s(7);break}if(d=h.toLowerCase().split(";")[0],"application/octet-stream"!=d){v.s(8);break}if(g.data.byteLength){v.s(9);break}return p.method="GET",w(v,lE(e,p,r,{type:f}).promise,10);case 10:g=v.h;case 9:qu(Ne(g.data))&&(d="video/mp2t");case 8:if("application/octet-stream"!=d)return v.return(d);case 7:return v.return(tE(t))}}))}function rE(e,t,n,i,r,s,a){e&&(e.width=Number(t)||void 0,e.height=Number(n)||void 0,e.frameRate=Number(i)||void 0,e.hdr=r||void 0,e.videoLayout=s||void 0,e.colorGamut=a||void 0)}function sE(e,t,n){return lE(e,Os(t,e.g.retryParameters),0,{type:n?2:3})}function aE(e){var t,n,i,r,s,a;return U((function(o){switch(o.g){case 1:return e.h?(x(o,2),t=Date.now(),w(o,e.update(),4)):o.return();case 4:n=Date.now(),oE(e)&&(i=(n-t)/1e3,e.Nb.sample(1,i),r=0<e.g.updatePeriod?e.g.updatePeriod:e.o,s=Math.max(0,r-X(e.Nb)),e.B.da(s)),k(o,3);break;case 2:if(a=L(o),!e.h)return o.return();if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.h.onError(a),o.return();a.severity=1,e.h.onError(a),e.B.da(.1);case 3:if(!e.h)return o.return();e.h.onManifestUpdated(),A(o)}}))}function oE(e){return e.Da!=SE}function uE(e,t){e.Da=t,e.l&&e.l.Ec(!oE(e)),oE(e)||e.B.stop()}function lE(e,t,n,i){if(!e.Z)throw new je(2,7,7001);return i||(i={}),i.isPreload=e.Ob(),t=e.h.networkingEngine.request(n,t,i),Ds(e.Z,t),t}function cE(e){return"AES-128"==e||"AES-256"==e||"AES-256-CTR"==e}function dE(t,n,i,r){var s,a,o,u,l,c;return U((function(d){if(1==d.g){if("video/mp2t"==i)throw new je(2,4,4040);if("apple"===e.shakaMediaKeysPolyfill)throw new je(2,4,4041);if(s=jT(n,"METHOD"),a=["SAMPLE-AES","SAMPLE-AES-CTR"],!a.includes(s))return d.return(null);o="cenc","SAMPLE-AES"==s&&(o="cbcs"),u=jT(n,"URI"),l=Gt("com.apple.fps",o,[{initDataType:"sinf",initData:new Uint8Array(0),keyId:null}],u);var h=new ve(u).lb.replace(/-/g,"").toLowerCase();return(c=32===h.length&&/^[0-9a-f]+$/.test(h)?h:null)||!r?d.s(2):w(d,fE(t,r),3)}return 2!=d.g&&(c=d.h),c&&l.keyIds.add(c),d.return(l)}))}function hE(t,n,i,r,s,a){var o,u,l,c,d,h,f,p,g,m,v,y;return U((function(b){switch(b.g){case 1:if("video/mp2t"==i)throw new je(2,4,4040);if("apple"===e.shakaMediaKeysPolyfill)throw new je(2,4,4041);if(o=jT(n,"METHOD"),u=["SAMPLE-AES","SAMPLE-AES-CTR"],!u.includes(o))return b.return(null);if(l=qT(r(),jT(n,"URI"),a),l[0].startsWith("data:text/plain;base64,")){c=Bt(Ut(l[0].split("data:text/plain;base64,").pop())),b.s(2);break}return d=l.sort().join(""),t.na.has(d)||(h=Os(l,t.g.retryParameters),f=lE(t,h,6).promise,t.na.set(d,f)),w(b,t.na.get(d),3);case 3:p=b.h,c=Bt(p.data);case 2:if(g="00000000000000000000000000000000",!s){b.s(4);break}return w(b,fE(t,s),5);case 5:(m=b.h)&&(g=m);case 4:return v=new Map,v.set(g,c),y="cenc","SAMPLE-AES"==o&&(y="cbcs"),b.return(Vt(v,y))}}))}function fE(e,t){var n,i,r,s;return U((function(a){return 1==a.g?(n=null,e.oa.has(t)?(n=e.oa.get(t),a.s(2)):(i=jc(t.N(),t.cc(),t.ac(),e.g.retryParameters),r=Gs,w(a,lE(e,i,r,{type:0}).promise,3))):(2!=a.g&&(s=a.h,t.Jd(s.data),n=Fc(s.data),e.oa.set(t,n)),a.return(n))}))}K("shaka.net.DataUriPlugin",tS),tS.parse=nS,Ps("data",nS),i=rS.prototype,i.configure=function(e,t){var n=this.h&&e.updatePeriod!=this.g.updatePeriod&&0<=e.updatePeriod;this.g=e,t&&(this.Ob=t),this.j&&this.j.configure(this.g),n&&this.m&&this.m.presentationTimeline.U()&&this.B.qb()},i.start=function(e,t){var n,i=this;return U((function(r){return 1==r.g?(i.h=t,i.fa=t.isLowLatencyMode(),w(r,sE(i,[e]).promise,2)):3!=r.g?(n=r.h,i.C=n.uri,w(r,cS(i,n.data),3)):r.return(i.m)}))},i.stop=function(){this.B&&(this.B.stop(),this.B=null);var e=[];return this.Z&&(e.push(this.Z.destroy()),this.Z=null),this.g=this.h=null,this.Ma.clear(),this.m=null,this.i.clear(),this.I.clear(),this.H.clear(),this.A.clear(),this.sa.clear(),this.ka.clear(),this.L.clear(),this.na.clear(),this.oa.clear(),this.ya.clear(),this.j&&this.j.destroy(),this.T&&(this.T.release(),this.T=null),Promise.all(e)},i.update=function(){var e,t,n,i,r,s,a,o,u,l,c,f,p=this;return U((function(g){if(1==g.g){if(!oE(p))return g.return();for(e=[],t=Array.from(p.i.values()),p.o=1/0,p.m.gapCount=0,n=t.filter((function(e){return e.stream.segmentIndex})),i=d(n),r=i.next();!r.done;r=i.next())s=r.value,e.push(aS(p,s));return w(g,Promise.all(e),2)}for(OS(p,n.map((function(e){return e.stream}))),a=n.some((function(e){return 0==e.pd})),n.length&&!a&&(o=AE,uE(p,o.Oh),u=n.map((function(e){return e.Tb})),p.l.$a(Math.min.apply(Math,h(u))),p.h.updateDuration()),a&&fS(p),l=d(n),c=l.next();!c.done;c=l.next())f=c.value,f.stream.isAudioMuxedInVideo||!f.stream.segmentIndex||sc(f.stream.segmentIndex)||p.h.disableStream(f.stream);A(g)}))},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(){},i.banLocation=function(e){this.j&&this.j.banLocation(e)},i.setMediaElement=function(e){this.W=e},K("shaka.hls.HlsParser",rS);var pE=(new Map).set("aac","audio/aac").set("ac3","audio/ac3").set("ec3","audio/ec3").set("mp3","audio/mpeg"),gE=(new Map).set("mp4","audio/mp4").set("mp4a","audio/mp4").set("m4s","audio/mp4").set("m4i","audio/mp4").set("m4a","audio/mp4").set("m4f","audio/mp4").set("cmfa","audio/mp4").set("ts","video/mp2t").set("tsa","video/mp2t"),mE=(new Map).set("mp4","video/mp4").set("mp4v","video/mp4").set("m4s","video/mp4").set("m4i","video/mp4").set("m4v","video/mp4").set("m4f","video/mp4").set("cmfv","video/mp4").set("ts","video/mp2t").set("tsv","video/mp2t"),vE=(new Map).set("mp4","application/mp4").set("m4s","application/mp4").set("m4i","application/mp4").set("m4f","application/mp4").set("cmft","application/mp4").set("vtt","text/vtt").set("webvtt","text/vtt").set("ttml","application/ttml+xml"),yE=(new Map).set("jpg","image/jpeg").set("png","image/png").set("svg","image/svg+xml").set("webp","image/webp").set("avif","image/avif"),bE=(new Map).set("audio",gE).set("video",mE).set("text",vE).set("image",yE),TE=new Set(["video/mp2t"].concat(h(rr))),SE="VOD",EE="EVENT",wE="LIVE",AE={Oh:SE,Zj:EE,gk:wE};function xE(e){return cy(e)}fo("application/x-mpegurl",(function(){return new rS})),fo("application/vnd.apple.mpegurl",(function(){return new rS}));var IE=(new Map).set("com.microsoft.playready",xE).set("com.microsoft.playready.recommendation",xE).set("com.microsoft.playready.software",xE).set("com.microsoft.playready.hardware",xE);function kE(){var e=this;this.h=this.g=null,this.l=[],this.j=null,this.u=1,this.i=null,this.C=new Y(5),this.o=new ze((function(){LE(e)})),this.B=new Cs,this.m=new Map,this.A=function(){return!1}}function LE(e){var t;U((function(n){switch(n.g){case 1:return x(n,2),w(n,RE(e),4);case 4:k(n,3);break;case 2:t=L(n),e.h&&(t.severity=1,e.h.onError(t));case 3:if(!e.h)return n.return();A(n)}}))}function RE(e){var t,n,i,r,s,a,o;return U((function(u){if(1==u.g)return t=Os(e.l,e.g.retryParameters),n=e.h.networkingEngine,i=Date.now(),r=n.request(0,t,{type:5,isPreload:e.A()}),Ds(e.B,r),w(u,r.promise,2);if(s=u.h,!e.h)return u.return();s.uri&&!e.l.includes(s.uri)&&e.l.unshift(s.uri);var l=s.uri,c=s.data,f=e.g.mss.manifestPreprocessor;if(f!=Qd){if(he("manifest.mss.manifestPreprocessor configuration","Please Use manifest.mss.manifestPreprocessorTXml instead."),c=zb(c,"SmoothStreamingMedia"),!c)throw new je(2,4,4046,l);f(c),c=Rt(c.outerHTML)}var p=Dn(c,"SmoothStreamingMedia");if(!p)throw new je(2,4,4046,l);if(l=e.g.mss.manifestPreprocessorTXml,l!=Jd&&l(p),e.i||(e.i=new Ul(null,0)),l=Vn(p,"IsLive",ei,!1))throw new je(2,4,4047);e.i.Ec(!l),f=Vn(p,"TimeScale",Jn,1e7),c=Vn(p,"DVRWindowLength",Jn),l&&(0===c||isNaN(c))&&(c=1/0);var g,m=Vn(p,"CanSeek",ei,!1);for(0===c&&m&&(c=1/0),m=null,c&&0<c&&(m=c/f),l&&!isNaN(e.g.availabilityWindowOverride)&&(m=e.g.availabilityWindowOverride),null==m&&(m=1/0),e.i.De(m),c=Vn(p,"Duration",Jn,1/0),l||e.i.$a(c/f),l={variants:[],textStreams:[],timescale:f,duration:c/f},m=Un(p,"Protection"),f=e.g.mss.keySystemsBySystemId,c=[],m=d(m),g=m.next();!g.done;g=m.next())c=c.concat(Un(g.value,"ProtectionHeader"));if(c.length){for(m=[],g=0;g<c.length;g++){var v=c[g],y=v.attributes.SystemID.toLowerCase(),b=f[y];if(b){var T;e:{if(T=ly(v)){T=d(jn(T,"DATA"));for(var S=T.next();!S.done;S=T.next())if(S=$n(S.value,"KID")){T=Ut(Fn(S)),T=new Uint8Array([T[3],T[2],T[1],T[0],T[5],T[4],T[7],T[6]].concat(h(T.slice(8)))),T=Bt(T);break e}}T=null}S=Ut(Fn(v)),y=Ft(y.replace(/-/g,"")),y=[{initData:ha(S,y,new Set,0),initDataType:"cenc",keyId:T}],y=Gt(b,"cenc",y),T&&y.keyIds.add(T),(b=IE.get(b))&&(y.licenseServerUri=b(v)),m.push(y)}}f=m}else f=[];for(g=f,m=[],f=[],c=[],p=Un(p,"StreamIndex"),p=d(p),v=p.next();!v.done;v=p.next()){v=v.value,b=Un(v,"QualityLevel"),y=l.timescale,T=l.duration,S=Un(v,"c");for(var E=[],x=0,I=0;I<S.length;++I){var k=S[I],L=S[I+1],R=Vn(k,"t",Jn),C=Vn(k,"d",Jn);if(k=Vn(k,"r",zn),!C)break;if(R=null!=R?R:x,(k=k||0)&&k--,0>k)if(L){if(L=Vn(L,"t",Jn),null==L)break;if(R>=L)break;k=Math.ceil((L-R)/C)-1}else{if(1/0==T)break;if(R/y>=T)break;k=Math.ceil((T*y-R)/C)-1}for(L=0;L<=k;++L)x=R+C,E.push({start:R/y,end:x/y,xg:R}),R=x}for(y=E,b=d(b),T=b.next();!T.done;T=b.next())(T=CE(e,v,T.value,y,g,l))&&("audio"!=T.type||e.g.disableAudio?"video"!=T.type||e.g.disableVideo?T.type!=qt||e.g.disableText||c.push(T):f.push(T):m.push(T))}for(p=[],m=d(0<m.length?m:[null]),g=m.next();!g.done;g=m.next())for(g=g.value,v=d(0<f.length?f:[null]),E=v.next();!E.done;E=v.next())b=p,y=b.push,T=e,S=g,E=E.value,I=0,S&&S.bandwidth&&0<S.bandwidth&&(I+=S.bandwidth),E&&E.bandwidth&&0<E.bandwidth&&(I+=E.bandwidth),T={id:T.u++,language:S?S.language:"und",disabledUntilTime:0,primary:!!S&&S.primary||!!E&&E.primary,audio:S,video:E,bandwidth:I,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},y.call(b,T);l.variants=p,l.textStreams=c,e.j?(e.j.variants=l.variants,e.j.textStreams=l.textStreams,e.h.filter(e.j)):(e.j={presentationTimeline:e.i,variants:l.variants,textStreams:l.textStreams,imageStreams:[],offlineSessionIds:[],sequenceMode:e.g.mss.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"MSS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:null},e.i.ke()),Promise.resolve(),a=Date.now(),o=(a-i)/1e3,e.C.sample(1,o),A(u)}))}function CE(e,t,n,i,r,s){var a=t.attributes.Type;if("audio"!==a&&"video"!==a&&"text"!==a)return Z("Ignoring unrecognized type:",a),null;var o=t.attributes.Language,u=e.u++,l=Vn(n,"Bitrate",Qn),c=Vn(n,"MaxWidth",Qn),d=Vn(n,"MaxHeight",Qn),h=Vn(n,"Channels",Qn),f=Vn(n,"SamplingRate",Qn),p=s.duration;i.length&&(p=i[i.length-1].end-i[0].start);var g=e.i.getDuration();e.i.$a(Math.min(p,g));var m={id:u,originalId:t.attributes.Name||String(u),groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:"",codecs:"",frameRate:void 0,pixelAspectRatio:void 0,bandwidth:l||0,width:c||void 0,height:d||void 0,kind:"",encrypted:0<r.length,drmInfos:r,keyIds:new Set,language:wr(o||"und"),originalLanguage:o,label:"",type:"",primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:[],roles:[],forced:!1,channelsCount:h,audioSamplingRate:f,spatialAudio:!1,closedCaptions:null,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,matchedStreams:[],mssPrivateData:{duration:p,timescale:s.timescale,codecPrivateData:null},accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null};if((r=t.attributes.Subtype)&&((r=NE.get(r))&&m.roles.push(r),"main"===r&&(m.primary=!0)),r=n.attributes.FourCC,null!==r&&""!==r||(r=t.attributes.FourCC),!r)if("audio"===a)r="AAC";else if("video"===a)return Z('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null;if(!OE.includes(r.toUpperCase()))return Z("Codec not supported:",r),null;switch(n=DE(n,a,r,m),m.mssPrivateData.codecPrivateData=n,a){case"audio":if(!n)return Z("Quality unsupported without CodecPrivateData",a),null;m.type="audio",m.mimeType="mss/audio/mp4",m.codecs=ME(r,n);break;case"video":if(!n)return Z("Quality unsupported without CodecPrivateData",a),null;m.type="video",m.mimeType="mss/video/mp4",m.codecs=PE(n);break;case"text":m.type=qt,m.mimeType="application/mp4",("TTML"===r||"DFXP"===r)&&(m.codecs="stpp")}return m.fullMimeTypes.add(Wi(m.mimeType,m.codecs)),m.createSegmentIndex=function(){if(m.segmentIndex)return Promise.resolve();if(e.m.has(m.id))var n=e.m.get(m.id);else n=[],"video"==m.type&&(n=m.mssPrivateData.codecPrivateData.split("00000001").slice(1)),n={id:m.id,type:m.type,codecs:m.codecs,encrypted:m.encrypted,timescale:m.mssPrivateData.timescale,duration:m.mssPrivateData.duration,jb:n,ra:new Uint8Array([]),Ba:new Uint8Array([]),Ha:0,Ja:0,data:null,stream:m},n=ko(new Io([n])),e.m.set(m.id,n);return n=_E(e,new au((function(){return[]}),0,null,yc(m),m.mssPrivateData.timescale,n,null,m.encrypted),m,t,i),m.segmentIndex=new rc(n),Promise.resolve()},m.closeSegmentIndex=function(){m.segmentIndex&&(m.segmentIndex.release(),m.segmentIndex=null)},m}function DE(e,t,n,i){if(e=e.attributes.CodecPrivateData)return e;if("audio"!==t)return null;t=i.channelsCount||2,e=i.audioSamplingRate||44100;var r={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12};return i=r[e],"AACH"===n?(n=new Uint8Array(4),e=r[2*e],n[0]=40|i>>1,n[1]=i<<7|t<<3|e>>1,n[2]=e<<7|8,n[3]=0,t=new Uint16Array(2),t[0]=(n[0]<<8)+n[1],t[1]=(n[2]<<8)+n[3],t[0].toString(16)+t[1].toString(16)):(n=new Uint8Array(2),n[0]=16|i>>1,n[1]=i<<7|t<<3,t=new Uint16Array(1),t[0]=(n[0]<<8)+n[1],t[0].toString(16))}function ME(e,t){var n=0;return"AACH"===e&&(n=5),t?0===n&&(n=(248&parseInt(t.substr(0,2),16))>>3):(n=2,"AACH"===e&&(n=5)),"mp4a.40."+n}function PE(e){var t=/00000001[0-9]7/.exec(e);return t.length&&e?"avc1."+e.substr(e.indexOf(t[0])+10,6):""}function _E(e,t,n,i,r){var s=i.attributes.Url.replace("{bitrate}",String(n.bandwidth));i=[],r=d(r);for(var a=r.next(),o={};!a.done;o={Ge:void 0},a=r.next())o.Ge=a.value,i.push(new uu(o.Ge.start,o.Ge.end,function(t){return function(){return $t(e.l,[s.replace("{start time}",String(t.Ge.xg))])}}(o),0,null,t,0,0,n.mssPrivateData.duration));return i}i=kE.prototype,i.configure=function(e,t){this.g=e,t&&(this.A=t)},i.start=function(e,t){var n=this;return U((function(i){if(1==i.g)return n.l=[e],n.h=t,w(i,RE(n),2);if(!n.h)throw new je(2,7,7001);return i.return(n.j)}))},i.stop=function(){return this.g=this.h=null,this.l=[],this.j=null,null!=this.o&&(this.o.stop(),this.o=null),this.m.clear(),this.B.destroy()},i.update=function(){var e,t=this;return U((function(n){return 1==n.g?(x(n,2),w(n,RE(t),4)):2!=n.g?k(n,0):(e=L(n),t.h&&e?(t.h.onError(e),void A(n)):n.return())}))},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(){},i.banLocation=function(){},i.setMediaElement=function(){},K("shaka.mss.MssParser",kE);var OE="AAC AACL AACH AACP AVC1 H264 TTML DFXP".split(" "),NE=(new Map).set("CAPT","main").set("SUBT","alternate").set("DESC","main");function UE(e,t,n,i,r,s,a){if(200<=n&&299>=n&&202!=n||304==n)return{uri:r||i,originalUri:i,data:t,status:n,headers:e,fromCache:!!e["x-shaka-from-cache"],originalRequest:s};s=null;try{s=Lt(t)}catch(o){}throw new je(401==n||403==n?2:1,1,1001,i,n,s,e,a,r||i)}function FE(){}function BE(e,t,n,i,r,s){var a=new WE;Xs(t.headers).forEach((function(e,t){a.append(t,e)}));var o=new HE,u={Gg:!1,Ih:!1};if(e=jE(e,t,n,{body:t.body||void 0,headers:a,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},u,i,r,t.streamDataCallback,s.minBytesForProgressEvents||0),e=new bs(e,(function(){return u.Gg=!0,o.abort(),Promise.resolve()})),t=t.retryParameters.timeout){var l=new ze((function(){u.Ih=!0,o.abort()}));l.da(t/1e3),e.finally((function(){l.stop()}))}return e}function jE(e,t,n,i,r,s,a,o,u){var l,c,d,h,f,p,g,m,v,y,b,T,S,E;return U((function(I){switch(I.g){case 1:return l=VE,c=KE,h=new ArrayBuffer(0),p=f=0,g=Date.now(),x(I,2),w(I,l(e,i),4);case 4:if(d=I.h,a($E(d.headers)),"HEAD"==i.method){I.s(5);break}return v=(m=d.headers.get("Content-Length"))?parseInt(m,10):0,d.body?(y=d.clone().body.getReader(),b=function(e){function t(){var n,i,r,a;return U((function(l){switch(l.g){case 1:return x(l,2),w(l,y.read(),4);case 4:n=l.h,k(l,3);break;case 2:return L(l),l.return();case 3:if(n.done){l.s(5);break}if(f+=n.value.byteLength,!o){l.s(5);break}return w(l,o(n.value),5);case 5:i=Date.now(),r=f-p,(100<i-g&&r>=u||n.done)&&(a=n.done?0:v-f,s(i-g,r,a),p=f,g=i),n.done?e.close():(e.enqueue(n.value),t()),A(l)}}))}t()},new c({start:b}),w(I,d.arrayBuffer(),8)):w(I,d.arrayBuffer(),9);case 8:h=I.h,I.s(5);break;case 9:h=I.h,T=Date.now(),s(T-g,h.byteLength,0);case 5:k(I,3);break;case 2:if(S=L(I),r.Gg)throw new je(1,1,7001,e,n);if(r.Ih)throw new je(1,1,1003,e,n);throw new je(1,1,1002,e,S,n);case 3:return E=$E(d.headers),I.return(UE(E,h,d.status,e,d.url,t,n))}}))}function $E(e){var t={};return e.forEach((function(e,n){t[n.trim()]=e})),t}function GE(){if(!e.ReadableStream)return!1;try{new ReadableStream({})}catch(LL){return!1}return!!e.Response&&(!!new Response("").body&&!(!e.fetch||"polyfill"in e.fetch||!e.AbortController))}fo("application/vnd.ms-sstr+xml",(function(){return new kE})),K("shaka.net.HttpFetchPlugin",FE),FE.isSupported=GE,FE.parse=BE;var VE=e.fetch,HE=e.AbortController,KE=e.ReadableStream,WE=e.Headers;function qE(){}function YE(e,t,n,i,r,s){var a=new zE,o=Date.now(),u=0,l=new Promise((function(l,c){a.open(t.method,e,!0),a.responseType="arraybuffer",a.timeout=t.retryParameters.timeout,a.withCredentials=t.allowCrossSiteCredentials,a.onabort=function(){c(new je(1,1,7001,e,n))};var d=!1;for(var h in a.onreadystatechange=function(){if(2==a.readyState&&!d){var e=XE(a);r(e),d=!0}},a.onload=function(r){var s=XE(a),d=a.response;try{i(Date.now()-o,r.loaded-u,0);var h=UE(s,d,a.status,e,a.responseURL,t,n);l(h)}catch(f){c(f)}},a.onerror=function(t){c(new je(1,1,1002,e,t,n))},a.ontimeout=function(){c(new je(1,1,1003,e,n))},a.onprogress=function(e){var t=Date.now(),n=s.minBytesForProgressEvents||0,r=e.loaded-u;(100<t-o&&r>=n||e.lengthComputable&&e.loaded==e.total)&&(i(t-o,r,4==a.readyState?0:e.total-e.loaded),u=e.loaded,o=t)},t.headers)a.setRequestHeader(h.toLowerCase(),t.headers[h]);a.send(t.body)}));return new bs(l,(function(){return a.abort(),Promise.resolve()}))}function XE(e){var t=e.getAllResponseHeaders().trim().split("\r\n");e={},t=d(t);for(var n=t.next();!n.done;n=t.next())n=n.value.split(": "),e[n[0].toLowerCase()]=n.slice(1).join(": ");return e}GE()&&(Ps("http",BE,2,!0),Ps("https",BE,2,!0),Ps("blob",BE,2,!0)),K("shaka.net.HttpXHRPlugin",qE),qE.parse=YE;var zE=e.XMLHttpRequest;function QE(e,t,n,i,r){this.g=e,this.i=t,this.groupId=n,this.h=i,this.j=r}function JE(e){var t=e.Gb(!1);return t?Nt(t):e.N().map((function(e){return"{"+encodeURI(e.split("#xywh=")[0])+"}"})).join("")+":"+e.startByte+":"+e.endByte}function ZE(e,t){return jc(e.g.N(),e.g.startByte,e.g.endByte,t.streaming.retryParameters)}function ew(){this.g=this.j=this.i=0,this.h=new Map,this.l=0}function tw(e,t){e.i+=t;var n=e.l;return e.l++,e.h.set(n,t),n}function nw(e){return 0==e.i?0:e.j/e.i}function iw(e){var t=this;this.u=e,this.i=new Map,this.h=new Ks((function(){return sw(t).catch((function(){}))})),this.j=[],this.o=function(){},this.m=function(){},this.g=new ew,this.l=!1}function rw(e,t,n){e.o=t,e.m=n}function sw(e){e.l=!0;var t=e.j.map((function(e){return e()}));return e.j=[],Promise.all(t)}function aw(e,t,n,i,r,s){Ws(e.h);var a=(e.i.get(t)||Promise.resolve()).then((function(){var t,a,o,u,l,c,d;return U((function(h){if(1==h.g)return w(h,lw(e,n),2);if(t=h.h,e.h.g)throw new je(2,9,7001);if(r)for(u in a=Ne(t),o=new da(a),o.data)l=Number(u),c=o.data[l],d=o.g[l],e.m(c,d);return e.g.close(i,t.byteLength),e.o(nw(e.g),e.g.g),h.return(s(t))}))}));e.i.set(t,a)}function ow(e,t,n,i,r,s){Ws(e.h);var a=(e.i.get(t)||Promise.resolve()).then((function(){if(e.h.g)throw new je(2,9,7001);if(r){var t=Ne(n);for(var a in t=new da(t),t.data){var o=Number(a);e.m(t.data[o],t.g[o])}}return e.g.close(i,n.byteLength),e.o(nw(e.g),e.g.g),s(n)}));e.i.set(t,a)}function uw(e){return U((function(t){return 1==t.g?w(t,Promise.all(e.i.values()),2):t.return(e.g.g)}))}function lw(e,t){var n,i,r,s;return U((function(a){return 1==a.g?(n=Gs,i=e.u.request(n,t),r=function(){return i.abort()},e.j.push(r),w(a,i.promise,2)):(s=a.h,yn(e.j,r),a.return(s.data))}))}function cw(e,t){var n=this;this.i=e,this.h=e.objectStore(t),this.g=new ys,e.onabort=function(e){e.preventDefault(),n.g.reject()},e.onerror=function(e){e.preventDefault(),n.g.reject()},e.oncomplete=function(){n.g.resolve()}}function dw(e,t){return new Promise((function(n,i){var r=e.h.openCursor();r.onerror=i,r.onsuccess=function(){var e;return U((function(i){if(1==i.g)return null==r.result?(n(),i.return()):(e=r.result,w(i,t(e.key,e.value,e),2));e.continue(),A(i)}))}}))}function hw(e){this.h=e,this.g=[]}function fw(e,t){return pw(e,t,"readwrite")}function pw(e,t,n){n=e.h.transaction([t],n);var i=new cw(n,t);return e.g.push(i),i.promise().then((function(){yn(e.g,i)}),(function(){yn(e.g,i)})),i}function gw(e,t,n){this.h=new hw(e),this.i=t,this.g=n}function mw(e,t,n){e=fw(e.h,e.g);var i=e.store();return i.get(t).onsuccess=function(){i.put(n,t)},e.promise()}function vw(e){return Promise.reject(new je(2,9,9011,"Cannot add new value to "+e))}function yw(e,t,n,i){e=fw(e.h,t),t=e.store(),n=d(n);for(var r=n.next(),s={};!r.done;s={Qf:void 0},r=n.next())s.Qf=r.value,t.delete(s.Qf).onsuccess=function(e){return function(){return i(e.Qf)}}(s);return e.promise()}function bw(e,t,n){var i,r,s,a,o,u,l;return U((function(c){if(1==c.g){for(i=pw(e.h,t,"readonly"),r=i.store(),s={},a=[],o=d(n),u=o.next(),l={};!u.done;l={xe:void 0,ge:void 0},u=o.next())l.ge=u.value,l.xe=r.get(l.ge),l.xe.onsuccess=function(e){return function(){void 0==e.xe.result&&a.push(e.ge),s[e.ge]=e.xe.result}}(l);return w(c,i.promise(),2)}if(a.length)throw new je(2,9,9012,"Could not find values for "+a);return c.return(n.map((function(e){return s[e]})))}))}function Tw(e){this.g=new hw(e)}function Sw(){this.g=new Map}function Ew(e){var t=null;if(e.g.forEach((function(e,n){e.getCells().forEach((function(e,i){e.hasFixedKeySpace()||t||(t={path:{zb:n,Qa:i},Qa:e})}))})),t)return t;throw new je(2,9,9013,"Could not find a cell that supports add-operations")}function ww(e,t){e.g.forEach((function(e,n){e.getCells().forEach((function(e,i){t({zb:n,Qa:i},e)}))}))}function Aw(e,t,n){if(e=e.g.get(t),!e)throw new je(2,9,9013,"Could not find mechanism with name "+t);if(t=e.getCells().get(n),!t)throw new je(2,9,9013,"Could not find cell with name "+n);return t}function xw(e,t){e.g.forEach((function(e){t(e.getEmeSessionCell())}))}function Iw(e){var t=Array.from(e.g.keys());if(!t.length)throw new je(2,9,9e3,"No supported storage mechanisms found");return e.g.get(t[0]).getEmeSessionCell()}function kw(e){var t,n,i;return U((function(r){return 1==r.g?(t=Array.from(e.g.values()),n=0<t.length,n||(i=Rw,i.forEach((function(e){(e=e())&&t.push(e)}))),w(r,Promise.all(t.map((function(e){return e.erase()}))),2)):n?r.s(0):w(r,Promise.all(t.map((function(e){return e.destroy()}))),0)}))}function Lw(e,t){Rw.set(e,t)}Ps("http",YE,1,!0),Ps("https",YE,1,!0),Ps("blob",YE,1,!0),ew.prototype.close=function(e,t){if(this.h.has(e)){var n=this.h.get(e);this.h.delete(e),this.j+=n,this.g+=t}},iw.prototype.destroy=function(){return this.h.destroy()},cw.prototype.abort=function(){var e=this;return U((function(t){if(1==t.g){try{e.i.abort()}catch(n){}return x(t,2),w(t,e.g,4)}if(2!=t.g)return k(t,0);L(t),A(t)}))},cw.prototype.store=function(){return this.h},cw.prototype.promise=function(){return this.g},hw.prototype.destroy=function(){return Promise.all(this.g.map((function(e){return e.abort()})))},i=gw.prototype,i.destroy=function(){return this.h.destroy()},i.hasFixedKeySpace=function(){return!0},i.addSegments=function(){return vw(this.i)},i.removeSegments=function(e,t){return yw(this,this.i,e,t)},i.getSegments=function(e){var t,n=this;return U((function(i){return 1==i.g?w(i,bw(n,n.i,e),2):(t=i.h,i.return(t.map((function(e){return n.Ig(e)}))))}))},i.addManifests=function(){return vw(this.g)},i.updateManifest=function(){return Promise.reject(new je(2,9,9016,"Cannot modify values in "+this.g))},i.updateManifestExpiration=function(e,t){var n=fw(this.h,this.g),i=n.store();return i.get(e).onsuccess=function(n){(n=n.target.result)&&(n.expiration=t,i.put(n,e))},n.promise()},i.removeManifests=function(e,t){return yw(this,this.g,e,t)},i.getManifests=function(e){var t,n=this;return U((function(i){return 1==i.g?w(i,bw(n,n.g,e),2):(t=i.h,i.return(Promise.all(t.map((function(e){return n.gd(e)})))))}))},i.getAllManifests=function(){var e,t,n=this;return U((function(i){return 1==i.g?(e=pw(n.h,n.g,"readonly"),t=new Map,w(i,dw(e,(function(e,i){var r;return U((function(s){if(1==s.g)return w(s,n.gd(i),2);r=s.h,t.set(e,r),A(s)}))})),2)):3!=i.g?w(i,e.promise(),3):i.return(t)}))},i.Ig=function(e){return e},i.gd=function(e){return Promise.resolve(e)},i.add=function(e,t){var n,i,r,s,a,o,u,l=this;return U((function(c){if(1==c.g){for(n=fw(l.h,e),i=n.store(),r=[],s=d(t),a=s.next(),o={};!a.done;o={cg:void 0},a=s.next())u=a.value,o.cg=i.add(u),o.cg.onsuccess=function(e){return function(){r.push(e.cg.result)}}(o);return w(c,n.promise(),2)}return c.return(r)}))},Tw.prototype.destroy=function(){return this.g.destroy()},Tw.prototype.getAll=function(){var e,t,n=this;return U((function(i){return 1==i.g?(e=pw(n.g,"session-ids","readonly"),t=[],w(i,dw(e,(function(e,n){t.push(n)})),2)):3!=i.g?w(i,e.promise(),3):i.return(t)}))},Tw.prototype.add=function(e){var t=fw(this.g,"session-ids"),n=t.store();e=d(e);for(var i=e.next();!i.done;i=e.next())n.add(i.value);return t.promise()},Tw.prototype.remove=function(e){var t,n=this;return U((function(i){return 1==i.g?(t=fw(n.g,"session-ids"),w(i,dw(t,(function(t,n,i){e.includes(n.sessionId)&&i.delete()})),2)):w(i,t.promise(),0)}))},Sw.prototype.destroy=function(){for(var e=[],t=d(this.g.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.g.clear(),Promise.all(e)},Sw.prototype.init=function(){var e=this;Rw.forEach((function(t,n){(t=t())&&e.g.set(n,t)}));for(var t=[],n=d(this.g.values()),i=n.next();!i.done;i=n.next())t.push(i.value.init());return Promise.all(t)},K("shaka.offline.StorageMuxer",Sw),Sw.unregister=function(e){Rw.delete(e)},Sw.register=Lw,Sw.prototype.destroy=Sw.prototype.destroy;var Rw=new Map;function Cw(){gw.apply(this,arguments)}function Dw(e,t){_w(e);for(var n=d(e.streams),i=n.next();!i.done;i=n.next());return e.streams.map((function(n){return Mw(n,e.startTime,t)}))}function Mw(e,t,n){var i=e.initSegmentUri?Pw(e.initSegmentUri):null,r=t+e.presentationTimeOffset,s=t+n;return{id:e.id,originalId:null,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,initSegmentKey:i,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(e){var n=Pw(e.uri);return{startTime:t+e.startTime,endTime:t+e.endTime,dataKey:n,initSegmentKey:i,appendWindowStart:t,appendWindowEnd:s,timestampOffset:r,tilesLayout:"",mimeType:null,codecs:null,thumbnailSprite:null}})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}}function Pw(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new je(2,9,9004,"Could not parse uri "+e)}function _w(e){var t=e.streams.filter((function(e){return"audio"==e.contentType}));if(e=e.streams.filter((function(e){return"video"==e.contentType})),!t.every((function(e){return e.variantIds}))||!e.every((function(e){return e.variantIds}))){for(var n=d(t),i=n.next();!i.done;i=n.next())i.value.variantIds=[];for(n=d(e),i=n.next();!i.done;i=n.next())i.value.variantIds=[];if(n=0,e.length&&!t.length){i=n++;for(var r=d(e),s=r.next();!s.done;s=r.next())s.value.variantIds.push(i)}if(!e.length&&t.length)for(i=n++,r=d(t),s=r.next();!s.done;s=r.next())s.value.variantIds.push(i);if(e.length&&t.length)for(t=d(t),i=t.next();!i.done;i=t.next())for(i=i.value,r=d(e),s=r.next();!s.done;s=r.next()){s=s.value;var a=n++;i.variantIds.push(a),s.variantIds.push(a)}}}function Ow(){gw.apply(this,arguments)}function Nw(e,t,n){return{id:e.id,originalId:e.originalId,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(i){return{startTime:t+i.startTime,endTime:t+i.endTime,initSegmentKey:e.initSegmentKey,appendWindowStart:t,appendWindowEnd:n,timestampOffset:t-e.presentationTimeOffset,dataKey:i.dataKey,tilesLayout:"",mimeType:null,codecs:null,thumbnailSprite:null}})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}}function Uw(){gw.apply(this,arguments)}function Fw(){this.m=this.j=this.i=this.h=this.g=this.l=null}function Bw(){var t=new ys,n=e.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new je(2,9,9001,n.error)),e.preventDefault()},t}function jw(e,t,n,i){this.g=e,this.i=t,this.h=n,this.l=i,this.j=["offline:",e,"/",t,"/",n,"/",i].join("")}function $w(e){if(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e),null==e)return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var i=e[3];return i&&null!=t?new jw(t,n,i,Number(e[4])):null}function Gw(e,t){this.h=e,this.g=t}function Vw(e,t){var n=new Ul(null,0);n.$a(t.duration);var i=t.streams.filter((function(e){return"audio"==e.type})),r=t.streams.filter((function(e){return"video"==e.type}));i=Hw(e,i,r,n),r=t.streams.filter((function(e){return e.type==qt})).map((function(t){return Kw(e,t,n)}));var s=t.streams.filter((function(e){return"image"==e.type})).map((function(t){return Kw(e,t,n)})),a=t.drmInfo?[t.drmInfo]:[];if(t.drmInfo)for(var o=d(i.values()),u=o.next();!u.done;u=o.next())u=u.value,u.audio&&u.audio.encrypted&&(u.audio.drmInfos=a),u.video&&u.video.encrypted&&(u.video.drmInfos=a);return{presentationTimeline:n,offlineSessionIds:t.sessionIds,variants:Array.from(i.values()),textStreams:r,imageStreams:s,sequenceMode:t.sequenceMode||!1,ignoreManifestTimestampsInSegmentsMode:!1,type:t.type||"UNKNOWN",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:null}}function Hw(e,t,n,i){for(var r=new Set,s=d(t),a=s.next();!a.done;a=s.next()){a=d(a.value.variantIds);for(var o=a.next();!o.done;o=a.next())r.add(o.value)}for(s=d(n),a=s.next();!a.done;a=s.next())for(a=d(a.value.variantIds),o=a.next();!o.done;o=a.next())r.add(o.value);for(s=new Map,r=d(r),a=r.next();!a.done;a=r.next())a=a.value,s.set(a,{id:a,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(t=d(t),r=t.next();!r.done;r=t.next())for(a=r.value,r=Kw(e,a,i),a=d(a.variantIds),o=a.next();!o.done;o=a.next())o=s.get(o.value),o.language=r.language,o.primary=o.primary||r.primary,o.audio=r;for(n=d(n),t=n.next();!t.done;t=n.next())for(r=t.value,t=Kw(e,r,i),r=d(r.variantIds),a=r.next();!a.done;a=r.next())a=s.get(a.value),a.primary=a.primary||t.primary,a.video=t;return s}function Kw(e,t,n){var i=t.segments.map((function(n){return Ww(e,n,t)}));return n.Cd(i),{id:t.id,originalId:t.originalId,groupId:t.groupId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new rc(i),mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate,pixelAspectRatio:t.pixelAspectRatio,hdr:t.hdr,colorGamut:t.colorGamut,videoLayout:t.videoLayout,kind:t.kind,encrypted:t.encrypted,drmInfos:[],keyIds:t.keyIds,language:t.language,originalLanguage:t.originalLanguage||null,label:t.label,type:t.type,primary:t.primary,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:t.roles,forced:t.forced,channelsCount:t.channelsCount,audioSamplingRate:t.audioSamplingRate,spatialAudio:t.spatialAudio,closedCaptions:t.closedCaptions,tilesLayout:t.tilesLayout,mssPrivateData:t.mssPrivateData,accessibilityPurpose:null,external:t.external,fastSwitching:t.fastSwitching,fullMimeTypes:new Set([Wi(t.mimeType,t.codecs)]),isAudioMuxedInVideo:!1,baseOriginalId:null}}function Ww(e,t,n){var i=new jw("segment",e.h,e.g,t.dataKey);return e=new uu(t.startTime,t.endTime,(function(){return[i.toString()]}),0,null,null!=t.initSegmentKey?qw(e,t.initSegmentKey):null,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd,[],t.tilesLayout||""),e.mimeType=t.mimeType||n.mimeType||"",e.codecs=t.codecs||n.codecs||"",t.thumbnailSprite&&e.Ee(t.thumbnailSprite),e}function qw(e,t){var n=new jw("segment",e.h,e.g,t);return new au((function(){return[n.toString()]}),0,null)}function Yw(){this.g=null}function Xw(){}function zw(e,t){var n=$w(e);return n&&"manifest"==n.g?(e={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"},originalRequest:t},e=Es(e)):e=n&&"segment"==n.g?Qw(n.key(),n,t):Ts(new je(2,1,9004,e)),e}function Qw(e,t,n){var i=new Sw;return Es(void 0).Ga((function(){return i.init()})).Ga((function(){return Aw(i,t.zb(),t.Qa())})).Ga((function(e){return e.getSegments([t.key()])})).Ga((function(e){return{uri:t,data:e[0].data,headers:{},originalRequest:n}})).finally((function(){return i.destroy()}))}function Jw(e,t,n){var i,r,s,a,o,u;return U((function(l){switch(l.g){case 1:i=[];for(var c=[],h=d(n),f=h.next();!f.done;f=h.next()){f=f.value;for(var p=!1,g=d(c),m=g.next();!m.done;m=g.next())if(m=m.value,eA(m.info,f)){m.sessionIds.push(f.sessionId),p=!0;break}p||c.push({info:f,sessionIds:[f.sessionId]})}r=d(c),s=r.next();case 2:if(s.done){l.s(4);break}return a=s.value,o=Zw(e,t,a),w(l,o,5);case 5:u=l.h,i=i.concat(u),s=r.next(),l.s(2);break;case 4:return l.return(i)}}))}function Zw(e,t,n){var i,r;return U((function(s){switch(s.g){case 1:return i=new fa({Vb:t,onError:function(){},re:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),x(s,2),i.configure(e),w(s,va(i,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:k(s,3);break;case 2:return L(s),w(s,i.destroy(),5);case 5:return s.return([]);case 3:return r=[],w(s,Promise.all(n.sessionIds.map((function(e){return U((function(t){return 1==t.g?(x(t,2),w(t,Ea(i,e),4)):2!=t.g?(r.push(e),k(t,0)):(L(t),void A(t))}))}))),6);case 6:return w(s,i.destroy(),7);case 7:return s.return(r)}}))}function eA(e,t){function n(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&bn(e.audioCapabilities,t.audioCapabilities,n)&&bn(e.videoCapabilities,t.videoCapabilities,n)}function tA(e,t,n){var i=t.presentationTimeline.getDuration();return t=iA(t),{offlineUri:null,originalManifestUri:e,duration:i,size:0,expiration:1/0,tracks:t,appMetadata:n,isIncomplete:!1}}function nA(e,t){var n=Vw(new Gw(e.zb(),e.Qa()),t),i=t.appMetadata||{};return n=iA(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:i,isIncomplete:t.isIncomplete||!1}}function iA(e){var t=[],n=es(e.variants);n=d(n);for(var i=n.next();!i.done;i=n.next())t.push(qr(i.value));for(e=d(e.textStreams),n=e.next();!n.done;n=e.next())t.push(Yr(n.value));return t}function rA(){this.g=new Map}function sA(e,t){var n=t.audio,i=t.video;if(n&&!i&&e.g.set(n.id,n.bandwidth||t.bandwidth),!n&&i&&e.g.set(i.id,i.bandwidth||t.bandwidth),n&&i){var r=n.bandwidth||393216,s=i.bandwidth||t.bandwidth-r;0>=s&&(s=t.bandwidth),e.g.set(n.id,r),e.g.set(i.id,s)}}function aA(e,t){e.g.set(t.id,t.bandwidth||2048)}function oA(e,t){return e=e.g.get(t),null==e&&(e=0),e}function uA(e){var t=this;if(e&&e.constructor!=Cf)throw new je(2,9,9008);this.g=this.h=null,e?(this.h=e.g,this.g=e.xb()):(this.h=qd(),this.g=new Ms),this.i=[],this.l=[];var n=!e;this.j=new Ks((function(){var e,i,r,s,a;return U((function(o){switch(o.g){case 1:return w(o,Promise.all(t.l.map((function(e){return sw(e)}))),2);case 2:for(e=function(){},i=[],r=d(t.i),s=r.next();!s.done;s=r.next())a=s.value,i.push(a.then(e,e));return w(o,Promise.all(i),3);case 3:if(!n){o.s(4);break}return w(o,t.g.destroy(),4);case 4:t.h=null,t.g=null,A(o)}}))})),this.m=1e9}function lA(){if(Qe())e:{for(var e=d(Rw.values()),t=e.next();!t.done;t=e.next())if(t=t.value,t=t()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function cA(e,t,n,i,r,s,a,o){var u,l,c,h,f,p,g,m,v,y,b,T,S,E,A,I,k,D,M,P,_,O,N,F;return U((function(U){switch(U.g){case 1:return _A(),l=u=null,c=new Sw,p=f=h=null,x(U,2,3),w(U,s(),5);case 5:return u=U.h,w(U,xA(e,t,u,a),6);case 6:if(g=U.h,PA(e),m=!g.presentationTimeline.U()&&!g.presentationTimeline.wc(),!m)throw new je(2,9,9005,t);v=d(i),y=v.next();case 7:if(y.done){U.s(9);break}return b=y.value,w(U,IA(e,b,g),10);case 10:T=U.h,g.imageStreams.push(T),PA(e),y=v.next(),U.s(7);break;case 9:S=d(r),E=S.next();case 11:return E.done?(qa(a.drm.clearKeys,g.variants),k=g.variants.some((function(e){if(e.audio)for(var t=d(e.audio.drmInfos),n=t.next();!n.done;n=t.next())if(n.value.licenseServerUri.startsWith("data:"))return!0;if(e.video)for(e=d(e.video.drmInfos),t=e.next();!t.done;t=e.next())if(t.value.licenseServerUri.startsWith("data:"))return!0;return!1})),D=a.offline.usePersistentLicense,k&&(D=!1),w(U,e.Jc(g,(function(e){p=p||e}),a,D),15)):(A=E.value,w(U,kA(e,g,A.uri,A.language,A.kind,A.mime,A.codecs),14));case 14:I=U.h,g.textStreams.push(I),PA(e),E=S.next(),U.s(11);break;case 15:if(l=U.h,PA(e),p)throw p;return w(U,pA(g,l,a,D),16);case 16:return w(U,c.init(),17);case 17:return PA(e),w(U,Ew(c),18);case 18:return h=U.h,PA(e),M=gA(l,g,t,n,a,o,D),P=M.Yi,_=M.tg,w(U,h.Qa.addManifests([P]),19);case 19:if(O=U.h,PA(e),f=O[0],PA(e),p)throw p;return w(U,dA(e,_,f,P,o,a,h.Qa,g,l,D),20);case 20:return PA(e),yA(g,P,l,D),w(U,h.Qa.updateManifest(f,P),21);case 21:return PA(e),N=new jw("manifest",h.path.zb,h.path.Qa,f),U.return(nA(N,P));case 3:return R(U),w(U,c.destroy(),22);case 22:if(!u){U.s(23);break}return w(U,u.stop(),23);case 23:if(!l){U.s(25);break}return w(U,l.destroy(),25);case 25:C(U,0);break;case 2:if(F=L(U),null==f){U.s(27);break}return w(U,hA(f),27);case 27:throw p||F}}))}function dA(e,t,n,i,r,s,a,o,u,l){var c,h,f,p,g,m,v,y,b,T,S;return U((function(E){switch(E.g){case 1:if(c={},h=0,f=function(){if(e.j.g||r.l)throw new je(2,9,7001)},p=function(e,t){var p,g,m,v,y,b,T,S,E;return U((function(x){if(1==x.g){for(p=d(e),g=p.next(),m={};!g.done;m={Lb:void 0},g=p.next())m.Lb=g.value,f(),v=ZE(m.Lb,s),y=m.Lb.i,b=m.Lb.h,T=function(e){return function(t){var n,i,r,s;return U((function(o){switch(o.g){case 1:if(n=e.Lb.g,i=n.Gb(!1),!n.aesKey||i){o.s(2);break}return w(o,Bc(t,n.aesKey,e.Lb.j),3);case 3:t=o.h;case 2:return r=JE(n),w(o,a.addSegments([{data:t}]),4);case 4:s=o.h,f(),c[r]=s[0],h+=t.byteLength,A(o)}}))}}(m),S=m.Lb.g,(E=S.Gb(!1))?ow(r,m.Lb.groupId,E,y,b,T):aw(r,m.Lb.groupId,v,y,b,T);return w(x,uw(r),2)}return f(),!t||r.l?x.s(0):(yA(o,i,u,l),w(x,a.updateManifest(n,i),0))}))},g=!1,x(E,2),!mA(o)||!g||vA(o)){E.s(4);break}return w(E,p(t.filter((function(e){return e.h})),!0),5);case 5:return f(),t=t.filter((function(e){return!e.h})),m=c,v=h,c={},h=0,w(E,fA(a,n,i,m,v,(function(){return PA(e)})),6);case 6:f();case 4:if(g){E.s(7);break}return w(E,p(t,!1),8);case 8:return f(),y=c,b=h,c={},h=0,w(E,fA(a,n,i,y,b,(function(){return f()})),9);case 9:f();case 7:k(E,0);break;case 2:return T=L(E),S=Object.values(c),w(E,a.removeSegments(S,(function(){})),10);case 10:throw T}}))}function hA(e){var t,n,i,r;return U((function(s){switch(s.g){case 1:return t=new Sw,w(s,t.init(),2);case 2:return w(s,Ew(t),3);case 3:return n=s.h,i=new jw("manifest",n.path.zb,n.path.Qa,e),w(s,t.destroy(),4);case 4:return r=new uA,w(s,r.remove(i.toString()),0)}}))}function fA(e,t,n,i,r,s){var a,o,u,l,c,h,f,p,g,m,v;return U((function(y){switch(y.g){case 1:for(a=!1,x(y,2),o=!0,u=d(n.streams),l=u.next();!l.done;l=u.next())for(c=l.value,h=d(c.segments),f=h.next();!f.done;f=h.next())p=f.value,g=p.pendingSegmentRefId?i[p.pendingSegmentRefId]:null,null!=g&&(p.dataKey=g,p.pendingSegmentRefId=void 0),g=p.pendingInitSegmentRefId?i[p.pendingInitSegmentRefId]:null,null!=g&&(p.initSegmentKey=g,p.pendingInitSegmentRefId=void 0),p.pendingSegmentRefId&&(o=!1),p.pendingInitSegmentRefId&&(o=!1);return n.size+=r,o&&(n.isIncomplete=!1),w(y,e.updateManifest(t,n),4);case 4:a=!0,s(),k(y,0);break;case 2:return m=L(y),w(y,hA(t),5);case 5:if(a){y.s(6);break}return v=Object.values(i),w(y,e.removeSegments(v,(function(){})),6);case 6:throw m}}))}function pA(e,t,n,i){var r,s,a,o,u,l,c,h,f,p,g,m,v,y,b,T,S,E,I,R,C,D,M,P,_,O,N,F,B,j;return U((function(U){switch(U.g){case 1:return r={width:1/0,height:1/0},Mr(e,n.restrictions,r),w(U,Or(t,e,i,n.drm.preferredKeySystems,n.drm.keySystemsMapping),2);case 2:for(s=[],a=n.preferredDecodingAttributes,o=n.preferredVideoCodecs,u=n.preferredAudioCodecs,l=n.preferredTextFormats,Cr(e,o,u,a,l),c=d(e.variants),h=c.next();!h.done;h=c.next())f=h.value,s.push(qr(f));for(p=d(e.textStreams),g=p.next();!g.done;g=p.next())m=g.value,s.push(Yr(m));for(v=d(e.imageStreams),y=v.next();!y.done;y=v.next())b=y.value,s.push(Xr(b));return w(U,n.offline.trackSelectionCallback(s),3);case 3:for(T=U.h,S=e.presentationTimeline.getDuration(),E=0,I=d(T),R=I.next();!R.done;R=I.next())C=R.value,D=C.bandwidth*S/8,E+=D;return x(U,4),w(U,n.offline.downloadSizeCallback(E),6);case 6:if(M=U.h,!M)throw new je(2,9,9014);k(U,5);break;case 4:if(P=L(U),P instanceof je)throw P;throw new je(2,9,9015);case 5:for(_=new Set,O=new Set,N=new Set,F=d(T),B=F.next();!B.done;B=F.next())j=B.value,"variant"==j.type&&_.add(j.id),"text"==j.type&&O.add(j.id),"image"==j.type&&N.add(j.id);e.variants=e.variants.filter((function(e){return _.has(e.id)})),e.textStreams=e.textStreams.filter((function(e){return O.has(e.id)})),e.imageStreams=e.imageStreams.filter((function(e){return N.has(e.id)})),jA(e),A(U)}}))}function gA(e,t,n,i,r,s,a){var o=tA(n,t,i),u=r.offline.progressCallback;rw(s,(function(e,t){o.size=t,u(o,e)}),(function(t,n){l&&a&&c==n&&Aa(e,"cenc",t)}));var l=mA(t)&&!vA(t),c=null;l&&(c=$A.get(e.h.keySystem));for(var h=new rA,f=d(t.textStreams),p=f.next();!p.done;p=f.next())h.g.set(p.value.id,52);for(f=d(t.imageStreams),p=f.next();!p.done;p=f.next())aA(h,p.value);for(f=d(t.variants),p=f.next();!p.done;p=f.next())sA(h,p.value);return s=CA(s,h,t,r),r=s.streams,s=s.tg,(h=e.h)&&a&&(h.initData=[]),{Yi:{creationTime:Date.now(),originalManifestUri:n,duration:t.presentationTimeline.getDuration(),size:0,expiration:e.nd(),streams:r,sessionIds:a?xa(e):[],drmInfo:h,appMetadata:i,isIncomplete:!0,sequenceMode:t.sequenceMode,type:t.type},tg:s}}function mA(e){return e.variants.some((function(e){var t=e.audio&&e.audio.encrypted;return e.video&&e.video.encrypted||t}))}function vA(e){return e.variants.some((function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]).some((function(e){return e.initData&&e.initData.length}))}))}function yA(e,t,n,i){if(t.expiration=n.nd(),n=xa(n),t.sessionIds=i?n:[],mA(e)&&i&&!n.length)throw new je(2,9,9007)}function bA(e,t){var n,i,r,s,a,o;return U((function(u){switch(u.g){case 1:if(_A(),n=$w(t),null==n||"manifest"!=n.g)throw new je(2,9,9004,t);return i=n,r=new Sw,I(u,2),w(u,r.init(),4);case 4:return w(u,Aw(r,i.zb(),i.Qa()),5);case 5:return s=u.h,w(u,s.getManifests([i.key()]),6);case 6:return a=u.h,o=a[0],w(u,Promise.all([SA(e,o,r),EA(s,i,o)]),2);case 2:return R(u),w(u,r.destroy(),8);case 8:C(u,0)}}))}function TA(e,t){for(var n=[],i=d(e.streams),r=i.next();!r.done;r=i.next())r=r.value,t&&"video"==r.type?n.push({contentType:Wi(r.mimeType,r.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=r.type||n.push({contentType:Wi(r.mimeType,r.codecs),robustness:e.drmInfo.audioRobustness});return n}function SA(e,t,n){return U((function(i){return w(i,FA(e.g,e.h.drm,n,t),0)}))}function EA(e,t,n){function i(){}var r=UA(n);return nA(t,n),Promise.all([e.removeSegments(r,i),e.removeManifests([t.key()],i)])}function wA(e){var t,n,i,r,s,a,o,u,l,c;return U((function(h){switch(h.g){case 1:return _A(),t=e.g,n=e.h.drm,i=new Sw,r=!1,I(h,2),w(h,i.init(),4);case 4:s=[],xw(i,(function(e){return s.push(e)})),a=d(s),o=a.next();case 5:if(o.done){h.s(2);break}return u=o.value,w(h,u.getAll(),8);case 8:return l=h.h,w(h,Jw(n,t,l),9);case 9:return c=h.h,w(h,u.remove(c),10);case 10:c.length!=l.length&&(r=!0),o=a.next(),h.s(5);break;case 2:return R(h),w(h,i.destroy(),11);case 11:C(h,3);break;case 3:return h.return(!r)}}))}function AA(){var e,t,n;return U((function(i){switch(i.g){case 1:return _A(),e=[],t=new Sw,I(i,2),w(i,t.init(),4);case 4:return n=Promise.resolve(),ww(t,(function(t,i){n=n.then((function(){var n;return U((function(r){if(1==r.g)return w(r,i.getAllManifests(),2);n=r.h,n.forEach((function(n,i){n=nA(new jw("manifest",t.zb,t.Qa,i),n),e.push(n)})),A(r)}))}))})),w(i,n,2);case 2:return R(i),w(i,t.destroy(),6);case 6:C(i,3);break;case 3:return i.return(e)}}))}function xA(e,t,n,i){var r,s,a,o,u;return U((function(l){if(1==l.g)return r=null,s=e.g,a={networkingEngine:s,filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){r=e},isLowLatencyMode:function(){return!1},updateDuration:function(){},newDrmInfo:function(){},onManifestUpdated:function(){},getBandwidthEstimate:function(){return i.abr.defaultBandwidthEstimate},onMetadata:function(){},disableStream:function(){},addFont:function(){}},n.configure(i.manifest),PA(e),w(l,n.start(t,a),2);if(3!=l.g)return o=l.h,PA(e),u=BA(o),w(l,Promise.all(qs(u,(function(e){return e.createSegmentIndex()}))),3);if(PA(e),r)throw r;return l.return(o)}))}function IA(e,t,n){var i,r,s,a,o,u,l,c,h,f,p,g,m,v,y;return U((function(b){switch(b.g){case 1:return w(b,LA(e,t),2);case 2:if(i=b.h,"text/vtt"!=i)throw new je(1,2,2017,t);return w(b,RA(t,e.g,e.h.streaming.retryParameters),3);case 3:if(r=b.h,s=or(i),!s)throw new je(2,2,2014,i);for(a=s(),o={periodStart:0,segmentStart:0,segmentEnd:n.presentationTimeline.getDuration(),vttOffset:0},u=Ne(r),l=a.parseMedia(u,o,t,[]),c=[],h=d(l),f=h.next(),p={};!f.done;p={Ne:void 0,Lc:void 0},f=h.next())p.Lc=f.value,p.Ne=null,g=function(e){return function(){return null==e.Ne&&(e.Ne=$t([t],[e.Lc.payload])),e.Ne||[]}}(p),m=new uu(p.Lc.startTime,p.Lc.endTime,g,0,null,null,0,0,1/0),p.Lc.payload.includes("#xywh")&&(v=p.Lc.payload.split("#xywh=")[1].split(","),4===v.length&&m.Ee({height:parseInt(v[3],10),positionX:parseInt(v[0],10),positionY:parseInt(v[1],10),width:parseInt(v[2],10)})),c.push(m);if(y=i,!c.length){b.s(4);break}return w(b,xh(c[0].N()[0],e.g,e.h.manifest.retryParameters),5);case 5:y=b.h;case 4:return b.return({id:e.m++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new rc(c),mimeType:y||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:"image",primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([Wi(y||"","")]),isAudioMuxedInVideo:!1,baseOriginalId:null})}}))}function kA(e,t,n,i,r,s,a){var o,u,l;return U((function(c){if(1==c.g)return s?c.s(2):w(c,LA(e,n),3);if(2!=c.g&&(s=c.h),o={id:e.m++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:ac(0,t.presentationTimeline.getDuration(),[n]),mimeType:s||"",codecs:a||"",kind:r,encrypted:!1,drmInfos:[],keyIds:new Set,language:i,originalLanguage:i,label:null,type:qt,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([Wi(s||"",a||"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},u=Wi(o.mimeType,o.codecs),l=ur(u),!l)throw new je(2,2,2014,s);return c.return(o)}))}function LA(e,t){var n;return U((function(i){switch(i.g){case 1:return x(i,2),w(i,xh(t,e.g,e.h.streaming.retryParameters),4);case 4:n=i.h,k(i,3);break;case 2:L(i);case 3:if(n)return i.return(n);throw new je(1,2,2011,t)}}))}function RA(e,t,n){var i,r,s;return U((function(a){return 1==a.g?(i=Gs,r=Os([e],n),r.method="GET",w(a,t.request(i,r).promise,2)):(s=a.h,a.return(s.data))}))}function CA(e,t,n,i){var r=new Map,s=BA(n),a=new Map;s=d(s);for(var o=s.next();!o.done;o=s.next()){o=o.value;var u=DA(e,t,n,o,i,r);a.set(o.id,u)}for(e=d(n.variants),t=e.next();!t.done;t=e.next())t=t.value,t.audio&&a.get(t.audio.id).variantIds.push(t.id),t.video&&a.get(t.video.id).variantIds.push(t.id);return{streams:Array.from(a.values()),tg:Array.from(r.values())}}function DA(e,t,n,i,r,s){var a={id:i.id,originalId:i.originalId,groupId:i.groupId,primary:i.primary,type:i.type,mimeType:i.mimeType,codecs:i.codecs,frameRate:i.frameRate,pixelAspectRatio:i.pixelAspectRatio,hdr:i.hdr,colorGamut:i.colorGamut,videoLayout:i.videoLayout,kind:i.kind,language:i.language,originalLanguage:i.originalLanguage,label:i.label,width:i.width||null,height:i.height||null,encrypted:i.encrypted,keyIds:i.keyIds,segments:[],variantIds:[],roles:i.roles,forced:i.forced,channelsCount:i.channelsCount,audioSamplingRate:i.audioSamplingRate,spatialAudio:i.spatialAudio,closedCaptions:i.closedCaptions,tilesLayout:i.tilesLayout,mssPrivateData:i.mssPrivateData,external:i.external,fastSwitching:i.fastSwitching,isAudioMuxedInVideo:i.isAudioMuxedInVideo},o=r.offline.numberOfParallelDownloads,u=0===o?i.id:0;return MA(i,n.presentationTimeline.nb(),(function(n,r){var l=JE(n),c=void 0;if(!s.has(l)){var d=n.endTime-n.startTime;d=oA(t,i.id)*d,d=tw(e.g,d),s.set(l,new QE(n,d,u,!1,r))}n.Y&&(c=JE(n.Y),s.has(c)||(d=.5*oA(t,i.id),d=tw(e.g,d),s.set(c,new QE(n.Y,d,u,!0,r)))),a.segments.push({pendingInitSegmentRefId:c,initSegmentKey:c?0:null,startTime:n.startTime,endTime:n.endTime,appendWindowStart:n.appendWindowStart,appendWindowEnd:n.appendWindowEnd,timestampOffset:n.timestampOffset,tilesLayout:n.tilesLayout,pendingSegmentRefId:l,dataKey:0,mimeType:n.mimeType,codecs:n.codecs,thumbnailSprite:n.thumbnailSprite}),0!==o&&(u=(u+1)%o)})),a}function MA(e,t,n){if(t=e.segmentIndex.find(t),null!=t)for(var i=e.segmentIndex.get(t);i;)n(i,t),i=e.segmentIndex.get(++t)}function PA(e){if(e.j.g)throw new je(2,9,7001)}function _A(){if(!lA())throw new je(2,9,9e3)}function OA(e,t){return U((function(n){return 1==n.g?(e.i.push(t),I(n,2),w(n,t,4)):2!=n.g?n.return(n.h):(R(n),yn(e.i,t),C(n,0))}))}function NA(e,t){var n=t.promise;return e.i.push(n),t.finally((function(){yn(e.i,n)}))}function UA(e){var t=new Set;e=d(e.streams);for(var n=e.next();!n.done;n=e.next()){n=d(n.value.segments);for(var i=n.next();!i.done;i=n.next())i=i.value,null!=i.initSegmentKey&&t.add(i.initSegmentKey),t.add(i.dataKey)}return Array.from(t)}function FA(e,t,n,i){var r,s,a;return U((function(o){return 1==o.g?i.drmInfo?(r=Iw(n),s=i.sessionIds.map((function(e){return{sessionId:e,keySystem:i.drmInfo.keySystem,licenseUri:i.drmInfo.licenseServerUri,serverCertificate:i.drmInfo.serverCertificate,audioCapabilities:TA(i,!1),videoCapabilities:TA(i,!0)}})),w(o,Jw(t,e,s),2)):o.return():3!=o.g?(a=o.h,w(o,r.remove(a),3)):w(o,r.add(s.filter((function(e){return!a.includes(e.sessionId)}))),0)}))}function BA(e){for(var t=new Set,n=d(e.variants),i=n.next();!i.done;i=n.next())i=i.value,i.audio&&t.add(i.audio),i.video&&t.add(i.video);for(n=d(e.textStreams),i=n.next();!i.done;i=n.next())t.add(i.value);for(e=d(e.imageStreams),n=e.next();!n.done;n=e.next())t.add(n.value);return t}function jA(e){e.variants.map((function(e){return e.video}));var t=new Set(e.variants.map((function(e){return e.audio})));e=e.textStreams;for(var n=d(t),i=n.next();!i.done;i=n.next()){i=d(t);for(var r=i.next();!r.done;r=i.next());}for(t=d(e),n=t.next();!n.done;n=t.next())for(n=d(e),i=n.next();!i.done;i=n.next());}b(Cw,gw),Cw.prototype.updateManifestExpiration=function(e,t){var n,i,r,s=this;return U((function(a){return n=fw(s.h,s.g),i=n.store(),r=new ys,i.get(e).onsuccess=function(n){(n=n.target.result)?(n.expiration=t,i.put(n),r.resolve()):r.reject(new je(2,9,9012,"Could not find values for "+e))},w(a,Promise.all([n.promise(),r]),0)}))},Cw.prototype.gd=function(e){var t,n,i,r,s,a;return U((function(o){if(1==o.g){for(t=[],n=0;n<e.periods.length;++n)i=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,r=i-e.periods[n].startTime,s=Dw(e.periods[n],r),t.push(s);return w(o,gb(t),2)}return a=o.h,o.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,streams:a,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})}))},Cw.prototype.Ig=function(e){return{data:e.data}},b(Ow,gw),Ow.prototype.gd=function(e){var t,n,i,r,s,a;return U((function(o){if(1==o.g){for(t=[],n=0;n<e.periods.length;++n){i=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,r=i-e.periods[n].startTime;for(var u=e.periods[n],l=[],c=d(u.streams),h=c.next();!h.done;h=c.next())h=h.value,0!=h.variantIds.length&&l.push(Nw(h,u.startTime,u.startTime+r));s=l,t.push(s)}return w(o,gb(t),2)}return a=o.h,o.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:null==e.expiration?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:a,sequenceMode:!1})}))},b(Uw,gw),i=Uw.prototype,i.hasFixedKeySpace=function(){return!1},i.addSegments=function(e){return this.add(this.i,e)},i.addManifests=function(e){return this.add(this.g,e)},i.updateManifest=function(e,t){return mw(this,e,t)},i.gd=function(e){return null==e.expiration&&(e.expiration=1/0),Promise.resolve(e)},i=Fw.prototype,i.init=function(){var t=this,n=new ys,i=!1,r=new ze((function(){i=!0,n.reject(new je(2,9,9017))}));r.da(5);var s=e.indexedDB.open("shaka_offline_db",5);return s.onsuccess=function(){if(!i){var e=s.result;t.l=e;var a=e.objectStoreNames;a=a.contains("manifest")&&a.contains("segment")?new Cw(e,"segment","manifest"):null,t.g=a,a=e.objectStoreNames,a=a.contains("manifest-v2")&&a.contains("segment-v2")?new Ow(e,"segment-v2","manifest-v2"):null,t.h=a,a=e.objectStoreNames,a=a.contains("manifest-v3")&&a.contains("segment-v3")?new Ow(e,"segment-v3","manifest-v3"):null,t.i=a,a=e.objectStoreNames,a=a.contains("manifest-v5")&&a.contains("segment-v5")?new Uw(e,"segment-v5","manifest-v5"):null,t.j=a,e=e.objectStoreNames.contains("session-ids")?new Tw(e):null,t.m=e,r.stop(),n.resolve()}},s.onupgradeneeded=function(){for(var e=s.result,t=d(["segment-v5","manifest-v5","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},s.onerror=function(e){i||(n.reject(new je(2,9,9001,s.error)),r.stop(),e.preventDefault())},n},i.destroy=function(){var e=this;return U((function(t){switch(t.g){case 1:if(!e.g){t.s(2);break}return w(t,e.g.destroy(),2);case 2:if(!e.h){t.s(4);break}return w(t,e.h.destroy(),4);case 4:if(!e.i){t.s(6);break}return w(t,e.i.destroy(),6);case 6:if(!e.j){t.s(8);break}return w(t,e.j.destroy(),8);case 8:if(!e.m){t.s(10);break}return w(t,e.m.destroy(),10);case 10:e.l&&e.l.close(),A(t)}}))},i.getCells=function(){var e=new Map;return this.g&&e.set("v1",this.g),this.h&&e.set("v2",this.h),this.i&&e.set("v3",this.i),this.j&&e.set("v5",this.j),e},i.getEmeSessionCell=function(){return this.m},i.erase=function(){var e=this;return U((function(t){switch(t.g){case 1:if(!e.g){t.s(2);break}return w(t,e.g.destroy(),2);case 2:if(!e.h){t.s(4);break}return w(t,e.h.destroy(),4);case 4:if(!e.i){t.s(6);break}return w(t,e.i.destroy(),6);case 6:if(!e.j){t.s(8);break}return w(t,e.j.destroy(),8);case 8:return e.l&&e.l.close(),w(t,Bw(),10);case 10:return e.l=null,e.g=null,e.h=null,e.i=null,e.j=null,w(t,e.init(),0)}}))},Lw("idb",(function(){return(!st()||st()&&pt())&&!et()&&e.indexedDB?new Fw:null})),jw.prototype.zb=function(){return this.i},jw.prototype.Qa=function(){return this.h},jw.prototype.key=function(){return this.l},jw.prototype.toString=function(){return this.j},i=Yw.prototype,i.configure=function(){},i.start=function(e,t){var n,i,r,s,a,o,u,l=this;return U((function(c){switch(c.g){case 1:if(n=$w(e),l.g=n,null==n||"manifest"!=n.g)throw new je(2,1,9004,e);return i=new Sw,I(c,2),w(c,i.init(),4);case 4:return w(c,Aw(i,n.zb(),n.Qa()),5);case 5:return r=c.h,w(c,r.getManifests([n.key()]),6);case 6:return s=c.h,a=s[0],o=new Gw(n.zb(),n.Qa()),u=Vw(o,a),t.makeTextStreamsForClosedCaptions(u),c.return(u);case 2:return R(c),w(c,i.destroy(),7);case 7:C(c,0)}}))},i.stop=function(){return Promise.resolve()},i.update=function(){},i.onExpirationUpdated=function(e,t){var n,i,r,s,a,o,u,l=this;return U((function(c){switch(c.g){case 1:return n=l.g,i=new Sw,x(c,2,3),w(c,i.init(),5);case 5:return w(c,Aw(i,n.zb(),n.Qa()),6);case 6:return r=c.h,w(c,r.getManifests([n.key()]),7);case 7:if(s=c.h,a=s[0],o=a.sessionIds.includes(e),u=void 0==a.expiration||a.expiration>t,!o||!u){c.s(3);break}return w(c,r.updateManifestExpiration(n.key(),t),3);case 3:return R(c),w(c,i.destroy(),10);case 10:C(c,0);break;case 2:L(c),c.s(3)}}))},i.onInitialVariantChosen=function(){},i.banLocation=function(){},i.setMediaElement=function(){},fo("application/x-offline-manifest",(function(){return new Yw})),K("shaka.offline.OfflineScheme",Xw),Xw.plugin=zw,Ps("offline",zw),i=uA.prototype,i.destroy=function(){return this.j.destroy()},i.configure=function(e,t){return 2==arguments.length&&"string"==typeof e&&(e=Ld(e,t)),Xd(this.h,e)},i.getConfiguration=function(){var e=qd();return Xd(e,this.h,qd()),e},i.xb=function(){return this.g},i.store=function(e,t,n,i,r){var s=this,a=this.getConfiguration(),o=new iw(this.g);return this.l.push(o),t=cA(this,e,t||{},i||[],r||[],(function(){var t;return U((function(i){return 1==i.g?n?i.s(2):w(i,xh(e,s.g,a.manifest.retryParameters),3):(2!=i.g&&(n=i.h),t=go(e,n||null),i.return(t()))}))}),a,o),t=new bs(t,(function(){return sw(o)})),t.finally((function(){yn(s.l,o)})),NA(this,t)},i.remove=function(e){return OA(this,bA(this,e))},i.qj=function(){return OA(this,wA(this))},i.list=function(){return OA(this,AA())},i.Jc=function(e,t,n,i){var r,s=this;return U((function(a){return 1==a.g?(r=new fa({Vb:s.g,onError:t,re:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),r.configure(n.drm),w(a,ga(r,e.variants,i),2)):3!=a.g?w(a,wa(r),3):a.return(r)}))},K("shaka.offline.Storage",uA),uA.deleteAll=function(){var e;return U((function(t){return 1==t.g?(e=new Sw,I(t,2),w(t,kw(e),2)):5!=t.g?(R(t),w(t,e.destroy(),5)):C(t,0)}))},uA.prototype.list=uA.prototype.list,uA.prototype.removeEmeSessions=uA.prototype.qj,uA.prototype.remove=uA.prototype.remove,uA.prototype.store=uA.prototype.store,uA.prototype.getNetworkingEngine=uA.prototype.xb,uA.prototype.getConfiguration=uA.prototype.getConfiguration,uA.prototype.configure=uA.prototype.configure,uA.prototype.destroy=uA.prototype.destroy,uA.support=lA;var $A=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.huawei.wiseplay","3d5e6d359b9a41e8b843dd3c6e72c42c");function GA(){}function VA(e,t){for(e={priority:t||0,callback:e},t=0;t<HA.length;t++)if(HA[t].priority<e.priority)return void HA.splice(t,0,e);HA.push(e)}_f("offline",lA),K("shaka.polyfill",GA),GA.register=VA,GA.installAll=function(){for(var e=d(HA),t=e.next();!t.done;t=e.next()){t=t.value;try{t.callback()}catch(n){Z("Error installing polyfill!",n)}}};var HA=[];function KA(){}function WA(){if(!Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))for(var e=d(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),t=e.next();!t.done;t=e.next())qA(t.value)}function qA(e){var t="aria-"+e.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,e,{get:function(){return this.getAttribute(t)},set:function(e){null==e||void 0==e?this.removeAttribute(t):this.setAttribute(t,e)}})}function YA(){}function XA(){lt()||vt("Sky_STB")||SL()}function zA(){}function QA(){if(e.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,t=Document.prototype,t.exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",JA),document.addEventListener("webkitfullscreenerror",JA),document.addEventListener("mozfullscreenchange",JA),document.addEventListener("mozfullscreenerror",JA),document.addEventListener("MSFullscreenChange",JA),document.addEventListener("MSFullscreenError",JA)}}function JA(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),n=document.createEvent("Event");n.initEvent(t,e.bubbles,e.cancelable),e.target.dispatchEvent(n)}function ZA(){}function ex(){var e=!0;(st()&&!pt()&&!gt()||ot()||ut()||lt()||it()||tt()||ct()||dt()||yt()&&!ot())&&(e=!1),e&&navigator.mediaCapabilities||(navigator.mediaCapabilities||(navigator.mediaCapabilities={}),sx=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=tx)}function tx(e){var t,n,i,r,s,a,o,u,l,c,d;return U((function(h){switch(h.g){case 1:if(t={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:e},n=e.video,i=e.audio,"media-source"!=e.type){if("file"!=e.type)return h.return(t);if(n&&(r=n.contentType,s=Je(r),!s)||i&&(a=i.contentType,o=Je(a),!o))return h.return(t);h.s(2);break}if(!Qe())return h.return(t);if(!n){h.s(3);break}return w(h,nx(n),4);case 4:if(u=h.h,!u)return h.return(t);case 3:if(i){var f=i.contentType;if(st()&&i.spatialRendering&&(f+="; spatialRendering=true"),l=tn(f),!l)return h.return(t)}case 2:return e.keySystemConfiguration?(c=e.keySystemConfiguration,w(h,ix(n,i,c),6)):(t.supported=!0,h.return(t));case 6:(d=h.h)&&(t.supported=!0,t.keySystemAccess=d);case 5:return h.return(t)}}))}function nx(e){var t;return U((function(n){return 1==n.g?st()?w(n,rx(e),3):n.s(2):2!=n.g?(t=n.h,n.return(t)):n.return(tn(e.contentType))}))}function ix(e,t,n){var i,r,s,a,o,u,l,c,d,h,f;return U((function(p){switch(p.g){case 1:if(i=[],r=[],n.audio&&(s={robustness:n.audio.robustness||"",contentType:t.contentType},tt()&&t.contentType.includes('codecs="ac-3"')&&(s.contentType='audio/mp4; codecs="ec-3"'),n.audio.encryptionScheme&&(s.encryptionScheme=n.audio.encryptionScheme),i.push(s)),n.video&&(a={robustness:n.video.robustness||"",contentType:e.contentType},n.video.encryptionScheme&&(a.encryptionScheme=n.video.encryptionScheme),r.push(a)),o={initDataTypes:[n.initDataType],distinctiveIdentifier:n.distinctiveIdentifier,persistentState:n.persistentState,sessionTypes:n.sessionTypes},i.length&&(o.audioCapabilities=i),r.length&&(o.videoCapabilities=r),u=e?e.contentType:"",l=t?t.contentType:"",c=Zi(u)+";"+Ji(u),d=Zi(l)+";"+Ji(l),h=n.keySystem,f=null,x(p,2),Ye.has(c+"#"+d+"#"+h)){f=Ye.get(c+"#"+d+"#"+h)||null,p.s(4);break}return w(p,navigator.requestMediaKeySystemAccess(n.keySystem,[o]),5);case 5:f=p.h,Ye.set(c+"#"+d+"#"+h,f);case 4:k(p,3);break;case 2:L(p);case 3:return p.return(f)}}))}function rx(t){var n,i,r,s,a;return U((function(o){if(1==o.g){if(!(e.cast&&cast.__platform__&&cast.__platform__.canDisplayType))return o.return(tn(t.contentType));switch(n=t.contentType,t.width&&t.height&&1280<t.width&&720<t.height&&(n+="; width="+t.width+"; height="+t.height),t.framerate&&(i=Math.round(t.framerate),24>i||30<i)&&(n+="; framerate="+t.framerate),r=t.transferFunction||"",r){case"":case"srgb":break;case"pq":n+="; eotf=smpte2084";break;case"hlg":n+="; eotf=arib-std-b67";break;default:return o.return(!1)}return s=!1,a=hx,a.has(n)?(s=a.get(n),o.s(2)):w(o,cast.__platform__.canDisplayType(n),3)}return 2!=o.g&&(s=o.h,a.set(n,s)),o.return(s)}))}GA.Aria=KA,KA.install=WA,VA(WA),GA.EncryptionScheme=YA,YA.install=XA,VA(XA,-2),GA.Fullscreen=zA,zA.install=QA,VA(QA),GA.MediaCapabilities=ZA,ZA.install=ex;var sx=null;ZA.originalMcap=sx;var ax,ox,ux,lx,cx,dx,hx=new Map;function fx(){}function px(){var t=ht();(e.MediaSource||e.ManagedMediaSource)&&(t&&e.MediaSource?12>=t?(gx(),mx()):15>=t&&gx():vt("DT_STB_BCM")?(gx(),mx()):(vt("Tizen 2")||nt()||vt("Tizen 4"))&&yx()),(e.MediaSource||e.ManagedMediaSource)&&vx(),e.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&bx()}function gx(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=e.apply(this,F.apply(0,arguments));return t.abort=function(){},t}}function mx(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}function vx(){if(e.MediaSource){var t=MediaSource.isTypeSupported.bind(MediaSource);MediaSource.isTypeSupported=function(e){return"mp2t"!=zi(e)&&t(e)}}if(e.ManagedMediaSource){var n=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);e.ManagedMediaSource.isTypeSupported=function(e){return"mp2t"!=zi(e)&&n(e)}}}function yx(){var t=MediaSource.isTypeSupported.bind(MediaSource);if(MediaSource.isTypeSupported=function(e){return"opus"!=Ji(e)&&t(e)},e.ManagedMediaSource){var n=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);e.ManagedMediaSource.isTypeSupported=function(e){return"opus"!=Ji(e)&&n(e)}}}function bx(){var e=MediaSource.isTypeSupported;it()||(MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */),i=n.findIndex((function(e){return e.startsWith("codecs=")}));if(0>i)return e(t);var r=n[i].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),s=r.findIndex((function(e){return e.startsWith("vp09")}));return 0<=s&&(r[s]="vp9",n[i]='codecs="'+r.join(",")+'"',t=n.join("; ")),e(t)})}function Tx(){}function Sx(){screen.orientation&&screen.orientation.unlock||(void 0!=screen.orientation?Ex():void 0!=e.orientation&&wx())}function Ex(){void 0===screen.orientation.lock&&(screen.orientation.lock=function(){return Promise.resolve()}),void 0===screen.orientation.unlock&&(screen.orientation.unlock=function(){})}function wx(){function t(){switch(e.orientation){case-90:n.type="landscape-secondary",n.angle=270;break;case 0:n.type="portrait-primary",n.angle=0;break;case 90:n.type="landscape-primary",n.angle=90;break;case 180:n.type="portrait-secondary",n.angle=180}}var n=new Ax;screen.orientation=n,t(),e.addEventListener("orientationchange",(function(){t();var e=new Is("change");n.dispatchEvent(e)}))}function Ax(){Rs.call(this),this.type="",this.angle=0}function xx(){}function Ix(t){e.HTMLVideoElement&&e.WebKitMediaKeys&&e.shakaMediaKeysPolyfill!=Nx&&(void 0!==t&&t&&(ax=!0,ox=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),ux=HTMLMediaElement.prototype.setMediaKeys,lx=e.MediaKeys,cx=e.MediaKeySystemAccess,dx=navigator.requestMediaKeySystemAccess),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Lx,e.MediaKeys=Dx,e.MediaKeySystemAccess=Cx,navigator.requestMediaKeySystemAccess=kx,e.shakaMediaKeysPolyfill=Nx,as.clear(),Ye.clear())}function kx(e,t){try{var n=new Cx(e,t);return Promise.resolve(n)}catch(i){return Promise.reject(i)}}function Lx(e){var t=this.mediaKeys;return t&&t!=e&&Mx(t,null),delete this.mediaKeys,(this.mediaKeys=e)?Mx(e,this):Promise.resolve()}function Rx(e){if(e=Ne(e.initData),Fe(e).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=kt(e.subarray(4),!0),e=Rt(e);var t=new Event("encrypted");t.initDataType="skd",t.initData=Oe(e),this.dispatchEvent(t)}function Cx(e,t){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(e=d(t),t=e.next();!t.done;t=e.next()){var n=t.value;if("required"==n.persistentState)t=null;else{t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:n.initDataTypes,sessionTypes:["temporary"],label:n.label};var i=!1,r=!1;if(n.audioCapabilities)for(var s=d(n.audioCapabilities),a=s.next();!a.done;a=s.next())a=a.value,a.contentType&&(i=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,a.contentType.split(";")[0])&&(t.audioCapabilities.push(a),r=!0));if(n.videoCapabilities)for(n=d(n.videoCapabilities),s=n.next();!s.done;s=n.next())s=s.value,s.contentType&&(i=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,s.contentType.split(";")[0])&&(t.videoCapabilities.push(s),r=!0));i||(r=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),t=r?t:null}if(t)return void(this.g=t)}throw e=Error("Unsupported keySystem"),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function Dx(e){this.h=new WebKitMediaKeys(e),this.g=new ae}function Mx(e,t){if(e.g.Pa(),!t)return Promise.resolve();e.g.D(t,"webkitneedkey",Rx);try{return Hl(t,HTMLMediaElement.HAVE_METADATA,e.g,(function(){t.webkitSetMediaKeys(e.h)})),Promise.resolve()}catch(n){return Promise.reject(n)}}function Px(e){Rs.call(this),this.i=null,this.l=e,this.g=this.h=null,this.j=new ae,this.sessionId="",this.expiration=NaN,this.closed=new ys,this.keyStatuses=new Ox}function _x(e,t){var n=e.keyStatuses;n.size=void 0==t?0:1,n.g=t,t=new Is("keystatuseschange"),e.dispatchEvent(t)}function Ox(){this.size=0,this.g=void 0}VA(ex,-1),GA.MediaSource=fx,fx.install=px,VA(px),GA.Orientation=Tx,Tx.install=Sx,b(Ax,Rs),Ax.prototype.lock=function(e){function t(e){return screen.lockOrientation?screen.lockOrientation(e):screen.mozLockOrientation?screen.mozLockOrientation(e):!!screen.msLockOrientation&&screen.msLockOrientation(e)}var n=!1;switch(e){case"natural":n=t("default");break;case"any":n=!0,this.unlock();break;default:n=t(e)}return n?Promise.resolve():(e=Error("screen.orientation.lock() is not available on this device"),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(e))},Ax.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},VA(Sx),GA.PatchedMediaKeysApple=xx,xx.uninstall=function(){e.shakaMediaKeysPolyfill==Nx&&ax&&(ax=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",ox),HTMLMediaElement.prototype.setMediaKeys=ux,e.MediaKeys=lx,e.MediaKeySystemAccess=cx,navigator.requestMediaKeySystemAccess=dx,ox=dx=ux=cx=lx=null,e.shakaMediaKeysPolyfill="",as.clear(),Ye.clear())},xx.install=Ix,Cx.prototype.createMediaKeys=function(){var e=new Dx(this.keySystem);return Promise.resolve(e)},Cx.prototype.getConfiguration=function(){return this.g},Dx.prototype.createSession=function(e){if(e=e||"temporary","temporary"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");return new Px(this.h,e)},Dx.prototype.setServerCertificate=function(){return Promise.resolve(!1)},Dx.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},b(Px,Rs),i=Px.prototype,i.generateRequest=function(e,t){var n=this;this.h=new ys;try{var i=this.l.createSession("video/mp4",Ne(t));this.i=i,this.sessionId=i.sessionId||"",this.j.D(this.i,"webkitkeymessage",(function(e){n.h&&(n.h.resolve(),n.h=null),e=(new Map).set("messageType",void 0==n.keyStatuses.dc()?"license-request":"license-renewal").set("message",Oe(e.message)),e=new Is("message",e),n.dispatchEvent(e)})),this.j.D(i,"webkitkeyadded",(function(){n.g&&(_x(n,"usable"),n.g.resolve(),n.g=null)})),this.j.D(i,"webkitkeyerror",(function(){var e=Error("EME PatchedMediaKeysApple key error");if(e.errorCode=n.i.error,null!=n.h)n.h.reject(e),n.h=null;else if(null!=n.g)n.g.reject(e),n.g=null;else switch(n.i.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:_x(n,"output-not-allowed");break;default:_x(n,"internal-error")}})),_x(this,"status-pending")}catch(r){this.h.reject(r)}return this.h},i.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},i.update=function(e){this.g=new ys;try{this.i.update(Ne(e))}catch(t){this.g.reject(t)}return this.g},i.close=function(){try{this.i.close(),this.closed.resolve(),this.j.Pa()}catch(LL){this.closed.reject(LL)}return this.closed},i.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},i=Ox.prototype,i.dc=function(){return this.g},i.forEach=function(e){this.g&&e(this.g,qe.value())},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=qe.value();return!(!this.g||!_e(e,t))},i.entries=function(){},i.keys=function(){},i.values=function(){};var Nx="apple";function Ux(){}function Fx(){e.MediaKeys&&(!MediaKeys.prototype.setServerCertificate||nt()||vt("Tizen 4")||vt("Tizen 5.0")||rt())&&(MediaKeys.prototype.setServerCertificate=Bx)}function Bx(){return Promise.resolve(!1)}function jx(){}function $x(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)eI="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=Vx,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Hx,e.MediaKeys=Wx,e.MediaKeySystemAccess=Kx,e.shakaMediaKeysPolyfill=tI}}function Gx(e){var t=eI;return t?t+e.charAt(0).toUpperCase()+e.slice(1):e}function Vx(e,t){try{var n=new Kx(e,t);return Promise.resolve(n)}catch(i){return Promise.reject(i)}}function Hx(e){var t=this.mediaKeys;return t&&t!=e&&qx(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&qx(e,this),Promise.resolve()}function Kx(e,t){this.g=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(this.g="webkit-org.w3.clearkey",n=!1);var i=!1,r=document.getElementsByTagName("video");r=r.length?r[0]:document.createElement("video"),t=d(t);for(var s=t.next();!s.done;s=t.next()){s=s.value;var a={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:s.initDataTypes,sessionTypes:["temporary"],label:s.label},o=!1;if(s.audioCapabilities)for(var u=d(s.audioCapabilities),l=u.next();!l.done;l=u.next())l=l.value,l.contentType&&(o=!0,r.canPlayType(l.contentType.split(";")[0],this.g)&&(a.audioCapabilities.push(l),i=!0));if(s.videoCapabilities)for(u=d(s.videoCapabilities),l=u.next();!l.done;l=u.next())l=l.value,l.contentType&&(o=!0,r.canPlayType(l.contentType,this.g)&&(a.videoCapabilities.push(l),i=!0));if(o||(i=r.canPlayType("video/mp4",this.g)||r.canPlayType("video/webm",this.g)),"required"==s.persistentState&&(n?(a.persistentState="required",a.sessionTypes=["persistent-license"]):i=!1),i)return void(this.h=a)}throw n="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(n="None of the requested configurations were supported."),e=Error(n),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function Wx(e){this.l=e,this.h=null,this.g=new ae,this.i=[],this.j=new Map}function qx(e,t){e.h=t,e.g.Pa();var n=eI;t&&(e.g.D(t,n+"needkey",(function(t){var n=new CustomEvent("encrypted");n.initDataType="cenc",n.initData=Oe(t.initData),e.h.dispatchEvent(n)})),e.g.D(t,n+"keymessage",(function(t){var n=Yx(e,t.sessionId);n&&(t=(new Map).set("messageType",void 0==n.keyStatuses.dc()?"licenserequest":"licenserenewal").set("message",t.message),t=new Is("message",t),n.h&&(n.h.resolve(),n.h=null),n.dispatchEvent(t))})),e.g.D(t,n+"keyadded",(function(t){(t=Yx(e,t.sessionId))&&t.ready()})),e.g.D(t,n+"keyerror",(function(t){var n=Yx(e,t.sessionId);if(n){var i=Error("EME v0.1b key error"),r=t.errorCode;r.systemCode=t.systemCode,i.errorCode=r,!t.sessionId&&n.h?(45==t.systemCode&&(i.message="Unsupported session type."),n.h.reject(i),n.h=null):t.sessionId&&n.g?(n.g.reject(i),n.g=null):(i=t.systemCode,t.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Jx(n,"output-restricted"):Jx(n,1==i?"expired":"internal-error"))}})))}function Yx(e,t){var n=e.j.get(t);return n||((n=e.i.shift())?(n.sessionId=t,e.j.set(t,n),n):null)}function Xx(e,t,n){Rs.call(this),this.j=e,this.m=!1,this.g=this.h=null,this.i=t,this.l=n,this.sessionId="",this.expiration=NaN,this.closed=new ys,this.keyStatuses=new Zx}function zx(e,t,n){if(e.m)return Promise.reject(Error("The session is already initialized."));e.m=!0;try{if("persistent-license"==e.l)if(n)var i=Ne(Rt("LOAD_SESSION|"+n));else{var r=Rt("PERSISTENT|");i=jt(r,t)}else i=Ne(t)}catch(a){return Promise.reject(a)}e.h=new ys;var s=Gx("generateKeyRequest");try{e.j[s](e.i,i)}catch(a){if("InvalidStateError"!=a.name)return e.h=null,Promise.reject(a);new ze((function(){try{e.j[s](e.i,i)}catch(t){e.h.reject(t),e.h=null}})).da(.01)}return e.h}function Qx(e,t,n){if(e.g)e.g.then((function(){return Qx(e,t,n)})).catch((function(){return Qx(e,t,n)}));else{if(e.g=t,"webkit-org.w3.clearkey"==e.i){var i=It(n),r=JSON.parse(i);"oct"!=r.keys[0].kty&&(e.g.reject(Error("Response is not a valid JSON Web Key Set.")),e.g=null),i=Ut(r.keys[0].k),r=Ut(r.keys[0].kid)}else i=Ne(n),r=null;var s=Gx("addKey");try{e.j[s](e.i,i,r,e.sessionId)}catch(a){e.g.reject(a),e.g=null}}}function Jx(e,t){var n=e.keyStatuses;n.size=void 0==t?0:1,n.g=t,t=new Is("keystatuseschange"),e.dispatchEvent(t)}function Zx(){this.size=0,this.g=void 0}VA((function(){e.HTMLVideoElement&&e.WebKitMediaKeys&&(navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||Ix())})),GA.PatchedMediaKeysCert=Ux,Ux.install=Fx,VA(Fx),GA.PatchedMediaKeysWebkit=jx,jx.install=$x,Kx.prototype.createMediaKeys=function(){var e=new Wx(this.g);return Promise.resolve(e)},Kx.prototype.getConfiguration=function(){return this.h},Wx.prototype.createSession=function(e){if(e=e||"temporary","temporary"!=e&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.h||document.createElement("video");return t.src||(t.src="about:blank"),e=new Xx(t,this.l,e),this.i.push(e),e},Wx.prototype.setServerCertificate=function(){return Promise.resolve(!1)},Wx.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},b(Xx,Rs),i=Xx.prototype,i.ready=function(){Jx(this,"usable"),this.g&&this.g.resolve(),this.g=null},i.generateRequest=function(e,t){return zx(this,t,null)},i.load=function(e){return"persistent-license"==this.l?zx(this,null,e):Promise.reject(Error("Not a persistent session."))},i.update=function(e){var t=new ys;return Qx(this,t,e),t},i.close=function(){if("persistent-license"!=this.l){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=Gx("cancelKeyRequest");try{this.j[e](this.i,this.sessionId)}catch(t){}}return this.closed.resolve(),this.closed},i.remove=function(){return"persistent-license"!=this.l?Promise.reject(Error("Not a persistent session.")):this.close()},i=Zx.prototype,i.dc=function(){return this.g},i.forEach=function(e){this.g&&e(this.g,qe.value())},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=qe.value();return!(!this.g||!_e(e,t))},i.entries=function(){},i.keys=function(){},i.values=function(){};var eI="",tI="webkit";function nI(){}function iI(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||!t.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=sI,Object.defineProperty(t,"disablePictureInPicture",{get:oI,set:uI,enumerable:!0,configurable:!0}),document.exitPictureInPicture=aI,document.addEventListener("webkitpresentationmodechanged",rI,!0))}}function rI(e){if(e=e.target,"picture-in-picture"==e.webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function sI(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function aI(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function oI(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function uI(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function lI(){}function cI(){e.crypto&&("randomUUID"in e.crypto||(e.crypto.randomUUID=dI))}function dI(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)}function hI(){}function fI(){var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:pI})}function pI(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0}function gI(){}function mI(){if(e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch((function(){})),e}}}function vI(){}function yI(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in t||rt())&&(t.getVideoPlaybackQuality=bI)}}function bI(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function TI(){}function SI(){if(!e.VTTCue&&e.TextTrackCue){var t=null,n=TextTrackCue.length;if(3==n)t=EI;else if(6==n)t=wI;else{try{var i=!!EI(1,2,"")}catch(r){i=!1}i&&(t=EI)}t&&(e.VTTCue=function(e,n,i){return t(e,n,i)})}}function EI(t,n,i){return new e.TextTrackCue(t,n,i)}function wI(t,n,i){return new e.TextTrackCue(t+"-"+n+"-"+i,t,n,i)}function AI(){}VA($x),GA.PiPWebkit=nI,nI.install=iI,VA(iI),GA.RandomUUID=lI,lI.install=cI,VA(cI),GA.Symbol=hI,hI.install=fI,VA(fI),GA.VideoPlayPromise=gI,gI.install=mI,VA(mI),GA.VideoPlaybackQuality=vI,vI.install=yI,VA(yI),GA.VTTCue=TI,TI.install=SI,VA(SI),AI.prototype.parseInit=function(){},AI.prototype.setSequenceMode=function(){},AI.prototype.setManifestType=function(){},AI.prototype.parseMedia=function(e,t){var n=null,i=[];e=It(e).split(/\r?\n/),e=d(e);for(var r=e.next();!r.done;r=e.next())if((r=r.value)&&!/^\s+$/.test(r)&&(r=xI.exec(r))){var s=II.exec(r[1]);s=60*parseInt(s[1],10)+parseFloat(s[2].replace(",",".")),r=new ci(s,t.segmentEnd?t.segmentEnd:s+2,r[2]),n&&(n.endTime=s,i.push(n)),n=r}return n&&i.push(n),i},K("shaka.text.LrcTextParser",AI),AI.prototype.parseMedia=AI.prototype.parseMedia,AI.prototype.setManifestType=AI.prototype.setManifestType,AI.prototype.setSequenceMode=AI.prototype.setSequenceMode,AI.prototype.parseInit=AI.prototype.parseInit;var xI=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,II=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;function kI(){}function LI(e,t,n,i,r,s,a,o,u,l,c,h,f){var p=l;if(On(e)){if(!c)return null;var g={tagName:"span",children:[Fn(e)],attributes:{},parent:null}}else g=e;for(var m=null,v=d(rk),y=v.next();!y.done&&!(m=UI(g,"backgroundImage",i,"#",y.value)[0]);y=v.next());v=null,y=Wn(g,rk,"backgroundImage");var b=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/;if(y&&b.test(y)){if(v=parseInt(y.split(":").pop(),10)-1,v>=f.length)return null;v=f[v]}else h&&y&&!y.startsWith("#")&&(b=new ve(h),y=new ve(y),(y=b.resolve(y).toString())&&(v=y));if(("p"==e.tagName||m||v)&&(c=!0),e=c,y="default"==(g.attributes["xml:space"]||(o?"default":"preserve")),b=g.children.every(On),o=[],!b)for(var T=d(g.children),S=T.next();!S.done;S=T.next())(S=LI(S.value,t,n,i,r,s,a,y,u,g,c,h,f))&&o.push(S);if(i=null!=l,h=Fn(g),h=g.children.length&&h&&/\S/.test(h),T=g.attributes.begin||g.attributes.end||g.attributes.dur,!(T||h||"br"==g.tagName||0!=o.length||i&&!y))return null;for(f=BI(g,n),h=f.start,f=f.end;p&&p.tagName&&"tt"!=p.tagName;)f=FI(p,n,h,f),h=f.start,f=f.end,p=p.parent;if(null==h&&(h=0),h+=t.periodStart,f=null==f?1/0:f+t.periodStart,h=Math.max(h,t.segmentStart),f=Math.min(f,t.segmentEnd),!T&&0<o.length)for(h=1/0,f=0,t=d(o),n=t.next();!n.done;n=t.next())n=n.value,h=Math.min(h,n.startTime),f=Math.max(f,n.endTime);if("br"==g.tagName)return r=new ci(h,f,""),r.lineBreak=!0,r;if(t="",b&&(t=Mt(Fn(g)||""),y&&(t=t.replace(/\s+/g," "))),t=new ci(h,f,t),t.nestedCues=o,c||(t.isContainer=!0),u&&(t.cellResolution=u),u=UI(g,"region",s,"")[0],g.attributes.region&&u&&u.attributes["xml:id"]){var E=u.attributes["xml:id"];t.region=a.filter((function(e){return e.id==E}))[0]}return a=u,l&&i&&!g.attributes.region&&!g.attributes.style&&(a=UI(l,"region",s,"")[0]),DI(t,g,a,m,v,r,e,0==o.length),t}function RI(e,t,n){var i=new pn,r=e.attributes["xml:id"];if(!r)return null;i.id=r,r=null,n&&(r=HI.exec(n)||qI.exec(n)),n=r?Number(r[1]):null,r=r?Number(r[2]):null;var s,a=_I(e,t,"extent");if(a){var o=(s=HI.exec(a))||qI.exec(a);null!=o&&(i.width=Number(o[1]),i.height=Number(o[2]),s||(null!=n&&(i.width=100*i.width/n),null!=r&&(i.height=100*i.height/r)),i.widthUnits=s||null!=n?gn:0,i.heightUnits=s||null!=r?gn:0)}return(e=_I(e,t,"origin"))&&(o=(s=HI.exec(e))||qI.exec(e),null!=o&&(i.viewportAnchorX=Number(o[1]),i.viewportAnchorY=Number(o[2]),s?a||(i.width=100-i.viewportAnchorX,i.widthUnits=gn,i.height=100-i.viewportAnchorY,i.heightUnits=gn):(null!=r&&(i.viewportAnchorY=100*i.viewportAnchorY/r),null!=n&&(i.viewportAnchorX=100*i.viewportAnchorX/n)),i.viewportAnchorUnits=s||null!=n?gn:0)),i}function CI(e){var t=e.match(/rgba\(([^)]+)\)/);return t&&(t=t[1].split(","),4==t.length)?(t[3]=String(Number(t[3])/255),"rgba("+t.join(",")+")"):e}function DI(e,t,n,i,r,s,a,o){if(a=a||o,"rtl"==PI(t,n,s,"direction",a)&&(e.direction="rtl"),o=PI(t,n,s,"writingMode",a),"tb"==o||"tblr"==o?e.writingMode="vertical-lr":"tbrl"==o?e.writingMode="vertical-rl":"rltb"==o||"rl"==o?e.direction="rtl":o&&(e.direction=wi),(o=PI(t,n,s,"textAlign",!0))?(e.positionAlign=tk.get(o),e.lineAlign=ek.get(o),e.textAlign=Ti[o.toUpperCase()]):e.textAlign=bi,(o=PI(t,n,s,"displayAlign",!0))&&(e.displayAlign=Ei[o.toUpperCase()]),(o=PI(t,n,s,"color",a))&&(e.color=CI(o)),(o=PI(t,n,s,"backgroundColor",a))&&(e.backgroundColor=CI(o)),(o=PI(t,n,s,"border",a))&&(e.border=o),o=PI(t,n,s,"fontFamily",a))switch(o){case"monospaceSerif":e.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":e.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":e.fontFamily="sans-serif";break;case"monospaceSansSerif":e.fontFamily="Consolas,monospace";break;case"proportionalSerif":e.fontFamily="serif";break;default:e.fontFamily=o.split(",").filter((function(e){return"default"!=e})).join(",")}switch((o=PI(t,n,s,"fontWeight",a))&&"bold"==o&&(e.fontWeight=Di),o=PI(t,n,s,"wrapOption",a),e.wrapLine=!o||"noWrap"!=o,(o=PI(t,n,s,"lineHeight",a))&&o.match(WI)&&(e.lineHeight=o),(o=PI(t,n,s,"fontSize",a))&&(o.match(WI)||o.match(KI))&&(e.fontSize=o),(o=PI(t,n,s,"fontStyle",a))&&(e.fontStyle=_i[o.toUpperCase()]),i?(r=i.attributes.imageType||i.attributes.imagetype,o=i.attributes.encoding,i=Fn(i).trim(),"PNG"==r&&"Base64"==o&&i&&(e.backgroundImage="data:image/png;base64,"+i)):r&&(e.backgroundImage=r),(i=PI(t,n,s,"textOutline",a))&&(i=i.split(" "),i[0].match(WI)?e.textStrokeColor=e.color:(e.textStrokeColor=CI(i[0]),i.shift()),i[0]&&i[0].match(WI)?e.textStrokeWidth=i[0]:e.textStrokeColor=""),(i=PI(t,n,s,"letterSpacing",a))&&i.match(WI)&&(e.letterSpacing=i),(i=PI(t,n,s,"linePadding",a))&&i.match(WI)&&(e.linePadding=i),(i=PI(t,n,s,"opacity",a))&&(e.opacity=parseFloat(i)),(i=_I(n,s,"textDecoration"))&&MI(e,i),(i=OI(t,s,"textDecoration"))&&MI(e,i),(i=PI(t,n,s,"textCombine",a))&&(e.textCombineUpright=i),PI(t,n,s,"ruby",a)){case"container":e.rubyTag="ruby";break;case"text":e.rubyTag="rt"}}function MI(e,t){t=d(t.split(" "));for(var n=t.next();!n.done;n=t.next())switch(n.value){case"underline":e.textDecoration.includes(Oi)||e.textDecoration.push(Oi);break;case"noUnderline":e.textDecoration.includes(Oi)&&yn(e.textDecoration,Oi);break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&yn(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&yn(e.textDecoration,"overline")}}function PI(e,t,n,i,r){return r=void 0===r||r,(e=OI(e,n,i))?e:r?_I(t,n,i):null}function _I(e,t,n){if(!e)return null;var i=Wn(e,ik,n);return i||NI(e,t,n)}function OI(e,t,n){var i=Wn(e,ik,n);return i||NI(e,t,n)}function NI(e,t,n){e=UI(e,"style",t,"");for(var i=null,r=0;r<e.length;r++){var s=Hn(e[r],"urn:ebu:tt:style",n);s||(s=Wn(e[r],ik,n)),s||(s=OI(e[r],t,n)),s&&(i=s)}return i}function UI(e,t,n,i,r){var s=[];if(!e||1>n.length)return s;var a=e;for(e=null;!e&&!(e=r?Hn(a,r,t):a.attributes[t])&&(a=a.parent,a););if(t=e)for(t=d(t.split(" ")),r=t.next();!r.done;r=t.next())for(r=r.value,e=d(n),a=e.next();!a.done;a=e.next())if(a=a.value,i+a.attributes["xml:id"]==r){s.push(a);break}return s}function FI(e,t,n,i){return e=BI(e,t),null==n?n=e.start:null!=e.start&&(n+=e.start),null==i?i=e.end:null!=e.start&&(i+=e.start),{start:n,end:i}}function BI(e,t){var n=jI(e.attributes.begin,t),i=jI(e.attributes.end,t);return e=jI(e.attributes.dur,t),null==i&&null!=e&&(i=n+e),{start:n,end:i}}function jI(e,t){var n=null;if(YI.test(e)){e=YI.exec(e),n=Number(e[1]);var i=Number(e[2]),r=Number(e[3]),s=Number(e[4]);s+=(Number(e[5])||0)/t.h,r+=s/t.frameRate,n=r+60*i+3600*n}else if(XI.test(e))n=$I(XI,e);else if(zI.test(e))n=$I(zI,e);else if(QI.test(e))e=QI.exec(e),n=Number(e[1])/t.frameRate;else if(JI.test(e))e=JI.exec(e),n=Number(e[1])/t.g;else if(ZI.test(e))n=$I(ZI,e);else if(e)throw new je(2,2,2001,"Could not parse cue time range in TTML");return n}function $I(e,t){return e=e.exec(t),null==e||""==e[0]?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+60*(Number(e[2])||0)+3600*(Number(e[1])||0)}function GI(e){return e&&(e=/^(\d+) (\d+)$/.exec(e))?{oc:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}function VI(e,t,n,i){this.frameRate=Number(e)||30,this.h=Number(t)||1,this.g=Number(i),0==this.g&&(this.g=e?this.frameRate*this.h:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}ar("application/x-subtitle-lrc",(function(){return new AI})),kI.prototype.parseInit=function(){},kI.prototype.setSequenceMode=function(){},kI.prototype.setManifestType=function(){},kI.prototype.parseMedia=function(e,t,n,i){var r=It(e);if(e=[],""==r)return e;var s=Mn(r,"tt",!0);if(!s)throw new je(2,2,2005,"Failed to parse TTML.");if(r=jn(s,"body")[0],!r)return[];var a=Wn(s,nk,"frameRate"),o=Wn(s,nk,"subFrameRate"),u=Wn(s,nk,"frameRateMultiplier"),l=Wn(s,nk,"tickRate"),c=Wn(s,nk,"cellResolution"),h=s.attributes["xml:space"]||"default",f=Wn(s,ik,"extent");if("default"!=h&&"preserve"!=h)throw new je(2,2,2005,"Invalid xml:space value: "+h);h="default"==h,a=new VI(a,o,u,l),c=GI(c),o=jn(s,"metadata")[0],o=(o?o.children:[]).filter((function(e){return"\n"!=e})),u=jn(s,"style"),s=jn(s,"region"),l=[];for(var p=d(s),g=p.next();!g.done;g=p.next())(g=RI(g.value,u,f))&&l.push(g);if(Un(r,"p").length)throw new je(2,2,2001,"<p> can only be inside <div> in TTML");for(f=d(Un(r,"div")),p=f.next();!p.done;p=f.next())if(Un(p.value,"span").length)throw new je(2,2,2001,"<span> can only be inside <p> in TTML");return(t=LI(r,t,a,o,u,s,l,h,c,null,!1,n,i))&&(t.backgroundColor||(t.backgroundColor="transparent"),e.push(t)),e},K("shaka.text.TtmlTextParser",kI),kI.prototype.parseMedia=kI.prototype.parseMedia,kI.prototype.setManifestType=kI.prototype.setManifestType,kI.prototype.setSequenceMode=kI.prototype.setSequenceMode,kI.prototype.parseInit=kI.prototype.parseInit;var HI=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,KI=/^(\d{1,4}(?:\.\d+)?|100)%$/,WI=/^(\d+px|\d+em|\d*\.?\d+c)$/,qI=/^(\d+)px (\d+)px$/,YI=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,XI=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,zI=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d+)$/,QI=/^(\d*(?:\.\d*)?)f$/,JI=/^(\d*(?:\.\d*)?)t$/,ZI=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),ek=(new Map).set("left",Ii).set("center","center").set("right","end").set("start",Ii).set("end","end"),tk=(new Map).set("left","line-left").set("center","center").set("right","line-right"),nk=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],ik=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],rk=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];function sk(){this.g=new kI}function ak(){this.g="UNKNOWN"}function ok(e,t,n){var i;(i=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=i[1],e.textAlign="middle"==t?bi:Ti[t.toUpperCase()]):(i=/^vertical:(lr|rl)$/.exec(t))?e.writingMode="lr"==i[1]?"vertical-lr":"vertical-rl":(i=/^size:([\d.]+)%$/.exec(t))?e.size=Number(i[1]):(i=/^position:([\d.]+)%(?:,(line-left|line-right|middle|center|start|end|auto))?$/.exec(t))?(e.position=Number(i[1]),i[2]&&(t=i[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center"==t||"middle"==t?"center":yi)):(i=/^region:(.*)$/.exec(t))?(t=uk(n,i[1]))&&(e.region=t):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=ki[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=xi,e.line=Number(n[1]),n[2]&&(e.lineAlign=ki[n[2].toUpperCase()]))}function uk(e,t){return e=e.filter((function(e){return e.id==t})),e.length?e[0]:null}function lk(){this.g=null}function ck(e,t,n){var i,r,s;return(new ea).box("payl",sa((function(e){i=It(e)}))).box("iden",sa((function(e){r=It(e)}))).box("sttg",sa((function(e){s=It(e)}))).parse(e),i?dk(i,r,s,t,n):null}function dk(e,t,n,i,r){if(e=new ci(i,r,e),fi(e),t&&(e.id=t),n)for(t=new Sn(n),n=An(t);n;)ok(e,n,[]),En(t),n=An(t);return e}function hk(){}function fk(){this.g=new ak}function pk(e){var t="WEBVTT\n\n";if(""==e)return t;e=e.replace(/\r+/g,""),e=e.trim(),e=d(e.split("\n\n"));for(var n=e.next();!n.done;n=e.next())n=n.value.split(/\n/),n[0].match(/\d+/)&&n.shift(),n[0]=n[0].replace(/,/g,"."),t+=n.join("\n").replace(/{b}/g,"<b>").replace(/{\/b}/g,"</b>").replace(/{i}/g,"<i>").replace(/{\/i}/g,"</i>").replace(/{u}/g,"<u>").replace(/{\/u}/g,"</u>")+"\n\n";return t}function gk(){}function mk(e,t){var n=t.Fontname;if(n&&(e.fontFamily=n),(n=t.Fontsize)&&(e.fontSize=n+"px"),(n=t.PrimaryColour)&&(n=vk(n))&&(e.color=n),(n=t.BackColour)&&(n=vk(n))&&(e.backgroundColor=n),t.Bold&&(e.fontWeight=Di),t.Italic&&(e.fontStyle=Pi),t.Underline&&e.textDecoration.push(Oi),(n=t.Spacing)&&(e.letterSpacing=n+"px"),n=t.Alignment)switch(parseInt(n,10)){case 1:e.displayAlign=Si,e.textAlign="start";break;case 2:e.displayAlign=Si,e.textAlign=bi;break;case 3:e.displayAlign=Si,e.textAlign="end";break;case 5:e.displayAlign="before",e.textAlign="start";break;case 6:e.displayAlign="before",e.textAlign=bi;break;case 7:e.displayAlign="before",e.textAlign="end";break;case 9:e.displayAlign="center",e.textAlign="start";break;case 10:e.displayAlign="center",e.textAlign=bi;break;case 11:e.displayAlign="center",e.textAlign="end"}(t=t.AlphaLevel)&&(e.opacity=parseFloat(t))}function vk(e){return e=parseInt(e.replace("&H",""),16),0<=e?"rgba("+(255&e)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null}function yk(e){return e=Ek.exec(e),3600*(e[1]?parseInt(e[1].replace(":",""),10):0)+60*parseInt(e[2],10)+parseFloat(e[3])}ar("application/ttml+xml",(function(){return new kI})),sk.prototype.parseInit=function(e){var t=!1;if((new ea).box("moov",ta).box("trak",ta).box("mdia",ta).box("minf",ta).box("stbl",ta).R("stsd",na).box("stpp",(function(e){t=!0,e.parser.stop()})).parse(e),!t)throw new je(2,2,2007)},sk.prototype.setSequenceMode=function(){},sk.prototype.setManifestType=function(){},sk.prototype.parseMedia=function(e,t,n){var i=[],r=null,s=[],a=new Map,o=[];if((new ea).box("moof",ta).box("traf",ta).R("tfhd",(function(e){r=vo(e.reader,e.flags).kd})).R("trun",(function(e){e=To(e.reader,e.version,e.flags),e=d(e.fg);for(var t=e.next();!t.done;t=e.next())o.push(t.value.sampleSize||r||0)})).R("subs",(function(e){for(var t=e.reader,n=t.S(),i=-1,r=0;r<n;r++){var s=t.S();i+=s,s=t.ma();for(var o=[],u=0;u<s;u++)1==e.version?o.push(t.S()):o.push(t.ma()),t.X(),t.X(),t.S();a.set(i,o)}})).box("mdat",sa((function(e){s.push(e)}))).parse(e,!1),0==s.length)throw new je(2,2,2007);for(var u=jt.apply(_t,h(s)),l=0,c=0;c<o.length;c++){var f=Ne(u,l,o[c]);l+=o[c];var p=a.get(c);if(p&&p.length){f=Ne(f,0,p[0]);for(var g=[],m=p[0],v=1;v<p.length;v++){var y=Ne(e,m,p[v]);y=Ot(y),g.push("data:image/png;base64,"+y),m+=p[v]}i=i.concat(this.g.parseMedia(f,t,n,g))}else i=i.concat(this.g.parseMedia(f,t,n,[]))}return i},K("shaka.text.Mp4TtmlParser",sk),sk.prototype.parseMedia=sk.prototype.parseMedia,sk.prototype.setManifestType=sk.prototype.setManifestType,sk.prototype.setSequenceMode=sk.prototype.setSequenceMode,sk.prototype.parseInit=sk.prototype.parseInit,ar('application/mp4; codecs="stpp"',(function(){return new sk})),ar('application/mp4; codecs="stpp.ttml"',(function(){return new sk})),ar('application/mp4; codecs="stpp.ttml.im1i"',(function(){return new sk})),ar('application/mp4; codecs="stpp.ttml.im1t"',(function(){return new sk})),ar('application/mp4; codecs="stpp.ttml.im2i"',(function(){return new sk})),ar('application/mp4; codecs="stpp.ttml.im2t"',(function(){return new sk})),ar('application/mp4; codecs="stpp.ttml.etd1"',(function(){return new sk})),ar('application/mp4; codecs="stpp.ttml.etd1|im1t"',(function(){return new sk})),ar('application/mp4; codecs="stpp.ttml.im1t|etd1"',(function(){return new sk})),ar('application/mp4; codecs="stpp.TTML.im1t"',(function(){return new sk})),ak.prototype.parseInit=function(){},ak.prototype.setSequenceMode=function(){},ak.prototype.setManifestType=function(e){this.g=e},ak.prototype.parseMedia=function(e,t){e=It(e),e=e.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");var n=e.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new je(2,2,2e3);if(e=t.vttOffset,"HLS"==this.g)if(n[0].includes("X-TIMESTAMP-MAP")){var i=n[0];if(e=i.match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),i=i.match(/MPEGTS:(\d+)/m),!e||!i)throw new je(2,2,2e3);if(e=In(e[1]),null==e)throw new je(2,2,2e3);i=Number(i[1]);for(var r=t.segmentStart-t.periodStart;95443.7176888889<=r;)r-=95443.7176888889,i+=8589934592;e=t.periodStart+i/9e4-e}else t.periodStart&&t.vttOffset==t.periodStart&&(e=0);for(t=[],i=d(n[0].split("\n")),r=i.next();!r.done;r=i.next())if(r=r.value,/^Region:/.test(r)){r=new Sn(r);var s=new pn;An(r),En(r);for(var a=An(r);a;){var o=s,u=a;(a=/^id=(.*)$/.exec(u))?o.id=a[1]:(a=/^width=(\d{1,2}|100)%$/.exec(u))?o.width=Number(a[1]):(a=/^lines=(\d+)$/.exec(u))?(o.height=Number(a[1]),o.heightUnits=2):(a=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(u))?(o.regionAnchorX=Number(a[1]),o.regionAnchorY=Number(a[2])):(a=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(u))?(o.viewportAnchorX=Number(a[1]),o.viewportAnchorY=Number(a[2])):/^scroll=up$/.exec(u)&&(o.scroll="up"),En(r),a=An(r)}t.push(s)}for(i=new Map,pi(i),r=[],n=d(n.slice(1)),s=n.next();!s.done;s=n.next()){if(s=s.value.split("\n"),(1!=s.length||s[0])&&!/^NOTE($|[ \t])/.test(s[0])&&"STYLE"==s[0]){for(o=[],a=-1,u=1;u<s.length;u++)s[u].includes("::cue")&&(o.push([]),a=o.length-1),-1!=a&&(o[a].push(s[u]),s[u].includes("}")&&(a=-1));for(o=d(o),a=o.next();!a.done;a=o.next()){var l=a.value;a="global",(u=l[0].match(/\((.*)\)/))&&(a=u.pop()),u=l.slice(1,-1),l[0].includes("}")&&(l=/\{(.*?)\}/.exec(l[0]))&&(u=l[1].split(";")),(l=i.get(a))||(l=new ci(0,0,""));for(var c=!1,h=0;h<u.length;h++){var f=/^\s*([^:]+):\s*(.*)/.exec(u[h]);if(f){var p=f[2].trim().replace(";","");switch(f[1].trim()){case"background-color":case"background":c=!0,l.backgroundColor=p;break;case"color":c=!0,l.color=p;break;case"font-family":c=!0,l.fontFamily=p;break;case"font-size":c=!0,l.fontSize=p;break;case"font-weight":(700<=parseInt(p,10)||"bold"==p)&&(c=!0,l.fontWeight=Di);break;case"font-style":switch(p){case"normal":c=!0,l.fontStyle=Mi;break;case"italic":c=!0,l.fontStyle=Pi;break;case"oblique":c=!0,l.fontStyle="oblique"}break;case"opacity":c=!0,l.opacity=parseFloat(p);break;case"text-combine-upright":c=!0,l.textCombineUpright=p;break;case"text-shadow":c=!0,l.textShadow=p;break;case"white-space":c=!0,l.wrapLine="noWrap"!=p}}}c&&i.set(a,l)}}if(l=s,c=e,1==l.length&&!l[0]||/^NOTE($|[ \t])/.test(l[0])||"STYLE"==l[0]||"REGION"==l[0])s=null;else if(s=null,l[0].includes("--\x3e")||(s=l[0],l.splice(0,1)),o=new Sn(l[0]),a=xn(o),h=wn(o,/[ \t]+--\x3e[ \t]+/g),u=xn(o),null==a||null==h||null==u)Z("Failed to parse VTT time code. Cue skipped:",s,l),s=null;else{for(a+=c,u+=c,c=l.slice(1).join("\n").trim(),i.has("global")?(l=i.get("global").clone(),l.startTime=a,l.endTime=u,l.payload=c):l=new ci(a,u,c),En(o),a=An(o);a;)ok(l,a,t),En(o),a=An(o);fi(l,i),null!=s&&(l.id=s),s=l}s&&r.push(s)}return r},K("shaka.text.VttTextParser",ak),ak.prototype.parseMedia=ak.prototype.parseMedia,ak.prototype.setManifestType=ak.prototype.setManifestType,ak.prototype.setSequenceMode=ak.prototype.setSequenceMode,ak.prototype.parseInit=ak.prototype.parseInit,ar("text/vtt",(function(){return new ak})),ar('text/vtt; codecs="vtt"',(function(){return new ak})),ar('text/vtt; codecs="wvtt"',(function(){return new ak})),lk.prototype.parseInit=function(e){var t=this,n=!1;if((new ea).box("moov",ta).box("trak",ta).box("mdia",ta).R("mdhd",(function(e){e=bo(e.reader,e.version),t.g=e.timescale})).box("minf",ta).box("stbl",ta).R("stsd",na).box("wvtt",(function(){n=!0})).parse(e),!this.g)throw new je(2,2,2008);if(!n)throw new je(2,2,2008)},lk.prototype.setSequenceMode=function(){},lk.prototype.setManifestType=function(){},lk.prototype.parseMedia=function(e,t){if(!e.length)return[];if(!this.g)throw new je(2,2,2008);var n,i=0,r=[],s=[],a=!1,o=!1,u=!1,l=null;if((new ea).box("moof",ta).box("traf",ta).R("tfdt",(function(e){a=!0,i=yo(e.reader,e.version).baseMediaDecodeTime})).R("tfhd",(function(e){l=vo(e.reader,e.flags).jd})).R("trun",(function(e){o=!0,r=To(e.reader,e.version,e.flags).fg})).box("mdat",sa((function(e){u=!0,n=e}))).parse(e,!1),!u&&!a&&!o)throw new je(2,2,2008);e=i;for(var c=new Qs(n,0),h=d(r),f=h.next();!f.done;f=h.next()){f=f.value;var p=f.gg||l,g=f.ze?i+f.ze:e;e=g+(p||0);var m=0;do{var v=c.S();m+=v;var y=c.S(),b=null;"vttc"==oa(y)?8<v&&(b=c.Cb(v-8)):c.skip(v-8),p&&b&&(v=ck(b,t.periodStart+g/this.g,t.periodStart+e/this.g),s.push(v))}while(f.sampleSize&&m<f.sampleSize)}return s.filter(vr)},K("shaka.text.Mp4VttParser",lk),lk.prototype.parseMedia=lk.prototype.parseMedia,lk.prototype.setManifestType=lk.prototype.setManifestType,lk.prototype.setSequenceMode=lk.prototype.setSequenceMode,lk.prototype.parseInit=lk.prototype.parseInit,ar('application/mp4; codecs="wvtt"',(function(){return new lk})),hk.prototype.parseInit=function(){},hk.prototype.setSequenceMode=function(){},hk.prototype.setManifestType=function(){},hk.prototype.parseMedia=function(e){var t=It(e).replace(/\r+/g,"");if(t=t.trim(),e=[],""==t)return e;t=d(t.split("\n\n"));for(var n=t.next();!n.done;n=t.next()){n=n.value.split("\n");var i=new Sn(n[0]),r=xn(i),s=wn(i,/,/g);if(i=xn(i),null==r||null==s||null==i)throw new je(2,2,2001,"Could not parse cue time range in SubViewer");e.push(new ci(r,i,n.slice(1).join("\n").trim()))}return e},K("shaka.text.SbvTextParser",hk),hk.prototype.parseMedia=hk.prototype.parseMedia,hk.prototype.setManifestType=hk.prototype.setManifestType,hk.prototype.setSequenceMode=hk.prototype.setSequenceMode,hk.prototype.parseInit=hk.prototype.parseInit,ar("text/x-subviewer",(function(){return new hk})),fk.prototype.parseInit=function(){},fk.prototype.setSequenceMode=function(){},fk.prototype.setManifestType=function(){},fk.prototype.parseMedia=function(e,t,n){return e=It(e),e=pk(e),e=Ne(Rt(e)),this.g.parseMedia(e,t,n,[])},K("shaka.text.SrtTextParser",fk),fk.srt2webvtt=pk,fk.prototype.parseMedia=fk.prototype.parseMedia,fk.prototype.setManifestType=fk.prototype.setManifestType,fk.prototype.setSequenceMode=fk.prototype.setSequenceMode,fk.prototype.parseInit=fk.prototype.parseInit,ar("text/srt",(function(){return new fk})),gk.prototype.parseInit=function(){},gk.prototype.setSequenceMode=function(){},gk.prototype.setManifestType=function(){},gk.prototype.parseMedia=function(e){var t="",n="",i=null,r=null;for(r=It(e).split(/\r?\n\s*\r?\n/),e=d(r),r=e.next();!r.done;r=e.next()){var s=r.value;r=s,(s=bk.exec(s))&&(i=s[1],r=s[2]),"V4 Styles"==i||"V4+ Styles"==i?(t=r,t=n?t+"\n"+r:r):"Events"==i&&(n=n?n+"\n"+r:r)}for(i=[],r=null,t=d(t.split(/\r?\n/)),e=t.next();!e.done;e=t.next())if(e=e.value,!/^\s*;/.test(e)&&(s=Tk.exec(e)))if(e=s[1].trim(),s=s[2].trim(),"Format"==e)r=s.split(Sk);else if("Style"==e){e=s.split(Sk),s={};for(var a=0;a<r.length&&a<e.length;a++)s[r[a]]=e[a];i.push(s)}for(r=[],t=null,n=d(n.split(/\r?\n/)),s=n.next(),e={};!s.done;e={Ch:void 0},s=n.next())if(s=s.value,!/^\s*;/.test(s)&&(a=Tk.exec(s)))if(s=a[1].trim(),a=a[2].trim(),"Format"==s)t=a.split(Sk);else if("Dialogue"==s){a=a.split(Sk),s={};for(var o=0;o<t.length&&o<a.length;o++)s[t[o]]=a[o];o=yk(s.Start);var u=yk(s.End);a=new ci(o,u,a.slice(t.length-1).join(",").replace(/\\N/g,"\n").replace(/\{[^}]+\}/g,"")),e.Ch=s.Style,(e=i.find(function(e){return function(t){return t.Name==e.Ch}}(e)))&&mk(a,e),r.push(a)}return r},K("shaka.text.SsaTextParser",gk),gk.prototype.parseMedia=gk.prototype.parseMedia,gk.prototype.setManifestType=gk.prototype.setManifestType,gk.prototype.setSequenceMode=gk.prototype.setSequenceMode,gk.prototype.parseInit=gk.prototype.parseInit;var bk=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,Tk=/^\s*([^:]+):\s*(.*)/,Sk=/\s*,\s*/,Ek=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;function wk(e,t){var n=1&e[t+1]?7:9;return t+n<=e.length&&(e=((3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5)-n,0<e)?{sd:n,ia:e}:null}function Ak(e,t){var n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=(60&e[t+2])>>>2;if(i>n.length-1)return null;var r=((192&e[t+2])>>>6)+1,s=(1&e[t+2])<<2;return s|=(192&e[t+3])>>>6,{sampleRate:n[i],channelCount:s,codec:"mp4a.40."+r}}function xk(e,t){if(t+1<e.length&&255===e[t]&&240===(246&e[t+1])){var n=1&e[t+1]?7:9;if(t+n>=e.length)return!1;var i=(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5;return!(i<=n)&&(t+=i,t===e.length||t+1<e.length&&255===e[t]&&240===(246&e[t+1]))}return!1}function Ik(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t||3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}function kk(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function Lk(e,t){if(t+8>e.length||11!==e[t]||119!==e[t+1])return null;var n=e[t+4]>>6;if(3<=n)return null;var i=63&e[t+4],r=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*i+n];if(t+r>e.length)return null;var s=e[t+6]>>5,a=0;2===s?a+=2:(1&s&&1!==s&&(a+=2),4&s&&(a+=2)),a=(e[t+6]<<8|e[t+7])>>12-a&1;var o=7&e[t+5];return e=new Uint8Array([n<<6|e[t+5]>>3<<1|o>>2,(3&o)<<6|s<<3|a<<2|i>>4,i<<4&224]),{sampleRate:[48e3,44100,32e3][n],channelCount:[2,1,2,3,3,4,4,5][s]+a,ra:e,ia:r}}function Rk(e,t){if(11===e[t]&&119===e[t+1]){var n,i,r=0,s=5;for(t+=s;0<s;){i=e[t];var a=Math.min(s,8),o=8-a;n=4278190080>>>24+o<<o,n=(i&n)>>o,r=r?r<<a|n:n,t+=1,s-=a}if(16>r)return!0}return!1}function Ck(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function Dk(e,t){if(t+8>e.length||2935!==(e[t]<<8|e[t+1]))return null;var n=new Ru(e.subarray(t+2));Du(n,2),Du(n,3);var i=Mu(n,11)+1<<1,r=Mu(n,2);if(3==r){r=Mu(n,2),r=[24e3,22060,16e3][r];var s=3}else r=[48e3,44100,32e3][r],s=Mu(n,2);var a=Mu(n,3),o=Mu(n,1);return n=Mu(n,5),t+i>e.byteLength?null:(e=Math.floor(i*r/(16*[1,2,3,6][s])),e=new Uint8Array([(8160&e)>>5,(31&e)<<3,r<<6|n<<1,a<<1|o,0]),{sampleRate:r,channelCount:[2,1,2,3,3,4,4,5][a]+o,ra:e,ia:i})}function Mk(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function Pk(e){if(!e.length)return null;var t=e.find((function(e){return 7==e.type}));if(e=e.find((function(e){return 8==e.type})),!t||!e)return null;var n=new Ru(t.data),i=Fu(n);if(Fu(n),Fu(n),_u(n),Ok.includes(i)&&(i=Ou(n),3===i&&Du(n,1),_u(n),_u(n),Du(n,1),Uu(n))){i=3!==i?8:12;for(var r=0;r<i;r++)Uu(n)&&Bu(n,6>r?16:64)}if(_u(n),i=Ou(n),0===i)Ou(n);else if(1===i)for(Du(n,1),_u(n),_u(n),i=Ou(n),r=0;r<i;r++)_u(n);_u(n),Du(n,1);var s=Ou(n),a=Ou(n),o=Mu(n,1);0===o&&Du(n,1),Du(n,1);var u=0,l=0,c=0,d=0;if(Uu(n)&&(u=Ou(n),l=Ou(n),c=Ou(n),d=Ou(n)),r=i=1,Uu(n)&&Uu(n)){var f=Fu(n),p=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],g=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];0<f&&16>=f?(i=p[f-1],r=g[f-1]):255===f&&(i=Mu(n,16),r=Mu(n,16))}return n=(2-o)*(a+1)*16-2*c-2*d,s=16*(s+1)-2*u-2*l,u=[],t=t.fullData,u.push(t.byteLength>>>8&255),u.push(255&t.byteLength),u=u.concat.apply(u,h(t)),t=[],e=e.fullData,t.push(e.byteLength>>>8&255),t.push(255&e.byteLength),t=t.concat.apply(t,h(e)),e=new Uint8Array([1,u[3],u[4],u[5],255,225].concat(u,[1],t)),{height:n,width:s,Ba:e,Ha:i,Ja:r}}function _k(e){function t(e){r={data:new Uint8Array([]),frame:!1,isKeyframe:!1,pts:e.pts,dts:e.dts,nalus:[]}}function n(){if(r&&r.nalus.length&&r.frame){for(var e=[],t=d(r.nalus),n=t.next();!n.done;n=t.next()){n=n.value;var s=n.fullData.byteLength,a=new Uint8Array(4);a[0]=s>>24&255,a[1]=s>>16&255,a[2]=s>>8&255,a[3]=255&s,e.push(a),e.push(n.fullData)}r.data=jt.apply(_t,h(e)),i.push(r)}}for(var i=[],r=null,s=!1,a=0;a<e.length;a++){var o=e[a],u=o.nalus,l=!1;r&&u.length&&!s&&(n(),t(o)),u=d(o.nalus);for(var c=u.next();!c.done;c=u.next()){c=c.value;var f=!1;switch(c.type){case 1:var p=!1;f=!0;var g=c.data;l&&4<g.length&&(g=ju(new Ru(g)),2===g||4===g||7===g||9===g)&&(p=!0),p&&r&&r.frame&&!r.isKeyframe&&(n(),r=null),r||t(o),r.frame=!0,r.isKeyframe=p;break;case 5:f=!0,r&&r.frame&&!r.isKeyframe&&(n(),r=null),r||t(o),r.frame=!0,r.isKeyframe=!0;break;case 6:f=!0;break;case 7:l=f=!0;break;case 8:f=!0;break;case 9:s=f=!0,r&&r.frame&&(n(),r=null),r||t(o);break;case 12:f=!0;break;default:f=!1}r&&f&&r.nalus.push(c)}}return n(),i}ar("text/x-ssa",(function(){return new gk})),i=kk.prototype,i.destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/aac"==e.toLowerCase().split(";")[0]&&tn(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/aac"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="'+(er(t)||"mp4a.40.2")+'"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){for(var r=Ne(e),s=Lu(r),a=s.length;a<r.length&&!xk(r,a);a++);if(e=1e3*n.endTime,s=ku(s),s.length&&n&&(s=s.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(e=s.data),s=Ak(r,a),!s)return Promise.reject(new je(2,3,3018,n?n.N()[0]:null));t.audioSamplingRate=s.sampleRate,t.channelsCount=s.channelCount;for(var o=[];a<r.length;){var u=wk(r,a);if(!u)return Promise.reject(new je(2,3,3018,n?n.N()[0]:null));var l=u.sd+u.ia;a+l<=r.length&&o.push({data:r.subarray(a+u.sd,a+l),size:u.ia,duration:1024,bb:0,flags:{fb:0,Ya:0,Xa:0,Va:0,Wa:2,gb:0}}),a+=l}return r=s.sampleRate,e=Math.floor(e*r/1e3),i={id:t.id,type:"audio",codecs:s.codec,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:i,jb:[],ra:new Uint8Array([]),Ba:new Uint8Array([]),Ha:0,Ja:0,data:{Db:this.h,baseMediaDecodeTime:e,hb:o},stream:t},i=new Io([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=ko(i),this.g.set(n,t)),n=this.i!==t,i=Mo(i),this.i=t,this.h++,n?(t=jt(t,i),Promise.resolve(t)):Promise.resolve(i)},K("shaka.transmuxer.AacTransmuxer",kk),kk.prototype.transmux=kk.prototype.transmux,kk.prototype.getOriginalMimeType=kk.prototype.getOriginalMimeType,kk.prototype.convertCodecs=kk.prototype.convertCodecs,kk.prototype.isSupported=kk.prototype.isSupported,kk.prototype.destroy=kk.prototype.destroy,Fi("audio/aac",(function(){return new kk("audio/aac")}),$i),i=Ck.prototype,i.destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/ac3"==e.toLowerCase().split(";")[0]&&tn(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/ac3"==t.toLowerCase().split(";")[0]?nt()?'audio/mp4; codecs="ec-3"':'audio/mp4; codecs="ac-3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){e=Ne(e);for(var r=Lu(e),s=r.length;s<e.length&&!Rk(e,s);s++);var a=1e3*n.endTime;r=ku(r),r.length&&n&&(r=r.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(a=r.data),r=0;for(var o=new Uint8Array([]),u=[];s<e.length;){var l=Lk(e,s);if(!l)return Promise.reject(new je(2,3,3018,n?n.N()[0]:null));t.audioSamplingRate=l.sampleRate,t.channelsCount=l.channelCount,r=l.sampleRate,o=l.ra,u.push({data:e.subarray(s,s+l.ia),size:l.ia,duration:1536,bb:0,flags:{fb:0,Ya:0,Xa:0,Va:0,Wa:2,gb:0}}),s+=l.ia}return e=Math.floor(a*r/1e3),i={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:i,jb:[],ra:o,Ba:new Uint8Array([]),Ha:0,Ja:0,data:{Db:this.h,baseMediaDecodeTime:e,hb:u},stream:t},i=new Io([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=ko(i),this.g.set(n,t)),n=this.i!==t,i=Mo(i),this.i=t,this.h++,n?(t=jt(t,i),Promise.resolve(t)):Promise.resolve(i)},K("shaka.transmuxer.Ac3Transmuxer",Ck),Ck.prototype.transmux=Ck.prototype.transmux,Ck.prototype.getOriginalMimeType=Ck.prototype.getOriginalMimeType,Ck.prototype.convertCodecs=Ck.prototype.convertCodecs,Ck.prototype.isSupported=Ck.prototype.isSupported,Ck.prototype.destroy=Ck.prototype.destroy,Fi("audio/ac3",(function(){return new Ck("audio/ac3")}),$i),i=Mk.prototype,i.destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/ec3"==e.toLowerCase().split(";")[0]&&tn(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/ec3"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="ec-3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){e=Ne(e);for(var r=Lu(e),s=r.length;s<e.length&&2935!==(e[s]<<8|e[s+1]);s++);var a=1e3*n.endTime;r=ku(r),r.length&&n&&(r=r.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(a=r.data),r=0;for(var o=new Uint8Array([]),u=[];s<e.length;){var l=Dk(e,s);if(!l)return Promise.reject(new je(2,3,3018,n?n.N()[0]:null));t.audioSamplingRate=l.sampleRate,t.channelsCount=l.channelCount,r=l.sampleRate,o=l.ra,u.push({data:e.subarray(s,s+l.ia),size:l.ia,duration:1536,bb:0,flags:{fb:0,Ya:0,Xa:0,Va:0,Wa:2,gb:0}}),s+=l.ia}return e=Math.floor(a*r/1e3),i={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:i,jb:[],ra:o,Ba:new Uint8Array([]),Ha:0,Ja:0,data:{Db:this.h,baseMediaDecodeTime:e,hb:u},stream:t},i=new Io([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=ko(i),this.g.set(n,t)),n=this.i!==t,i=Mo(i),this.i=t,this.h++,n?(t=jt(t,i),Promise.resolve(t)):Promise.resolve(i)},K("shaka.transmuxer.Ec3Transmuxer",Mk),Mk.prototype.transmux=Mk.prototype.transmux,Mk.prototype.getOriginalMimeType=Mk.prototype.getOriginalMimeType,Mk.prototype.convertCodecs=Mk.prototype.convertCodecs,Mk.prototype.isSupported=Mk.prototype.isSupported,Mk.prototype.destroy=Mk.prototype.destroy,Fi("audio/ec3",(function(){return new Mk("audio/ec3")}),$i);var Ok=[100,110,122,244,44,83,86,118,128,138,139,134];function Nk(e){if(!e.length)return null;var t=e.find((function(e){return 32==e.type})),n=e.find((function(e){return 33==e.type})),i=e.find((function(e){return 34==e.type}));if(!t||!n||!i)return null;var r=Uk(t.fullData);e=Fk(n.fullData);var s=Bk(i.fullData);return t=jk(t.fullData,n.fullData,i.fullData,{Uf:r.Uf,rg:r.rg,Ef:e.Ef,Ff:e.Ff,yf:e.yf,Df:e.Df,zf:e.zf,Af:e.Af,Bf:e.Bf,Cf:e.Cf,rf:e.rf,tf:e.tf,uf:e.uf,vf:e.vf,wf:e.wf,xf:e.xf,hf:e.hf,ne:e.ne,ff:e.ff,ef:e.ef,df:e.df,Wf:s.Wf}),{height:e.height,width:e.width,Ba:t,Ha:e.vj,Ja:e.uj}}function Uk(e){var t=new Ru(e,!0);return Fu(t),Fu(t),Mu(t,4),Mu(t,2),Mu(t,6),e=Mu(t,3),t=Uu(t),{Uf:e+1,rg:t}}function Fk(e){e=new Ru(e,!0),Fu(e),Fu(e);var t=0,n=0,i=0,r=0;Mu(e,4);var s=Mu(e,3);Uu(e);for(var a=Mu(e,2),o=Mu(e,1),u=Mu(e,5),l=Fu(e),c=Fu(e),d=Fu(e),h=Fu(e),f=Fu(e),p=Fu(e),g=Fu(e),m=Fu(e),v=Fu(e),y=Fu(e),b=Fu(e),T=[],S=[],E=0;E<s;E++)T.push(Uu(e)),S.push(Uu(e));if(0<s)for(E=s;8>E;E++)Mu(e,2);for(E=0;E<s;E++)T[E]&&Mu(e,88),S[E]&&Fu(e);Ou(e),T=Ou(e),3==T&&Mu(e,1),S=Ou(e),E=Ou(e),Uu(e)&&(t+=Ou(e),n+=Ou(e),i+=Ou(e),r+=Ou(e));var w=Ou(e),A=Ou(e),x=Ou(e);if(Uu(e))for(var I=0;I<=s;I++)Ou(e),Ou(e),Ou(e);else Ou(e),Ou(e),Ou(e);if(Ou(e),Ou(e),Ou(e),Ou(e),Ou(e),Ou(e),Uu(e)&&Uu(e))for(I=0;4>I;I++)for(var k=0;k<(3===I?2:6);k++)if(Uu(e)){var L=Math.min(64,1<<4+(I<<1));1<I&&Nu(e);for(var R=0;R<L;R++)Nu(e)}else Ou(e);for(Uu(e),Uu(e),Uu(e)&&(Fu(e),Ou(e),Ou(e),Uu(e)),I=Ou(e),L=k=0;L<I;L++)if(R=!1,0!==L&&(R=Uu(e)),R){L===I&&Ou(e),Uu(e),Ou(e);for(var C=R=0;C<=k;C++){var D=Uu(e),M=!1;D||(M=Uu(e)),(D||M)&&R++}k=R}else{for(C=Ou(e),R=Ou(e),k=C+R,D=0;D<C;D++)Ou(e),Uu(e);for(C=0;C<R;C++)Ou(e),Uu(e)}if(Uu(e))for(I=Ou(e),k=0;k<I;k++){for(L=0;L<x+4;L++)Mu(e,1);Mu(e,1)}if(I=x=1,k=0,Uu(e),Uu(e),Uu(e)){if(Uu(e)&&(L=Fu(e),R=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],C=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1],0<L&&16>=L?(x=R[L-1],I=C[L-1]):255===L&&(x=Mu(e,16),I=Mu(e,16))),Uu(e)&&Uu(e),Uu(e)&&(Mu(e,3),Uu(e),Uu(e)&&(Fu(e),Fu(e),Fu(e))),Uu(e)&&(Ou(e),Ou(e)),Uu(e),Uu(e),Uu(e),(L=Uu(e))&&(Ou(e),Ou(e),Ou(e),Ou(e)),Uu(e)&&(Mu(e,32),Mu(e,32),Uu(e)&&Ou(e),Uu(e)))for(C=!1,L=Uu(e),R=Uu(e),(L||R)&&((C=Uu(e))&&(Fu(e),Mu(e,5),Uu(e),Mu(e,5)),Mu(e,4),Mu(e,4),C&&Mu(e,4),Mu(e,5),Mu(e,5),Mu(e,5)),D=0;D<=s;D++){var P=!0;M=1,Uu(e)||(P=Uu(e));var _=!1;if(P?Ou(e):_=Uu(e),_||(M=Ou(e)+1),L){for(P=0;P<M;P++)Ou(e),Ou(e),C&&(Ou(e),Ou(e));Uu(e)}if(R){for(P=0;P<M;P++)Ou(e),Ou(e),C&&(Ou(e),Ou(e));Uu(e)}}Uu(e)&&(Uu(e),Uu(e),Uu(e),k=Ou(e),Ou(e),Ou(e),Ou(e),Ou(e))}return{yf:b,Ef:a,Ff:o,Df:u,zf:l,Af:c,Bf:d,Cf:h,rf:f,tf:p,uf:g,vf:m,wf:v,xf:y,ne:k,hf:0,ff:T,ef:w,df:A,width:S-(t+n)*(1===T||2===T?2:1),height:E-(i+r)*(1===T?2:1),vj:x,uj:I}}function Bk(e){var t=new Ru(e,!0);Fu(t),Fu(t),Ou(t),Ou(t),Uu(t),Uu(t),Mu(t,3),Uu(t),Uu(t),Ou(t),Ou(t),Nu(t),Uu(t),Uu(t),Uu(t)&&Ou(t),Nu(t),Nu(t),Uu(t),Uu(t),Uu(t),Uu(t),e=Uu(t),t=Uu(t);var n=1;return t&&e?n=0:t?n=3:e&&(n=2),{Wf:n}}function jk(e,t,n,i){var r=new Uint8Array(23+(5+e.byteLength)+(5+t.byteLength)+(5+n.byteLength));return r[0]=1,r[1]=(3&i.Ef)<<6|(i.Ff?1:0)<<5|31&i.Df,r[2]=i.zf,r[3]=i.Af,r[4]=i.Bf,r[5]=i.Cf,r[6]=i.rf,r[7]=i.tf,r[8]=i.uf,r[9]=i.vf,r[10]=i.wf,r[11]=i.xf,r[12]=i.yf,r[13]=240|(3840&i.ne)>>8,r[14]=255&i.ne,r[15]=252|3&i.Wf,r[16]=252|3&i.ff,r[17]=248|7&i.ef,r[18]=248|7&i.df,r[19]=0,r[20]=0,r[21]=(3&i.hf)<<6|(7&i.Uf)<<3|(i.rg?1:0)<<2|3,r[22]=3,r[23]=160,r[24]=0,r[25]=1,r[26]=(65280&e.byteLength)>>8,r[27]=255&e.byteLength,r.set(e,28),r[23+(5+e.byteLength)]=161,r[e.byteLength+29]=0,r[e.byteLength+30]=1,r[e.byteLength+31]=(65280&t.byteLength)>>8,r[e.byteLength+32]=255&t.byteLength,r.set(t,e.byteLength+33),r[23+(e.byteLength+10+t.byteLength)]=162,r[e.byteLength+10+t.byteLength+24]=0,r[e.byteLength+10+t.byteLength+25]=1,r[e.byteLength+10+t.byteLength+26]=(65280&n.byteLength)>>8,r[e.byteLength+10+t.byteLength+27]=255&n.byteLength,r.set(n,e.byteLength+10+t.byteLength+28),r}function $k(e,t){var n=e[t+1]>>3&3,i=e[t+1]>>1&3,r=e[t+2]>>4&15,s=e[t+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==s){var a=e[t+3]>>6;r=1e3*Hk[14*(3===n?3-i:3===i?3:4)+r-1],s=Kk[3*(3===n?0:2===n?1:2)+s],n=Wk[n][i];var o=qk[i],u=Math.floor(n*r/s+(e[t+2]>>1&1))*o,l=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);return(l=l?parseInt(l[1],10):0)&&87>=l&&2===i&&224e3<=r&&0===a&&(e[t+3]|=128),{sampleRate:s,channelCount:3===a?1:2,ia:u,tj:8*n*o}}return null}function Gk(e,t){return 255===e[t]&&224===(224&e[t+1])&&0!==(6&e[t+1])}function Vk(e,t){if(t+1<e.length&&Gk(e,t)){var n=$k(e,t),i=4;return n&&n.ia&&(i=n.ia),t+=i,t===e.length||t+1<e.length&&Gk(e,t)}return!1}var Hk=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Kk=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Wk=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],qk=[0,1,1,4];function Yk(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function Xk(e){this.h=e,this.g=null}
/*
 @license
 MSS Transmuxer
 Copyright 2015 Dash Industry Forum
 SPDX-License-Identifier: BSD-3-Clause
*/
function zk(e){this.h=e,(this.g=_T.get("ISOBoxer")())&&Qk(this)}function Qk(e){function t(){this._procFullBox(),1&this.flags&&(this._procField("AlgorithmID","uint",24),this._procField("IV_size","uint",8),this._procFieldArray("KID",16,"uint",8)),this._procField("sample_count","uint",32),this._procEntries("entry",this.sample_count,(function(e){this._procEntryField(e,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(e,"NumberOfEntries","uint",16),this._procSubEntries(e,"clearAndCryptedData",e.NumberOfEntries,(function(e){this._procEntryField(e,"BytesOfClearData","uint",16),this._procEntryField(e,"BytesOfEncryptedData","uint",32)})))}))}e.g.addBoxProcessor("saio",(function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",1===this.version?64:32)})),e.g.addBoxProcessor("saiz",(function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),0===this.default_sample_info_size&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)})),e.g.addBoxProcessor("senc",t),e.g.addBoxProcessor("uuid",(function(){for(var e=!0,n=0;16>n;n++)this.usertype[n]!==Zk[n]&&(e=!1);e&&(this._parsing&&(this.type="sepiff"),t.call(this))}))}function Jk(e,t){for(var n=8,i=0;i<e.boxes.length&&e.boxes[i].type!==t;i++)n+=e.boxes[i].size;return n}i=Yk.prototype,i.destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/mpeg"==e.toLowerCase().split(";")[0]&&tn(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/mpeg"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="mp3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){for(var r=Ne(e),s=Lu(r).length;s<r.length&&!Vk(r,s);s++);var a;for(e=[];s<r.length;){var o=$k(r,s);if(!o)return Promise.reject(new je(2,3,3018,n?n.N()[0]:null));a||(a=o),s+o.ia<=r.length&&e.push({data:r.subarray(s,s+o.ia),size:o.ia,duration:1152,bb:0,flags:{fb:0,Ya:0,Xa:0,Va:0,Wa:2,gb:0}}),s+=o.ia}return a?(r=9e4*a.tj/a.sampleRate*this.h,i={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:a.sampleRate,duration:i,jb:[],ra:new Uint8Array([]),Ba:new Uint8Array([]),Ha:0,Ja:0,data:{Db:this.h,baseMediaDecodeTime:r,hb:e},stream:t},i=new Io([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=ko(i),this.g.set(n,t)),n=this.i!==t,i=Mo(i),this.i=t,this.h++,n?(t=jt(t,i),Promise.resolve(t)):Promise.resolve(i)):Promise.reject(new je(2,3,3018,n?n.N()[0]:null))},K("shaka.transmuxer.Mp3Transmuxer",Yk),Yk.prototype.transmux=Yk.prototype.transmux,Yk.prototype.getOriginalMimeType=Yk.prototype.getOriginalMimeType,Yk.prototype.convertCodecs=Yk.prototype.convertCodecs,Yk.prototype.isSupported=Yk.prototype.isSupported,Yk.prototype.destroy=Yk.prototype.destroy,Fi("audio/mpeg",(function(){return new Yk("audio/mpeg")}),$i),i=Xk.prototype,i.destroy=function(){},i.isSupported=function(e){if("video/mp2t"!=e.toLowerCase().split(";")[0])return!1;var t=er(e).split(","),n=Kt("audio",t);return t=Kt("video",t),!(!n||t||"mp3"!=Qi(n))&&tn(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"video/mp2t"==t.toLowerCase().split(";")[0]?"audio/mpeg":t},i.getOriginalMimeType=function(){return this.h},i.transmux=function(e,t,n,i,r){if(this.g?this.g.clearData():this.g=new $u,e=Ne(e),e=this.g.parse(e),"mp3"!=e.md().audio||"audio"!=r)return Promise.reject(new je(2,3,3018,n?n.N()[0]:null));for(n=new Uint8Array([]),r=d(e.cb()),e=r.next();!e.done;e=r.next())if(e=e.value.data)for(t=0;t<e.length;)(i=$k(e,t))?(t+i.ia<=e.length&&(n=jt(n,e.subarray(t,t+i.ia))),t+=i.ia):t++;return Promise.resolve(n)},K("shaka.transmuxer.MpegTsTransmuxer",Xk),Xk.prototype.transmux=Xk.prototype.transmux,Xk.prototype.getOriginalMimeType=Xk.prototype.getOriginalMimeType,Xk.prototype.convertCodecs=Xk.prototype.convertCodecs,Xk.prototype.isSupported=Xk.prototype.isSupported,Xk.prototype.destroy=Xk.prototype.destroy,Fi("video/mp2t",(function(){return new Xk("video/mp2t")}),Gi),i=zk.prototype,i.destroy=function(){},i.isSupported=function(e,t){var n=e.startsWith("mss/");return!(!this.g||!n)&&(t?tn(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),tn(t)||tn(e)))},i.convertCodecs=function(e,t){return t.replace("mss/","")},i.getOriginalMimeType=function(){return this.h},i.transmux=function(e,t,n){if(!n)return Promise.resolve(Ne(e));if(!t.mssPrivateData)return Promise.reject(new je(2,3,3020,n?n.N()[0]:null));try{var i,r=this.g.parseBuffer(e),s=r.fetch("tfhd");s.track_ID=t.id+1;var a=r.fetch("tfdt"),o=r.fetch("traf");null===a&&(a=this.g.createFullBox("tfdt",o,s),a.version=1,a.flags=0,a.baseMediaDecodeTime=Math.floor(n.startTime*t.mssPrivateData.timescale));var u=r.fetch("trun"),l=r.fetch("tfxd");l&&l._parent.boxes.splice(l._parent.boxes.indexOf(l),1);var c=r.fetch("tfrf");c&&c._parent.boxes.splice(c._parent.boxes.indexOf(c),1);var d=r.fetch("sepiff");if(null!==d){d.type="senc",d.usertype=void 0;var h=r.fetch("saio");if(null===h){h=this.g.createFullBox("saio",o),h.version=0,h.flags=0,h.entry_count=1,h.offset=[0];var f=this.g.createFullBox("saiz",o);if(f.version=0,f.flags=0,f.sample_count=d.sample_count,f.default_sample_info_size=0,f.sample_info_size=[],2&d.flags)for(i=0;i<d.sample_count;i+=1)f.sample_info_size[i]=10+6*d.entry[i].NumberOfEntries;else f.default_sample_info_size=8}}s.flags&=16777214,s.flags|=131072,u.flags|=1;var p=r.fetch("moof");u.data_offset=p.getLength()+8;var g=r.fetch("saio");null!==g&&(g.offset[0]=Jk(p,"traf")+Jk(o,"senc")+16);var m=Ne(r.write());return Promise.resolve(m)}catch(v){return v instanceof je?Promise.reject(v):Promise.reject(new je(2,3,3022,n?n.N()[0]:null))}},K("shaka.transmuxer.MssTransmuxer",zk),zk.prototype.transmux=zk.prototype.transmux,zk.prototype.getOriginalMimeType=zk.prototype.getOriginalMimeType,zk.prototype.convertCodecs=zk.prototype.convertCodecs,zk.prototype.isSupported=zk.prototype.isSupported,zk.prototype.destroy=zk.prototype.destroy;var Zk=new Uint8Array([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244]);function eL(e){this.m=e,this.g=0,this.i=new Map,this.l=this.h=this.j=null}Fi("mss/audio/mp4",(function(){return new zk("mss/audio/mp4")}),$i),Fi("mss/video/mp4",(function(){return new zk("mss/video/mp4")}),$i),i=eL.prototype,i.destroy=function(){this.i.clear(),this.h&&this.h.destroy()},i.isSupported=function(e,t){if("video/mp2t"!=e.toLowerCase().split(";")[0])return!1;var n=e;t&&(n=this.convertCodecs(t,e));var i=er(n).split(",");return n=Kt("audio",i),i=Kt("video",i),!(n&&(n=Qi(n),!iL.includes(n))||i&&(n=Qi(i),!rL.includes(n)))&&(t?tn(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),tn(t)||tn(e)))},i.convertCodecs=function(e,t){return"video/mp2t"==t.toLowerCase().split(";")[0]?(t=er(t).replace("mp4a.40.34","mp3").split(",").map((function(e){return Gr(e,"audio/mp4")})).map(Vr).join(","),"audio"==e?'audio/mp4; codecs="'+t+'"':'video/mp4; codecs="'+t+'"'):t},i.getOriginalMimeType=function(){return this.m},i.transmux=function(e,t,n,i,r){var s=Ne(e);if("audio"==r&&!qu(s)){for(var a=Lu(s),o=a.length;o<s.length;o++)if(Vk(s,o))return Promise.reject(new je(2,3,3018,n?n.N()[0]:null));for(o=a.length;o<s.length;o++)if(xk(s,o))return this.h||(this.h=new kk("audio/aac")),this.h.transmux(e,t,n,i,r);return Promise.reject(new je(2,3,3018,n?n.N()[0]:null))}this.j?this.j.clearData():this.j=new $u;var u=this.j.parse(s),l=[],c=u.md();try{var f=null;if("video"==r){switch(c.video){case"avc":var p=[],g=null,m=u.uc(),v=_k(m);if(!v.length)throw new je(2,3,3023,n?n.N()[0]:null);for(var y=0;y<v.length;y++){var b=v[y];null==g&&(g=b.dts);var T=void 0;T=y+1<v.length?(v[y+1].dts||0)-(b.dts||0):1<v.length?(b.dts||0)-(v[y-1].dts||0):9e4*(n.endTime-n.startTime),p.push({data:b.data,size:b.data.byteLength,duration:T,bb:Math.round((b.pts||0)-(b.dts||0)),flags:{fb:0,Ya:0,Xa:0,Va:0,Wa:b.isKeyframe?2:1,gb:b.isKeyframe?0:1}})}for(var S=[],E=d(m),w=E.next();!w.done;w=E.next())S.push.apply(S,h(w.value.nalus));var A=Pk(S);if(!A||null==g)throw new je(2,3,3018,n?n.N()[0]:null);t.height=A.height,t.width=A.width,f={id:t.id,type:"video",codecs:"avc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:9e4,duration:i,jb:[],ra:new Uint8Array([]),Ba:A.Ba,Ha:A.Ha,Ja:A.Ja,data:{Db:this.g,baseMediaDecodeTime:g,hb:p},stream:t};break;case"hvc":var x=[],I=null,k=[],L=u.uc();if(!L.length)throw new je(2,3,3023,n?n.N()[0]:null);for(var R=0;R<L.length;R++){var C=L[R],D=C.nalus;k.push.apply(k,h(D));for(var M=!1,P=[],_=!1,O=d(D),N=O.next();!N.done;N=O.next()){var U=N.value;switch(U.type){case 1:case 0:var F=_=!0;break;case 19:case 20:case 21:M=F=_=!0;break;case 32:F=!0;break;case 33:F=!0;break;case 34:F=!0;break;case 35:_=F=!0;break;case 39:case 40:F=!0;break;default:F=!1}if(_&&F){var B=U.fullData.byteLength,j=new Uint8Array(4);j[0]=B>>24&255,j[1]=B>>16&255,j[2]=B>>8&255,j[3]=255&B,P.push(j),P.push(U.fullData)}}var $=P.length?{data:jt.apply(_t,h(P)),isKeyframe:M}:null;if($){null==I&&null!=C.dts&&(I=C.dts);var G=void 0;G=R+1<L.length?(L[R+1].dts||0)-(C.dts||0):1<L.length?(C.dts||0)-(L[R-1].dts||0):9e4*(n.endTime-n.startTime),x.push({data:$.data,size:$.data.byteLength,duration:G,bb:Math.round((C.pts||0)-(C.dts||0)),flags:{fb:0,Ya:0,Xa:0,Va:0,Wa:$.isKeyframe?2:1,gb:$.isKeyframe?0:1}})}}var V=Nk(k);if(!V||null==I)throw new je(2,3,3018,n?n.N()[0]:null);t.height=V.height,t.width=V.width,f={id:t.id,type:"video",codecs:"hvc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:9e4,duration:i,jb:[],ra:new Uint8Array([]),Ba:V.Ba,Ha:V.Ha,Ja:V.Ja,data:{Db:this.g,baseMediaDecodeTime:I,hb:x},stream:t}}f&&(l.push(f),f=null)}if("audio"==r){switch(c.audio){case"aac":for(var H,K=[],W=null,q=null,Y=null,X=d(u.cb()),z=X.next();!z.done;z=X.next()){var Q=z.value,J=Q.data;if(J){var Z=0;if(-1==q&&Y)J=jt(Y,Q.data),q=null;else if(null!=q&&Y){Z=Math.max(0,q);var ee=jt(Y,J.subarray(0,Z));K.push({data:ee,size:ee.byteLength,duration:1024,bb:0,flags:{fb:0,Ya:0,Xa:0,Va:0,Wa:2,gb:0}}),q=Y=null}if(H=Ak(J,Z),!H)throw new je(2,3,3018,n?n.N()[0]:null);for(t.audioSamplingRate=H.sampleRate,t.channelsCount=H.channelCount,null==W&&null!==Q.pts&&(W=Q.pts);Z<J.length;){var te=wk(J,Z);if(!te){Y=J.subarray(Z,J.length),q=-1;break}var ne=te.sd+te.ia;q=Math.max(0,Z+ne-J.length),0!=q?Y=J.subarray(Z+te.sd,Z+ne):Z+ne<=J.length&&K.push({data:J.subarray(Z+te.sd,Z+ne),size:te.ia,duration:1024,bb:0,flags:{fb:0,Ya:0,Xa:0,Va:0,Wa:2,gb:0}}),Z+=ne}}}if(!H||null==W){if(!u.uc().length)throw new je(2,3,3018,n?n.N()[0]:null);W=9e4*n.startTime;var ie=Kt("audio",t.codecs.split(","));if(!ie||!t.channelsCount||!t.audioSamplingRate)throw new je(2,3,3018,n?n.N()[0]:null);H={sampleRate:t.audioSamplingRate,channelCount:t.channelsCount,codec:ie};var re=Ik(ie,t.channelsCount);if(!re)throw new je(2,3,3018,n?n.N()[0]:null);for(var se=W+9e4*(n.endTime-n.startTime),ae=W;ae<se;)K.push({data:re,size:re.byteLength,duration:1024,bb:0,flags:{fb:0,Ya:0,Xa:0,Va:0,Wa:2,gb:0}}),ae+=1024/H.sampleRate*9e4}var oe=H.sampleRate,ue=W/9e4*oe;f={id:t.id,type:"audio",codecs:H.codec,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:oe,duration:i,jb:[],ra:new Uint8Array([]),Ba:new Uint8Array([]),Ha:0,Ja:0,data:{Db:this.g,baseMediaDecodeTime:ue,hb:K},stream:t};break;case"ac3":for(var le=[],ce=0,de=new Uint8Array([]),he=null,fe=d(u.cb()),pe=fe.next();!pe.done;pe=fe.next()){var ge=pe.value,me=ge.data;null==he&&null!==ge.pts&&(he=ge.pts);for(var ve=0;ve<me.length;){var ye=Lk(me,ve);ye?(t.audioSamplingRate=ye.sampleRate,t.channelsCount=ye.channelCount,ce=ye.sampleRate,de=ye.ra,le.push({data:me.subarray(ve,ve+ye.ia),size:ye.ia,duration:1536,bb:0,flags:{fb:0,Ya:0,Xa:0,Va:0,Wa:2,gb:0}}),ve+=ye.ia):ve++}}if(0==ce||0==de.byteLength||null==he)throw new je(2,3,3018,n?n.N()[0]:null);var be=he/9e4*ce;f={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:ce,duration:i,jb:[],ra:de,Ba:new Uint8Array([]),Ha:0,Ja:0,data:{Db:this.g,baseMediaDecodeTime:be,hb:le},stream:t};break;case"ec3":for(var Te=[],Se=0,Ee=new Uint8Array([]),we=null,Ae=d(u.cb()),xe=Ae.next();!xe.done;xe=Ae.next()){var Ie=xe.value,ke=Ie.data;null==we&&null!==Ie.pts&&(we=Ie.pts);for(var Le=0;Le<ke.length;){var Re=Dk(ke,Le);Re?(t.audioSamplingRate=Re.sampleRate,t.channelsCount=Re.channelCount,Se=Re.sampleRate,Ee=Re.ra,Te.push({data:ke.subarray(Le,Le+Re.ia),size:Re.ia,duration:1536,bb:0,flags:{fb:0,Ya:0,Xa:0,Va:0,Wa:2,gb:0}}),Le+=Re.ia):Le++}}if(0==Se||0==Ee.byteLength||null==we)throw new je(2,3,3018,n?n.N()[0]:null);var Ce=we/9e4*Se;f={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:Se,duration:i,jb:[],ra:Ee,Ba:new Uint8Array([]),Ha:0,Ja:0,data:{Db:this.g,baseMediaDecodeTime:Ce,hb:Te},stream:t};break;case"mp3":for(var De,Me=[],Pe=null,_e=d(u.cb()),Oe=_e.next();!Oe.done;Oe=_e.next()){var Ue=Oe.value,Fe=Ue.data;if(Fe){null==Pe&&null!==Ue.pts&&(Pe=Ue.pts);for(var Be=0;Be<Fe.length;){var $e=$k(Fe,Be);$e?(De||(De=$e),Be+$e.ia<=Fe.length&&Me.push({data:Fe.subarray(Be,Be+$e.ia),size:$e.ia,duration:1152,bb:0,flags:{fb:0,Ya:0,Xa:0,Va:0,Wa:2,gb:0}}),Be+=$e.ia):Be++}}}if(!De||null==Pe)throw new je(2,3,3018,n?n.N()[0]:null);var Ge=De.sampleRate,Ve=Pe/9e4*Ge;f={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:Ge,duration:i,jb:[],ra:new Uint8Array([]),Ba:new Uint8Array([]),Ha:0,Ja:0,data:{Db:this.g,baseMediaDecodeTime:Ve,hb:Me},stream:t};break;case"opus":var He=[],Ke=null,We=u.F;if(!We)throw new je(2,3,3018,n?n.N()[0]:null);var qe=[];switch(We.Yh){case 1:case 2:qe=[0];break;case 0:qe=[255,1,1,0,1];break;case 128:qe=[255,2,0,0,1];break;case 3:qe=[1,2,1,0,2,1];break;case 4:qe=[1,2,2,0,1,2,3];break;case 5:qe=[1,3,2,0,4,1,2,3];break;case 6:qe=[1,4,2,0,4,1,2,3,5];break;case 7:qe=[1,4,2,0,4,1,2,3,5,6];break;case 8:qe=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:qe=[1,1,2,0,1];break;case 131:qe=[1,1,3,0,1,2];break;case 132:qe=[1,1,4,0,1,2,3];break;case 133:qe=[1,1,5,0,1,2,3,4];break;case 134:qe=[1,1,6,0,1,2,3,4,5];break;case 135:qe=[1,1,7,0,1,2,3,4,5,6];break;case 136:qe=[1,1,8,0,1,2,3,4,5,6,7]}for(var Ye=new Uint8Array([0,We.channelCount,0,0,We.sampleRate>>>24&255,We.sampleRate>>>17&255,We.sampleRate>>>8&255,We.sampleRate>>>0&255,0,0].concat(h(qe))),Xe=We.sampleRate,ze=d(u.cb()),Qe=ze.next();!Qe.done;Qe=ze.next()){var Je=Qe.value,Ze=Je.data;null==Ke&&null!==Je.pts&&(Ke=Je.pts);for(var et=0;et<Ze.length;){for(var tt=0!==(16&Ze[et+1]),nt=0!==(8&Ze[et+1]),it=et+2,rt=0;255===Ze[it];)rt+=255,it+=1;rt+=Ze[it],it+=1,it+=tt?2:0,it+=nt?2:0;var st=Ze.slice(it,it+rt);He.push({data:st,size:st.byteLength,duration:960,bb:0,flags:{fb:0,Ya:0,Xa:0,Va:0,Wa:2,gb:0}}),et=it+rt}}if(0==Ye.byteLength||null==Ke)throw new je(2,3,3018,n?n.N()[0]:null);t.audioSamplingRate=We.sampleRate,t.channelsCount=We.channelCount;var at=Ke/9e4*Xe;f={id:t.id,type:"audio",codecs:"opus",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:Xe,duration:i,jb:[],ra:Ye,Ba:new Uint8Array([]),Ha:0,Ja:0,data:{Db:this.g,baseMediaDecodeTime:at,hb:He},stream:t}}f&&(l.push(f),f=null)}}catch(ft){return ft&&3023==ft.code?Promise.resolve(new Uint8Array([])):Promise.reject(ft)}if(!l.length)return Promise.reject(new je(2,3,3018,n?n.N()[0]:null));var ot=new Io(l),ut=t.id+"_"+n.i;if(this.i.has(ut))var lt=this.i.get(ut);else lt=ko(ot),this.i.set(ut,lt);var ct=this.l!==lt,dt=Mo(ot);if(this.l=lt,this.g++,ct){var ht=jt(lt,dt);return Promise.resolve(ht)}return Promise.resolve(dt)},K("shaka.transmuxer.TsTransmuxer",eL),eL.prototype.transmux=eL.prototype.transmux,eL.prototype.getOriginalMimeType=eL.prototype.getOriginalMimeType,eL.prototype.convertCodecs=eL.prototype.convertCodecs,eL.prototype.isSupported=eL.prototype.isSupported,eL.prototype.destroy=eL.prototype.destroy;var tL,nL,iL=["aac","ac-3","ec-3","mp3","opus"],rL=["avc","hevc"];function sL(){}
/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function aL(){}function oL(){tL||navigator.emeEncryptionSchemePolyfilled?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(tL=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=uL,navigator.emeEncryptionSchemePolyfilled=!0):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function uL(e,t){var n,i=this;return U((function(r){return 1==r.g?(console.assert(i==navigator,'bad "this" for requestMediaKeySystemAccess'),w(r,tL.call(i,e,t),2)):(n=r.h,yL(n)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=tL,r.return(n)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=lL,r.return(lL.call(i,e,t))))}))}function lL(e,t){var n,i,r,s,a,o,u,l,c,h,f,p,g=this;return U((function(m){if(1==m.g){for(console.assert(g==navigator,'bad "this" for requestMediaKeySystemAccess'),n=vL(e),i=[],r=d(t),s=r.next();!s.done;s=r.next())a=s.value,o=cL(a.videoCapabilities,n),u=cL(a.audioCapabilities,n),a.videoCapabilities&&a.videoCapabilities.length&&!o.length||a.audioCapabilities&&a.audioCapabilities.length&&!u.length||(l=Object.assign({},a),l.videoCapabilities=o,l.audioCapabilities=u,i.push(l));if(!i.length)throw c=Error("Unsupported keySystem or supportedConfigurations."),c.name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c;return w(m,tL.call(g,e,i),2)}return h=m.h,p=f=null,i[0]&&(i[0].videoCapabilities&&(f=i[0].videoCapabilities[0].encryptionScheme),i[0].audioCapabilities&&(p=i[0].audioCapabilities[0].encryptionScheme)),m.return(new mL(h,f,p))}))}function cL(e,t){return e?e.filter((function(e){return bL(e.encryptionScheme,t)})):e}function dL(){}function hL(){nL||navigator.mediaCapabilitiesEncryptionSchemePolyfilled?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(nL=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=fL,navigator.mediaCapabilitiesEncryptionSchemePolyfilled=!0):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function fL(e){var t,n,i=this;return U((function(r){switch(r.g){case 1:return console.assert(i==navigator.mediaCapabilities,'bad "this" for decodingInfo'),w(r,nL.call(i,e),2);case 2:if(t=r.h,!t.supported||!e.keySystemConfiguration)return r.return(t);if((n=t.keySystemAccess)&&yL(n))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=nL,r.return(t);if(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=pL,n){r.s(3);break}return w(r,gL(e),4);case 4:return t.keySystemAccess=r.h,r.return(t);case 3:return r.return(pL.call(i,e))}}))}function pL(e){var t,n,i,r,s,a,o,u=this;return U((function(l){switch(l.g){case 1:return console.assert(u==navigator.mediaCapabilities,'bad "this" for decodingInfo'),n=t=null,!e.keySystemConfiguration||(i=e.keySystemConfiguration,r=i.keySystem,n=i.audio&&i.audio.encryptionScheme,t=i.video&&i.video.encryptionScheme,s=vL(r),a={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},bL(n,s)&&bL(t,s))?w(l,nL.call(u,e),2):l.return(a);case 2:if(o=l.h,o.keySystemAccess){o.keySystemAccess=new mL(o.keySystemAccess,t,n),l.s(3);break}if(!e.keySystemConfiguration){l.s(3);break}return w(l,gL(e),5);case 5:o.keySystemAccess=l.h;case 3:return l.return(o)}}))}function gL(e){var t,n;return U((function(i){if(1==i.g){var r=e.keySystemConfiguration,s=[],a=[];return r.audio&&s.push({robustness:r.audio.robustness||"",contentType:e.audio.contentType,encryptionScheme:r.audio.encryptionScheme}),r.video&&a.push({robustness:r.video.robustness||"",contentType:e.video.contentType,encryptionScheme:r.video.encryptionScheme}),r={initDataTypes:r.initDataType?[r.initDataType]:[],distinctiveIdentifier:r.distinctiveIdentifier,persistentState:r.persistentState,sessionTypes:r.sessionTypes},s.length&&(r.audioCapabilities=s),a.length&&(r.videoCapabilities=a),t=r,w(i,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[t]),2)}return n=i.h,i.return(n)}))}function mL(e,t,n){this.g=e,this.i=t||null,this.h=n||null,this.keySystem=e.keySystem}function vL(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs":e.startsWith("com.huawei")?"cenc":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function yL(e){e=e.getConfiguration();var t=e.audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function bL(e,t){return!e||e==t||!("cbcs"!=e&&"cbcs-1-9"!=e||!(AL||kL||wL))}function TL(){}function SL(){oL(),hL()}Fi("video/mp2t",(function(){return new eL("video/mp2t")}),Vi),b(sL,Dd),K("shaka.util.FairPlayUtils",sL),K("EmeEncryptionSchemePolyfill",aL),aL.install=oL,K("McEncryptionSchemePolyfill",dL),dL.install=hL,mL.prototype.getConfiguration=function(){var e=this.g.getConfiguration();if(e.videoCapabilities)for(var t=d(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.i;if(e.audioCapabilities)for(t=d(e.audioCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.h;return e},mL.prototype.createMediaKeys=function(){return this.g.createMediaKeys()},K("EncryptionSchemePolyfills",TL),TL.install=SL;var EL,wL=navigator.userAgent.includes("CrKey"),AL=100<=parseInt(navigator.userAgent.split("Firefox/").pop(),10),xL=navigator.userAgent||"";if(xL.includes("Web0S")){var IL=xL.match(/Chrome\/(\d+)/);EL=!!IL&&79<=parseInt(IL[1],10)}else EL=!1;var kL=EL;"undefined"!==typeof n&&n.exports&&(n.exports=TL)}.call(i,e,e,void 0),i.shaka)t[r]=i.shaka[r]}()},851:function(e,t,n){"use strict";var i=n(6955),r=n(5966),s=n(4117),a=n(6269),o=n(8227),u=o("iterator");e.exports=function(e){if(!s(e))return r(e,u)||r(e,"@@iterator")||a[i(e)]}},1072:function(e,t,n){"use strict";var i=n(1828),r=n(8727);e.exports=Object.keys||function(e){return i(e,r)}},1148:function(e,t,n){"use strict";var i=n(6518),r=n(9565),s=n(2652),a=n(9306),o=n(8551),u=n(1767),l=n(9539),c=n(4549),d=c("every",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:d},{every:function(e){o(this);try{a(e)}catch(i){l(this,"throw",i)}if(d)return r(d,this,e);var t=u(this),n=0;return!s(t,(function(t,i){if(!e(t,n++))return i()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},1181:function(e,t,n){"use strict";var i,r,s,a=n(8622),o=n(4576),u=n(34),l=n(6699),c=n(9297),d=n(7629),h=n(6119),f=n(421),p="Object already initialized",g=o.TypeError,m=o.WeakMap,v=function(e){return s(e)?r(e):i(e,{})},y=function(e){return function(t){var n;if(!u(t)||(n=r(t)).type!==e)throw new g("Incompatible receiver, "+e+" required");return n}};if(a||d.state){var b=d.state||(d.state=new m);b.get=b.get,b.has=b.has,b.set=b.set,i=function(e,t){if(b.has(e))throw new g(p);return t.facade=e,b.set(e,t),t},r=function(e){return b.get(e)||{}},s=function(e){return b.has(e)}}else{var T=h("state");f[T]=!0,i=function(e,t){if(c(e,T))throw new g(p);return t.facade=e,l(e,T,t),t},r=function(e){return c(e,T)?e[T]:{}},s=function(e){return c(e,T)}}e.exports={set:i,get:r,has:s,enforce:v,getterFor:y}},1241:function(e,t){"use strict";t.A=(e,t)=>{const n=e.__vccOpts||e;for(const[i,r]of t)n[i]=r;return n}},1291:function(e,t,n){"use strict";var i=n(741);e.exports=function(e){var t=+e;return t!==t||0===t?0:i(t)}},1387:function(e,t,n){"use strict";n.d(t,{Bt:function(){return le},aE:function(){return st},lq:function(){return ut},rd:function(){return ot}});n(4114),n(8111),n(1148),n(2489),n(116),n(7588),n(1701),n(8237),n(3579),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698);var i=n(6768),r=n(144);
/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */
const s="undefined"!==typeof document;function a(e){return"object"===typeof e||"displayName"in e||"props"in e||"__vccOpts"in e}function o(e){return e.__esModule||"Module"===e[Symbol.toStringTag]||e.default&&a(e.default)}const u=Object.assign;function l(e,t){const n={};for(const i in t){const r=t[i];n[i]=d(r)?r.map(e):e(r)}return n}const c=()=>{},d=Array.isArray;const h=/#/g,f=/&/g,p=/\//g,g=/=/g,m=/\?/g,v=/\+/g,y=/%5B/g,b=/%5D/g,T=/%5E/g,S=/%60/g,E=/%7B/g,w=/%7C/g,A=/%7D/g,x=/%20/g;function I(e){return encodeURI(""+e).replace(w,"|").replace(y,"[").replace(b,"]")}function k(e){return I(e).replace(E,"{").replace(A,"}").replace(T,"^")}function L(e){return I(e).replace(v,"%2B").replace(x,"+").replace(h,"%23").replace(f,"%26").replace(S,"`").replace(E,"{").replace(A,"}").replace(T,"^")}function R(e){return L(e).replace(g,"%3D")}function C(e){return I(e).replace(h,"%23").replace(m,"%3F")}function D(e){return null==e?"":C(e).replace(p,"%2F")}function M(e){try{return decodeURIComponent(""+e)}catch(t){}return""+e}const P=/\/$/,_=e=>e.replace(P,"");function O(e,t,n="/"){let i,r={},s="",a="";const o=t.indexOf("#");let u=t.indexOf("?");return o<u&&o>=0&&(u=-1),u>-1&&(i=t.slice(0,u),s=t.slice(u+1,o>-1?o:t.length),r=e(s)),o>-1&&(i=i||t.slice(0,o),a=t.slice(o,t.length)),i=V(null!=i?i:t,n),{fullPath:i+(s&&"?")+s+a,path:i,query:r,hash:M(a)}}function N(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function U(e,t){return t&&e.toLowerCase().startsWith(t.toLowerCase())?e.slice(t.length)||"/":e}function F(e,t,n){const i=t.matched.length-1,r=n.matched.length-1;return i>-1&&i===r&&B(t.matched[i],n.matched[r])&&j(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function B(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function j(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!$(e[n],t[n]))return!1;return!0}function $(e,t){return d(e)?G(e,t):d(t)?G(t,e):e===t}function G(e,t){return d(t)?e.length===t.length&&e.every(((e,n)=>e===t[n])):1===e.length&&e[0]===t}function V(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),i=e.split("/"),r=i[i.length-1];".."!==r&&"."!==r||i.push("");let s,a,o=n.length-1;for(s=0;s<i.length;s++)if(a=i[s],"."!==a){if(".."!==a)break;o>1&&o--}return n.slice(0,o).join("/")+"/"+i.slice(s).join("/")}const H={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var K,W;(function(e){e["pop"]="pop",e["push"]="push"})(K||(K={})),function(e){e["back"]="back",e["forward"]="forward",e["unknown"]=""}(W||(W={}));function q(e){if(!e)if(s){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return"/"!==e[0]&&"#"!==e[0]&&(e="/"+e),_(e)}const Y=/^[^#]+#/;function X(e,t){return e.replace(Y,"#")+t}function z(e,t){const n=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-n.left-(t.left||0),top:i.top-n.top-(t.top||0)}}const Q=()=>({left:window.scrollX,top:window.scrollY});function J(e){let t;if("el"in e){const n=e.el,i="string"===typeof n&&n.startsWith("#");0;const r="string"===typeof n?i?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;t=z(r,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(null!=t.left?t.left:window.scrollX,null!=t.top?t.top:window.scrollY)}function Z(e,t){const n=history.state?history.state.position-t:-1;return n+e}const ee=new Map;function te(e,t){ee.set(e,t)}function ne(e){const t=ee.get(e);return ee.delete(e),t}let ie=()=>location.protocol+"//"+location.host;function re(e,t){const{pathname:n,search:i,hash:r}=t,s=e.indexOf("#");if(s>-1){let t=r.includes(e.slice(s))?e.slice(s).length:1,n=r.slice(t);return"/"!==n[0]&&(n="/"+n),U(n,"")}const a=U(n,e);return a+i+r}function se(e,t,n,i){let r=[],s=[],a=null;const o=({state:s})=>{const o=re(e,location),u=n.value,l=t.value;let c=0;if(s){if(n.value=o,t.value=s,a&&a===u)return void(a=null);c=l?s.position-l.position:0}else i(o);r.forEach((e=>{e(n.value,u,{delta:c,type:K.pop,direction:c?c>0?W.forward:W.back:W.unknown})}))};function l(){a=n.value}function c(e){r.push(e);const t=()=>{const t=r.indexOf(e);t>-1&&r.splice(t,1)};return s.push(t),t}function d(){const{history:e}=window;e.state&&e.replaceState(u({},e.state,{scroll:Q()}),"")}function h(){for(const e of s)e();s=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:l,listen:c,destroy:h}}function ae(e,t,n,i=!1,r=!1){return{back:e,current:t,forward:n,replaced:i,position:window.history.length,scroll:r?Q():null}}function oe(e){const{history:t,location:n}=window,i={value:re(e,n)},r={value:t.state};function s(i,s,a){const o=e.indexOf("#"),u=o>-1?(n.host&&document.querySelector("base")?e:e.slice(o))+i:ie()+e+i;try{t[a?"replaceState":"pushState"](s,"",u),r.value=s}catch(l){console.error(l),n[a?"replace":"assign"](u)}}function a(e,n){const a=u({},t.state,ae(r.value.back,e,r.value.forward,!0),n,{position:r.value.position});s(e,a,!0),i.value=e}function o(e,n){const a=u({},r.value,t.state,{forward:e,scroll:Q()});s(a.current,a,!0);const o=u({},ae(i.value,e,null),{position:a.position+1},n);s(e,o,!1),i.value=e}return r.value||s(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0),{location:i,state:r,push:o,replace:a}}function ue(e){e=q(e);const t=oe(e),n=se(e,t.state,t.location,t.replace);function i(e,t=!0){t||n.pauseListeners(),history.go(e)}const r=u({location:"",base:e,go:i,createHref:X.bind(null,e)},t,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>t.state.value}),r}function le(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),ue(e)}function ce(e){return"string"===typeof e||e&&"object"===typeof e}function de(e){return"string"===typeof e||"symbol"===typeof e}const he=Symbol("");var fe;(function(e){e[e["aborted"]=4]="aborted",e[e["cancelled"]=8]="cancelled",e[e["duplicated"]=16]="duplicated"})(fe||(fe={}));function pe(e,t){return u(new Error,{type:e,[he]:!0},t)}function ge(e,t){return e instanceof Error&&he in e&&(null==t||!!(e.type&t))}const me="[^/]+?",ve={sensitive:!1,strict:!1,start:!0,end:!0},ye=/[.+*?^${}()[\]/\\]/g;function be(e,t){const n=u({},ve,t),i=[];let r=n.start?"^":"";const s=[];for(const u of e){const e=u.length?[]:[90];n.strict&&!u.length&&(r+="/");for(let t=0;t<u.length;t++){const i=u[t];let a=40+(n.sensitive?.25:0);if(0===i.type)t||(r+="/"),r+=i.value.replace(ye,"\\$&"),a+=40;else if(1===i.type){const{value:e,repeatable:n,optional:o,regexp:l}=i;s.push({name:e,repeatable:n,optional:o});const d=l||me;if(d!==me){a+=10;try{new RegExp(`(${d})`)}catch(c){throw new Error(`Invalid custom RegExp for param "${e}" (${d}): `+c.message)}}let h=n?`((?:${d})(?:/(?:${d}))*)`:`(${d})`;t||(h=o&&u.length<2?`(?:/${h})`:"/"+h),o&&(h+="?"),r+=h,a+=20,o&&(a+=-8),n&&(a+=-20),".*"===d&&(a+=-50)}e.push(a)}i.push(e)}if(n.strict&&n.end){const e=i.length-1;i[e][i[e].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const a=new RegExp(r,n.sensitive?"":"i");function o(e){const t=e.match(a),n={};if(!t)return null;for(let i=1;i<t.length;i++){const e=t[i]||"",r=s[i-1];n[r.name]=e&&r.repeatable?e.split("/"):e}return n}function l(t){let n="",i=!1;for(const r of e){i&&n.endsWith("/")||(n+="/"),i=!1;for(const e of r)if(0===e.type)n+=e.value;else if(1===e.type){const{value:s,repeatable:a,optional:o}=e,u=s in t?t[s]:"";if(d(u)&&!a)throw new Error(`Provided param "${s}" is an array but it is not repeatable (* or + modifiers)`);const l=d(u)?u.join("/"):u;if(!l){if(!o)throw new Error(`Missing required param "${s}"`);r.length<2&&(n.endsWith("/")?n=n.slice(0,-1):i=!0)}n+=l}}return n||"/"}return{re:a,score:i,keys:s,parse:o,stringify:l}}function Te(e,t){let n=0;while(n<e.length&&n<t.length){const i=t[n]-e[n];if(i)return i;n++}return e.length<t.length?1===e.length&&80===e[0]?-1:1:e.length>t.length?1===t.length&&80===t[0]?1:-1:0}function Se(e,t){let n=0;const i=e.score,r=t.score;while(n<i.length&&n<r.length){const e=Te(i[n],r[n]);if(e)return e;n++}if(1===Math.abs(r.length-i.length)){if(Ee(i))return 1;if(Ee(r))return-1}return r.length-i.length}function Ee(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const we={type:0,value:""},Ae=/[a-zA-Z0-9_]/;function xe(e){if(!e)return[[]];if("/"===e)return[[we]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(e){throw new Error(`ERR (${n})/"${l}": ${e}`)}let n=0,i=n;const r=[];let s;function a(){s&&r.push(s),s=[]}let o,u=0,l="",c="";function d(){l&&(0===n?s.push({type:0,value:l}):1===n||2===n||3===n?(s.length>1&&("*"===o||"+"===o)&&t(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:l,regexp:c,repeatable:"*"===o||"+"===o,optional:"*"===o||"?"===o})):t("Invalid state to consume buffer"),l="")}function h(){l+=o}while(u<e.length)if(o=e[u++],"\\"!==o||2===n)switch(n){case 0:"/"===o?(l&&d(),a()):":"===o?(d(),n=1):h();break;case 4:h(),n=i;break;case 1:"("===o?n=2:Ae.test(o)?h():(d(),n=0,"*"!==o&&"?"!==o&&"+"!==o&&u--);break;case 2:")"===o?"\\"==c[c.length-1]?c=c.slice(0,-1)+o:n=3:c+=o;break;case 3:d(),n=0,"*"!==o&&"?"!==o&&"+"!==o&&u--,c="";break;default:t("Unknown state");break}else i=n,n=4;return 2===n&&t(`Unfinished custom RegExp for param "${l}"`),d(),a(),r}function Ie(e,t,n){const i=be(xe(e.path),n);const r=u(i,{record:e,parent:t,children:[],alias:[]});return t&&!r.record.aliasOf===!t.record.aliasOf&&t.children.push(r),r}function ke(e,t){const n=[],i=new Map;function r(e){return i.get(e)}function s(e,n,i){const r=!i,o=Re(e);o.aliasOf=i&&i.record;const d=Pe(t,e),h=[o];if("alias"in e){const t="string"===typeof e.alias?[e.alias]:e.alias;for(const e of t)h.push(Re(u({},o,{components:i?i.record.components:o.components,path:e,aliasOf:i?i.record:o})))}let f,p;for(const t of h){const{path:u}=t;if(n&&"/"!==u[0]){const e=n.record.path,i="/"===e[e.length-1]?"":"/";t.path=n.record.path+(u&&i+u)}if(f=Ie(t,n,d),i?i.alias.push(f):(p=p||f,p!==f&&p.alias.push(f),r&&e.name&&!De(f)&&a(e.name)),Ne(f)&&l(f),o.children){const e=o.children;for(let t=0;t<e.length;t++)s(e[t],f,i&&i.children[t])}i=i||f}return p?()=>{a(p)}:c}function a(e){if(de(e)){const t=i.get(e);t&&(i.delete(e),n.splice(n.indexOf(t),1),t.children.forEach(a),t.alias.forEach(a))}else{const t=n.indexOf(e);t>-1&&(n.splice(t,1),e.record.name&&i.delete(e.record.name),e.children.forEach(a),e.alias.forEach(a))}}function o(){return n}function l(e){const t=_e(e,n);n.splice(t,0,e),e.record.name&&!De(e)&&i.set(e.record.name,e)}function d(e,t){let r,s,a,o={};if("name"in e&&e.name){if(r=i.get(e.name),!r)throw pe(1,{location:e});0,a=r.record.name,o=u(Le(t.params,r.keys.filter((e=>!e.optional)).concat(r.parent?r.parent.keys.filter((e=>e.optional)):[]).map((e=>e.name))),e.params&&Le(e.params,r.keys.map((e=>e.name)))),s=r.stringify(o)}else if(null!=e.path)s=e.path,r=n.find((e=>e.re.test(s))),r&&(o=r.parse(s),a=r.record.name);else{if(r=t.name?i.get(t.name):n.find((e=>e.re.test(t.path))),!r)throw pe(1,{location:e,currentLocation:t});a=r.record.name,o=u({},t.params,e.params),s=r.stringify(o)}const l=[];let c=r;while(c)l.unshift(c.record),c=c.parent;return{name:a,path:s,params:o,matched:l,meta:Me(l)}}function h(){n.length=0,i.clear()}return t=Pe({strict:!1,end:!0,sensitive:!1},t),e.forEach((e=>s(e))),{addRoute:s,resolve:d,removeRoute:a,clearRoutes:h,getRoutes:o,getRecordMatcher:r}}function Le(e,t){const n={};for(const i of t)i in e&&(n[i]=e[i]);return n}function Re(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:Ce(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function Ce(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const i in e.components)t[i]="object"===typeof n?n[i]:n;return t}function De(e){while(e){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Me(e){return e.reduce(((e,t)=>u(e,t.meta)),{})}function Pe(e,t){const n={};for(const i in e)n[i]=i in t?t[i]:e[i];return n}function _e(e,t){let n=0,i=t.length;while(n!==i){const r=n+i>>1,s=Se(e,t[r]);s<0?i=r:n=r+1}const r=Oe(e);return r&&(i=t.lastIndexOf(r,i-1)),i}function Oe(e){let t=e;while(t=t.parent)if(Ne(t)&&0===Se(e,t))return t}function Ne({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Ue(e){const t={};if(""===e||"?"===e)return t;const n="?"===e[0],i=(n?e.slice(1):e).split("&");for(let r=0;r<i.length;++r){const e=i[r].replace(v," "),n=e.indexOf("="),s=M(n<0?e:e.slice(0,n)),a=n<0?null:M(e.slice(n+1));if(s in t){let e=t[s];d(e)||(e=t[s]=[e]),e.push(a)}else t[s]=a}return t}function Fe(e){let t="";for(let n in e){const i=e[n];if(n=R(n),null==i){void 0!==i&&(t+=(t.length?"&":"")+n);continue}const r=d(i)?i.map((e=>e&&L(e))):[i&&L(i)];r.forEach((e=>{void 0!==e&&(t+=(t.length?"&":"")+n,null!=e&&(t+="="+e))}))}return t}function Be(e){const t={};for(const n in e){const i=e[n];void 0!==i&&(t[n]=d(i)?i.map((e=>null==e?null:""+e)):null==i?i:""+i)}return t}const je=Symbol(""),$e=Symbol(""),Ge=Symbol(""),Ve=Symbol(""),He=Symbol("");function Ke(){let e=[];function t(t){return e.push(t),()=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function We(e,t,n,i,r,s=e=>e()){const a=i&&(i.enterCallbacks[r]=i.enterCallbacks[r]||[]);return()=>new Promise(((o,u)=>{const l=e=>{!1===e?u(pe(4,{from:n,to:t})):e instanceof Error?u(e):ce(e)?u(pe(2,{from:t,to:e})):(a&&i.enterCallbacks[r]===a&&"function"===typeof e&&a.push(e),o())},c=s((()=>e.call(i&&i.instances[r],t,n,l)));let d=Promise.resolve(c);e.length<3&&(d=d.then(l)),d.catch((e=>u(e)))}))}function qe(e,t,n,i,r=e=>e()){const s=[];for(const u of e){0;for(const e in u.components){let l=u.components[e];if("beforeRouteEnter"===t||u.instances[e])if(a(l)){const a=l.__vccOpts||l,o=a[t];o&&s.push(We(o,n,i,u,e,r))}else{let a=l();0,s.push((()=>a.then((s=>{if(!s)throw new Error(`Couldn't resolve component "${e}" at "${u.path}"`);const a=o(s)?s.default:s;u.mods[e]=s,u.components[e]=a;const l=a.__vccOpts||a,c=l[t];return c&&We(c,n,i,u,e,r)()}))))}}}return s}function Ye(e){const t=(0,i.WQ)(Ge),n=(0,i.WQ)(Ve);const s=(0,i.EW)((()=>{const n=(0,r.R1)(e.to);return t.resolve(n)})),a=(0,i.EW)((()=>{const{matched:e}=s.value,{length:t}=e,i=e[t-1],r=n.matched;if(!i||!r.length)return-1;const a=r.findIndex(B.bind(null,i));if(a>-1)return a;const o=et(e[t-2]);return t>1&&et(i)===o&&r[r.length-1].path!==o?r.findIndex(B.bind(null,e[t-2])):a})),o=(0,i.EW)((()=>a.value>-1&&Ze(n.params,s.value.params))),u=(0,i.EW)((()=>a.value>-1&&a.value===n.matched.length-1&&j(n.params,s.value.params)));function l(n={}){if(Je(n)){const n=t[(0,r.R1)(e.replace)?"replace":"push"]((0,r.R1)(e.to)).catch(c);return e.viewTransition&&"undefined"!==typeof document&&"startViewTransition"in document&&document.startViewTransition((()=>n)),n}return Promise.resolve()}return{route:s,href:(0,i.EW)((()=>s.value.href)),isActive:o,isExactActive:u,navigate:l}}function Xe(e){return 1===e.length?e[0]:e}const ze=(0,i.pM)({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Ye,setup(e,{slots:t}){const n=(0,r.Kh)(Ye(e)),{options:s}=(0,i.WQ)(Ge),a=(0,i.EW)((()=>({[tt(e.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[tt(e.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive})));return()=>{const r=t.default&&Xe(t.default(n));return e.custom?r:(0,i.h)("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:a.value},r)}}}),Qe=ze;function Je(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&(void 0===e.button||0===e.button)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Ze(e,t){for(const n in t){const i=t[n],r=e[n];if("string"===typeof i){if(i!==r)return!1}else if(!d(r)||r.length!==i.length||i.some(((e,t)=>e!==r[t])))return!1}return!0}function et(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const tt=(e,t,n)=>null!=e?e:null!=t?t:n,nt=(0,i.pM)({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const s=(0,i.WQ)(He),a=(0,i.EW)((()=>e.route||s.value)),o=(0,i.WQ)($e,0),l=(0,i.EW)((()=>{let e=(0,r.R1)(o);const{matched:t}=a.value;let n;while((n=t[e])&&!n.components)e++;return e})),c=(0,i.EW)((()=>a.value.matched[l.value]));(0,i.Gt)($e,(0,i.EW)((()=>l.value+1))),(0,i.Gt)(je,c),(0,i.Gt)(He,a);const d=(0,r.KR)();return(0,i.wB)((()=>[d.value,c.value,e.name]),(([e,t,n],[i,r,s])=>{t&&(t.instances[n]=e,r&&r!==t&&e&&e===i&&(t.leaveGuards.size||(t.leaveGuards=r.leaveGuards),t.updateGuards.size||(t.updateGuards=r.updateGuards))),!e||!t||r&&B(t,r)&&i||(t.enterCallbacks[n]||[]).forEach((t=>t(e)))}),{flush:"post"}),()=>{const r=a.value,s=e.name,o=c.value,l=o&&o.components[s];if(!l)return it(n.default,{Component:l,route:r});const h=o.props[s],f=h?!0===h?r.params:"function"===typeof h?h(r):h:null,p=e=>{e.component.isUnmounted&&(o.instances[s]=null)},g=(0,i.h)(l,u({},f,t,{onVnodeUnmounted:p,ref:d}));return it(n.default,{Component:g,route:r})||g}}});function it(e,t){if(!e)return null;const n=e(t);return 1===n.length?n[0]:n}const rt=nt;function st(e){const t=ke(e.routes,e),n=e.parseQuery||Ue,a=e.stringifyQuery||Fe,o=e.history;const h=Ke(),f=Ke(),p=Ke(),g=(0,r.IJ)(H);let m=H;s&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const v=l.bind(null,(e=>""+e)),y=l.bind(null,D),b=l.bind(null,M);function T(e,n){let i,r;return de(e)?(i=t.getRecordMatcher(e),r=n):r=e,t.addRoute(r,i)}function S(e){const n=t.getRecordMatcher(e);n&&t.removeRoute(n)}function E(){return t.getRoutes().map((e=>e.record))}function w(e){return!!t.getRecordMatcher(e)}function A(e,i){if(i=u({},i||g.value),"string"===typeof e){const r=O(n,e,i.path),s=t.resolve({path:r.path},i),a=o.createHref(r.fullPath);return u(r,s,{params:b(s.params),hash:M(r.hash),redirectedFrom:void 0,href:a})}let r;if(null!=e.path)r=u({},e,{path:O(n,e.path,i.path).path});else{const t=u({},e.params);for(const e in t)null==t[e]&&delete t[e];r=u({},e,{params:y(t)}),i.params=y(i.params)}const s=t.resolve(r,i),l=e.hash||"";s.params=v(b(s.params));const c=N(a,u({},e,{hash:k(l),path:s.path})),d=o.createHref(c);return u({fullPath:c,hash:l,query:a===Fe?Be(e.query):e.query||{}},s,{redirectedFrom:void 0,href:d})}function x(e){return"string"===typeof e?O(n,e,g.value.path):u({},e)}function I(e,t){if(m!==e)return pe(8,{from:t,to:e})}function L(e){return P(e)}function R(e){return L(u(x(e),{replace:!0}))}function C(e){const t=e.matched[e.matched.length-1];if(t&&t.redirect){const{redirect:n}=t;let i="function"===typeof n?n(e):n;return"string"===typeof i&&(i=i.includes("?")||i.includes("#")?i=x(i):{path:i},i.params={}),u({query:e.query,hash:e.hash,params:null!=i.path?{}:e.params},i)}}function P(e,t){const n=m=A(e),i=g.value,r=e.state,s=e.force,o=!0===e.replace,l=C(n);if(l)return P(u(x(l),{state:"object"===typeof l?u({},r,l.state):r,force:s,replace:o}),t||n);const c=n;let d;return c.redirectedFrom=t,!s&&F(a,i,n)&&(d=pe(16,{to:c,from:i}),ie(i,i,!0,!1)),(d?Promise.resolve(d):B(c,i)).catch((e=>ge(e)?ge(e,2)?e:ee(e):X(e,c,i))).then((e=>{if(e){if(ge(e,2))return P(u({replace:o},x(e.to),{state:"object"===typeof e.to?u({},r,e.to.state):r,force:s}),t||c)}else e=$(c,i,!0,o,r);return j(c,i,e),e}))}function _(e,t){const n=I(e,t);return n?Promise.reject(n):Promise.resolve()}function U(e){const t=ae.values().next().value;return t&&"function"===typeof t.runWithContext?t.runWithContext(e):e()}function B(e,t){let n;const[i,r,s]=at(e,t);n=qe(i.reverse(),"beforeRouteLeave",e,t);for(const o of i)o.leaveGuards.forEach((i=>{n.push(We(i,e,t))}));const a=_.bind(null,e,t);return n.push(a),ue(n).then((()=>{n=[];for(const i of h.list())n.push(We(i,e,t));return n.push(a),ue(n)})).then((()=>{n=qe(r,"beforeRouteUpdate",e,t);for(const i of r)i.updateGuards.forEach((i=>{n.push(We(i,e,t))}));return n.push(a),ue(n)})).then((()=>{n=[];for(const i of s)if(i.beforeEnter)if(d(i.beforeEnter))for(const r of i.beforeEnter)n.push(We(r,e,t));else n.push(We(i.beforeEnter,e,t));return n.push(a),ue(n)})).then((()=>(e.matched.forEach((e=>e.enterCallbacks={})),n=qe(s,"beforeRouteEnter",e,t,U),n.push(a),ue(n)))).then((()=>{n=[];for(const i of f.list())n.push(We(i,e,t));return n.push(a),ue(n)})).catch((e=>ge(e,8)?e:Promise.reject(e)))}function j(e,t,n){p.list().forEach((i=>U((()=>i(e,t,n)))))}function $(e,t,n,i,r){const a=I(e,t);if(a)return a;const l=t===H,c=s?history.state:{};n&&(i||l?o.replace(e.fullPath,u({scroll:l&&c&&c.scroll},r)):o.push(e.fullPath,r)),g.value=e,ie(e,t,n,l),ee()}let G;function V(){G||(G=o.listen(((e,t,n)=>{if(!oe.listening)return;const i=A(e),r=C(i);if(r)return void P(u(r,{replace:!0,force:!0}),i).catch(c);m=i;const a=g.value;s&&te(Z(a.fullPath,n.delta),Q()),B(i,a).catch((e=>ge(e,12)?e:ge(e,2)?(P(u(x(e.to),{force:!0}),i).then((e=>{ge(e,20)&&!n.delta&&n.type===K.pop&&o.go(-1,!1)})).catch(c),Promise.reject()):(n.delta&&o.go(-n.delta,!1),X(e,i,a)))).then((e=>{e=e||$(i,a,!1),e&&(n.delta&&!ge(e,8)?o.go(-n.delta,!1):n.type===K.pop&&ge(e,20)&&o.go(-1,!1)),j(i,a,e)})).catch(c)})))}let W,q=Ke(),Y=Ke();function X(e,t,n){ee(e);const i=Y.list();return i.length?i.forEach((i=>i(e,t,n))):console.error(e),Promise.reject(e)}function z(){return W&&g.value!==H?Promise.resolve():new Promise(((e,t)=>{q.add([e,t])}))}function ee(e){return W||(W=!e,V(),q.list().forEach((([t,n])=>e?n(e):t())),q.reset()),e}function ie(t,n,r,a){const{scrollBehavior:o}=e;if(!s||!o)return Promise.resolve();const u=!r&&ne(Z(t.fullPath,0))||(a||!r)&&history.state&&history.state.scroll||null;return(0,i.dY)().then((()=>o(t,n,u))).then((e=>e&&J(e))).catch((e=>X(e,t,n)))}const re=e=>o.go(e);let se;const ae=new Set,oe={currentRoute:g,listening:!0,addRoute:T,removeRoute:S,clearRoutes:t.clearRoutes,hasRoute:w,getRoutes:E,resolve:A,options:e,push:L,replace:R,go:re,back:()=>re(-1),forward:()=>re(1),beforeEach:h.add,beforeResolve:f.add,afterEach:p.add,onError:Y.add,isReady:z,install(e){const t=this;e.component("RouterLink",Qe),e.component("RouterView",rt),e.config.globalProperties.$router=t,Object.defineProperty(e.config.globalProperties,"$route",{enumerable:!0,get:()=>(0,r.R1)(g)}),s&&!se&&g.value===H&&(se=!0,L(o.location).catch((e=>{0})));const n={};for(const r in H)Object.defineProperty(n,r,{get:()=>g.value[r],enumerable:!0});e.provide(Ge,t),e.provide(Ve,(0,r.Gc)(n)),e.provide(He,g);const i=e.unmount;ae.add(e),e.unmount=function(){ae.delete(e),ae.size<1&&(m=H,G&&G(),G=null,g.value=H,se=!1,W=!1),i()}}};function ue(e){return e.reduce(((e,t)=>e.then((()=>U(t)))),Promise.resolve())}return oe}function at(e,t){const n=[],i=[],r=[],s=Math.max(t.matched.length,e.matched.length);for(let a=0;a<s;a++){const s=t.matched[a];s&&(e.matched.find((e=>B(e,s)))?i.push(s):n.push(s));const o=e.matched[a];o&&(t.matched.find((e=>B(e,o)))||r.push(o))}return[n,i,r]}function ot(){return(0,i.WQ)(Ge)}function ut(e){return(0,i.WQ)(Ve)}},1510:function(e,t,n){"use strict";n.d(t,{KpY:function(){return b}});n(4114),n(8111),n(1148),n(2489),n(116),n(531),n(7588),n(1701),n(8237),n(3579),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698),n(4979);var i=n(144),r=n(6768);function s(e){return!!(0,i.o5)()&&((0,i.jr)(e),!0)}const a="undefined"!==typeof window&&"undefined"!==typeof document,o=("undefined"!==typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope),Object.prototype.toString),u=e=>"[object Object]"===o.call(e);function l(e){return Array.isArray(e)?e:[e]}function c(e){const t=Object.create(null);return n=>{const i=t[n];return i||(t[n]=e(n))}}const d=/\B([A-Z])/g,h=(c((e=>e.replace(d,"-$1").toLowerCase())),/-(\w)/g);c((e=>e.replace(h,((e,t)=>t?t.toUpperCase():""))));function f(e,t,n){return(0,r.wB)(e,t,{...n,immediate:!0})}const p=a?window:void 0;a&&window.document,a&&window.navigator,a&&window.location;function g(e){var t;const n=(0,i.BA)(e);return null!=(t=null==n?void 0:n.$el)?t:n}function m(...e){const t=[],n=()=>{t.forEach((e=>e())),t.length=0},a=(e,t,n,i)=>(e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)),o=(0,r.EW)((()=>{const t=l((0,i.BA)(e[0])).filter((e=>null!=e));return t.every((e=>"string"!==typeof e))?t:void 0})),c=f((()=>{var t,n;return[null!=(n=null==(t=o.value)?void 0:t.map((e=>g(e))))?n:[p].filter((e=>null!=e)),l((0,i.BA)(o.value?e[1]:e[0])),l((0,i.R1)(o.value?e[2]:e[1])),(0,i.BA)(o.value?e[3]:e[2])]}),(([e,i,r,s])=>{if(n(),!(null==e?void 0:e.length)||!(null==i?void 0:i.length)||!(null==r?void 0:r.length))return;const o=u(s)?{...s}:s;t.push(...e.flatMap((e=>i.flatMap((t=>r.map((n=>a(e,t,n,o))))))))}),{flush:"post"}),d=()=>{c(),n()};return s(n),d}function v(){const e=(0,i.IJ)(!1),t=(0,r.nI)();return t&&(0,r.sV)((()=>{e.value=!0}),t),e}function y(e){const t=v();return(0,r.EW)((()=>(t.value,Boolean(e()))))}Symbol("vueuse-ssr-width");"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self&&self;function b(e={}){const{window:t=p}=e,n=y((()=>t&&"screen"in t&&"orientation"in t.screen)),r=n.value?t.screen.orientation:{},s=(0,i.KR)(r.type),a=(0,i.IJ)(r.angle||0);n.value&&m(t,"orientationchange",(()=>{s.value=r.type,a.value=r.angle}),{passive:!0});const o=e=>n.value&&"function"===typeof r.lock?r.lock(e):Promise.reject(new Error("Not supported")),u=()=>{n.value&&"function"===typeof r.unlock&&r.unlock()};return{isSupported:n,orientation:s,angle:a,lockOrientation:o,unlockOrientation:u}}Number.POSITIVE_INFINITY},1625:function(e,t,n){"use strict";var i=n(9504);e.exports=i({}.isPrototypeOf)},1698:function(e,t,n){"use strict";var i=n(6518),r=n(4204),s=n(4916);i({target:"Set",proto:!0,real:!0,forced:!s("union")},{union:r})},1701:function(e,t,n){"use strict";var i=n(6518),r=n(9565),s=n(9306),a=n(8551),o=n(1767),u=n(9462),l=n(6319),c=n(9539),d=n(4549),h=n(6395),f=!h&&d("map",TypeError),p=u((function(){var e=this.iterator,t=a(r(this.next,e)),n=this.done=!!t.done;if(!n)return l(e,this.mapper,[t.value,this.counter++],!0)}));i({target:"Iterator",proto:!0,real:!0,forced:h||f},{map:function(e){a(this);try{s(e)}catch(t){c(this,"throw",t)}return f?r(f,this,e):new p(o(this),{mapper:e})}})},1712:function(e,t,n){"use strict";n.d(t,{m:function(){return u}});var i=n(3883),r=n(4156),s=n(2436),a=n(4068);function o(e,t){const n=(0,a.a)(e,t?.in);return n.setHours(0,0,0,0),n}function u(e,t,n){const[a,u]=(0,r.x)(n?.in,e,t),l=o(a),c=o(u),d=+l-(0,i.G)(l),h=+c-(0,i.G)(c);return Math.round((d-h)/s.w4)}},1767:function(e){"use strict";e.exports=function(e){return{iterator:e,next:e.next,done:!1}}},1806:function(e,t,n){"use strict";var i=n(6518),r=n(8551),s=n(2652),a=n(1767),o=[].push;i({target:"Iterator",proto:!0,real:!0},{toArray:function(){var e=[];return s(a(r(this)),o,{that:e,IS_RECORD:!0}),e}})},1828:function(e,t,n){"use strict";var i=n(9504),r=n(9297),s=n(5397),a=n(9617).indexOf,o=n(421),u=i([].push);e.exports=function(e,t){var n,i=s(e),l=0,c=[];for(n in i)!r(o,n)&&r(i,n)&&u(c,n);while(t.length>l)r(i,n=t[l++])&&(~a(c,n)||u(c,n));return c}},2106:function(e,t,n){"use strict";var i=n(283),r=n(4913);e.exports=function(e,t,n){return n.get&&i(n.get,t,{getter:!0}),n.set&&i(n.set,t,{setter:!0}),r.f(e,t,n)}},2140:function(e,t,n){"use strict";var i=n(8227),r=i("toStringTag"),s={};s[r]="z",e.exports="[object z]"===String(s)},2195:function(e,t,n){"use strict";var i=n(9504),r=i({}.toString),s=i("".slice);e.exports=function(e){return s(r(e),8,-1)}},2211:function(e,t,n){"use strict";var i=n(9039);e.exports=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},2360:function(e,t,n){"use strict";var i,r=n(8551),s=n(6801),a=n(8727),o=n(421),u=n(397),l=n(4055),c=n(6119),d=">",h="<",f="prototype",p="script",g=c("IE_PROTO"),m=function(){},v=function(e){return h+p+d+e+h+"/"+p+d},y=function(e){e.write(v("")),e.close();var t=e.parentWindow.Object;return e=null,t},b=function(){var e,t=l("iframe"),n="java"+p+":";return t.style.display="none",u.appendChild(t),t.src=String(n),e=t.contentWindow.document,e.open(),e.write(v("document.F=Object")),e.close(),e.F},T=function(){try{i=new ActiveXObject("htmlfile")}catch(t){}T="undefined"!=typeof document?document.domain&&i?y(i):b():y(i);var e=a.length;while(e--)delete T[f][a[e]];return T()};o[g]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(m[f]=r(e),n=new m,m[f]=null,n[g]=e):n=T(),void 0===t?n:s.f(n,t)}},2436:function(e,t,n){"use strict";n.d(t,{F6:function(){return a},Nw:function(){return s},_P:function(){return o},my:function(){return i},w4:function(){return r}});Math.pow(10,8);const i=6048e5,r=864e5,s=43200,a=1440,o=Symbol.for("constructDateFrom")},2475:function(e,t,n){"use strict";var i=n(6518),r=n(8527),s=n(4916),a=!s("isSupersetOf",(function(e){return!e}));i({target:"Set",proto:!0,real:!0,forced:a},{isSupersetOf:r})},2489:function(e,t,n){"use strict";var i=n(6518),r=n(9565),s=n(9306),a=n(8551),o=n(1767),u=n(9462),l=n(6319),c=n(6395),d=n(9539),h=n(4549),f=!c&&h("filter",TypeError),p=u((function(){var e,t,n,i=this.iterator,s=this.predicate,o=this.next;while(1){if(e=a(r(o,i)),t=this.done=!!e.done,t)return;if(n=e.value,l(i,s,[n,this.counter++],!0))return n}}));i({target:"Iterator",proto:!0,real:!0,forced:c||f},{filter:function(e){a(this);try{s(e)}catch(t){d(this,"throw",t)}return f?r(f,this,e):new p(o(this),{predicate:e})}})},2529:function(e){"use strict";e.exports=function(e,t){return{value:e,done:t}}},2603:function(e,t,n){"use strict";var i=n(655);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:i(e)}},2652:function(e,t,n){"use strict";var i=n(6080),r=n(9565),s=n(8551),a=n(6823),o=n(4209),u=n(6198),l=n(1625),c=n(81),d=n(851),h=n(9539),f=TypeError,p=function(e,t){this.stopped=e,this.result=t},g=p.prototype;e.exports=function(e,t,n){var m,v,y,b,T,S,E,w=n&&n.that,A=!(!n||!n.AS_ENTRIES),x=!(!n||!n.IS_RECORD),I=!(!n||!n.IS_ITERATOR),k=!(!n||!n.INTERRUPTED),L=i(t,w),R=function(e){return m&&h(m,"normal",e),new p(!0,e)},C=function(e){return A?(s(e),k?L(e[0],e[1],R):L(e[0],e[1])):k?L(e,R):L(e)};if(x)m=e.iterator;else if(I)m=e;else{if(v=d(e),!v)throw new f(a(e)+" is not iterable");if(o(v)){for(y=0,b=u(e);b>y;y++)if(T=C(e[y]),T&&l(g,T))return T;return new p(!1)}m=c(e,v)}S=x?e.next:m.next;while(!(E=r(S,m)).done){try{T=C(E.value)}catch(D){h(m,"throw",D)}if("object"==typeof T&&T&&l(g,T))return T}return new p(!1)}},2777:function(e,t,n){"use strict";var i=n(9565),r=n(34),s=n(757),a=n(5966),o=n(4270),u=n(8227),l=TypeError,c=u("toPrimitive");e.exports=function(e,t){if(!r(e)||s(e))return e;var n,u=a(e,c);if(u){if(void 0===t&&(t="default"),n=i(u,e,t),!r(n)||s(n))return n;throw new l("Can't convert object to primitive value")}return void 0===t&&(t="number"),o(e,t)}},2787:function(e,t,n){"use strict";var i=n(9297),r=n(4901),s=n(8981),a=n(6119),o=n(2211),u=a("IE_PROTO"),l=Object,c=l.prototype;e.exports=o?l.getPrototypeOf:function(e){var t=s(e);if(i(t,u))return t[u];var n=t.constructor;return r(n)&&t instanceof n?n.prototype:t instanceof l?c:null}},2796:function(e,t,n){"use strict";var i=n(9039),r=n(4901),s=/#|\.prototype\./,a=function(e,t){var n=u[o(e)];return n===c||n!==l&&(r(t)?i(t):!!t)},o=a.normalize=function(e){return String(e).replace(s,".").toLowerCase()},u=a.data={},l=a.NATIVE="N",c=a.POLYFILL="P";e.exports=a},2812:function(e){"use strict";var t=TypeError;e.exports=function(e,n){if(e<n)throw new t("Not enough arguments");return e}},2839:function(e,t,n){"use strict";var i=n(4576),r=i.navigator,s=r&&r.userAgent;e.exports=s?String(s):""},2967:function(e,t,n){"use strict";var i=n(6706),r=n(34),s=n(7750),a=n(3506);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{e=i(Object.prototype,"__proto__","set"),e(n,[]),t=n instanceof Array}catch(o){}return function(n,i){return s(n),a(i),r(n)?(t?e(n,i):n.__proto__=i,n):n}}():void 0)},3066:function(e,t,n){"use strict";n.d(t,{B:function(){return y}});var i=n(8541),r=n(9369),s=n(3883),a=n(4156),o=n(4068);function u(e,t){const n=+(0,o.a)(e)-+(0,o.a)(t);return n<0?-1:n>0?1:n}var l=n(2436);function c(e,t,n){const[i,r]=(0,a.x)(n?.in,e,t),s=i.getFullYear()-r.getFullYear(),o=i.getMonth()-r.getMonth();return 12*s+o}function d(e,t){const n=(0,o.a)(e,t?.in);return n.setHours(23,59,59,999),n}function h(e,t){const n=(0,o.a)(e,t?.in),i=n.getMonth();return n.setFullYear(n.getFullYear(),i+1,0),n.setHours(23,59,59,999),n}function f(e,t){const n=(0,o.a)(e,t?.in);return+d(n,t)===+h(n,t)}function p(e,t,n){const[i,r,s]=(0,a.x)(n?.in,e,e,t),o=u(r,s),l=Math.abs(c(r,s));if(l<1)return 0;1===r.getMonth()&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-o*l);let d=u(r,s)===-o;f(i)&&1===l&&1===u(i,s)&&(d=!1);const h=o*(l-+d);return 0===h?0:h}function g(e){return t=>{const n=e?Math[e]:Math.trunc,i=n(t);return 0===i?0:i}}function m(e,t){return+(0,o.a)(e)-+(0,o.a)(t)}function v(e,t,n){const i=m(e,t)/1e3;return g(n?.roundingMethod)(i)}function y(e,t,n){const o=(0,r.q)(),c=n?.locale??o.locale??i.c,d=2520,h=u(e,t);if(isNaN(h))throw new RangeError("Invalid time value");const f=Object.assign({},n,{addSuffix:n?.addSuffix,comparison:h}),[g,m]=(0,a.x)(n?.in,...h>0?[t,e]:[e,t]),y=v(m,g),b=((0,s.G)(m)-(0,s.G)(g))/1e3,T=Math.round((y-b)/60);let S;if(T<2)return n?.includeSeconds?y<5?c.formatDistance("lessThanXSeconds",5,f):y<10?c.formatDistance("lessThanXSeconds",10,f):y<20?c.formatDistance("lessThanXSeconds",20,f):y<40?c.formatDistance("halfAMinute",0,f):y<60?c.formatDistance("lessThanXMinutes",1,f):c.formatDistance("xMinutes",1,f):0===T?c.formatDistance("lessThanXMinutes",1,f):c.formatDistance("xMinutes",T,f);if(T<45)return c.formatDistance("xMinutes",T,f);if(T<90)return c.formatDistance("aboutXHours",1,f);if(T<l.F6){const e=Math.round(T/60);return c.formatDistance("aboutXHours",e,f)}if(T<d)return c.formatDistance("xDays",1,f);if(T<l.Nw){const e=Math.round(T/l.F6);return c.formatDistance("xDays",e,f)}if(T<2*l.Nw)return S=Math.round(T/l.Nw),c.formatDistance("aboutXMonths",S,f);if(S=p(m,g),S<12){const e=Math.round(T/l.Nw);return c.formatDistance("xMonths",e,f)}{const e=S%12,t=Math.trunc(S/12);return e<3?c.formatDistance("aboutXYears",t,f):e<9?c.formatDistance("overXYears",t,f):c.formatDistance("almostXYears",t+1,f)}}},3167:function(e,t,n){"use strict";var i=n(4901),r=n(34),s=n(2967);e.exports=function(e,t,n){var a,o;return s&&i(a=t.constructor)&&a!==n&&r(o=a.prototype)&&o!==n.prototype&&s(e,o),e}},3392:function(e,t,n){"use strict";var i=n(9504),r=0,s=Math.random(),a=i(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++r+s,36)}},3440:function(e,t,n){"use strict";var i=n(7080),r=n(4402),s=n(9286),a=n(5170),o=n(3789),u=n(8469),l=n(507),c=r.has,d=r.remove;e.exports=function(e){var t=i(this),n=o(e),r=s(t);return a(t)<=n.size?u(t,(function(e){n.includes(e)&&d(r,e)})):l(n.getIterator(),(function(e){c(t,e)&&d(r,e)})),r}},3506:function(e,t,n){"use strict";var i=n(3925),r=String,s=TypeError;e.exports=function(e){if(i(e))return e;throw new s("Can't set "+r(e)+" as a prototype")}},3579:function(e,t,n){"use strict";var i=n(6518),r=n(9565),s=n(2652),a=n(9306),o=n(8551),u=n(1767),l=n(9539),c=n(4549),d=c("some",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:d},{some:function(e){o(this);try{a(e)}catch(i){l(this,"throw",i)}if(d)return r(d,this,e);var t=u(this),n=0;return s(t,(function(t,i){if(e(t,n++))return i()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},3650:function(e,t,n){"use strict";var i=n(7080),r=n(4402),s=n(9286),a=n(3789),o=n(507),u=r.add,l=r.has,c=r.remove;e.exports=function(e){var t=i(this),n=a(e).getIterator(),r=s(t);return o(n,(function(e){l(t,e)?c(r,e):u(r,e)})),r}},3706:function(e,t,n){"use strict";var i=n(9504),r=n(4901),s=n(7629),a=i(Function.toString);r(s.inspectSource)||(s.inspectSource=function(e){return a(e)}),e.exports=s.inspectSource},3717:function(e,t){"use strict";t.f=Object.getOwnPropertySymbols},3724:function(e,t,n){"use strict";var i=n(9039);e.exports=!i((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},3789:function(e,t,n){"use strict";var i=n(9306),r=n(8551),s=n(9565),a=n(1291),o=n(1767),u="Invalid size",l=RangeError,c=TypeError,d=Math.max,h=function(e,t){this.set=e,this.size=d(t,0),this.has=i(e.has),this.keys=i(e.keys)};h.prototype={getIterator:function(){return o(r(s(this.keys,this.set)))},includes:function(e){return s(this.has,this.set,e)}},e.exports=function(e){r(e);var t=+e.size;if(t!==t)throw new c(u);var n=a(t);if(n<0)throw new l(u);return new h(e,n)}},3838:function(e,t,n){"use strict";var i=n(7080),r=n(5170),s=n(8469),a=n(3789);e.exports=function(e){var t=i(this),n=a(e);return!(r(t)>n.size)&&!1!==s(t,(function(e){if(!n.includes(e))return!1}),!0)}},3853:function(e,t,n){"use strict";var i=n(6518),r=n(4449),s=n(4916),a=!s("isDisjointFrom",(function(e){return!e}));i({target:"Set",proto:!0,real:!0,forced:a},{isDisjointFrom:r})},3883:function(e,t,n){"use strict";n.d(t,{G:function(){return r}});var i=n(4068);function r(e){const t=(0,i.a)(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}},3925:function(e,t,n){"use strict";var i=n(34);e.exports=function(e){return i(e)||null===e}},4004:function(e,t,n){"use strict";n.d(t,{Ay:function(){return Wl}});n(4114),n(8111),n(2489),n(116),n(7588),n(1701),n(8237),n(3579),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698),n(4979);const i=Number.isFinite||function(e){return"number"===typeof e&&isFinite(e)},r=Number.isSafeInteger||function(e){return"number"===typeof e&&Math.abs(e)<=s},s=Number.MAX_SAFE_INTEGER||9007199254740991;let a=function(e){return e["NETWORK_ERROR"]="networkError",e["MEDIA_ERROR"]="mediaError",e["KEY_SYSTEM_ERROR"]="keySystemError",e["MUX_ERROR"]="muxError",e["OTHER_ERROR"]="otherError",e}({}),o=function(e){return e["KEY_SYSTEM_NO_KEYS"]="keySystemNoKeys",e["KEY_SYSTEM_NO_ACCESS"]="keySystemNoAccess",e["KEY_SYSTEM_NO_SESSION"]="keySystemNoSession",e["KEY_SYSTEM_NO_CONFIGURED_LICENSE"]="keySystemNoConfiguredLicense",e["KEY_SYSTEM_LICENSE_REQUEST_FAILED"]="keySystemLicenseRequestFailed",e["KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED"]="keySystemServerCertificateRequestFailed",e["KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED"]="keySystemServerCertificateUpdateFailed",e["KEY_SYSTEM_SESSION_UPDATE_FAILED"]="keySystemSessionUpdateFailed",e["KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED"]="keySystemStatusOutputRestricted",e["KEY_SYSTEM_STATUS_INTERNAL_ERROR"]="keySystemStatusInternalError",e["KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR"]="keySystemDestroyMediaKeysError",e["KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR"]="keySystemDestroyCloseSessionError",e["KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR"]="keySystemDestroyRemoveSessionError",e["MANIFEST_LOAD_ERROR"]="manifestLoadError",e["MANIFEST_LOAD_TIMEOUT"]="manifestLoadTimeOut",e["MANIFEST_PARSING_ERROR"]="manifestParsingError",e["MANIFEST_INCOMPATIBLE_CODECS_ERROR"]="manifestIncompatibleCodecsError",e["LEVEL_EMPTY_ERROR"]="levelEmptyError",e["LEVEL_LOAD_ERROR"]="levelLoadError",e["LEVEL_LOAD_TIMEOUT"]="levelLoadTimeOut",e["LEVEL_PARSING_ERROR"]="levelParsingError",e["LEVEL_SWITCH_ERROR"]="levelSwitchError",e["AUDIO_TRACK_LOAD_ERROR"]="audioTrackLoadError",e["AUDIO_TRACK_LOAD_TIMEOUT"]="audioTrackLoadTimeOut",e["SUBTITLE_LOAD_ERROR"]="subtitleTrackLoadError",e["SUBTITLE_TRACK_LOAD_TIMEOUT"]="subtitleTrackLoadTimeOut",e["FRAG_LOAD_ERROR"]="fragLoadError",e["FRAG_LOAD_TIMEOUT"]="fragLoadTimeOut",e["FRAG_DECRYPT_ERROR"]="fragDecryptError",e["FRAG_PARSING_ERROR"]="fragParsingError",e["FRAG_GAP"]="fragGap",e["REMUX_ALLOC_ERROR"]="remuxAllocError",e["KEY_LOAD_ERROR"]="keyLoadError",e["KEY_LOAD_TIMEOUT"]="keyLoadTimeOut",e["BUFFER_ADD_CODEC_ERROR"]="bufferAddCodecError",e["BUFFER_INCOMPATIBLE_CODECS_ERROR"]="bufferIncompatibleCodecsError",e["BUFFER_APPEND_ERROR"]="bufferAppendError",e["BUFFER_APPENDING_ERROR"]="bufferAppendingError",e["BUFFER_STALLED_ERROR"]="bufferStalledError",e["BUFFER_FULL_ERROR"]="bufferFullError",e["BUFFER_SEEK_OVER_HOLE"]="bufferSeekOverHole",e["BUFFER_NUDGE_ON_STALL"]="bufferNudgeOnStall",e["ASSET_LIST_LOAD_ERROR"]="assetListLoadError",e["ASSET_LIST_LOAD_TIMEOUT"]="assetListLoadTimeout",e["ASSET_LIST_PARSING_ERROR"]="assetListParsingError",e["INTERSTITIAL_ASSET_ITEM_ERROR"]="interstitialAssetItemError",e["INTERNAL_EXCEPTION"]="internalException",e["INTERNAL_ABORTED"]="aborted",e["ATTACH_MEDIA_ERROR"]="attachMediaError",e["UNKNOWN"]="unknown",e}({}),u=function(e){return e["MEDIA_ATTACHING"]="hlsMediaAttaching",e["MEDIA_ATTACHED"]="hlsMediaAttached",e["MEDIA_DETACHING"]="hlsMediaDetaching",e["MEDIA_DETACHED"]="hlsMediaDetached",e["MEDIA_ENDED"]="hlsMediaEnded",e["STALL_RESOLVED"]="hlsStallResolved",e["BUFFER_RESET"]="hlsBufferReset",e["BUFFER_CODECS"]="hlsBufferCodecs",e["BUFFER_CREATED"]="hlsBufferCreated",e["BUFFER_APPENDING"]="hlsBufferAppending",e["BUFFER_APPENDED"]="hlsBufferAppended",e["BUFFER_EOS"]="hlsBufferEos",e["BUFFERED_TO_END"]="hlsBufferedToEnd",e["BUFFER_FLUSHING"]="hlsBufferFlushing",e["BUFFER_FLUSHED"]="hlsBufferFlushed",e["MANIFEST_LOADING"]="hlsManifestLoading",e["MANIFEST_LOADED"]="hlsManifestLoaded",e["MANIFEST_PARSED"]="hlsManifestParsed",e["LEVEL_SWITCHING"]="hlsLevelSwitching",e["LEVEL_SWITCHED"]="hlsLevelSwitched",e["LEVEL_LOADING"]="hlsLevelLoading",e["LEVEL_LOADED"]="hlsLevelLoaded",e["LEVEL_UPDATED"]="hlsLevelUpdated",e["LEVEL_PTS_UPDATED"]="hlsLevelPtsUpdated",e["LEVELS_UPDATED"]="hlsLevelsUpdated",e["AUDIO_TRACKS_UPDATED"]="hlsAudioTracksUpdated",e["AUDIO_TRACK_SWITCHING"]="hlsAudioTrackSwitching",e["AUDIO_TRACK_SWITCHED"]="hlsAudioTrackSwitched",e["AUDIO_TRACK_LOADING"]="hlsAudioTrackLoading",e["AUDIO_TRACK_LOADED"]="hlsAudioTrackLoaded",e["AUDIO_TRACK_UPDATED"]="hlsAudioTrackUpdated",e["SUBTITLE_TRACKS_UPDATED"]="hlsSubtitleTracksUpdated",e["SUBTITLE_TRACKS_CLEARED"]="hlsSubtitleTracksCleared",e["SUBTITLE_TRACK_SWITCH"]="hlsSubtitleTrackSwitch",e["SUBTITLE_TRACK_LOADING"]="hlsSubtitleTrackLoading",e["SUBTITLE_TRACK_LOADED"]="hlsSubtitleTrackLoaded",e["SUBTITLE_TRACK_UPDATED"]="hlsSubtitleTrackUpdated",e["SUBTITLE_FRAG_PROCESSED"]="hlsSubtitleFragProcessed",e["CUES_PARSED"]="hlsCuesParsed",e["NON_NATIVE_TEXT_TRACKS_FOUND"]="hlsNonNativeTextTracksFound",e["INIT_PTS_FOUND"]="hlsInitPtsFound",e["FRAG_LOADING"]="hlsFragLoading",e["FRAG_LOAD_EMERGENCY_ABORTED"]="hlsFragLoadEmergencyAborted",e["FRAG_LOADED"]="hlsFragLoaded",e["FRAG_DECRYPTED"]="hlsFragDecrypted",e["FRAG_PARSING_INIT_SEGMENT"]="hlsFragParsingInitSegment",e["FRAG_PARSING_USERDATA"]="hlsFragParsingUserdata",e["FRAG_PARSING_METADATA"]="hlsFragParsingMetadata",e["FRAG_PARSED"]="hlsFragParsed",e["FRAG_BUFFERED"]="hlsFragBuffered",e["FRAG_CHANGED"]="hlsFragChanged",e["FPS_DROP"]="hlsFpsDrop",e["FPS_DROP_LEVEL_CAPPING"]="hlsFpsDropLevelCapping",e["MAX_AUTO_LEVEL_UPDATED"]="hlsMaxAutoLevelUpdated",e["ERROR"]="hlsError",e["DESTROYING"]="hlsDestroying",e["KEY_LOADING"]="hlsKeyLoading",e["KEY_LOADED"]="hlsKeyLoaded",e["LIVE_BACK_BUFFER_REACHED"]="hlsLiveBackBufferReached",e["BACK_BUFFER_REACHED"]="hlsBackBufferReached",e["STEERING_MANIFEST_LOADED"]="hlsSteeringManifestLoaded",e["ASSET_LIST_LOADING"]="hlsAssetListLoading",e["ASSET_LIST_LOADED"]="hlsAssetListLoaded",e["INTERSTITIALS_UPDATED"]="hlsInterstitialsUpdated",e["INTERSTITIALS_BUFFERED_TO_BOUNDARY"]="hlsInterstitialsBufferedToBoundary",e["INTERSTITIAL_ASSET_PLAYER_CREATED"]="hlsInterstitialAssetPlayerCreated",e["INTERSTITIAL_STARTED"]="hlsInterstitialStarted",e["INTERSTITIAL_ASSET_STARTED"]="hlsInterstitialAssetStarted",e["INTERSTITIAL_ASSET_ENDED"]="hlsInterstitialAssetEnded",e["INTERSTITIAL_ASSET_ERROR"]="hlsInterstitialAssetError",e["INTERSTITIAL_ENDED"]="hlsInterstitialEnded",e["INTERSTITIALS_PRIMARY_RESUMED"]="hlsInterstitialsPrimaryResumed",e["PLAYOUT_LIMIT_REACHED"]="hlsPlayoutLimitReached",e["EVENT_CUE_ENTER"]="hlsEventCueEnter",e}({});var l={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},c={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class d{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class h{constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new d(e),this.fast_=new d(t),this.defaultTTFB_=i,this.ttfb_=new d(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:r}=this;n.halfLife!==e&&(this.slow_=new d(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new d(t,i.getEstimate(),i.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new d(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,i=e/1e3,r=n/i;this.fast_.sample(i,r),this.slow_.sample(i,r)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function f(e,t,n){return(t=y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},p.apply(null,arguments)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function y(e){var t=v(e,"string");return"symbol"==typeof t?t:t+""}class b{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const n=`[${e}]:`;this.trace=T,this.debug=t.debug.bind(null,n),this.log=t.log.bind(null,n),this.warn=t.warn.bind(null,n),this.info=t.info.bind(null,n),this.error=t.error.bind(null,n)}}const T=function(){},S={trace:T,debug:T,log:T,warn:T,info:T,error:T};function E(){return p({},S)}function w(e,t){const n=self.console[e];return n?n.bind(self.console,`${t?"["+t+"] ":""}[${e}] >`):T}function A(e,t,n){return t[e]?t[e].bind(t):w(e,n)}const x=E();function I(e,t,n){const i=E();if("object"===typeof console&&!0===e||"object"===typeof e){const s=["debug","log","info","warn","error"];s.forEach((t=>{i[t]=A(t,e,n)}));try{i.log(`Debug logs enabled for "${t}" in hls.js version 1.6.2`)}catch(r){return E()}s.forEach((t=>{x[t]=A(t,e)}))}else p(x,i);return i}const k=x;function L(e=!0){if("undefined"===typeof self)return;const t=(e||!self.MediaSource)&&self.ManagedMediaSource;return t||self.MediaSource||self.WebKitMediaSource}function R(e){return"undefined"!==typeof self&&e===self.ManagedMediaSource}function C(e,t){const n=Object.keys(e),i=Object.keys(t),r=n.length,s=i.length;return!r||!s||r===s&&!n.some((e=>-1===i.indexOf(e)))}function D(e,t=!1){if("undefined"!==typeof TextDecoder){const n=new TextDecoder("utf-8"),i=n.decode(e);if(t){const e=i.indexOf("\0");return-1!==e?i.substring(0,e):i}return i.replace(/\0/g,"")}const n=e.length;let i,r,s,a="",o=0;while(o<n){if(i=e[o++],0===i&&t)return a;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:r=e[o++],a+=String.fromCharCode((31&i)<<6|63&r);break;case 14:r=e[o++],s=e[o++],a+=String.fromCharCode((15&i)<<12|(63&r)<<6|63&s);break}}return a}const M={hexDump:function(e){let t="";for(let n=0;n<e.length;n++){let i=e[n].toString(16);i.length<2&&(i="0"+i),t+=i}return t}};function P(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}var _,O={exports:{}};function N(){return _||(_=1,function(e){(function(){var t=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,r=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),t=t.trim(),!t){if(!i.alwaysNormalize)return e;var r=s.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=s.normalizePath(r.path),s.buildURLFromParts(r)}var a=s.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o=s.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var u=n.exec(o.path);o.netLoc=u[1],o.path=u[2]}o.netLoc&&!o.path&&(o.path="/");var l={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(l.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;l.path=s.normalizePath(d)}else l.path=o.path,a.params||(l.params=o.params,a.query||(l.query=o.query));return null===l.path&&(l.path=i.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(l)},parseURL:function(e){var n=t.exec(e);return n?{scheme:n[1]||"",netLoc:n[2]||"",path:n[3]||"",params:n[4]||"",query:n[5]||"",fragment:n[6]||""}:null},normalizePath:function(e){e=e.split("").reverse().join("").replace(i,"");while(e.length!==(e=e.replace(r,"")).length);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=s})()}(O)),O.exports}var U=N();class F{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var B={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class j{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,"string"===typeof e&&(e={url:e}),this.base=e,K(this,"stats")}setByteRange(e,t){const n=e.split("@",2);let i;i=1===n.length?(null==t?void 0:t.byteRangeEndOffset)||0:parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get baseurl(){return this.base.url}get byteRange(){return null===this._byteRange?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return null===this._streams&&(this._streams={[B.AUDIO]:null,[B.VIDEO]:null,[B.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return null!==this._stats}get hasStreams(){return null!==this._streams}get stats(){return null===this._stats&&(this._stats=new F),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=U.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[B.AUDIO]=null,e[B.VIDEO]=null,e[B.AUDIOVIDEO]=null}}function $(e){return"initSegment"!==e.sn}class G extends j{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange){const e=this.byteRange[0],t=this.byteRange[1];if(i(e)&&i(t))return t-e}return null}get bitrate(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{const e=Object.keys(this.levelkeys);if(1===e.length)return this._decryptdata=this.levelkeys[e[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;const e=i(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){const e=Object.keys(this.levelkeys),t=e.length;if(t>1||1===t&&this.levelkeys[e[0]].encrypted)return!0}return!1}get programDateTime(){return null===this._programDateTime&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){i(e)?this._programDateTime=e:this._programDateTime=this.rawProgramDateTime=null}get ref(){return $(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,n,i,r,s=!1){const{elementaryStreams:a}=this,o=a[e];o?(o.startPTS=Math.min(o.startPTS,t),o.endPTS=Math.max(o.endPTS,n),o.startDTS=Math.min(o.startDTS,i),o.endDTS=Math.max(o.endDTS,r)):a[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:r,partial:s}}}class V extends j{constructor(e,t,n,i,r){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const s=e.enumeratedString("BYTERANGE");s&&this.setByteRange(s,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function H(e,t){const n=Object.getPrototypeOf(e);if(n){const e=Object.getOwnPropertyDescriptor(n,t);return e||H(n,t)}}function K(e,t){const n=H(e,t);n&&(n.enumerable=!0,Object.defineProperty(e,t,n))}const W=Math.pow(2,32)-1,q=[].push,Y={video:1,audio:2,id3:3,text:4};function X(e){return String.fromCharCode.apply(null,e)}function z(e,t){const n=e[t]<<8|e[t+1];return n<0?65536+n:n}function Q(e,t){const n=Z(e,t);return n<0?4294967296+n:n}function J(e,t){let n=Q(e,t);return n*=Math.pow(2,32),n+=Q(e,t+4),n}function Z(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function ee(e,t,n){e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function te(e){const t=e.byteLength;for(let n=0;n<t;){const i=Q(e,n);if(i>8&&109===e[n+4]&&111===e[n+5]&&111===e[n+6]&&102===e[n+7])return!0;n=i>1?n+i:t}return!1}function ne(e,t){const n=[];if(!t.length)return n;const i=e.byteLength;for(let r=0;r<i;){const s=Q(e,r),a=X(e.subarray(r+4,r+8)),o=s>1?r+s:i;if(a===t[0])if(1===t.length)n.push(e.subarray(r+8,o));else{const i=ne(e.subarray(r+8,o),t.slice(1));i.length&&q.apply(n,i)}r=o}return n}function ie(e){const t=[],n=e[0];let i=8;const r=Q(e,i);i+=4;let s=0,a=0;0===n?(s=Q(e,i),a=Q(e,i+4),i+=8):(s=J(e,i),a=J(e,i+8),i+=16),i+=2;let o=e.length+a;const u=z(e,i);i+=2;for(let l=0;l<u;l++){let n=i;const s=Q(e,n);n+=4;const a=2147483647&s,u=(2147483648&s)>>>31;if(1===u)return k.warn("SIDX has hierarchical references (not supported)"),null;const l=Q(e,n);n+=4,t.push({referenceSize:a,subsegmentDuration:l,info:{duration:l/r,start:o,end:o+a-1}}),o+=a,n+=4,i=n}return{earliestPresentationTime:s,timescale:r,version:n,referencesCount:u,references:t}}function re(e){const t=[],n=ne(e,["moov","trak"]);for(let r=0;r<n.length;r++){const e=n[r],i=ne(e,["tkhd"])[0];if(i){let n=i[0];const r=Q(i,0===n?12:20),s=ne(e,["mdia","mdhd"])[0];if(s){n=s[0];const i=Q(s,0===n?12:20),a=ne(e,["mdia","hdlr"])[0];if(a){const n=X(a.subarray(8,12)),s={soun:B.AUDIO,vide:B.VIDEO}[n],o=ne(e,["mdia","minf","stbl","stsd"])[0],u=se(o);s?(t[r]={timescale:i,type:s,stsd:u},t[s]=m({timescale:i,id:r},u)):t[r]={timescale:i,type:n,stsd:u}}}}}const i=ne(e,["moov","mvex","trex"]);return i.forEach((e=>{const n=Q(e,4),i=t[n];i&&(i.default={duration:Q(e,12),flags:Q(e,20)})})),t}function se(e){const t=e.subarray(8),n=t.subarray(86),i=X(t.subarray(4,8));let r,s=i;const a="enca"===i||"encv"===i;if(a){const e=ne(t,[i])[0],n=e.subarray("enca"===i?28:78),r=ne(n,["sinf"]);r.forEach((e=>{const t=ne(e,["schm"])[0];if(t){const n=X(t.subarray(4,8));if("cbcs"===n||"cenc"===n){const t=ne(e,["frma"])[0];t&&(s=X(t))}}}))}const o=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const e=ne(n,["avcC"])[0];e&&e.length>3&&(s+="."+ue(e[1])+ue(e[2])+ue(e[3]),r=ae("avc1"===o?"dva1":"dvav",n));break}case"mp4a":{const e=ne(t,[i])[0],n=ne(e.subarray(28),["esds"])[0];if(n&&n.length>7){let e=4;if(3!==n[e++])break;e=oe(n,e),e+=2;const t=n[e++];if(128&t&&(e+=2),64&t&&(e+=n[e++]),4!==n[e++])break;e=oe(n,e);const i=n[e++];if(64!==i)break;if(s+="."+ue(i),e+=12,5!==n[e++])break;e=oe(n,e);const r=n[e++];let a=(248&r)>>3;31===a&&(a+=1+((7&r)<<3)+((224&n[e])>>5)),s+="."+a}break}case"hvc1":case"hev1":{const e=ne(n,["hvcC"])[0];if(e&&e.length>12){const t=e[1],n=["","A","B","C"][t>>6],i=31&t,r=Q(e,2),a=(32&t)>>5?"H":"L",o=e[12],u=e.subarray(6,12);s+="."+n+i,s+="."+r.toString(16).toUpperCase(),s+="."+a+o;let l="";for(let e=u.length;e--;){const t=u[e];if(t||l){const e=t.toString(16).toUpperCase();l="."+e+l}}s+=l}r=ae("hev1"==o?"dvhe":"dvh1",n);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":s=ae(s,n)||s;break;case"vp09":{const e=ne(n,["vpcC"])[0];if(e&&e.length>6){const t=e[4],n=e[5],i=e[6]>>4&15;s+="."+le(t)+"."+le(n)+"."+le(i)}break}case"av01":{const e=ne(n,["av1C"])[0];if(e&&e.length>2){const t=e[1]>>>5,i=31&e[1],a=e[2]>>>7?"H":"M",o=(64&e[2])>>6,u=(32&e[2])>>5,l=2===t&&o?u?12:10:o?10:8,c=(16&e[2])>>4,d=(8&e[2])>>3,h=(4&e[2])>>2,f=3&e[2],p=1,g=1,m=1,v=0;s+="."+t+"."+le(i)+a+"."+le(l)+"."+c+"."+d+h+f+"."+le(p)+"."+le(g)+"."+le(m)+"."+v,r=ae("dav1",n)}break}}return{codec:s,encrypted:a,supplemental:r}}function ae(e,t){const n=ne(t,["dvvC"]),i=n.length?n[0]:ne(t,["dvcC"])[0];if(i){const t=i[2]>>1&127,n=i[2]<<5&32|i[3]>>3&31;return e+"."+le(t)+"."+le(n)}}function oe(e,t){const n=t+5;while(128&e[t++]&&t<n);return t}function ue(e){return("0"+e.toString(16).toUpperCase()).slice(-2)}function le(e){return(e<10?"0":"")+e}function ce(e,t){if(!e||!t)return e;const n=t.keyId;if(n&&t.isCommonEncryption){const t=ne(e,["moov","trak"]);t.forEach((e=>{const t=ne(e,["mdia","minf","stbl","stsd"])[0],i=t.subarray(8);let r=ne(i,["enca"]);const s=r.length>0;s||(r=ne(i,["encv"])),r.forEach((e=>{const t=s?e.subarray(28):e.subarray(78),i=ne(t,["sinf"]);i.forEach((e=>{const t=de(e);if(t){const e=t.subarray(8,24);e.some((e=>0!==e))||(k.log(`[eme] Patching keyId in 'enc${s?"a":"v"}>sinf>>tenc' box: ${M.hexDump(e)} -> ${M.hexDump(n)}`),t.set(n,8))}}))}))}))}return e}function de(e){const t=ne(e,["schm"])[0];if(t){const n=X(t.subarray(4,8));if("cbcs"===n||"cenc"===n)return ne(e,["schi","tenc"])[0]}return null}function he(e,t){return ne(t,["moof","traf"]).reduce(((t,n)=>{const r=ne(n,["tfdt"])[0],s=r[0],a=ne(n,["tfhd"]).reduce(((t,n)=>{const a=Q(n,4),o=e[a];if(o){let e=Q(r,4);if(1===s){if(e===W)return k.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),t;e*=W+1,e+=Q(r,8)}const n=o.timescale||9e4,a=e/n;if(i(a)&&(null===t||a<t))return a}return t}),null);return null!==a&&i(a)&&(null===t||a<t)?a:t}),null)}function fe(e,t){let n=0,r=0,s=0;const a=ne(e,["moof","traf"]);for(let i=0;i<a.length;i++){const e=a[i],o=ne(e,["tfhd"])[0],u=Q(o,4),l=t[u];if(!l)continue;const c=l.default,d=Q(o,0)|(null==c?void 0:c.flags);let h=null==c?void 0:c.duration;8&d&&(h=Q(o,2&d?12:8));const f=l.timescale||9e4,p=ne(e,["trun"]);for(let t=0;t<p.length;t++){if(n=pe(p[t]),!n&&h){const e=Q(p[t],4);n=h*e}l.type===B.VIDEO?r+=n/f:l.type===B.AUDIO&&(s+=n/f)}}if(0===r&&0===s){let t=1/0,n=0,r=0;const s=ne(e,["sidx"]);for(let e=0;e<s.length;e++){const i=ie(s[e]);if(null!=i&&i.references){t=Math.min(t,i.earliestPresentationTime/i.timescale);const e=i.references.reduce(((e,t)=>e+t.info.duration||0),0);n=Math.max(n,e+i.earliestPresentationTime/i.timescale),r=n-t}}if(r&&i(r))return r}return r||s}function pe(e){const t=Q(e,0);let n=8;1&t&&(n+=4),4&t&&(n+=4);let i=0;const r=Q(e,4);for(let s=0;s<r;s++){if(256&t){const t=Q(e,n);i+=t,n+=4}512&t&&(n+=4),1024&t&&(n+=4),2048&t&&(n+=4)}return i}function ge(e,t,n){ne(t,["moof","traf"]).forEach((t=>{ne(t,["tfhd"]).forEach((i=>{const r=Q(i,4),s=e[r];if(!s)return;const a=s.timescale||9e4;ne(t,["tfdt"]).forEach((e=>{const t=e[0],i=n*a;if(i){let n=Q(e,4);if(0===t)n-=i,n=Math.max(n,0),ee(e,4,n);else{n*=Math.pow(2,32),n+=Q(e,8),n-=i,n=Math.max(n,0);const t=Math.floor(n/(W+1)),r=Math.floor(n%(W+1));ee(e,4,t),ee(e,8,r)}}}))}))}))}function me(e){const t={valid:null,remainder:null},n=ne(e,["moof"]);if(n.length<2)return t.remainder=e,t;const i=n[n.length-1];return t.valid=e.slice(0,i.byteOffset-8),t.remainder=e.slice(i.byteOffset-8),t}function ve(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function ye(e,t){const n=[],i=t.samples,r=t.timescale,s=t.id;let a=!1;const o=ne(i,["moof"]);return o.map((o=>{const u=o.byteOffset-8,l=ne(o,["traf"]);l.map((o=>{const l=ne(o,["tfdt"]).map((e=>{const t=e[0];let n=Q(e,4);return 1===t&&(n*=Math.pow(2,32),n+=Q(e,8)),n/r}))[0];return void 0!==l&&(e=l),ne(o,["tfhd"]).map((l=>{const c=Q(l,4),d=16777215&Q(l,0),h=0!==(1&d),f=0!==(2&d),p=0!==(8&d);let g=0;const m=0!==(16&d);let v=0;const y=0!==(32&d);let b=8;c===s&&(h&&(b+=8),f&&(b+=4),p&&(g=Q(l,b),b+=4),m&&(v=Q(l,b),b+=4),y&&(b+=4),"video"===t.type&&(a=be(t.codec)),ne(o,["trun"]).map((s=>{const o=s[0],l=16777215&Q(s,0),c=0!==(1&l);let d=0;const h=0!==(4&l),f=0!==(256&l);let p=0;const m=0!==(512&l);let y=0;const b=0!==(1024&l),T=0!==(2048&l);let S=0;const E=Q(s,4);let w=8;c&&(d=Q(s,w),w+=4),h&&(w+=4);let A=d+u;for(let u=0;u<E;u++){if(f?(p=Q(s,w),w+=4):p=g,m?(y=Q(s,w),w+=4):y=v,b&&(w+=4),T&&(S=0===o?Q(s,w):Z(s,w),w+=4),t.type===B.VIDEO){let t=0;while(t<y){const s=Q(i,A);if(A+=4,Te(a,i[A])){const t=i.subarray(A,A+s);Se(t,a?2:1,e+S/r,n)}A+=s,t+=s+4}}e+=p/r}})))}))}))})),n}function be(e){if(!e)return!1;const t=e.substring(0,4);return"hvc1"===t||"hev1"===t||"dvh1"===t||"dvhe"===t}function Te(e,t){if(e){const e=t>>1&63;return 39===e||40===e}{const e=31&t;return 6===e}}function Se(e,t,n,i){const r=Ee(e);let s=0;s+=t;let a=0,o=0,u=0;while(s<r.length){a=0;do{if(s>=r.length)break;u=r[s++],a+=u}while(255===u);o=0;do{if(s>=r.length)break;u=r[s++],o+=u}while(255===u);const e=r.length-s;let t=s;if(o<e)s+=o;else if(o>e){k.error(`Malformed SEI payload. ${o} is too small, only ${e} bytes left to parse.`);break}if(4===a){const e=r[t++];if(181===e){const e=z(r,t);if(t+=2,49===e){const e=Q(r,t);if(t+=4,1195456820===e){const e=r[t++];if(3===e){const s=r[t++],o=31&s,u=64&s,l=u?2+3*o:0,c=new Uint8Array(l);if(u){c[0]=s;for(let e=1;e<l;e++)c[e]=r[t++]}i.push({type:e,payloadType:a,pts:n,bytes:c})}}}}}else if(5===a&&o>16){const e=[];for(let n=0;n<16;n++){const i=r[t++].toString(16);e.push(1==i.length?"0"+i:i),3!==n&&5!==n&&7!==n&&9!==n||e.push("-")}const s=o-16,u=new Uint8Array(s);for(let n=0;n<s;n++)u[n]=r[t++];i.push({payloadType:a,pts:n,uuid:e.join(""),userData:D(u),userDataBytes:u})}}}function Ee(e){const t=e.byteLength,n=[];let i=1;while(i<t-2)0===e[i]&&0===e[i+1]&&3===e[i+2]?(n.push(i+2),i+=2):i++;if(0===n.length)return e;const r=t-n.length,s=new Uint8Array(r);let a=0;for(i=0;i<r;a++,i++)a===n[0]&&(a++,n.shift()),s[i]=e[a];return s}function we(e){const t=e[0];let n="",i="",s=0,a=0,o=0,u=0,l=0,c=0;if(0===t){while("\0"!==X(e.subarray(c,c+1)))n+=X(e.subarray(c,c+1)),c+=1;n+=X(e.subarray(c,c+1)),c+=1;while("\0"!==X(e.subarray(c,c+1)))i+=X(e.subarray(c,c+1)),c+=1;i+=X(e.subarray(c,c+1)),c+=1,s=Q(e,12),a=Q(e,16),u=Q(e,20),l=Q(e,24),c=28}else if(1===t){c+=4,s=Q(e,c),c+=4;const t=Q(e,c);c+=4;const a=Q(e,c);c+=4,o=2**32*t+a,r(o)||(o=Number.MAX_SAFE_INTEGER,k.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),u=Q(e,c),c+=4,l=Q(e,c),c+=4;while("\0"!==X(e.subarray(c,c+1)))n+=X(e.subarray(c,c+1)),c+=1;n+=X(e.subarray(c,c+1)),c+=1;while("\0"!==X(e.subarray(c,c+1)))i+=X(e.subarray(c,c+1)),c+=1;i+=X(e.subarray(c,c+1)),c+=1}const d=e.subarray(c,e.byteLength);return{schemeIdUri:n,value:i,timeScale:s,presentationTime:o,presentationTimeDelta:a,eventDuration:u,id:l,payload:d}}function Ae(e,...t){const n=t.length;let i=8,r=n;while(r--)i+=t[r].byteLength;const s=new Uint8Array(i);for(s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=255&i,s.set(e,4),r=0,i=8;r<n;r++)s.set(t[r],i),i+=t[r].byteLength;return s}function xe(e,t,n){if(16!==e.byteLength)throw new RangeError("Invalid system id");let i,r,s;i=0,r=new Uint8Array,i>0?(s=new Uint8Array(4),t.length>0&&new DataView(s.buffer).setUint32(0,t.length,!1)):s=new Uint8Array;const a=new Uint8Array(4);return n&&n.byteLength>0&&new DataView(a.buffer).setUint32(0,n.byteLength,!1),Ae([112,115,115,104],new Uint8Array([i,0,0,0]),e,s,r,a,n||new Uint8Array)}function Ie(e){const t=[];if(e instanceof ArrayBuffer){const n=e.byteLength;let i=0;while(i+32<n){const n=new DataView(e,i),r=ke(n);t.push(r),i+=r.size}}return t}function ke(e){const t=e.getUint32(0),n=e.byteOffset,i=e.byteLength;if(i<t)return{offset:n,size:i};const r=e.getUint32(4);if(1886614376!==r)return{offset:n,size:t};const s=e.getUint32(8)>>>24;if(0!==s&&1!==s)return{offset:n,size:t};const a=e.buffer,o=M.hexDump(new Uint8Array(a,n+12,16)),u=e.getUint32(28);let l=null,c=null;if(0===s){if(t-32<u||u<22)return{offset:n,size:t};c=new Uint8Array(a,n+32,u)}else if(1===s){if(!u||i<n+32+16*u+16)return{offset:n,size:t};l=[];for(let e=0;e<u;e++)l.push(new Uint8Array(a,n+32+16*e,16))}return{version:s,systemId:o,kids:l,data:c,offset:n,size:t}}const Le=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Re={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Ce(e,t){const n=Re[t];return!!n&&!!n[e.slice(0,4)]}function De(e,t,n=!0){return!e.split(",").some((e=>!Me(e,t,n)))}function Me(e,t,n=!0){var i;const r=L(n);return null!=(i=null==r?void 0:r.isTypeSupported(Pe(e,t)))&&i}function Pe(e,t){return`${t}/mp4;codecs=${e}`}function _e(e){if(e){const t=e.substring(0,4);return Re.video[t]}return 2}function Oe(e){const t=Le();return e.split(",").reduce(((e,n)=>{const i=t&&be(n),r=i?9:Re.video[n];return r?(2*r+e)/(e?3:2):(Re.audio[n]+e)/(e?2:1)}),0)}const Ne={};function Ue(e,t=!0){if(Ne[e])return Ne[e];const n={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[e];for(let r=0;r<n.length;r++){var i;if(Me(n[r],"audio",t))return Ne[e]=n[r],n[r];if("mp3"===n[r]&&null!=(i=L(t))&&i.isTypeSupported("audio/mpeg"))return""}return e}const Fe=/flac|opus|mp4a\.40\.34/i;function Be(e,t=!0){return e.replace(Fe,(e=>Ue(e.toLowerCase(),t)))}function je(e,t){const n=[];if(e){const t=e.split(",");for(let e=0;e<t.length;e++)Ce(t[e],"video")||n.push(t[e])}return t&&n.push(t),n.join(",")}function $e(e,t){if(e&&(e.length>4||-1!==["ac-3","ec-3","alac","fLaC","Opus"].indexOf(e)))return e;if(t){const n=t.split(",");if(n.length>1){if(e)for(let t=n.length;t--;)if(n[t].substring(0,4)===e.substring(0,4))return n[t];return n[0]}}return t||e}function Ge(e){const t=e.split(",");for(let n=0;n<t.length;n++){const e=t[n].split(".");if(e.length>2){let i=e.shift()+".";i+=parseInt(e.shift()).toString(16),i+=("000"+parseInt(e.shift()).toString(16)).slice(-4),t[n]=i}}return t.join(",")}function Ve(e){if(e.startsWith("av01.")){const t=e.split("."),n=["0","111","01","01","01","0"];for(let e=t.length;e>4&&e<10;e++)t[e]=n[e-4];return t.join(".")}return e}function He(e){const t=L(e)||{isTypeSupported:()=>!1};return{mpeg:t.isTypeSupported("audio/mpeg"),mp3:t.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:t.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Ke(e){return e.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const We={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function qe(e,t){return{supported:!1,configurations:t,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:e}}const Ye={};function Xe(e,t,n,r,s,a){const o=e.audioCodec?e.audioGroups:null,u=null==a?void 0:a.audioCodec,l=null==a?void 0:a.channels,c=l?parseInt(l):u?1/0:2;let d=null;if(null!=o&&o.length)try{d=1===o.length&&o[0]?t.groups[o[0]].channels:o.reduce(((e,n)=>{if(n){const i=t.groups[n];if(!i)throw new Error(`Audio track group ${n} not found`);Object.keys(i.channels).forEach((t=>{e[t]=(e[t]||0)+i.channels[t]}))}return e}),{2:0})}catch(h){return!0}return void 0!==e.videoCodec&&(e.width>1920&&e.height>1088||e.height>1920&&e.width>1088||e.frameRate>Math.max(r,30)||"SDR"!==e.videoRange&&e.videoRange!==n||e.bitrate>Math.max(s,8e6))||!!d&&i(c)&&Object.keys(d).some((e=>parseInt(e)>c))}function ze(e,t,n){const r=e.videoCodec,s=e.audioCodec;if(!r&&!s||!n)return Promise.resolve(We);const a=[];if(r){const t={width:e.width,height:e.height,bitrate:Math.ceil(Math.max(.9*e.bitrate,e.averageBitrate)),framerate:e.frameRate||30},n=e.videoRange;"SDR"!==n&&(t.transferFunction=n.toLowerCase());const i=r.split(","),s=navigator.userAgent;if(i.some((e=>be(e)))&&Le())return Promise.resolve(qe(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: (${s})`),a));a.push.apply(a,i.map((e=>({type:"media-source",video:m(m({},t),{},{contentType:Pe(Ve(e),"video")})}))))}return s&&e.audioGroups&&e.audioGroups.forEach((e=>{var n;e&&(null==(n=t.groups[e])||n.tracks.forEach((t=>{if(t.groupId===e){const e=t.channels||"",n=parseFloat(e);i(n)&&n>2&&a.push.apply(a,s.split(",").map((e=>({type:"media-source",audio:{contentType:Pe(e,"audio"),channels:""+n}}))))}})))})),Promise.all(a.map((e=>{const t=Qe(e);return Ye[t]||(Ye[t]=n.decodingInfo(e))}))).then((e=>({supported:!e.some((e=>!e.supported)),configurations:a,decodingInfoResults:e}))).catch((e=>({supported:!1,configurations:a,decodingInfoResults:[],error:e})))}function Qe(e){const{audio:t,video:n}=e,i=n||t;if(i){const e=Ke(i.contentType);if(n)return`r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${e}_${Math.ceil(n.bitrate/1e5)}`;if(t)return`c${t.channels}${t.spatialRendering?"s":"n"}_${e}`}return""}const Je=["NONE","TYPE-0","TYPE-1",null];function Ze(e){return Je.indexOf(e)>-1}const et=["SDR","PQ","HLG"];function tt(e){return!!e&&et.indexOf(e)>-1}var nt={No:"",Yes:"YES",v2:"v2"};function it(e){const{canSkipUntil:t,canSkipDateRanges:n,age:i}=e,r=i<t/2;return t&&r?n?nt.v2:nt.Yes:nt.No}class rt{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class st{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter((e=>!!e)).map((e=>e.substring(0,4))).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const n=null==(t=e.supplemental)?void 0:t.videoCodec;n&&n!==e.videoCodec&&(this.codecSet+=`,${n.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return at(this._audioGroups,e)}hasSubtitleGroup(e){return at(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t)if("audio"===e){let e=this._audioGroups;e||(e=this._audioGroups=[]),-1===e.indexOf(t)&&e.push(t)}else if("text"===e){let e=this._subtitleGroups;e||(e=this._subtitleGroups=[]),-1===e.indexOf(t)&&e.push(t)}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return null==(e=this.audioGroups)?void 0:e[0]}get textGroupId(){var e;return null==(e=this.subtitleGroups)?void 0:e[0]}addFallback(){}}function at(e,t){return!(!t||!e)&&-1!==e.indexOf(t)}function ot(){if("function"===typeof matchMedia){const e=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(e.media!==t.media)return!0===e.matches}return!1}function ut(e,t){let n=!1,i=[];if(e&&(n="SDR"!==e,i=[e]),t){i=t.allowedVideoRanges||et.slice(0);const e="SDR"!==i.join("")&&!t.videoCodec;n=void 0!==t.preferHDR?t.preferHDR:e&&ot(),n||(i=["SDR"])}return{preferHDR:n,allowedVideoRanges:i}}const lt=e=>{const t=new WeakSet;return(n,i)=>{if(e&&(i=e(n,i)),"object"===typeof i&&null!==i){if(t.has(i))return;t.add(i)}return i}},ct=(e,t)=>JSON.stringify(e,lt(t));function dt(e,t,n,r,s){const a=Object.keys(e),o=null==r?void 0:r.channels,u=null==r?void 0:r.audioCodec,l=null==s?void 0:s.videoCodec,c=o&&2===parseInt(o);let d=!1,h=!1,f=1/0,p=1/0,g=1/0,m=1/0,v=0,y=[];const{preferHDR:b,allowedVideoRanges:T}=ut(t,s);for(let i=a.length;i--;){const t=e[a[i]];d||(d=t.channels[2]>0),f=Math.min(f,t.minHeight),p=Math.min(p,t.minFramerate),g=Math.min(g,t.minBitrate);const n=T.filter((e=>t.videoRanges[e]>0));n.length>0&&(h=!0)}f=i(f)?f:0,p=i(p)?p:0;const S=Math.max(1080,f),E=Math.max(30,p);g=i(g)?g:n,n=Math.max(g,n),h||(t=void 0);const w=a.length>1,A=a.reduce(((t,i)=>{const r=e[i];if(i===t)return t;if(y=h?T.filter((e=>r.videoRanges[e]>0)):[],w){if(r.minBitrate>n)return ht(i,`min bitrate of ${r.minBitrate} > current estimate of ${n}`),t;if(!r.hasDefaultAudio)return ht(i,"no renditions with default or auto-select sound found"),t;if(u&&i.indexOf(u.substring(0,4))%5!==0)return ht(i,`audio codec preference "${u}" not found`),t;if(o&&!c){if(!r.channels[o])return ht(i,`no renditions with ${o} channel sound found (channels options: ${Object.keys(r.channels)})`),t}else if((!u||c)&&d&&0===r.channels["2"])return ht(i,"no renditions with stereo sound found"),t;if(r.minHeight>S)return ht(i,`min resolution of ${r.minHeight} > maximum of ${S}`),t;if(r.minFramerate>E)return ht(i,`min framerate of ${r.minFramerate} > maximum of ${E}`),t;if(!y.some((e=>r.videoRanges[e]>0)))return ht(i,`no variants with VIDEO-RANGE of ${ct(y)} found`),t;if(l&&i.indexOf(l.substring(0,4))%5!==0)return ht(i,`video codec preference "${l}" not found`),t;if(r.maxScore<v)return ht(i,`max score of ${r.maxScore} < selected max of ${v}`),t}return t&&(Oe(i)>=Oe(t)||r.fragmentError>e[t].fragmentError)?t:(m=r.minIndex,v=r.maxScore,i)}),void 0);return{codecSet:A,videoRanges:y,preferHDR:b,minFramerate:p,minBitrate:g,minIndex:m}}function ht(e,t){k.log(`[abr] start candidates with "${e}" ignored because ${t}`)}function ft(e){return e.reduce(((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const i=t.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e}),{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function pt(e,t,n,i){return e.slice(n,i+1).reduce(((e,n,i)=>{if(!n.codecSet)return e;const r=n.audioGroups;let s=e[n.codecSet];s||(e[n.codecSet]=s={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:i,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!r,fragmentError:0}),s.minBitrate=Math.min(s.minBitrate,n.bitrate);const a=Math.min(n.height,n.width);return s.minHeight=Math.min(s.minHeight,a),s.minFramerate=Math.min(s.minFramerate,n.frameRate),s.minIndex=Math.min(s.minIndex,i),s.maxScore=Math.max(s.maxScore,n.score),s.fragmentError+=n.fragmentError,s.videoRanges[n.videoRange]=(s.videoRanges[n.videoRange]||0)+1,r&&r.forEach((e=>{if(!e)return;const n=t.groups[e];n&&(s.hasDefaultAudio=s.hasDefaultAudio||t.hasDefaultAudio?n.hasDefault:n.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(n.channels).forEach((e=>{s.channels[e]=(s.channels[e]||0)+n.channels[e]})))})),e}),{})}function gt(e){if(!e)return e;const{lang:t,assocLang:n,characteristics:i,channels:r,audioCodec:s}=e;return{lang:t,assocLang:n,characteristics:i,channels:r,audioCodec:s}}function mt(e,t,n){if("attrs"in e){const n=t.indexOf(e);if(-1!==n)return n}for(let i=0;i<t.length;i++){const r=t[i];if(vt(e,r,n))return i}return-1}function vt(e,t,n){const{groupId:i,name:r,lang:s,assocLang:a,default:o}=e,u=e.forced;return(void 0===i||t.groupId===i)&&(void 0===r||t.name===r)&&(void 0===s||yt(s,t.lang))&&(void 0===s||t.assocLang===a)&&(void 0===o||t.default===o)&&(void 0===u||t.forced===u)&&(!("characteristics"in e)||bt(e.characteristics||"",t.characteristics))&&(void 0===n||n(e,t))}function yt(e,t="--"){return e.length===t.length?e===t:e.startsWith(t)||t.startsWith(e)}function bt(e,t=""){const n=e.split(","),i=t.split(",");return n.length===i.length&&!n.some((e=>-1===i.indexOf(e)))}function Tt(e,t){const{audioCodec:n,channels:i}=e;return(void 0===n||(t.audioCodec||"").substring(0,4)===n.substring(0,4))&&(void 0===i||i===(t.channels||"2"))}function St(e,t,n,i,r){const s=t[i],a=t.reduce(((e,t,n)=>{const i=t.uri,r=e[i]||(e[i]=[]);return r.push(n),e}),{}),o=a[s.uri];o.length>1&&(i=Math.max.apply(Math,o));const u=s.videoRange,l=s.frameRate,c=s.codecSet.substring(0,4),d=Et(t,i,(t=>{if(t.videoRange!==u||t.frameRate!==l||t.codecSet.substring(0,4)!==c)return!1;const i=t.audioGroups,s=n.filter((e=>!i||-1!==i.indexOf(e.groupId)));return mt(e,s,r)>-1}));return d>-1?d:Et(t,i,(t=>{const i=t.audioGroups,s=n.filter((e=>!i||-1!==i.indexOf(e.groupId)));return mt(e,s,r)>-1}))}function Et(e,t,n){for(let i=t;i>-1;i--)if(n(e[i]))return i;for(let i=t+1;i<e.length;i++)if(n(e[i]))return i;return-1}function wt(e,t){var n;return!!e&&e!==(null==(n=t.loadLevelObj)?void 0:n.uri)}class At extends b{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.bwEstimator=void 0,this._abandonRulesCheck=e=>{var t;const{fragCurrent:n,partCurrent:r,hls:s}=this,{autoLevelEnabled:a,media:o}=s;if(!n||!o)return;const l=performance.now(),c=r?r.stats:n.stats,d=r?r.duration:n.duration,h=l-c.loading.start,f=s.minAutoLevel,p=n.level,g=this._nextAutoLevel;if(c.aborted||c.loaded&&c.loaded===c.total||p<=f)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!a)return;const m=g>-1&&g!==p,v=!!e||m;if(!v&&(o.paused||!o.playbackRate||!o.readyState))return;const y=s.mainForwardBufferInfo;if(!v&&null===y)return;const b=this.bwEstimator.getEstimateTTFB(),T=Math.abs(o.playbackRate);if(h<=Math.max(b,d/(2*T)*1e3))return;const S=y?y.len/T:0,E=c.loading.first?c.loading.first-c.loading.start:-1,w=c.loaded&&E>-1,A=this.getBwEstimate(),x=s.levels,I=x[p],k=Math.max(c.loaded,Math.round(d*(n.bitrate||I.averageBitrate)/8));let L=w?h-E:h;L<1&&w&&(L=Math.min(h,8*c.loaded/A));const R=w?1e3*c.loaded/L:0,C=b/1e3,D=R?(k-c.loaded)/R:8*k/A+C;if(D<=S)return;const M=R?8*R:A,P=!0===(null==(t=(null==e?void 0:e.details)||this.hls.latestLevelDetails)?void 0:t.live),_=this.hls.config.abrBandWidthUpFactor;let O,N=Number.POSITIVE_INFINITY;for(O=p-1;O>f;O--){const e=x[O].maxBitrate,t=!x[O].details||P;if(N=this.getTimeToLoadFrag(C,M,d*e,t),N<Math.min(S,d+C))break}if(N>=D)return;if(N>10*d)return;w?this.bwEstimator.sample(h-Math.min(b,E),c.loaded):this.bwEstimator.sampleTTFB(h);const U=x[O].maxBitrate;this.getBwEstimate()*_>U&&this.resetEstimator(U);const F=this.findBestLevel(U,f,O,0,S,1,1);F>-1&&(O=F),this.warn(`Fragment ${n.sn}${r?" part "+r.index:""} of level ${p} is loading too slowly;\n      Fragment duration: ${n.duration.toFixed(3)}\n      Time to underbuffer: ${S.toFixed(3)} s\n      Estimated load time for current fragment: ${D.toFixed(3)} s\n      Estimated load time for down switch fragment: ${N.toFixed(3)} s\n      TTFB estimate: ${0|E} ms\n      Current BW estimate: ${i(A)?0|A:"Unknown"} bps\n      New BW estimate: ${0|this.getBwEstimate()} bps\n      Switching to level ${O} @ ${0|U} bps`),s.nextLoadLevel=s.nextAutoLevel=O,this.clearTimer();const B=()=>{if(this.clearTimer(),this.fragCurrent===n&&this.hls.loadLevel===O&&O>0){const e=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${O>0?"and switching down":""}\n      Fragment duration: ${n.duration.toFixed(3)} s\n      Time to underbuffer: ${e.toFixed(3)} s`),n.abortRequests(),this.fragCurrent=this.partCurrent=null,O>f){let t=this.findBestLevel(this.hls.levels[f].bitrate,f,O,0,e,1,1);-1===t&&(t=f),this.hls.nextLoadLevel=this.hls.nextAutoLevel=t,this.resetEstimator(this.hls.levels[t].bitrate)}}};m||D>2*N?B():this.timer=self.setInterval(B,1e3*N),s.trigger(u.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:r,stats:c})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new h(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.FRAG_LOADING,this.onFragLoading,this),e.on(u.FRAG_LOADED,this.onFragLoaded,this),e.on(u.FRAG_BUFFERED,this.onFragBuffered,this),e.on(u.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(u.LEVEL_LOADED,this.onLevelLoaded,this),e.on(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(u.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(u.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.FRAG_LOADING,this.onFragLoading,this),e.off(u.FRAG_LOADED,this.onFragLoaded,this),e.off(u.FRAG_BUFFERED,this.onFragBuffered,this),e.off(u.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(u.LEVEL_LOADED,this.onLevelLoaded,this),e.off(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(u.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(u.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){var i;if(!n.bitrateTest)this.fragCurrent=n,this.partCurrent=null!=(i=t.part)?i:null;this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case o.BUFFER_ADD_CODEC_ERROR:case o.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case o.FRAG_LOAD_TIMEOUT:{const e=t.frag,{fragCurrent:n,partCurrent:i}=this;if(e&&n&&e.sn===n.sn&&e.level===n.level){const t=performance.now(),n=i?i.stats:e.stats,r=t-n.loading.start,s=n.loading.first?n.loading.first-n.loading.start:-1,a=n.loaded&&s>-1;if(a){const e=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(r-Math.min(e,s),n.loaded)}else this.bwEstimator.sampleTTFB(r)}break}}}getTimeToLoadFrag(e,t,n,i){const r=e+n/t,s=i?e+this.lastLevelLoadSec:0;return r+s}onLevelLoaded(e,t){const n=this.hls.config,{loading:r}=t.stats,s=r.end-r.first;i(s)&&(this.lastLevelLoadSec=s/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:n}){const i=n?n.stats:t.stats;if(t.type===c.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const e=n?n.duration:t.duration,r=this.hls.levels[t.level],s=(r.loaded?r.loaded.bytes:0)+i.loaded,a=(r.loaded?r.loaded.duration:0)+e;r.loaded={bytes:s,duration:a},r.realBitrate=Math.round(8*s/a)}if(t.bitrateTest){const e={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered(u.FRAG_BUFFERED,e),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:i}=t,r=null!=i&&i.stats.loaded?i.stats:n.stats;if(r.aborted)return;if(this.ignoreFragment(n))return;const s=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(s,r.loaded),r.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=s/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==c.MAIN||"initSegment"===e.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,r=this.findBestLevel(n,t,e,0,i,1,1);if(r>-1)return r;const s=this.hls.firstLevel,a=Math.min(Math.max(s,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${s} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,t=this.bwEstimator,n=t.canEstimate(),i=this.lastLoadedFragLevel>-1;if(-1!==e&&(!n||!i||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const r=n&&i?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){const t=this.hls.levels;if(t.length>Math.max(e,r)&&t[e].loadError<=t[r].loadError)return e}return this._nextAutoLevel=r,this.nextAutoLevelKey=this.getAutoLevelKey(),r}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this;if(n.levels.length<=1)return n.loadLevel;const{maxAutoLevel:i,config:r,minAutoLevel:s}=n,a=t?t.duration:e?e.duration:0,o=this.getBwEstimate(),u=this.getStarvationDelay();let l=r.abrBandWidthFactor,c=r.abrBandWidthUpFactor;if(u){const e=this.findBestLevel(o,s,i,u,0,l,c);if(e>=0)return this.rebufferNotice=-1,e}let d=a?Math.min(a,r.maxStarvationDelay):r.maxStarvationDelay;if(!u){const e=this.bitrateTestDelay;if(e){const t=a?Math.min(a,r.maxLoadingDelay):r.maxLoadingDelay;d=t-e,this.info(`bitrate test took ${Math.round(1e3*e)}ms, set first fragment max fetchDuration to ${Math.round(1e3*d)} ms`),l=c=1}}const h=this.findBestLevel(o,s,i,u,d,l,c);if(this.rebufferNotice!==h&&(this.rebufferNotice=h,this.info(`${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${h}`)),h>-1)return h;const f=n.levels[s],p=n.loadLevelObj;return p&&(null==f?void 0:f.bitrate)<p.bitrate?s:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,r,s,a,o){var u;const l=r+s,c=this.lastLoadedFragLevel,d=-1===c?this.hls.firstLevel:c,{fragCurrent:h,partCurrent:f}=this,{levels:p,allAudioTracks:g,loadLevel:m,config:v}=this.hls;if(1===p.length)return 0;const y=p[d],b=!(null==(u=this.hls.latestLevelDetails)||!u.live),T=-1===m||-1===c;let S,E="SDR",w=(null==y?void 0:y.frameRate)||0;const{audioPreference:A,videoPreference:x}=v,I=this.audioTracksByGroup||(this.audioTracksByGroup=ft(g));let k=-1;if(T){if(-1!==this.firstSelection)return this.firstSelection;const i=this.codecTiers||(this.codecTiers=pt(p,I,t,n)),r=dt(i,E,e,A,x),{codecSet:s,videoRanges:a,minFramerate:o,minBitrate:u,minIndex:l,preferHDR:c}=r;k=l,S=s,E=c?a[a.length-1]:a[0],w=o,e=Math.max(e,u),this.log(`picked start tier ${ct(r)}`)}else S=null==y?void 0:y.codecSet,E=null==y?void 0:y.videoRange;const L=f?f.duration:h?h.duration:0,R=this.bwEstimator.getEstimateTTFB()/1e3,C=[];for(let M=n;M>=t;M--){var D;const t=p[M],u=M>d;if(!t)continue;if(v.useMediaCapabilities&&!t.supportedResult&&!t.supportedPromise){const n=navigator.mediaCapabilities;"function"===typeof(null==n?void 0:n.decodingInfo)&&(Xe(t,I,E,w,e,A)||be(t.videoCodec))?(t.supportedPromise=ze(t,I,n),t.supportedPromise.then((e=>{if(!this.hls)return;t.supportedResult=e;const n=this.hls.levels,i=n.indexOf(t);e.error?this.warn(`MediaCapabilities decodingInfo error: "${e.error}" for level ${i} ${ct(e)}`):e.supported||(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${i} ${ct(e)}`),i>-1&&n.length>1&&(this.log(`Removing unsupported level ${i}`),this.hls.removeLevel(i),-1===this.hls.loadLevel&&(this.hls.nextLoadLevel=0)))}))):t.supportedResult=We}if((S&&t.codecSet!==S||E&&t.videoRange!==E||u&&w>t.frameRate||!u&&w>0&&w<t.frameRate||t.supportedResult&&(null==(D=t.supportedResult.decodingInfoResults)||!D[0].smooth))&&(!T||M!==k)){C.push(M);continue}const h=t.details,g=(f?null==h?void 0:h.partTarget:null==h?void 0:h.averagetargetduration)||L;let y;y=u?o*e:a*e;const x=L&&r>=2*L&&0===s?t.averageBitrate:t.maxBitrate,P=this.getTimeToLoadFrag(R,y,x*g,void 0===h),_=y>=x&&(M===c||0===t.loadError&&0===t.fragmentError)&&(P<=R||!i(P)||b&&!this.bitrateTestDelay||P<l);if(_){const e=this.forcedAutoLevel;return M===m||-1!==e&&e===m||(C.length&&this.trace(`Skipped level(s) ${C.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${p[C[0]].codecs}" ${p[C[0]].videoRange}; not compatible with "${S}" ${E}`),this.info(`switch candidate:${d}->${M} adjustedbw(${Math.round(y)})-bitrate=${Math.round(y-x)} ttfb:${R.toFixed(1)} avgDuration:${g.toFixed(1)} maxFetchDuration:${l.toFixed(1)} fetchDuration:${P.toFixed(1)} firstSelection:${T} codecSet:${t.codecSet} videoRange:${t.videoRange} hls.loadLevel:${m}`)),T&&(this.firstSelection=M),M}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls;return Math.min(Math.max(e,n),t)}}const xt={search:function(e,t){let n=0,i=e.length-1,r=null,s=null;while(n<=i){r=(n+i)/2|0,s=e[r];const a=t(s);if(a>0)n=r+1;else{if(!(a<0))return s;i=r-1}}return null}};function It(e,t,n){if(null===t||!Array.isArray(e)||!e.length||!i(t))return null;const r=e[0].programDateTime;if(t<(r||0))return null;const s=e[e.length-1].endProgramDateTime;if(t>=(s||0))return null;n=n||0;for(let i=0;i<e.length;++i){const r=e[i];if(Ct(t,n,r))return r}return null}function kt(e,t,n=0,i=0,r=.005){let s=null;if(e){s=t[1+e.sn-t[0].sn]||null;const i=e.endDTS-n;i>0&&i<15e-7&&(n+=15e-7),s&&e.level!==s.level&&s.end<=e.end&&(s=t[2+e.sn-t[0].sn]||null)}else 0===n&&0===t[0].start&&(s=t[0]);if(s&&((!e||e.level===s.level)&&0===Rt(n,i,s)||Lt(s,e,Math.min(r,i))))return s;const a=xt.search(t,Rt.bind(null,n,i));return!a||a===e&&s?s:a}function Lt(e,t,n){if(t&&0===t.start&&t.level<e.level&&(t.endPTS||0)>0){const i=t.tagList.reduce(((e,t)=>("INF"===t[0]&&(e+=parseFloat(t[1])),e)),n);return e.start<=i}return!1}function Rt(e=0,t=0,n){if(n.start<=e&&n.start+n.duration>e)return 0;const i=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-i<=e?1:n.start-i>e&&n.start?-1:0}function Ct(e,t,n){const i=1e3*Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0)),r=n.endProgramDateTime||0;return r-i>e}function Dt(e,t){return xt.search(e,(e=>e.cc<t?1:e.cc>t?-1:0))}function Mt(e,t,n){if(e&&e.startCC<=t&&e.endCC>=t){const i=n.start,r=n.end;let s=e.fragments;if(!n.relurl){const{fragmentHint:t}=e;t&&(s=s.concat(t))}return xt.search(s,(e=>e.cc<t||e.end<=i?1:e.cc>t||e.start>=r?-1:0))}return null}function Pt(e){switch(e.details){case o.FRAG_LOAD_TIMEOUT:case o.KEY_LOAD_TIMEOUT:case o.LEVEL_LOAD_TIMEOUT:case o.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function _t(e,t){const n=Pt(t);return e.default[(n?"timeout":"error")+"Retry"]}function Ot(e,t){const n="linear"===e.backoff?1:Math.pow(2,t);return Math.min(n*e.retryDelayMs,e.maxRetryDelayMs)}function Nt(e){return m(m({},e),{errorRetry:null,timeoutRetry:null})}function Ut(e,t,n,i){if(!e)return!1;const r=null==i?void 0:i.code,s=t<e.maxNumRetry&&(Ft(r)||!!n);return e.shouldRetry?e.shouldRetry(e,t,n,i,s):s}function Ft(e){return 0===e&&!1===navigator.onLine||!!e&&(e<400||e>499)}var Bt={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},jt={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class $t extends b{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(u.ERROR,this.onError,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(u.ERROR,this.onError,this),e.off(u.ERROR,this.onErrorOut,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(null==e?void 0:e.type)===c.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n;if(t.fatal)return;const i=this.hls,r=t.context;switch(t.details){case o.FRAG_LOAD_ERROR:case o.FRAG_LOAD_TIMEOUT:case o.KEY_LOAD_ERROR:case o.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case o.FRAG_PARSING_ERROR:if(null!=(n=t.frag)&&n.gap)return void(t.errorAction=Gt());case o.FRAG_GAP:case o.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=Bt.SendAlternateToPenaltyBox);case o.LEVEL_EMPTY_ERROR:case o.LEVEL_PARSING_ERROR:{var s,u;const e=t.parent===c.MAIN?t.level:i.loadLevel;t.details===o.LEVEL_EMPTY_ERROR&&null!=(s=t.context)&&null!=(u=s.levelDetails)&&u.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case o.LEVEL_LOAD_ERROR:case o.LEVEL_LOAD_TIMEOUT:return void("number"===typeof(null==r?void 0:r.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.level)));case o.AUDIO_TRACK_LOAD_ERROR:case o.AUDIO_TRACK_LOAD_TIMEOUT:case o.SUBTITLE_LOAD_ERROR:case o.SUBTITLE_TRACK_LOAD_TIMEOUT:if(r){const e=i.loadLevelObj;if(e&&(r.type===l.AUDIO_TRACK&&e.hasAudioGroup(r.groupId)||r.type===l.SUBTITLE_TRACK&&e.hasSubtitleGroup(r.groupId)))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=Bt.SendAlternateToPenaltyBox,void(t.errorAction.flags=jt.MoveAllAlternatesMatchingHost)}return;case o.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const e=i.loadLevelObj,n=null==e?void 0:e.attrs["HDCP-LEVEL"];n?t.errorAction={action:Bt.SendAlternateToPenaltyBox,flags:jt.MoveAllAlternatesMatchingHDCP,hdcpLevel:n}:this.keySystemError(t)}return;case o.BUFFER_ADD_CODEC_ERROR:case o.REMUX_ALLOC_ERROR:case o.BUFFER_APPEND_ERROR:var d;if(!t.errorAction)t.errorAction=this.getLevelSwitchAction(t,null!=(d=t.level)?d:i.loadLevel);return;case o.INTERNAL_EXCEPTION:case o.BUFFER_APPENDING_ERROR:case o.BUFFER_FULL_ERROR:case o.LEVEL_SWITCH_ERROR:case o.BUFFER_STALLED_ERROR:case o.BUFFER_SEEK_OVER_HOLE:case o.BUFFER_NUDGE_ON_STALL:return void(t.errorAction=Gt())}t.type===a.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,i=_t(n.config.playlistLoadPolicy,e),r=this.playlistError++,s=Ut(i,r,Pt(e),e.response);if(s)return{action:Bt.RetryRequest,flags:jt.None,retryConfig:i,retryCount:r};const a=this.getLevelSwitchAction(e,t);return i&&(a.retryConfig=i,a.retryCount=r),a}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:r,keyLoadPolicy:s}=t.config,a=_t(e.details.startsWith("key")?s:r,e),u=t.levels.reduce(((e,t)=>e+t.fragmentError),0);if(i){e.details!==o.FRAG_GAP&&i.fragmentError++;const t=Ut(a,u,Pt(e),e.response);if(t)return{action:Bt.RetryRequest,flags:jt.None,retryConfig:a,retryCount:u}}const l=this.getLevelSwitchAction(e,n);return a&&(l.retryConfig=a,l.retryCount=u),l}getLevelSwitchAction(e,t){const n=this.hls;null!==t&&void 0!==t||(t=n.loadLevel);const i=this.hls.levels[t];if(i){var r,s;const t=e.details;i.loadError++,t===o.BUFFER_APPEND_ERROR&&i.fragmentError++;let d=-1;const{levels:h,loadLevel:f,minAutoLevel:p,maxAutoLevel:g}=n;n.autoLevelEnabled||(n.loadLevel=-1);const m=null==(r=e.frag)?void 0:r.type,v=m===c.AUDIO&&t===o.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(t===o.BUFFER_ADD_CODEC_ERROR||t===o.BUFFER_APPEND_ERROR),y=v&&h.some((({audioCodec:e})=>i.audioCodec!==e)),b="video"===e.sourceBufferName&&(t===o.BUFFER_ADD_CODEC_ERROR||t===o.BUFFER_APPEND_ERROR),T=b&&h.some((({codecSet:e,audioCodec:t})=>i.codecSet!==e&&i.audioCodec===t)),{type:S,groupId:E}=null!=(s=e.context)?s:{};for(let n=h.length;n--;){const r=(n+f)%h.length;if(r!==f&&r>=p&&r<=g&&0===h[r].loadError){var a,u;const n=h[r];if(t===o.FRAG_GAP&&m===c.MAIN&&e.frag){const t=h[r].details;if(t){const n=kt(e.frag,t.fragments,e.frag.start);if(null!=n&&n.gap)continue}}else{if(S===l.AUDIO_TRACK&&n.hasAudioGroup(E)||S===l.SUBTITLE_TRACK&&n.hasSubtitleGroup(E))continue;if(m===c.AUDIO&&null!=(a=i.audioGroups)&&a.some((e=>n.hasAudioGroup(e)))||m===c.SUBTITLE&&null!=(u=i.subtitleGroups)&&u.some((e=>n.hasSubtitleGroup(e)))||y&&i.audioCodec===n.audioCodec||!y&&i.audioCodec!==n.audioCodec||T&&i.codecSet===n.codecSet)continue}d=r;break}}if(d>-1&&n.loadLevel!==d)return e.levelRetry=!0,this.playlistError=0,{action:Bt.SendAlternateToPenaltyBox,flags:jt.None,nextAutoLevel:d}}return{action:Bt.SendAlternateToPenaltyBox,flags:jt.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch(null==(n=t.errorAction)?void 0:n.action){case Bt.DoNothing:break;case Bt.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===o.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError()):t.fatal=!0;break;case Bt.RetryRequest:break}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i,hdcpLevel:r,nextAutoLevel:s}=n;switch(i){case jt.None:this.switchLevel(e,s);break;case jt.MoveAllAlternatesMatchingHDCP:r&&(t.maxHdcpLevel=Je[Je.indexOf(r)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,s)}switchLevel(e,t){if(void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===o.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&"audiovideo"!==e.sourceBufferName)){const t=Ke(e.mimeType),n=this.hls.levels;for(let i=n.length;i--;)n[i][`${e.sourceBufferName}Codec`]===t&&this.hls.removeLevel(i)}}}function Gt(e){const t={action:Bt.DoNothing,flags:jt.None};return e&&(t.resolved=!0),t}var Vt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class Ht{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.BUFFER_APPENDED,this.onBufferAppended,this),e.on(u.FRAG_BUFFERED,this.onFragBuffered,this),e.on(u.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.BUFFER_APPENDED,this.onBufferAppended,this),e.off(u.FRAG_BUFFERED,this.onFragBuffered,this),e.off(u.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let i=n.length;i--;){const t=n[i];if(!t)break;const r=t.end;if(t.start<=e&&null!==r&&e<=r)return t}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,n){const{fragments:i}=this,r=Object.keys(i);for(let s=r.length;s--;){const a=i[r[s]];if((null==a?void 0:a.body.type)===t&&(!n||a.buffered)){const t=a.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,n,i,r){this.timeRanges&&(this.timeRanges[e]=t);const s=(null==i?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach((i=>{const a=this.fragments[i];if(!a)return;if(s>=a.body.sn)return;if(!a.buffered&&(!a.loaded||r))return void(a.body.type===n&&this.removeFragment(a.body));const o=a.range[e];o&&(0!==o.time.length?o.time.some((e=>{const n=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return n&&this.removeFragment(a.body),n})):this.removeFragment(a.body))}))}detectPartialFragments(e){const t=this.timeRanges;if(!t||"initSegment"===e.frag.sn)return;const n=e.frag,i=Wt(n),r=this.fragments[i];if(!r||r.buffered&&n.gap)return;const s=!n.relurl;if(Object.keys(t).forEach((i=>{const a=n.elementaryStreams[i];if(!a)return;const o=t[i],u=s||!0===a.partial;r.range[i]=this.getBufferedTimes(n,e.part,u,o)})),r.loaded=null,Object.keys(r.range).length){r.buffered=!0;const e=r.body.endList=n.endList||r.body.endList;e&&(this.endListFragments[r.body.type]=r),Kt(r)||this.removeParts(n.sn-1,n.type)}else this.removeFragment(r.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=qt(n,(t=>t.fragment.sn>=e)))}fragBuffered(e,t){const n=Wt(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){const r={time:[],partial:n},s=e.start,a=e.end,o=e.minEndPTS||a,u=e.maxStartPTS||s;for(let l=0;l<i.length;l++){const e=i.start(l)-this.bufferPadding,t=i.end(l)+this.bufferPadding;if(u>=e&&o<=t){r.time.push({startPTS:Math.max(s,i.start(l)),endPTS:Math.min(a,i.end(l))});break}if(s<t&&a>e){const e=Math.max(s,i.start(l)),t=Math.min(a,i.end(l));t>e&&(r.partial=!0,r.time.push({startPTS:e,endPTS:t}))}else if(a<=e)break}return r}getPartialFragment(e){let t,n,i,r=null,s=0;const{bufferPadding:a,fragments:o}=this;return Object.keys(o).forEach((u=>{const l=o[u];l&&Kt(l)&&(n=l.body.start-a,i=l.body.end+a,e>=n&&e<=i&&(t=Math.min(e-n,i-e),s<=t&&(r=l.body,s=t)))})),r}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||Kt(t))}getState(e){const t=Wt(e),n=this.fragments[t];return n?n.buffered?Kt(n)?Vt.PARTIAL:Vt.OK:Vt.APPENDING:Vt.NOT_LOADED}isTimeBuffered(e,t,n){let i,r;for(let s=0;s<n.length;s++){if(i=n.start(s)-this.bufferPadding,r=n.end(s)+this.bufferPadding,e>=i&&t<=r)return!0;if(t<=i)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if("initSegment"===t.frag.sn||t.frag.bitrateTest)return;const n=t.frag,i=t.part?null:t,r=Wt(n);this.fragments[r]={body:n,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:r,type:s}=t;if("initSegment"===n.sn)return;const a=n.type;if(i){let e=this.activePartLists[a];e||(this.activePartLists[a]=e=[]),e.push(i)}this.timeRanges=r;const o=r[s];this.detectEvictedFragments(s,o,a,i)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Wt(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,n=Object.keys(t);if(!e)return n.length>0;for(let i=n.length;i--;){const r=t[n[i]];if((null==r?void 0:r.body.type)===e)return!0}return!1}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,n,i,r){i&&!this.hasGaps||Object.keys(this.fragments).forEach((s=>{const a=this.fragments[s];if(!a)return;const o=a.body;o.type!==n||i&&!o.gap||o.start<t&&o.end>e&&(a.buffered||r)&&this.removeFragment(o)}))}removeFragment(e){const t=Wt(e);e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const t=e.sn;this.activePartLists[e.type]=qt(n,(e=>e.fragment.sn!==t))}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e,t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const n=null==(e=this.hls)||null==(t=e.latestLevelDetails)?void 0:t.partList;n&&n.forEach((e=>e.clearElementaryStreamInfo()))}}function Kt(e){var t,n,i;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(n=e.range.audio)?void 0:n.partial)||(null==(i=e.range.audiovideo)?void 0:i.partial))}function Wt(e){return`${e.type}_${e.level}_${e.sn}`}function qt(e,t){return e.filter((e=>{const n=t(e);return n||e.clearElementaryStreamInfo(),n}))}var Yt={cbc:0,ctr:1};class Xt{constructor(e,t,n){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=n}decrypt(e,t){switch(this.aesMode){case Yt.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case Yt.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function zt(e){const t=e.byteLength,n=t&&new DataView(e.buffer).getUint8(t-1);return n?e.slice(0,t-n):e}class Qt{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=t.getUint32(4*i);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],r=n[1],s=n[2],a=n[3],o=this.invSubMix,u=o[0],l=o[1],c=o[2],d=o[3],h=new Uint32Array(256);let f=0,p=0,g=0;for(g=0;g<256;g++)h[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){let n=p^p<<1^p<<2^p<<3^p<<4;n=n>>>8^255&n^99,e[f]=n,t[n]=f;const o=h[f],g=h[o],m=h[g];let v=257*h[n]^16843008*n;i[f]=v<<24|v>>>8,r[f]=v<<16|v>>>16,s[f]=v<<8|v>>>24,a[f]=v,v=16843009*m^65537*g^257*o^16843008*f,u[n]=v<<24|v>>>8,l[n]=v<<16|v>>>16,c[n]=v<<8|v>>>24,d[n]=v,f?(f=o^h[h[h[m^o]]],p^=h[h[p]]):f=p=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;while(i<t.length&&n)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);const s=this.ksRows=4*(r+6+1);let a,o;const u=this.keySchedule=new Uint32Array(s),l=this.invKeySchedule=new Uint32Array(s),c=this.sBox,d=this.rcon,h=this.invSubMix,f=h[0],p=h[1],g=h[2],m=h[3];let v,y;for(a=0;a<s;a++)a<r?v=u[a]=t[a]:(y=v,a%r===0?(y=y<<8|y>>>24,y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y],y^=d[a/r|0]<<24):r>6&&a%r===4&&(y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y]),u[a]=v=(u[a-r]^y)>>>0);for(o=0;o<s;o++)a=s-o,y=3&o?u[a]:u[a-4],l[o]=o<4||a<=4?y:f[c[y>>>24]]^p[c[y>>>16&255]]^g[c[y>>>8&255]]^m[c[255&y]],l[o]=l[o]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,r=this.invKeySchedule,s=this.invSBox,a=this.invSubMix,o=a[0],u=a[1],l=a[2],c=a[3],d=this.uint8ArrayToUint32Array_(n);let h=d[0],f=d[1],p=d[2],g=d[3];const m=new Int32Array(e),v=new Int32Array(m.length);let y,b,T,S,E,w,A,x,I,k,L,R,C,D;const M=this.networkToHostOrderSwap;while(t<m.length){for(I=M(m[t]),k=M(m[t+1]),L=M(m[t+2]),R=M(m[t+3]),E=I^r[0],w=R^r[1],A=L^r[2],x=k^r[3],C=4,D=1;D<i;D++)y=o[E>>>24]^u[w>>16&255]^l[A>>8&255]^c[255&x]^r[C],b=o[w>>>24]^u[A>>16&255]^l[x>>8&255]^c[255&E]^r[C+1],T=o[A>>>24]^u[x>>16&255]^l[E>>8&255]^c[255&w]^r[C+2],S=o[x>>>24]^u[E>>16&255]^l[w>>8&255]^c[255&A]^r[C+3],E=y,w=b,A=T,x=S,C+=4;y=s[E>>>24]<<24^s[w>>16&255]<<16^s[A>>8&255]<<8^s[255&x]^r[C],b=s[w>>>24]<<24^s[A>>16&255]<<16^s[x>>8&255]<<8^s[255&E]^r[C+1],T=s[A>>>24]<<24^s[x>>16&255]<<16^s[E>>8&255]<<8^s[255&w]^r[C+2],S=s[x>>>24]<<24^s[E>>16&255]<<16^s[w>>8&255]<<8^s[255&A]^r[C+3],v[t]=M(y^h),v[t+1]=M(S^f),v[t+2]=M(T^p),v[t+3]=M(b^g),h=I,f=k,p=L,g=R,t+=4}return v.buffer}}class Jt{constructor(e,t,n){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=n}expandKey(){const e=Zt(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function Zt(e){switch(e){case Yt.cbc:return"AES-CBC";case Yt.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${e}`)}}const en=16;class tn{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(n){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?zt(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n,i){return this.useSoftware?new Promise(((r,s)=>{const a=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(a,t,n,i);const o=this.flush();o?r(o.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(e),t,n,i)}softwareDecrypt(e,t,n,i){const{currentIV:r,currentResult:s,remainderData:a}=this;if(i!==Yt.cbc||16!==t.byteLength)return k.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),a&&(e=ve(a,e),this.remainderData=null);const o=this.getValidChunk(e);if(!o.length)return null;r&&(n=r);let u=this.softwareDecrypter;u||(u=this.softwareDecrypter=new Qt),u.expandKey(t);const l=s;return this.currentResult=u.decrypt(o.buffer,0,n),this.currentIV=o.slice(-16).buffer,l||null}webCryptoDecrypt(e,t,n,i){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n,i));this.key=t,this.fastAesKey=new Jt(this.subtle,t,i)}return this.fastAesKey.expandKey().then((t=>{if(!this.subtle)return Promise.reject(new Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");const r=new Xt(this.subtle,new Uint8Array(n),i);return r.decrypt(e.buffer,t)})).catch((r=>(k.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,n,i))))}onWebCryptoError(e,t,n,i){const r=this.enableSoftwareAES;if(r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n,i);const r=this.flush();if(r)return r.buffer}throw new Error("WebCrypto"+(r?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%en;return n!==e.length&&(t=e.slice(0,n),this.remainderData=e.slice(n)),t}logOnce(e){this.logEnabled&&(k.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const nn=Math.pow(2,17);class rn{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new un({type:a.NETWORK_ERROR,details:o.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(n?"part list":"url")),networkDetails:null}));this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise(((u,l)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some((e=>"GAP"===e[0])))return void l(an(e));e.gap=!1}const c=this.loader=r?new r(i):new s(i),d=sn(e);e.loader=c;const h=Nt(i.fragLoadPolicy.default),f={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:nn};e.stats=c.stats;const p={onSuccess:(t,n,i,r)=>{this.resetLoader(e,c);let s=t.data;i.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(s.slice(0,16)),s=s.slice(16)),u({frag:e,part:null,payload:s,networkDetails:r})},onError:(t,i,r,s)=>{this.resetLoader(e,c),l(new un({type:a.NETWORK_ERROR,details:o.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:m({url:n,data:void 0},t),error:new Error(`HTTP Error ${t.code} ${t.text}`),networkDetails:r,stats:s}))},onAbort:(t,n,i)=>{this.resetLoader(e,c),l(new un({type:a.NETWORK_ERROR,details:o.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:i,stats:t}))},onTimeout:(t,n,i)=>{this.resetLoader(e,c),l(new un({type:a.NETWORK_ERROR,details:o.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:i,stats:t}))}};t&&(p.onProgress=(n,i,r,s)=>t({frag:e,part:null,payload:r,networkDetails:s})),c.load(d,f,p)}))}loadPart(e,t,n){this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise(((u,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void l(an(e,t));const c=this.loader=r?new r(i):new s(i),d=sn(e,t);e.loader=c;const h=Nt(i.fragLoadPolicy.default),f={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:nn};t.stats=c.stats,c.load(d,f,{onSuccess:(i,r,s,a)=>{this.resetLoader(e,c),this.updateStatsFromPart(e,t);const o={frag:e,part:t,payload:i.data,networkDetails:a};n(o),u(o)},onError:(n,i,r,s)=>{this.resetLoader(e,c),l(new un({type:a.NETWORK_ERROR,details:o.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:m({url:d.url,data:void 0},n),error:new Error(`HTTP Error ${n.code} ${n.text}`),networkDetails:r,stats:s}))},onAbort:(n,i,r)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,c),l(new un({type:a.NETWORK_ERROR,details:o.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:r,stats:n}))},onTimeout:(n,i,r)=>{this.resetLoader(e,c),l(new un({type:a.NETWORK_ERROR,details:o.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:r,stats:n}))}})}))}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,r=i.total;if(n.loaded+=i.loaded,r){const i=Math.round(e.duration/t.duration),s=Math.min(Math.round(n.loaded/r),i),a=i-s,o=a*Math.round(n.loaded/s);n.total=n.loaded+o}else n.total=Math.max(n.loaded,n.total);const s=n.loading,a=i.loading;s.start?s.first+=a.first-a.start:(s.start=a.start,s.first=a.first),s.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function sn(e,t=null){const n=t||e,r={frag:e,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},s=n.byteRangeStartOffset,a=n.byteRangeEndOffset;if(i(s)&&i(a)){var o;let t=s,n=a;if("initSegment"===e.sn&&on(null==(o=e.decryptdata)?void 0:o.method)){const e=a-s;e%16&&(n=a+(16-e%16)),0!==s&&(r.resetIV=!0,t=s-16)}r.rangeStart=t,r.rangeEnd=n}return r}function an(e,t){const n=new Error(`GAP ${e.gap?"tag":"attribute"} found`),i={type:a.MEDIA_ERROR,details:o.FRAG_GAP,fatal:!1,frag:e,error:n,networkDetails:null};return t&&(i.part=t),(t||e).stats.aborted=!0,new un(i)}function on(e){return"AES-128"===e||"AES-256"===e}class un extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class ln extends b{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class cn{constructor(e,t,n,i=0,r=-1,s=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=dn(),this.buffering={audio:dn(),video:dn(),audiovideo:dn()},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=r,this.partial=s}}function dn(){return{start:0,executeStart:0,executeEnd:0,end:0}}const hn={length:0,start:()=>0,end:()=>0};class fn{static isBuffered(e,t){if(e){const n=fn.getBuffered(e);for(let e=n.length;e--;)if(t>=n.start(e)&&t<=n.end(e))return!0}return!1}static bufferedRanges(e){if(e){const t=fn.getBuffered(e);return fn.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}static bufferInfo(e,t,n){if(e){const i=fn.bufferedRanges(e);if(i.length)return fn.bufferedInfo(i,t,n)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.length>1&&e.sort(((e,t)=>e.start-t.start||t.end-e.end));let i=-1,r=[];if(n)for(let l=0;l<e.length;l++){t>=e[l].start&&t<=e[l].end&&(i=l);const s=r.length;if(s){const t=r[s-1].end;e[l].start-t<n?e[l].end>t&&(r[s-1].end=e[l].end):r.push(e[l])}else r.push(e[l])}else r=e;let s,a=0,o=t,u=t;for(let l=0;l<r.length;l++){const e=r[l].start,c=r[l].end;if(-1===i&&t>=e&&t<=c&&(i=l),t+n>=e&&t<c)o=e,u=c,a=u-t;else if(t+n<e){s=e;break}}return{len:a,start:o||0,end:u||0,nextStart:s,buffered:e,bufferedIndex:i}}static getBuffered(e){try{return e.buffered||hn}catch(t){return k.log("failed to get media.buffered",t),hn}}}const pn=/\{\$([a-zA-Z0-9-_]+)\}/g;function gn(e){return pn.test(e)}function mn(e,t){if(null!==e.variableList||e.hasVariableRefs){const n=e.variableList;return t.replace(pn,(t=>{const i=t.substring(2,t.length-1),r=null==n?void 0:n[i];return void 0===r?(e.playlistParsingError||(e.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),t):r}))}return t}function vn(e,t,n){let i,r,s=e.variableList;if(s||(e.variableList=s={}),"QUERYPARAM"in t){i=t.QUERYPARAM;try{const e=new self.URL(n).searchParams;if(!e.has(i))throw new Error(`"${i}" does not match any query parameter in URI: "${n}"`);r=e.get(i)}catch(a){e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else i=t.NAME,r=t.VALUE;i in s?e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):s[i]=r||""}function yn(e,t,n){const i=t.IMPORT;if(n&&i in n){let t=e.variableList;t||(e.variableList=t={}),t[i]=n[i]}else e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}const bn=/^(\d+)x(\d+)$/,Tn=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Sn{constructor(e,t){"string"===typeof e&&(e=Sn.parseAttrList(e,t)),p(this,e)}get clientAttrs(){return Object.keys(this).filter((e=>"X-"===e.substring(0,2)))}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const n=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)n[e]=parseInt(t.slice(2*e,2*e+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const n=this[e];return(n?n.split(/[ ,]+/):[]).reduce(((e,t)=>(e[t.toLowerCase()]=!0,e)),t)}bool(e){return"YES"===this[e]}decimalResolution(e){const t=bn.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let n;const i={},r='"';Tn.lastIndex=0;while(null!==(n=Tn.exec(e))){const s=n[1].trim();let a=n[2];const o=0===a.indexOf(r)&&a.lastIndexOf(r)===a.length-1;let u=!1;if(o)a=a.slice(1,-1);else switch(s){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":u=!0}if(t&&(o||u))a=mn(t,a);else if(!u&&!o)switch(s){case"CLOSED-CAPTIONS":if("NONE"===a)break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":k.warn(`${e}: attribute ${s} is missing quotes`)}i[s]=a}return i}}const En="com.apple.hls.interstitial";function wn(e){return"ID"!==e&&"CLASS"!==e&&"CUE"!==e&&"START-DATE"!==e&&"DURATION"!==e&&"END-DATE"!==e&&"END-ON-NEXT"!==e}function An(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e||"SCTE35-CMD"===e}class xn{constructor(e,t,n=0){var r;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(null==t?void 0:t.tagAnchor)||null,this.tagOrder=null!=(r=null==t?void 0:t.tagOrder)?r:n,t){const n=t.attr;for(const t in n)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==n[t]){k.warn(`DATERANGE tag attribute: "${t}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=t;break}e=p(new Sn({}),n,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const e=(null==t?void 0:t.endDate)||new Date(this.attr["END-DATE"]);i(e.getTime())&&(this._endDate=e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return void 0===e?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return null===e||null===e.programDateTime?(k.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return null!==t?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*t):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(i(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===En}get isValid(){return!!this.id&&!this._badValueForSameId&&i(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const In=10;class kn{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1}get hasProgramDateTime(){return!!this.fragments.length&&i(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||In}get drift(){const e=this.driftEndTime-this.driftStartTime;if(e>0){const t=this.driftEnd-this.driftStart;return 1e3*t/e}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(-1!==t){for(let n=e.length;n--;)if(e[n].index>t)return e[n].index;return t}}return 0}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Ln(e){return"AES-128"===e||"AES-256"===e||"AES-256-CTR"===e}function Rn(e){switch(e){case"AES-128":case"AES-256":return Yt.cbc;case"AES-256-CTR":return Yt.ctr;default:throw new Error(`invalid full segment method ${e}`)}}function Cn(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))}function Dn(e){return Uint8Array.from(unescape(encodeURIComponent(e)),(e=>e.charCodeAt(0)))}function Mn(e){const t=Dn(e).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}function Pn(e){const t=function(e,t,n){const i=e[t];e[t]=e[n],e[n]=i};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}function _n(e){const t=e.split(":");let n=null;if("data"===t[0]&&2===t.length){const e=t[1].split(";"),i=e[e.length-1].split(",");if(2===i.length){const t="base64"===i[0],r=i[1];t?(e.splice(-1,1),n=Cn(r)):n=Mn(r)}}return n}const On="undefined"!==typeof self?self:void 0;var Nn={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Un={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Fn(e){switch(e){case Un.FAIRPLAY:return Nn.FAIRPLAY;case Un.PLAYREADY:return Nn.PLAYREADY;case Un.WIDEVINE:return Nn.WIDEVINE;case Un.CLEARKEY:return Nn.CLEARKEY}}var Bn={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function jn(e){return e===Bn.WIDEVINE?Nn.WIDEVINE:e===Bn.PLAYREADY?Nn.PLAYREADY:e===Bn.CENC||e===Bn.CLEARKEY?Nn.CLEARKEY:void 0}function $n(e){switch(e){case Nn.FAIRPLAY:return Un.FAIRPLAY;case Nn.PLAYREADY:return Un.PLAYREADY;case Nn.WIDEVINE:return Un.WIDEVINE;case Nn.CLEARKEY:return Un.CLEARKEY}}function Gn(e){const{drmSystems:t,widevineLicenseUrl:n}=e,i=t?[Nn.FAIRPLAY,Nn.WIDEVINE,Nn.PLAYREADY,Nn.CLEARKEY].filter((e=>!!t[e])):[];return!i[Nn.WIDEVINE]&&n&&i.push(Nn.WIDEVINE),i}const Vn=function(e){return null!=On&&null!=(e=On.navigator)&&e.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function Hn(e,t,n,i){let r;switch(e){case Nn.FAIRPLAY:r=["cenc","sinf"];break;case Nn.WIDEVINE:case Nn.PLAYREADY:r=["cenc"];break;case Nn.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${e}`)}return Kn(r,t,n,i)}function Kn(e,t,n,i){const r={initDataTypes:e,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map((e=>({contentType:`audio/mp4; codecs=${e}`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null}))),videoCapabilities:n.map((e=>({contentType:`video/mp4; codecs=${e}`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null})))};return[r]}function Wn(e){var t;return"persistent-license"===e.sessionType||!(null==(t=e.sessionTypes)||!t.some((e=>"persistent-license"===e)))}function qn(e){const t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),n=String.fromCharCode.apply(null,Array.from(t)),i=n.substring(n.indexOf("<"),n.length),r=new DOMParser,s=r.parseFromString(i,"text/xml"),a=s.getElementsByTagName("KID")[0];if(a){const e=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(e){const t=Cn(e).subarray(0,16);return Pn(t),t}}return null}let Yn={};class Xn{static clearKeyUriToKeyIdMap(){Yn={}}constructor(e,t,n,i=[1],r=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=r,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&!Ln(e)}isSupported(){if(this.method){if(Ln(this.method)||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case Un.FAIRPLAY:case Un.WIDEVINE:case Un.PLAYREADY:case Un.CLEARKEY:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(Ln(this.method)&&this.uri&&!this.iv){"number"!==typeof e&&(k.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const t=zn(e),n=new Xn(this.method,this.uri,"identity",this.keyFormatVersions,t);return n}const t=_n(this.uri);if(t)switch(this.keyFormat){case Un.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Un.PLAYREADY:{const e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=xe(e,null,t),this.keyId=qn(t);break}default:{let e=t.subarray(0,16);if(16!==e.length){const t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e;break}}if(!this.keyId||16!==this.keyId.byteLength){let e=Yn[this.uri];if(!e){const t=Object.keys(Yn).length%Number.MAX_SAFE_INTEGER;e=new Uint8Array(16);const n=new DataView(e.buffer,12,4);n.setUint32(0,t),Yn[this.uri]=e}this.keyId=e}return this}}function zn(e){const t=new Uint8Array(16);for(let n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}const Qn=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Jn=/#EXT-X-MEDIA:(.*)/g,Zn=/^#EXT(?:INF|-X-TARGETDURATION):/m,ei=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),ti=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class ni{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static resolve(e,t){return U.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return Zn.test(e)}static parseMasterPlaylist(e,t){const n=gn(e),i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},r=[];let s;Qn.lastIndex=0;while(null!=(s=Qn.exec(e)))if(s[1]){var a;const e=new Sn(s[1],i),n=mn(i,s[2]),o={attrs:e,bitrate:e.decimalInteger("BANDWIDTH")||e.decimalInteger("AVERAGE-BANDWIDTH"),name:e.NAME,url:ni.resolve(n,t)},u=e.decimalResolution("RESOLUTION");u&&(o.width=u.width,o.height=u.height),oi(e.CODECS,o);const l=e["SUPPLEMENTAL-CODECS"];l&&(o.supplemental={},oi(l,o.supplemental)),null!=(a=o.unknownCodecs)&&a.length||r.push(o),i.levels.push(o)}else if(s[3]){const e=s[3],n=s[4];switch(e){case"SESSION-DATA":{const e=new Sn(n,i),t=e["DATA-ID"];t&&(null===i.sessionData&&(i.sessionData={}),i.sessionData[t]=e);break}case"SESSION-KEY":{const e=si(n,t,i);e.encrypted&&e.isSupported()?(null===i.sessionKeys&&(i.sessionKeys=[]),i.sessionKeys.push(e)):k.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${n}"`);break}case"DEFINE":{const e=new Sn(n,i);vn(i,e,t)}break;case"CONTENT-STEERING":{const e=new Sn(n,i);i.contentSteering={uri:ni.resolve(e["SERVER-URI"],t),pathwayId:e["PATHWAY-ID"]||"."};break}case"START":i.startTimeOffset=ai(n);break}}const o=r.length>0&&r.length<i.levels.length;return i.levels=o?r:i.levels,0===i.levels.length&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,t,n){let i;const r={},s=n.levels,a={AUDIO:s.map((e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec}))),SUBTITLES:s.map((e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec}))),"CLOSED-CAPTIONS":[]};let o=0;Jn.lastIndex=0;while(null!==(i=Jn.exec(e))){const e=new Sn(i[1],n),s=e.TYPE;if(s){const n=a[s],i=r[s]||[];r[s]=i;const u=e.LANGUAGE,l=e["ASSOC-LANGUAGE"],c=e.CHANNELS,d=e.CHARACTERISTICS,h=e["INSTREAM-ID"],f={attrs:e,bitrate:0,id:o++,groupId:e["GROUP-ID"]||"",name:e.NAME||u||"",type:s,default:e.bool("DEFAULT"),autoselect:e.bool("AUTOSELECT"),forced:e.bool("FORCED"),lang:u,url:e.URI?ni.resolve(e.URI,t):""};if(l&&(f.assocLang=l),c&&(f.channels=c),d&&(f.characteristics=d),h&&(f.instreamId=h),null!=n&&n.length){const e=ni.findGroup(n,f.groupId)||n[0];ui(f,e,"audioCodec"),ui(f,e,"textCodec")}i.push(f)}}return r}static parseLevelPlaylist(e,t,n,r,s,a){var o;const u={url:t},l=new kn(t),c=l.fragments,d=[];let h,f,g,m,v=null,y=0,b=0,T=0,S=0,E=0,w=null,A=new G(r,u),x=-1,I=!1,L=null;if(ei.lastIndex=0,l.m3u8=e,l.hasVariableRefs=gn(e),"#EXTM3U"!==(null==(o=ei.exec(e))?void 0:o[0]))return l.playlistParsingError=new Error("Missing format identifier #EXTM3U"),l;while(null!==(h=ei.exec(e))){I&&(I=!1,A=new G(r,u),A.playlistOffset=T,A.start=T,A.sn=y,A.cc=S,E&&(A.bitrate=E),A.level=n,v&&(A.initSegment=v,v.rawProgramDateTime&&(A.rawProgramDateTime=v.rawProgramDateTime,v.rawProgramDateTime=null),L&&(A.setByteRange(L),L=null)));const e=h[1];if(e){A.duration=parseFloat(e);const t=(" "+h[2]).slice(1);A.title=t||null,A.tagList.push(t?["INF",e,t]:["INF",e])}else if(h[3]){if(i(A.duration)){A.playlistOffset=T,A.start=T,g&&hi(A,g,l),A.sn=y,A.level=n,A.cc=S,c.push(A);const e=(" "+h[3]).slice(1);A.relurl=mn(l,e),ci(A,w,d),w=A,T+=A.duration,y++,b=0,I=!0}}else{if(h=h[0].match(ti),!h){k.warn("No matches on slow regex match for level playlist!");continue}for(f=1;f<h.length;f++)if(void 0!==h[f])break;const e=(" "+h[f]).slice(1),s=(" "+h[f+1]).slice(1),o=h[f+2]?(" "+h[f+2]).slice(1):null;switch(e){case"BYTERANGE":w?A.setByteRange(s,w):A.setByteRange(s);break;case"PROGRAM-DATE-TIME":A.rawProgramDateTime=s,A.tagList.push(["PROGRAM-DATE-TIME",s]),-1===x&&(x=c.length);break;case"PLAYLIST-TYPE":l.type&&fi(l,e,h),l.type=s.toUpperCase();break;case"MEDIA-SEQUENCE":0!==l.startSN?fi(l,e,h):c.length>0&&pi(l,e,h),y=l.startSN=parseInt(s);break;case"SKIP":{l.skippedSegments&&fi(l,e,h);const t=new Sn(s,l),n=t.decimalInteger("SKIPPED-SEGMENTS");if(i(n)){l.skippedSegments+=n;for(let e=n;e--;)c.push(null);y+=n}const r=t.enumeratedString("RECENTLY-REMOVED-DATERANGES");r&&(l.recentlyRemovedDateranges=(l.recentlyRemovedDateranges||[]).concat(r.split("\t")));break}case"TARGETDURATION":0!==l.targetduration&&fi(l,e,h),l.targetduration=Math.max(parseInt(s),1);break;case"VERSION":null!==l.version&&fi(l,e,h),l.version=parseInt(s);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":l.live||fi(l,e,h),l.live=!1;break;case"#":(s||o)&&A.tagList.push(o?[s,o]:[s]);break;case"DISCONTINUITY":S++,A.tagList.push(["DIS"]);break;case"GAP":A.gap=!0,A.tagList.push([e]);break;case"BITRATE":A.tagList.push([e,s]),E=1e3*parseInt(s),i(E)?A.bitrate=E:E=0;break;case"DATERANGE":{const e=new Sn(s,l),t=new xn(e,l.dateRanges[e.ID],l.dateRangeTagCount);l.dateRangeTagCount++,t.isValid||l.skippedSegments?l.dateRanges[t.id]=t:k.warn(`Ignoring invalid DATERANGE tag: "${s}"`),A.tagList.push(["EXT-X-DATERANGE",s]);break}case"DEFINE":{const e=new Sn(s,l);"IMPORT"in e?yn(l,e,a):vn(l,e,t)}break;case"DISCONTINUITY-SEQUENCE":0!==l.startCC?fi(l,e,h):c.length>0&&pi(l,e,h),l.startCC=S=parseInt(s);break;case"KEY":{const e=si(s,t,l);if(e.isSupported()){if("NONE"===e.method){g=void 0;break}g||(g={}),g[e.keyFormat]&&(g=p({},g)),g[e.keyFormat]=e}else k.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${s}"`);break}case"START":l.startTimeOffset=ai(s);break;case"MAP":{const e=new Sn(s,l);if(A.duration){const t=new G(r,u);di(t,e,n,g),v=t,A.initSegment=v,v.rawProgramDateTime&&!A.rawProgramDateTime&&(A.rawProgramDateTime=v.rawProgramDateTime)}else{const t=A.byteRangeEndOffset;if(t){const e=A.byteRangeStartOffset;L=`${t-e}@${e}`}else L=null;di(A,e,n,g),v=A,I=!0}v.cc=S;break}case"SERVER-CONTROL":m&&fi(l,e,h),m=new Sn(s),l.canBlockReload=m.bool("CAN-BLOCK-RELOAD"),l.canSkipUntil=m.optionalFloat("CAN-SKIP-UNTIL",0),l.canSkipDateRanges=l.canSkipUntil>0&&m.bool("CAN-SKIP-DATERANGES"),l.partHoldBack=m.optionalFloat("PART-HOLD-BACK",0),l.holdBack=m.optionalFloat("HOLD-BACK",0);break;case"PART-INF":{l.partTarget&&fi(l,e,h);const t=new Sn(s);l.partTarget=t.decimalFloatingPoint("PART-TARGET");break}case"PART":{let e=l.partList;e||(e=l.partList=[]);const t=b>0?e[e.length-1]:void 0,n=b++,i=new Sn(s,l),r=new V(i,A,u,n,t);e.push(r),A.duration+=r.duration;break}case"PRELOAD-HINT":{const e=new Sn(s,l);l.preloadHint=e;break}case"RENDITION-REPORT":{const e=new Sn(s,l);l.renditionReports=l.renditionReports||[],l.renditionReports.push(e);break}default:k.warn(`line parsed but not handled: ${h}`);break}}}w&&!w.relurl?(c.pop(),T-=w.duration,l.partList&&(l.fragmentHint=w)):l.partList&&(ci(A,w,d),A.cc=S,l.fragmentHint=A,g&&hi(A,g,l)),l.targetduration||(l.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const R=c.length,C=c[0],D=c[R-1];if(T+=l.skippedSegments*l.targetduration,T>0&&R&&D){l.averagetargetduration=T/R;const e=D.sn;l.endSN="initSegment"!==e?e:0,l.live||(D.endList=!0),C&&void 0===l.startCC&&(l.startCC=C.cc),x>0&&(li(c,x),C&&d.unshift(C))}else l.endSN=0,l.startCC=0;return l.fragmentHint&&(T+=l.fragmentHint.duration),l.totalduration=T,d.length&&l.dateRangeTagCount&&C&&ii(d,l),l.endCC=S,l}}function ii(e,t){const n=e.length,i=e[n-1],r=t.live?1/0:t.totalduration,s=Object.keys(t.dateRanges);for(let a=s.length;a--;){const o=t.dateRanges[s[a]],u=o.startDate.getTime();o.tagAnchor=i.ref;for(let i=n;i--;){const n=ri(t,u,e,i,r);if(-1!==n){o.tagAnchor=t.fragments[n].ref;break}}}}function ri(e,t,n,i,r){const s=n[i];if(s){const o=s.programDateTime;if(t>=o||0===i){var a;const u=((null==(a=n[i+1])?void 0:a.start)||r)-s.start;if(t<=o+1e3*u){const r=n[i].sn-e.startSN,s=e.fragments;if(s.length>n.length){const a=n[i+1]||s[s.length-1],o=a.sn-e.startSN;for(let e=o;e>r;e--){const n=s[e].programDateTime;if(t>=n&&t<n+1e3*s[e].duration)return e}}return r}}}return-1}function si(e,t,n){var i,r;const s=new Sn(e,n),a=null!=(i=s.METHOD)?i:"",o=s.URI,u=s.hexadecimalInteger("IV"),l=s.KEYFORMATVERSIONS,c=null!=(r=s.KEYFORMAT)?r:"identity";o&&s.IV&&!u&&k.error(`Invalid IV: ${s.IV}`);const d=o?ni.resolve(o,t):"",h=(l||"1").split("/").map(Number).filter(Number.isFinite);return new Xn(a,d,c,h,u)}function ai(e){const t=new Sn(e),n=t.decimalFloatingPoint("TIME-OFFSET");return i(n)?n:null}function oi(e,t){let n=(e||"").split(/[ ,]+/).filter((e=>e));["video","audio","text"].forEach((e=>{const i=n.filter((t=>Ce(t,e)));i.length&&(t[`${e}Codec`]=i.map((e=>e.split("/")[0])).join(","),n=n.filter((e=>-1===i.indexOf(e))))})),t.unknownCodecs=n}function ui(e,t,n){const i=t[n];i&&(e[n]=i)}function li(e,t){let n=e[t];for(let i=t;i--;){const t=e[i];if(!t)return;t.programDateTime=n.programDateTime-1e3*t.duration,n=t}}function ci(e,t,n){e.rawProgramDateTime?n.push(e):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime)}function di(e,t,n,i){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=n,e.sn="initSegment",i&&(e.levelkeys=i),e.initSegment=null}function hi(e,t,n){e.levelkeys=t;const{encryptedFragments:i}=n;i.length&&i[i.length-1].levelkeys===t||!Object.keys(t).some((e=>t[e].isCommonEncryption))||i.push(e)}function fi(e,t,n){e.playlistParsingError=new Error(`#EXT-X-${t} must not appear more than once (${n[0]})`)}function pi(e,t,n){e.playlistParsingError=new Error(`#EXT-X-${t} must appear before the first Media Segment (${n[0]})`)}function gi(e,t){const n=t.startPTS;if(i(n)){let i,r=0;t.sn>e.sn?(r=n-e.start,i=e):(r=e.start-n,i=t),i.duration!==r&&i.setDuration(r)}else if(t.sn>e.sn){const n=e.cc===t.cc;n&&e.minEndPTS?t.setStart(e.start+(e.minEndPTS-e.start)):t.setStart(e.start+e.duration)}else t.setStart(Math.max(e.start-t.duration,0))}function mi(e,t,n,r,s,a){const o=r-n;o<=0&&(k.warn("Fragment should have a positive duration",t),r=n+t.duration,a=s+t.duration);let u=n,l=r;const c=t.startPTS,d=t.endPTS;if(i(c)){const e=Math.abs(c-n);i(t.deltaPTS)?t.deltaPTS=Math.max(e,t.deltaPTS):t.deltaPTS=e,u=Math.max(n,c),n=Math.min(n,c),s=Math.min(s,t.startDTS),l=Math.min(r,d),r=Math.max(r,d),a=Math.max(a,t.endDTS)}const h=n-t.start;0!==t.start&&t.setStart(n),t.setDuration(r-t.start),t.startPTS=n,t.maxStartPTS=u,t.startDTS=s,t.endPTS=r,t.minEndPTS=l,t.endDTS=a;const f=t.sn;if(!e||f<e.startSN||f>e.endSN)return 0;let p;const g=f-e.startSN,m=e.fragments;for(m[g]=t,p=g;p>0;p--)gi(m[p],m[p-1]);for(p=g;p<m.length-1;p++)gi(m[p],m[p+1]);return e.fragmentHint&&gi(m[m.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,h}function vi(e,t){if(e===t)return;let n=null;const r=e.fragments;for(let i=r.length-1;i>=0;i--){const e=r[i].initSegment;if(e){n=e;break}}let s;e.fragmentHint&&delete e.fragmentHint.endPTS,Ti(e,t,((r,a,o,u)=>{if(!t.startCC&&a.cc!==r.cc){var l,c;const n=r.cc-a.cc;for(let e=o;e<u.length;e++)u[e].cc+=n;t.startCC=null!=(l=null==(c=xi(e,t.startSN-1))?void 0:c.cc)?l:u[0].cc,t.endCC=u[u.length-1].cc}i(r.startPTS)&&i(r.endPTS)&&(a.setStart(a.startPTS=r.startPTS),a.startDTS=r.startDTS,a.maxStartPTS=r.maxStartPTS,a.endPTS=r.endPTS,a.endDTS=r.endDTS,a.minEndPTS=r.minEndPTS,a.setDuration(r.endPTS-r.startPTS),a.duration&&(s=a),t.PTSKnown=t.alignedSliding=!0),r.hasStreams&&(a.elementaryStreams=r.elementaryStreams),a.loader=r.loader,r.hasStats&&(a.stats=r.stats),r.initSegment&&(a.initSegment=r.initSegment,n=r.initSegment)}));const a=t.fragments,o=t.fragmentHint?a.concat(t.fragmentHint):a;if(n&&o.forEach((e=>{var t;!e||e.initSegment&&e.initSegment.relurl!==(null==(t=n)?void 0:t.relurl)||(e.initSegment=n)})),t.skippedSegments)if(t.deltaUpdateFailed=a.some((e=>!e)),t.deltaUpdateFailed){k.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let e=t.skippedSegments;e--;)a.shift();t.startSN=a[0].sn}else{t.endCC=a[a.length-1].cc,t.canSkipDateRanges&&(t.dateRanges=yi(e.dateRanges,t));const n=e.fragments.filter((e=>e.rawProgramDateTime));if(e.hasProgramDateTime&&!t.hasProgramDateTime)for(let e=1;e<o.length;e++)null===o[e].programDateTime&&ci(o[e],o[e-1],n);ii(n,t)}bi(e.partList,t.partList,((e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats})),s?mi(t,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):Ei(e,t),a.length&&(t.totalduration=t.edge-a[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;const u=t.advancedDateTime;if(t.advanced&&u){const e=t.edge;t.driftStart||(t.driftStartTime=u,t.driftStart=e),t.driftEndTime=u,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime;-1===t.requestScheduled&&(t.requestScheduled=e.requestScheduled)}function yi(e,t){const{dateRanges:n,recentlyRemovedDateranges:i}=t,r=p({},e);i&&i.forEach((e=>{delete r[e]}));const s=Object.keys(r),a=s.length;return a&&Object.keys(n).forEach((e=>{const t=r[e],i=new xn(n[e].attr,t);i.isValid?(r[e]=i,t||(i.tagOrder+=a)):k.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${ct(n[e].attr)}"`)})),r}function bi(e,t,n){if(e&&t){let i=0;for(let r=0,s=e.length;r<=s;r++){const s=e[r],a=t[r+i];s&&a&&s.index===a.index&&s.fragment.sn===a.fragment.sn?n(s,a):i--}}}function Ti(e,t,n){const i=t.skippedSegments,r=Math.max(e.startSN,t.startSN)-t.startSN,s=(e.fragmentHint?1:0)+(i?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,a=t.startSN-e.startSN,o=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,u=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let l=r;l<=s;l++){const r=u[a+l];let s=o[l];if(i&&!s&&r&&(s=t.fragments[l]=r),r&&s){if(n(r,s,l,o),r.url&&r.url!==s.url)return void(t.playlistParsingError=Si(`media sequence mismatch ${s.sn}:`,e,t,r,s));if(r.cc!==s.cc)return void(t.playlistParsingError=Si(`discontinuity sequence mismatch (${r.cc}!=${s.cc})`,e,t,r,s))}}}function Si(e,t,n,i,r){return new Error(`${e} ${r.url}\nPlaylist starting @${t.startSN}\n${t.m3u8}\n\nPlaylist starting @${n.startSN}\n${n.m3u8}`)}function Ei(e,t,n=!0){const i=t.startSN+t.skippedSegments-e.startSN,r=e.fragments,s=i>=0;let a=0;if(s&&i<r.length)a=r[i].start;else if(s&&t.startSN===e.endSN+1)a=e.fragmentEnd;else if(s&&n)a=e.fragmentStart+i*t.levelTargetDuration;else{if(t.skippedSegments||0!==t.fragmentStart)return;a=e.fragmentStart}wi(t,a)}function wi(e,t){if(t){const n=e.fragments;for(let i=e.skippedSegments;i<n.length;i++)n[i].addStart(t);e.fragmentHint&&e.fragmentHint.addStart(t)}}function Ai(e,t=1/0){let n=1e3*e.targetduration;if(e.updated){const i=e.fragments,r=4;if(i.length&&n*r>t){const e=1e3*i[i.length-1].duration;e<n&&(n=e)}}else n/=2;return Math.round(n)}function xi(e,t,n){if(!e)return null;let i=e.fragments[t-e.startSN];return i||(i=e.fragmentHint,i&&i.sn===t?i:t<e.startSN&&n&&n.sn===t?n:null)}function Ii(e,t,n){return e?ki(e.partList,t,n):null}function ki(e,t,n){if(e)for(let i=e.length;i--;){const r=e[i];if(r.index===n&&r.fragment.sn===t)return r}return null}function Li(e){e.forEach(((e,t)=>{var n;null==(n=e.details)||n.fragments.forEach((e=>{e.level=t,e.initSegment&&(e.initSegment.level=t)}))}))}function Ri(e,t){for(let i=0,r=e.length;i<r;i++){var n;if((null==(n=e[i])?void 0:n.cc)===t)return e[i]}return null}function Ci(e,t){return!!(e&&t.startCC<e.endCC&&t.endCC>e.startCC)}function Di(e,t){if(e){const n=e.start+t;e.start=e.startPTS=n,e.endPTS=n+e.duration}}function Mi(e,t){const n=t.fragments;for(let i=0,r=n.length;i<r;i++)Di(n[i],e);t.fragmentHint&&Di(t.fragmentHint,e),t.alignedSliding=!0}function Pi(e,t){e&&(_i(t,e),!t.alignedSliding&&e&&Oi(t,e),t.alignedSliding||!e||t.skippedSegments||Ei(e,t,!1))}function _i(e,t){if(!Ci(t,e))return;const n=Math.min(t.endCC,e.endCC),i=Ri(t.fragments,n),r=Ri(e.fragments,n);if(!i||!r)return;k.log(`Aligning playlist at start of dicontinuity sequence ${n}`);const s=i.start-r.start;Mi(s,e)}function Oi(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;const n=e.fragments,i=t.fragments;if(!n.length||!i.length)return;let r,s;const a=Math.min(t.endCC,e.endCC);t.startCC<a&&e.startCC<a&&(r=Ri(i,a),s=Ri(n,a)),r&&s||(r=i[Math.floor(i.length/2)],s=Ri(n,r.cc)||n[Math.floor(n.length/2)]);const o=r.programDateTime,u=s.programDateTime;if(!o||!u)return;const l=(u-o)/1e3-(s.start-r.start);Mi(l,e)}const Ni={toString:function(e){let t="";const n=e.length;for(let i=0;i<n;i++)t+=`[${e.start(i).toFixed(3)}-${e.end(i).toFixed(3)}]`;return t}},Ui={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Fi extends ln{constructor(e,t,n,r,s){super(r,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Ui.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:e,fragCurrent:t,media:n,mediaBuffer:r,state:s}=this,a=n?n.currentTime:0,o=fn.bufferInfo(r||n,a,e.maxBufferHole);if(this.log(`media seeking to ${i(a)?a.toFixed(3):a}, state: ${s}`),this.state===Ui.ENDED)this.resetLoadingState();else if(t){const n=e.maxFragLookUpTolerance,i=t.start-n,r=t.start+t.duration+n;if(!o.len||r<o.start||i>o.end){const e=a>r;(a<i||e)&&(e&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(n){this.fragmentTracker.removeFragmentsInRange(a,1/0,this.playlistType,!0);const e=this.lastCurrentTime;if(a>e&&(this.lastCurrentTime=a),!this.loadingParts){const e=Math.max(o.end,a),t=this.shouldLoadParts(this.getLevelDetails(),e);t&&(this.log(`LL-Part loading ON after seeking to ${a.toFixed(2)} with buffer @${e.toFixed(2)}`),this.loadingParts=t)}}this.hls.hasEnoughToStart||o.len||(this.log(`setting startPosition to ${a} because of seek before start`),this.nextLoadPosition=this.startPosition=a),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=s,this.hls=e,this.fragmentLoader=new rn(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new tn(e.config)}registerListeners(){const{hls:e}=this;e.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(u.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(u.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===Ui.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Ui.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return-1===t&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const n=e.end||0,i=this.config.timelineOffset||0;if(n<=i)return!1;const r=e.nextStart,s=r&&r>i&&r<t.edge;if(s)return!1;if(this.media.currentTime<e.start)return!1;const a=t.partList;if(null!=a&&a.length){const e=a[a.length-1],t=fn.isBuffered(this.media,e.start+e.duration/2);return t}const o=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(o)}getLevelDetails(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levelLastLoaded)?void 0:e.details}get timelineOffset(){const e=this.config.timelineOffset;var t;return e?(null==(t=this.getLevelDetails())?void 0:t.appliedTimelineOffset)||e:0}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;n.removeEventListener("seeking",this.onMediaSeeking),n.removeEventListener("ended",this.onMediaEnded),n.addEventListener("seeking",this.onMediaSeeking),n.addEventListener("ended",this.onMediaEnded);const i=this.config;this.levels&&i.autoStartLoad&&this.state===Ui.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(e,t){const n=!!t.transferMedia,i=this.media;if(null!==i){if(i.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),i.removeEventListener("seeking",this.onMediaSeeking),i.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!n&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,n)return this.resetLoadingState(),void this.resetTransmuxer();this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=Ui.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this.startFragRequested=!0,this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const i=e=>{const t=e.frag;if(this.fragContextChanged(t))return this.warn(`${t.type} sn: ${t.sn}${e.part?" part: "+e.part.index:""} of ${this.fragInfo(t,!1,e.part)}) was dropped during download.`),void this.fragmentTracker.removeFragment(t);t.stats.chunkCount++,this._handleFragmentLoadProgress(e)};this._doFragLoad(e,t,n,i).then((e=>{if(!e)return;const t=this.state,n=e.frag;this.fragContextChanged(n)?(t===Ui.FRAG_LOADING||!this.fragCurrent&&t===Ui.PARSING)&&(this.fragmentTracker.removeFragment(n),this.state=Ui.IDLE):("payload"in e&&(this.log(`Loaded ${n.type} sn: ${n.sn} of ${this.playlistLabel()} ${n.level}`),this.hls.trigger(u.FRAG_LOADED,e)),this._handleFragmentLoadComplete(e))})).catch((t=>{this.state!==Ui.STOPPED&&this.state!==Ui.ERROR&&(this.warn(`Frag error: ${(null==t?void 0:t.message)||t}`),this.resetFragmentLoading(e))}))}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this,i=n.getState(e);if(i===Vt.APPENDING){const t=e.type,i=this.getFwdBufferInfo(this.mediaBuffer,t),r=Math.max(e.duration,i?i.len:this.config.maxBufferLength),s=this.backtrackFragment,a=s?e.sn-s.sn:0;(1===a||this.reduceMaxBufferLength(r,e.duration))&&n.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Vt.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(null==t?void 0:t.live)&&"EVENT"!==t.type&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:n};this.hls.trigger(u.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then((e=>{const t=null==e?void 0:e.frag;if(!t||this.fragContextChanged(t)||!this.levels)throw new Error("init load aborted");return e})).then((e=>{const{hls:t}=this,{frag:n,payload:i}=e,r=n.decryptdata;if(i&&i.byteLength>0&&null!=r&&r.key&&r.iv&&Ln(r.method)){const s=self.performance.now();return this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer,Rn(r.method)).catch((e=>{throw t.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:n}),e})).then((i=>{const r=self.performance.now();return t.trigger(u.FRAG_DECRYPTED,{frag:n,payload:i,stats:{tstart:s,tdecrypt:r}}),e.payload=i,this.completeInitSegmentLoad(e)}))}return this.completeInitSegmentLoad(e)})).catch((t=>{this.state!==Ui.STOPPED&&this.state!==Ui.ERROR&&(this.warn(t),this.resetFragmentLoading(e))}))}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state!==Ui.STOPPED&&(this.state=Ui.IDLE),e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const n=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${n?Ni.toString(fn.getBuffered(n)):"(detached)"})`),$(e)){var i;if(e.type!==c.SUBTITLE){const t=e.elementaryStreams;if(!Object.keys(t).some((e=>!!t[e])))return void(this.state=Ui.IDLE)}const t=null==(i=this.levels)?void 0:i[e.level];null!=t&&t.fragmentError&&(this.log(`Resetting level fragment error count of ${t.fragmentError} on frag buffered`),t.fragmentError=0)}this.state=Ui.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:r}=e,s=!r||0===r.length||r.some((e=>!e)),a=new cn(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!s);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,r){var s;this.fragCurrent=e;const a=null==t?void 0:t.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;!e.encrypted||null!=(s=e.decryptdata)&&s.key?!e.encrypted&&a.encryptedFragments.length&&this.keyLoader.loadClear(e,a.encryptedFragments):(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=Ui.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then((e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger(u.KEY_LOADED,e),this.state===Ui.KEY_LOADING&&(this.state=Ui.IDLE),e})),this.hls.trigger(u.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING"))));const l=this.fragPrevious;if($(e)&&(!l||e.sn!==l.sn)){const n=this.shouldLoadParts(t.details,e.end);n!==this.loadingParts&&(this.log(`LL-Part loading ${n?"ON":"OFF"} loading sn ${null==l?void 0:l.sn}->${e.sn}`),this.loadingParts=n)}if(n=Math.max(e.start,n||0),this.loadingParts&&$(e)){const i=a.partList;if(i&&r){n>e.end&&a.fragmentHint&&(e=a.fragmentHint);const s=this.getNextPart(i,e,n);if(s>-1){const l=i[s];let c;return e=this.fragCurrent=l.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${l.index} (${s}/${i.length-1}) of ${this.fragInfo(e,!1,l)}) cc: ${e.cc} [${a.startSN}-${a.endSN}], target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=l.start+l.duration,this.state=Ui.FRAG_LOADING,c=o?o.then((n=>!n||this.fragContextChanged(n.frag)?null:this.doFragPartsLoad(e,l,t,r))).catch((e=>this.handleFragLoadError(e))):this.doFragPartsLoad(e,l,t,r).catch((e=>this.handleFragLoadError(e))),this.hls.trigger(u.FRAG_LOADING,{frag:e,part:l,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):c}if(!e.url||this.loadedEndOfParts(i,n))return Promise.resolve(null)}}if($(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${n.toFixed(2)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${a?"["+a.startSN+"-"+a.endSN+"]":""}, target: ${parseFloat(n.toFixed(3))}`),i(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Ui.FRAG_LOADING;const c=this.config.progressive;let d;return d=c&&o?o.then((t=>!t||this.fragContextChanged(null==t?void 0:t.frag)?null:this.fragmentLoader.load(e,r))).catch((e=>this.handleFragLoadError(e))):Promise.all([this.fragmentLoader.load(e,c?r:void 0),o]).then((([e])=>(!c&&e&&r&&r(e),e))).catch((e=>this.handleFragLoadError(e))),this.hls.trigger(u.FRAG_LOADING,{frag:e,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):d}doFragPartsLoad(e,t,n,i){return new Promise(((r,s)=>{var a;const o=[],l=null==(a=n.details)?void 0:a.partList,c=t=>{this.fragmentLoader.loadPart(e,t,i).then((i=>{o[t.index]=i;const s=i.part;this.hls.trigger(u.FRAG_LOADED,i);const a=Ii(n.details,e.sn,t.index+1)||ki(l,e.sn,t.index+1);if(!a)return r({frag:e,part:s,partsLoaded:o});c(a)})).catch(s)};c(t)}))}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===o.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(u.ERROR,t)}else this.hls.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==Ui.PARSING)return void(this.fragCurrent||this.state===Ui.STOPPED||this.state===Ui.ERROR||(this.state=Ui.IDLE));const{frag:n,part:i,level:r}=t,s=self.performance.now();n.stats.parsing.end=s,i&&(i.stats.parsing.end=s);const a=this.getLevelDetails(),o=a&&n.sn>a.endSN,u=o||this.shouldLoadParts(a,n.end);u!==this.loadingParts&&(this.log(`LL-Part loading ${u?"ON":"OFF"} after parsing segment ending @${n.end.toFixed(2)}`),this.loadingParts=u),this.updateLevelTiming(n,i,r,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(null!=e&&e.partList){var n;const r=e.partList[0],s=r.end+((null==(n=e.fragmentHint)?void 0:n.duration)||0);if(t>=s){var i;const e=this.hls.hasEnoughToStart?(null==(i=this.media)?void 0:i.currentTime)||this.lastCurrentTime:this.getLoadPosition();if(e>r.start-r.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:r,part:s}=e;if(null==t||!t[i])return this.warn(`Levels object was unset while buffering fragment ${r} of ${this.playlistLabel()} ${i}. The current chunk will not be buffered.`),null;const a=t[i],o=a.details,u=s>-1?Ii(o,r,s):null,l=u?u.fragment:xi(o,r,n);return l?(n&&n!==l&&(l.stats=n.stats),{frag:l,part:u,level:a}):null}bufferFragmentData(e,t,n,i,r){var s;if(!e||this.state!==Ui.PARSING)return;const{data1:a,data2:o}=e;let l=a;if(a&&o&&(l=ve(a,o)),null==(s=l)||!s.length)return;const c={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:l};if(this.hls.trigger(u.BUFFER_APPENDING,c),e.dropped&&e.independent&&!n){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!fn.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const n=t.currentTime,i=fn.bufferInfo(t,n,0),r=e.duration,s=Math.min(2*this.config.maxFragLookUpTolerance,.25*r),a=Math.max(Math.min(e.start-s,i.end-s),n+s);e.start-a>s&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){var n;const r=this.getLoadPosition();if(!i(r))return null;const s=this.lastCurrentTime>r,a=s||null!=(n=this.media)&&n.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,r,t,a)}getFwdBufferInfoAtPos(e,t,n,i){const r=fn.bufferInfo(e,t,i);if(0===r.len&&void 0!==r.nextStart){const s=this.fragmentTracker.getBufferedFrag(t,n);if(s&&(r.nextStart<=s.end||s.gap)){const n=Math.max(Math.min(r.nextStart,s.end)-t,i);return fn.bufferInfo(e,t,n)}}return r}getMaxBufferLength(e){const{config:t}=this;let n;return n=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,i=Math.max(Math.min(e-t,n.maxBufferLength),t),r=Math.max(e-3*t,n.maxMaxBufferLength/2,i);return r>=i&&(n.maxMaxBufferLength=r,this.warn(`Reduce max buffer length to ${r}s`),!0)}getAppendedFrag(e,t=c.MAIN){var n;const i=null==(n=this.fragmentTracker)?void 0:n.getAppendedFrag(e,t);return i&&"fragment"in i?i.fragment:i}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:r}=this,s=n[0].start,a=r.lowLatencyMode&&!!t.partList;let o=null;if(t.live){const l=r.initialLiveManifestSize;if(i<l)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${l})`),null;if(!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||e<s){var u;a&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),o=this.getInitialLiveFragment(t,n);const i=this.hls.startPosition,r=this.hls.liveSyncPosition,l=o?(-1!==i&&i>=s?i:r)||o.start:e;this.log(`Setting startPosition to ${l} to match start frag at live edge. mainStart: ${i} liveSyncPosition: ${r} frag.start: ${null==(u=o)?void 0:u.start}`),this.startPosition=this.nextLoadPosition=l}}else e<=s&&(o=n[0]);if(!o){const n=this.loadingParts?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,n,t)}let l=this.filterReplacedPrimary(o,t);if(!l&&o){const e=o.sn-t.startSN;l=this.filterReplacedPrimary(n[e+1]||null,t)}return this.mapToInitFragWhenRequired(l)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===Vt.OK||n===Vt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,r){let s=null;if(e.gap&&(s=this.getNextFragment(this.nextLoadPosition,t),s&&!s.gap&&n.nextStart)){const e=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i,0);if(null!==e&&n.len+e.len>=r){const e=s.sn;return this.loopSn!==e&&(this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e}`),this.loopSn=e),null}}return this.loopSn=void 0,s}get primaryPrefetch(){if(Bi(this.hls.config)){var e,t;const n=null==(e=this.hls.interstitialsManager)||null==(t=e.playingItem)?void 0:t.event;if(n)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(Bi(this.hls.config)&&e.type!==c.SUBTITLE){const n=this.hls.interstitialsManager,i=null==n?void 0:n.bufferingItem;if(i){const n=i.event;if(n){if(n.appendInPlace||Math.abs(e.start-i.start)>1||0===i.start)return null}else{if(e.end<=i.start&&!1===(null==t?void 0:t.live))return null;if(e.start>i.end&&i.nextEvent&&(i.nextEvent.appendInPlace||e.start-i.end>1))return null}}const r=null==n?void 0:n.playerQueue;if(r)for(let t=r.length;t--;){const n=r[t].interstitial;if(n.appendInPlace&&e.start>=n.startTime&&e.end<=n.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,n){let i=-1,r=!1,s=!0;for(let a=0,o=e.length;a<o;a++){const o=e[a];if(s=s&&!o.independent,i>-1&&n<o.start)break;const u=o.loaded;u?i=-1:(r||o.independent||s)&&o.fragment===t&&(i=a),r=u}return i}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=It(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const r=n.sn+1;if(r>=e.startSN&&r<=e.endSN){const s=t[r-e.startSN];n.cc===s.cc&&(i=s,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=Dt(t,n.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const t=this.hls.liveSyncPosition;null!==t&&(i=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:r}=this,{fragments:s,endSN:a}=n;const{fragmentHint:o}=n,{maxFragLookUpTolerance:u}=i,l=n.partList,c=!!(this.loadingParts&&null!=l&&l.length&&o);let d;if(c&&o&&!this.bitrateTest&&l[l.length-1].fragment.sn===o.sn&&(s=s.concat(o),a=o.sn),e<t){var h;const n=e<this.lastCurrentTime,i=n||e>t-u||null!=(h=this.media)&&h.paused||!this.startFragRequested?0:u;d=kt(r,s,e,i)}else d=s[s.length-1];if(d){const e=d.sn-n.startSN,t=this.fragmentTracker.getState(d);if((t===Vt.OK||t===Vt.PARTIAL&&d.gap)&&(r=d),r&&d.sn===r.sn&&(!c||l[0].fragment.sn>d.sn||!n.live&&!c)){const t=r&&d.level===r.level;if(t){const t=s[e+1];d=d.sn<a&&this.fragmentTracker.getState(t)!==Vt.OK?t:null}}}return d}alignPlaylists(e,t,n){const r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const s=e.fragmentStart,a=!t,o=e.alignedSliding&&i(s);if(a||!o&&!s){Pi(n,e);const i=e.fragmentStart;return this.log(`Live playlist sliding: ${i.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${r}`),i}return s}waitForCdnTuneIn(e){const t=3;return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*t)}setStartPosition(e,t){let n=this.startPosition;n<t&&(n=-1);const r=this.timelineOffset;if(-1===n){const s=null!==this.startTimeOffset,a=s?this.startTimeOffset:e.startTimeOffset;null!==a&&i(a)?(n=t+a,a<0&&(n+=e.edge),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Setting startPosition to ${n} for start time offset ${a} found in ${s?"multivariant":"media"} playlist`),this.startPosition=n):e.live?(n=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${n}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=n=0),this.lastCurrentTime=n+r}this.nextLoadPosition=n+r}getLoadPosition(){var e;const{media:t}=this;let n=0;return null!=(e=this.hls)&&e.hasEnoughToStart&&t?n=t.currentTime:this.nextLoadPosition>=0&&(n=this.nextLoadPosition),n}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&$(e)&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===Ui.FRAG_LOADING_WAITING_RETRY)||(this.state=Ui.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;var i;if(this.fragContextChanged(n))return void this.warn(`Frag load error must match current frag to retry ${n.url} > ${null==(i=this.fragCurrent)?void 0:i.url}`);const r=t.details===o.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(n,!0);const s=t.errorAction,{action:a,flags:u,retryCount:l=0,retryConfig:c}=s||{},d=!!s&&!!c,h=d&&a===Bt.RetryRequest,f=d&&!s.resolved&&u===jt.MoveAllAlternatesMatchingHost;if(!h&&f&&$(n)&&!n.endList)this.resetFragmentErrors(e),this.treatAsGap(n),s.resolved=!0;else if((h||f)&&l<c.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);const i=Ot(c,l);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${l+1}/${c.maxNumRetry} in ${i}ms`),s.resolved=!0,this.retryDate=self.performance.now()+i,this.state=Ui.FRAG_LOADING_WAITING_RETRY}else if(c&&s){if(this.resetFragmentErrors(e),!(l<c.maxNumRetry))return void this.warn(`${t.details} reached or exceeded max retry (${l})`);r||a===Bt.RemoveAlternatePermanently||(s.resolved=!0)}else a===Bt.SendAlternateToPenaltyBox?this.state=Ui.WAITING_LEVEL:this.state=Ui.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Ui.PARSING||this.state===Ui.PARSED){const t=e.frag,n=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),r=i&&i.len>.5;r&&this.reduceMaxBufferLength(i.len,(null==t?void 0:t.duration)||10);const s=!r;return s&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(e){e===c.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==Ui.STOPPED&&(this.state=Ui.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const i=fn.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===Ui.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==Ui.STOPPED&&(this.state=Ui.IDLE)}resetStartWhenNotLoaded(e){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=e?e.details:null;null!=t&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of ${this.playlistLabel()} ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){const r=n.details;if(!r)return void this.warn("level.details undefined");const s=Object.keys(e.elementaryStreams).reduce(((t,s)=>{const a=e.elementaryStreams[s];if(a){const o=a.endPTS-a.startPTS;if(o<=0)return this.warn(`Could not parse fragment ${e.sn} ${s} duration reliably (${o})`),t||!1;const l=i?0:mi(r,e,a.startPTS,a.endPTS,a.startDTS,a.endDTS);return this.hls.trigger(u.LEVEL_PTS_UPDATED,{details:r,level:n,drift:l,type:s,frag:e,start:a.startPTS,end:a.endPTS}),!0}return t}),!1);var l;if(!s&&(0===n.fragmentError&&this.treatAsGap(e,n),null===(null==(l=this.transmuxer)?void 0:l.error))){const t=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(t.message),this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Ui.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(u.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===c.MAIN?"level":"track"}fragInfo(e,t=!0,n){var i,r;return`${this.playlistLabel()} ${e.level} (${n?"part":"frag"}:[${(null!=(i=t&&!n?e.startPTS:(n||e).start)?i:NaN).toFixed(3)}-${(null!=(r=t&&!n?e.endPTS:(n||e).end)?r:NaN).toFixed(3)}]${n&&"main"===e.type?"INDEPENDENT="+(n.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;null==(e=this.transmuxer)||e.reset()}recoverWorkerError(e){"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function Bi(e){return!!e.interstitialsController&&!1!==e.enableInterstitialPlayback}class ji{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;return e.length?(n=1===e.length?e[0]:$i(e,t),this.reset(),n):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function $i(e,t){const n=new Uint8Array(t);let i=0;for(let r=0;r<e.length;r++){const t=e[r];n.set(t,i),i+=t.length}return n}var Gi,Vi={exports:{}};function Hi(){return Gi||(Gi=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,i,s,a){if("function"!==typeof i)throw new TypeError("The listener must be a function");var o=new r(i,s||e,a),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],o]:e._events[u].push(o):(e._events[u]=o,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new i:delete e._events[t]}function o(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a},o.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},o.prototype.emit=function(e,t,i,r,s,a){var o=n?n+e:e;if(!this._events[o])return!1;var u,l,c=this._events[o],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,r),!0;case 5:return c.fn.call(c.context,t,i,r,s),!0;case 6:return c.fn.call(c.context,t,i,r,s,a),!0}for(l=1,u=new Array(d-1);l<d;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var h,f=c.length;for(l=0;l<f;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),d){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,i);break;case 4:c[l].fn.call(c[l].context,t,i,r);break;default:if(!u)for(h=1,u=new Array(d-1);h<d;h++)u[h-1]=arguments[h];c[l].fn.apply(c[l].context,u)}}return!0},o.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,i,r){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||r&&!o.once||i&&o.context!==i||a(this,s);else{for(var u=0,l=[],c=o.length;u<c;u++)(o[u].fn!==t||r&&!o[u].once||i&&o[u].context!==i)&&l.push(o[u]);l.length?this._events[s]=1===l.length?l[0]:l:a(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(Vi)),Vi.exports}var Ki=Hi(),Wi=P(Ki);const qi="1.6.2",Yi={};function Xi(){return"function"===typeof __HLS_WORKER_BUNDLE__}function zi(){const e=Yi[qi];if(e)return e.clientCount++,e;const t=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),n=self.URL.createObjectURL(t),i=new self.Worker(n),r={worker:i,objectURL:n,clientCount:1};return Yi[qi]=r,r}function Qi(e){const t=Yi[e];if(t)return t.clientCount++,t;const n=new self.URL(e,self.location.href).href,i=new self.Worker(n),r={worker:i,scriptURL:n,clientCount:1};return Yi[e]=r,r}function Ji(e){const t=Yi[e||qi];if(t){const n=t.clientCount--;if(1===n){const{worker:n,objectURL:i}=t;delete Yi[e||qi],i&&self.URL.revokeObjectURL(i),n.terminate()}}}function Zi(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function er(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function tr(e,t){let n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3],n}function nr(e,t){const n=t;let i=0;while(er(e,t)){i+=10;const n=tr(e,t+6);i+=n,Zi(e,t+10)&&(i+=10),t+=i}if(i>0)return e.subarray(n,n+i)}function ir(e,t,n,i){const r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],s=t[n+2],l=s>>2&15;if(l>12){const t=new Error(`invalid ADTS sampling index:${l}`);return void e.emit(u.ERROR,u.ERROR,{type:a.MEDIA_ERROR,details:o.FRAG_PARSING_ERROR,fatal:!0,error:t,reason:t.message})}const c=1+(s>>6&3),d=t[n+3]>>6&3|(1&s)<<2,h="mp4a.40."+c,f=r[l];let p=l;5!==c&&29!==c||(p-=3);const g=[c<<3|(14&p)>>1,(1&p)<<7|d<<3];return k.log(`manifest codec:${i}, parsed codec:${h}, channels:${d}, rate:${f} (ADTS object type:${c} sampling index:${l})`),{config:g,samplerate:f,channelCount:d,codec:h,parsedCodec:h,manifestCodec:i}}function rr(e,t){return 255===e[t]&&240===(246&e[t+1])}function sr(e,t){return 1&e[t+1]?7:9}function ar(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function or(e,t){return t+5<e.length}function ur(e,t){return t+1<e.length&&rr(e,t)}function lr(e,t){return or(e,t)&&rr(e,t)&&ar(e,t)<=e.length-t}function cr(e,t){if(ur(e,t)){const n=sr(e,t);if(t+n>=e.length)return!1;const i=ar(e,t);if(i<=n)return!1;const r=t+i;return r===e.length||ur(e,r)}return!1}function dr(e,t,n,i,r){if(!e.samplerate){const s=ir(t,n,i,r);if(!s)return;p(e,s)}}function hr(e){return 9216e4/e}function fr(e,t){const n=sr(e,t);if(t+n<=e.length){const i=ar(e,t)-n;if(i>0)return{headerLength:n,frameLength:i}}}function pr(e,t,n,i,r){const s=hr(e.samplerate),a=i+r*s,o=fr(t,n);let u;if(o){const{frameLength:i,headerLength:r}=o,s=r+i,l=Math.max(0,n+s-t.length);l?(u=new Uint8Array(s-r),u.set(t.subarray(n+r,t.length),0)):u=t.subarray(n+r,n+s);const c={unit:u,pts:a};return l||e.samples.push(c),{sample:c,length:s,missing:l}}const l=t.length-n;u=new Uint8Array(l),u.set(t.subarray(n,t.length),0);const c={unit:u,pts:a};return{sample:c,length:l,missing:-1}}function gr(e,t){return er(e,t)&&tr(e,t+6)+10<=e.length-t}function mr(e){if(e.size<2)return;const t=D(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}}function vr(e){if(e.size<2)return;if("TXXX"===e.type){let t=1;const n=D(e.data.subarray(t),!0);t+=n.length+1;const i=D(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=D(e.data.subarray(1));return{key:e.type,info:"",data:t}}function yr(e){if("WXXX"===e.type){if(e.size<2)return;let t=1;const n=D(e.data.subarray(t),!0);t+=n.length+1;const i=D(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=D(e.data);return{key:e.type,info:"",data:t}}function br(e){return btoa(String.fromCharCode(...e))}function Tr(e,t){if(e<0)return-Tr(-e,t);const n=Math.pow(10,t),i=Math.abs(e*n%1-.5)<Number.EPSILON;if(i){const t=Math.floor(e*n);return(t%2===0?t:t+1)/n}return Math.round(e*n)/n}function Sr(e,t){const n=new URL(e),i=new URL(t);if(n.origin!==i.origin)return e;const r=n.pathname.split("/").slice(1),s=i.pathname.split("/").slice(1,-1);while(r[0]===s[0])r.shift(),s.shift();while(s.length)s.shift(),r.unshift("..");return r.join("/")}function Er(){try{return crypto.randomUUID()}catch(e){try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch(e){let t=(new Date).getTime();const n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)}));return n}}}function wr(e){return e instanceof ArrayBuffer?e:0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer}function Ar(e,t=0,n=1/0){return xr(e,t,n,Uint8Array)}function xr(e,t,n,i){const r=Ir(e);let s=1;"BYTES_PER_ELEMENT"in i&&(s=i.BYTES_PER_ELEMENT);const a=kr(e)?e.byteOffset:0,o=(a+e.byteLength)/s,u=(a+t)/s,l=Math.floor(Math.max(0,Math.min(u,o))),c=Math.floor(Math.min(l+Math.max(n,0),o));return new i(r,l,c-l)}function Ir(e){return e instanceof ArrayBuffer?e:e.buffer}function kr(e){return e&&e.buffer instanceof ArrayBuffer&&void 0!==e.byteLength&&void 0!==e.byteOffset}function Lr(e){const t={key:e.type,description:"",data:"",mimeType:null,pictureType:null},n=3;if(e.size<2)return;if(e.data[0]!==n)return void console.log("Ignore frame with unrecognized character encoding");const i=e.data.subarray(1).indexOf(0);if(-1===i)return;const r=D(Ar(e.data,1,i)),s=e.data[2+i],a=e.data.subarray(3+i).indexOf(0);if(-1===a)return;const o=D(Ar(e.data,3+i,a));let u;return u="--\x3e"===r?D(Ar(e.data,4+i+a)):wr(e.data.subarray(4+i+a)),t.mimeType=r,t.pictureType=s,t.description=o,t.data=u,t}function Rr(e){return"PRIV"===e.type?mr(e):"W"===e.type[0]?yr(e):"APIC"===e.type?Lr(e):vr(e)}function Cr(e){const t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=tr(e,4),i=10;return{type:t,size:n,data:e.subarray(i,i+n)}}const Dr=10,Mr=10;function Pr(e){let t=0;const n=[];while(er(e,t)){const i=tr(e,t+6);e[t+5]>>6&1&&(t+=Dr),t+=Dr;const r=t+i;while(t+Mr<r){const i=Cr(e.subarray(t)),r=Rr(i);r&&n.push(r),t+=i.size+Dr}Zi(e,t)&&(t+=Dr)}return n}function _r(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info}function Or(e){if(8===e.data.byteLength){const t=new Uint8Array(e.data),n=1&t[3];let i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,n&&(i+=47721858.84),Math.round(i)}}function Nr(e){const t=Pr(e);for(let n=0;n<t.length;n++){const e=t[n];if(_r(e))return Or(e)}}let Ur=function(e){return e["audioId3"]="org.id3",e["dateRange"]="com.apple.quicktime.HLS",e["emsg"]="https://aomedia.org/emsg/ID3",e["misbklv"]="urn:misb:KLV:bin:1910.1",e}({});function Fr(e="",t=9e4){return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class Br{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=ve(this.cachedData,e),this.cachedData=null);let n,r=nr(e,0),s=r?r.length:0;const a=this._audioTrack,o=this._id3Track,u=r?Nr(r):void 0,l=e.length;(null===this.basePTS||0===this.frameIndex&&i(u))&&(this.basePTS=jr(u,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),r&&r.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Ur.audioId3,duration:Number.POSITIVE_INFINITY});while(s<l){if(this.canParse(e,s)){const t=this.appendFrame(a,e,s);t?(this.frameIndex++,this.lastPTS=t.sample.pts,s+=t.length,n=s):s=l}else gr(e,s)?(r=nr(e,s),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Ur.audioId3,duration:Number.POSITIVE_INFINITY}),s+=r.length,n=s):s++;if(s===l&&n!==l){const t=e.slice(n);this.cachedData?this.cachedData=ve(this.cachedData,t):this.cachedData=t}}return{audioTrack:a,videoTrack:Fr(),id3Track:o,textTrack:Fr()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Fr(),id3Track:this._id3Track,textTrack:Fr()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const jr=(e,t,n)=>{if(i(e))return 90*e;const r=n?9e4*n.baseTime/n.timescale:0;return 9e4*t+r};let $r=null;const Gr=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Vr=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Hr=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Kr=[0,1,1,4];function Wr(e,t,n,i,r){if(n+24>t.length)return;const s=qr(t,n);if(s&&n+s.frameLength<=t.length){const a=9e4*s.samplesPerFrame/s.sampleRate,o=i+r*a,u={unit:t.subarray(n,n+s.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=s.channelCount,e.samplerate=s.sampleRate,e.samples.push(u),{sample:u,length:s.frameLength,missing:0}}}function qr(e,t){const n=e[t+1]>>3&3,i=e[t+1]>>1&3,r=e[t+2]>>4&15,s=e[t+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==s){const a=e[t+2]>>1&1,o=e[t+3]>>6,u=3===n?3-i:3===i?3:4,l=1e3*Gr[14*u+r-1],c=3===n?0:2===n?1:2,d=Vr[3*c+s],h=3===o?1:2,f=Hr[n][i],p=Kr[i],g=8*f*p,m=Math.floor(f*l/d+a)*p;if(null===$r){const e=navigator.userAgent||"",t=e.match(/Chrome\/(\d+)/i);$r=t?parseInt(t[1]):0}const v=!!$r&&$r<=87;return v&&2===i&&l>=224e3&&0===o&&(e[t+3]=128|e[t+3]),{sampleRate:d,channelCount:h,frameLength:m,samplesPerFrame:g}}}function Yr(e,t){return 255===e[t]&&224===(224&e[t+1])&&0!==(6&e[t+1])}function Xr(e,t){return t+1<e.length&&Yr(e,t)}function zr(e,t){const n=4;return Yr(e,t)&&n<=e.length-t}function Qr(e,t){if(t+1<e.length&&Yr(e,t)){const n=4,i=qr(e,t);let r=n;null!=i&&i.frameLength&&(r=i.frameLength);const s=t+r;return s===e.length||Xr(e,s)}return!1}class Jr extends Br{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const n=nr(e,0);let i=(null==n?void 0:n.length)||0;if(Qr(e,i))return!1;for(let r=e.length;i<r;i++)if(cr(e,i))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return lr(e,t)}appendFrame(e,t,n){dr(e,this.observer,t,n,e.manifestCodec);const i=pr(e,t,n,this.basePTS,this.frameIndex);if(i&&0===i.missing)return i}}const Zr=(e,t)=>{let n=0,i=5;t+=i;const r=new Uint32Array(1),s=new Uint32Array(1),a=new Uint8Array(1);while(i>0){a[0]=e[t];const o=Math.min(i,8),u=8-o;s[0]=4278190080>>>24+u<<u,r[0]=(a[0]&s[0])>>u,n=n?n<<o|r[0]:r[0],t+=1,i-=o}return n};class es extends Br{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const i=ts(e,t,n,this.basePTS,this.frameIndex);if(-1!==i){const t=e.samples[e.samples.length-1];return{sample:t,length:i,missing:0}}}static probe(e){if(!e)return!1;const t=nr(e,0);if(!t)return!1;const n=t.length;return 11===e[n]&&119===e[n+1]&&void 0!==Nr(t)&&Zr(e,n)<16}}function ts(e,t,n,i,r){if(n+8>t.length)return-1;if(11!==t[n]||119!==t[n+1])return-1;const s=t[n+4]>>6;if(s>=3)return-1;const a=[48e3,44100,32e3],o=a[s],u=63&t[n+4],l=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920],c=2*l[3*u+s];if(n+c>t.length)return-1;const d=t[n+6]>>5;let h=0;2===d?h+=2:(1&d&&1!==d&&(h+=2),4&d&&(h+=2));const f=(t[n+6]<<8|t[n+7])>>12-h&1,p=[2,1,2,3,3,4,4,5],g=p[d]+f,m=t[n+5]>>3,v=7&t[n+5],y=new Uint8Array([s<<6|m<<1|v>>2,(3&v)<<6|d<<3|f<<2|u>>4,u<<4&224]),b=1536/o*9e4,T=i+r*b,S=t.subarray(n,n+c);return e.config=y,e.channelCount=g,e.samplerate=o,e.samples.push({unit:S,pts:T}),c}class ns extends Br{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=nr(e,0);let n=(null==t?void 0:t.length)||0;if(t&&11===e[n]&&119===e[n+1]&&void 0!==Nr(t)&&Zr(e,n)<=16)return!1;for(let i=e.length;n<i;n++)if(Qr(e,n))return k.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return zr(e,t)}appendFrame(e,t,n){if(null!==this.basePTS)return Wr(e,t,n,this.basePTS,this.frameIndex)}}const is=/\/emsg[-/]ID3/i;class rs{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const r=this.videoTrack=Fr("video",1),s=this.audioTrack=Fr("audio",1),a=this.txtTrack=Fr("text",1);if(this.id3Track=Fr("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const o=re(e);if(o.video){const{id:e,timescale:t,codec:n,supplemental:i}=o.video;r.id=e,r.timescale=a.timescale=t,r.codec=n,r.supplemental=i}if(o.audio){const{id:e,timescale:t,codec:n}=o.audio;s.id=e,s.timescale=t,s.codec=n}a.id=Y.text,r.sampleDuration=0,r.duration=s.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return te(e)}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=ve(this.remainderData,e));const t=me(n);this.remainderData=t.remainder,i.samples=t.valid||new Uint8Array}else i.samples=n;const s=this.extractID3Track(i,t);return r.samples=ye(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=ye(e,t),{videoTrack:t,audioTrack:Fr(),id3Track:i,textTrack:Fr()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=ne(e.samples,["emsg"]);i&&i.forEach((e=>{const i=we(e);if(is.test(i.schemeIdUri)){const e=ss(i,t);let r=4294967295===i.eventDuration?Number.POSITIVE_INFINITY:i.eventDuration/i.timeScale;r<=.001&&(r=Number.POSITIVE_INFINITY);const s=i.payload;n.samples.push({data:s,len:s.byteLength,dts:e,pts:e,type:Ur.emsg,duration:r})}else if(this.config.enableEmsgKLVMetadata&&i.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const e=ss(i,t);n.samples.push({data:i.payload,len:i.payload.byteLength,dts:e,pts:e,type:Ur.misbklv,duration:Number.POSITIVE_INFINITY})}}))}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function ss(e,t){return i(e.presentationTime)?e.presentationTime/e.timeScale:t+e.presentationTimeDelta/e.timeScale}class as{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new tn(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,Yt.cbc)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const r=i.subarray(16,i.length-i.length%16),s=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(s).then((r=>{const s=new Uint8Array(r);i.set(s,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)}))}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)n.set(e.subarray(r,r+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)e.set(n.subarray(i,i+16),r);return e}decryptAvcSample(e,t,n,i,r){const s=Ee(r.data),a=this.getAvcEncryptedData(s);this.decryptBuffer(a.buffer).then((a=>{r.data=this.getAvcDecryptedUnit(s,a),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)}))}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length)return void i();const r=e[t].units;for(;;n++){if(n>=r.length)break;const s=r[n];if(!(s.data.length<=48||1!==s.type&&5!==s.type)&&(this.decryptAvcSample(e,t,n,i,s),!this.decrypter.isSync()))return}}}}class os{constructor(){this.VideoSample=null}createVideoSample(e,t,n){return{key:e,frame:!1,pts:t,dts:n,units:[],length:0}}getLastNalUnit(e){var t;let n,i=this.VideoSample;if(i&&0!==i.units.length||(i=e[e.length-1]),null!=(t=i)&&t.units){const e=i.units;n=e[e.length-1]}return n}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){const n=t.samples,i=n.length;if(!i)return void t.dropped++;{const t=n[i-1];e.pts=t.pts,e.dts=t.dts}}t.samples.push(e)}}parseNALu(e,t,n){const i=t.byteLength;let r=e.naluState||0;const s=r,a=[];let o,u,l,c=0,d=-1,h=0;-1===r&&(d=0,h=this.getNALuType(t,0),r=0,c=1);while(c<i)if(o=t[c++],r)if(1!==r)if(o)if(1===o){if(u=c-r-1,d>=0){const e={data:t.subarray(d,u),type:h};a.push(e)}else{const n=this.getLastNalUnit(e.samples);n&&(s&&c<=4-s&&n.state&&(n.data=n.data.subarray(0,n.data.byteLength-s)),u>0&&(n.data=ve(n.data,t.subarray(0,u)),n.state=0))}c<i?(l=this.getNALuType(t,c),d=c,h=l,r=0):r=-1}else r=0;else r=3;else r=o?0:2;else r=o?0:1;if(d>=0&&r>=0){const e={data:t.subarray(d,i),type:h,state:r};a.push(e)}if(0===a.length){const n=this.getLastNalUnit(e.samples);n&&(n.data=ve(n.data,t))}return e.naluState=r,a}}class us{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");i.set(e.subarray(n,n+r)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&k.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(0!==(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class ls extends os{parsePES(e,t,n,i){const r=this.parseNALu(e,n.data,i);let s,a=this.VideoSample,o=!1;n.data=null,a&&r.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),r.forEach((i=>{var r,u;switch(i.type){case 1:{let t=!1;s=!0;const r=i.data;if(o&&r.length>4){const e=this.readSliceType(r);2!==e&&4!==e&&7!==e&&9!==e||(t=!0)}var l;if(t)null!=(l=a)&&l.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null);a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.frame=!0,a.key=t;break}case 5:s=!0,null!=(r=a)&&r.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 6:s=!0,Se(i.data,1,n.pts,t.samples);break;case 7:{var c,d;s=!0,o=!0;const t=i.data,n=this.readSPS(t);if(!e.sps||e.width!==n.width||e.height!==n.height||(null==(c=e.pixelRatio)?void 0:c[0])!==n.pixelRatio[0]||(null==(d=e.pixelRatio)?void 0:d[1])!==n.pixelRatio[1]){e.width=n.width,e.height=n.height,e.pixelRatio=n.pixelRatio,e.sps=[t];const i=t.subarray(1,4);let r="avc1.";for(let e=0;e<3;e++){let t=i[e].toString(16);t.length<2&&(t="0"+t),r+=t}e.codec=r}break}case 8:s=!0,e.pps=[i.data];break;case 9:s=!0,e.audFound=!0,null!=(u=a)&&u.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;case 12:s=!0;break;default:s=!1;break}if(a&&s){const e=a.units;e.push(i)}})),i&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}getNALuType(e,t){return 31&e[t]}readSliceType(e){const t=new us(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let n,i=8,r=8;for(let s=0;s<e;s++)0!==r&&(n=t.readEG(),r=(i+n+256)%256),i=0===r?i:r}readSPS(e){const t=new us(e);let n,i,r,s=0,a=0,o=0,u=0;const l=t.readUByte.bind(t),c=t.readBits.bind(t),d=t.readUEG.bind(t),h=t.readBoolean.bind(t),f=t.skipBits.bind(t),p=t.skipEG.bind(t),g=t.skipUEG.bind(t),m=this.skipScalingList.bind(this);l();const v=l();if(c(5),f(3),l(),g(),100===v||110===v||122===v||244===v||44===v||83===v||86===v||118===v||128===v){const e=d();if(3===e&&f(1),g(),g(),f(1),h())for(i=3!==e?8:12,r=0;r<i;r++)h()&&m(r<6?16:64,t)}g();const y=d();if(0===y)d();else if(1===y)for(f(1),p(),p(),n=d(),r=0;r<n;r++)p();g(),f(1);const b=d(),T=d(),S=c(1);0===S&&f(1),f(1),h()&&(s=d(),a=d(),o=d(),u=d());let E=[1,1];if(h()&&h()){const e=l();switch(e){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:E=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil(16*(b+1)-2*s-2*a),height:(2-S)*(T+1)*16-(S?2:4)*(o+u),pixelRatio:E}}}class cs extends os{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,n,i){const r=this.parseNALu(e,n.data,i);let s,a=this.VideoSample,o=!1;n.data=null,a&&r.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),r.forEach((i=>{var r,u;switch(i.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),a.frame=!0,s=!0;break;case 16:case 17:case 18:case 21:var l;if(s=!0,o)null!=(l=a)&&l.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null);a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:s=!0,null!=(r=a)&&r.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 39:s=!0,Se(i.data,2,n.pts,t.samples);break;case 32:s=!0,e.vps||("object"!==typeof e.params&&(e.params={}),e.params=p(e.params,this.readVPS(i.data)),this.initVPS=i.data),e.vps=[i.data];break;case 33:if(s=!0,o=!0,void 0===e.vps||e.vps[0]===this.initVPS||void 0===e.sps||this.matchSPS(e.sps[0],i.data)||(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const t=this.readSPS(i.data);e.width=t.width,e.height=t.height,e.pixelRatio=t.pixelRatio,e.codec=t.codecString,e.sps=[],"object"!==typeof e.params&&(e.params={});for(const n in t.params)e.params[n]=t.params[n]}this.pushParameterSet(e.sps,i.data,e.vps),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0;break;case 34:if(s=!0,"object"===typeof e.params){if(!e.pps){e.pps=[];const t=this.readPPS(i.data);for(const n in t)e.params[n]=t[n]}this.pushParameterSet(e.pps,i.data,e.vps)}break;case 35:s=!0,e.audFound=!0,null!=(u=a)&&u.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;default:s=!1;break}if(a&&s){const e=a.units;e.push(i)}})),i&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}pushParameterSet(e,t,n){(n&&n[0]===this.initVPS||!n&&!e.length)&&e.push(t)}getNALuType(e,t){return(126&e[t])>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let n=0;for(let i=0;i<e.byteLength;i++)i>=2&&3===e[i]&&0===e[i-1]&&0===e[i-2]||(t[n]=e[i],n++);return new Uint8Array(t.buffer,0,n)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new us(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const n=t.readBits(3),i=t.readBoolean();return{numTemporalLayers:n+1,temporalIdNested:i}}readSPS(e){const t=new us(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const n=t.readBits(3);t.readBoolean();const i=t.readBits(2),r=t.readBoolean(),s=t.readBits(5),a=t.readUByte(),o=t.readUByte(),u=t.readUByte(),l=t.readUByte(),c=t.readUByte(),d=t.readUByte(),h=t.readUByte(),f=t.readUByte(),p=t.readUByte(),g=t.readUByte(),m=t.readUByte(),v=[],y=[];for(let Q=0;Q<n;Q++)v.push(t.readBoolean()),y.push(t.readBoolean());if(n>0)for(let Q=n;Q<8;Q++)t.readBits(2);for(let Q=0;Q<n;Q++)v[Q]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),y[Q]&&t.readUByte();t.readUEG();const b=t.readUEG();3==b&&t.skipBits(1);const T=t.readUEG(),S=t.readUEG(),E=t.readBoolean();let w=0,A=0,x=0,I=0;E&&(w+=t.readUEG(),A+=t.readUEG(),x+=t.readUEG(),I+=t.readUEG());const k=t.readUEG(),L=t.readUEG(),R=t.readUEG(),C=t.readBoolean();for(let Q=C?0:n;Q<=n;Q++)t.skipUEG(),t.skipUEG(),t.skipUEG();t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG();const D=t.readBoolean();if(D){const e=t.readBoolean();if(e)for(let n=0;n<4;n++)for(let e=0;e<(3===n?2:6);e++){const e=t.readBoolean();if(e){const e=Math.min(64,1<<4+(n<<1));n>1&&t.readEG();for(let n=0;n<e;n++)t.readEG()}else t.readUEG()}}t.readBoolean(),t.readBoolean();const M=t.readBoolean();M&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const P=t.readUEG();let _=0;for(let Q=0;Q<P;Q++){let e=!1;if(0!==Q&&(e=t.readBoolean()),e){Q===P&&t.readUEG(),t.readBoolean(),t.readUEG();let e=0;for(let n=0;n<=_;n++){const n=t.readBoolean();let i=!1;n||(i=t.readBoolean()),(n||i)&&e++}_=e}else{const e=t.readUEG(),n=t.readUEG();_=e+n;for(let i=0;i<e;i++)t.readUEG(),t.readBoolean();for(let i=0;i<n;i++)t.readUEG(),t.readBoolean()}}const O=t.readBoolean();if(O){const e=t.readUEG();for(let n=0;n<e;n++){for(let e=0;e<R+4;e++)t.readBits(1);t.readBits(1)}}let N=0,U=1,F=1,B=!0,j=1,$=0;t.readBoolean(),t.readBoolean();let G=!1;const V=t.readBoolean();if(V){const e=t.readBoolean();if(e){const e=t.readUByte(),n=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],i=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];e>0&&e<16?(U=n[e-1],F=i[e-1]):255===e&&(U=t.readBits(16),F=t.readBits(16))}const i=t.readBoolean();i&&t.readBoolean();const r=t.readBoolean();if(r){t.readBits(3),t.readBoolean();const e=t.readBoolean();e&&(t.readUByte(),t.readUByte(),t.readUByte())}const s=t.readBoolean();s&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),G=t.readBoolean(),G&&(w+=t.readUEG(),A+=t.readUEG(),x+=t.readUEG(),I+=t.readUEG());const a=t.readBoolean();if(a){j=t.readBits(32),$=t.readBits(32);const e=t.readBoolean();e&&t.readUEG();const i=t.readBoolean();if(i){const e=t.readBoolean(),i=t.readBoolean();let r=!1;(e||i)&&(r=t.readBoolean(),r&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),r&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let s=0;s<=n;s++){B=t.readBoolean();const n=B||t.readBoolean();let s=!1;n?t.readEG():s=t.readBoolean();const a=s?1:t.readUEG()+1;if(e)for(let e=0;e<a;e++)t.readUEG(),t.readUEG(),r&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(i)for(let e=0;e<a;e++)t.readUEG(),t.readUEG(),r&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}}const o=t.readBoolean();o&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),N=t.readUEG())}let H=T,K=S;if(E||G){let e=1,t=1;1===b?e=t=2:2==b&&(e=2),H=T-e*A-e*w,K=S-t*I-t*x}const W=i?["A","B","C"][i]:"",q=a<<24|o<<16|u<<8|l;let Y=0;for(let Q=0;Q<32;Q++)Y=(Y|(q>>Q&1)<<31-Q)>>>0;let X=Y.toString(16);1===s&&"2"===X&&(X="6");const z=r?"H":"L";return{codecString:`hvc1.${W}${s}.${X}.${z}${m}.B0`,params:{general_tier_flag:r,general_profile_idc:s,general_profile_space:i,general_profile_compatibility_flags:[a,o,u,l],general_constraint_indicator_flags:[c,d,h,f,p,g],general_level_idc:m,bit_depth:k+8,bit_depth_luma_minus8:k,bit_depth_chroma_minus8:L,min_spatial_segmentation_idc:N,chroma_format_idc:b,frame_rate:{fixed:B,fps:$/j}},width:H,height:K,pixelRatio:[U,F]}}readPPS(e){const t=new us(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2);const n=t.readBoolean();n&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const i=t.readBoolean(),r=t.readBoolean();let s=1;return r&&i?s=0:r?s=3:i&&(s=2),{parallelismType:s}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const ds=188;class hs{constructor(e,t,n,i){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=i,this.videoParser=null}static probe(e,t){const n=hs.syncOffset(e);return n>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),-1!==n}static syncOffset(e){const t=e.length;let n=Math.min(5*ds,t-ds)+1,i=0;while(i<n){let r=!1,s=-1,a=0;for(let o=i;o<t;o+=ds){if(71!==e[o]||t-o!==ds&&71!==e[o+ds]){if(a)return-1;break}if(a++,-1===s&&(s=o,0!==s&&(n=Math.min(s+99*ds,e.length-ds)+1)),r||(r=0===fs(e,o)),r&&a>1&&(0===s&&a>2||o+ds>n))return s}i++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:Y[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=hs.createTrack("video"),this._videoTrack.duration=i,this._audioTrack=hs.createTrack("audio",i),this._id3Track=hs.createTrack("id3"),this._txtTrack=hs.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,i=!1){let r;n||(this.sampleAes=null);const s=this._videoTrack,a=this._audioTrack,o=this._id3Track,u=this._txtTrack;let l=s.pid,c=s.pesData,d=a.pid,h=o.pid,f=a.pesData,p=o.pesData,g=null,m=this.pmtParsed,v=this._pmtId,y=e.length;if(this.remainderData&&(e=ve(this.remainderData,e),y=e.length,this.remainderData=null),y<ds&&!i)return this.remainderData=e,{audioTrack:a,videoTrack:s,id3Track:o,textTrack:u};const b=Math.max(0,hs.syncOffset(e));y-=(y-b)%ds,y<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,y,e.buffer.byteLength-y));let T=0;for(let E=b;E<y;E+=ds)if(71===e[E]){const t=!!(64&e[E+1]),i=fs(e,E),y=(48&e[E+3])>>4;let T;if(y>1){if(T=E+5+e[E+4],T===E+ds)continue}else T=E+4;switch(i){case l:if(t){if(c&&(r=ys(c,this.logger))){if(null===this.videoParser)switch(s.segmentCodec){case"avc":this.videoParser=new ls;break;case"hevc":this.videoParser=new cs;break}null!==this.videoParser&&this.videoParser.parsePES(s,u,r,!1)}c={data:[],size:0}}c&&(c.data.push(e.subarray(T,E+ds)),c.size+=E+ds-T);break;case d:if(t){if(f&&(r=ys(f,this.logger)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,r);break;case"mp3":this.parseMPEGPES(a,r);break;case"ac3":this.parseAC3PES(a,r);break}f={data:[],size:0}}f&&(f.data.push(e.subarray(T,E+ds)),f.size+=E+ds-T);break;case h:t&&(p&&(r=ys(p,this.logger))&&this.parseID3PES(o,r),p={data:[],size:0}),p&&(p.data.push(e.subarray(T,E+ds)),p.size+=E+ds-T);break;case 0:t&&(T+=e[T]+1),v=this._pmtId=ps(e,T);break;case v:{t&&(T+=e[T]+1);const i=gs(e,T,this.typeSupported,n,this.observer,this.logger);l=i.videoPid,l>0&&(s.pid=l,s.segmentCodec=i.segmentVideoCodec),d=i.audioPid,d>0&&(a.pid=d,a.segmentCodec=i.segmentAudioCodec),h=i.id3Pid,h>0&&(o.pid=h),null===g||m||(this.logger.warn(`MPEG-TS PMT found at ${E} after unknown PID '${g}'. Backtracking to sync byte @${b} to parse all TS packets.`),g=null,E=b-188),m=this.pmtParsed=!0;break}case 17:case 8191:break;default:g=i;break}}else T++;T>0&&ms(this.observer,new Error(`Found ${T} TS packet/s that do not start with 0x47`),void 0,this.logger),s.pesData=c,a.pesData=f,o.pesData=p;const S={audioTrack:a,videoTrack:s,id3Track:o,textTrack:u};return i&&this.extractRemainingSamples(S),S}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:r}=e,s=n.pesData,a=t.pesData,o=i.pesData;let u;if(s&&(u=ys(s,this.logger))){if(null===this.videoParser)switch(n.segmentCodec){case"avc":this.videoParser=new ls;break;case"hevc":this.videoParser=new cs;break}null!==this.videoParser&&(this.videoParser.parsePES(n,r,u,!0),n.pesData=null)}else n.pesData=s;if(a&&(u=ys(a,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,u);break;case"mp3":this.parseMPEGPES(t,u);break;case"ac3":this.parseAC3PES(t,u);break}t.pesData=null}else null!=a&&a.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;o&&(u=ys(o,this.logger))?(this.parseID3PES(i,u),i.pesData=null):i.pesData=o}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),r=this.sampleAes=new as(this.observer,this.config,t);return this.decrypt(i,r)}decrypt(e,t){return new Promise((n=>{const{audioTrack:i,videoTrack:r}=e;i.samples&&"aac"===i.segmentCodec?t.decryptAacSamples(i.samples,0,(()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,(()=>{n(e)})):n(e)})):r.samples&&t.decryptAvcSamples(r.samples,0,0,(()=>{n(e)}))}))}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let r,s,a,o=t.data;if(i){this.aacOverFlow=null;const t=i.missing,r=i.sample.unit.byteLength;if(-1===t)o=ve(i.sample.unit,o);else{const s=r-t;i.sample.unit.set(o.subarray(0,t),s),e.samples.push(i.sample),n=i.missing}}for(r=n,s=o.length;r<s-1;r++)if(ur(o,r))break;if(r!==n){let e;const t=r<s-1;if(e=t?`AAC PES did not start with ADTS header,offset:${r}`:"No ADTS header found in AAC PES",ms(this.observer,new Error(e),t,this.logger),!t)return}if(dr(e,this.observer,o,r,this.audioCodec),void 0!==t.pts)a=t.pts;else{if(!i)return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");{const t=hr(e.samplerate);a=i.sample.pts+t}}let u,l=0;while(r<s){if(u=pr(e,o,r,a,l),r+=u.length,u.missing){this.aacOverFlow=u;break}for(l++;r<s-1;r++)if(ur(o,r))break}}parseMPEGPES(e,t){const n=t.data,i=n.length;let r=0,s=0;const a=t.pts;if(void 0!==a)while(s<i)if(Xr(n,s)){const t=Wr(e,n,s,a,r);if(!t)break;s+=t.length,r++}else s++;else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(e,t){{const n=t.data,i=t.pts;if(void 0===i)return void this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");const r=n.length;let s,a=0,o=0;while(o<r&&(s=ts(e,n,o,i,a++))>0)o+=s}}parseID3PES(e,t){if(void 0===t.pts)return void this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");const n=p({},t,{type:this._videoTrack?Ur.emsg:Ur.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function fs(e,t){return((31&e[t+1])<<8)+e[t+2]}function ps(e,t){return(31&e[t+10])<<8|e[t+11]}function gs(e,t,n,i,r,s){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(15&e[t+1])<<8|e[t+2],u=t+3+o-4,l=(15&e[t+10])<<8|e[t+11];t+=12+l;while(t<u){const o=fs(e,t),u=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 207:if(!i){vs("ADTS AAC",s);break}case 15:-1===a.audioPid&&(a.audioPid=o);break;case 21:-1===a.id3Pid&&(a.id3Pid=o);break;case 219:if(!i){vs("H.264",s);break}case 27:-1===a.videoPid&&(a.videoPid=o);break;case 3:case 4:n.mpeg||n.mp3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="mp3"):s.log("MPEG audio found, not supported in this browser");break;case 193:if(!i){vs("AC-3",s);break}case 129:n.ac3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="ac3"):s.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===a.audioPid&&u>0){let i=t+5,r=u;while(r>2){const t=e[i];switch(t){case 106:!0!==n.ac3?s.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=o,a.segmentAudioCodec="ac3");break}const u=e[i+1]+2;i+=u,r-=u}}break;case 194:case 135:return ms(r,new Error("Unsupported EC-3 in M2TS found"),void 0,s),a;case 36:-1===a.videoPid&&(a.videoPid=o,a.segmentVideoCodec="hevc",s.log("HEVC in M2TS found"));break}t+=u+5}return a}function ms(e,t,n,i){i.warn(`parsing error: ${t.message}`),e.emit(u.ERROR,u.ERROR,{type:a.MEDIA_ERROR,details:o.FRAG_PARSING_ERROR,fatal:!1,levelRetry:n,error:t,reason:t.message})}function vs(e,t){t.log(`${e} with AES-128-CBC encryption found in unencrypted stream`)}function ys(e,t){let n,i,r,s,a,o=0;const u=e.data;if(!e||0===e.size)return null;while(u[0].length<19&&u.length>1)u[0]=ve(u[0],u[1]),u.splice(1,1);n=u[0];const l=(n[0]<<16)+(n[1]<<8)+n[2];if(1===l){if(i=(n[4]<<8)+n[5],i&&i>e.size-6)return null;const l=n[7];192&l&&(s=536870912*(14&n[9])+4194304*(255&n[10])+16384*(254&n[11])+128*(255&n[12])+(254&n[13])/2,64&l?(a=536870912*(14&n[14])+4194304*(255&n[15])+16384*(254&n[16])+128*(255&n[17])+(254&n[18])/2,s-a>54e5&&(t.warn(`${Math.round((s-a)/9e4)}s delta between PTS and DTS, align them`),s=a)):a=s),r=n[8];let c=r+9;if(e.size<=c)return null;e.size-=c;const d=new Uint8Array(e.size);for(let e=0,t=u.length;e<t;e++){n=u[e];let t=n.byteLength;if(c){if(c>t){c-=t;continue}n=n.subarray(c),t-=c,c=0}d.set(n,o),o+=t}return i&&(i-=r+3),{data:d,pts:s,dts:a,len:i}}return null}class bs{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Ts=Math.pow(2,32)-1;class Ss{static init(){let e;for(e in Ss.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},Ss.types)Ss.types.hasOwnProperty(e)&&(Ss.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Ss.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);Ss.STTS=Ss.STSC=Ss.STCO=r,Ss.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Ss.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Ss.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Ss.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const s=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);Ss.FTYP=Ss.box(Ss.types.ftyp,s,o,s,a),Ss.DINF=Ss.box(Ss.types.dinf,Ss.box(Ss.types.dref,i))}static box(e,...t){let n=8,i=t.length;const r=i;while(i--)n+=t[i].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=255&n,s.set(e,4),i=0,n=8;i<r;i++)s.set(t[i],n),n+=t[i].byteLength;return s}static hdlr(e){return Ss.box(Ss.types.hdlr,Ss.HDLR_TYPES[e])}static mdat(e){return Ss.box(Ss.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(Ts+1)),i=Math.floor(t%(Ts+1));return Ss.box(Ss.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}static mdia(e){return Ss.box(Ss.types.mdia,Ss.mdhd(e.timescale||0,e.duration||0),Ss.hdlr(e.type),Ss.minf(e))}static mfhd(e){return Ss.box(Ss.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?Ss.box(Ss.types.minf,Ss.box(Ss.types.smhd,Ss.SMHD),Ss.DINF,Ss.stbl(e)):Ss.box(Ss.types.minf,Ss.box(Ss.types.vmhd,Ss.VMHD),Ss.DINF,Ss.stbl(e))}static moof(e,t,n){return Ss.box(Ss.types.moof,Ss.mfhd(e),Ss.traf(n,t))}static moov(e){let t=e.length;const n=[];while(t--)n[t]=Ss.trak(e[t]);return Ss.box.apply(null,[Ss.types.moov,Ss.mvhd(e[0].timescale||0,e[0].duration||0)].concat(n).concat(Ss.mvex(e)))}static mvex(e){let t=e.length;const n=[];while(t--)n[t]=Ss.trex(e[t]);return Ss.box.apply(null,[Ss.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(Ts+1)),i=Math.floor(t%(Ts+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Ss.box(Ss.types.mvhd,r)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,r;for(i=0;i<t.length;i++)r=t[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return Ss.box(Ss.types.sdtp,n)}static stbl(e){return Ss.box(Ss.types.stbl,Ss.stsd(e),Ss.box(Ss.types.stts,Ss.STTS),Ss.box(Ss.types.stsc,Ss.STSC),Ss.box(Ss.types.stsz,Ss.STSZ),Ss.box(Ss.types.stco,Ss.STCO))}static avc1(e){let t,n,i,r=[],s=[];for(t=0;t<e.sps.length;t++)n=e.sps[t],i=n.byteLength,r.push(i>>>8&255),r.push(255&i),r=r.concat(Array.prototype.slice.call(n));for(t=0;t<e.pps.length;t++)n=e.pps[t],i=n.byteLength,s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(n));const a=Ss.box(Ss.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|e.sps.length].concat(r).concat([e.pps.length]).concat(s))),o=e.width,u=e.height,l=e.pixelRatio[0],c=e.pixelRatio[1];return Ss.box(Ss.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,Ss.box(Ss.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Ss.box(Ss.types.pasp,new Uint8Array([l>>24,l>>16&255,l>>8&255,255&l,c>>24,c>>16&255,c>>8&255,255&c])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,255&t,0,0])}static mp4a(e){return Ss.box(Ss.types.mp4a,Ss.audioStsd(e),Ss.box(Ss.types.esds,Ss.esds(e)))}static mp3(e){return Ss.box(Ss.types[".mp3"],Ss.audioStsd(e))}static ac3(e){return Ss.box(Ss.types["ac-3"],Ss.audioStsd(e),Ss.box(Ss.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if("audio"===e.type){if("aac"===t)return Ss.box(Ss.types.stsd,Ss.STSD,Ss.mp4a(e));if("ac3"===t&&e.config)return Ss.box(Ss.types.stsd,Ss.STSD,Ss.ac3(e));if("mp3"===t&&"mp3"===e.codec)return Ss.box(Ss.types.stsd,Ss.STSD,Ss.mp3(e))}else{if(!e.pps||!e.sps)throw new Error("video track missing pps or sps");if("avc"===t)return Ss.box(Ss.types.stsd,Ss.STSD,Ss.avc1(e));if("hevc"===t&&e.vps)return Ss.box(Ss.types.stsd,Ss.STSD,Ss.hvc1(e))}throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,n=(e.duration||0)*(e.timescale||0),i=e.width||0,r=e.height||0,s=Math.floor(n/(Ts+1)),a=Math.floor(n%(Ts+1));return Ss.box(Ss.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,r>>8&255,255&r,0,0]))}static traf(e,t){const n=Ss.sdtp(e),i=e.id,r=Math.floor(t/(Ts+1)),s=Math.floor(t%(Ts+1));return Ss.box(Ss.types.traf,Ss.box(Ss.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),Ss.box(Ss.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s])),Ss.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,Ss.box(Ss.types.trak,Ss.tkhd(e),Ss.mdia(e))}static trex(e){const t=e.id;return Ss.box(Ss.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,r=12+16*i,s=new Uint8Array(r);let a,o,u,l,c,d;for(t+=8+r,s.set(["video"===e.type?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,255&i,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),a=0;a<i;a++)o=n[a],u=o.duration,l=o.size,c=o.flags,d=o.cts,s.set([u>>>24&255,u>>>16&255,u>>>8&255,255&u,l>>>24&255,l>>>16&255,l>>>8&255,255&l,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,61440&c.degradPrio,15&c.degradPrio,d>>>24&255,d>>>16&255,d>>>8&255,255&d],12+16*a);return Ss.box(Ss.types.trun,s)}static initSegment(e){Ss.types||Ss.init();const t=Ss.moov(e),n=ve(Ss.FTYP,t);return n}static hvc1(e){const t=e.params,n=[e.vps,e.sps,e.pps],i=4,r=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),i-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),n.length]);let s=r.length;for(let f=0;f<n.length;f+=1){s+=3;for(let e=0;e<n[f].length;e+=1)s+=2+n[f][e].length}const a=new Uint8Array(s);a.set(r,0),s=r.length;const o=n.length-1;for(let f=0;f<n.length;f+=1){a.set(new Uint8Array([32+f|(f===o?128:0),0,n[f].length]),s),s+=3;for(let e=0;e<n[f].length;e+=1)a.set(new Uint8Array([n[f][e].length>>8,255&n[f][e].length]),s),s+=2,a.set(n[f][e],s),s+=n[f][e].length}const u=Ss.box(Ss.types.hvcC,a),l=e.width,c=e.height,d=e.pixelRatio[0],h=e.pixelRatio[1];return Ss.box(Ss.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,Ss.box(Ss.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Ss.box(Ss.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,255&d,h>>24,h>>16&255,h>>8&255,255&h])))}}Ss.types=void 0,Ss.HDLR_TYPES=void 0,Ss.STTS=void 0,Ss.STSC=void 0,Ss.STCO=void 0,Ss.STSZ=void 0,Ss.VMHD=void 0,Ss.SMHD=void 0,Ss.STSD=void 0,Ss.FTYP=void 0,Ss.DINF=void 0;const Es=9e4;function ws(e,t,n=1,i=!1){const r=e*t*n;return i?Math.round(r):r}function As(e,t,n=1,i=!1){return ws(e,t,1/n,i)}function xs(e,t=!1){return ws(e,1e3,1/Es,t)}function Is(e,t=1){return ws(e,Es,1/t)}const ks=1e4,Ls=1024,Rs=1152,Cs=1536;let Ds,Ms=null,Ps=null;function _s(e,t,n,i){return{duration:t,size:n,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class Os{constructor(e,t,n,i){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=i,this.ISGenerated=!1,null===Ms){const e=navigator.userAgent||"",t=e.match(/Chrome\/(\d+)/i);Ms=t?parseInt(t[1]):0}if(null===Ps){const e=navigator.userAgent.match(/Safari\/(\d+)/i);Ps=e?parseInt(e[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,i=e.reduce(((e,i)=>{let r=i.pts,s=r-e;return s<-4294967296&&(t=!0,r=Ns(r,n),s=r-e),s>0?e:r}),n);return t&&this.logger.debug("PTS rollover detected"),i}remux(e,t,n,i,r,s,a,o){let u,l,d,h,f,p,g=r,m=r;const v=e.pid>-1,y=t.pid>-1,b=t.samples.length,T=e.samples.length>0,S=a&&b>0||b>1,E=(!v||T)&&(!y||S)||this.ISGenerated||a;if(E){if(this.ISGenerated){var w,A,x,I;const e=this.videoTrackConfig;(e&&(t.width!==e.width||t.height!==e.height||(null==(w=t.pixelRatio)?void 0:w[0])!==(null==(A=e.pixelRatio)?void 0:A[0])||(null==(x=t.pixelRatio)?void 0:x[1])!==(null==(I=e.pixelRatio)?void 0:I[1]))||!e&&S||null===this.nextAudioPts&&T)&&this.resetInitSegment()}this.ISGenerated||(d=this.generateIS(e,t,r,s));const n=this.isVideoContiguous;let i,a=-1;if(S&&(a=Us(t.samples),!n&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,a>0){this.logger.warn(`[mp4-remuxer]: Dropped ${a} out of ${b} video samples due to a missing keyframe`);const e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(a),t.dropped+=a,m+=(t.samples[0].pts-e)/t.inputTimeScale,i=m}else-1===a&&(this.logger.warn(`[mp4-remuxer]: No keyframe found out of ${b} video samples`),p=!1);if(this.ISGenerated){if(T&&S){const n=this.getVideoStartPts(t.samples),i=Ns(e.samples[0].pts,n)-n,r=i/t.inputTimeScale;g+=Math.max(0,r),m+=Math.max(0,-r)}if(T){if(e.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,t,r,s)),l=this.remuxAudio(e,g,this.isAudioContiguous,s,y||S||o===c.AUDIO?m:void 0),S){const i=l?l.endPTS-l.startPTS:0;t.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,t,r,s)),u=this.remuxVideo(t,m,n,i)}}else S&&(u=this.remuxVideo(t,m,n,0));u&&(u.firstKeyFrame=a,u.independent=-1!==a,u.firstKeyFramePTS=i)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(f=Fs(n,r,this._initPTS,this._initDTS)),i.samples.length&&(h=Bs(i,r,this._initPTS))),{audio:l,video:u,initSegment:d,independent:p,text:h,id3:f}}generateIS(e,t,n,i){const r=e.samples,s=t.samples,a=this.typeSupported,o={},u=this._initPTS;let l,c,d,h=!u||i,f="audio/mp4";if(h&&(l=c=1/0),e.config&&r.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(f="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}o.audio={id:"audio",container:f,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&a.mpeg?new Uint8Array(0):Ss.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(d=e.inputTimeScale,u&&d===u.timescale?h=!1:l=c=r[0].pts-Math.round(d*n))}if(t.sps&&t.pps&&s.length){if(t.timescale=t.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Ss.initSegment([t]),metadata:{width:t.width,height:t.height}},h)if(d=t.inputTimeScale,u&&d===u.timescale)h=!1;else{const e=this.getVideoStartPts(s),t=Math.round(d*n);c=Math.min(c,Ns(s[0].dts,e)-t),l=Math.min(l,e-t)}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(o).length)return this.ISGenerated=!0,h?(this._initPTS={baseTime:l,timescale:d},this._initDTS={baseTime:c,timescale:d}):l=d=void 0,{tracks:o,initPTS:l,timescale:d}}remuxVideo(e,t,n,i){const r=e.inputTimeScale,s=e.samples,l=[],c=s.length,d=this._initPTS;let h,f,g=this.nextAvcDts,m=8,v=this.videoSampleDuration,y=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,T=!1;if(!n||null===g){const e=t*r,i=s[0].pts-Ns(s[0].dts,s[0].pts);Ms&&null!==g&&Math.abs(e-i-g)<15e3?n=!0:g=e-i}const S=d.baseTime*r/d.timescale;for(let a=0;a<c;a++){const e=s[a];e.pts=Ns(e.pts-S,g),e.dts=Ns(e.dts-S,g),e.dts<s[a>0?a-1:a].dts&&(T=!0)}T&&s.sort((function(e,t){const n=e.dts-t.dts,i=e.pts-t.pts;return n||i})),h=s[0].dts,f=s[s.length-1].dts;const E=f-h,w=E?Math.round(E/(c-1)):v||e.inputTimeScale/30;if(n){const n=h-g,i=n>w,r=n<-1;if((i||r)&&(i?this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${xs(n,!0)} ms (${n}dts) hole between fragments detected at ${t.toFixed(3)}`):this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${xs(-n,!0)} ms (${n}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!r||g>=s[0].pts||Ms)){h=g;const e=s[0].pts-n;if(i)s[0].dts=h,s[0].pts=e;else{let t=!0;for(let i=0;i<s.length;i++){if(s[i].dts>e&&t)break;const r=s[i].pts;if(s[i].dts-=n,s[i].pts-=n,i<s.length-1){const e=s[i+1].pts,n=s[i].pts,a=e<=n,o=e<=r;t=a==o}}}this.logger.log(`Video: Initial PTS/DTS adjusted: ${xs(e,!0)}/${xs(h,!0)}, delta: ${xs(n,!0)} ms`)}}h=Math.max(0,h);let A=0,x=0,I=h;for(let a=0;a<c;a++){const e=s[a],t=e.units,n=t.length;let i=0;for(let r=0;r<n;r++)i+=t[r].data.length;x+=i,A+=n,e.length=i,e.dts<I?(e.dts=I,I+=w/4|0||1):I=e.dts,y=Math.min(e.pts,y),b=Math.max(e.pts,b)}f=s[c-1].dts;const k=x+4*A+8;let L;try{L=new Uint8Array(k)}catch(F){return void this.observer.emit(u.ERROR,u.ERROR,{type:a.MUX_ERROR,details:o.REMUX_ALLOC_ERROR,fatal:!1,error:F,bytes:k,reason:`fail allocating video mdat ${k}`})}const R=new DataView(L.buffer);R.setUint32(0,k),L.set(Ss.types.mdat,4);let C=!1,D=Number.POSITIVE_INFINITY,M=Number.POSITIVE_INFINITY,P=Number.NEGATIVE_INFINITY,_=Number.NEGATIVE_INFINITY;for(let a=0;a<c;a++){const e=s[a],t=e.units;let n,o=0;for(let i=0,r=t.length;i<r;i++){const e=t[i],n=e.data,r=e.data.byteLength;R.setUint32(m,r),m+=4,L.set(n,m),m+=r,o+=4+r}if(a<c-1)v=s[a+1].dts-e.dts,n=s[a+1].pts-e.pts;else{const t=this.config,o=a>0?e.dts-s[a-1].dts:w;if(n=a>0?e.pts-s[a-1].pts:w,t.stretchShortVideoTrack&&null!==this.nextAudioPts){const n=Math.floor(t.maxBufferHole*r),s=(i?y+i*r:this.nextAudioPts)-e.pts;s>n?(v=s-o,v<0?v=o:C=!0,this.logger.log(`[mp4-remuxer]: It is approximately ${s/90} ms to the next segment; using duration ${v/90} ms for the last video frame.`)):v=o}else v=o}const u=Math.round(e.pts-e.dts);D=Math.min(D,v),P=Math.max(P,v),M=Math.min(M,n),_=Math.max(_,n),l.push(_s(e.key,v,o,u))}if(l.length)if(Ms){if(Ms<70){const e=l[0].flags;e.dependsOn=2,e.isNonSync=0}}else if(Ps&&_-M<P-D&&w/P<.025&&0===l[0].cts){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let e=h;for(let t=0,n=l.length;t<n;t++){const i=e+l[t].duration,r=e+l[t].cts;if(t<n-1){const e=i+l[t+1].cts;l[t].duration=e-r}else l[t].duration=t?l[t-1].duration:w;l[t].cts=0,e=i}}v=C||!v?w:v,this.nextAvcDts=g=f+v,this.videoSampleDuration=v,this.isVideoContiguous=!0;const O=Ss.moof(e.sequenceNumber++,h,p(e,{samples:l})),N="video",U={data1:O,data2:L,startPTS:y/r,endPTS:(b+v)/r,startDTS:h/r,endDTS:g/r,type:N,hasAudio:!1,hasVideo:!0,nb:l.length,dropped:e.dropped};return e.samples=[],e.dropped=0,U}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return Rs;case"ac3":return Cs;default:return Ls}}remuxAudio(e,t,n,i,r){const s=e.inputTimeScale,l=e.samplerate?e.samplerate:s,c=s/l,d=this.getSamplesPerFrame(e),h=d*c,f=this._initPTS,g="mp3"===e.segmentCodec&&this.typeSupported.mpeg,m=[],v=void 0!==r;let y=e.samples,b=g?0:8,T=this.nextAudioPts||-1;const S=t*s,E=f.baseTime*s/f.timescale;if(this.isAudioContiguous=n=n||y.length&&T>0&&(i&&Math.abs(S-T)<9e3||Math.abs(Ns(y[0].pts-E,S)-T)<20*h),y.forEach((function(e){e.pts=Ns(e.pts-E,S)})),!n||T<0){if(y=y.filter((e=>e.pts>=0)),!y.length)return;T=0===r?0:i&&!v?Math.max(0,S):y[0].pts}if("aac"===e.segmentCodec){const t=this.config.maxAudioFramesDrift;for(let n=0,i=T;n<y.length;n++){const r=y[n],a=r.pts,o=a-i,u=Math.abs(1e3*o/s);if(o<=-t*h&&v)0===n&&(this.logger.warn(`Audio frame @ ${(a/s).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*o/s)} ms.`),this.nextAudioPts=T=i=a);else if(o>=t*h&&u<ks&&v){let t=Math.round(o/h);i=a-t*h,i<0&&(t--,i+=h),0===n&&(this.nextAudioPts=T=i),this.logger.warn(`[mp4-remuxer]: Injecting ${t} audio frame @ ${(i/s).toFixed(3)}s due to ${Math.round(1e3*o/s)} ms gap.`);for(let s=0;s<t;s++){const t=Math.max(i,0);let s=bs.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);s||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),s=r.unit.subarray()),y.splice(n,0,{unit:s,pts:t}),i+=h,n++}}r.pts=i,i+=h}}let w,A=null,x=null,I=0,k=y.length;while(k--)I+=y[k].unit.byteLength;for(let p=0,N=y.length;p<N;p++){const t=y[p],i=t.unit;let r=t.pts;if(null!==x){const e=m[p-1];e.duration=Math.round((r-x)/c)}else{if(n&&"aac"===e.segmentCodec&&(r=T),A=r,!(I>0))return;I+=b;try{w=new Uint8Array(I)}catch(O){return void this.observer.emit(u.ERROR,u.ERROR,{type:a.MUX_ERROR,details:o.REMUX_ALLOC_ERROR,fatal:!1,error:O,bytes:I,reason:`fail allocating audio mdat ${I}`})}if(!g){const e=new DataView(w.buffer);e.setUint32(0,I),w.set(Ss.types.mdat,4)}}w.set(i,b);const s=i.byteLength;b+=s,m.push(_s(!0,d,s,0)),x=r}const L=m.length;if(!L)return;const R=m[m.length-1];this.nextAudioPts=T=x+c*R.duration;const C=g?new Uint8Array(0):Ss.moof(e.sequenceNumber++,A/c,p({},e,{samples:m}));e.samples=[];const D=A/s,M=T/s,P="audio",_={data1:C,data2:w,startPTS:D,endPTS:M,startDTS:D,endDTS:M,type:P,hasAudio:!0,hasVideo:!1,nb:L};return this.isAudioContiguous=!0,_}}function Ns(e,t){let n;if(null===t)return e;n=t<e?-8589934592:8589934592;while(Math.abs(e-t)>4294967296)e+=n;return e}function Us(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}function Fs(e,t,n,i){const r=e.samples.length;if(!r)return;const s=e.inputTimeScale;for(let o=0;o<r;o++){const r=e.samples[o];r.pts=Ns(r.pts-n.baseTime*s/n.timescale,t*s)/s,r.dts=Ns(r.dts-i.baseTime*s/i.timescale,t*s)/s}const a=e.samples;return e.samples=[],{samples:a}}function Bs(e,t,n){const i=e.samples.length;if(!i)return;const r=e.inputTimeScale;for(let a=0;a<i;a++){const i=e.samples[a];i.pts=Ns(i.pts-n.baseTime*r/n.timescale,t*r)/r}e.samples.sort(((e,t)=>e.pts-t.pts));const s=e.samples;return e.samples=[],{samples:s}}class js{constructor(e,t,n,i){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.logger=i}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(ce(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const i=this.initData=re(e);i.audio&&(t=Gs(i.audio,B.AUDIO)),i.video&&(n=Gs(i.video,B.VIDEO));const r={};i.audio&&i.video?r.audiovideo={container:"video/mp4",codec:t+","+n,supplemental:i.video.supplemental,initSegment:e,id:"main"}:i.audio?r.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?r.video={container:"video/mp4",codec:n,supplemental:i.video.supplemental,initSegment:e,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(e,t,n,r,s,a){var o,u;let{initPTS:l,lastEndTime:c}=this;const d={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};i(c)||(c=this.lastEndTime=s||0);const h=t.samples;if(null==h||!h.length)return d;const f={initPTS:void 0,timescale:1};let p=this.initData;if(null!=(o=p)&&o.length||(this.generateInitSegment(h),p=this.initData),null==(u=p)||!u.length)return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(f.tracks=this.initTracks,this.emitInitSegment=!1);const g=fe(h,p),m=he(p,h),v=null===m?s:m;!a&&l||!$s(l,v,s,g)&&f.timescale===l.timescale||(f.initPTS=v-s,l&&1===l.timescale&&this.logger.warn(`Adjusting initPTS @${s} from ${l.baseTime/l.timescale} to ${f.initPTS}`),this.initPTS=l={baseTime:f.initPTS,timescale:1});const y=e?v-l.baseTime/l.timescale:c,b=y+g;ge(p,h,l.baseTime/l.timescale),g>0?this.lastEndTime=b:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const T=!!p.audio,S=!!p.video;let E="";T&&(E+="audio"),S&&(E+="video");const w={data1:h,startPTS:y,startDTS:y,endPTS:b,endDTS:b,type:E,hasAudio:T,hasVideo:S,nb:1,dropped:0};return d.audio="audio"===w.type?w:void 0,d.video="audio"!==w.type?w:void 0,d.initSegment=f,d.id3=Fs(n,s,l,l),r.samples.length&&(d.text=Bs(r,s,l)),d}}function $s(e,t,n,i){if(null===e)return!0;const r=Math.max(i,1),s=t-e.baseTime/e.timescale;return Math.abs(s-n)>r}function Gs(e,t){const n=null==e?void 0:e.codec;if(n&&n.length>4)return n;if(t===B.AUDIO){if("ec-3"===n||"ac-3"===n||"alac"===n)return n;if("fLaC"===n||"Opus"===n){const e=!1;return Be(n,e)}return k.warn(`Unhandled audio codec "${n}" in mp4 MAP`),n||"mp4a"}return k.warn(`Unhandled video codec "${n}" in mp4 MAP`),n||"avc1"}try{Ds=self.performance.now.bind(self.performance)}catch(ql){Ds=Date.now}const Vs=[{demux:rs,remux:js},{demux:hs,remux:Os},{demux:Jr,remux:Os},{demux:ns,remux:Os}];Vs.splice(2,0,{demux:es,remux:Os});class Hs{constructor(e,t,n,i,r,s){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.id=r,this.logger=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const r=n.transmuxing;r.executeStart=Ds();let s=new Uint8Array(e);const{currentTransmuxState:l,transmuxConfig:c}=this;i&&(this.currentTransmuxState=i);const{contiguous:d,discontinuity:h,trackSwitch:f,accurateTimeOffset:p,timeOffset:g,initSegmentChange:m}=i||l,{audioCodec:v,videoCodec:y,defaultInitPts:b,duration:T,initSegmentData:S}=c,E=Ks(s,t);if(E&&Ln(E.method)){const e=this.getDecrypter(),t=Rn(E.method);if(!e.isSync())return this.asyncResult=!0,this.decryptionPromise=e.webCryptoDecrypt(s,E.key.buffer,E.iv.buffer,t).then((e=>{const t=this.push(e,null,n);return this.decryptionPromise=null,t})),this.decryptionPromise;{let i=e.softwareDecrypt(s,E.key.buffer,E.iv.buffer,t);const a=n.part>-1;if(a){const t=e.flush();i=t?t.buffer:t}if(!i)return r.executeEnd=Ds(),Ws(n);s=new Uint8Array(i)}}const w=this.needsProbing(h,f);if(w){const e=this.configureTransmuxer(s);if(e)return this.logger.warn(`[transmuxer] ${e.message}`),this.observer.emit(u.ERROR,u.ERROR,{type:a.MEDIA_ERROR,details:o.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),r.executeEnd=Ds(),Ws(n)}(h||f||m||w)&&this.resetInitSegment(S,v,y,T,t),(h||m||w)&&this.resetInitialTimestamp(b),d||this.resetContiguity();const A=this.transmux(s,E,g,p,n);this.asyncResult=qs(A);const x=this.currentTransmuxState;return x.contiguous=!0,x.discontinuity=!1,x.trackSwitch=!1,r.executeEnd=Ds(),A}flush(e){const t=e.transmuxing;t.executeStart=Ds();const{decrypter:n,currentTransmuxState:i,decryptionPromise:r}=this;if(r)return this.asyncResult=!0,r.then((()=>this.flush(e)));const s=[],{timeOffset:a}=i;if(n){const t=n.flush();t&&s.push(this.push(t.buffer,null,e))}const{demuxer:o,remuxer:u}=this;if(!o||!u){t.executeEnd=Ds();const n=[Ws(e)];return this.asyncResult?Promise.resolve(n):n}const l=o.flush(a);return qs(l)?(this.asyncResult=!0,l.then((t=>(this.flushRemux(s,t,e),s)))):(this.flushRemux(s,l,e),this.asyncResult?Promise.resolve(s):s)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:r,id3Track:s,textTrack:a}=t,{accurateTimeOffset:o,timeOffset:u}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${n.sn}${n.part>-1?" part: "+n.part:""} of ${this.id===c.MAIN?"level":"track"} ${n.level}`);const l=this.remuxer.remux(i,r,s,a,u,o,!0,this.id);e.push({remuxResult:l,chunkMeta:n}),n.transmuxing.executeEnd=Ds()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;t&&n&&(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,r){const{demuxer:s,remuxer:a}=this;s&&a&&(s.resetInitSegment(e,t,n,i),a.resetInitSegment(e,t,n,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,r){let s;return s=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,n,i,r):this.transmuxUnencrypted(e,n,i,r),s}transmuxUnencrypted(e,t,n,i){const{audioTrack:r,videoTrack:s,id3Track:a,textTrack:o}=this.demuxer.demux(e,t,!1,!this.config.progressive),u=this.remuxer.remux(r,s,a,o,t,n,!1,this.id);return{remuxResult:u,chunkMeta:i}}transmuxSampleAes(e,t,n,i,r){return this.demuxer.demuxSampleAes(e,t,n).then((e=>{const t=this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,n,i,!1,this.id);return{remuxResult:t,chunkMeta:r}}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i}=this;let r;for(let c=0,d=Vs.length;c<d;c++){var s;if(null!=(s=Vs[c].demux)&&s.probe(e,this.logger)){r=Vs[c];break}}if(!r)return new Error("Failed to find demuxer by probing fragment data");const a=this.demuxer,o=this.remuxer,u=r.remux,l=r.demux;o&&o instanceof u||(this.remuxer=new u(n,t,i,this.logger)),a&&a instanceof l||(this.demuxer=new l(n,t,i,this.logger),this.probe=l.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new tn(this.config)),e}}function Ks(e,t){let n=null;return e.byteLength>0&&null!=(null==t?void 0:t.key)&&null!==t.iv&&null!=t.method&&(n=t),n}const Ws=e=>({remuxResult:{},chunkMeta:e});function qs(e){return"then"in e&&e.then instanceof Function}class Ys{constructor(e,t,n,i,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=r||null}}class Xs{constructor(e,t,n,i,r,s){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=r,this.initSegmentChange=s}}let zs=0;class Qs{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=zs++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=e=>{const t=e.data,n=this.hls;if(n&&null!=t&&t.event&&t.instanceNo===this.instanceNo)switch(t.event){case"init":{var i;const e=null==(i=this.workerContext)?void 0:i.objectURL;e&&self.URL.revokeObjectURL(e);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":n.logger[t.data.logType]&&n.logger[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.part=this.part,t.data.id=this.id,n.trigger(t.event,t.data);break}},this.onWorkerError=e=>{if(!this.hls)return;const t=new Error(`${e.message}  (${e.filename}:${e.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:t})};const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const s=(e,t)=>{t=t||{},t.frag=this.frag||void 0,e===u.ERROR&&(t.parent=this.id,t.part=this.part,this.error=t.error),this.hls.trigger(e,t)};this.observer=new Wi,this.observer.on(u.FRAG_DECRYPTED,s),this.observer.on(u.ERROR,s);const l=He(r.preferManagedMediaSource);if(this.useWorker&&"undefined"!==typeof Worker){const n=this.hls.logger,i=r.workerPath||Xi();if(i){try{r.workerPath?(n.log(`loading Web Worker ${r.workerPath} for "${t}"`),this.workerContext=Qi(r.workerPath)):(n.log(`injecting Web Worker for "${t}"`),this.workerContext=zi());const{worker:e}=this.workerContext;e.addEventListener("message",this.onWorkerMessage),e.addEventListener("error",this.onWorkerError),e.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:l,id:t,config:ct(r)})}catch(ql){n.warn(`Error setting up "${t}" Web Worker, fallback to inline`,ql),this.terminateWorker(),this.error=null,this.transmuxer=new Hs(this.observer,l,r,"",t,e.logger)}return}}this.transmuxer=new Hs(this.observer,l,r,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=zs++;const t=this.hls.config,n=He(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:n,id:this.id,config:ct(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),Ji(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,n,i,r,s,a,o,u,l){var d,h;u.transmuxing.start=self.performance.now();const{instanceNo:f,transmuxer:p}=this,g=s?s.start:r.start,m=r.decryptdata,v=this.frag,y=!(v&&r.cc===v.cc),b=!(v&&u.level===v.level),T=v?u.sn-v.sn:-1,S=this.part?u.part-this.part.index:-1,E=0===T&&u.id>1&&u.id===(null==v?void 0:v.stats.chunkCount),w=!b&&(1===T||0===T&&(1===S||E&&S<=0)),A=self.performance.now();(b||T||0===r.stats.parsing.start)&&(r.stats.parsing.start=A),!s||!S&&w||(s.stats.parsing.start=A);const x=!(v&&(null==(d=r.initSegment)?void 0:d.url)===(null==(h=v.initSegment)?void 0:h.url)),I=new Xs(y,w,o,b,g,x);if(!w||y||x){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${r.type} sn: ${u.sn}${u.part>-1?" part: "+u.part:""} ${this.id===c.MAIN?"level":"track"}: ${u.level} id: ${u.id}\n        discontinuity: ${y}\n        trackSwitch: ${b}\n        contiguous: ${w}\n        accurateTimeOffset: ${o}\n        timeOffset: ${g}\n        initSegmentChange: ${x}`);const e=new Ys(n,i,t,a,l);this.configureTransmuxer(e)}if(this.frag=r,this.part=s,this.workerContext)this.workerContext.worker.postMessage({instanceNo:f,cmd:"demux",data:e,decryptdata:m,chunkMeta:u,state:I},e instanceof ArrayBuffer?[e]:[]);else if(p){const t=p.push(e,m,u,I);qs(t)?t.then((e=>{this.handleTransmuxComplete(e)})).catch((e=>{this.transmuxerError(e,u,"transmuxer-interface push error")})):this.handleTransmuxComplete(t)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(n){const t=n.flush(e);qs(t)?t.then((t=>{this.handleFlushResult(t,e)})).catch((t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")})):this.handleFlushResult(t,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach((e=>{this.handleTransmuxComplete(e)})),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):n&&n.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const Js=100;class Zs extends Fi{constructor(e,t,n){super(e,t,n,"audio-stream-controller",c.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(u.LEVEL_LOADED,this.onLevelLoaded,this),e.on(u.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(u.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(u.BUFFER_RESET,this.onBufferReset,this),e.on(u.BUFFER_CREATED,this.onBufferCreated,this),e.on(u.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(u.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(u.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(u.FRAG_LOADING,this.onFragLoading,this),e.on(u.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(u.LEVEL_LOADED,this.onLevelLoaded,this),e.off(u.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(u.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(u.BUFFER_RESET,this.onBufferReset,this),e.off(u.BUFFER_CREATED,this.onBufferCreated,this),e.off(u.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(u.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(u.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(u.FRAG_LOADING,this.onFragLoading,this),e.off(u.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r}){if(n===c.MAIN){const e=t.cc,n=this.fragCurrent;if(this.initPTS[e]={baseTime:i,timescale:r},this.log(`InitPTS for cc: ${e} found from main: ${i}/${r}`),this.mainAnchor=t,this.state===Ui.WAITING_INIT_PTS){const n=this.waitingData;(!n&&!this.loadingParts||n&&n.frag.cc!==e)&&(this.nextLoadPosition=this.findSyncFrag(t).start),this.tick()}else!this.hls.hasEnoughToStart&&n&&n.cc!==e?(this.startFragRequested=!1,this.nextLoadPosition=this.findSyncFrag(t).start,n.abortRequests(),this.resetLoadingState()):this.state===Ui.IDLE&&this.tick()}}findSyncFrag(e){const t=this.getLevelDetails(),n=e.cc;return Mt(t,n,e)||t&&Dt(t.fragments,n)||e}startLoad(e,t){if(!this.levels)return this.startPosition=e,void(this.state=Ui.STOPPED);const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(Js),n>0&&-1===e?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n,this.state=Ui.IDLE):this.state=Ui.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case Ui.IDLE:this.doTickIdle();break;case Ui.WAITING_TRACK:{const{levels:e,trackId:t}=this,n=null==e?void 0:e[t],i=null==n?void 0:n.details;if(i&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(i))break;this.state=Ui.WAITING_INIT_PTS}break}case Ui.FRAG_LOADING_WAITING_RETRY:{var e;const t=performance.now(),n=this.retryDate;if(!n||t>=n||null!=(e=this.media)&&e.seeking){const{levels:e,trackId:t}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((null==e?void 0:e[t])||null),this.state=Ui.IDLE}break}case Ui.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:i,complete:r}=e,s=this.mainAnchor;if(void 0!==this.initPTS[t.cc]){this.waitingData=null,this.state=Ui.FRAG_LOADING;const e=i.flush().buffer,s={frag:t,part:n,payload:e,networkDetails:null};this._handleFragmentLoadProgress(s),r&&super._handleFragmentLoadComplete(s)}else s&&s.cc!==e.frag.cc&&(this.log(`Waiting fragment cc (${t.cc}) cancelled because video is at cc ${s.cc}`),this.nextLoadPosition=this.findSyncFrag(s).start,this.clearWaitingFragment())}else this.state=Ui.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.state!==Ui.STOPPED&&(this.state=Ui.IDLE))}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:n,media:i,trackId:r}=this,s=t.config;if(!this.buffering||!i&&!this.primaryPrefetch&&(this.startFragRequested||!s.startFragPrefetch)||null==n||!n[r])return;const a=n[r],o=a.details;if(!o||this.waitForLive(a)||this.waitForCdnTuneIn(o))return this.state=Ui.WAITING_TRACK,void(this.startFragRequested=!1);const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,B.AUDIO,c.AUDIO));const d=this.getFwdBufferInfo(l,c.AUDIO);if(null===d)return;if(!this.switchingTrack&&this._streamEnded(d,o))return t.trigger(u.BUFFER_EOS,{type:"audio"}),void(this.state=Ui.ENDED);const h=d.len,f=t.maxBufferLength,p=o.fragments,g=p[0].start,m=this.getLoadPosition(),v=this.flushing?m:d.end;if(this.switchingTrack&&i){const e=m;o.PTSKnown&&e<g&&(d.end>g||d.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=g+.05)}if(h>=f&&!this.switchingTrack&&v<p[p.length-1].start)return;let y=this.getNextFragment(v,o);if(y&&this.isLoopLoading(y,v)&&(y=this.getNextFragmentLoopLoading(y,o,d,c.MAIN,f)),!y)return void(this.bufferFlushed=!0);let b=(null==(e=this.mainFragLoading)?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&b&&$(y)&&!y.endList&&(!o.live||!this.loadingParts&&v<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(b)===Vt.OK&&(this.mainFragLoading=b=null),b&&$(b))){if(y.start>b.end){const e=this.fragmentTracker.getFragAtPos(v,c.MAIN);e&&e.end>b.end&&(b=e,this.mainFragLoading={frag:e,targetBufferTime:null})}const e=y.start>b.end;if(e)return}this.loadFragment(y,a,v)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map((e=>new st(e)))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==Ui.STOPPED&&(this.setInterval(Js),this.state=Ui.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const n=this.cachedTrackLoadedData;n&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(u.AUDIO_TRACK_LOADED,n))}onAudioTrackLoaded(e,t){var n;const{levels:i}=this,{details:r,id:s,groupId:a,track:o}=t;if(!i)return void this.warn(`Audio tracks reset while loading track ${s} "${o.name}" of "${a}"`);const l=this.mainDetails;if(!l||r.endCC>l.endCC||l.expired)return this.cachedTrackLoadedData=t,void(this.state!==Ui.STOPPED&&(this.state=Ui.WAITING_TRACK));this.cachedTrackLoadedData=null,this.log(`Audio track ${s} "${o.name}" of "${a}" loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const c=i[s];let d=0;if(r.live||null!=(n=c.details)&&n.live){if(this.checkLiveUpdate(r),r.deltaUpdateFailed)return;var h;if(c.details)d=this.alignPlaylists(r,c.details,null==(h=this.levelLastLoaded)?void 0:h.details);r.alignedSliding||(_i(r,l),r.alignedSliding||Oi(r,l),d=r.fragmentStart)}c.details=r,this.levelLastLoaded=c,this.startFragRequested||this.setStartPosition(l,d),this.hls.trigger(u.AUDIO_TRACK_UPDATED,{details:r,id:s,groupId:t.groupId}),this.state!==Ui.WAITING_TRACK||this.waitForCdnTuneIn(r)||(this.state=Ui.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:i,payload:r}=e,{config:s,trackId:a,levels:o}=this;if(!o)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const u=o[a];if(!u)return void this.warn("Audio track is undefined on fragment load progress");const l=u.details;if(!l)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(n.start);const d=s.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let h=this.transmuxer;h||(h=this.transmuxer=new Qs(this.hls,c.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const f=this.initPTS[n.cc],p=null==(t=n.initSegment)?void 0:t.data;if(void 0!==f){const e=!1,t=i?i.index:-1,s=-1!==t,a=new cn(n.level,n.sn,n.stats.chunkCount,r.byteLength,t,s);h.push(r,p,d,"",n,i,l.totalduration,e,a,f)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${l.startSN} ,${l.endSN}],track ${a}`);const{cache:e}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new ji,complete:!1};e.push(new Uint8Array(r)),this.state!==Ui.STOPPED&&(this.state=Ui.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===c.MAIN&&$(t.frag)&&(this.mainFragLoading=t,this.state===Ui.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type===c.AUDIO)if(this.fragContextChanged(n))this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if($(n)){this.fragPrevious=n;const e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger(u.AUDIO_TRACK_SWITCHED,m({},e)))}this.fragBufferedComplete(n,i),this.media&&this.tick()}else this.audioOnly||n.type!==c.MAIN||n.elementaryStreams.video||n.elementaryStreams.audiovideo||(this.audioOnly=!0,this.mainFragLoading=null)}onError(e,t){var n;if(t.fatal)this.state=Ui.ERROR;else switch(t.details){case o.FRAG_GAP:case o.FRAG_PARSING_ERROR:case o.FRAG_DECRYPT_ERROR:case o.FRAG_LOAD_ERROR:case o.FRAG_LOAD_TIMEOUT:case o.KEY_LOAD_ERROR:case o.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(c.AUDIO,t);break;case o.AUDIO_TRACK_LOAD_ERROR:case o.AUDIO_TRACK_LOAD_TIMEOUT:case o.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Ui.WAITING_TRACK||(null==(n=t.context)?void 0:n.type)!==l.AUDIO_TRACK||(this.state=Ui.IDLE);break;case o.BUFFER_ADD_CODEC_ERROR:case o.BUFFER_APPEND_ERROR:if("audio"!==t.parent)return;this.resetLoadingState();break;case o.BUFFER_FULL_ERROR:if("audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case o.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==B.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==B.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===Ui.ENDED&&(this.state=Ui.IDLE);const e=this.mediaBuffer||this.media;e&&(this.afterBufferFlushed(e,t,c.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:r,chunkMeta:s}=e,a=this.getCurrentContext(s);if(!a)return void this.resetWhenMissingContext(s);const{frag:o,part:l,level:c}=a,{details:d}=c,{audio:h,text:f,id3:g,initSegment:m}=r;if(!this.fragContextChanged(o)&&d){if(this.state=Ui.PARSING,this.switchingTrack&&h&&this.completeAudioSwitch(this.switchingTrack),null!=m&&m.tracks){const e=o.initSegment||o;this._bufferInitSegment(c,m.tracks,e,s),i.trigger(u.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:m.tracks})}if(h){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=h;l&&(l.elementaryStreams[B.AUDIO]={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),o.setElementaryStreamInfo(B.AUDIO,e,t,n,i),this.bufferFragmentData(h,o,l,s)}if(null!=g&&null!=(t=g.samples)&&t.length){const e=p({id:n,frag:o,details:d},g);i.trigger(u.FRAG_PARSING_METADATA,e)}if(f){const e=p({id:n,frag:o,details:d},f);i.trigger(u.FRAG_PARSING_USERDATA,e)}}else this.fragmentTracker.removeFragment(o)}_bufferInitSegment(e,t,n,i){if(this.state!==Ui.PARSING)return;if(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio)return;const r=t.audio;r.id=c.AUDIO;const s=e.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${s}/${r.codec}]`),s&&1===s.split(",").length&&(r.levelCodec=s),this.hls.trigger(u.BUFFER_CODECS,t);const a=r.initSegment;if(null!=a&&a.byteLength){const e={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:a};this.hls.trigger(u.BUFFER_APPENDING,e)}this.tickImmediate()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);var r;if(this.switchingTrack||i===Vt.NOT_LOADED||i===Vt.PARTIAL)if($(e))if(null!=(r=t.details)&&r.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Ui.WAITING_INIT_PTS;const n=this.mainDetails;n&&n.fragmentStart!==t.details.fragmentStart&&Oi(t.details,n)}else super.loadFragment(e,t,n);else this._loadInitSegment(e,t);else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:i,characteristics:r,audioCodec:s,channels:a}=this.bufferedTrack;vt({name:t,lang:n,assocLang:i,characteristics:r,audioCodec:s,channels:a},e,Tt)||(wt(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(u.AUDIO_TRACK_SWITCHED,m({},e))}}class ea extends b{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const i=null==t?void 0:t.renditionReports;if(i){let s=-1;for(let n=0;n<i.length;n++){const a=i[n];let o;try{o=new self.URL(a.URI,t.url).href}catch(r){this.warn(`Could not construct new URL for Rendition Report: ${r}`),o=a.URI||""}if(o===e){s=n;break}o===e.substring(0,o.length)&&(s=n)}if(-1!==s){const e=i[s],r=parseInt(e["LAST-MSN"])||(null==t?void 0:t.lastPartSn);let a=parseInt(e["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const e=Math.min(t.age-t.partTarget,t.targetduration);a>=0&&e>t.partTarget&&(a+=1)}const o=n&&it(n);return new rt(r,a>=0?a:void 0,o)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(n){this.warn(`Could not construct new URL with HLS Delivery Directives: ${n}`)}return e}playlistLoaded(e,t,n){const{details:i,stats:r}=t,s=self.performance.now(),l=r.loading.first?Math.max(0,s-r.loading.first):0;i.advancedDateTime=Date.now()-l;const c=this.hls.config.timelineOffset;if(c!==i.appliedTimelineOffset){const e=Math.max(c||0,0);i.appliedTimelineOffset=e,i.fragments.forEach((t=>{t.start=t.playlistOffset+e}))}if(i.live||null!=n&&n.live){const c="levelInfo"in t?t.levelInfo:t.track;if(i.reloaded(n),n&&i.fragments.length>0){vi(n,i);const e=i.playlistParsingError;if(e){this.warn(e);const n=this.hls;if(!n.config.ignorePlaylistParsingErrors){var d;const{networkDetails:s}=t;return void n.trigger(u.ERROR,{type:a.NETWORK_ERROR,details:o.LEVEL_PARSING_ERROR,fatal:!1,url:i.url,error:e,reason:e.message,level:t.level||void 0,parent:null==(d=i.fragments[0])?void 0:d.type,networkDetails:s,stats:r})}i.playlistParsingError=null}}-1===i.requestScheduled&&(i.requestScheduled=r.loading.start);const h=this.hls.mainForwardBufferInfo,f=h?h.end-h.len:0,p=1e3*(i.edge-f),g=Ai(i,p);if(i.requestScheduled+g<s?i.requestScheduled=s:i.requestScheduled+=g,this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),!this.canLoad||!i.live)return;let m,v,y;if(i.canBlockReload&&i.endSN&&i.advanced){const e=this.hls.config.lowLatencyMode,r=i.lastPartSn,a=i.endSN,o=i.lastPartIndex,u=-1!==o,l=r===a;u?l?(v=a+1,y=e?0:o):(v=r,y=e?o+1:i.maxPartIndex):v=a+1;const d=i.age,h=d+i.ageHeader;let f=Math.min(h-i.partTarget,1.5*i.targetduration);if(f>0){if(h>3*i.targetduration)this.log(`Playlist last advanced ${d.toFixed(2)}s ago. Omitting segment and part directives.`),v=void 0,y=void 0;else if(null!=n&&n.tuneInGoal&&h-i.partTarget>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${f} with playlist age: ${i.age}`),f=0;else{const e=Math.floor(f/i.targetduration);if(v+=e,void 0!==y){const e=Math.round(f%i.targetduration/i.partTarget);y+=e}this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${d.toFixed(2)}s goal: ${f} skip sn ${e} to part ${y}`)}i.tuneInGoal=f}if(m=this.getDeliveryDirectives(i,t.deliveryDirectives,v,y),e||!l)return i.requestScheduled=s,void this.loadingPlaylist(c,m)}else(i.canBlockReload||i.canSkipUntil)&&(m=this.getDeliveryDirectives(i,t.deliveryDirectives,v,y));m&&void 0!==v&&i.canBlockReload&&(i.requestScheduled=r.loading.first+Math.max(g-2*l,g/2)),this.scheduleLoading(c,m,i)}else this.clearTimer()}scheduleLoading(e,t,n){const i=n||e.details;if(!i)return void this.loadingPlaylist(e,t);const r=self.performance.now(),s=i.requestScheduled;if(r>=s)return void this.loadingPlaylist(e,t);const a=s-r;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(a)} ms`),this.clearTimer(),this.timer=self.setTimeout((()=>this.loadingPlaylist(e,t)),a)}getDeliveryDirectives(e,t,n,i){let r=it(e);return null!=t&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,r=nt.No),new rt(n,i,r)}checkRetry(e){const t=e.details,n=Pt(e),i=e.errorAction,{action:r,retryCount:s=0,retryConfig:a}=i||{},o=!!i&&!!a&&(r===Bt.RetryRequest||!i.resolved&&r===Bt.SendAlternateToPenaltyBox);if(o){var u;if(s>=a.maxNumRetry)return!1;if(n&&null!=(u=e.context)&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${s+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const e=Ot(a,s);this.clearTimer(),this.timer=self.setTimeout((()=>this.loadPlaylist()),e),this.warn(`Retrying playlist loading ${s+1}/${a.maxNumRetry} after "${t}" in ${e}ms`)}e.levelRetry=!0,i.resolved=!0}return o}}function ta(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!na(e[n].attrs,t[n].attrs))return!1;return!0}function na(e,t,n){const i=e["STABLE-RENDITION-ID"];return i&&!n?i===t["STABLE-RENDITION-ID"]:!(n||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some((n=>e[n]!==t[n]))}function ia(e,t){return t.label.toLowerCase()===e.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(e.lang||"").toLowerCase())}class ra extends ea{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.MANIFEST_PARSED,this.onManifestParsed,this),e.on(u.LEVEL_LOADING,this.onLevelLoading,this),e.on(u.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(u.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(u.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.MANIFEST_PARSED,this.onManifestParsed,this),e.off(u.LEVEL_LOADING,this.onLevelLoading,this),e.off(u.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(u.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(u.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn(`Audio track with id:${n} and group:${i} not found in active group ${null==s?void 0:s.groupId}`);const a=s.details;s.details=t.details,this.log(`Audio track ${n} "${s.name}" lang:${s.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some((e=>-1===(null==i?void 0:i.indexOf(e))))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter((e=>!n||-1!==n.indexOf(e.groupId)));if(e.length)this.selectDefaultTrack&&!e.some((e=>e.default))&&(this.selectDefaultTrack=!1),e.forEach(((e,t)=>{e.id=t}));else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.audioPreference;if(!r&&t){const n=mt(t,e,Tt);if(n>-1)r=e[n];else{const e=mt(t,this.tracks);r=this.tracks[e]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const l={audioTracks:e};this.log(`Updating audio tracks, ${e.length} track(s) found in group(s): ${null==n?void 0:n.join(",")}`),this.hls.trigger(u.AUDIO_TRACKS_UPDATED,l);const c=this.trackId;if(-1!==i&&-1===c)this.setAudioTrack(i);else if(e.length&&-1===c){var s;const t=new Error(`No audio track selected for current audio group-ID(s): ${null==(s=this.groupIds)?void 0:s.join(",")} track count: ${e.length}`);this.warn(t.message),this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}}onError(e,t){!t.fatal&&t.context&&(t.context.type!==l.AUDIO_TRACK||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&vt(e,i,Tt))return i;const r=mt(e,this.tracksInGroup,Tt);if(r>-1){const e=this.tracksInGroup[r];return this.setAudioTrack(r),e}if(i){let i=t.loadLevel;-1===i&&(i=t.firstAutoLevel);const r=St(e,t.levels,n,i,Tt);if(-1===r)return null;t.nextLoadLevel=r}if(e.channels||e.audioCodec){const t=mt(e,n);if(t>-1)return n[t]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn(`Invalid audio track id: ${e}`);this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e],r=i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;if(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger(u.AUDIO_TRACK_SWITCHING,m({},i)),r)return;const s=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(s)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||vt(e,i,Tt)))return n}if(e){const{name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o}=e;for(let e=0;e<t.length;e++){const u=t[e];if(vt({name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o},u,Tt))return e}for(let u=0;u<t.length;u++){const n=t[u];if(na(e.attrs,n.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<t.length;u++){const n=t[u];if(na(e.attrs,n.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&wt(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,i=e.groupId,r=this.getUrlWithDirectives(e.url,t),s=e.details,a=null==s?void 0:s.age;this.log(`Loading audio-track ${n} "${e.name}" lang:${e.lang} group:${i}${void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:""}${a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""} ${r}`),this.hls.trigger(u.AUDIO_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:t||null,track:e})}}class sa{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,n){if(null===this.queues||null===this.tracks)return;const i=this.queues[t];i.push(e),1!==i.length||n||this.executeNext(t)}appendBlocker(e){return new Promise((t=>{const n={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(n,e)}))}prependBlocker(e){return new Promise((t=>{if(this.queues){const n={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(n)}}))}removeBlockers(){null!==this.queues&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach((e=>{var t;const n=null==(t=e[0])?void 0:t.label;"async-blocker"!==n&&"async-blocker-prepend"!==n||(e[0].execute(),e.splice(0,1))}))}unblockAudio(e){if(null===this.queues)return;const t=this.queues.audio;t[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(null===this.queues||null===this.tracks)return;const t=this.queues[e];if(t.length){const r=t[0];try{r.execute()}catch(i){var n;if(r.onError(i),null===this.queues||null===this.tracks)return;const t=null==(n=this.tracks[e])?void 0:n.buffer;null!=t&&t.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){null!==this.queues&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return(null==(t=this.queues)?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return null===e||null===t?"<destroyed>":`\n${this.list("video")}\n${this.list("audio")}\n${this.list("audiovideo")}}`}list(e){var t,n;return null!=(t=this.queues)&&t[e]||null!=(n=this.tracks)&&n[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const n=null==(t=this.tracks)?void 0:t[e],i=null==n?void 0:n.buffer;return i?`SourceBuffer${i.updating?" updating":""}${n.ended?" ended":""}${n.ending?" ending":""}`:"none"}listOps(e){var t;return(null==(t=this.queues)?void 0:t[e].map((e=>e.label)).join(", "))||""}}const aa=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,oa="HlsJsTrackRemovedError";class ua extends Error{constructor(e){super(e),this.name=oa}}class la extends b{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=e=>{var t;this.hls&&"open"===(null==(t=this.mediaSource)?void 0:t.readyState)&&this.hls.pauseBuffering()},this._onStartStreaming=e=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=e=>{const{media:t,mediaSource:n}=this;e&&this.log("Media source opened"),t&&n&&(n.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(u.MEDIA_ATTACHED,{media:t,mediaSource:n}),null!==this.mediaSource&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:e,_objectUrl:t}=this;e!==t&&this.error(`Media element src was set while attaching MediaSource (${t} > ${e})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=R(L(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.MANIFEST_PARSED,this.onManifestParsed,this),e.on(u.BUFFER_RESET,this.onBufferReset,this),e.on(u.BUFFER_APPENDING,this.onBufferAppending,this),e.on(u.BUFFER_CODECS,this.onBufferCodecs,this),e.on(u.BUFFER_EOS,this.onBufferEos,this),e.on(u.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(u.FRAG_PARSED,this.onFragParsed,this),e.on(u.FRAG_CHANGED,this.onFragChanged,this),e.on(u.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.MANIFEST_PARSED,this.onManifestParsed,this),e.off(u.BUFFER_RESET,this.onBufferReset,this),e.off(u.BUFFER_APPENDING,this.onBufferAppending,this),e.off(u.BUFFER_CODECS,this.onBufferCodecs,this),e.off(u.BUFFER_EOS,this.onBufferEos,this),e.off(u.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(u.FRAG_PARSED,this.onFragParsed,this),e.off(u.FRAG_CHANGED,this.onFragChanged,this),e.off(u.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const n={};if(this.operationQueue){const e=this.isUpdating();e||this.operationQueue.removeBlockers();const t=this.isQueued();(e||t)&&this.warn(`Transfering MediaSource with${t?" operations in queue":""}${e?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const i=this.transferData;return!this.sourceBufferCount&&i&&i.mediaSource===t?p(n,i.tracks):this.sourceBuffers.forEach((e=>{const[t]=e;t&&(n[t]=p({},this.tracks[t]),this.removeBuffer(t)),e[0]=e[1]=null})),{media:e,mediaSource:t,tracks:n}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var n;let i=2;(t.audio&&!t.video||!t.altAudio)&&(i=1),this.bufferCodecEventsTotal=i,this.log(`${i} bufferCodec event(s) expected.`),null!=(n=this.transferData)&&n.mediaSource&&this.sourceBufferCount&&i&&this.bufferCreated()}onMediaAttaching(e,t){const n=this.media=t.media,i=L(this.appendSource);if(this.transferData=this.overrides=void 0,n&&i){const e=!!t.mediaSource;(e||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const s=this.mediaSource=t.mediaSource||new i;if(this.assignMediaSource(s),e)this._objectUrl=n.src,this.attachTransferred();else{const e=this._objectUrl=self.URL.createObjectURL(s);if(this.appendSource)try{n.removeAttribute("src");const t=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||t&&s instanceof t,ca(n),da(n,e),n.load()}catch(r){n.src=e}else n.src=e}n.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,n;this.log(`${(null==(t=this.transferData)?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${null==(n=e.constructor)?void 0:n.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const n=this.tracks,i=t.tracks,r=i?Object.keys(i):null,s=r?r.length:0,a=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(i&&r&&s){if(!this.tracksReady)return this.hls.config.startFragPrefetch=!0,void this.log("attachTransferred: waiting for SourceBuffer track info");if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})\nrequired tracks: ${ct(n,((e,t)=>"initSegment"===e?void 0:t))};\ntransfer tracks: ${ct(i,((e,t)=>"initSegment"===e?void 0:t))}}`),!C(i,n)){t.mediaSource=null,t.tracks=void 0;const r=e.currentTime,s=this.details,a=Math.max(r,(null==s?void 0:s.fragments[0].start)||0);return a-r>1?void this.log(`attachTransferred: waiting for playback to reach new tracks start time ${r} -> ${a}`):(this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(i)}"->"${Object.keys(n)}") start time: ${a} currentTime: ${r}`),this.onMediaDetaching(u.MEDIA_DETACHING,{}),this.onMediaAttaching(u.MEDIA_ATTACHING,t),void(e.currentTime=a))}this.transferData=void 0,r.forEach((e=>{const t=e,n=i[t];if(n){const e=n.buffer;if(e){const i=this.fragmentTracker,r=n.id;if(i.hasFragments(r)||i.hasParts(r)){const n=fn.getBuffered(e);i.detectEvictedFragments(t,n,r,null,!0)}const s=ha(t),a=[t,e];this.sourceBuffers[s]=a,e.updating&&this.operationQueue&&this.operationQueue.prependBlocker(t),this.trackSourceBuffer(t,n)}}})),a(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),a()}get mediaSourceOpenOrEnded(){var e;const t=null==(e=this.mediaSource)?void 0:e.readyState;return"open"===t||"ended"===t}onMediaDetaching(e,t){const n=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:i,mediaSource:r,_objectUrl:s}=this;if(r){if(this.log("media source "+(n?"transferring":"detaching")),n)this.sourceBuffers.forEach((([e])=>{e&&this.removeBuffer(e)})),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const e="open"===r.readyState;try{const t=r.sourceBuffers;for(let n=t.length;n--;)e&&t[n].abort(),r.removeSourceBuffer(t[n]);e&&r.endOfStream()}catch(ql){this.warn(`onMediaDetaching: ${ql.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}r.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("sourceended",this._onMediaSourceEnded),r.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}i&&(i.removeEventListener("emptied",this._onMediaEmptied),n||(s&&self.URL.revokeObjectURL(s),this.mediaSrc===s?(i.removeAttribute("src"),this.appendSource&&ca(i),i.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(u.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach((([e])=>{e&&this.resetBuffer(e)})),this.initTracks()}resetBuffer(e){var t;const n=null==(t=this.tracks[e])?void 0:t.buffer;if(this.removeBuffer(e),n)try{var i;null!=(i=this.mediaSource)&&i.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}catch(ql){this.warn(`onBufferReset ${e}`,ql)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[ha(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new sa(this.tracks)}onBufferCodecs(e,t){const n=this.tracks,i=Object.keys(t);this.log(`BUFFER_CODECS: "${i}" (current SB count ${this.sourceBufferCount})`);const r="audiovideo"in t&&(n.audio||n.video)||n.audiovideo&&("audio"in t||"video"in t),s=!r&&this.sourceBufferCount&&this.media&&i.some((e=>!n[e]));r||s?this.warn(`Unsupported transition between "${Object.keys(n)}" and "${i}" SourceBuffers`):(i.forEach((e=>{var i,r,s;const a=t[e],{id:o,codec:u,levelCodec:l,container:c,metadata:d,supplemental:h}=a;let f=n[e];const p=null==(i=this.transferData)||null==(r=i.tracks)?void 0:r[e],g=null!=p&&p.buffer?p:f,m=(null==g?void 0:g.pendingCodec)||(null==g?void 0:g.codec),v=null==g?void 0:g.levelCodec;f||(f=n[e]={buffer:void 0,listeners:[],codec:u,supplemental:h,container:c,levelCodec:l,metadata:d,id:o});const y=$e(m,v),b=null==y?void 0:y.replace(aa,"$1");let T=$e(u,l);const S=null==(s=T)?void 0:s.replace(aa,"$1");T&&y&&b!==S&&("audio"===e.slice(0,5)&&(T=Be(T,this.appendSource)),this.log(`switching codec ${m} to ${T}`),T!==(f.pendingCodec||f.codec)&&(f.pendingCodec=T),f.container=c,this.appendChangeType(e,c,T))})),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),this.sourceBufferCount||this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce(((e,t)=>{const n=this.tracks[t];return e[t]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},e}),{})}appendChangeType(e,t,n){const i=`${t};codecs=${n}`,r={label:`change-type=${i}`,execute:()=>{const r=this.tracks[e];if(r){const s=r.buffer;null!=s&&s.changeType&&(this.log(`changing ${e} sourceBuffer type to ${i}`),s.changeType(i),r.codec=n,r.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{this.warn(`Failed to change ${e} SourceBuffer type`,t)}};this.append(r,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const n=e.start,i=n+.05*e.duration,r=!0===(null==(t=this.fragmentTracker.getAppendedFrag(n,c.MAIN))?void 0:t.gap);if(r)return;const s={label:"block-audio",execute:()=>{var e;const t=this.tracks.video;(this.lastVideoAppendEnd>i||null!=t&&t.buffer&&fn.isBuffered(t.buffer,i)||!0===(null==(e=this.fragmentTracker.getAppendedFrag(i,c.MAIN))?void 0:e.gap))&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:e=>{this.warn("Error executing block-audio operation",e)}};this.blockedAudioAppend={op:s,frag:e},this.append(s,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:n}=this,{data:i,type:r,parent:s,frag:l,part:c,chunkMeta:d}=t,h=d.buffering[r],f=l.sn,p=self.performance.now();h.start=p;const g=l.stats.buffering,m=c?c.stats.buffering:null;0===g.start&&(g.start=p),m&&0===m.start&&(m.start=p);const v=n.audio;let y=!1;"audio"===r&&"audio/mpeg"===(null==v?void 0:v.container)&&(y=!this.lastMpegAudioChunk||1===d.id||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const b=this.tracks.video,T=null==b?void 0:b.buffer;if(T&&"initSegment"!==f){const e=c||l,t=this.blockedAudioAppend;if("audio"!==r||"main"===s||this.blockedAudioAppend){if("video"===r){const n=e.end;if(t){const e=t.frag.start;(n>e||n<this.lastVideoAppendEnd||fn.isBuffered(T,e))&&this.unblockAudio()}this.lastVideoAppendEnd=n}}else{const t=e.start,n=t+.05*e.duration,i=T.buffered,r=this.currentOp("video");i.length||r?!r&&!fn.isBuffered(T,n)&&this.lastVideoAppendEnd<n&&this.blockAudio(e):this.blockAudio(e)}}const S=(c||l).start,E={label:`append-${r}`,execute:()=>{if(h.executeStart=self.performance.now(),y){const e=this.tracks[r];if(e){const t=e.buffer;if(t){const e=S-t.timestampOffset;Math.abs(e)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${S} (delta: ${e}) sn: ${f})`),t.timestampOffset=S)}}}this.appendExecutor(i,r)},onStart:()=>{},onComplete:()=>{const e=self.performance.now();h.executeEnd=h.end=e,0===g.first&&(g.first=e),m&&0===m.first&&(m.first=e);const t={};this.sourceBuffers.forEach((([e,n])=>{e&&(t[e]=fn.getBuffered(n))})),this.appendErrors[r]=0,"audio"===r||"video"===r?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(u.BUFFER_APPENDED,{type:r,frag:l,part:c,chunkMeta:d,parent:l.type,timeRanges:t})},onError:e=>{var t;const n={type:a.MEDIA_ERROR,parent:l.type,details:o.BUFFER_APPEND_ERROR,sourceBufferName:r,frag:l,part:c,chunkMeta:d,error:e,err:e,fatal:!1},i=null==(t=this.media)?void 0:t.error;if(e.code===DOMException.QUOTA_EXCEEDED_ERR)n.details=o.BUFFER_FULL_ERROR;else if(e.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!i)n.errorAction=Gt(!0);else if(e.name===oa&&0===this.sourceBufferCount)n.errorAction=Gt(!0);else{const e=++this.appendErrors[r];this.warn(`Failed ${e}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${r}" sourceBuffer (${i||"no media error"})`),(e>=this.hls.config.appendErrorMaxRetry||i)&&(n.fatal=!0)}this.hls.trigger(u.ERROR,n)}};this.append(E,r,this.isPending(this.tracks[r]))}getFlushOp(e,t,n){return this.log(`queuing "${e}" remove ${t}-${n}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,n)},onStart:()=>{},onComplete:()=>{this.hls.trigger(u.BUFFER_FLUSHED,{type:e})},onError:i=>{this.warn(`Failed to remove ${t}-${n} from "${e}" SourceBuffer`,i)}}}onBufferFlushing(e,t){const{type:n,startOffset:i,endOffset:r}=t;n?this.append(this.getFlushOp(n,i,r),n):this.sourceBuffers.forEach((([e])=>{e&&this.append(this.getFlushOp(e,i,r),e)}))}onFragParsed(e,t){const{frag:n,part:i}=t,r=[],s=i?i.elementaryStreams:n.elementaryStreams;s[B.AUDIOVIDEO]?r.push("audiovideo"):(s[B.AUDIO]&&r.push("audio"),s[B.VIDEO]&&r.push("video"));const a=()=>{const e=self.performance.now();n.stats.buffering.end=e,i&&(i.stats.buffering.end=e);const t=i?i.stats:n.stats;this.hls.trigger(u.FRAG_BUFFERED,{frag:n,part:i,stats:t,id:n.type})};0===r.length&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(a,r).catch((e=>{this.warn(`Fragment buffered callback ${e}`),this.stepOperationQueue(this.sourceBufferTypes)}))}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some((([e])=>{var t,n;return e&&(!(null!=(t=this.tracks[e])&&t.ended)||(null==(n=this.tracks[e])?void 0:n.ending))}))}onBufferEos(e,t){var n;this.sourceBuffers.forEach((([e])=>{if(e){const n=this.tracks[e];t.type&&t.type!==e||(n.ending=!0,n.ended||(n.ended=!0,this.log(`${e} buffer reached EOS`)))}}));const i=!1!==(null==(n=this.overrides)?void 0:n.endOfStream),r=this.sourceBufferCount>0&&!this.sourceBuffers.some((([e])=>{var t;return e&&!(null!=(t=this.tracks[e])&&t.ended)}));r&&(i?(this.log("Queueing EOS"),this.blockUntilOpen((()=>{this.tracksEnded();const{mediaSource:e}=this;e&&"open"===e.readyState?(this.log("Calling mediaSource.endOfStream()"),e.endOfStream(),this.hls.trigger(u.BUFFERED_TO_END,void 0)):e&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${e.readyState}`)}))):(this.tracksEnded(),this.hls.trigger(u.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach((([e])=>{if(null!==e){const t=this.tracks[e];t&&(t.ending=!1)}}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){const e=this.getDurationAndRange();e&&this.blockUntilOpen((()=>this.updateMediaSource(e)))}onError(e,t){if(t.details===o.BUFFER_APPEND_ERROR&&t.frag){var n;const e=null==(n=t.errorAction)?void 0:n.nextAutoLevel;i(e)&&e!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||null===t)return;if(!this.sourceBufferCount)return;const r=e.config,s=n.currentTime,a=t.levelTargetDuration,o=t.live&&null!==r.liveBackBufferLength?r.liveBackBufferLength:r.backBufferLength;if(i(o)&&o>=0){const e=Math.max(o,a),t=Math.floor(s/a)*a-e;this.flushBackBuffer(s,a,t)}if(i(r.frontBufferFlushThreshold)&&r.frontBufferFlushThreshold>0){const e=Math.max(r.maxBufferLength,r.frontBufferFlushThreshold),t=Math.max(e,a),n=Math.floor(s/a)*a+t;this.flushFrontBuffer(s,a,n)}}flushBackBuffer(e,t,n){this.sourceBuffers.forEach((([e,t])=>{if(t){const r=fn.getBuffered(t);if(r.length>0&&n>r.start(0)){var i;this.hls.trigger(u.BACK_BUFFER_REACHED,{bufferEnd:n});const t=this.tracks[e];if(null!=(i=this.details)&&i.live)this.hls.trigger(u.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(null!=t&&t.ended)return void this.log(`Cannot flush ${e} back buffer while SourceBuffer is in ended state`);this.hls.trigger(u.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:e})}}}))}flushFrontBuffer(e,t,n){this.sourceBuffers.forEach((([t,i])=>{if(i){const r=fn.getBuffered(i),s=r.length;if(s<2)return;const a=r.start(s-1),o=r.end(s-1);if(n>a||e>=a&&e<=o)return;this.hls.trigger(u.BUFFER_FLUSHING,{startOffset:a,endOffset:1/0,type:t})}}))}getDurationAndRange(){var e;const{details:t,mediaSource:n}=this;if(!t||!this.media||"open"!==(null==n?void 0:n.readyState))return null;const r=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){const e=t.fragments.length;if(e&&t.live&&n.setLiveSeekableRange){const e=Math.max(0,t.fragmentStart),n=Math.max(e,r);return{duration:1/0,start:e,end:n}}return{duration:1/0}}const s=null==(e=this.overrides)?void 0:e.duration;if(s)return i(s)?{duration:s}:null;const a=this.media.duration,o=i(n.duration)?n.duration:0;return r>o&&r>a||!i(a)?{duration:r}:null}updateMediaSource({duration:e,start:t,end:n}){const r=this.mediaSource;this.media&&r&&"open"===r.readyState&&(r.duration!==e&&(i(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),r.duration=e),void 0!==t&&void 0!==n&&(this.log(`MediaSource duration is set to ${r.duration}. Setting seekable range to ${t}-${n}.`),r.setLiveSeekableRange(t,n)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:n}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${ct(n)}`),this.tracksReady){var i;const e=null==(i=this.transferData)?void 0:i.tracks;e&&Object.keys(e).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach((([t,n])=>{if(t){const i=this.tracks[t];e[t]={buffer:n,container:i.container,codec:i.codec,supplemental:i.supplemental,levelCodec:i.levelCodec,id:i.id,metadata:i.metadata}}})),this.hls.trigger(u.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach((([e])=>{this.executeNext(e)}))}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:n}=this;if(!n)throw new Error("createSourceBuffers called when mediaSource was null");for(const s in e){const l=s,c=e[l];if(this.isPending(c)){const e=this.getTrackCodec(c,l),s=`${c.container};codecs=${e}`;c.codec=e,this.log(`creating sourceBuffer(${s})${this.currentOp(l)?" Queued":""} ${ct(c)}`);try{const e=n.addSourceBuffer(s),i=ha(l),r=[l,e];t[i]=r,c.buffer=e}catch(r){var i;return this.error(`error while trying to add sourceBuffer: ${r.message}`),this.shiftAndExecuteNext(l),null==(i=this.operationQueue)||i.removeBlockers(),delete this.tracks[l],void this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:r,sourceBufferName:l,mimeType:s,parent:c.id})}this.trackSourceBuffer(l,c)}}this.bufferCreated()}getTrackCodec(e,t){const n=e.supplemental;let i=e.codec;n&&("video"===t||"audiovideo"===t)&&De(n,"video")&&(i=je(i,n));const r=$e(i,e.levelCodec);return r?"audio"===t.slice(0,5)?Be(r,this.appendSource):r:""}trackSourceBuffer(e,t){const n=t.buffer;if(!n)return;const i=this.getTrackCodec(t,e);this.tracks[e]={buffer:n,codec:i,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",((e,t)=>{const n=t.removedRanges;null!=n&&n.length&&this.hls.trigger(u.BUFFER_FLUSHED,{type:e})}))}get mediaSrc(){var e,t;const n=(null==(e=this.media)||null==(t=e.querySelector)?void 0:t.call(e,"source"))||this.media;return null==n?void 0:n.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if("closed"===(null==(t=this.mediaSource)?void 0:t.readyState))return void this.resetBuffer(e);const n=this.currentOp(e);n&&(n.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var n;const i=new Error(`${e} SourceBuffer error. MediaSource readyState: ${null==(n=this.mediaSource)?void 0:n.readyState}`);this.error(`${i}`,t),this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const r=this.currentOp(e);r&&r.onError(i)}removeExecutor(e,t,n){const{media:r,mediaSource:s}=this,a=this.tracks[e],o=null==a?void 0:a.buffer;if(!r||!s||!o)return this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),void this.shiftAndExecuteNext(e);const u=i(r.duration)?r.duration:1/0,l=i(s.duration)?s.duration:1/0,c=Math.max(0,t),d=Math.min(n,u,l);d>c&&(!a.ending||a.ended)?(a.ended=!1,this.log(`Removing [${c},${d}] from the ${e} SourceBuffer`),o.remove(c,d)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.tracks[t],i=null==n?void 0:n.buffer;if(!i)throw new ua(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);n.ending=!1,n.ended=!1,i.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch((e=>{this.warn(`SourceBuffer blocked callback ${e}`),this.stepOperationQueue(this.sourceBufferTypes)}));else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some((([e,t])=>e&&t.updating))}isQueued(){return this.sourceBuffers.some((([e])=>e&&!!this.currentOp(e)))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:n}=this,i=t.map((e=>this.appendBlocker(e))),r=t.length>1&&!!this.blockedAudioAppend;return r&&this.unblockAudio(),Promise.all(i).then((t=>{n===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))}))}stepOperationQueue(e){e.forEach((e=>{var t;const n=null==(t=this.tracks[e])?void 0:t.buffer;n&&!n.updating&&this.shiftAndExecuteNext(e)}))}append(e,t,n){this.operationQueue&&this.operationQueue.append(e,t,n)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce(((e,t)=>e+(this.isPending(this.tracks[t])?1:0)),0)}get sourceBufferCount(){return this.sourceBuffers.reduce(((e,[t])=>e+(t?1:0)),0)}get sourceBufferTypes(){return this.sourceBuffers.map((([e])=>e)).filter((e=>!!e))}addBufferListener(e,t,n){const i=this.tracks[e];if(!i)return;const r=i.buffer;if(!r)return;const s=n.bind(this,e);i.listeners.push({event:t,listener:s}),r.addEventListener(t,s)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const n=t.buffer;n&&(t.listeners.forEach((e=>{n.removeEventListener(e.event,e.listener)})),t.listeners.length=0)}}function ca(e){const t=e.querySelectorAll("source");[].slice.call(t).forEach((t=>{e.removeChild(t)}))}function da(e,t){const n=self.document.createElement("source");n.type="video/mp4",n.src=t,e.appendChild(n)}function ha(e){return"audio"===e?1:0}class fa{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(u.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(u.MANIFEST_PARSED,this.onManifestParsed,this),e.on(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(u.BUFFER_CODECS,this.onBufferCodecs,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(u.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(u.MANIFEST_PARSED,this.onManifestParsed,this),e.off(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(u.BUFFER_CODECS,this.onBufferCodecs,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&i(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){const n=this.hls;n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter(((t,n)=>this.isLevelAllowed(t)&&n<=e));return this.clientRect=null,fa.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.width||t.height||(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(t){}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){const t=this.restrictedLevels;return!t.some((t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height))}static getMaxLevelByMediaSize(e,t,n){if(null==e||!e.length)return-1;const i=(e,t)=>!t||(e.width!==t.width||e.height!==t.height);let r=e.length-1;const s=Math.max(t,n);for(let a=0;a<e.length;a+=1){const t=e[a];if((t.width>=s||t.height>=s)&&i(t,e[a+1])){r=a;break}}return r}}const pa={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},ga=pa,ma={HLS:"h"},va=ma,ya="CMCD-Object",ba="CMCD-Request",Ta="CMCD-Session",Sa="CMCD-Status",Ea={OBJECT:ya,REQUEST:ba,SESSION:Ta,STATUS:Sa},wa={[Ea.OBJECT]:["br","d","ot","tb"],[Ea.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[Ea.SESSION]:["cid","pr","sf","sid","st","v"],[Ea.STATUS]:["bs","rtp"]};class Aa{constructor(e,t){Array.isArray(e)&&(e=e.map((e=>e instanceof Aa?e:new Aa(e)))),this.value=e,this.params=t}}const xa="Dict";function Ia(e){return Array.isArray(e)?JSON.stringify(e):e instanceof Map?"Map{}":e instanceof Set?"Set{}":"object"===typeof e?JSON.stringify(e):String(e)}function ka(e,t,n,i){return new Error(`failed to ${e} "${Ia(t)}" as ${n}`,{cause:i})}function La(e,t,n){return ka("serialize",e,t,n)}class Ra{constructor(e){this.description=e}}const Ca="Bare Item",Da="Boolean";function Ma(e){if("boolean"!==typeof e)throw La(e,Da);return e?"?1":"?0"}const Pa="Byte Sequence";function _a(e){if(!1===ArrayBuffer.isView(e))throw La(e,Pa);return`:${br(e)}:`}const Oa="Integer";function Na(e){return e<-999999999999999||999999999999999<e}function Ua(e){if(Na(e))throw La(e,Oa);return e.toString()}function Fa(e){return`@${Ua(e.getTime()/1e3)}`}const Ba="Decimal";function ja(e){const t=Tr(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw La(e,Ba);const n=t.toString();return n.includes(".")?n:`${n}.0`}const $a="String",Ga=/[\x00-\x1f\x7f]+/;function Va(e){if(Ga.test(e))throw La(e,$a);return`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function Ha(e){return e.description||e.toString().slice(7,-1)}const Ka="Token";function Wa(e){const t=Ha(e);if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t))throw La(t,Ka);return t}function qa(e){switch(typeof e){case"number":if(!i(e))throw La(e,Ca);return Number.isInteger(e)?Ua(e):ja(e);case"string":return Va(e);case"symbol":return Wa(e);case"boolean":return Ma(e);case"object":if(e instanceof Date)return Fa(e);if(e instanceof Uint8Array)return _a(e);if(e instanceof Ra)return Wa(e);default:throw La(e,Ca)}}const Ya="Key";function Xa(e){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(e))throw La(e,Ya);return e}function za(e){return null==e?"":Object.entries(e).map((([e,t])=>!0===t?`;${Xa(e)}`:`;${Xa(e)}=${qa(t)}`)).join("")}function Qa(e){return e instanceof Aa?`${qa(e.value)}${za(e.params)}`:qa(e)}function Ja(e){return`(${e.value.map(Qa).join(" ")})${za(e.params)}`}function Za(e,t={whitespace:!0}){if("object"!==typeof e)throw La(e,xa);const n=e instanceof Map?e.entries():Object.entries(e),i=(null===t||void 0===t?void 0:t.whitespace)?" ":"";return Array.from(n).map((([e,t])=>{t instanceof Aa===!1&&(t=new Aa(t));let n=Xa(e);return!0===t.value?n+=za(t.params):(n+="=",Array.isArray(t.value)?n+=Ja(t):n+=Qa(t)),n})).join(`,${i}`)}function eo(e,t){return Za(e,t)}function to(e){return"ot"===e||"sf"===e||"st"===e}function no(e){return"number"===typeof e?i(e):null!=e&&""!==e&&!1!==e}const io=e=>Math.round(e),ro=(e,t)=>((null===t||void 0===t?void 0:t.baseUrl)&&(e=Sr(e,t.baseUrl)),encodeURIComponent(e)),so=e=>100*io(e/100),ao={br:io,d:io,bl:so,dl:so,mtp:so,nor:ro,rtp:so,tb:io};function oo(e,t){const n={};if(null==e||"object"!==typeof e)return n;const i=Object.keys(e).sort(),r=p({},ao,null===t||void 0===t?void 0:t.formatters),s=null===t||void 0===t?void 0:t.filter;return i.forEach((i=>{if(null===s||void 0===s?void 0:s(i))return;let a=e[i];const o=r[i];o&&(a=o(a,t)),"v"===i&&1===a||"pr"==i&&1===a||no(a)&&(to(i)&&"string"===typeof a&&(a=new Ra(a)),n[i]=a)})),n}function uo(e,t={}){return e?eo(oo(e,t),p({whitespace:!1},t)):""}function lo(e,t={}){const n={};if(!e)return n;const i=Object.entries(e),r=Object.entries(wa).concat(Object.entries((null===t||void 0===t?void 0:t.customHeaderMap)||{})),s=i.reduce(((e,t)=>{var n,i;const[s,a]=t,o=(null===(n=r.find((e=>e[1].includes(s))))||void 0===n?void 0:n[0])||Ea.REQUEST;return null!==(i=e[o])&&void 0!==i||(e[o]={}),e[o][s]=a,e}),{});return Object.entries(s).reduce(((e,[n,i])=>(e[n]=uo(i,t),e)),n)}function co(e,t,n){return p(e,lo(t,n))}const ho="CMCD";function fo(e,t={}){if(!e)return"";const n=uo(e,t);return`${ho}=${encodeURIComponent(n)}`}const po=/CMCD=[^&#]+/;function go(e,t,n){const i=fo(t,n);if(!i)return e;if(po.test(e))return e.replace(po,i);const r=e.includes("?")?"&":"?";return`${e}${r}${i}`}class mo{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=e=>{try{this.apply(e,{ot:ga.MANIFEST,su:!this.initialized})}catch(t){this.hls.logger.warn("Could not generate manifest CMCD data.",t)}},this.applyFragmentData=e=>{try{const{frag:t,part:n}=e,i=this.hls.levels[t.level],r=this.getObjectType(t),s={d:1e3*(n||t).duration,ot:r};r!==ga.VIDEO&&r!==ga.AUDIO&&r!=ga.MUXED||(s.br=i.bitrate/1e3,s.tb=this.getTopBandwidth(r)/1e3,s.bl=this.getBufferLength(r));const a=n?this.getNextPart(n):this.getNextFrag(t);null!=a&&a.url&&a.url!==t.url&&(s.nor=a.url),this.apply(e,s)}catch(t){this.hls.logger.warn("Could not generate segment CMCD data.",t)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;null!=n&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.sessionId,this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(u.MEDIA_DETACHED,this.onMediaDetached,this),e.on(u.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(u.MEDIA_DETACHED,this.onMediaDetached,this),e.off(u.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=null==(n=t.tracks.audio)?void 0:n.buffer,this.videoBuffer=null==(i=t.tracks.video)?void 0:i.buffer}createData(){var e;return{v:1,sf:va.HLS,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){p(t,this.createData());const n=t.ot===ga.INIT||t.ot===ga.VIDEO||t.ot===ga.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering);const{includeKeys:i}=this;i&&(t=Object.keys(t).reduce(((e,n)=>(i.includes(n)&&(e[n]=t[n]),e)),{}));const r={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),co(e.headers,t,r)):e.url=go(e.url,t,r)}getNextFrag(e){var t;const n=null==(t=this.hls.levels[e.level])?void 0:t.details;if(n){const t=e.sn-n.startSN;return n.fragments[t+1]}}getNextPart(e){var t,n;const{index:i,fragment:r}=e,s=null==(t=this.hls.levels[r.level])||null==(n=t.details)?void 0:n.partList;if(s){const{sn:e}=r;for(let t=s.length-1;t>=0;t--){const n=s[t];if(n.index===i&&n.fragment.sn===e)return s[t+1]}}}getObjectType(e){const{type:t}=e;return"subtitle"===t?ga.TIMED_TEXT:"initSegment"===e.sn?ga.INIT:"audio"===t?ga.AUDIO:"main"===t?this.hls.audioTracks.length?ga.VIDEO:ga.MUXED:void 0}getTopBandwidth(e){let t,n=0;const i=this.hls;if(e===ga.AUDIO)t=i.audioTracks;else{const e=i.maxAutoLevel,n=e>-1?e+1:i.levels.length;t=i.levels.slice(0,n)}for(const r of t)r.bitrate>n&&(n=r.bitrate);return n>0?n:NaN}getBufferLength(e){const t=this.media,n=e===ga.AUDIO?this.audioBuffer:this.videoBuffer;if(!n||!t)return NaN;const i=fn.bufferInfo(n,t.currentTime,this.config.maxBufferHole);return 1e3*i.len}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}}const vo=3e5;class yo extends b{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(u.MANIFEST_PARSED,this.onManifestParsed,this),e.on(u.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(u.MANIFEST_PARSED,this.onManifestParsed,this),e.off(u.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce(((e,t)=>(-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e)),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter((t=>t!==e)))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;null!==n&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((null==n?void 0:n.action)===Bt.SendAlternateToPenaltyBox&&n.flags===jt.MoveAllAlternatesMatchingHost){const e=this.levels;let i=this._pathwayPriority,r=this.pathwayId;if(t.context){const{groupId:n,pathwayId:i,type:s}=t.context;n&&e?r=this.getPathwayForGroupId(n,s,r):i&&(r=i)}r in this.penalizedPathways||(this.penalizedPathways[r]=performance.now()),!i&&e&&(i=this.pathways()),i&&i.length>1&&(this.updatePathwayPriority(i),n.resolved=this.pathwayId!==r),n.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${r} levels: ${e?e.length:e} priorities: ${ct(i)} penalized: ${ct(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter((t=>e===t.pathwayId))}updatePathwayPriority(e){let t;this._pathwayPriority=e;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach((e=>{i-n[e]>vo&&delete n[e]}));for(let r=0;r<e.length;r++){const i=e[r];if(i in n)continue;if(i===this.pathwayId)return;const s=this.hls.nextLoadLevel,a=this.hls.levels[s];if(t=this.getLevelsForPathway(i),t.length>0){this.log(`Setting Pathway to "${i}"`),this.pathwayId=i,Li(t),this.hls.trigger(u.LEVELS_UPDATED,{levels:t});const e=this.hls.levels[s];a&&e&&this.levels&&(e.attrs["STABLE-VARIANT-ID"]!==a.attrs["STABLE-VARIANT-ID"]&&e.bitrate!==a.bitrate&&this.log(`Unstable Pathways change from bitrate ${a.bitrate} to ${e.bitrate}`),this.hls.nextLoadLevel=s);break}}}getPathwayForGroupId(e,t,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let r=0;r<i.length;r++)if(t===l.AUDIO_TRACK&&i[r].hasAudioGroup(e)||t===l.SUBTITLE_TRACK&&i[r].hasSubtitleGroup(e))return i[r].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach((e=>{const{ID:r,"BASE-ID":s,"URI-REPLACEMENT":a}=e;if(t.some((e=>e.pathwayId===r)))return;const o=this.getLevelsForPathway(s).map((e=>{const t=new Sn(e.attrs);t["PATHWAY-ID"]=r;const s=t.AUDIO&&`${t.AUDIO}_clone_${r}`,o=t.SUBTITLES&&`${t.SUBTITLES}_clone_${r}`;s&&(n[t.AUDIO]=s,t.AUDIO=s),o&&(i[t.SUBTITLES]=o,t.SUBTITLES=o);const u=To(e.uri,t["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a),l=new st({attrs:t,audioCodec:e.audioCodec,bitrate:e.bitrate,height:e.height,name:e.name,url:u,videoCodec:e.videoCodec,width:e.width});if(e.audioGroups)for(let n=1;n<e.audioGroups.length;n++)l.addGroupId("audio",`${e.audioGroups[n]}_clone_${r}`);if(e.subtitleGroups)for(let n=1;n<e.subtitleGroups.length;n++)l.addGroupId("text",`${e.subtitleGroups[n]}_clone_${r}`);return l}));t.push(...o),bo(this.audioTracks,n,a,r),bo(this.subtitleTracks,i,a,r)}))}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;let i;this.loader&&this.loader.destroy(),this.loader=new n(t);try{i=new self.URL(e)}catch(c){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${e}`)}if("data:"!==i.protocol){const e=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+e)}const r={responseType:"json",url:i.href},s=t.steeringManifestLoadPolicy.default,a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(e,t,n,r)=>{this.log(`Loaded steering manifest: "${i}"`);const s=e.data;if(1!==(null==s?void 0:s.VERSION))return void this.log(`Steering VERSION ${s.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=s.TTL;const{"RELOAD-URI":a,"PATHWAY-CLONES":o,"PATHWAY-PRIORITY":l}=s;if(a)try{this.uri=new self.URL(a,i).href}catch(c){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${a}`)}this.scheduleRefresh(this.uri||n.url),o&&this.clonePathways(o);const d={steeringManifest:s,url:i.toString()};this.hls.trigger(u.STEERING_MANIFEST_LOADED,d),l&&this.updatePathwayPriority(l)},onError:(e,t,n,i)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),this.stopLoad(),410===e.code)return this.enabled=!1,void this.log(`Steering manifest ${t.url} no longer available`);let r=1e3*this.timeToLoad;if(429!==e.code)this.scheduleRefresh(this.uri||t.url,r);else{const e=this.loader;if("function"===typeof(null==e?void 0:e.getResponseHeader)){const t=e.getResponseHeader("Retry-After");t&&(r=1e3*parseFloat(t))}this.log(`Steering manifest ${t.url} rate limited`)}},onTimeout:(e,t,n)=>{this.log(`Timeout loading steering manifest (${t.url})`),this.scheduleRefresh(this.uri||t.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(r,o,l)}scheduleRefresh(e,t=1e3*this.timeToLoad){this.clearTimeout(),this.reloadTimer=self.setTimeout((()=>{var t;const n=null==(t=this.hls)?void 0:t.media;!n||n.ended?this.scheduleRefresh(e,1e3*this.timeToLoad):this.loadSteeringManifest(e)}),t)}}function bo(e,t,n,i){e&&Object.keys(t).forEach((r=>{const s=e.filter((e=>e.groupId===r)).map((e=>{const s=p({},e);return s.details=void 0,s.attrs=new Sn(s.attrs),s.url=s.attrs.URI=To(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),s.groupId=s.attrs["GROUP-ID"]=t[r],s.attrs["PATHWAY-ID"]=i,s}));e.push(...s)}))}function To(e,t,n,i){const{HOST:r,PARAMS:s,[n]:a}=i;let o;t&&(o=null==a?void 0:a[t],o&&(e=o));const u=new self.URL(e);return r&&!o&&(u.host=r),s&&Object.keys(s).sort().forEach((e=>{e&&u.searchParams.set(e,s[e])})),u.href}class So extends b{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=So.CDMCleanupPromise?[So.CDMCleanupPromise]:[],this.onMediaEncrypted=e=>{const{initDataType:t,initData:n}=e,i=`"${e.type}" event: init data type: "${t}"`;if(this.debug(i),null!==n){if(!this.keyFormatPromise){let e=Object.keys(this.keySystemAccessPromises);e.length||(e=Gn(this.config));const t=e.map($n).filter((e=>!!e));this.keyFormatPromise=this.getKeyFormatPromise(t)}this.keyFormatPromise.then((r=>{const s=Fn(r);let a,o;if("sinf"===t){if(s!==Nn.FAIRPLAY)return void this.warn(`Ignoring unexpected "${e.type}" event with init data type: "${t}" for selected key-system ${s}`);const r=X(new Uint8Array(n));try{const e=Cn(JSON.parse(r).sinf),t=de(e);if(!t)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");a=new Uint8Array(t.subarray(8,24)),o=Nn.FAIRPLAY}catch(h){return void this.warn(`${i} Failed to parse sinf: ${h}`)}}else{if(s!==Nn.WIDEVINE&&s!==Nn.PLAYREADY)return void this.warn(`Ignoring unexpected "${e.type}" event with init data type: "${t}" for selected key-system ${s}`);const r=Ie(n),u=r.filter((e=>!!e.systemId&&jn(e.systemId)===s));u.length>1&&this.warn(`${i} Using first of ${u.length} pssh found for selected key-system ${s}`);const l=u[0];if(!l)return void(0===r.length||r.some((e=>!e.systemId))?this.warn(`${i} contains incomplete or invalid pssh data`):this.log(`ignoring ${i} for ${r.map((e=>jn(e.systemId))).join(",")} pssh data in favor of playlist keys`));if(o=jn(l.systemId),0===l.version&&l.data)if(o===Nn.WIDEVINE){const e=l.data.length-22;a=new Uint8Array(l.data.subarray(e,e+16))}else o===Nn.PLAYREADY&&(a=qn(l.data))}if(!o||!a)return;const u=M.hexDump(a),{keyIdToKeySessionPromise:l,mediaKeySessions:c}=this;let d=l[u];for(let e=0;e<c.length;e++){const i=c[e],r=i.decryptdata;if(!r.keyId)continue;const s=M.hexDump(r.keyId);if(u===s||-1!==r.uri.replace(/-/g,"").indexOf(u)){if(d=l[s],r.pssh)break;delete l[s],r.pssh=new Uint8Array(n),r.keyId=a,d=l[u]=d.then((()=>this.generateRequestWithPreferredKeySession(i,t,n,"encrypted-event-key-match"))),d.catch((e=>this.handleError(e)));break}}if(!d){if(o!==s)return void this.log(`Ignoring "${e.type}" event with ${o} init data for selected key-system ${s}`);d=l[u]=this.getKeySystemSelectionPromise([o]).then((({keySystem:e,mediaKeys:i})=>{var r;this.throwIfDestroyed();const s=new Xn("ISO-23001-7",u,null!=(r=$n(e))?r:"");return s.pssh=new Uint8Array(n),s.keyId=a,this.attemptSetMediaKeys(e,i).then((()=>{this.throwIfDestroyed();const r=this.createMediaKeySessionContext({decryptdata:s,keySystem:e,mediaKeys:i});return this.generateRequestWithPreferredKeySession(r,t,n,"encrypted-event-no-match")}))})),d.catch((e=>this.handleError(e)))}}))}},this.onWaitingForKey=e=>{this.log(`"${e.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){const e=this.media;this.unregisterListeners(),this.onMediaDetached(),this._clear(e);const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(u.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(u.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(u.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(u.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(u.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(u.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t[e];return i?i.licenseUrl:e===Nn.WIDEVINE&&n?n:void 0}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(void 0===t)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(e,t,n)=>!!e&&n.indexOf(e)===t,i=t.map((e=>e.audioCodec)).filter(n),r=t.map((e=>e.videoCodec)).filter(n);return i.length+r.length===0&&r.push("avc1.42e01e"),new Promise(((t,n)=>{const s=e=>{const u=e.shift();this.getMediaKeysPromise(u,i,r).then((e=>t({keySystem:u,mediaKeys:e}))).catch((t=>{e.length?s(e):n(t instanceof Eo?t:new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))}))};s(e)}))}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if("function"!==typeof n){let e=`Configured requestMediaKeySystemAccess is not a function ${n}`;return null===Vn&&"http:"===self.location.protocol&&(e=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(e))}return n(e,t)}getMediaKeysPromise(e,t,n){const i=Hn(e,t,n,this.config.drmSystemOptions),r=this.keySystemAccessPromises[e];let s=null==r?void 0:r.keySystemAccess;if(!s){this.log(`Requesting encrypted media "${e}" key-system access with config: ${ct(i)}`),s=this.requestMediaKeySystemAccess(e,i);const t=this.keySystemAccessPromises[e]={keySystemAccess:s};return s.catch((t=>{this.log(`Failed to obtain access to key-system "${e}": ${t}`)})),s.then((n=>{this.log(`Access for key-system "${n.keySystem}" obtained`);const i=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),t.mediaKeys=n.createMediaKeys().then((t=>(this.log(`Media-keys created for "${e}"`),i.then((n=>n?this.setMediaKeysServerCertificate(t,e,n):t))))),t.mediaKeys.catch((t=>{this.error(`Failed to create media-keys for "${e}"}: ${t}`)})),t.mediaKeys}))}return s.then((()=>r.mediaKeys))}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${M.hexDump(e.keyId||[])}`);const i=n.createSession(),r={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),r="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,r,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return M.hexDump(e.keyId)}updateKeySession(e,t){var n;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${M.hexDump((null==(n=e.decryptdata)?void 0:n.keyId)||[])}\n      } (data length: ${t?t.byteLength:t})`),i.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise(((t,n)=>{const i=Gn(this.config),r=e.map(Fn).filter((e=>!!e&&-1!==i.indexOf(e)));return this.getKeySystemSelectionPromise(r).then((({keySystem:e})=>{const i=$n(e);i?t(i):n(new Error(`Unable to find format for key-system "${e}"`))})).catch(n)}))}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),i=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let r=this.keyIdToKeySessionPromise[n];if(!r){r=this.getKeySystemForKeyPromise(t).then((({keySystem:n,mediaKeys:r})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(n,r).then((()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:n,mediaKeys:r,decryptdata:t})))))));const s=this.keyIdToKeySessionPromise[n]=r.then((e=>{const n="cenc",i=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(e,n,i,"playlist-key")}));s.catch((e=>this.handleError(e)))}return r}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Eo?this.hls.trigger(u.ERROR,e.data):this.hls.trigger(u.ERROR,{type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const t=Fn(e.keyFormat),n=t?[t]:Gn(this.config);return this.attemptKeySystemAccess(n)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Gn(this.config)),0===e.length)throw new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${ct({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then((()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)}));return this.setMediaKeysQueue.push(i),i.then((()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter((e=>-1===n.indexOf(e)))}))}generateRequestWithPreferredKeySession(e,t,n,i){var r,s;const u=null==(r=this.config.drmSystems)||null==(s=r[e.keySystem])?void 0:s.generateRequest;if(u)try{const i=u.call(this.hls,t,n,e);if(!i)throw new Error("Invalid response from configured generateRequest filter");t=i.initDataType,n=i.initData?i.initData:null,e.decryptdata.pssh=n?new Uint8Array(n):null}catch(g){var l;if(this.warn(g.message),null!=(l=this.hls)&&l.config.debug)throw g}if(null===n)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const c=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${c} (init data type: ${t} length: ${n?n.byteLength:null})`);const d=new Wi,h=e._onmessage=t=>{const n=e.mediaKeysSession;if(!n)return void d.emit("error",new Error("invalid state"));const{messageType:i,message:r}=t;this.log(`"${i}" message event for session "${n.sessionId}" message size: ${r.byteLength}`),"license-request"===i||"license-renewal"===i?this.renewLicense(e,r).catch((e=>{d.eventNames().length?d.emit("error",e):this.handleError(e)})):"license-release"===i?e.keySystem===Nn.FAIRPLAY&&(this.updateKeySession(e,Dn("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${i}"`)},f=e._onkeystatuseschange=t=>{const n=e.mediaKeysSession;if(!n)return void d.emit("error",new Error("invalid state"));this.onKeyStatusChange(e);const i=e.keyStatus;d.emit("keyStatus",i),"expired"===i&&(this.warn(`${e.keySystem} expired for key ${c}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",h),e.mediaKeysSession.addEventListener("keystatuseschange",f);const p=new Promise(((e,t)=>{d.on("error",t),d.on("keyStatus",(n=>{n.startsWith("usable")?e():"output-restricted"===n?t(new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===n?t(new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${n}"`)):"expired"===n?t(new Error("key expired while generating request")):this.warn(`unhandled key status change "${n}"`)}))}));return e.mediaKeysSession.generateRequest(t,n).then((()=>{var t;this.log(`Request generated for key-session "${null==(t=e.mediaKeysSession)?void 0:t.sessionId}" keyId: ${c}`)})).catch((e=>{throw new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},`Error generating key-session request: ${e}`)})).then((()=>p)).catch((t=>{throw d.removeAllListeners(),this.removeSession(e),t})).then((()=>(d.removeAllListeners(),e)))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach(((t,n)=>{if("string"===typeof n&&"object"===typeof t){const e=n;n=t,t=e}this.log(`key status change "${t}" for keyStatuses keyId: ${M.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${M.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t}))}fetchServerCertificate(e){const t=this.config,n=t.loader,i=new n(t),r=this.getServerCertificateUrl(e);return r?(this.log(`Fetching server certificate for "${e}"`),new Promise(((n,s)=>{const u={responseType:"arraybuffer",url:r},l=t.certLoadPolicy.default,c={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(e,t,i,r)=>{n(e.data)},onError:(t,n,i,l)=>{s(new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:m({url:u.url,data:void 0},t)},`"${e}" certificate request failed (${r}). Status: ${t.code} (${t.text})`))},onTimeout:(t,n,i)=>{s(new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:{url:u.url,data:void 0}},`"${e}" certificate request timed out (${r})`))},onAbort:(e,t,n)=>{s(new Error("aborted"))}};i.load(u,c,d)}))):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise(((i,r)=>{e.setServerCertificate(n).then((r=>{this.log(`setServerCertificate ${r?"success":"not supported by CDM"} (${null==n?void 0:n.byteLength}) on "${t}"`),i(e)})).catch((e=>{r(new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))}))}))}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then((t=>this.updateKeySession(e,new Uint8Array(t)).catch((e=>{throw new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const i=(new DOMParser).parseFromString(n,"application/xml"),r=i.querySelectorAll("HttpHeader");if(r.length>0){let t;for(let n=0,i=r.length;n<i;n++){var s,a;t=r[n];const i=null==(s=t.querySelector("name"))?void 0:s.textContent,o=null==(a=t.querySelector("value"))?void 0:a.textContent;i&&o&&e.setRequestHeader(i,o)}}const o=i.querySelector("Challenge"),u=null==o?void 0:o.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return Dn(atob(u))}setupLicenseXHR(e,t,n,i){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then((()=>{if(!n.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,n,i)})).catch((s=>{if(!n.decryptdata)throw s;return e.open("POST",t,!0),r.call(this.hls,e,t,n,i)})).then((n=>{e.readyState||e.open("POST",t,!0);const r=n||i;return{xhr:e,licenseChallenge:r}})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise(((i,r)=>{const s=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${s}`);const u=new XMLHttpRequest;u.responseType="arraybuffer",u.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(4===u.readyState)if(200===u.status){this._requestLicenseFailureCount=0;let t=u.response;this.log(`License received ${t instanceof ArrayBuffer?t.byteLength:t}`);const n=this.config.licenseResponseCallback;if(n)try{t=n.call(this.hls,u,s,e)}catch(l){this.error(l)}i(t)}else{const l=n.errorRetry,c=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>c||u.status>=400&&u.status<500)r(new Eo({type:a.KEY_SYSTEM_ERROR,details:o.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:u,response:{url:s,data:void 0,code:u.status,text:u.statusText}},`License Request XHR failed (${s}). Status: ${u.status} (${u.statusText})`));else{const n=c-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${n} attempts left`),this.requestLicense(e,t).then(i,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=u,this.setupLicenseXHR(u,s,e,t).then((({xhr:t,licenseChallenge:n})=>{e.keySystem==Nn.PLAYREADY&&(n=this.unpackPlayReadyKeyMessage(t,n)),t.send(n)}))}))}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.removeEventListener("encrypted",this.onMediaEncrypted),n.removeEventListener("waitingforkey",this.onWaitingForKey),n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null)}_clear(e){var t;const n=this.mediaKeySessions;this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Xn.clearKeyUriToKeyIdMap();const i=n.length;So.CDMCleanupPromise=Promise.all(n.map((e=>this.removeSession(e))).concat(null==e||null==(t=e.setMediaKeys(null))?void 0:t.catch((e=>{var t;this.log(`Could not clear media keys: ${e}`),null==(t=this.hls)||t.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${e}`)})})))).then((()=>{i&&(this.log("finished closing key sessions and clearing media keys"),n.length=0)})).catch((e=>{var t;this.log(`Could not close sessions and clear media keys: ${e}`),null==(t=this.hls)||t.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${e}`)})}))}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(t&&this.config.emeEnabled&&!this.keyFormatPromise){const e=t.reduce(((e,t)=>(-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e)),[]);this.log(`Selecting key-system from session-keys ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);i>-1&&this.mediaKeySessions.splice(i,1);const{drmSystemOptions:r}=this.config,s=Wn(r)?new Promise(((e,n)=>{self.setTimeout((()=>n(new Error("MediaKeySession.remove() timeout"))),8e3),t.remove().then(e)})):Promise.resolve();return s.catch((e=>{var t;this.log(`Could not remove session: ${e}`),null==(t=this.hls)||t.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${e}`)})})).then((()=>t.close())).catch((e=>{var t;this.log(`Could not close session: ${e}`),null==(t=this.hls)||t.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${e}`)})}))}}}So.CDMCleanupPromise=void 0;class Eo extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}class wo{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(u.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(u.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&"function"===typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const e=i-this.lastTime,r=n-this.lastDroppedFrames,s=t-this.lastDecodedFrames,a=1e3*r/e,o=this.hls;if(o.trigger(u.FPS_DROP,{currentDropped:r,currentDecoded:s,totalDroppedFrames:n}),a>0&&r>o.config.fpsDroppedMonitoringThreshold*s){let e=o.currentLevel;o.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===o.autoLevelCapping||o.autoLevelCapping>=e)&&(e-=1,o.trigger(u.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:o.currentLevel}),o.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function Ao(e,t){let n;try{n=new Event("addtrack")}catch(ql){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function xo(e,t){const n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(ql){k.debug(`[texttrack-utils]: ${ql}`);try{const n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(i){k.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${i}`)}}"disabled"===n&&(e.mode=n)}function Io(e,t){const n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues)for(let i=e.cues.length;i--;)t&&e.cues[i].removeEventListener("enter",t),e.removeCue(e.cues[i]);"disabled"===n&&(e.mode=n)}function ko(e,t,n,i){const r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&e.cues.length>0){const r=Ro(e.cues,t,n);for(let t=0;t<r.length;t++)i&&!i(r[t])||e.removeCue(r[t])}"disabled"===r&&(e.mode=r)}function Lo(e,t){if(t<=e[0].startTime)return 0;const n=e.length-1;if(t>e[n].endTime)return-1;let i,r=0,s=n;while(r<=s)if(i=Math.floor((s+r)/2),t<e[i].startTime)s=i-1;else{if(!(t>e[i].startTime&&r<n))return i;r=i+1}return e[r].startTime-t<t-e[s].startTime?r:s}function Ro(e,t,n){const i=[],r=Lo(e,t);if(r>-1)for(let s=r,a=e.length;s<a;s++){const r=e[s];if(r.startTime>=t&&r.endTime<=n)i.push(r);else if(r.startTime>n)return i}return i}function Co(e){const t=[];for(let n=0;n<e.length;n++){const i=e[n];"subtitles"!==i.kind&&"captions"!==i.kind||!i.label||t.push(e[n])}return t}class Do extends ea{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=null;const t=Co(this.media.textTracks);for(let i=0;i<t.length;i++)if("hidden"===t[i].mode)e=t[i];else if("showing"===t[i].mode){e=t[i];break}const n=this.findTrackForTextTrack(e);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.MANIFEST_PARSED,this.onManifestParsed,this),e.on(u.LEVEL_LOADING,this.onLevelLoading,this),e.on(u.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(u.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(u.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.MANIFEST_PARSED,this.onManifestParsed,this),e.off(u.LEVEL_LOADING,this.onLevelLoading,this),e.off(u.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(u.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(u.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const n=this.media;if(!n)return;const i=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||n.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,i)return;const r=Co(n.textTracks);r.forEach((e=>{Io(e)}))}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn(`Subtitle track with id:${n} and group:${i} not found in active group ${null==s?void 0:s.groupId}`);const a=s.details;s.details=t.details,this.log(`Subtitle track ${n} "${s.name}" lang:${s.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some((e=>-1===(null==i?void 0:i.indexOf(e))))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter((e=>!n||-1!==n.indexOf(e.groupId)));if(e.length)this.selectDefaultTrack&&!e.some((e=>e.default))&&(this.selectDefaultTrack=!1),e.forEach(((e,t)=>{e.id=t}));else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.subtitlePreference;if(!r&&t){this.selectDefaultTrack=!1;const n=mt(t,e);if(n>-1)r=e[n];else{const e=mt(t,this.tracks);r=this.tracks[e]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const s={subtitleTracks:e};this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${null==n?void 0:n.join(",")}" group-id`),this.hls.trigger(u.SUBTITLE_TRACKS_UPDATED,s),-1!==i&&-1===this.trackId&&this.setSubtitleTrack(i)}}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<t.length;i++){const r=t[i];if((!n||r.default)&&(n||e)&&(!e||vt(r,e)))return i}if(e){for(let n=0;n<t.length;n++){const i=t[n];if(na(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const i=t[n];if(na(e.attrs,i.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(ia(i,e))return n}}return-1}onError(e,t){!t.fatal&&t.context&&(t.context.type!==l.SUBTITLE_TRACK||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(-1===e.id)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&vt(e,n))return n;const i=mt(e,this.tracksInGroup);if(i>-1){const e=this.tracksInGroup[i];return this.setSubtitleTrack(i),e}if(n)return null;{const n=mt(e,t);if(n>-1)return t[n]}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,i=e.groupId,r=this.getUrlWithDirectives(e.url,t),s=e.details,a=null==s?void 0:s.age;this.log(`Loading subtitle ${n} "${e.name}" lang:${e.lang} group:${i}${void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:""}${a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""} ${r}`),this.hls.trigger(u.SUBTITLE_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Co(e.textTracks),n=this.currentTrack;let i;if(n&&(i=t.filter((e=>ia(n,e)))[0],i||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach((e=>{"disabled"!==e.mode&&e!==i&&(e.mode="disabled")})),i){const e=this.subtitleDisplay?"showing":"hidden";i.mode!==e&&(i.mode=e)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(e<-1||e>=t.length||!i(e))return void this.warn(`Invalid subtitle track id: ${e}`);this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r)return void this.hls.trigger(u.SUBTITLE_TRACK_SWITCH,{id:e});const s=!!r.details&&!r.details.live;if(e===this.trackId&&r===n&&s)return;this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:a,groupId:o="",name:l,type:c,url:d}=r;this.hls.trigger(u.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:l,type:c,url:d});const h=this.switchParams(r.url,null==n?void 0:n.details,r.details);this.loadPlaylist(h)}}function Mo(e){let t=5381,n=e.length;while(n)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()}const Po=.025;let _o=function(e){return e[e["Point"]=0]="Point",e[e["Range"]=1]="Range",e}({});function Oo(e,t,n){return`${e.identifier}-${n+1}-${Mo(t)}`}class No{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,null==(e=this.assetListLoader)||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){if(e>=this.assetList.length)return!0;const t=this.playoutLimit;if(e<=0||isNaN(t))return!1;const n=this.assetList[e].startOffset;return n>t}findAssetIndex(e){const t=this.assetList.indexOf(e);return t}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Uo(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(0===this.startTime||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,n=Uo(t,e);return t-n<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=i(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Uo(e,t)}return e}get appendInPlace(){return!!this.appendInPlaceStarted||!this.appendInPlaceDisabled&&!(this.cue.once||this.cue.pre||!this.startIsAligned||!(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Po))}set appendInPlace(e){this.appendInPlaceStarted?this.resetOnResume=!e:this.appendInPlaceDisabled=!e}get timelineStart(){return null!==this._timelineStart?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return t=null!==this._duration?this._duration:this.dateRange.duration?this.dateRange.duration:this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return"RANGE"===this.dateRange.attr["X-TIMELINE-OCCUPIES"]?_o.Range:_o.Point}get supplementsPrimary(){return"PRIMARY"===this.dateRange.attr["X-TIMELINE-STYLE"]}get contentMayVary(){return"NO"!==this.dateRange.attr["X-CONTENT-MAY-VARY"]}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||null!==this.assetListResponse}toString(){return Bo(this)}}function Uo(e,t){return e-t.start<t.duration/2&&!(Math.abs(e-(t.start+t.duration))<Po)?t.start:t.start+t.duration}function Fo(e,t,n){const i=new self.URL(e,n);return"data:"!==i.protocol&&i.searchParams.set("_HLS_primary_id",t),i}function Bo(e){return`["${e.identifier}" ${e.cue.pre?"<pre>":e.cue.post?"<post>":""}${e.timelineStart.toFixed(2)}-${e.resumeTime.toFixed(2)}]`}function jo(e){const t=e.timelineStart,n=e.duration||0;return`["${e.identifier}" ${t.toFixed(2)}-${(t+n).toFixed(2)}]`}class $o{constructor(e,t,n,i){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{const e=this.interstitial,t=e.playoutLimit,n=this.currentTime;this.startOffset+n>=t&&this.hls.trigger(u.PLAYOUT_LIMIT_REACHED,{})};const r=this.hls=new e(t);this.interstitial=n,this.assetItem=i;let s=i.uri;try{s=Fo(s,r.sessionId).href}catch(o){}r.loadSource(s);const a=()=>{this.hasDetails=!0};r.once(u.LEVEL_LOADED,a),r.once(u.AUDIO_TRACK_LOADED,a),r.once(u.SUBTITLE_TRACK_LOADED,a),r.on(u.MEDIA_ATTACHING,((e,{media:t})=>{this.removeMediaListeners(),this.mediaAttached=t;const n=this.interstitial;n.playoutLimit&&t.addEventListener("timeupdate",this.checkPlayout)}))}bufferedInPlaceToEnd(e){var t;if(!this.interstitial.appendInPlace)return!1;if(null!=(t=this.hls)&&t.bufferedToEnd)return!0;if(!e||!this._bufferedEosTime)return!1;const n=this.timelineOffset,i=fn.bufferInfo(e,n,0),r=this.getAssetTime(i.end);return r>=this._bufferedEosTime-.02}get destroyed(){var e;return!(null!=(e=this.hls)&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return(null==(e=this.hls)?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=fn.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;return e||0}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return(null==(e=this.hls)?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const n=e-t;if(Math.abs(n)>1/9e4){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,n=this.duration;return Math.min(Math.max(0,e-t),n)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){var e;this.mediaAttached&&(null!=(e=this.hls)&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd))}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){this.hls.attachMedia(e)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}on(e,t,n){this.hls.on(e,t)}once(e,t,n){this.hls.once(e,t)}off(e,t,n){this.hls.off(e,t)}toString(){var e,t;return`HlsAssetPlayer: ${jo(this.assetItem)} ${null==(e=this.hls)?void 0:e.sessionId} ${null!=(t=this.interstitial)&&t.appendInPlace?"append-in-place":""}`}}const Go=.033;class Vo extends b{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach((e=>e.reset())),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce(((n,i)=>e<=i.startOffset&&t>i.startOffset?(delete i.error,n+1):n),0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let n=-1;e.nextEvent?n=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(n=this.findEventIndex(e.previousEvent.identifier)+1);const i=this.items;if(i){i[n]||(void 0===t&&(t=e.start),n=this.findItemIndexAtTime(t));while(n>=0&&null!=(r=i[n])&&r.event){var r;n--}}return n}findItemIndexAtTime(e,t){const n=this.items;if(n)for(let i=0;i<n.length;i++){let r=n[i];if(t&&"primary"!==t&&(r=r[t]),e===r.start||e>r.start&&e<r.end)return i}return-1}findJumpRestrictedIndex(e,t){const n=this.items;if(n)for(let i=e;i<=t;i++){if(!n[i])break;const e=n[i].event;if(null!=e&&e.restrictions.jump&&!e.appendInPlace)return i}return-1}findEventIndex(e){const t=this.items;if(t)for(let i=t.length;i--;){var n;if((null==(n=t[i].event)?void 0:n.identifier)===e)return i}return-1}findAssetIndex(e,t){const n=e.assetList,i=n.length;if(i>1)for(let r=0;r<i;r++){const e=n[r];if(!e.error){const n=e.timelineStart;if(t===n||t>n&&t<n+(e.duration||0))return r}}return 0}get assetIdAtEnd(){var e,t;const n=null==(e=this.items)||null==(t=e[this.length-1])?void 0:t.event;if(n){const e=n.assetList,t=e[e.length-1];if(t)return t.identifier}return null}parseInterstitialDateRanges(e,t){const n=e.main.details,{dateRanges:i}=n,r=this.events,s=this.parseDateRanges(i,{url:n.url},t),a=Object.keys(i),o=r?r.filter((e=>!a.includes(e.identifier))):[];s.length&&s.sort(((e,t)=>{const n=e.cue.pre,i=e.cue.post,r=t.cue.pre,s=t.cue.post;if(n&&!r)return-1;if(r&&!n)return 1;if(i&&!s)return 1;if(s&&!i)return-1;if(!n&&!r&&!i&&!s){const n=e.startTime,i=t.startTime;if(n!==i)return n-i}return e.dateRange.tagOrder-t.dateRange.tagOrder})),this.events=s,o.forEach((e=>{this.removeEvent(e)})),this.updateSchedule(e,o)}updateSchedule(e,t=[]){const n=this.events||[];if(n.length||t.length||this.length<2){const i=this.items,r=this.parseSchedule(n,e),s=t.length||(null==i?void 0:i.length)!==r.length||r.some(((e,t)=>Math.abs(e.playout.start-i[t].playout.start)>.005||Math.abs(e.playout.end-i[t].playout.end)>.005));s&&(this.items=r,this.onScheduleUpdate(t,i))}}parseDateRanges(e,t,n){const i=[],r=Object.keys(e);for(let s=0;s<r.length;s++){const a=r[s],o=e[a];if(o.isInterstitial){let e=this.eventMap[a];e?e.setDateRange(o):(e=new No(o,t),this.eventMap[a]=e,!1===n&&(e.appendInPlace=n)),i.push(e)}}return i}parseSchedule(e,t){const n=[],i=t.main.details,r=i.live?1/0:i.edge;let s=0;if(e=e.filter((e=>!e.error&&!(e.cue.once&&e.hasPlayed))),e.length){this.resolveOffsets(e,t);let i=0,o=0;if(e.forEach(((t,a)=>{const u=t.cue.pre,l=t.cue.post,c=e[a-1]||null,d=t.appendInPlace,h=l?r:t.startOffset,f=t.duration,p=t.timelineOccupancy===_o.Range?f:0,g=t.resumptionOffset,m=(null==c?void 0:c.startTime)===h,v=h+t.cumulativeDuration;let y=d?v+f:h+g;if(u||!l&&h<=0){const e=o;o+=p,t.timelineStart=v;const i=s;s+=f,n.push({event:t,start:v,end:y,playout:{start:i,end:s},integrated:{start:e,end:o}})}else{if(!(h<=r))return;{if(!m){const r=h-i;if(r>Go){const u=i,l=o;o+=r;const c=s;s+=r;const d={previousEvent:e[a-1]||null,nextEvent:t,start:u,end:u+r,playout:{start:c,end:s},integrated:{start:l,end:o}};n.push(d)}else r>0&&c&&(c.cumulativeDuration+=r,n[n.length-1].end=h)}l&&(y=v),t.timelineStart=v;const r=o;o+=p;const u=s;s+=f,n.push({event:t,start:v,end:y,playout:{start:u,end:s},integrated:{start:r,end:o}})}}const b=t.resumeTime;i=l||b>r?r:b})),i<r){var a;const e=i,t=o,u=r-i;o+=u;const l=s;s+=u,n.push({previousEvent:(null==(a=n[n.length-1])?void 0:a.event)||null,nextEvent:null,start:i,end:e+u,playout:{start:l,end:s},integrated:{start:t,end:o}})}this.setDurations(r,s,o)}else{const e=0;n.push({previousEvent:null,nextEvent:null,start:e,end:r,playout:{start:e,end:r},integrated:{start:e,end:r}}),this.setDurations(r,r,r)}return n}setDurations(e,t,n){this.durations={primary:e,playout:t,integrated:n}}resolveOffsets(e,t){const n=t.main.details,r=n.live?1/0:n.edge;let s=0,a=-1;e.forEach(((o,u)=>{const l=o.cue.pre,c=o.cue.post,d=l?0:c?r:o.startTime;this.updateAssetDurations(o);const h=a===d;if(h?o.cumulativeDuration=s:(s=0,a=d),!c&&o.snapOptions.in&&(o.resumeAnchor=kt(null,n.fragments,o.startOffset+o.resumptionOffset,0,0)||void 0),o.appendInPlace&&!o.appendInPlaceStarted){const e=this.primaryCanResumeInPlaceAt(o,t);e||(o.appendInPlace=!1)}if(!o.appendInPlace&&u+1<e.length){const t=e[u+1].startTime-e[u].resumeTime;t<Go&&(e[u+1].appendInPlace=!1,e[u+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${o}`))}const f=i(o.resumeOffset)?o.resumeOffset:o.duration;s+=f}))}primaryCanResumeInPlaceAt(e,t){const n=e.resumeTime,i=e.startTime+e.resumptionOffset;if(Math.abs(n-i)>Po)return this.log(`"${e.identifier}" resumption ${n} not aligned with estimated timeline end ${i}`),!1;if(!t)return this.log(`"${e.identifier}" resumption ${n} can not be aligned with media (none selected)`),!1;const r=Object.keys(t);return!r.some((i=>{const r=t[i].details,s=r.edge;if(n>=s)return this.log(`"${e.identifier}" resumption ${n} past ${i} playlist end ${s}`),!1;const a=kt(null,r.fragments,n);if(!a)return this.log(`"${e.identifier}" resumption ${n} does not align with any fragments in ${i} playlist (${r.fragStart}-${r.fragmentEnd})`),!0;const o="audio"===i?.175:0,u=Math.abs(a.start-n)<Po+o||Math.abs(a.end-n)<Po+o;return!u&&(this.log(`"${e.identifier}" resumption ${n} not aligned with ${i} fragment bounds (${a.start}-${a.end} sn: ${a.sn} cc: ${a.cc})`),!0)}))}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let n=0,i=!1,r=!1;e.assetList.forEach(((e,s)=>{const a=t+n;e.startOffset=n,e.timelineStart=a,i||(i=null===e.duration),r||(r=!!e.error);const o=e.error?0:e.duration||0;n+=o})),e.duration=i&&!r?Math.max(n,e.duration):n}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function Ho(e){return`[${e.event?'"'+e.event.identifier+'"':"primary"}: ${e.start.toFixed(2)}-${e.end.toFixed(2)}]`}class Ko{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const n=e.assetListUrl;let i;try{i=Fo(n,this.hls.sessionId,e.baseUrl)}catch(f){const t=this.assignAssetListError(e,o.ASSET_LIST_LOAD_ERROR,f,n);return void this.hls.trigger(u.ERROR,t)}t&&"data:"!==i.protocol&&i.searchParams.set("_HLS_start_offset",""+t);const r=this.hls.config,s=r.loader,a=new s(r),l={responseType:"json",url:i.href},c=r.interstitialAssetListLoadPolicy.default,d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(t,n,i,r)=>{const s=t.data,a=null==s?void 0:s.ASSETS;if(Array.isArray(a))e.assetListResponse=s,this.hls.trigger(u.ASSET_LIST_LOADED,{event:e,assetListResponse:s,networkDetails:r});else{const t=this.assignAssetListError(e,o.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),i.url,n,r);this.hls.trigger(u.ERROR,t)}},onError:(t,n,i,r)=>{const s=this.assignAssetListError(e,o.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${t.code} ${t.text} (${n.url})`),n.url,r,i);this.hls.trigger(u.ERROR,s)},onTimeout:(t,n,i)=>{const r=this.assignAssetListError(e,o.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${n.url})`),n.url,t,i);this.hls.trigger(u.ERROR,r)}};return a.load(l,d,h),this.hls.trigger(u.ASSET_LIST_LOADING,{event:e}),a}assignAssetListError(e,t,n,i,r,s){return e.error=n,{type:a.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:i,error:n,networkDetails:s,stats:r}}}function Wo(e,t,n){qo(e,t,n),e.addEventListener(t,n)}function qo(e,t,n){e.removeEventListener(t,n)}function Yo(e){null==e||e.play().catch((()=>{}))}class Xo extends b{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const e=this.currentTime;if(void 0===e||this.playbackDisabled)return;const t=e-this.timelinePos,n=Math.abs(t)<1/7056e5;if(n)return;const i=t<=-.01;this.timelinePos=e,this.bufferedPos=e;const r=this.playingItem;if(!r)return void this.checkBuffer();if(i){const n=this.schedule.resetErrorsInRange(e,e-t);n&&this.updateSchedule()}if(this.checkBuffer(),i&&e<r.start||e>=r.end){var s;const e=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(r)&&null!=(s=this.media)&&s.paused&&(this.shouldPlay=!1),!i){const t=this.findItemIndex(r);if(e>t){const n=this.schedule.findJumpRestrictedIndex(t+1,e);if(n>t)return void this.setSchedulePosition(n)}}return void this.setSchedulePosition(e)}const a=this.playingAsset;if(!a){if(this.playingLastItem&&this.isInterstitial(r)){const t=r.event.assetList[0];t&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(e,t))}return}const o=a.timelineStart,u=a.duration||0;(i&&e<o||e>=o+u)&&this.setScheduleToAssetAtTime(e,a)},this.onTimeupdate=()=>{const e=this.currentTime;if(void 0===e||this.playbackDisabled)return;if(!(e>this.timelinePos))return;this.timelinePos=e,e>this.bufferedPos&&this.checkBuffer();const t=this.playingItem;if(!t||this.playingLastItem)return;if(e>=t.end){this.timelinePos=t.end;const e=this.findItemIndex(t);this.setSchedulePosition(e+1)}const n=this.playingAsset;if(!n)return;const i=n.timelineStart+(n.duration||0);e>=i&&this.setScheduleToAssetAtTime(e,n)},this.onScheduleUpdate=(e,t)=>{const n=this.schedule,i=this.playingItem,r=n.events||[],s=n.items||[],a=n.durations,o=e.map((e=>e.identifier)),l=!(!r.length&&!o.length);if(l&&this.log(`INTERSTITIALS_UPDATED (${r.length}): ${r}\nSchedule: ${s.map((e=>Ho(e)))}`),o.length&&this.log(`Removed events ${o}`),this.playerQueue.forEach((e=>{if(e.interstitial.appendInPlace){const n=e.assetItem.timelineStart,i=e.timelineOffset-n;if(i)try{e.timelineOffset=n}catch(t){Math.abs(i)>Po&&this.warn(`${t} ("${e.assetId}" ${e.timelineOffset}->${n})`)}}})),i){const e=this.updateItem(i,this.timelinePos);this.itemsMatch(i,e)&&(this.playingItem=e,this.waitingItem=this.endedItem=null)}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const c=this.bufferingItem;if(c){const e=this.updateItem(c,this.bufferedPos);this.itemsMatch(c,e)?this.bufferingItem=e:c.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(c.event,null))}if(e.forEach((e=>{e.assetList.forEach((e=>{this.clearAssetPlayer(e.identifier,null)}))})),l||t){if(this.hls.trigger(u.INTERSTITIALS_UPDATED,{events:r.slice(0),schedule:s.slice(0),durations:a,removedIds:o}),this.isInterstitial(i)&&o.includes(i.event.identifier))return this.warn(`Interstitial "${i.event.identifier}" removed while playing`),void this.primaryFallback(i.event);this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new Ko(e),this.schedule=new Vo(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(u.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(u.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(u.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(u.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(u.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(u.BUFFER_APPENDED,this.onBufferAppended,this),e.on(u.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(u.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(u.MEDIA_ENDED,this.onMediaEnded,this),e.on(u.ERROR,this.onError,this),e.on(u.DESTROYING,this.onDestroying,this)}unregisterListeners(){const e=this.hls;e&&(e.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(u.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(u.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(u.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(u.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(u.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(u.BUFFER_CODECS,this.onBufferCodecs,this),e.off(u.BUFFER_APPENDED,this.onBufferAppended,this),e.off(u.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(u.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(u.MEDIA_ENDED,this.onMediaEnded,this),e.off(u.ERROR,this.onError,this),e.off(u.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;null==(e=this.getBufferingPlayer())||e.resumeBuffering()}pauseBuffering(){var e;null==(e=this.getBufferingPlayer())||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){qo(e,"play",this.onPlay),qo(e,"pause",this.onPause),qo(e,"seeking",this.onSeeking),qo(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const n=this.media=t.media;Wo(n,"seeking",this.onSeeking),Wo(n,"timeupdate",this.onTimeupdate),Wo(n,"play",this.onPlay),Wo(n,"pause",this.onPause)}onMediaAttached(e,t){const n=this.effectivePlayingItem,i=this.detachedData;if(this.detachedData=null,null===n)this.checkStart();else if(!i){this.clearScheduleState();const e=this.findItemIndex(n);this.setSchedulePosition(e)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const n=!!t.transferMedia,i=this.media;if(this.media=null,!n&&(i&&this.removeMediaListeners(i),this.detachedData)){const e=this.getBufferingPlayer();e&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,e.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const e=this,t=()=>e.bufferingItem||e.waitingItem,n=t=>t?e.getAssetPlayer(t.identifier):t,i=(t,i,r,a,o)=>{if(t){let u=t[i].start;const l=t.event;if(l){if("playout"===i||l.timelineOccupancy!==_o.Point){const e=n(r);(null==e?void 0:e.interstitial)===l&&(u+=e.assetItem.startOffset+e[o])}}else{const n="bufferedPos"===a?s():e[a];u+=n-t.start}return u}return 0},r=(t,n)=>{if(0!==t&&"primary"!==n&&e.schedule.length){var i;const r=e.schedule.findItemIndexAtTime(t),s=null==(i=e.schedule.items)?void 0:i[r];if(s){const e=s[n].start-s.start;return t+e}}return t},s=()=>{const t=e.bufferedPos;return t===Number.MAX_VALUE?a("primary"):Math.max(t,0)},a=t=>{var n;return null!=(n=e.primaryDetails)&&n.live?e.primaryDetails.edge:e.schedule.durations[t]},o=(t,r)=>{var s,a;const o=e.effectivePlayingItem;if(null!=o&&null!=(s=o.event)&&s.restrictions.skip)return;e.log(`seek to ${t} "${r}"`);const u=e.effectivePlayingItem,l=e.schedule.findItemIndexAtTime(t,r),c=null==(a=e.schedule.items)?void 0:a[l],d=e.getBufferingPlayer(),h=null==d?void 0:d.interstitial,f=null==h?void 0:h.appendInPlace,p=u&&e.itemsMatch(u,c);if(u&&(f||p)){const s=n(e.playingAsset),a=(null==s?void 0:s.media)||e.primaryMedia;if(a){const n="primary"===r?a.currentTime:i(u,r,e.playingAsset,"timelinePos","currentTime"),o=t-n,l=(f?n:a.currentTime)+o;if(l>=0&&(!s||f||l<=s.duration))return void(a.currentTime=l)}}if(c){let n=t;if("primary"!==r){const e=c[r].start,i=t-e;n=c.start+i}const i=!e.isInterstitial(c);if(e.isInterstitial(u)&&!u.event.appendInPlace||!i&&!c.event.appendInPlace){if(u){const s=e.findItemIndex(u);if(l>s){const t=e.schedule.findJumpRestrictedIndex(s+1,l);if(t>s)return void e.setSchedulePosition(t)}let a=0;if(i)e.timelinePos=n,e.checkBuffer();else{var g;const e=null==c||null==(g=c.event)?void 0:g.assetList;if(e){const n=t-(c[r]||c).start;for(let t=e.length;t--;){const i=e[t];if(i.duration&&n>=i.startOffset&&n<i.startOffset+i.duration){a=t;break}}}}e.setSchedulePosition(l,a)}}else{const t=e.media||(f?null==d?void 0:d.media:null);t&&(t.currentTime=n)}}},u=()=>{const n=e.effectivePlayingItem;if(e.isInterstitial(n))return n;const i=t();return e.isInterstitial(i)?i:null},l={get currentTime(){const t=u(),n=e.effectivePlayingItem;return n&&n===t?i(n,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-n.playout.start:0},set currentTime(t){const n=u(),i=e.effectivePlayingItem;i&&i===n&&o(t+i.playout.start,"playout")},get duration(){const e=u();return e?e.playout.end-e.playout.start:0},get assetPlayers(){var t;const n=null==(t=u())?void 0:t.event.assetList;return n?n.map((t=>e.getAssetPlayer(t.identifier))):[]},get playingIndex(){var t;const n=null==(t=u())?void 0:t.event;return n&&e.effectivePlayingAsset?n.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return u()}};this.manager={get events(){var t,n;return(null==(t=e.schedule)||null==(n=t.events)?void 0:n.slice(0))||[]},get schedule(){var t,n;return(null==(t=e.schedule)||null==(n=t.items)?void 0:n.slice(0))||[]},get interstitialPlayer(){return u()?l:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const n=t();return e.findItemIndex(n)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const t=e.effectivePlayingItem;return e.findItemIndex(t)},primary:{get bufferedEnd(){return s()},get currentTime(){const t=e.timelinePos;return t>0?t:0},set currentTime(e){o(e,"primary")},get duration(){return a("primary")},get seekableStart(){var t;return(null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0}},integrated:{get bufferedEnd(){return i(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return i(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(e){o(e,"integrated")},get duration(){return a("integrated")},get seekableStart(){var t;return r((null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0,"integrated")}},skip:()=>{const t=e.effectivePlayingItem,n=null==t?void 0:t.event;if(n&&!n.restrictions.skip){const i=e.findItemIndex(t);if(n.appendInPlace){const e=t.playout.start+t.event.duration;o(e+.001,"playout")}else e.advanceAfterAssetEnded(n,i,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,n=null==(e=this.schedule)?void 0:e.items;return!!(this.playbackStarted&&t&&n)&&this.findItemIndex(t)===n.length-1}get playbackStarted(){return null!==this.effectivePlayingItem}get currentTime(){var e,t,n;if(null===this.mediaSelection)return;const r=this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&!r.event.appendInPlace)return;let s=this.media;!s&&null!=(e=this.bufferingItem)&&null!=(t=e.event)&&t.appendInPlace&&(s=this.primaryMedia);const a=null==(n=s)?void 0:n.currentTime;return void 0!==a&&i(a)?a:void 0}get primaryMedia(){var e;return this.media||(null==(e=this.detachedData)?void 0:e.media)||null}isInterstitial(e){return!(null==e||!e.event)}retreiveMediaSource(e,t){const n=this.getAssetPlayer(e);n&&this.transferMediaFromPlayer(n,t)}transferMediaFromPlayer(e,t){const n=e.interstitial.appendInPlace,i=e.media;if(n&&i===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&i)return void(this.detachedData={media:i});const n=e.transferMedia();this.log(`transfer MediaSource from ${e} ${ct(n)}`),this.detachedData=n}else t&&i&&(this.shouldPlay||(this.shouldPlay=!i.paused))}transferMediaTo(e,t){var n,i;if(e.media===t)return;let r=null;const s=this.hls,a=e!==s,o=a&&e.interstitial.appendInPlace,u=null==(n=this.detachedData)?void 0:n.mediaSource;let l;if(s.media)o&&(r=s.transferMedia(),this.detachedData=r),l="Primary";else if(u){const e=this.getBufferingPlayer();e?(r=e.transferMedia(),l=`${e}`):l="detached MediaSource"}else l="detached media";if(!r)if(u)r=this.detachedData,this.log(`using detachedData: MediaSource ${ct(r)}`);else if(!this.detachedData||s.media===t){const e=this.playerQueue;e.length>1&&e.forEach((e=>{if(a&&e.interstitial.appendInPlace!==o){const t=e.interstitial;this.clearInterstitial(e.interstitial,null),t.appendInPlace=!1,t.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${t}`)}})),this.hls.detachMedia(),this.detachedData={media:t}}const c=r&&"mediaSource"in r&&"closed"!==(null==(i=r.mediaSource)?void 0:i.readyState),d=c&&r?r:t;if(this.log(`${c?"transfering MediaSource":"attaching media"} to ${a?e:"Primary"} from ${l}`),d===r){const t=a&&e.assetId===this.schedule.assetIdAtEnd;d.overrides={duration:this.schedule.duration,endOfStream:!a||t,cueRemoval:!a}}e.attachMedia(d)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e.events;if(!t||this.playbackDisabled||!this.media)return;-1===this.bufferedPos&&(this.bufferedPos=0);const n=this.timelinePos,i=this.effectivePlayingItem;if(-1===n){const n=this.hls.startPosition;if(this.timelinePos=n,t.length&&t[0].cue.pre){const n=e.findEventIndex(t[0].identifier);this.setSchedulePosition(n)}else if(n>=0||!this.primaryLive){const t=this.timelinePos=n>0?n:0,i=e.findItemIndexAtTime(t);this.setSchedulePosition(i)}}else if(i&&!this.playingItem){const t=e.findItemIndex(i);this.setSchedulePosition(t)}}advanceAfterAssetEnded(e,t,n){const i=n+1;if(e.isAssetPastPlayoutLimit(i)||e.assetList[i].error){const n=this.schedule.items;if(n){const i=t+1,r=n.length;if(i>=r)return void this.setSchedulePosition(-1);const s=e.resumeTime;this.timelinePos<s&&(this.timelinePos=s,this.checkBuffer()),this.setSchedulePosition(i)}}else this.setSchedulePosition(t,i)}setScheduleToAssetAtTime(e,t){const n=this.schedule,i=t.parentIdentifier,r=n.getEvent(i);if(r){const t=n.findEventIndex(i),s=n.findAssetIndex(r,e);this.setSchedulePosition(t,s)}}setSchedulePosition(e,t){const n=this.schedule.items;if(!n||this.playbackDisabled)return;this.log(`setSchedulePosition ${e}, ${t}`);const i=e>=0?n[e]:null,r=this.playingItem,s=this.playingLastItem;if(this.isInterstitial(r)){var a;const l=r.event,c=this.playingAsset,d=null==c?void 0:c.identifier,h=d?this.getAssetPlayer(d):null;if(h&&d&&(!this.eventItemsMatch(r,i)||void 0!==t&&d!==(null==(a=l.assetList)?void 0:a[t].identifier))){var o;const t=l.findAssetIndex(c);this.log(`INTERSTITIAL_ASSET_ENDED ${t+1}/${l.assetList.length} ${jo(c)}`),this.endedAsset=c,this.playingAsset=null,this.hls.trigger(u.INTERSTITIAL_ASSET_ENDED,{asset:c,assetListIndex:t,event:l,schedule:n.slice(0),scheduleIndex:e,player:h}),this.retreiveMediaSource(d,i),!h.media||null!=(o=this.detachedData)&&o.mediaSource||h.detachMedia()}if(!this.eventItemsMatch(r,i)&&(this.endedItem=r,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${l} ${Ho(r)}`),l.hasPlayed=!0,this.hls.trigger(u.INTERSTITIAL_ENDED,{event:l,schedule:n.slice(0),scheduleIndex:e}),l.cue.once)){this.updateSchedule();const e=this.schedule.items;if(i&&e){const n=this.schedule.findItemIndex(i);this.advanceSchedule(n,e,t,r,s)}return}}this.advanceSchedule(e,n,t,r,s)}advanceSchedule(e,t,n,i,r){const s=e>=0?t[e]:null,a=this.primaryMedia,o=this.playerQueue;if(o.length&&o.forEach((t=>{const n=t.interstitial,i=this.schedule.findEventIndex(n.identifier);(i<e||i>e+1)&&this.clearInterstitial(n,s)})),this.isInterstitial(s)){this.timelinePos=Math.min(Math.max(this.timelinePos,s.start),s.end);const r=s.event;void 0===n&&(n=this.schedule.findAssetIndex(r,this.timelinePos));const o=this.waitingItem;this.assetsBuffered(s,a)||this.setBufferingItem(s);let l=this.preloadAssets(r,n);if(this.eventItemsMatch(s,o||i)||(this.waitingItem=s,this.log(`INTERSTITIAL_STARTED ${Ho(s)} ${r.appendInPlace?"append in place":""}`),this.hls.trigger(u.INTERSTITIAL_STARTED,{event:r,schedule:t.slice(0),scheduleIndex:e})),!r.assetListLoaded)return void this.log(`Waiting for ASSET-LIST to complete loading ${r}`);if(r.assetListLoader&&(r.assetListLoader.destroy(),r.assetListLoader=void 0),!a)return void this.log(`Waiting for attachMedia to start Interstitial ${r}`);this.waitingItem=this.endedItem=null,this.playingItem=s;const c=r.assetList[n];if(!c){const i=t[e+1],s=this.media;return i&&s&&!this.isInterstitial(i)&&s.currentTime<i.start&&(s.currentTime=this.timelinePos=i.start),void this.advanceAfterAssetEnded(r,e,n||0)}if(l||(l=this.getAssetPlayer(c.identifier)),null===l||l.destroyed){const e=r.assetList.length;this.warn(`asset ${n+1}/${e} player destroyed ${r}`),l=this.createAssetPlayer(r,c,n)}if(!this.eventItemsMatch(s,this.bufferingItem)&&r.appendInPlace&&this.isAssetBuffered(c))return;this.startAssetPlayer(l,n,t,e,a),this.shouldPlay&&Yo(l.media)}else null!==s?(this.resumePrimary(s,e,i),this.shouldPlay&&Yo(this.hls.media)):r&&this.isInterstitial(i)&&(this.endedItem=null,this.playingItem=i,i.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return!1===this.hls.config.enableInterstitialPlayback}get primaryDetails(){var e,t;return null==(e=this.mediaSelection)||null==(t=e.main)?void 0:t.details}get primaryLive(){var e;return!(null==(e=this.primaryDetails)||!e.live)}resumePrimary(e,t,n){var i;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${Ho(e)}`),null==(i=this.detachedData)||!i.mediaSource){let n=this.timelinePos;(n<e.start||n>=e.end)&&(n=this.getPrimaryResumption(e,t),this.timelinePos=n),this.attachPrimary(n,e)}if(!n)return;const r=this.schedule.items;r&&(this.log(`resumed ${Ho(e)}`),this.hls.trigger(u.INTERSTITIALS_PRIMARY_RESUMED,{schedule:r.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const n=e.start;if(this.primaryLive){const e=this.primaryDetails;if(0===t)return this.hls.startPosition;if(e&&(n<e.fragmentStart||n>e.edge))return this.hls.liveSyncPosition||-1}return n}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);if(null!=t&&t.hls)return t.hls.bufferedToEnd;const n=fn.bufferInfo(this.primaryMedia,this.timelinePos,0);return n.end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,n){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const i=this.primaryMedia;if(!i)return;const r=this.hls;r.media?this.checkBuffer():(this.transferMediaTo(r,i),n&&this.startLoadingPrimaryAt(e,n)),n||(this.timelinePos=e,this.startLoadingPrimaryAt(e,n))}startLoadingPrimaryAt(e,t){var n;const i=this.hls;!i.loadingEnabled||!i.media||Math.abs(((null==(n=i.mainForwardBufferInfo)?void 0:n.start)||i.media.currentTime)-e)>.5?i.startLoad(e,t):i.bufferingEnabled||i.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(u.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(u.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(-1===t.level)return;const n=this.hls.levels[t.level],i=m(m({},this.mediaSelection||this.altSelection),{},{main:n});this.mediaSelection=i,this.schedule.parseInterstitialDateRanges(i,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const n=this.hls.audioTracks[t.id],i=this.mediaSelection;if(!i)return void(this.altSelection=m(m({},this.altSelection),{},{audio:n}));const r=m(m({},i),{},{audio:n});this.mediaSelection=r}onSubtitleTrackUpdated(e,t){const n=this.hls.subtitleTracks[t.id],i=this.mediaSelection;if(!i)return void(this.altSelection=m(m({},this.altSelection),{},{subtitles:n}));const r=m(m({},i),{},{subtitles:n});this.mediaSelection=r}onAudioTrackSwitching(e,t){const n=gt(t);this.playerQueue.forEach((e=>e.hls.setAudioOption(t)||e.hls.setAudioOption(n)))}onSubtitleTrackSwitch(e,t){const n=gt(t);this.playerQueue.forEach((e=>e.hls.setSubtitleOption(t)||-1!==t.id&&e.hls.setSubtitleOption(n)))}onBufferCodecs(e,t){const n=t.tracks;n&&(this.requiredTracks=n)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const n=this.playingItem;if(n&&!this.itemsMatch(n,this.bufferingItem)&&!this.isInterstitial(n)){const e=this.timelinePos;this.bufferedPos=e,this.checkBuffer()}}onBufferedToEnd(e){const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let e=0;e<t.length;e++){const i=t[e];if(i.cue.post){var n;const e=this.schedule.findEventIndex(i.identifier),t=null==(n=this.schedule.items)?void 0:n[e];this.isInterstitial(t)&&this.eventItemsMatch(t,this.bufferingItem)&&this.bufferedToItem(t,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const e=this.findItemIndex(t);this.setSchedulePosition(e+1)}else this.shouldPlay=!1}updateItem(e,t){const n=this.schedule.items;if(e&&n){const i=this.findItemIndex(e,t);return n[i]||null}return null}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var n;return!!t&&(e===t||e.event.identifier===(null==(n=t.event)?void 0:n.identifier))}findItemIndex(e,t){return e?this.schedule.findItemIndex(e,t):-1}updateSchedule(){const e=this.mediaSelection;e&&this.schedule.updateSchedule(e,[])}checkBuffer(e){const t=this.schedule.items;if(!t)return;const n=fn.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=n.len<1),this.updateBufferedPos(n.end,t,e)}updateBufferedPos(e,t,n){const i=this.schedule,r=this.bufferingItem;if(this.bufferedPos>e)return;if(1===t.length&&this.itemsMatch(t[0],r))return void(this.bufferedPos=e);const s=this.playingItem,a=this.findItemIndex(s);let o=i.findItemIndexAtTime(e);if(this.bufferedPos<e){var u,l;const n=this.findItemIndex(r),i=Math.min(n+1,t.length-1),s=t[i];if((-1===o&&r&&e>=r.end||null!=(u=s.event)&&u.appendInPlace&&e+.01>=s.start)&&(o=i),i-a>1&&!1===(null==r||null==(l=r.event)?void 0:l.appendInPlace))return;if(this.bufferedPos=e,o>n&&o>a)this.bufferedToItem(s);else{const t=this.primaryDetails;this.primaryLive&&t&&e>t.edge-t.targetduration&&s.start<t.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(s)&&this.preloadAssets(s.event,0)}}else n&&s&&!this.itemsMatch(s,r)&&(o===a?this.bufferedToItem(s):o===a+1&&this.bufferedToItem(t[o]))}assetsBuffered(e,t){const n=e.event.assetList;return 0!==n.length&&!e.event.assetList.some((e=>{const n=this.getAssetPlayer(e.identifier);return!(null!=n&&n.bufferedInPlaceToEnd(t))}))}setBufferingItem(e){const t=this.bufferingItem,n=this.schedule;if(this.itemsMatch(e,t))this.bufferingItem!==e&&(this.bufferingItem=e);else{const{items:i,events:r}=n;if(!i||!r)return t;const s=this.isInterstitial(e),a=this.getBufferingPlayer();if(this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos)),!this.playbackDisabled){const n=a?a.remaining:t?t.end-this.timelinePos:0;this.log(`buffered to boundary ${Ho(e)}`+(t?` (${n.toFixed(2)} remaining)`:"")),s?e.event.assetList.forEach((e=>{const t=this.getAssetPlayer(e.identifier);t&&t.resumeBuffering()})):(this.hls.resumeBuffering(),this.playerQueue.forEach((e=>e.pauseBuffering())))}this.hls.trigger(u.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:r.slice(0),schedule:i.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}return t}bufferedToItem(e,t=0){const n=this.setBufferingItem(e);if(!this.playbackDisabled)if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(null!==n){this.bufferingAsset=null;const t=this.detachedData;if(t)if(t.mediaSource){const t=!0;this.attachPrimary(e.start,e,t)}else this.preloadPrimary(e);else this.preloadPrimary(e)}}preloadPrimary(e){const t=this.findItemIndex(e),n=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(n)}bufferedToEvent(e,t){const n=e.event,i=0===n.assetList.length&&!n.assetListLoader,r=n.cue.once;if(i||!r){const e=this.preloadAssets(n,t);if(null!=e&&e.interstitial.appendInPlace){const i=n.assetList[t],r=this.primaryMedia;i&&r&&this.bufferAssetPlayer(e,r)}}}preloadAssets(e,t){const n=e.assetUrl,i=e.assetList.length,r=0===i&&!e.assetListLoader,s=e.cue.once;if(r){const r=e.timelineStart;if(e.appendInPlace){var a;const t=this.playingItem;this.isInterstitial(t)||(null==t||null==(a=t.nextEvent)?void 0:a.identifier)!==e.identifier||this.flushFrontBuffer(r+.25)}let s,o=0;if(!this.playingItem&&this.primaryLive&&(o=this.hls.startPosition,-1===o&&(o=this.hls.liveSyncPosition||0)),o&&!e.cue.pre&&!e.cue.post){const e=o-r;e>0&&(s=Math.round(1e3*e)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${n?1:i} ${e}${s?` live-start: ${o} start-offset: ${s}`:""}`),n)return this.createAsset(e,0,0,r,e.duration,n);const u=this.assetListLoader.loadAssetList(e,s);u&&(e.assetListLoader=u)}else if(!s&&i){for(let n=t;n<i;n++){const t=e.assetList[n],i=this.getAssetPlayerQueueIndex(t.identifier);-1!==i&&!this.playerQueue[i].destroyed||t.error||this.createAssetPlayer(e,t,n)}return this.getAssetPlayer(e.assetList[t].identifier)}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`);const n=Object.keys(t);n.forEach((t=>{this.hls.trigger(u.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:t})}))}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let n=0;n<t.length;n++)if(e===t[n].assetId)return n;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t)for(let n=0;n<e.length;n++)if(e[n].media===t)return e[n];return null}createAsset(e,t,n,i,r,s){const a={parentIdentifier:e.identifier,identifier:Oo(e,s,t),duration:r,startOffset:n,timelineStart:i,uri:s};return this.createAssetPlayer(e,a,t)}createAssetPlayer(e,t,n){this.log(`create HLSAssetPlayer for ${jo(t)}`);const i=this.hls,r=i.userConfig;let s=r.videoPreference;const l=i.loadLevelObj||i.levels[i.currentLevel];(s||l)&&(s=p({},s),l.videoCodec&&(s.videoCodec=l.videoCodec),l.videoRange&&(s.allowedVideoRanges=[l.videoRange]));const c=i.audioTracks[i.audioTrack],d=i.subtitleTracks[i.subtitleTrack];let h=0;if(this.primaryLive||e.appendInPlace){const e=this.timelinePos-t.timelineStart;if(e>1){const n=t.duration;n&&e<n&&(h=e)}}const f=t.identifier,g=m(m({},r),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:i.sessionId,assetPlayerId:f,abrEwmaDefaultEstimate:i.bandwidthEstimate,interstitialsController:void 0,startPosition:h,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:s,audioPreference:c||r.audioPreference,subtitlePreference:d||r.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(g.timelineOffset=t.timelineStart));const v=g.cmcd;null!=v&&v.sessionId&&v.contentId&&(g.cmcd=p({},v,{contentId:Mo(t.uri)})),this.getAssetPlayer(f)&&this.warn(`Duplicate date range identifier ${e} and asset ${f}`);const y=new $o(this.HlsPlayerClass,g,e,t);this.playerQueue.push(y),e.assetList[n]=t;const b=i=>{if(i.live){const t=new Error(`Interstitials MUST be VOD assets ${e}`),i={fatal:!0,type:a.OTHER_ERROR,details:o.INTERSTITIAL_ASSET_ITEM_ERROR,error:t};return void this.handleAssetItemError(i,e,this.schedule.findEventIndex(e.identifier),n,t.message)}const r=i.edge-i.fragmentStart,s=t.duration;(null===s||r>s)&&(this.log(`Interstitial asset "${f}" duration change ${s} > ${r}`),t.duration=r,this.updateSchedule())};y.on(u.LEVEL_UPDATED,((e,{details:t})=>b(t))),y.on(u.LEVEL_PTS_UPDATED,((e,{details:t})=>b(t)));const T=(e,t)=>{const n=this.getAssetPlayer(f);if(n&&t.tracks){n.off(u.BUFFER_CODECS,T),n.tracks=t.tracks;const e=this.primaryMedia;this.bufferingAsset===n.assetItem&&e&&!n.media&&this.bufferAssetPlayer(n,e)}};y.on(u.BUFFER_CODECS,T);const S=()=>{var n;const i=this.getAssetPlayer(f);if(this.log(`buffered to end of asset ${i}`),!i)return;const r=this.schedule.findEventIndex(e.identifier),s=e.findAssetIndex(t),a=s+1,o=null==(n=this.schedule.items)?void 0:n[r];if(this.isInterstitial(o))if(-1===s||e.isAssetPastPlayoutLimit(a)||e.assetList[a].error){var u;const e=null==(u=this.schedule.items)?void 0:u[r+1];e&&this.bufferedToItem(e)}else this.bufferedToItem(o,a)};y.on(u.BUFFERED_TO_END,S);const E=t=>()=>{const n=this.getAssetPlayer(f);if(!n)return;this.shouldPlay=!0;const i=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,i,t)};return y.once(u.MEDIA_ENDED,E(n)),y.once(u.PLAYOUT_LIMIT_REACHED,E(1/0)),y.on(u.ERROR,((t,i)=>{const r=this.getAssetPlayer(f);if(i.details!==o.BUFFER_STALLED_ERROR)this.handleAssetItemError(i,e,this.schedule.findEventIndex(e.identifier),n,`Asset player error ${i.error} ${e}`);else if(null!=r&&r.media){const t=r.currentTime,n=r.duration-t;t&&e.appendInPlace&&n/r.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${f} ${e} at ${r.media.currentTime}`),S()):(this.warn(`Stalled at ${t} of ${t+n} in asset ${f} ${e}`),this.onTimeupdate(),this.checkBuffer(!0))}})),y.on(u.DESTROYING,(()=>{const t=this.getAssetPlayer(f);if(!t)return;const i=new Error(`Asset player destroyed unexpectedly ${f}`),r={fatal:!0,type:a.OTHER_ERROR,details:o.INTERSTITIAL_ASSET_ITEM_ERROR,error:i};this.handleAssetItemError(r,e,this.schedule.findEventIndex(e.identifier),n,i.message)})),this.hls.trigger(u.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:n,event:e,player:y}),y}clearInterstitial(e,t){e.assetList.forEach((e=>{this.clearAssetPlayer(e.identifier,t)})),e.reset()}clearAssetPlayer(e,t){const n=this.getAssetPlayerQueueIndex(e);if(-1!==n){this.log(`clearAssetPlayer "${e}" toSegment: ${t?Ho(t):t}`);const i=this.playerQueue[n];this.transferMediaFromPlayer(i,t),this.playerQueue.splice(n,1),i.destroy()}}emptyPlayerQueue(){let e;while(e=this.playerQueue.pop())e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,n,i,r){const{interstitial:s,assetItem:a,assetId:o}=e,l=s.assetList.length,c=this.playingAsset;this.endedAsset=null,this.playingAsset=a,c&&c.identifier===o||(c&&(this.clearAssetPlayer(c.identifier,n[i]),delete c.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${l} ${e}`),this.hls.trigger(u.INTERSTITIAL_ASSET_STARTED,{asset:a,assetListIndex:t,event:s,schedule:n.slice(0),scheduleIndex:i,player:e})),this.bufferAssetPlayer(e,r)}bufferAssetPlayer(e,t){var n,i;const{interstitial:r,assetItem:s,assetId:u}=e,l=this.schedule.findEventIndex(r.identifier),c=null==(n=this.schedule.items)?void 0:n[l];if(!c)return;this.setBufferingItem(c),this.bufferingAsset=s;const d=this.getBufferingPlayer();if(d===e)return;const h=r.appendInPlace;if(h&&!1===(null==d?void 0:d.interstitial.appendInPlace))return;const f=(null==d?void 0:d.tracks)||(null==(i=this.detachedData)?void 0:i.tracks)||this.requiredTracks;if(h&&s!==this.playingAsset){if(!e.tracks)return;if(f&&!C(f,e.tracks)){const t=new Error(`Asset "${u}" SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(f)}')`),n={fatal:!0,type:a.OTHER_ERROR,details:o.INTERSTITIAL_ASSET_ITEM_ERROR,error:t},i=r.findAssetIndex(s);return void this.handleAssetItemError(n,r,l,i,t.message)}}this.transferMediaTo(e,t)}handleAssetItemError(e,t,n,i,r){if(e.details===o.BUFFER_STALLED_ERROR)return;const s=t.assetList[i]||null;let a=null;if(s){const e=this.getAssetPlayerQueueIndex(s.identifier);a=this.playerQueue[e]||null}const l=this.schedule.items,c=p({},e,{fatal:!1,errorAction:Gt(!0),asset:s,assetListIndex:i,event:t,schedule:l,scheduleIndex:n,player:a});if(this.warn(`Asset item error: ${e.error}`),this.hls.trigger(u.INTERSTITIAL_ASSET_ERROR,c),!e.fatal)return;const d=new Error(r);s&&(this.playingAsset!==s&&this.clearAssetPlayer(s.identifier,null),s.error=d),t.assetList.some((e=>!e.error))?t.appendInPlace&&(t.error=d):t.error=d,this.primaryFallback(t)}primaryFallback(e){const t=e.timelineStart,n=this.effectivePlayingItem;if(this.updateSchedule(),n){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${n?Ho(n):"<none>"} error: ${e.error}`),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t));let i=this.timelinePos;-1===i&&(i=this.hls.startPosition);const r=this.updateItem(n,i);if(this.itemsMatch(n,r))this.clearInterstitial(e,null);else{const e=this.schedule.findItemIndexAtTime(i);this.setSchedulePosition(e)}}else this.checkStart()}onAssetListLoaded(e,t){var n;const i=t.event,r=i.identifier,s=t.assetListResponse.ASSETS;if(!this.schedule.hasEvent(r))return;const a=i.timelineStart,o=i.duration;let u=0;s.forEach(((e,t)=>{const n=parseFloat(e.DURATION);this.createAsset(i,t,u,a+u,n,e.URI),u+=n})),i.duration=u,this.log(`Loaded asset-list with duration: ${u} (was: ${o}) ${i}`);const l=this.waitingItem,c=(null==l?void 0:l.event.identifier)===r;this.updateSchedule();const d=null==(n=this.bufferingItem)?void 0:n.event;if(c){var h;const e=this.schedule.findEventIndex(r),t=null==(h=this.schedule.items)?void 0:h[e];if(t){if(!this.playingItem&&this.timelinePos>t.end){const t=this.schedule.findItemIndexAtTime(this.timelinePos);if(t!==e)return i.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${i}`),void this.primaryFallback(i)}this.setBufferingItem(t)}this.setSchedulePosition(e)}else if((null==d?void 0:d.identifier)===r&&d.appendInPlace){const e=i.assetList[0],t=this.getAssetPlayer(e.identifier),n=this.primaryMedia;e&&t&&n&&this.bufferAssetPlayer(t,n)}}onError(e,t){switch(t.details){case o.ASSET_LIST_PARSING_ERROR:case o.ASSET_LIST_LOAD_ERROR:case o.ASSET_LIST_LOAD_TIMEOUT:{const e=t.interstitial;e&&this.primaryFallback(e);break}case o.BUFFER_STALLED_ERROR:this.onTimeupdate(),this.checkBuffer(!0);break}}}const zo=500;class Qo extends Fi{constructor(e,t,n){super(e,t,n,"subtitle-stream-controller",c.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(u.LEVEL_LOADED,this.onLevelLoaded,this),e.on(u.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(u.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(u.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(u.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(u.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(u.LEVEL_LOADED,this.onLevelLoaded,this),e.off(u.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(u.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(u.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(u.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(u.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=Ui.IDLE,this.setInterval(zo),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if($(n)&&(this.fragPrevious=n),this.state=Ui.IDLE,!i)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let s;const a=n.start;for(let u=0;u<r.length;u++)if(a>=r[u].start&&a<=r[u].end){s=r[u];break}const o=n.start+n.duration;s?s.end=o:(s={start:a,end:o},r.push(s)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(0===n&&i!==Number.POSITIVE_INFINITY){const e=i-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach((t=>{for(let n=0;n<t.length;)if(t[n].end<=e)t.shift();else{if(!(t[n].start<e))break;t[n].start=e,n++}})),this.fragmentTracker.removeFragmentsInRange(n,e,c.SUBTITLE)}}onError(e,t){const n=t.frag;(null==n?void 0:n.type)===c.SUBTITLE&&(t.details===o.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Ui.STOPPED&&(this.state=Ui.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){this.levels&&ta(this.levels,t)?this.levels=t.map((e=>new st(e))):(this.tracksBuffered=[],this.levels=t.map((e=>{const t=new st(e);return this.tracksBuffered[t.id]=[],t})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,c.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,null==(n=this.levels)||!n.length||-1===this.currentTrackId)return void this.clearInterval();const i=this.levels[this.currentTrackId];null!=i&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.state!==Ui.STOPPED&&this.setInterval(zo)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:i,levels:r}=this,{details:s,id:a}=t;if(!r)return void this.warn(`Subtitle tracks were reset while loading level ${a}`);const o=r[a];if(a>=r.length||!o)return;this.log(`Subtitle track ${a} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(s.live||null!=(n=o.details)&&n.live){const e=this.mainDetails;if(s.deltaUpdateFailed||!e)return;const t=e.fragments[0];var c;if(o.details)l=this.alignPlaylists(s,o.details,null==(c=this.levelLastLoaded)?void 0:c.details),0===l&&t&&(l=t.start,wi(s,l));else s.hasProgramDateTime&&e.hasProgramDateTime?(Oi(s,e),l=s.fragmentStart):t&&(l=t.start,wi(s,l))}if(o.details=s,this.levelLastLoaded=o,a===i&&(this.hls.trigger(u.SUBTITLE_TRACK_UPDATED,{details:s,id:a,groupId:t.groupId}),this.tick(),s.live&&!this.fragCurrent&&this.media&&this.state===Ui.IDLE)){const e=kt(null,s.fragments,this.media.currentTime,0);e||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0)}}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&null!=i&&i.key&&i.iv&&Ln(i.method)){const e=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer,Rn(i.method)).catch((e=>{throw r.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e})).then((n=>{const i=performance.now();r.trigger(u.FRAG_DECRYPTED,{frag:t,payload:n,stats:{tstart:e,tdecrypt:i}})})).catch((e=>{this.warn(`${e.name}: ${e.message}`),this.state=Ui.IDLE}))}}doTick(){if(this.media){if(this.state===Ui.IDLE){const{currentTrackId:e,levels:t}=this,n=null==t?void 0:t[e];if(!n||!t.length||!n.details)return;if(this.waitForLive(n))return;const{config:i}=this,r=this.getLoadPosition(),s=fn.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,i.maxBufferHole),{end:a,len:o}=s,u=n.details,l=this.hls.maxBufferLength+u.levelTargetDuration;if(o>l)return;const c=u.fragments,d=c.length,h=u.edge;let f=null;const p=this.fragPrevious;if(a<h){const e=i.maxFragLookUpTolerance,t=a>h-e?0:e;f=kt(p,c,Math.max(c[0].start,a),t),!f&&p&&p.start<c[0].start&&(f=c[0])}else f=c[d-1];if(f=this.filterReplacedPrimary(f,n.details),!f)return;const g=f.sn-u.startSN,m=c[g-1];if(m&&m.cc===f.cc&&this.fragmentTracker.getState(m)===Vt.NOT_LOADED&&(f=m),this.fragmentTracker.getState(f)===Vt.NOT_LOADED){const e=this.mapToInitFragWhenRequired(f);e&&this.loadFragment(e,n,a)}}}else this.state=Ui.IDLE}loadFragment(e,t,n){$(e)?super.loadFragment(e,t,n):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new Jo(this.tracksBuffered[this.currentTrackId]||[])}}class Jo{constructor(e){this.buffered=void 0;const t=(t,n,i)=>{if(n>>>=0,n>i-1)throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${i})`);return e[n][t]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}const Zo={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},eu=e=>String.fromCharCode(Zo[e]||e),tu=15,nu=100,iu={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},ru={17:2,18:4,21:6,22:8,23:10,19:13,20:15},su={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},au={25:2,26:4,29:6,30:8,31:10,27:13,28:15},ou=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class uu{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n="function"===typeof t?t():t;k.log(`${this.time} [${e}] ${n}`)}}}const lu=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class cu{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class du{constructor(){this.uchar=" ",this.penState=new cu}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class hu{constructor(e){this.chars=[],this.pos=0,this.currPenState=new cu,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<nu;t++)this.chars.push(new du);this.logger=e}equals(e){for(let t=0;t<nu;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<nu;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<nu;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>nu&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=nu)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=eu(e);this.pos>=nu?this.logger.log(0,(()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!")):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<nu;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<nu;n++){const i=this.chars[n].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e);const t=this.chars[this.pos];t.setPenState(this.currPenState)}}class fu{constructor(e){this.rows=[],this.currRow=tu-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<tu;t++)this.rows.push(new hu(e));this.logger=e}reset(){for(let e=0;e<tu;e++)this.rows[e].clear();this.currRow=tu-1}equals(e){let t=!0;for(let n=0;n<tu;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<tu;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<tu;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){const e=this.rows[this.currRow];e.backSpace()}clearToEndOfRow(){const e=this.rows[this.currRow];e.clearToEndOfRow()}insertChar(e){const t=this.rows[this.currRow];t.insertChar(e)}setPen(e){const t=this.rows[this.currRow];t.setPenStyles(e)}moveCursor(e){const t=this.rows[this.currRow];t.moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e);const t=this.rows[this.currRow];t.setCursor(e)}setPAC(e){this.logger.log(2,(()=>"pacData = "+ct(e)));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let t=0;t<tu;t++)this.rows[t].clear();const e=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){const i=n.rows[e].cueStartTime,r=this.logger.time;if(null!==i&&null!==r&&i<r)for(let s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(n.rows[e+s])}}this.currRow=t;const n=this.rows[this.currRow];if(null!==e.indent){const t=e.indent,i=Math.max(t-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,(()=>"bkgData = "+ct(e))),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,(()=>this.getDisplayText()));const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let r=0;r<tu;r++){const n=this.rows[r].getTextString();n&&(i=r+1,e?t.push("Row "+i+": '"+n+"'"):t.push(n.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}getTextAndFormat(){return this.rows}}class pu{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new fu(n),this.nonDisplayedMemory=new fu(n),this.lastOutputScreen=new fu(n),this.currRollUpRow=this.displayedMemory.rows[tu-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[tu-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,(()=>"MODE="+e)),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(()=>t+": "+this.writeScreen.getDisplayText(!0))),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0))),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(()=>"DISP: "+this.displayedMemory.getDisplayText()))}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+ct(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class gu{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=yu(),this.logger=void 0;const i=this.logger=new uu;this.channels=[null,new pu(e,t,i),new pu(e+1,n,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const e=127&t[n],i=127&t[n+1];let r=!1,s=null;if(0===e&&0===i)continue;this.logger.log(3,(()=>"["+lu([t[n],t[n+1]])+"] -> ("+lu([e,i])+")"));const a=this.cmdHistory,o=e>=16&&e<=31;if(o){if(vu(e,i,a)){mu(null,null,a),this.logger.log(3,(()=>"Repeated command ("+lu([e,i])+") is dropped"));continue}mu(e,i,this.cmdHistory),r=this.parseCmd(e,i),r||(r=this.parseMidrow(e,i)),r||(r=this.parsePAC(e,i)),r||(r=this.parseBackgroundAttributes(e,i))}else mu(null,null,a);if(!r&&(s=this.parseChars(e,i),s)){const e=this.currentChannel;if(e&&e>0){const t=this.channels[e];t.insertChars(s)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}r||s||this.logger.log(2,(()=>"Couldn't parse cleaned data "+lu([e,i])+" orig: "+lu([t[n],t[n+1]])))}}parseCmd(e,t){const n=(20===e||28===e||21===e||29===e)&&t>=32&&t<=47,i=(23===e||31===e)&&t>=33&&t<=35;if(!n&&!i)return!1;const r=20===e||21===e||23===e?1:2,s=this.channels[r];return 20===e||21===e||28===e||29===e?32===t?s.ccRCL():33===t?s.ccBS():34===t?s.ccAOF():35===t?s.ccAON():36===t?s.ccDER():37===t?s.ccRU(2):38===t?s.ccRU(3):39===t?s.ccRU(4):40===t?s.ccFON():41===t?s.ccRDC():42===t?s.ccTR():43===t?s.ccRTD():44===t?s.ccEDM():45===t?s.ccCR():46===t?s.ccENM():47===t&&s.ccEOC():s.ccTO(t-32),this.currentChannel=r,!0}parseMidrow(e,t){let n=0;if((17===e||25===e)&&t>=32&&t<=47){if(n=17===e?1:2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return!!i&&(i.ccMIDROW(t),this.logger.log(3,(()=>"MIDROW ("+lu([e,t])+")")),!0)}return!1}parsePAC(e,t){let n;const i=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,r=(16===e||24===e)&&t>=64&&t<=95;if(!i&&!r)return!1;const s=e<=23?1:2;n=t>=64&&t<=95?1===s?iu[e]:su[e]:1===s?ru[e]:au[e];const a=this.channels[s];return!!a&&(a.setPAC(this.interpretPAC(n,t)),this.currentChannel=s,!0)}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,i.underline=1===(1&n),n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((n-16)/2),i}parseChars(e,t){let n,i=null,r=null;if(e>=25?(n=2,r=e-8):(n=1,r=e),r>=17&&r<=19){let e;e=17===r?t+80:18===r?t+112:t+144,this.logger.log(2,(()=>"Special char '"+eu(e)+"' in channel "+n)),i=[e]}else e>=32&&e<=127&&(i=0===t?[e]:[e,t]);return i&&this.logger.log(3,(()=>"Char codes =  "+lu(i).join(","))),i}parseBackgroundAttributes(e,t){const n=(16===e||24===e)&&t>=32&&t<=47,i=(23===e||31===e)&&t>=45&&t<=47;if(!n&&!i)return!1;let r;const s={};16===e||24===e?(r=Math.floor((t-32)/2),s.background=ou[r],t%2===1&&(s.background=s.background+"_semi")):45===t?s.background="transparent":(s.foreground="black",47===t&&(s.underline=!0));const a=e<=23?1:2,o=this.channels[a];return o.setBkgData(s),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}mu(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function mu(e,t,n){n.a=e,n.b=t}function vu(e,t,n){return n.a===e&&n.b===t}function yu(){return{a:null,b:null}}var bu=function(){if(null!=On&&On.VTTCue)return self.VTTCue;const e=["","lr","rl"],t=["start","middle","end","left","right"];function n(e,t){if("string"!==typeof t)return!1;if(!Array.isArray(e))return!1;const n=t.toLowerCase();return!!~e.indexOf(n)&&n}function i(t){return n(e,t)}function r(e){return n(t,e)}function s(e,...t){let n=1;for(;n<arguments.length;n++){const t=arguments[n];for(const n in t)e[n]=t[n]}return e}function a(e,t,n){const a=this,o={enumerable:!0};a.hasBeenReset=!1;let u="",l=!1,c=e,d=t,h=n,f=null,p="",g=!0,m="auto",v="start",y=50,b="middle",T=50,S="middle";Object.defineProperty(a,"id",s({},o,{get:function(){return u},set:function(e){u=""+e}})),Object.defineProperty(a,"pauseOnExit",s({},o,{get:function(){return l},set:function(e){l=!!e}})),Object.defineProperty(a,"startTime",s({},o,{get:function(){return c},set:function(e){if("number"!==typeof e)throw new TypeError("Start time must be set to a number.");c=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"endTime",s({},o,{get:function(){return d},set:function(e){if("number"!==typeof e)throw new TypeError("End time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"text",s({},o,{get:function(){return h},set:function(e){h=""+e,this.hasBeenReset=!0}})),Object.defineProperty(a,"region",s({},o,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"vertical",s({},o,{get:function(){return p},set:function(e){const t=i(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");p=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"snapToLines",s({},o,{get:function(){return g},set:function(e){g=!!e,this.hasBeenReset=!0}})),Object.defineProperty(a,"line",s({},o,{get:function(){return m},set:function(e){if("number"!==typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"lineAlign",s({},o,{get:function(){return v},set:function(e){const t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"position",s({},o,{get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"positionAlign",s({},o,{get:function(){return b},set:function(e){const t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"size",s({},o,{get:function(){return T},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");T=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"align",s({},o,{get:function(){return S},set:function(e){const t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");S=t,this.hasBeenReset=!0}})),a.displayState=void 0}return a.prototype.getCueAsHTML=function(){const e=self.WebVTT;return e.convertCueToDOMTree(self,this.text)},a}();class Tu{decode(e,t){if(!e)return"";if("string"!==typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function Su(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+parseFloat(i||0)}const n=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}class Eu{constructor(){this.values=Object.create(null)}set(e,t){this.get(e)||""===t||(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function wu(e,t,n,i){const r=i?e.split(i):[e];for(const s in r){if("string"!==typeof r[s])continue;const e=r[s].split(n);if(2!==e.length)continue;const i=e[0],a=e[1];t(i,a)}}const Au=new bu(0,0,""),xu="middle"===Au.align?"middle":"center";function Iu(e,t,n){const i=e;function r(){const t=Su(e);if(null===t)throw new Error("Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function s(e,t){const i=new Eu;wu(e,(function(e,t){let r;switch(e){case"region":for(let r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":r=t.split(","),i.integer(e,r[0]),i.percent(e,r[0])&&i.set("snapToLines",!1),i.alt(e,r[0],["auto"]),2===r.length&&i.alt("lineAlign",r[1],["start",xu,"end"]);break;case"position":r=t.split(","),i.percent(e,r[0]),2===r.length&&i.alt("positionAlign",r[1],["start",xu,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",xu,"end","left","right"]);break}}),/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");let r=i.get("line","auto");"auto"===r&&-1===Au.line&&(r=-1),t.line=r,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",xu);let s=i.get("position","auto");"auto"===s&&50===Au.position&&(s="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=s}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=r(),a(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.slice(3),a(),t.endTime=r(),a(),s(e,t)}function ku(e){return e.replace(/<br(?: \/)?>/gi,"\n")}class Lu{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Tu,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;function n(){let e=t.buffer,n=0;e=ku(e);while(n<e.length&&"\r"!==e[n]&&"\n"!==e[n])++n;const i=e.slice(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.slice(n),i}function i(e){wu(e,(function(e,t){}),/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let e="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;e=n();const i=e.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(null==i||!i[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let s=!1;while(t.buffer){if(!/\r\n|\n/.test(t.buffer))return this;switch(s?s=!1:e=n(),t.state){case"HEADER":/:/.test(e)?i(e):e||(t.state="ID");continue;case"NOTE":e||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){t.state="NOTE";break}if(!e)continue;if(t.cue=new bu(0,0,""),t.state="CUE",-1===e.indexOf("--\x3e")){t.cue.id=e;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{Iu(e,t.cue,t.regionList)}catch(r){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const n=-1!==e.indexOf("--\x3e");if(!e||n&&(s=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=e}continue;case"BADCUE":e||(t.state="ID")}}}catch(r){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const Ru=/\r\n|\n\r|\n|\r/g,Cu=function(e,t,n=0){return e.slice(n,n+t.length)===t},Du=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!i(t)||!i(n)||!i(r)||!i(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=6e4*r,t+=36e5*s,t};function Mu(e,t,n){return Mo(e.toString())+Mo(t.toString())+Mo(n)}const Pu=function(e,t,n){let i=e[t],r=e[i.prevCC];if(!r||!r.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,void(i.new=!1);while(null!=(s=r)&&s.new){var s;e.ccOffset+=i.start-r.start,i.new=!1,i=r,r=e[i.prevCC]}e.presentationOffset=n};function _u(e,t,n,i,r,s,a){const o=new Lu,u=D(new Uint8Array(e)).trim().replace(Ru,"\n").split("\n"),l=[],c=t?Is(t.baseTime,t.timescale):0;let d,h="00:00.000",f=0,p=0,g=!0;o.oncue=function(e){const s=n[i];let a=n.ccOffset;const o=(f-c)/9e4;if(null!=s&&s.new&&(void 0!==p?a=n.ccOffset=s.start:Pu(n,i,o)),o){if(!t)return void(d=new Error("Missing initPTS for VTT MPEGTS"));a=o-n.presentationOffset}const u=e.endTime-e.startTime,h=Ns(9e4*(e.startTime+a-p),9e4*r)/9e4;e.startTime=Math.max(h,0),e.endTime=Math.max(h+u,0);const g=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(g)),e.id||(e.id=Mu(e.startTime,e.endTime,g)),e.endTime>0&&l.push(e)},o.onparsingerror=function(e){d=e},o.onflush=function(){d?a(d):s(l)},u.forEach((e=>{if(g){if(Cu(e,"X-TIMESTAMP-MAP=")){g=!1,e.slice(16).split(",").forEach((e=>{Cu(e,"LOCAL:")?h=e.slice(6):Cu(e,"MPEGTS:")&&(f=parseInt(e.slice(7)))}));try{p=Du(h)/1e3}catch(t){d=t}return}""===e&&(g=!1)}o.parse(e+"\n")})),o.flush()}const Ou="stpp.ttml.im1t",Nu=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Uu=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Fu={left:"start",center:"center",right:"end",start:"start",end:"end"};function Bu(e,t,n,i){const r=ne(new Uint8Array(e),["mdat"]);if(0===r.length)return void i(new Error("Could not parse IMSC1 mdat"));const s=r.map((e=>D(e))),a=As(t.baseTime,1,t.timescale);try{s.forEach((e=>n(ju(e,a))))}catch(o){i(o)}}function ju(e,t){const n=new DOMParser,i=n.parseFromString(e,"text/xml"),r=i.getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(s).reduce(((e,t)=>(e[t]=r.getAttribute(`ttp:${t}`)||s[t],e)),{}),o="preserve"!==r.getAttribute("xml:space"),u=Gu($u(r,"styling","style")),l=Gu($u(r,"layout","region")),c=$u(r,"body","[begin]");return[].map.call(c,(e=>{const n=Vu(e,o);if(!n||!e.hasAttribute("begin"))return null;const i=qu(e.getAttribute("begin"),a),r=qu(e.getAttribute("dur"),a);let s=qu(e.getAttribute("end"),a);if(null===i)throw Wu(e);if(null===s){if(null===r)throw Wu(e);s=i+r}const c=new bu(i-t,s-t,n);c.id=Mu(c.startTime,c.endTime,c.text);const d=l[e.getAttribute("region")],h=u[e.getAttribute("style")],f=Hu(d,h,u),{textAlign:g}=f;if(g){const e=Fu[g];e&&(c.lineAlign=e),c.align=g}return p(c,f),c})).filter((e=>null!==e))}function $u(e,t,n){const i=e.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(n)):[]}function Gu(e){return e.reduce(((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e}),{})}function Vu(e,t){return[].slice.call(e.childNodes).reduce(((e,n,i)=>{var r;return"br"===n.nodeName&&i?e+"\n":null!=(r=n.childNodes)&&r.length?Vu(n,t):t?e+n.textContent.trim().replace(/\s+/g," "):e+n.textContent}),"")}function Hu(e,t,n){const i="http://www.w3.org/ns/ttml#styling";let r=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return a&&n.hasOwnProperty(a)&&(r=n[a]),s.reduce(((n,s)=>{const a=Ku(t,i,s)||Ku(e,i,s)||Ku(r,i,s);return a&&(n[s]=a),n}),{})}function Ku(e,t,n){return e&&e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function Wu(e){return new Error(`Could not parse ttml timestamp ${e}`)}function qu(e,t){if(!e)return null;let n=Su(e);return null===n&&(Nu.test(e)?n=Yu(e,t):Uu.test(e)&&(n=Xu(e,t))),n}function Yu(e,t){const n=Nu.exec(e),i=(0|n[4])+(0|n[5])/t.subFrameRate;return 3600*(0|n[1])+60*(0|n[2])+(0|n[3])+i/t.frameRate}function Xu(e,t){const n=Uu.exec(e),i=Number(n[1]),r=n[2];switch(r){case"h":return 3600*i;case"m":return 60*i;case"ms":return 1e3*i;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}class zu{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class Qu{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=tl(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(u.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(u.FRAG_LOADING,this.onFragLoading,this),e.on(u.FRAG_LOADED,this.onFragLoaded,this),e.on(u.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(u.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(u.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(u.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(u.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(u.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(u.FRAG_LOADING,this.onFragLoading,this),e.off(u.FRAG_LOADED,this.onFragLoaded,this),e.off(u.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(u.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(u.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(u.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(u.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new zu(this,"textTrack1"),t=new zu(this,"textTrack2"),n=new zu(this,"textTrack3"),i=new zu(this,"textTrack4");this.cea608Parser1=new gu(1,e,t),this.cea608Parser2=new gu(3,n,i)}addCues(e,t,n,i,r){let s=!1;for(let a=r.length;a--;){const e=r[a],i=el(e[0],e[1],t,n);if(i>=0&&(e[0]=Math.min(e[0],t),e[1]=Math.max(e[1],n),s=!0,i/(n-t)>.5))return}if(s||r.push([t,n]),this.config.renderTextTracksNatively){const r=this.captionsTracks[e];this.Cues.newCue(r,t,n,i)}else{const r=this.Cues.newCue(null,t,n,i);this.hls.trigger(u.CUES_PARSED,{type:"captions",cues:r,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r}){const{unparsedVttFrags:s}=this;n===c.MAIN&&(this.initPTS[t.cc]={baseTime:i,timescale:r}),s.length&&(this.unparsedVttFrags=[],s.forEach((e=>{this.onFragLoaded(u.FRAG_LOADED,e)})))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const r=n.textTracks[i];if(Zu(r,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:r,languageCode:s}=t[e],a=this.getExistingTrack(r,s);if(a)n[e]=a,Io(n[e]),Ao(n[e],i);else{const t=this.createTextTrack("captions",r,s);t&&(t[e]=!0,n[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,i={_id:e,label:n,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(u.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,n){const i=this.media;if(i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const n=!!t.transferMedia;if(this.media=null,n)return;const{captionsTracks:i}=this;Object.keys(i).forEach((e=>{Io(i[e]),delete i[e]})),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=tl(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Io(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some((e=>e.textCodec===Ou));if(this.config.enableWebVTT||i&&this.config.enableIMSC1){const e=ta(this.tracks,n);if(e)return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const e=this.media,t=e?Co(e.textTracks):null;if(this.tracks.forEach(((e,n)=>{let i;if(t){let n=null;for(let i=0;i<t.length;i++)if(t[i]&&Zu(t[i],e)){n=t[i],t[i]=null;break}n&&(i=n)}if(i)Io(i);else{const t=Ju(e);i=this.createTextTrack(t,e.name,e.lang),i&&(i.mode="disabled")}i&&this.textTracks.push(i)})),null!=t&&t.length){const e=t.filter((e=>null!==e)).map((e=>e.label));e.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${e.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const e=this.tracks.map((e=>({label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e})));this.hls.trigger(u.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((e=>{const t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;const n=`textTrack${t[1]}`,i=this.captionsProperties[n];i&&(i.label=e.name,e.lang&&(i.languageCode=e.lang),i.media=e)}))}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===c.MAIN){var n,i;const{cea608Parser1:e,cea608Parser2:r,lastSn:s}=this,{cc:a,sn:o}=t.frag,u=null!=(n=null==(i=t.part)?void 0:i.index)?n:-1;e&&r&&(o!==s+1||o===s&&u!==this.lastPartIndex+1||a!==this.lastCc)&&(e.reset(),r.reset()),this.lastCc=a,this.lastSn=o,this.lastPartIndex=u}}onFragLoaded(e,t){const{frag:n,payload:i}=t;if(n.type===c.SUBTITLE)if(i.byteLength){const e=n.decryptdata,r="stats"in t;if(null==e||!e.encrypted||r){const e=this.tracks[n.level],r=this.vttCCs;r[n.cc]||(r[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),e&&e.textCodec===Ou?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;Bu(t,this.initPTS[e.cc],(t=>{this._appendCues(t,e.level),n.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(t=>{n.logger.log(`Failed to parse IMSC1: ${t}`),n.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))}_parseVTTs(e){var t;const{frag:n,payload:i}=e,{initPTS:r,unparsedVttFrags:s}=this,a=r.length-1;if(!r[n.cc]&&-1===a)return void s.push(e);const o=this.hls,l=null!=(t=n.initSegment)&&t.data?ve(n.initSegment.data,new Uint8Array(i)).buffer:i;_u(l,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,(e=>{this._appendCues(e,n.level),o.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})}),(t=>{const r="Missing initPTS for VTT MPEGTS"===t.message;r?s.push(e):this._fallbackToIMSC1(n,i),o.logger.log(`Failed to parse VTT cue: ${t}`),r&&a>n.cc||o.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})}))}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||Bu(t,this.initPTS[e.cc],(()=>{n.textCodec=Ou,this._parseIMSC1(e,t)}),(()=>{n.textCodec="wvtt"}))}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||"disabled"===n.mode)return;e.forEach((e=>xo(n,e)))}else{const i=this.tracks[t];if(!i)return;const r=i.default?"default":"subtitles"+t;n.trigger(u.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===c.SUBTITLE&&this.onFragLoaded(u.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:n,samples:i}=t;if(n.type!==c.MAIN||"NONE"!==this.closedCaptionsForLevel(n))for(let r=0;r<i.length;r++){const e=i[r].bytes;if(e){this.cea608Parser1||this.initCea608Parsers();const t=this.extractCea608Data(e);this.cea608Parser1.addData(i[r].pts,t[0]),this.cea608Parser2.addData(i[r].pts,t[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:r}){const{media:s}=this;if(s&&!(s.currentTime<n)){if(!r||"video"===r){const{captionsTracks:e}=this;Object.keys(e).forEach((i=>ko(e[i],t,n)))}if(this.config.renderTextTracksNatively&&0===t&&void 0!==i){const{textTracks:e}=this;Object.keys(e).forEach((n=>ko(e[n],t,i)))}}}extractCea608Data(e){const t=[[],[]],n=31&e[0];let i=2;for(let r=0;r<n;r++){const n=e[i++],r=127&e[i++],s=127&e[i++];if(0===r&&0===s)continue;const a=0!==(4&n);if(a){const e=3&n;0!==e&&1!==e||(t[e].push(r),t[e].push(s))}}return t}}function Ju(e){return e.characteristics&&/transcribes-spoken-dialog/gi.test(e.characteristics)&&/describes-music-and-sound/gi.test(e.characteristics)?"captions":"subtitles"}function Zu(e,t){return!!e&&e.kind===Ju(t)&&ia(t,e)}function el(e,t,n,i){return Math.min(t,i)-Math.max(e,n)}function tl(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const nl=/\s/,il={newCue(e,t,n,i){const r=[];let s,a,o,u,l;const c=self.VTTCue||self.TextTrackCue;for(let h=0;h<i.rows.length;h++)if(s=i.rows[h],o=!0,u=0,l="",!s.isEmpty()){var d;for(let e=0;e<s.chars.length;e++)nl.test(s.chars[e].uchar)&&o?u++:(l+=s.chars[e].uchar,o=!1);s.cueStartTime=t,t===n&&(n+=1e-4),u>=16?u--:u++;const i=ku(l.trim()),f=Mu(t,n,i);null!=e&&null!=(d=e.cues)&&d.getCueById(f)||(a=new c(t,n,i),a.id=f,a.line=h+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*u/32)),r.push(a))}return e&&r.length&&(r.sort(((e,t)=>"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line)),r.forEach((t=>xo(e,t)))),r}};function rl(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}const sl=/(\d+)-(\d+)\/(\d+)/;class al{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||cl,this.controller=new self.AbortController,this.stats=new F}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const s=ol(e,this.controller.signal),a="arraybuffer"===e.responseType,o=a?"byteLength":"length",{maxTimeToFirstByteMs:u,maxLoadTimeMs:l}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=u&&i(u)?u:l,this.requestTimeout=self.setTimeout((()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))}),t.timeout);const c=qs(this.request)?this.request.then(self.fetch):self.fetch(this.request);c.then((n=>{var s;this.response=this.loader=n;const o=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=l,this.requestTimeout=self.setTimeout((()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))}),l-(o-r.loading.start)),!n.ok){const{status:e,statusText:t}=n;throw new dl(t||"fetch, bad network response",e,n)}r.loading.first=o,r.total=ll(n.headers)||r.total;const u=null==(s=this.callbacks)?void 0:s.onProgress;return u&&i(t.highWaterMark)?this.loadProgressively(n,r,e,t.highWaterMark,u):a?n.arrayBuffer():"json"===e.responseType?n.json():n.text()})).then((n=>{var s,a;const u=this.response;if(!u)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const l=n[o];l&&(r.loaded=r.total=l);const c={url:u.url,data:n,code:u.status},d=null==(s=this.callbacks)?void 0:s.onProgress;d&&!i(t.highWaterMark)&&d(r,e,n,u),null==(a=this.callbacks)||a.onSuccess(c,r,e,u)})).catch((t=>{var n;if(self.clearTimeout(this.requestTimeout),r.aborted)return;const i=t&&t.code||0,s=t?t.message:null;null==(n=this.callbacks)||n.onError({code:i,text:s},e,t?t.details:null,r)}))}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,r){const s=new ji,a=e.body.getReader(),o=()=>a.read().then((a=>{if(a.done)return s.dataLength&&r(t,n,s.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const u=a.value,l=u.length;return t.loaded+=l,l<i||s.dataLength?(s.push(u),s.dataLength>=i&&r(t,n,s.flush().buffer,e)):r(t,n,u.buffer,e),o()})).catch((()=>Promise.reject()));return o()}}function ol(e,t){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(p({},e.headers))};return e.rangeEnd&&n.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),n}function ul(e){const t=sl.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}function ll(e){const t=e.get("Content-Range");if(t){const e=ul(t);if(i(e))return e}const n=e.get("Content-Length");if(n)return parseInt(n)}function cl(e,t){return new self.Request(e.url,t)}class dl extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const hl=/^age:\s*[\d.]+\s*$/im;class fl{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new F,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then((()=>{if(this.loader===n&&!this.stats.aborted)return r(n,t.url)})).catch((e=>{if(this.loader===n&&!this.stats.aborted)return n.open("GET",t.url,!0),r(n,t.url)})).then((()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)})).catch((e=>{var r;null==(r=this.callbacks)||r.onError({code:n.status,text:e.message},t,n,i)})):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const r=t.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:a}=n.loadPolicy;if(r)for(const i in r)e.setRequestHeader(i,r[i]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=s&&i(s)?s:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,r=this.config;if(!n.aborted&&i>=2&&(0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),4===i)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const i=t.status,u="text"===t.responseType?t.responseText:null;if(i>=200&&i<300){const r=null!=u?u:t.response;if(null!=r){var s,a;n.loading.end=Math.max(self.performance.now(),n.loading.first);const o="arraybuffer"===t.responseType?r.byteLength:r.length;n.loaded=n.total=o,n.bwEstimate=8e3*n.total/(n.loading.end-n.loading.first);const u=null==(s=this.callbacks)?void 0:s.onProgress;u&&u(n,e,r,t);const l={url:t.responseURL,data:r,code:i};return void(null==(a=this.callbacks)||a.onSuccess(l,n,e,t))}}const l=r.loadPolicy.errorRetry,c=n.retry,d={url:e.url,data:void 0,code:i};var o;if(Ut(l,c,!1,d))this.retry(l);else k.error(`${i} while loading ${e.url}`),null==(o=this.callbacks)||o.onError({code:i,text:t.statusText},e,t,n)}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(Ut(e,t,!0))this.retry(e);else{var n;k.warn(`timeout while loading ${null==(n=this.context)?void 0:n.url}`);const e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Ot(e,n.retry),n.retry++,k.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${null==t?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&hl.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const pl={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},gl=m(m({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:fl,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:At,bufferController:la,capLevelController:fa,errorController:$t,fpsController:wo,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Vn,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,certLoadPolicy:{default:pl},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},ml()),{},{subtitleStreamController:Qo,subtitleTrackController:Do,timelineController:Qu,audioStreamController:Zs,audioTrackController:ra,emeController:So,cmcdController:mo,contentSteeringController:yo,interstitialsController:Xo});function ml(){return{cueHandler:il,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function vl(e,t,n){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=yl(e),r=["manifest","level","frag"],s=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return r.forEach((e=>{const r=`${"level"===e?"playlist":e}LoadPolicy`,a=void 0===t[r],o=[];s.forEach((n=>{const s=`${e}Loading${n}`,u=t[s];if(void 0!==u&&a){o.push(s);const e=i[r].default;switch(t[r]={default:e},n){case"TimeOut":e.maxLoadTimeMs=u,e.maxTimeToFirstByteMs=u;break;case"MaxRetry":e.errorRetry.maxNumRetry=u,e.timeoutRetry.maxNumRetry=u;break;case"RetryDelay":e.errorRetry.retryDelayMs=u,e.timeoutRetry.retryDelayMs=u;break;case"MaxRetryTimeout":e.errorRetry.maxRetryDelayMs=u,e.timeoutRetry.maxRetryDelayMs=u;break}}})),o.length&&n.warn(`hls.js config: "${o.join('", "')}" setting(s) are deprecated, use "${r}": ${ct(t[r])}`)})),m(m({},i),t)}function yl(e){return e&&"object"===typeof e?Array.isArray(e)?e.map(yl):Object.keys(e).reduce(((t,n)=>(t[n]=yl(e[n]),t)),{}):e}function bl(e,t){const n=e.loader;if(n!==al&&n!==fl)t.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1;else{const n=rl();n&&(e.loader=al,e.progressive=!0,e.enableSoftwareAES=!0,t.log("[config]: Progressive streaming enabled, using FetchLoader"))}}const Tl=2,Sl=.1,El=.05,wl=100;class Al extends ln{constructor(e,t){super("gap-controller",e.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var e;null!=(e=this.media)&&e.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{var e;this.hls&&(this.ended=(null==(e=this.media)?void 0:e.currentTime)||1,this.hls.trigger(u.MEDIA_ENDED,{stalled:!1}))},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(wl),this.mediaSource=t.mediaSource;const n=this.media=t.media;Wo(n,"playing",this.onMediaPlaying),Wo(n,"waiting",this.onMediaWaiting),Wo(n,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:n}=this;n&&(qo(n,"playing",this.onMediaPlaying),qo(n,"waiting",this.onMediaWaiting),qo(n,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(null==(e=this.media)||!e.readyState||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var n,i;const r=null==(n=this.hls)?void 0:n.config;if(!r)return;const{media:s,stalled:a}=this;if(!s)return;const{seeking:o}=s,l=this.seeking&&!o,c=!this.seeking&&o,d=s.paused&&!o||s.ended||0===s.playbackRate;if(this.seeking=o,e!==t)return t&&(this.ended=0),this.moved=!0,o||(this.nudgeRetry=0,r.nudgeOnVideoHole&&!d&&e>t&&this.nudgeOnVideoHole(e,t)),void(0===this.waiting&&this.stallResolved(e));if(c||l)return void(l&&this.stallResolved(e));if(d)return this.nudgeRetry=0,this.stallResolved(e),void(!this.ended&&s.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(u.MEDIA_ENDED,{stalled:!1})));if(!fn.getBuffered(s).length)return void(this.nudgeRetry=0);const h=fn.bufferInfo(s,e,0),f=h.nextStart||0,p=this.fragmentTracker;if(o&&p&&this.hls){const t=xl(this.hls.inFlightFragments,e),n=h.len>Tl,i=!f||t||f-e>Tl&&!p.getPartialFragment(e);if(n||i)return;this.moved=!1}const g=null==(i=this.hls)?void 0:i.latestLevelDetails;if(!this.moved&&null!==this.stalled&&p){const t=h.len>0;if(!t&&!f)return;const n=Math.max(f,h.start||0)-e,i=!(null==g||!g.live),r=i?2*g.targetduration:Tl,a=p.getPartialFragment(e);if(n>0&&(n<=r||a))return void(s.paused||this._trySkipBufferHole(a))}const m=r.detectStallWithCurrentTimeMs,v=self.performance.now(),y=this.waiting;if(null===a)return void(this.stalled=y>0&&v-y<m?y:v);const b=v-a;if(!o&&(b>=m||y)&&this.hls){var T;if("ended"===(null==(T=this.mediaSource)?void 0:T.readyState)&&(null==g||!g.live)&&Math.abs(e-((null==g?void 0:g.edge)||0))<1){if(this.ended)return;return this.ended=e||1,void this.hls.trigger(u.MEDIA_ENDED,{stalled:!0})}if(this._reportStall(h),!this.media||!this.hls)return}const S=fn.bufferInfo(s,e,r.maxBufferHole);this._tryFixBufferStall(S,b)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const n=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(n)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(u.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var n;const i=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&null!=(n=this.buffered.audio)&&n.length&&i&&i.length>1&&e>i.end(0)){const n=fn.bufferedInfo(fn.timeRangesToArray(this.buffered.audio),e,0);if(n.len>1&&t>=n.start){const n=fn.timeRangesToArray(i),r=fn.bufferedInfo(n,t,0).bufferedIndex;if(r>-1&&r<n.length-1){const t=fn.bufferedInfo(n,e,0).bufferedIndex,i=n[r].end,s=n[r+1].start;if((-1===t||t>r)&&s-i<1&&e-i<2){const n=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${i} -> ${s} buffered index: ${t}`);this.warn(n.message),this.media.currentTime+=1e-6;const r=this.fragmentTracker.getPartialFragment(e)||void 0,l=fn.bufferInfo(this.media,e,0);this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:n,reason:n.message,frag:r,buffer:l.len,bufferInfo:l})}}}}}_tryFixBufferStall(e,t){var n,i;const{fragmentTracker:r,media:s}=this,a=null==(n=this.hls)?void 0:n.config;if(!s||!r||!a)return;const o=s.currentTime,u=null==(i=this.hls)?void 0:i.latestLevelDetails,l=r.getPartialFragment(o);if(l||null!=u&&u.live&&o<u.fragmentStart){const e=this._trySkipBufferHole(l);if(e||!this.media)return}const c=e.buffered;(c&&c.length>1&&e.len>a.maxBufferHole||e.nextStart&&e.nextStart-o<a.maxBufferHole)&&(t>1e3*a.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}_reportStall(e){const{hls:t,media:n,stallReported:i,stalled:r}=this;if(!i&&null!==r&&n&&t){this.stallReported=!0;const i=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${ct(e)})`);this.warn(i.message),t.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_STALLED_ERROR,fatal:!1,error:i,buffer:e.len,bufferInfo:e,stalled:{start:r}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:n,media:i}=this,r=null==(t=this.hls)?void 0:t.config;if(!i||!n||!r)return 0;const s=i.currentTime,l=fn.bufferInfo(i,s,0),d=s<l.start?l.start:l.nextStart;if(d&&this.hls){const t=l.len<=r.maxBufferHole,f=l.len>0&&l.len<1&&i.readyState<3,p=d-s;if(p>0&&(t||f)){if(p>r.maxBufferHole){let t=!1;if(0===s){const e=n.getAppendedFrag(0,c.MAIN);e&&d<e.end&&(t=!0)}if(!t){const t=e||n.getAppendedFrag(s,c.MAIN);if(t){var h;if(null==(h=this.hls.loadLevelObj)||!h.details)return 0;const e=xl(this.hls.inFlightFragments,d);if(e)return 0;let i=!1,r=t.end;while(r<d){const e=n.getPartialFragment(r);if(!e){i=!0;break}r+=e.duration}if(i)return 0}}}const t=Math.max(d+El,s+Sl);if(this.warn(`skipping hole, adjusting currentTime from ${s} to ${t}`),this.moved=!0,i.currentTime=t,null==e||!e.gap){const n=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${t}`);this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:n,reason:n.message,frag:e||void 0,buffer:l.len,bufferInfo:l})}return t}}return 0}_tryNudgeBuffer(e){const{hls:t,media:n,nudgeRetry:i}=this,r=null==t?void 0:t.config;if(!n||!r)return 0;const s=n.currentTime;if(this.nudgeRetry++,i<r.nudgeMaxRetry){const l=s+(i+1)*r.nudgeOffset,c=new Error(`Nudging 'currentTime' from ${s} to ${l}`);this.warn(c.message),n.currentTime=l,t.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_NUDGE_ON_STALL,error:c,fatal:!1,buffer:e.len,bufferInfo:e})}else{const n=new Error(`Playhead still not moving while enough data buffered @${s} after ${r.nudgeMaxRetry} nudges`);this.error(n.message),t.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.BUFFER_STALLED_ERROR,error:n,fatal:!0,buffer:e.len,bufferInfo:e})}}}function xl(e,t){const n=Il(e.main);if(n&&n.start<=t)return n;const i=Il(e.audio);return i&&i.start<=t?i:null}function Il(e){if(!e)return null;switch(e.state){case Ui.IDLE:case Ui.STOPPED:case Ui.ENDED:case Ui.ERROR:return null}return e.frag}const kl=.25;function Ll(){if("undefined"!==typeof self)return self.VTTCue||self.TextTrackCue}function Rl(e,t,n,i,r){let s=new e(t,n,"");try{s.value=i,r&&(s.type=r)}catch(a){s=new e(t,n,ct(r?m({type:r},i):i))}return s}const Cl=(()=>{const e=Ll();try{e&&new e(0,Number.POSITIVE_INFINITY,"")}catch(t){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Dl(e){return Uint8Array.from(e.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class Ml{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(u.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(u.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(u.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(u.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(u.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(e,t){var n;this.media=t.media,!1===(null==(n=t.overrides)?void 0:n.cueRemoval)&&(this.removeCues=!1)}onMediaAttached(){const e=this.hls.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(e,t){this.media=null;const n=!!t.transferMedia;n||(this.id3Track&&(this.removeCues&&Io(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if("metadata"===n.kind&&"id3"===n.label)return Ao(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const s=Ll();if(s)for(let a=0;a<r.length;a++){const e=r[a].type;if(e===Ur.emsg&&!n||!i)continue;const t=Pr(r[a].data);if(t){const n=r[a].pts;let i=n+r[a].duration;i>Cl&&(i=Cl);const o=i-n;o<=0&&(i=n+kl);for(let r=0;r<t.length;r++){const a=t[r];if(!_r(a)){this.updateId3CueEnds(n,e);const t=Rl(s,n,i,a,e);t&&this.id3Track.addCue(t)}}}}}updateId3CueEnds(e,t){var n;const i=null==(n=this.id3Track)?void 0:n.cues;if(i)for(let r=i.length;r--;){const n=i[r];n.type===t&&n.startTime<e&&n.endTime===Cl&&(n.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){const{id3Track:r,hls:s}=this;if(!s)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:o}}=s;if(r&&(a||o)){let e;e="audio"===i?e=>e.type===Ur.audioId3&&o:"video"===i?e=>e.type===Ur.emsg&&a:e=>e.type===Ur.audioId3&&o||e.type===Ur.emsg&&a,ko(r,t,n,e)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.media||!e.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{id3Track:n}=this,{dateRanges:r}=e,s=Object.keys(r);let a=this.dateRangeCuesAppended;var o;if(n&&t)if(null!=(o=n.cues)&&o.length){const e=Object.keys(a).filter((e=>!s.includes(e)));for(let t=e.length;t--;){const i=e[t],r=a[i].cues;delete a[i],Object.keys(r).forEach((e=>{try{const t=r[e];t.removeEventListener("enter",this.onEventCueEnter),n.removeCue(t)}catch(t){}}))}}else a=this.dateRangeCuesAppended={};const u=e.fragments[e.fragments.length-1];if(0===s.length||!i(null==u?void 0:u.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=Ll();for(let i=0;i<s.length;i++){const e=s[i],t=r[e],n=t.startTime,o=a[e],u=(null==o?void 0:o.cues)||{};let c=(null==o?void 0:o.durationKnown)||!1,d=Cl;const{duration:h,endDate:f}=t;if(f&&null!==h)d=n+h,c=!0;else if(t.endOnNext&&!c){const e=s.reduce(((e,n)=>{if(n!==t.id){const i=r[n];if(i.class===t.class&&i.startDate>t.startDate&&(!e||t.startDate<e.startDate))return i}return e}),null);e&&(d=e.startTime,c=!0)}const p=Object.keys(t.attr);for(let i=0;i<p.length;i++){const r=p[i];if(!wn(r))continue;const s=u[r];if(s)c&&!o.durationKnown?s.endTime=d:Math.abs(s.startTime-n)>.01&&(s.startTime=n,s.endTime=d);else if(l){let i=t.attr[r];An(r)&&(i=Dl(i));const s={key:r,data:i},a=Rl(l,n,d,s,Ur.dateRange);a&&(a.id=e,this.id3Track.addCue(a),u[r]=a,this.hls.config.interstitialsController&&("X-ASSET-LIST"!==r&&"X-ASSET-URL"!==r||a.addEventListener("enter",this.onEventCueEnter)))}}a[e]={cues:u,dateRange:t,durationKnown:c}}}}class Pl{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:e}=this,t=this.levelDetails;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(null===n)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:r}=this.config;if(!i||1===r||!t.live)return;const s=this.targetLatency;if(null===s)return;const a=n-s,o=Math.min(this.maxLatency,s+t.targetduration),u=a<o;if(u&&a>.05&&this.forwardBufferLength>1){const t=Math.min(2,Math.max(1,r)),n=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20,i=Math.min(t,Math.max(1,n));this.changeMediaPlaybackRate(e,i)}else 1!==e.playbackRate&&0!==e.playbackRate&&this.changeMediaPlaybackRate(e,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return(null==(e=this.hls)?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(void 0!==e.liveMaxLatencyDuration)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(null===e||null===this.hls)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:r,liveSyncDurationCount:s,lowLatencyMode:a}=this.config,o=this.hls.userConfig;let u=a&&n||t;(this._targetLatencyUpdated||o.liveSyncDuration||o.liveSyncDurationCount||0===u)&&(u=void 0!==r?r:s*i);const l=i;return u+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,l)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(null===e||null===t)return null;const n=this.levelDetails;if(null===n)return null;const i=n.edge,r=e-t-this.edgeStalled,s=i-n.totalduration,a=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(s,r),a)}get drift(){const e=this.levelDetails;return null===e?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(null===e)return 0;const t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(u.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(u.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(u.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(u.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var n;t.details===o.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&null!=(n=this.levelDetails)&&n.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var n,i;e.playbackRate!==t&&(null==(n=this.hls)||n.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${null==(i=this.targetLatency)?void 0:i.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}class _l extends ea{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(u.LEVEL_LOADED,this.onLevelLoaded,this),e.on(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(u.FRAG_BUFFERED,this.onFragBuffered,this),e.on(u.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(u.LEVEL_LOADED,this.onLevelLoaded,this),e.off(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(u.FRAG_BUFFERED,this.onFragBuffered,this),e.off(u.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){const e=this._levels;e.forEach((e=>{e.loadError=0,e.fragmentError=0})),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,i=[],r={},s={};let a=!1,o=!1,u=!1;t.levels.forEach((e=>{var t;const l=e.attrs;let{audioCodec:c,videoCodec:d}=e;c&&(e.audioCodec=c=Be(c,n)||void 0),0===(null==(t=d)?void 0:t.indexOf("avc1"))&&(d=e.videoCodec=Ge(d));const{width:h,height:f,unknownCodecs:p}=e;let g=p?p.length:0;if(p)for(let n=g;n--;){const t=p[n];this.isAudioSupported(t)?(e.audioCodec=c=c?`${c},${t}`:t,g--,Re.audio[c.substring(0,4)]=2):this.isVideoSupported(t)&&(e.videoCodec=d=d?`${d},${t}`:t,g--,Re.video[d.substring(0,4)]=2)}if(a||(a=!(!h||!f)),o||(o=!!d),u||(u=!!c),g||c&&!this.isAudioSupported(c)||d&&!this.isVideoSupported(d))return void this.log(`Some or all CODECS not supported "${l.CODECS}"`);const{CODECS:m,"FRAME-RATE":v,"HDCP-LEVEL":y,"PATHWAY-ID":b,RESOLUTION:T,"VIDEO-RANGE":S}=l,E=`${b||"."}-`,w=`${E}${e.bitrate}-${T}-${v}-${m}-${S}-${y}`;if(r[w])if(r[w].uri===e.url||e.attrs["PATHWAY-ID"])r[w].addGroupId("audio",l.AUDIO),r[w].addGroupId("text",l.SUBTITLES);else{const t=s[w]+=1;e.attrs["PATHWAY-ID"]=new Array(t+1).join(".");const n=this.createLevel(e);r[w]=n,i.push(n)}else{const t=this.createLevel(e);r[w]=t,s[w]=1,i.push(t)}})),this.filterAndSortMediaOptions(i,t,a,o,u)}createLevel(e){const t=new st(e),n=e.supplemental;if(null!=n&&n.videoCodec&&!this.isVideoSupported(n.videoCodec)){const e=new Error(`SUPPLEMENTAL-CODECS not supported "${n.videoCodec}"`);this.log(e.message),t.supportedResult=qe(e,[])}return t}isAudioSupported(e){return De(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return De(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,n,i,r){let s=[],l=[],c=e;if((n||i)&&r&&(c=c.filter((({videoCodec:e,videoRange:t,width:n,height:i})=>(!!e||!(!n||!i))&&tt(t)))),0===c.length)return void Promise.resolve().then((()=>{if(this.hls){let e="no level with compatible codecs found in manifest",n=e;t.levels.length&&(n=`one or more CODECS in variant not supported: ${ct(t.levels.map((e=>e.attrs.CODECS)).filter(((e,t,n)=>n.indexOf(e)===t)))}`,this.warn(n),e+=` (${n})`);const i=new Error(e);this.hls.trigger(u.ERROR,{type:a.MEDIA_ERROR,details:o.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:i,reason:n})}}));t.audioTracks&&(s=t.audioTracks.filter((e=>!e.audioCodec||this.isAudioSupported(e.audioCodec))),Ol(s)),t.subtitles&&(l=t.subtitles,Ol(l));const d=c.slice(0);c.sort(((e,t)=>{if(e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"])return(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&e.height!==t.height)return e.height-t.height;if(e.frameRate!==t.frameRate)return e.frameRate-t.frameRate;if(e.videoRange!==t.videoRange)return et.indexOf(e.videoRange)-et.indexOf(t.videoRange);if(e.videoCodec!==t.videoCodec){const n=_e(e.videoCodec),i=_e(t.videoCodec);if(n!==i)return i-n}if(e.uri===t.uri&&e.codecSet!==t.codecSet){const n=Oe(e.codecSet),i=Oe(t.codecSet);if(n!==i)return i-n}return e.averageBitrate!==t.averageBitrate?e.averageBitrate-t.averageBitrate:0}));let h=d[0];if(this.steering&&(c=this.steering.filterParsedLevels(c),c.length!==d.length))for(let a=0;a<d.length;a++)if(d[a].pathwayId===c[0].pathwayId){h=d[a];break}this._levels=c;for(let a=0;a<c.length;a++)if(c[a]===h){var f;this._firstLevel=a;const e=h.bitrate,t=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${c.length} level(s) found, first bitrate: ${e}`),void 0===(null==(f=this.hls.userConfig)?void 0:f.abrEwmaDefaultEstimate)){const n=Math.min(e,this.hls.config.abrEwmaDefaultEstimateMax);n>t&&t===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=n)}break}const p=r&&!i,g=this.hls.config,m=!(!g.audioStreamController||!g.audioTrackController),v={levels:c,audioTracks:s,subtitleTracks:l,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:r,video:i,altAudio:m&&!p&&s.some((e=>!!e.url))};this.hls.trigger(u.MANIFEST_PARSED,v)}get levels(){return 0===this._levels.length?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const n=new Error("invalid level idx"),i=e<0;if(this.hls.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.LEVEL_SWITCH_ERROR,level:e,fatal:i,error:n,reason:n.message}),i)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,r=i?i.attrs["PATHWAY-ID"]:void 0,s=t[e],l=s.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=s,n===e&&i&&r===l)return;this.log(`Switching to level ${e} (${s.height?s.height+"p ":""}${s.videoRange?s.videoRange+" ":""}${s.codecSet?s.codecSet+" ":""}@${s.bitrate})${l?" with Pathway "+l:""} from level ${n}${r?" with Pathway "+r:""}`);const c={level:e,attrs:s.attrs,details:s.details,bitrate:s.bitrate,averageBitrate:s.averageBitrate,maxBitrate:s.maxBitrate,realBitrate:s.realBitrate,width:s.width,height:s.height,codecSet:s.codecSet,audioCodec:s.audioCodec,videoCodec:s.videoCodec,audioGroups:s.audioGroups,subtitleGroups:s.subtitleGroups,loaded:s.loaded,loadError:s.loadError,fragmentError:s.fragmentError,name:s.name,id:s.id,uri:s.uri,url:s.url,urlId:0,audioGroupIds:s.audioGroupIds,textGroupIds:s.textGroupIds};this.hls.trigger(u.LEVEL_SWITCHING,c);const d=s.details;if(!d||d.live){const e=this.switchParams(s.uri,null==i?void 0:i.details,d);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),n=e.filter((e=>-1!==t.indexOf(e)));if(e.length<1)return void this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);this.steering.pathwayPriority=n}}onError(e,t){!t.fatal&&t.context&&t.context.type===l.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(void 0!==t&&t.type===c.MAIN){const e=t.elementaryStreams;if(!Object.keys(e).some((t=>!!e[t])))return;const n=this._levels[t.level];null!=n&&n.loadError&&(this.log(`Resetting level error count of ${n.loadError} on frag buffered`),n.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:r}=t,s=t.levelInfo;var a;if(!s)return this.warn(`Invalid level index ${i}`),void(null!=(a=t.deliveryDirectives)&&a.skip&&(r.deltaUpdateFailed=!0));if(s===this.currentLevel||t.withoutMultiVariant){0===s.fragmentError&&(s.loadError=0);let e=s.details;e===t.details&&e.advanced&&(e=void 0),this.playlistLoaded(i,t,e)}else null!=(n=t.deliveryDirectives)&&n.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=this.getUrlWithDirectives(e.uri,t),i=this.currentLevelIndex,r=e.attrs["PATHWAY-ID"],s=e.details,a=null==s?void 0:s.age;this.log(`Loading level index ${i}${void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:""}${r?" Pathway "+r:""}${a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""} ${n}`),this.hls.trigger(u.LEVEL_LOADING,{url:n,level:i,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(1===this._levels.length)return;const n=this._levels.filter(((t,n)=>n!==e||(this.steering&&this.steering.removeLevel(t),t===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,t.details&&t.details.fragments.forEach((e=>e.level=-1))),!1)));Li(n),this._levels=n,this.currentLevelIndex>-1&&null!=(t=this.currentLevel)&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const i=n.length-1;this._firstLevel=Math.min(this._firstLevel,i),this._startLevel&&(this._startLevel=Math.min(this._startLevel,i)),this.hls.trigger(u.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(u.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function Ol(e){const t={};e.forEach((e=>{const n=e.groupId||"";e.id=t[n]=t[n]||0,t[n]++}))}function Nl(){return self.SourceBuffer||self.WebKitSourceBuffer}function Ul(){const e=L();if(!e)return!1;const t=Nl();return!t||t.prototype&&"function"===typeof t.prototype.appendBuffer&&"function"===typeof t.prototype.remove}function Fl(){if(!Ul())return!1;const e=L();return"function"===typeof(null==e?void 0:e.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some((t=>e.isTypeSupported(Pe(t,"video"))))||["mp4a.40.2","fLaC"].some((t=>e.isTypeSupported(Pe(t,"audio")))))}function Bl(){var e;const t=Nl();return"function"===typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}const jl=100;class $l extends Fi{constructor(e,t,n){super(e,t,n,"stream-controller",c.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const e=this.media,t=e?e.currentTime:null;if(null===t||!i(t))return;if(this.log(`Media seeked to ${t.toFixed(3)}`),!this.getBufferedFrag(t))return;const n=this.getFwdBufferInfoAtPos(e,t,c.MAIN,0);null!==n&&0!==n.len?this.tick():this.warn(`Main forward buffer length at ${t} on "seeked" event ${n?n.len:"empty"})`)},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(u.MANIFEST_PARSED,this.onManifestParsed,this),e.on(u.LEVEL_LOADING,this.onLevelLoading,this),e.on(u.LEVEL_LOADED,this.onLevelLoaded,this),e.on(u.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(u.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(u.BUFFER_CREATED,this.onBufferCreated,this),e.on(u.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(u.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(u.MANIFEST_PARSED,this.onManifestParsed,this),e.off(u.LEVEL_LOADED,this.onLevelLoaded,this),e.off(u.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(u.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(u.BUFFER_CREATED,this.onBufferCreated,this),e.off(u.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(u.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(u.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:n,hls:i}=this;if(this.stopLoad(),this.setInterval(jl),this.level=-1,!this.startFragRequested){let e=i.startLevel;-1===e&&(i.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=i.firstAutoLevel),i.nextLoadLevel=e,this.level=i.loadLevel,this._hasEnoughToStart=!!t}n>0&&-1===e&&!t&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n),this.state=Ui.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=Ui.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Ui.WAITING_LEVEL:{const{levels:e,level:t}=this,n=null==e?void 0:e[t],i=null==n?void 0:n.details;if(i&&(!i.live||this.levelLastLoaded===n&&!this.waitForLive(n))){if(this.waitForCdnTuneIn(i))break;this.state=Ui.IDLE;break}if(this.hls.nextLoadLevel!==this.level){this.state=Ui.IDLE;break}break}case Ui.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||null!=(e=this.media)&&e.seeking){const{levels:e,level:t}=this,n=null==e?void 0:e[t];this.resetStartWhenNotLoaded(n||null),this.state=Ui.IDLE}}break}this.state===Ui.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),null!=(e=this.media)&&e.readyState&&!1===this.media.seeking&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this;if(null===t||!i&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const r=this.buffering?e.nextLoadLevel:e.loadLevel;if(null==n||!n[r])return;const s=n[r],a=this.getMainFwdBufferInfo();if(null===a)return;const o=this.getLevelDetails();if(o&&this._streamEnded(a,o)){const e={};return 2===this.altAudio&&(e.type="video"),this.hls.trigger(u.BUFFER_EOS,e),void(this.state=Ui.ENDED)}if(!this.buffering)return;e.loadLevel!==r&&-1===e.manualLevel&&this.log(`Adapting to level ${r} from level ${this.level}`),this.level=e.nextLoadLevel=r;const l=s.details;if(!l||this.state===Ui.WAITING_LEVEL||this.waitForLive(s))return this.level=r,this.state=Ui.WAITING_LEVEL,void(this.startFragRequested=!1);const d=a.len,h=this.getMaxBufferLength(s.maxBitrate);if(d>=h)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const f=this.backtrackFragment?this.backtrackFragment.start:a.end;let p=this.getNextFragment(f,l);if(this.couldBacktrack&&!this.fragPrevious&&p&&$(p)&&this.fragmentTracker.getState(p)!==Vt.OK){var g;const e=(null!=(g=this.backtrackFragment)?g:p).sn,t=e-l.startSN,n=l.fragments[t-1];n&&p.cc===n.cc&&(p=n,this.fragmentTracker.removeFragment(n))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(p&&this.isLoopLoading(p,f)){const e=p.gap;if(!e){const e=this.audioOnly&&!this.altAudio?B.AUDIO:B.VIDEO,t=(e===B.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,c.MAIN)}p=this.getNextFragmentLoopLoading(p,l,a,c.MAIN,h)}p&&(!p.initSegment||p.initSegment.data||this.bitrateTest||(p=p.initSegment),this.loadFragment(p,s,f))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);i===Vt.NOT_LOADED||i===Vt.PARTIAL?$(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,n):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,c.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const r=this.getLevelDetails();if(null!=r&&r.live){const e=this.getMainFwdBufferInfo();if(!e||e.len<2*r.targetduration)return}if(!t.paused&&e){const t=this.hls.nextLoadLevel,i=e[t],r=this.fragLastKbps;n=r&&this.fragCurrent?this.fragCurrent.duration*i.maxBitrate/(1e3*r)+1:0}else n=0;const s=this.getBufferedFrag(t.currentTime+n);if(s){const e=this.followingBufferedFrag(s);if(e){this.abortCurrentFrag();const t=e.maxStartPTS?e.maxStartPTS:e.start,n=e.duration,i=Math.max(s.end,t+Math.min(Math.max(n-this.config.maxFragLookUpTolerance,n*(this.couldBacktrack?.5:.125)),n*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(i,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Ui.KEY_LOADING:case Ui.FRAG_LOADING:case Ui.FRAG_LOADING_WAITING_RETRY:case Ui.PARSING:case Ui.PARSED:this.state=Ui.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,2===this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;Wo(n,"playing",this.onMediaPlaying),Wo(n,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:n}=this;n&&(qo(n,"playing",this.onMediaPlaying),qo(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t);const i=!!t.transferMedia;i||(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(u.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let n=!1,i=!1;t.levels.forEach((e=>{const t=e.audioCodec;t&&(n=n||-1!==t.indexOf("mp4a.40.2"),i=i||-1!==t.indexOf("mp4a.40.5"))})),this.audioCodecSwitch=n&&i&&!Bl(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==Ui.IDLE)return;const i=t.levelInfo;(!i.details||i.details.live&&(this.levelLastLoaded!==i||i.details.expired)||this.waitForCdnTuneIn(i.details))&&(this.state=Ui.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:i,startFragRequested:r}=this,s=t.level,a=t.details,o=a.totalduration;if(!i)return void this.warn(`Levels were reset while loading level ${s}`);this.log(`Level ${s} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${o}`);const l=t.levelInfo,c=this.fragCurrent;!c||this.state!==Ui.FRAG_LOADING&&this.state!==Ui.FRAG_LOADING_WAITING_RETRY||c.level!==t.level&&c.loader&&this.abortCurrentFrag();let d=0;if(a.live||null!=(n=l.details)&&n.live){var h;if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;d=this.alignPlaylists(a,l.details,null==(h=this.levelLastLoaded)?void 0:h.details)}if(l.details=a,this.levelLastLoaded=l,r||this.setStartPosition(a,d),this.hls.trigger(u.LEVEL_UPDATED,{details:a,level:s}),this.state===Ui.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=Ui.IDLE}r&&a.live&&this.synchronizeToLiveEdge(a),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,r=this.getLoadPosition(),s=e.fragmentStart,a=e.edge,o=r>=s-t.maxFragLookUpTolerance&&r<=a;if(null!==i&&n.duration>i&&(r<i||!o)){const s=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!o&&n.readyState<4||r<a-s)&&(this._hasEnoughToStart||(this.nextLoadPosition=i),n.readyState&&(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${i.toFixed(3)}`),n.currentTime=i))}}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:i,payload:r}=e,{levels:s}=this;if(!s)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const a=s[n.level];if(!a)return void this.warn(`Level ${n.level} not found on progress`);const o=a.details;if(!o)return this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),void this.fragmentTracker.removeFragment(n);const u=a.videoCodec,l=o.PTSKnown||!o.live,d=null==(t=n.initSegment)?void 0:t.data,h=this._getAudioCodec(a),f=this.transmuxer=this.transmuxer||new Qs(this.hls,c.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),p=i?i.index:-1,g=-1!==p,m=new cn(n.level,n.sn,n.stats.chunkCount,r.byteLength,p,g),v=this.initPTS[n.cc];f.push(r,d,h,u,n,i,o.totalduration,l,m,v)}onAudioTrackSwitching(e,t){const n=this.hls,i=2===this.altAudio,r=wt(t.url,n);if(r)this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const e=this.fragCurrent;e&&(this.log("Switching to main audio track, cancel main fragment load"),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(i)return this.fragmentTracker.removeAllFragments(),n.once(u.BUFFER_FLUSHED,(()=>{var e;null==(e=this.hls)||e.trigger(u.AUDIO_TRACK_SWITCHED,t)})),void n.trigger(u.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});n.trigger(u.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=wt(t.url,this.hls);if(n){const e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=e)}this.altAudio=n?2:0,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,r,s=!1;for(const a in n){const e=n[a];if("main"===e.id){if(r=a,i=e,"video"===a){const e=n[a];e&&(this.videoBuffer=e.buffer)}}else s=!0}s&&i?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t,r=n.type===c.MAIN;if(r){if(this.fragContextChanged(n))return this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===Ui.PARSED&&(this.state=Ui.IDLE));const e=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*e.total/(e.buffering.end-e.loading.first)),$(n)&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}const s=this.media;s&&(!this._hasEnoughToStart&&fn.getBuffered(s).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),r&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var n;if(t.fatal)this.state=Ui.ERROR;else switch(t.details){case o.FRAG_GAP:case o.FRAG_PARSING_ERROR:case o.FRAG_DECRYPT_ERROR:case o.FRAG_LOAD_ERROR:case o.FRAG_LOAD_TIMEOUT:case o.KEY_LOAD_ERROR:case o.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(c.MAIN,t);break;case o.LEVEL_LOAD_ERROR:case o.LEVEL_LOAD_TIMEOUT:case o.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Ui.WAITING_LEVEL||(null==(n=t.context)?void 0:n.type)!==l.LEVEL||(this.state=Ui.IDLE);break;case o.BUFFER_ADD_CODEC_ERROR:case o.BUFFER_APPEND_ERROR:if("main"!==t.parent)return;this.resetLoadingState();break;case o.BUFFER_FULL_ERROR:if("main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case o.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=Ui.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==B.AUDIO||!this.altAudio){const e=(t===B.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;e&&(this.afterBufferFlushed(e,t,c.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,-1===this.level&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking)return void this.log(`could not seek to ${n}, already seeking at ${t}`);const i=this.timelineOffset;i&&n&&(n+=i);const r=this.getLevelDetails(),s=fn.getBuffered(e),a=s.length?s.start(0):0,o=a-n,u=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);o>0&&(o<u||this.loadingParts&&o<2*((null==r?void 0:r.partTarget)||0))&&(this.log(`adjusting start position by ${o} to match buffer start`),n+=o,this.startPosition=n),t<n&&(this.log(`seek to target start position ${n} from current time ${t} buffer start ${a}`),e.currentTime=n)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then((e=>{const{hls:n}=this,i=null==e?void 0:e.frag;if(!i||this.fragContextChanged(i))return;t.fragmentError=0,this.state=Ui.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const r=i.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),n.trigger(u.FRAG_LOADED,e),i.bitrateTest=!1}))}_handleTransmuxComplete(e){var t;const n=this.playlistType,{hls:r}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o)return void this.resetWhenMissingContext(a);const{frag:l,part:c,level:d}=o,{video:h,text:f,id3:p,initSegment:g}=s,{details:m}=d,v=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l))this.fragmentTracker.removeFragment(l);else{if(this.state=Ui.PARSING,g){if(null!=g&&g.tracks){const e=l.initSegment||l;this._bufferInitSegment(d,g.tracks,e,a),r.trigger(u.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:g.tracks})}const e=g.initPTS,t=g.timescale;i(e)&&(this.initPTS[l.cc]={baseTime:e,timescale:t},r.trigger(u.INIT_PTS_FOUND,{frag:l,id:n,initPTS:e,timescale:t}))}if(h&&m){v&&"audiovideo"===h.type&&this.logMuxedErr(l);const e=m.fragments[l.sn-1-m.startSN],t=l.sn===m.startSN,n=!e||l.cc>e.cc;if(!1!==s.independent){const{startPTS:e,endPTS:i,startDTS:r,endDTS:s}=h;if(c)c.elementaryStreams[h.type]={startPTS:e,endPTS:i,startDTS:r,endDTS:s};else if(h.firstKeyFrame&&h.independent&&1===a.id&&!n&&(this.couldBacktrack=!0),h.dropped&&h.independent){const r=this.getMainFwdBufferInfo(),a=(r?r.end:this.getLoadPosition())+this.config.maxBufferHole,o=h.firstKeyFramePTS?h.firstKeyFramePTS:e;if(!t&&a<o-this.config.maxBufferHole&&!n)return void this.backtrack(l);n&&(l.gap=!0),l.setElementaryStreamInfo(h.type,l.start,i,l.start,s,!0)}else t&&e-(m.appliedTimelineOffset||0)>Tl&&(l.gap=!0);l.setElementaryStreamInfo(h.type,e,i,r,s),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(h,l,c,a,t||n)}else{if(!t&&!n)return void this.backtrack(l);l.gap=!0}}if(v){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=v;c&&(c.elementaryStreams[B.AUDIO]={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),l.setElementaryStreamInfo(B.AUDIO,e,t,n,i),this.bufferFragmentData(v,l,c,a)}if(m&&null!=p&&null!=(t=p.samples)&&t.length){const e={id:n,frag:l,details:m,samples:p.samples};r.trigger(u.FRAG_PARSING_METADATA,e)}if(m&&f){const e={id:n,frag:l,details:m,samples:f.samples};r.trigger(u.FRAG_PARSING_USERDATA,e)}}}logMuxedErr(e){this.warn(`${$(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,n,i){if(this.state!==Ui.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(n));const{audio:r,video:s,audiovideo:a}=t;if(r){let n=$e(r.codec,e.audioCodec);"mp4a"===n&&(n="mp4a.40.5");const i=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){n&&(n=-1!==n.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const e=r.metadata;e&&"channelCount"in e&&1!==(e.channelCount||1)&&-1===i.indexOf("firefox")&&(n="mp4a.40.5")}n&&-1!==n.indexOf("mp4a.40.5")&&-1!==i.indexOf("android")&&"audio/mpeg"!==r.container&&(n="mp4a.40.2",this.log(`Android: force audio codec to ${n}`)),e.audioCodec&&e.audioCodec!==n&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${n}"`),r.levelCodec=n,r.id=c.MAIN,this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${n||""}/${e.audioCodec||""}/${r.codec}]`),delete t.audiovideo}if(s){s.levelCodec=e.videoCodec,s.id=c.MAIN;const n=s.codec;if(4===(null==n?void 0:n.length))switch(n){case"hvc1":case"hev1":s.codec="hvc1.1.6.L120.90";break;case"av01":s.codec="av01.0.04M.08";break;case"avc1":s.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${s.container}, codecs[level/parsed]=[${e.videoCodec||""}/${n}]${s.codec!==n?" parsed-corrected="+s.codec:""}${s.supplemental?" supplemental="+s.supplemental:""}`),delete t.audiovideo}a&&(this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),delete t.video,delete t.audio);const o=Object.keys(t);if(o.length){if(this.hls.trigger(u.BUFFER_CODECS,t),!this.hls)return;o.forEach((e=>{const r=t[e],s=r.initSegment;null!=s&&s.byteLength&&this.hls.trigger(u.BUFFER_APPENDING,{type:e,data:s,frag:n,part:null,chunkMeta:i,parent:n.type})}))}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&2===this.altAudio?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,c.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,n=null==e?void 0:e[t];return n?this.getMaxBufferLength(n.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Ui.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const n=e.currentTime;if(fn.isBuffered(e,n)?t=this.getAppendedFrag(n):fn.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const e=this.fragPlaying,n=t.level;e&&t.sn===e.sn&&e.level===n||(this.fragPlaying=t,this.hls.trigger(u.FRAG_CHANGED,{frag:t}),e&&e.level===n||this.hls.trigger(u.LEVEL_SWITCHED,{level:n}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;return i(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;if(i(t)){const e=this.getLevelDetails(),n=this.currentFrag||(e?kt(null,e.fragments,t):null);if(n){const e=n.programDateTime;if(null!==e){const i=e+1e3*(t-n.start);return new Date(i)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Gl{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[n].loader;if(i){var t;if(e&&e!==(null==(t=i.context)?void 0:t.frag.type))return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=o.KEY_LOAD_ERROR,n,i,r){return new un({type:a.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:n,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:i}=e;for(let e=0;e<t.length;e++){const r=t[e];if(i<=r.cc&&("initSegment"===n||"initSegment"===r.sn||n<r.sn)){this.emeController.selectKeySystemFormat(r).then((e=>{r.setKeyFormat(e)}));break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then((t=>this.loadInternal(e,t))):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const n=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,o.KEY_LOAD_ERROR,n))}const s=r.uri;if(!s)return Promise.reject(this.createKeyLoadError(e,o.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${s}"`)));let a=this.keyUriToKeyInfo[s];if(null!=(n=a)&&n.decryptdata.key)return r.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});var u;if(null!=(i=a)&&i.keyLoadPromise)switch(null==(u=a.mediaKeySessionContext)?void 0:u.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then((t=>(r.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:a})))}switch(a=this.keyUriToKeyInfo[s]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===r.keyFormat?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,o.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const t=this.emeController.loadKey(n);if(t)return(e.keyLoadPromise=t.then((t=>(e.mediaKeySessionContext=t,n)))).catch((t=>{throw e.keyLoadPromise=null,t}))}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=n.loader,r=new i(n);return t.keyLoader=e.loader=r,e.keyLoadPromise=new Promise(((i,s)=>{const a={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=n.keyLoadPolicy.default,l={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(e,t,n,r)=>{const{frag:a,keyInfo:u,url:l}=n;if(!a.decryptdata||u!==this.keyUriToKeyInfo[l])return s(this.createKeyLoadError(a,o.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),r));u.decryptdata.key=a.decryptdata.key=new Uint8Array(e.data),a.keyLoader=null,u.loader=null,i({frag:a,keyInfo:u})},onError:(e,n,i,r)=>{this.resetLoader(n),s(this.createKeyLoadError(t,o.KEY_LOAD_ERROR,new Error(`HTTP Error ${e.code} loading key ${e.text}`),i,m({url:a.url,data:void 0},e)))},onTimeout:(e,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(t,o.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),i))},onAbort:(e,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(t,o.INTERNAL_ABORTED,new Error("key loading aborted"),i))}};r.load(a,l,c)}))}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,r=n.loader;t.keyLoader===r&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],r&&r.destroy()}}function Vl(e){const{type:t}=e;switch(t){case l.AUDIO_TRACK:return c.AUDIO;case l.SUBTITLE_TRACK:return c.SUBTITLE;default:return c.MAIN}}function Hl(e,t){let n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n}class Kl{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(u.MANIFEST_LOADING,this.onManifestLoading,this),e.on(u.LEVEL_LOADING,this.onLevelLoading,this),e.on(u.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(u.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(u.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(u.MANIFEST_LOADING,this.onManifestLoading,this),e.off(u.LEVEL_LOADING,this.onLevelLoading,this),e.off(u.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(u.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(u.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,r=n||i,s=new r(t);return this.loaders[e.type]=s,s}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:l.MANIFEST,url:n,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:n,level:i,pathwayId:r,url:s,deliveryDirectives:a,levelInfo:o}=t;this.load({id:n,level:i,pathwayId:r,responseType:"text",type:l.LEVEL,url:s,deliveryDirectives:a,levelOrTrack:o})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:s,track:a}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:l.AUDIO_TRACK,url:r,deliveryDirectives:s,levelOrTrack:a})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:s,track:a}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:l.SUBTITLE_TRACK,url:r,deliveryDirectives:s,levelOrTrack:a})}onLevelsUpdated(e,t){const n=this.loaders[l.LEVEL];if(n){const e=n.context;e&&!t.levels.some((t=>t===e.levelOrTrack))&&(n.abort(),delete this.loaders[l.LEVEL])}}load(e){var t;const n=this.hls.config;let r,s=this.getInternalLoader(e);if(s){const t=this.hls.logger,n=s.context;if(n&&n.levelOrTrack===e.levelOrTrack&&(n.url===e.url||n.deliveryDirectives&&!e.deliveryDirectives))return void(n.url===e.url?t.log(`[playlist-loader]: ignore ${e.url} ongoing request`):t.log(`[playlist-loader]: ignore ${e.url} in favor of ${n.url}`));t.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),s.abort()}if(r=e.type===l.MANIFEST?n.manifestLoadPolicy.default:p({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(e),i(null==(t=e.deliveryDirectives)?void 0:t.part)){let t;if(e.type===l.LEVEL&&null!==e.level?t=this.hls.levels[e.level].details:e.type===l.AUDIO_TRACK&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===l.SUBTITLE_TRACK&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t){const e=t.partTarget,n=t.targetduration;if(e&&n){const t=1e3*Math.max(3*e,.8*n);r=p({},r,{maxTimeToFirstByteMs:Math.min(t,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,r.maxTimeToFirstByteMs)})}}}const a=r.errorRetry||r.timeoutRetry||{},o={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},u={onSuccess:(e,t,n,i)=>{const r=this.getInternalLoader(n);this.resetInternalLoader(n.type);const s=e.data;0===s.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),ni.isMediaPlaylist(s)||n.type!==l.MANIFEST?this.handleTrackOrLevelPlaylist(e,t,n,i||null,r):this.handleMasterPlaylist(e,t,n,i)):this.handleManifestParsingError(e,n,new Error("no EXTM3U delimiter"),i||null,t)},onError:(e,t,n,i)=>{this.handleNetworkError(t,n,!1,e,i)},onTimeout:(e,t,n)=>{this.handleNetworkError(t,n,!0,void 0,e)}};s.load(e,o,u)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:n}=this.hls;(e||n)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,n,i){const r=this.hls,s=e.data,a=Hl(e,n),o=ni.parseMasterPlaylist(s,a);if(o.playlistParsingError)return void this.handleManifestParsingError(e,n,o.playlistParsingError,i,t);const{contentSteering:l,levels:c,sessionData:d,sessionKeys:h,startTimeOffset:f,variableList:p}=o;this.variableList=p;const{AUDIO:g=[],SUBTITLES:m,"CLOSED-CAPTIONS":v}=ni.parseMasterPlaylistMedia(s,a,o);if(g.length){const e=g.some((e=>!e.url));e||!c[0].audioCodec||c[0].attrs.AUDIO||(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),g.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Sn({}),bitrate:0,url:""}))}r.trigger(u.MANIFEST_LOADED,{levels:c,audioTracks:g,subtitles:m,captions:v,contentSteering:l,url:a,stats:t,networkDetails:i,sessionData:d,sessionKeys:h,startTimeOffset:f,variableList:p})}handleTrackOrLevelPlaylist(e,t,n,r,s){const a=this.hls,{id:o,level:c,type:d}=n,h=Hl(e,n),f=i(c)?c:i(o)?o:0,p=Vl(n),g=ni.parseLevelPlaylist(e.data,h,f,p,0,this.variableList);if(d===l.MANIFEST){const e={attrs:new Sn({}),bitrate:0,details:g,name:"",url:h};g.requestScheduled=t.loading.start+Ai(g,0),a.trigger(u.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:h,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=g,this.handlePlaylistLoaded(g,e,t,n,r,s)}handleManifestParsingError(e,t,n,i,r){this.hls.trigger(u.ERROR,{type:a.NETWORK_ERROR,details:o.MANIFEST_PARSING_ERROR,fatal:t.type===l.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:r})}handleNetworkError(e,t,n=!1,i,r){let s=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===l.LEVEL?s+=`: ${e.level} id: ${e.id}`:e.type!==l.AUDIO_TRACK&&e.type!==l.SUBTITLE_TRACK||(s+=` id: ${e.id} group-id: "${e.groupId}"`);const c=new Error(s);this.hls.logger.warn(`[playlist-loader]: ${s}`);let d=o.UNKNOWN,h=!1;const f=this.getInternalLoader(e);switch(e.type){case l.MANIFEST:d=n?o.MANIFEST_LOAD_TIMEOUT:o.MANIFEST_LOAD_ERROR,h=!0;break;case l.LEVEL:d=n?o.LEVEL_LOAD_TIMEOUT:o.LEVEL_LOAD_ERROR,h=!1;break;case l.AUDIO_TRACK:d=n?o.AUDIO_TRACK_LOAD_TIMEOUT:o.AUDIO_TRACK_LOAD_ERROR,h=!1;break;case l.SUBTITLE_TRACK:d=n?o.SUBTITLE_TRACK_LOAD_TIMEOUT:o.SUBTITLE_LOAD_ERROR,h=!1;break}f&&this.resetInternalLoader(e.type);const p={type:a.NETWORK_ERROR,details:d,fatal:h,url:e.url,loader:f,context:e,error:c,networkDetails:t,stats:r};if(i){const n=(null==t?void 0:t.url)||e.url;p.response=m({url:n,data:void 0},i)}this.hls.trigger(u.ERROR,p)}handlePlaylistLoaded(e,t,n,i,r,s){const d=this.hls,{type:h,level:f,id:p,groupId:g,deliveryDirectives:m}=i,v=Hl(t,i),y=Vl(i),b="number"===typeof i.level&&y===c.MAIN?f:void 0;if(!e.fragments.length){const s=e.playlistParsingError=new Error("No Segments found in Playlist");return void d.trigger(u.ERROR,{type:a.NETWORK_ERROR,details:o.LEVEL_EMPTY_ERROR,fatal:!1,url:v,error:s,reason:s.message,response:t,context:i,level:b,parent:y,networkDetails:r,stats:n})}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const T=e.playlistParsingError;if(T){if(this.hls.logger.warn(T),!d.config.ignorePlaylistParsingErrors)return void d.trigger(u.ERROR,{type:a.NETWORK_ERROR,details:o.LEVEL_PARSING_ERROR,fatal:!1,url:v,error:T,reason:T.message,response:t,context:i,level:b,parent:y,networkDetails:r,stats:n});e.playlistParsingError=null}switch(e.live&&s&&(s.getCacheAge&&(e.ageHeader=s.getCacheAge()||0),s.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),h){case l.MANIFEST:case l.LEVEL:d.trigger(u.LEVEL_LOADED,{details:e,levelInfo:i.levelOrTrack||d.levels[0],level:b||0,id:p||0,stats:n,networkDetails:r,deliveryDirectives:m,withoutMultiVariant:h===l.MANIFEST});break;case l.AUDIO_TRACK:d.trigger(u.AUDIO_TRACK_LOADED,{details:e,track:i.levelOrTrack,id:p||0,groupId:g||"",stats:n,networkDetails:r,deliveryDirectives:m});break;case l.SUBTITLE_TRACK:d.trigger(u.SUBTITLE_TRACK_LOADED,{details:e,track:i.levelOrTrack,id:p||0,groupId:g||"",stats:n,networkDetails:r,deliveryDirectives:m});break}}}class Wl{static get version(){return qi}static isMSESupported(){return Ul()}static isSupported(){return Fl()}static getMediaSource(){return L()}static get Events(){return u}static get MetadataSchema(){return Ur}static get ErrorTypes(){return a}static get ErrorDetails(){return o}static get DefaultConfig(){return Wl.defaultConfig?Wl.defaultConfig:gl}static set DefaultConfig(e){Wl.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Wi,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=I(e.debug||!1,"Hls instance",e.assetPlayerId),n=this.config=vl(Wl.DefaultConfig,e,t);this.userConfig=e,n.progressive&&bl(n,t);const{abrController:i,bufferController:r,capLevelController:s,errorController:a,fpsController:o}=n,l=new a(this),c=this.abrController=new i(this),d=new Ht(this),h=n.interstitialsController,f=h?this.interstitialsController=new h(this,Wl):null,p=this.bufferController=new r(this,d),g=this.capLevelController=new s(this),m=new o(this),v=new Kl(this),y=n.contentSteeringController,b=y?new y(this):null,T=this.levelController=new _l(this,b),S=new Ml(this),E=new Gl(this.config),w=this.streamController=new $l(this,d,E),A=this.gapController=new Al(this,d);g.setStreamController(w),m.setStreamController(w);const x=[v,T,w];f&&x.splice(1,0,f),b&&x.splice(1,0,b),this.networkControllers=x;const k=[c,p,A,g,m,S,d];this.audioTrackController=this.createController(n.audioTrackController,x);const L=n.audioStreamController;L&&x.push(this.audioStreamController=new L(this,d,E)),this.subtitleTrackController=this.createController(n.subtitleTrackController,x);const R=n.subtitleStreamController;R&&x.push(this.subtititleStreamController=new R(this,d,E)),this.createController(n.timelineController,k),E.emeController=this.emeController=this.createController(n.emeController,k),this.cmcdController=this.createController(n.cmcdController,k),this.latencyController=this.createController(Pl,k),this.coreComponents=k,x.push(l);const C=l.onErrorOut;"function"===typeof C&&this.on(u.ERROR,C,l),this.on(u.MANIFEST_LOADED,v.onManifestLoaded,v)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const t=e===u.ERROR;this.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.INTERNAL_EXCEPTION,fatal:t,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(u.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach((e=>e.destroy())),this.networkControllers.length=0,this.coreComponents.forEach((e=>e.destroy())),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const t=new Error(`attachMedia failed: invalid argument (${e})`);return void this.trigger(u.ERROR,{type:a.OTHER_ERROR,details:o.ATTACH_MEDIA_ERROR,fatal:!0,error:t})}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,n=t?e.media:e,i=t?e:{media:n};this._media=n,this.trigger(u.MEDIA_ATTACHING,i)}detachMedia(){this.logger.log("detachMedia"),this.trigger(u.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(u.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,n=this._url,i=this._url=U.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(u.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let n=0;n<this.networkControllers.length;n++)if(this.networkControllers[n].startLoad(e,t),!this.started||!this.networkControllers)break}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length;e++)if(this.networkControllers[e].stopLoad(),this.started||!this.networkControllers)break}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach((e=>{e.resumeBuffering&&e.resumeBuffering()})))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach((e=>{e.pauseBuffering&&e.pauseBuffering()})))}get inFlightFragments(){const e={[c.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[c.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[c.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=null==e?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=Er()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return-1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){Ze(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(i=-1===t&&null!=e&&e.length?e.length-1:t,n)for(let r=i;r--;){const t=e[r].attrs["HDCP-LEVEL"];if(t&&t<=n)return r}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return(null==(t=this.audioTrackController)?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return(null==(t=this.subtitleTrackController)?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!(null==(e=this.bufferController)||!e.bufferedToEnd)}get interstitialsManager(){var e;return(null==(e=this.interstitialsController)?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const n=ft(t);return ze(e,n,navigator.mediaCapabilities)}}Wl.defaultConfig=void 0},4055:function(e,t,n){"use strict";var i=n(4576),r=n(34),s=i.document,a=r(s)&&r(s.createElement);e.exports=function(e){return a?s.createElement(e):{}}},4068:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var i=n(5808);function r(e,t){return(0,i.w)(t||e,e)}},4114:function(e,t,n){"use strict";var i=n(6518),r=n(8981),s=n(6198),a=n(4527),o=n(6837),u=n(9039),l=u((function(){return 4294967297!==[].push.call({length:4294967296},1)})),c=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},d=l||!c();i({target:"Array",proto:!0,arity:1,forced:d},{push:function(e){var t=r(this),n=s(t),i=arguments.length;o(n+i);for(var u=0;u<i;u++)t[n]=arguments[u],n++;return a(t,n),n}})},4117:function(e){"use strict";e.exports=function(e){return null===e||void 0===e}},4138:function(e,t,n){"use strict";n.d(t,{GP:function(){return H}});n(8111),n(1701);var i=n(8541),r=n(9369),s=n(1712),a=n(4068);function o(e,t){const n=(0,a.a)(e,t?.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function u(e,t){const n=(0,a.a)(e,t?.in),i=(0,s.m)(n,o(n)),r=i+1;return r}var l=n(2436);function c(e,t){const n=(0,r.q)(),i=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,s=(0,a.a)(e,t?.in),o=s.getDay(),u=(o<i?7:0)+o-i;return s.setDate(s.getDate()-u),s.setHours(0,0,0,0),s}function d(e,t){return c(e,{...t,weekStartsOn:1})}var h=n(5808);function f(e,t){const n=(0,a.a)(e,t?.in),i=n.getFullYear(),r=(0,h.w)(n,0);r.setFullYear(i+1,0,4),r.setHours(0,0,0,0);const s=d(r),o=(0,h.w)(n,0);o.setFullYear(i,0,4),o.setHours(0,0,0,0);const u=d(o);return n.getTime()>=s.getTime()?i+1:n.getTime()>=u.getTime()?i:i-1}function p(e,t){const n=f(e,t),i=(0,h.w)(t?.in||e,0);return i.setFullYear(n,0,4),i.setHours(0,0,0,0),d(i)}function g(e,t){const n=(0,a.a)(e,t?.in),i=+d(n)-+p(n);return Math.round(i/l.my)+1}function m(e,t){const n=(0,a.a)(e,t?.in),i=n.getFullYear(),s=(0,r.q)(),o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,u=(0,h.w)(t?.in||e,0);u.setFullYear(i+1,0,o),u.setHours(0,0,0,0);const l=c(u,t),d=(0,h.w)(t?.in||e,0);d.setFullYear(i,0,o),d.setHours(0,0,0,0);const f=c(d,t);return+n>=+l?i+1:+n>=+f?i:i-1}function v(e,t){const n=(0,r.q)(),i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,s=m(e,t),a=(0,h.w)(t?.in||e,0);a.setFullYear(s,0,i),a.setHours(0,0,0,0);const o=c(a,t);return o}function y(e,t){const n=(0,a.a)(e,t?.in),i=+c(n,t)-+v(n,t);return Math.round(i/l.my)+1}function b(e,t){const n=e<0?"-":"",i=Math.abs(e).toString().padStart(t,"0");return n+i}const T={y(e,t){const n=e.getFullYear(),i=n>0?n:1-n;return b("yy"===t?i%100:i,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):b(n+1,2)},d(e,t){return b(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return"am"===n?"a.m.":"p.m."}},h(e,t){return b(e.getHours()%12||12,t.length)},H(e,t){return b(e.getHours(),t.length)},m(e,t){return b(e.getMinutes(),t.length)},s(e,t){return b(e.getSeconds(),t.length)},S(e,t){const n=t.length,i=e.getMilliseconds(),r=Math.trunc(i*Math.pow(10,n-3));return b(r,t.length)}},S={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},E={G:function(e,t,n){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});case"GGGG":default:return n.era(i,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),i=t>0?t:1-t;return n.ordinalNumber(i,{unit:"year"})}return T.y(e,t)},Y:function(e,t,n,i){const r=m(e,i),s=r>0?r:1-r;if("YY"===t){const e=s%100;return b(e,2)}return"Yo"===t?n.ordinalNumber(s,{unit:"year"}):b(s,t.length)},R:function(e,t){const n=f(e);return b(n,t.length)},u:function(e,t){const n=e.getFullYear();return b(n,t.length)},Q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return b(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return b(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,n){const i=e.getMonth();switch(t){case"M":case"MM":return T.M(e,t);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,n){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return b(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,n,i){const r=y(e,i);return"wo"===t?n.ordinalNumber(r,{unit:"week"}):b(r,t.length)},I:function(e,t,n){const i=g(e);return"Io"===t?n.ordinalNumber(i,{unit:"week"}):b(i,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):T.d(e,t)},D:function(e,t,n){const i=u(e);return"Do"===t?n.ordinalNumber(i,{unit:"dayOfYear"}):b(i,t.length)},E:function(e,t,n){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});case"EEEE":default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,n,i){const r=e.getDay(),s=(r-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return b(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(e,t,n,i){const r=e.getDay(),s=(r-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return b(s,t.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(e,t,n){const i=e.getDay(),r=0===i?7:i;switch(t){case"i":return String(r);case"ii":return b(r,t.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});case"iiii":default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,n){const i=e.getHours(),r=i/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){const i=e.getHours();let r;switch(r=12===i?S.noon:0===i?S.midnight:i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){const i=e.getHours();let r;switch(r=i>=17?S.evening:i>=12?S.afternoon:i>=4?S.morning:S.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return T.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):T.H(e,t)},K:function(e,t,n){const i=e.getHours()%12;return"Ko"===t?n.ordinalNumber(i,{unit:"hour"}):b(i,t.length)},k:function(e,t,n){let i=e.getHours();return 0===i&&(i=24),"ko"===t?n.ordinalNumber(i,{unit:"hour"}):b(i,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):T.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):T.s(e,t)},S:function(e,t){return T.S(e,t)},X:function(e,t,n){const i=e.getTimezoneOffset();if(0===i)return"Z";switch(t){case"X":return A(i);case"XXXX":case"XX":return x(i);case"XXXXX":case"XXX":default:return x(i,":")}},x:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"x":return A(i);case"xxxx":case"xx":return x(i);case"xxxxx":case"xxx":default:return x(i,":")}},O:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+w(i,":");case"OOOO":default:return"GMT"+x(i,":")}},z:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+w(i,":");case"zzzz":default:return"GMT"+x(i,":")}},t:function(e,t,n){const i=Math.trunc(+e/1e3);return b(i,t.length)},T:function(e,t,n){return b(+e,t.length)}};function w(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),r=Math.trunc(i/60),s=i%60;return 0===s?n+String(r):n+String(r)+t+b(s,2)}function A(e,t){if(e%60===0){const t=e>0?"-":"+";return t+b(Math.abs(e)/60,2)}return x(e,t)}function x(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),r=b(Math.trunc(i/60),2),s=b(i%60,2);return n+r+t+s}const I=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},k=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},L=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],i=n[1],r=n[2];if(!r)return I(e,t);let s;switch(i){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",I(i,t)).replace("{{time}}",k(r,t))},R={p:k,P:L},C=/^D+$/,D=/^Y+$/,M=["D","DD","YY","YYYY"];function P(e){return C.test(e)}function _(e){return D.test(e)}function O(e,t,n){const i=N(e,t,n);if(console.warn(i),M.includes(e))throw new RangeError(i)}function N(e,t,n){const i="Y"===e[0]?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}function U(e){return e instanceof Date||"object"===typeof e&&"[object Date]"===Object.prototype.toString.call(e)}function F(e){return!(!U(e)&&"number"!==typeof e||isNaN(+(0,a.a)(e)))}const B=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,j=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,$=/^'([^]*?)'?$/,G=/''/g,V=/[a-zA-Z]/;function H(e,t,n){const s=(0,r.q)(),o=n?.locale??s.locale??i.c,u=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,l=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??s.weekStartsOn??s.locale?.options?.weekStartsOn??0,c=(0,a.a)(e,n?.in);if(!F(c))throw new RangeError("Invalid time value");let d=t.match(j).map((e=>{const t=e[0];if("p"===t||"P"===t){const n=R[t];return n(e,o.formatLong)}return e})).join("").match(B).map((e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:K(e)};if(E[t])return{isToken:!0,value:e};if(t.match(V))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}}));o.localize.preprocessor&&(d=o.localize.preprocessor(c,d));const h={firstWeekContainsDate:u,weekStartsOn:l,locale:o};return d.map((i=>{if(!i.isToken)return i.value;const r=i.value;(!n?.useAdditionalWeekYearTokens&&_(r)||!n?.useAdditionalDayOfYearTokens&&P(r))&&O(r,t,String(e));const s=E[r[0]];return s(c,r,o.localize,h)})).join("")}function K(e){const t=e.match($);return t?t[1].replace(G,"'"):e}},4156:function(e,t,n){"use strict";n.d(t,{x:function(){return r}});n(8111),n(116),n(1701);var i=n(5808);function r(e,...t){const n=i.w.bind(null,e||t.find((e=>"object"===typeof e)));return t.map(n)}},4204:function(e,t,n){"use strict";var i=n(7080),r=n(4402).add,s=n(9286),a=n(3789),o=n(507);e.exports=function(e){var t=i(this),n=a(e).getIterator(),u=s(t);return o(n,(function(e){r(u,e)})),u}},4209:function(e,t,n){"use strict";var i=n(8227),r=n(6269),s=i("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[s]===e)}},4215:function(e,t,n){"use strict";var i=n(4576),r=n(2839),s=n(2195),a=function(e){return r.slice(0,e.length)===e};e.exports=function(){return a("Bun/")?"BUN":a("Cloudflare-Workers")?"CLOUDFLARE":a("Deno/")?"DENO":a("Node.js/")?"NODE":i.Bun&&"string"==typeof Bun.version?"BUN":i.Deno&&"object"==typeof Deno.version?"DENO":"process"===s(i.process)?"NODE":i.window&&i.document?"BROWSER":"REST"}()},4232:function(e,t,n){"use strict";n.d(t,{$3:function(){return f},$H:function(){return U},BH:function(){return K},BX:function(){return ne},Bm:function(){return S},C4:function(){return Q},CE:function(){return g},CP:function(){return l},DY:function(){return F},Gv:function(){return E},J$:function(){return Z},Kg:function(){return T},MZ:function(){return r},Mp:function(){return u},NO:function(){return o},Oj:function(){return s},PT:function(){return M},Qd:function(){return k},Ro:function(){return $},SU:function(){return R},TF:function(){return d},Tg:function(){return _},Tn:function(){return b},Tr:function(){return W},We:function(){return V},X$:function(){return c},Y2:function(){return ee},ZH:function(){return O},Zf:function(){return I},bB:function(){return j},cy:function(){return p},gd:function(){return y},pD:function(){return i},rU:function(){return N},tE:function(){return a},u3:function(){return ie},vM:function(){return m},v_:function(){return se},yI:function(){return L},yL:function(){return w},yQ:function(){return B}});n(4114),n(8111),n(2489),n(7588);
/**
* @vue/shared v3.5.14
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/
/*! #__NO_SIDE_EFFECTS__ */
function i(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return e=>e in t}const r={},s=[],a=()=>{},o=()=>!1,u=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),l=e=>e.startsWith("onUpdate:"),c=Object.assign,d=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},h=Object.prototype.hasOwnProperty,f=(e,t)=>h.call(e,t),p=Array.isArray,g=e=>"[object Map]"===x(e),m=e=>"[object Set]"===x(e),v=e=>"[object Date]"===x(e),y=e=>"[object RegExp]"===x(e),b=e=>"function"===typeof e,T=e=>"string"===typeof e,S=e=>"symbol"===typeof e,E=e=>null!==e&&"object"===typeof e,w=e=>(E(e)||b(e))&&b(e.then)&&b(e.catch),A=Object.prototype.toString,x=e=>A.call(e),I=e=>x(e).slice(8,-1),k=e=>"[object Object]"===x(e),L=e=>T(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,R=i(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),C=e=>{const t=Object.create(null);return n=>{const i=t[n];return i||(t[n]=e(n))}},D=/-(\w)/g,M=C((e=>e.replace(D,((e,t)=>t?t.toUpperCase():"")))),P=/\B([A-Z])/g,_=C((e=>e.replace(P,"-$1").toLowerCase())),O=C((e=>e.charAt(0).toUpperCase()+e.slice(1))),N=C((e=>{const t=e?`on${O(e)}`:"";return t})),U=(e,t)=>!Object.is(e,t),F=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},B=(e,t,n,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:n})},j=e=>{const t=parseFloat(e);return isNaN(t)?e:t},$=e=>{const t=T(e)?Number(e):NaN;return isNaN(t)?e:t};let G;const V=()=>G||(G="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{});const H="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol",K=i(H);function W(e){if(p(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],r=T(i)?z(i):W(i);if(r)for(const e in r)t[e]=r[e]}return t}if(T(e)||E(e))return e}const q=/;(?![^(]*\))/g,Y=/:([^]+)/,X=/\/\*[^]*?\*\//g;function z(e){const t={};return e.replace(X,"").split(q).forEach((e=>{if(e){const n=e.split(Y);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}function Q(e){let t="";if(T(e))t=e;else if(p(e))for(let n=0;n<e.length;n++){const i=Q(e[n]);i&&(t+=i+" ")}else if(E(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const J="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Z=i(J);function ee(e){return!!e||""===e}function te(e,t){if(e.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<e.length;i++)n=ne(e[i],t[i]);return n}function ne(e,t){if(e===t)return!0;let n=v(e),i=v(t);if(n||i)return!(!n||!i)&&e.getTime()===t.getTime();if(n=S(e),i=S(t),n||i)return e===t;if(n=p(e),i=p(t),n||i)return!(!n||!i)&&te(e,t);if(n=E(e),i=E(t),n||i){if(!n||!i)return!1;const r=Object.keys(e).length,s=Object.keys(t).length;if(r!==s)return!1;for(const n in e){const i=e.hasOwnProperty(n),r=t.hasOwnProperty(n);if(i&&!r||!i&&r||!ne(e[n],t[n]))return!1}}return String(e)===String(t)}function ie(e,t){return e.findIndex((e=>ne(e,t)))}const re=e=>!(!e||!0!==e["__v_isRef"]),se=e=>T(e)?e:null==e?"":p(e)||E(e)&&(e.toString===A||!b(e.toString))?re(e)?se(e.value):JSON.stringify(e,ae,2):String(e),ae=(e,t)=>re(t)?ae(e,t.value):g(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,n],i)=>(e[oe(t,i)+" =>"]=n,e)),{})}:m(t)?{[`Set(${t.size})`]:[...t.values()].map((e=>oe(e)))}:S(t)?oe(t):!E(t)||p(t)||k(t)?t:String(t),oe=(e,t="")=>{var n;return S(e)?`Symbol(${null!=(n=e.description)?n:t})`:e}},4270:function(e,t,n){"use strict";var i=n(9565),r=n(4901),s=n(34),a=TypeError;e.exports=function(e,t){var n,o;if("string"===t&&r(n=e.toString)&&!s(o=i(n,e)))return o;if(r(n=e.valueOf)&&!s(o=i(n,e)))return o;if("string"!==t&&r(n=e.toString)&&!s(o=i(n,e)))return o;throw new a("Can't convert object to primitive value")}},4373:function(e,t,n){"use strict";n.d(t,{A:function(){return yn}});var i={};n.r(i),n.d(i,{hasBrowserEnv:function(){return Ue},hasStandardBrowserEnv:function(){return Be},hasStandardBrowserWebWorkerEnv:function(){return je},navigator:function(){return Fe},origin:function(){return $e}});n(4114),n(8111),n(7588),n(9848);function r(e,t){return function(){return e.apply(t,arguments)}}const{toString:s}=Object.prototype,{getPrototypeOf:a}=Object,{iterator:o,toStringTag:u}=Symbol,l=(e=>t=>{const n=s.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),c=e=>(e=e.toLowerCase(),t=>l(t)===e),d=e=>t=>typeof t===e,{isArray:h}=Array,f=d("undefined");function p(e){return null!==e&&!f(e)&&null!==e.constructor&&!f(e.constructor)&&y(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const g=c("ArrayBuffer");function m(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&g(e.buffer),t}const v=d("string"),y=d("function"),b=d("number"),T=e=>null!==e&&"object"===typeof e,S=e=>!0===e||!1===e,E=e=>{if("object"!==l(e))return!1;const t=a(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(u in e)&&!(o in e)},w=c("Date"),A=c("File"),x=c("Blob"),I=c("FileList"),k=e=>T(e)&&y(e.pipe),L=e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||y(e.append)&&("formdata"===(t=l(e))||"object"===t&&y(e.toString)&&"[object FormData]"===e.toString()))},R=c("URLSearchParams"),[C,D,M,P]=["ReadableStream","Request","Response","Headers"].map(c),_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function O(e,t,{allOwnKeys:n=!1}={}){if(null===e||"undefined"===typeof e)return;let i,r;if("object"!==typeof e&&(e=[e]),h(e))for(i=0,r=e.length;i<r;i++)t.call(null,e[i],i,e);else{const r=n?Object.getOwnPropertyNames(e):Object.keys(e),s=r.length;let a;for(i=0;i<s;i++)a=r[i],t.call(null,e[a],a,e)}}function N(e,t){t=t.toLowerCase();const n=Object.keys(e);let i,r=n.length;while(r-- >0)if(i=n[r],t===i.toLowerCase())return i;return null}const U=(()=>"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global)(),F=e=>!f(e)&&e!==U;function B(){const{caseless:e}=F(this)&&this||{},t={},n=(n,i)=>{const r=e&&N(t,i)||i;E(t[r])&&E(n)?t[r]=B(t[r],n):E(n)?t[r]=B({},n):h(n)?t[r]=n.slice():t[r]=n};for(let i=0,r=arguments.length;i<r;i++)arguments[i]&&O(arguments[i],n);return t}const j=(e,t,n,{allOwnKeys:i}={})=>(O(t,((t,i)=>{n&&y(t)?e[i]=r(t,n):e[i]=t}),{allOwnKeys:i}),e),$=e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),G=(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},V=(e,t,n,i)=>{let r,s,o;const u={};if(t=t||{},null==e)return t;do{r=Object.getOwnPropertyNames(e),s=r.length;while(s-- >0)o=r[s],i&&!i(o,e,t)||u[o]||(t[o]=e[o],u[o]=!0);e=!1!==n&&a(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},H=(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return-1!==i&&i===n},K=e=>{if(!e)return null;if(h(e))return e;let t=e.length;if(!b(t))return null;const n=new Array(t);while(t-- >0)n[t]=e[t];return n},W=(e=>t=>e&&t instanceof e)("undefined"!==typeof Uint8Array&&a(Uint8Array)),q=(e,t)=>{const n=e&&e[o],i=n.call(e);let r;while((r=i.next())&&!r.done){const n=r.value;t.call(e,n[0],n[1])}},Y=(e,t)=>{let n;const i=[];while(null!==(n=e.exec(t)))i.push(n);return i},X=c("HTMLFormElement"),z=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),Q=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),J=c("RegExp"),Z=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};O(n,((n,r)=>{let s;!1!==(s=t(n,r,e))&&(i[r]=s||n)})),Object.defineProperties(e,i)},ee=e=>{Z(e,((t,n)=>{if(y(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=e[n];y(i)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},te=(e,t)=>{const n={},i=e=>{e.forEach((e=>{n[e]=!0}))};return h(e)?i(e):i(String(e).split(t)),n},ne=()=>{},ie=(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t;function re(e){return!!(e&&y(e.append)&&"FormData"===e[u]&&e[o])}const se=e=>{const t=new Array(10),n=(e,i)=>{if(T(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[i]=e;const r=h(e)?[]:{};return O(e,((e,t)=>{const s=n(e,i+1);!f(s)&&(r[t]=s)})),t[i]=void 0,r}}return e};return n(e,0)},ae=c("AsyncFunction"),oe=e=>e&&(T(e)||y(e))&&y(e.then)&&y(e.catch),ue=((e,t)=>e?setImmediate:t?((e,t)=>(U.addEventListener("message",(({source:n,data:i})=>{n===U&&i===e&&t.length&&t.shift()()}),!1),n=>{t.push(n),U.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))("function"===typeof setImmediate,y(U.postMessage)),le="undefined"!==typeof queueMicrotask?queueMicrotask.bind(U):"undefined"!==typeof process&&process.nextTick||ue,ce=e=>null!=e&&y(e[o]);var de={isArray:h,isArrayBuffer:g,isBuffer:p,isFormData:L,isArrayBufferView:m,isString:v,isNumber:b,isBoolean:S,isObject:T,isPlainObject:E,isReadableStream:C,isRequest:D,isResponse:M,isHeaders:P,isUndefined:f,isDate:w,isFile:A,isBlob:x,isRegExp:J,isFunction:y,isStream:k,isURLSearchParams:R,isTypedArray:W,isFileList:I,forEach:O,merge:B,extend:j,trim:_,stripBOM:$,inherits:G,toFlatObject:V,kindOf:l,kindOfTest:c,endsWith:H,toArray:K,forEachEntry:q,matchAll:Y,isHTMLForm:X,hasOwnProperty:Q,hasOwnProp:Q,reduceDescriptors:Z,freezeMethods:ee,toObjectSet:te,toCamelCase:z,noop:ne,toFiniteNumber:ie,findKey:N,global:U,isContextDefined:F,isSpecCompliantForm:re,toJSONObject:se,isAsyncFn:ae,isThenable:oe,setImmediate:ue,asap:le,isIterable:ce};n(1701),n(3579),n(1806);function he(e,t,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}de.inherits(he,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:de.toJSONObject(this.config),code:this.code,status:this.status}}});const fe=he.prototype,pe={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{pe[e]={value:e}})),Object.defineProperties(he,pe),Object.defineProperty(fe,"isAxiosError",{value:!0}),he.from=(e,t,n,i,r,s)=>{const a=Object.create(fe);return de.toFlatObject(e,a,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),he.call(a,e.message,t,n,i,r),a.cause=e,a.name=e.name,s&&Object.assign(a,s),a};var ge=he,me=null;function ve(e){return de.isPlainObject(e)||de.isArray(e)}function ye(e){return de.endsWith(e,"[]")?e.slice(0,-2):e}function be(e,t,n){return e?e.concat(t).map((function(e,t){return e=ye(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}function Te(e){return de.isArray(e)&&!e.some(ve)}const Se=de.toFlatObject(de,{},null,(function(e){return/^is[A-Z]/.test(e)}));function Ee(e,t,n){if(!de.isObject(e))throw new TypeError("target must be an object");t=t||new(me||FormData),n=de.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!de.isUndefined(t[e])}));const i=n.metaTokens,r=n.visitor||c,s=n.dots,a=n.indexes,o=n.Blob||"undefined"!==typeof Blob&&Blob,u=o&&de.isSpecCompliantForm(t);if(!de.isFunction(r))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(de.isDate(e))return e.toISOString();if(!u&&de.isBlob(e))throw new ge("Blob is not supported. Use a Buffer instead.");return de.isArrayBuffer(e)||de.isTypedArray(e)?u&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,r){let o=e;if(e&&!r&&"object"===typeof e)if(de.endsWith(n,"{}"))n=i?n:n.slice(0,-2),e=JSON.stringify(e);else if(de.isArray(e)&&Te(e)||(de.isFileList(e)||de.endsWith(n,"[]"))&&(o=de.toArray(e)))return n=ye(n),o.forEach((function(e,i){!de.isUndefined(e)&&null!==e&&t.append(!0===a?be([n],i,s):null===a?n:n+"[]",l(e))})),!1;return!!ve(e)||(t.append(be(r,n,s),l(e)),!1)}const d=[],h=Object.assign(Se,{defaultVisitor:c,convertValue:l,isVisitable:ve});function f(e,n){if(!de.isUndefined(e)){if(-1!==d.indexOf(e))throw Error("Circular reference detected in "+n.join("."));d.push(e),de.forEach(e,(function(e,i){const s=!(de.isUndefined(e)||null===e)&&r.call(t,e,de.isString(i)?i.trim():i,n,h);!0===s&&f(e,n?n.concat(i):[i])})),d.pop()}}if(!de.isObject(e))throw new TypeError("data must be an object");return f(e),t}var we=Ee;function Ae(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function xe(e,t){this._pairs=[],e&&we(e,this,t)}const Ie=xe.prototype;Ie.append=function(e,t){this._pairs.push([e,t])},Ie.toString=function(e){const t=e?function(t){return e.call(this,t,Ae)}:Ae;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};var ke=xe;function Le(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Re(e,t,n){if(!t)return e;const i=n&&n.encode||Le;de.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let s;if(s=r?r(t,n):de.isURLSearchParams(t)?t.toString():new ke(t,n).toString(i),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}class Ce{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){de.forEach(this.handlers,(function(t){null!==t&&e(t)}))}}var De=Ce,Me={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Pe="undefined"!==typeof URLSearchParams?URLSearchParams:ke,_e="undefined"!==typeof FormData?FormData:null,Oe="undefined"!==typeof Blob?Blob:null,Ne={isBrowser:!0,classes:{URLSearchParams:Pe,FormData:_e,Blob:Oe},protocols:["http","https","file","blob","url","data"]};const Ue="undefined"!==typeof window&&"undefined"!==typeof document,Fe="object"===typeof navigator&&navigator||void 0,Be=Ue&&(!Fe||["ReactNative","NativeScript","NS"].indexOf(Fe.product)<0),je=(()=>"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts)(),$e=Ue&&window.location.href||"http://localhost";var Ge={...i,...Ne};function Ve(e,t){return we(e,new Ge.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,i){return Ge.isNode&&de.isBuffer(e)?(this.append(t,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function He(e){return de.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}function Ke(e){const t={},n=Object.keys(e);let i;const r=n.length;let s;for(i=0;i<r;i++)s=n[i],t[s]=e[s];return t}function We(e){function t(e,n,i,r){let s=e[r++];if("__proto__"===s)return!0;const a=Number.isFinite(+s),o=r>=e.length;if(s=!s&&de.isArray(i)?i.length:s,o)return de.hasOwnProp(i,s)?i[s]=[i[s],n]:i[s]=n,!a;i[s]&&de.isObject(i[s])||(i[s]=[]);const u=t(e,n,i[s],r);return u&&de.isArray(i[s])&&(i[s]=Ke(i[s])),!a}if(de.isFormData(e)&&de.isFunction(e.entries)){const n={};return de.forEachEntry(e,((e,i)=>{t(He(e),i,n,0)})),n}return null}var qe=We;function Ye(e,t,n){if(de.isString(e))try{return(t||JSON.parse)(e),de.trim(e)}catch(i){if("SyntaxError"!==i.name)throw i}return(n||JSON.stringify)(e)}const Xe={transitional:Me,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,r=de.isObject(e);r&&de.isHTMLForm(e)&&(e=new FormData(e));const s=de.isFormData(e);if(s)return i?JSON.stringify(qe(e)):e;if(de.isArrayBuffer(e)||de.isBuffer(e)||de.isStream(e)||de.isFile(e)||de.isBlob(e)||de.isReadableStream(e))return e;if(de.isArrayBufferView(e))return e.buffer;if(de.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Ve(e,this.formSerializer).toString();if((a=de.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return we(a?{"files[]":e}:e,t&&new t,this.formSerializer)}}return r||i?(t.setContentType("application/json",!1),Ye(e)):e}],transformResponse:[function(e){const t=this.transitional||Xe.transitional,n=t&&t.forcedJSONParsing,i="json"===this.responseType;if(de.isResponse(e)||de.isReadableStream(e))return e;if(e&&de.isString(e)&&(n&&!this.responseType||i)){const n=t&&t.silentJSONParsing,s=!n&&i;try{return JSON.parse(e)}catch(r){if(s){if("SyntaxError"===r.name)throw ge.from(r,ge.ERR_BAD_RESPONSE,this,null,this.response);throw r}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ge.classes.FormData,Blob:Ge.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};de.forEach(["delete","get","head","post","put","patch"],(e=>{Xe.headers[e]={}}));var ze=Xe;const Qe=de.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);var Je=e=>{const t={};let n,i,r;return e&&e.split("\n").forEach((function(e){r=e.indexOf(":"),n=e.substring(0,r).trim().toLowerCase(),i=e.substring(r+1).trim(),!n||t[n]&&Qe[n]||("set-cookie"===n?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)})),t};const Ze=Symbol("internals");function et(e){return e&&String(e).trim().toLowerCase()}function tt(e){return!1===e||null==e?e:de.isArray(e)?e.map(tt):String(e)}function nt(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;while(i=n.exec(e))t[i[1]]=i[2];return t}const it=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function rt(e,t,n,i,r){return de.isFunction(i)?i.call(this,t,n):(r&&(t=n),de.isString(t)?de.isString(i)?-1!==t.indexOf(i):de.isRegExp(i)?i.test(t):void 0:void 0)}function st(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}function at(e,t){const n=de.toCamelCase(" "+t);["get","set","has"].forEach((i=>{Object.defineProperty(e,i+n,{value:function(e,n,r){return this[i].call(this,t,e,n,r)},configurable:!0})}))}class ot{constructor(e){e&&this.set(e)}set(e,t,n){const i=this;function r(e,t,n){const r=et(t);if(!r)throw new Error("header name must be a non-empty string");const s=de.findKey(i,r);(!s||void 0===i[s]||!0===n||void 0===n&&!1!==i[s])&&(i[s||t]=tt(e))}const s=(e,t)=>de.forEach(e,((e,n)=>r(e,n,t)));if(de.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(de.isString(e)&&(e=e.trim())&&!it(e))s(Je(e),t);else if(de.isObject(e)&&de.isIterable(e)){let n,i,r={};for(const t of e){if(!de.isArray(t))throw TypeError("Object iterator must return a key-value pair");r[i=t[0]]=(n=r[i])?de.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}s(r,t)}else null!=e&&r(t,e,n);return this}get(e,t){if(e=et(e),e){const n=de.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return nt(e);if(de.isFunction(t))return t.call(this,e,n);if(de.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=et(e),e){const n=de.findKey(this,e);return!(!n||void 0===this[n]||t&&!rt(this,this[n],n,t))}return!1}delete(e,t){const n=this;let i=!1;function r(e){if(e=et(e),e){const r=de.findKey(n,e);!r||t&&!rt(n,n[r],r,t)||(delete n[r],i=!0)}}return de.isArray(e)?e.forEach(r):r(e),i}clear(e){const t=Object.keys(this);let n=t.length,i=!1;while(n--){const r=t[n];e&&!rt(this,this[r],r,e,!0)||(delete this[r],i=!0)}return i}normalize(e){const t=this,n={};return de.forEach(this,((i,r)=>{const s=de.findKey(n,r);if(s)return t[s]=tt(i),void delete t[r];const a=e?st(r):String(r).trim();a!==r&&delete t[r],t[a]=tt(i),n[a]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return de.forEach(this,((n,i)=>{null!=n&&!1!==n&&(t[i]=e&&de.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=this[Ze]=this[Ze]={accessors:{}},n=t.accessors,i=this.prototype;function r(e){const t=et(e);n[t]||(at(i,e),n[t]=!0)}return de.isArray(e)?e.forEach(r):r(e),this}}ot.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),de.reduceDescriptors(ot.prototype,(({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}})),de.freezeMethods(ot);var ut=ot;function lt(e,t){const n=this||ze,i=t||n,r=ut.from(i.headers);let s=i.data;return de.forEach(e,(function(e){s=e.call(n,s,r.normalize(),t?t.status:void 0)})),r.normalize(),s}function ct(e){return!(!e||!e.__CANCEL__)}function dt(e,t,n){ge.call(this,null==e?"canceled":e,ge.ERR_CANCELED,t,n),this.name="CanceledError"}de.inherits(dt,ge,{__CANCEL__:!0});var ht=dt;function ft(e,t,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(new ge("Request failed with status code "+n.status,[ge.ERR_BAD_REQUEST,ge.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}function pt(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function gt(e,t){e=e||10;const n=new Array(e),i=new Array(e);let r,s=0,a=0;return t=void 0!==t?t:1e3,function(o){const u=Date.now(),l=i[a];r||(r=u),n[s]=o,i[s]=u;let c=a,d=0;while(c!==s)d+=n[c++],c%=e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),u-r<t)return;const h=l&&u-l;return h?Math.round(1e3*d/h):void 0}}var mt=gt;function vt(e,t){let n,i,r=0,s=1e3/t;const a=(t,s=Date.now())=>{r=s,n=null,i&&(clearTimeout(i),i=null),e.apply(null,t)},o=(...e)=>{const t=Date.now(),o=t-r;o>=s?a(e,t):(n=e,i||(i=setTimeout((()=>{i=null,a(n)}),s-o)))},u=()=>n&&a(n);return[o,u]}var yt=vt;const bt=(e,t,n=3)=>{let i=0;const r=mt(50,250);return yt((n=>{const s=n.loaded,a=n.lengthComputable?n.total:void 0,o=s-i,u=r(o),l=s<=a;i=s;const c={loaded:s,total:a,progress:a?s/a:void 0,bytes:o,rate:u||void 0,estimated:u&&a&&l?(a-s)/u:void 0,event:n,lengthComputable:null!=a,[t?"download":"upload"]:!0};e(c)}),n)},Tt=(e,t)=>{const n=null!=e;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},St=e=>(...t)=>de.asap((()=>e(...t)));n(2489),n(4979);var Et=Ge.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Ge.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Ge.origin),Ge.navigator&&/(msie|trident)/i.test(Ge.navigator.userAgent)):()=>!0,wt=Ge.hasStandardBrowserEnv?{write(e,t,n,i,r,s){const a=[e+"="+encodeURIComponent(t)];de.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),de.isString(i)&&a.push("path="+i),de.isString(r)&&a.push("domain="+r),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function At(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function xt(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function It(e,t,n){let i=!At(t);return e&&(i||0==n)?xt(e,t):t}const kt=e=>e instanceof ut?{...e}:e;function Lt(e,t){t=t||{};const n={};function i(e,t,n,i){return de.isPlainObject(e)&&de.isPlainObject(t)?de.merge.call({caseless:i},e,t):de.isPlainObject(t)?de.merge({},t):de.isArray(t)?t.slice():t}function r(e,t,n,r){return de.isUndefined(t)?de.isUndefined(e)?void 0:i(void 0,e,n,r):i(e,t,n,r)}function s(e,t){if(!de.isUndefined(t))return i(void 0,t)}function a(e,t){return de.isUndefined(t)?de.isUndefined(e)?void 0:i(void 0,e):i(void 0,t)}function o(n,r,s){return s in t?i(n,r):s in e?i(void 0,n):void 0}const u={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(e,t,n)=>r(kt(e),kt(t),n,!0)};return de.forEach(Object.keys(Object.assign({},e,t)),(function(i){const s=u[i]||r,a=s(e[i],t[i],i);de.isUndefined(a)&&s!==o||(n[i]=a)})),n}var Rt=e=>{const t=Lt({},e);let n,{data:i,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:a,headers:o,auth:u}=t;if(t.headers=o=ut.from(o),t.url=Re(It(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),de.isFormData(i))if(Ge.hasStandardBrowserEnv||Ge.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(!1!==(n=o.getContentType())){const[e,...t]=n?n.split(";").map((e=>e.trim())).filter(Boolean):[];o.setContentType([e||"multipart/form-data",...t].join("; "))}if(Ge.hasStandardBrowserEnv&&(r&&de.isFunction(r)&&(r=r(t)),r||!1!==r&&Et(t.url))){const e=s&&a&&wt.read(a);e&&o.set(s,e)}return t};const Ct="undefined"!==typeof XMLHttpRequest;var Dt=Ct&&function(e){return new Promise((function(t,n){const i=Rt(e);let r=i.data;const s=ut.from(i.headers).normalize();let a,o,u,l,c,{responseType:d,onUploadProgress:h,onDownloadProgress:f}=i;function p(){l&&l(),c&&c(),i.cancelToken&&i.cancelToken.unsubscribe(a),i.signal&&i.signal.removeEventListener("abort",a)}let g=new XMLHttpRequest;function m(){if(!g)return;const i=ut.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),r=d&&"text"!==d&&"json"!==d?g.response:g.responseText,s={data:r,status:g.status,statusText:g.statusText,headers:i,config:e,request:g};ft((function(e){t(e),p()}),(function(e){n(e),p()}),s),g=null}g.open(i.method.toUpperCase(),i.url,!0),g.timeout=i.timeout,"onloadend"in g?g.onloadend=m:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(m)},g.onabort=function(){g&&(n(new ge("Request aborted",ge.ECONNABORTED,e,g)),g=null)},g.onerror=function(){n(new ge("Network Error",ge.ERR_NETWORK,e,g)),g=null},g.ontimeout=function(){let t=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const r=i.transitional||Me;i.timeoutErrorMessage&&(t=i.timeoutErrorMessage),n(new ge(t,r.clarifyTimeoutError?ge.ETIMEDOUT:ge.ECONNABORTED,e,g)),g=null},void 0===r&&s.setContentType(null),"setRequestHeader"in g&&de.forEach(s.toJSON(),(function(e,t){g.setRequestHeader(t,e)})),de.isUndefined(i.withCredentials)||(g.withCredentials=!!i.withCredentials),d&&"json"!==d&&(g.responseType=i.responseType),f&&([u,c]=bt(f,!0),g.addEventListener("progress",u)),h&&g.upload&&([o,l]=bt(h),g.upload.addEventListener("progress",o),g.upload.addEventListener("loadend",l)),(i.cancelToken||i.signal)&&(a=t=>{g&&(n(!t||t.type?new ht(null,e,g):t),g.abort(),g=null)},i.cancelToken&&i.cancelToken.subscribe(a),i.signal&&(i.signal.aborted?a():i.signal.addEventListener("abort",a)));const v=pt(i.url);v&&-1===Ge.protocols.indexOf(v)?n(new ge("Unsupported protocol "+v+":",ge.ERR_BAD_REQUEST,e)):g.send(r||null)}))};const Mt=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,i=new AbortController;const r=function(e){if(!n){n=!0,a();const t=e instanceof Error?e:this.reason;i.abort(t instanceof ge?t:new ht(t instanceof Error?t.message:t))}};let s=t&&setTimeout((()=>{s=null,r(new ge(`timeout ${t} of ms exceeded`,ge.ETIMEDOUT))}),t);const a=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(r):e.removeEventListener("abort",r)})),e=null)};e.forEach((e=>e.addEventListener("abort",r)));const{signal:o}=i;return o.unsubscribe=()=>de.asap(a),o}};var Pt=Mt;const _t=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let i,r=0;while(r<n)i=r+t,yield e.slice(r,i),r=i},Ot=async function*(e,t){for await(const n of Nt(e))yield*_t(n,t)},Nt=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}},Ut=(e,t,n,i)=>{const r=Ot(e,t);let s,a=0,o=e=>{s||(s=!0,i&&i(e))};return new ReadableStream({async pull(e){try{const{done:t,value:i}=await r.next();if(t)return o(),void e.close();let s=i.byteLength;if(n){let e=a+=s;n(e)}e.enqueue(new Uint8Array(i))}catch(t){throw o(t),t}},cancel(e){return o(e),r.return()}},{highWaterMark:2})},Ft="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,Bt=Ft&&"function"===typeof ReadableStream,jt=Ft&&("function"===typeof TextEncoder?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),$t=(e,...t)=>{try{return!!e(...t)}catch(n){return!1}},Gt=Bt&&$t((()=>{let e=!1;const t=new Request(Ge.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),Vt=65536,Ht=Bt&&$t((()=>de.isReadableStream(new Response("").body))),Kt={stream:Ht&&(e=>e.body)};Ft&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach((t=>{!Kt[t]&&(Kt[t]=de.isFunction(e[t])?e=>e[t]():(e,n)=>{throw new ge(`Response type '${t}' is not supported`,ge.ERR_NOT_SUPPORT,n)})}))})(new Response);const Wt=async e=>{if(null==e)return 0;if(de.isBlob(e))return e.size;if(de.isSpecCompliantForm(e)){const t=new Request(Ge.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return de.isArrayBufferView(e)||de.isArrayBuffer(e)?e.byteLength:(de.isURLSearchParams(e)&&(e+=""),de.isString(e)?(await jt(e)).byteLength:void 0)},qt=async(e,t)=>{const n=de.toFiniteNumber(e.getContentLength());return null==n?Wt(t):n};var Yt=Ft&&(async e=>{let{url:t,method:n,data:i,signal:r,cancelToken:s,timeout:a,onDownloadProgress:o,onUploadProgress:u,responseType:l,headers:c,withCredentials:d="same-origin",fetchOptions:h}=Rt(e);l=l?(l+"").toLowerCase():"text";let f,p=Pt([r,s&&s.toAbortSignal()],a);const g=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let m;try{if(u&&Gt&&"get"!==n&&"head"!==n&&0!==(m=await qt(c,i))){let e,n=new Request(t,{method:"POST",body:i,duplex:"half"});if(de.isFormData(i)&&(e=n.headers.get("content-type"))&&c.setContentType(e),n.body){const[e,t]=Tt(m,bt(St(u)));i=Ut(n.body,Vt,e,t)}}de.isString(d)||(d=d?"include":"omit");const r="credentials"in Request.prototype;f=new Request(t,{...h,signal:p,method:n.toUpperCase(),headers:c.normalize().toJSON(),body:i,duplex:"half",credentials:r?d:void 0});let s=await fetch(f);const a=Ht&&("stream"===l||"response"===l);if(Ht&&(o||a&&g)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=s[t]}));const t=de.toFiniteNumber(s.headers.get("content-length")),[n,i]=o&&Tt(t,bt(St(o),!0))||[];s=new Response(Ut(s.body,Vt,n,(()=>{i&&i(),g&&g()})),e)}l=l||"text";let v=await Kt[de.findKey(Kt,l)||"text"](s,e);return!a&&g&&g(),await new Promise(((t,n)=>{ft(t,n,{data:v,headers:ut.from(s.headers),status:s.status,statusText:s.statusText,config:e,request:f})}))}catch(v){if(g&&g(),v&&"TypeError"===v.name&&/Load failed|fetch/i.test(v.message))throw Object.assign(new ge("Network Error",ge.ERR_NETWORK,e,f),{cause:v.cause||v});throw ge.from(v,v&&v.code,e,f)}});const Xt={http:me,xhr:Dt,fetch:Yt};de.forEach(Xt,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(n){}Object.defineProperty(e,"adapterName",{value:t})}}));const zt=e=>`- ${e}`,Qt=e=>de.isFunction(e)||null===e||!1===e;var Jt={getAdapter:e=>{e=de.isArray(e)?e:[e];const{length:t}=e;let n,i;const r={};for(let s=0;s<t;s++){let t;if(n=e[s],i=n,!Qt(n)&&(i=Xt[(t=String(n)).toLowerCase()],void 0===i))throw new ge(`Unknown adapter '${t}'`);if(i)break;r[t||"#"+s]=i}if(!i){const e=Object.entries(r).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));let n=t?e.length>1?"since :\n"+e.map(zt).join("\n"):" "+zt(e[0]):"as no adapter specified";throw new ge("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return i},adapters:Xt};function Zt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ht(null,e)}function en(e){Zt(e),e.headers=ut.from(e.headers),e.data=lt.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);const t=Jt.getAdapter(e.adapter||ze.adapter);return t(e).then((function(t){return Zt(e),t.data=lt.call(e,e.transformResponse,t),t.headers=ut.from(t.headers),t}),(function(t){return ct(t)||(Zt(e),t&&t.response&&(t.response.data=lt.call(e,e.transformResponse,t.response),t.response.headers=ut.from(t.response.headers))),Promise.reject(t)}))}const tn="1.9.0",nn={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{nn[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const rn={};function sn(e,t,n){if("object"!==typeof e)throw new ge("options must be an object",ge.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let r=i.length;while(r-- >0){const s=i[r],a=t[s];if(a){const t=e[s],n=void 0===t||a(t,s,e);if(!0!==n)throw new ge("option "+s+" must be "+n,ge.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new ge("Unknown option "+s,ge.ERR_BAD_OPTION)}}nn.transitional=function(e,t,n){function i(e,t){return"[Axios v"+tn+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,r,s)=>{if(!1===e)throw new ge(i(r," has been removed"+(t?" in "+t:"")),ge.ERR_DEPRECATED);return t&&!rn[r]&&(rn[r]=!0,console.warn(i(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,s)}},nn.spelling=function(e){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};var an={assertOptions:sn,validators:nn};const on=an.validators;class un{constructor(e){this.defaults=e||{},this.interceptors={request:new De,response:new De}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(i){}}throw n}}_request(e,t){"string"===typeof e?(t=t||{},t.url=e):t=e||{},t=Lt(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:r}=t;void 0!==n&&an.assertOptions(n,{silentJSONParsing:on.transitional(on.boolean),forcedJSONParsing:on.transitional(on.boolean),clarifyTimeoutError:on.transitional(on.boolean)},!1),null!=i&&(de.isFunction(i)?t.paramsSerializer={serialize:i}:an.assertOptions(i,{encode:on.function,serialize:on.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),an.assertOptions(t,{baseUrl:on.spelling("baseURL"),withXsrfToken:on.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=r&&de.merge(r.common,r[t.method]);r&&de.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete r[e]})),t.headers=ut.concat(s,r);const a=[];let o=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,a.unshift(e.fulfilled,e.rejected))}));const u=[];let l;this.interceptors.response.forEach((function(e){u.push(e.fulfilled,e.rejected)}));let c,d=0;if(!o){const e=[en.bind(this),void 0];e.unshift.apply(e,a),e.push.apply(e,u),c=e.length,l=Promise.resolve(t);while(d<c)l=l.then(e[d++],e[d++]);return l}c=a.length;let h=t;d=0;while(d<c){const e=a[d++],t=a[d++];try{h=e(h)}catch(f){t.call(this,f);break}}try{l=en.call(this,h)}catch(f){return Promise.reject(f)}d=0,c=u.length;while(d<c)l=l.then(u[d++],u[d++]);return l}getUri(e){e=Lt(this.defaults,e);const t=It(e.baseURL,e.url,e.allowAbsoluteUrls);return Re(t,e.params,e.paramsSerializer)}}de.forEach(["delete","get","head","options"],(function(e){un.prototype[e]=function(t,n){return this.request(Lt(n||{},{method:e,url:t,data:(n||{}).data}))}})),de.forEach(["post","put","patch"],(function(e){function t(t){return function(n,i,r){return this.request(Lt(r||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}un.prototype[e]=t(),un.prototype[e+"Form"]=t(!0)}));var ln=un;class cn{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;while(t-- >0)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const i=new Promise((e=>{n.subscribe(e),t=e})).then(e);return i.cancel=function(){n.unsubscribe(t)},i},e((function(e,i,r){n.reason||(n.reason=new ht(e,i,r),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;const t=new cn((function(t){e=t}));return{token:t,cancel:e}}}var dn=cn;function hn(e){return function(t){return e.apply(null,t)}}function fn(e){return de.isObject(e)&&!0===e.isAxiosError}const pn={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(pn).forEach((([e,t])=>{pn[t]=e}));var gn=pn;function mn(e){const t=new ln(e),n=r(ln.prototype.request,t);return de.extend(n,ln.prototype,t,{allOwnKeys:!0}),de.extend(n,t,null,{allOwnKeys:!0}),n.create=function(t){return mn(Lt(e,t))},n}const vn=mn(ze);vn.Axios=ln,vn.CanceledError=ht,vn.CancelToken=dn,vn.isCancel=ct,vn.VERSION=tn,vn.toFormData=we,vn.AxiosError=ge,vn.Cancel=vn.CanceledError,vn.all=function(e){return Promise.all(e)},vn.spread=hn,vn.isAxiosError=fn,vn.mergeConfig=Lt,vn.AxiosHeaders=ut,vn.formToJSON=e=>qe(de.isHTMLForm(e)?new FormData(e):e),vn.getAdapter=Jt.getAdapter,vn.HttpStatusCode=gn,vn.default=vn;var yn=vn},4376:function(e,t,n){"use strict";var i=n(2195);e.exports=Array.isArray||function(e){return"Array"===i(e)}},4402:function(e,t,n){"use strict";var i=n(9504),r=Set.prototype;e.exports={Set:Set,add:i(r.add),has:i(r.has),remove:i(r["delete"]),proto:r}},4449:function(e,t,n){"use strict";var i=n(7080),r=n(4402).has,s=n(5170),a=n(3789),o=n(8469),u=n(507),l=n(9539);e.exports=function(e){var t=i(this),n=a(e);if(s(t)<=n.size)return!1!==o(t,(function(e){if(n.includes(e))return!1}),!0);var c=n.getIterator();return!1!==u(c,(function(e){if(r(t,e))return l(c,"normal",!1)}))}},4495:function(e,t,n){"use strict";var i=n(9519),r=n(9039),s=n(4576),a=s.String;e.exports=!!Object.getOwnPropertySymbols&&!r((function(){var e=Symbol("symbol detection");return!a(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},4527:function(e,t,n){"use strict";var i=n(3724),r=n(4376),s=TypeError,a=Object.getOwnPropertyDescriptor,o=i&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=o?function(e,t){if(r(e)&&!a(e,"length").writable)throw new s("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},4549:function(e,t,n){"use strict";var i=n(4576);e.exports=function(e,t){var n=i.Iterator,r=n&&n.prototype,s=r&&r[e],a=!1;if(s)try{s.call({next:function(){return{done:!0}},return:function(){a=!0}},-1)}catch(o){o instanceof t||(a=!1)}if(!a)return s}},4576:function(e,t,n){"use strict";var i=function(e){return e&&e.Math===Math&&e};e.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof n.g&&n.g)||i("object"==typeof this&&this)||function(){return this}()||Function("return this")()},4659:function(e,t,n){"use strict";var i=n(3724),r=n(4913),s=n(6980);e.exports=function(e,t,n){i?r.f(e,t,s(0,n)):e[t]=n}},4901:function(e){"use strict";var t="object"==typeof document&&document.all;e.exports="undefined"==typeof t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},4913:function(e,t,n){"use strict";var i=n(3724),r=n(5917),s=n(8686),a=n(8551),o=n(6969),u=TypeError,l=Object.defineProperty,c=Object.getOwnPropertyDescriptor,d="enumerable",h="configurable",f="writable";t.f=i?s?function(e,t,n){if(a(e),t=o(t),a(n),"function"===typeof e&&"prototype"===t&&"value"in n&&f in n&&!n[f]){var i=c(e,t);i&&i[f]&&(e[t]=n.value,n={configurable:h in n?n[h]:i[h],enumerable:d in n?n[d]:i[d],writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(a(e),t=o(t),a(n),r)try{return l(e,t,n)}catch(i){}if("get"in n||"set"in n)throw new u("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},4916:function(e,t,n){"use strict";var i=n(7751),r=function(e){return{size:e,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},s=function(e){return{size:e,has:function(){return!0},keys:function(){throw new Error("e")}}};e.exports=function(e,t){var n=i("Set");try{(new n)[e](r(0));try{return(new n)[e](r(-1)),!1}catch(o){if(!t)return!0;try{return(new n)[e](s(-1/0)),!1}catch(u){var a=new n;return a.add(1),a.add(2),t(a[e](s(1/0)))}}}catch(u){return!1}}},4979:function(e,t,n){"use strict";var i=n(6518),r=n(4576),s=n(7751),a=n(6980),o=n(4913).f,u=n(9297),l=n(679),c=n(3167),d=n(2603),h=n(5002),f=n(8574),p=n(3724),g=n(6395),m="DOMException",v=s("Error"),y=s(m),b=function(){l(this,T);var e=arguments.length,t=d(e<1?void 0:arguments[0]),n=d(e<2?void 0:arguments[1],"Error"),i=new y(t,n),r=new v(t);return r.name=m,o(i,"stack",a(1,f(r.stack,1))),c(i,this,b),i},T=b.prototype=y.prototype,S="stack"in new v(m),E="stack"in new y(1,2),w=y&&p&&Object.getOwnPropertyDescriptor(r,m),A=!!w&&!(w.writable&&w.configurable),x=S&&!A&&!E;i({global:!0,constructor:!0,forced:g||x},{DOMException:x?b:y});var I=s(m),k=I.prototype;if(k.constructor!==I)for(var L in g||o(k,"constructor",a(1,I)),h)if(u(h,L)){var R=h[L],C=R.s;u(I,C)||o(I,C,a(6,R.c))}},5002:function(e){"use strict";e.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},5024:function(e,t,n){"use strict";var i=n(6518),r=n(3650),s=n(4916);i({target:"Set",proto:!0,real:!0,forced:!s("symmetricDifference")},{symmetricDifference:r})},5031:function(e,t,n){"use strict";var i=n(7751),r=n(9504),s=n(8480),a=n(3717),o=n(8551),u=r([].concat);e.exports=i("Reflect","ownKeys")||function(e){var t=s.f(o(e)),n=a.f;return n?u(t,n(e)):t}},5130:function(e,t,n){"use strict";n.d(t,{D$:function(){return we},Ef:function(){return ke},Jo:function(){return pe},aG:function(){return U},eB:function(){return b},lH:function(){return ge},u1:function(){return ve}});n(4114),n(8111),n(2489),n(7588),n(1701),n(3579),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698);var i=n(6768),r=n(4232);n(144);
/**
* @vue/runtime-dom v3.5.14
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/
let s;const a="undefined"!==typeof window&&window.trustedTypes;if(a)try{s=a.createPolicy("vue",{createHTML:e=>e})}catch(Ce){}const o=s?e=>s.createHTML(e):e=>e,u="http://www.w3.org/2000/svg",l="http://www.w3.org/1998/Math/MathML",c="undefined"!==typeof document?document:null,d=c&&c.createElement("template"),h={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const r="svg"===t?c.createElementNS(u,e):"mathml"===t?c.createElementNS(l,e):n?c.createElement(e,{is:n}):c.createElement(e);return"select"===e&&i&&null!=i.multiple&&r.setAttribute("multiple",i.multiple),r},createText:e=>c.createTextNode(e),createComment:e=>c.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>c.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,i,r,s){const a=n?n.previousSibling:t.lastChild;if(r&&(r===s||r.nextSibling)){while(1)if(t.insertBefore(r.cloneNode(!0),n),r===s||!(r=r.nextSibling))break}else{d.innerHTML=o("svg"===i?`<svg>${e}</svg>`:"mathml"===i?`<math>${e}</math>`:e);const r=d.content;if("svg"===i||"mathml"===i){const e=r.firstChild;while(e.firstChild)r.appendChild(e.firstChild);r.removeChild(e)}t.insertBefore(r,n)}return[a?a.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},f="transition",p="animation",g=Symbol("_vtc"),m={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},v=(0,r.X$)({},i.QP,m),y=e=>(e.displayName="Transition",e.props=v,e),b=y(((e,{slots:t})=>(0,i.h)(i.pR,E(e),t))),T=(e,t=[])=>{(0,r.cy)(e)?e.forEach((e=>e(...t))):e&&e(...t)},S=e=>!!e&&((0,r.cy)(e)?e.some((e=>e.length>1)):e.length>1);function E(e){const t={};for(const r in e)r in m||(t[r]=e[r]);if(!1===e.css)return t;const{name:n="v",type:i,duration:s,enterFromClass:a=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:u=`${n}-enter-to`,appearFromClass:l=a,appearActiveClass:c=o,appearToClass:d=u,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:f=`${n}-leave-active`,leaveToClass:p=`${n}-leave-to`}=e,g=w(s),v=g&&g[0],y=g&&g[1],{onBeforeEnter:b,onEnter:E,onEnterCancelled:A,onLeave:L,onLeaveCancelled:C,onBeforeAppear:D=b,onAppear:M=E,onAppearCancelled:_=A}=t,O=(e,t,n,i)=>{e._enterCancelled=i,I(e,t?d:u),I(e,t?c:o),n&&n()},N=(e,t)=>{e._isLeaving=!1,I(e,h),I(e,p),I(e,f),t&&t()},U=e=>(t,n)=>{const r=e?M:E,s=()=>O(t,e,n);T(r,[t,s]),k((()=>{I(t,e?l:a),x(t,e?d:u),S(r)||R(t,i,v,s)}))};return(0,r.X$)(t,{onBeforeEnter(e){T(b,[e]),x(e,a),x(e,o)},onBeforeAppear(e){T(D,[e]),x(e,l),x(e,c)},onEnter:U(!1),onAppear:U(!0),onLeave(e,t){e._isLeaving=!0;const n=()=>N(e,t);x(e,h),e._enterCancelled?(x(e,f),P()):(P(),x(e,f)),k((()=>{e._isLeaving&&(I(e,h),x(e,p),S(L)||R(e,i,y,n))})),T(L,[e,n])},onEnterCancelled(e){O(e,!1,void 0,!0),T(A,[e])},onAppearCancelled(e){O(e,!0,void 0,!0),T(_,[e])},onLeaveCancelled(e){N(e),T(C,[e])}})}function w(e){if(null==e)return null;if((0,r.Gv)(e))return[A(e.enter),A(e.leave)];{const t=A(e);return[t,t]}}function A(e){const t=(0,r.Ro)(e);return t}function x(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.add(t))),(e[g]||(e[g]=new Set)).add(t)}function I(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.remove(t)));const n=e[g];n&&(n.delete(t),n.size||(e[g]=void 0))}function k(e){requestAnimationFrame((()=>{requestAnimationFrame(e)}))}let L=0;function R(e,t,n,i){const r=e._endId=++L,s=()=>{r===e._endId&&i()};if(null!=n)return setTimeout(s,n);const{type:a,timeout:o,propCount:u}=C(e,t);if(!a)return i();const l=a+"end";let c=0;const d=()=>{e.removeEventListener(l,h),s()},h=t=>{t.target===e&&++c>=u&&d()};setTimeout((()=>{c<u&&d()}),o+1),e.addEventListener(l,h)}function C(e,t){const n=window.getComputedStyle(e),i=e=>(n[e]||"").split(", "),r=i(`${f}Delay`),s=i(`${f}Duration`),a=D(r,s),o=i(`${p}Delay`),u=i(`${p}Duration`),l=D(o,u);let c=null,d=0,h=0;t===f?a>0&&(c=f,d=a,h=s.length):t===p?l>0&&(c=p,d=l,h=u.length):(d=Math.max(a,l),c=d>0?a>l?f:p:null,h=c?c===f?s.length:u.length:0);const g=c===f&&/\b(transform|all)(,|$)/.test(i(`${f}Property`).toString());return{type:c,timeout:d,propCount:h,hasTransform:g}}function D(e,t){while(e.length<t.length)e=e.concat(e);return Math.max(...t.map(((t,n)=>M(t)+M(e[n]))))}function M(e){return"auto"===e?0:1e3*Number(e.slice(0,-1).replace(",","."))}function P(){return document.body.offsetHeight}function _(e,t,n){const i=e[g];i&&(t=(t?[t,...i]:[...i]).join(" ")),null==t?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const O=Symbol("_vod"),N=Symbol("_vsh"),U={beforeMount(e,{value:t},{transition:n}){e[O]="none"===e.style.display?"":e.style.display,n&&t?n.beforeEnter(e):F(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:i}){!t!==!n&&(i?t?(i.beforeEnter(e),F(e,!0),i.enter(e)):i.leave(e,(()=>{F(e,!1)})):F(e,t))},beforeUnmount(e,{value:t}){F(e,t)}};function F(e,t){e.style.display=t?e[O]:"none",e[N]=!t}const B=Symbol("");const j=/(^|;)\s*display\s*:/;function $(e,t,n){const i=e.style,s=(0,r.Kg)(n);let a=!1;if(n&&!s){if(t)if((0,r.Kg)(t))for(const e of t.split(";")){const t=e.slice(0,e.indexOf(":")).trim();null==n[t]&&V(i,t,"")}else for(const e in t)null==n[e]&&V(i,e,"");for(const e in n)"display"===e&&(a=!0),V(i,e,n[e])}else if(s){if(t!==n){const e=i[B];e&&(n+=";"+e),i.cssText=n,a=j.test(n)}}else t&&e.removeAttribute("style");O in e&&(e[O]=a?i.display:"",e[N]&&(i.display="none"))}const G=/\s*!important$/;function V(e,t,n){if((0,r.cy)(n))n.forEach((n=>V(e,t,n)));else if(null==n&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=W(e,t);G.test(n)?e.setProperty((0,r.Tg)(i),n.replace(G,""),"important"):e[i]=n}}const H=["Webkit","Moz","ms"],K={};function W(e,t){const n=K[t];if(n)return n;let i=(0,r.PT)(t);if("filter"!==i&&i in e)return K[t]=i;i=(0,r.ZH)(i);for(let r=0;r<H.length;r++){const n=H[r]+i;if(n in e)return K[t]=n}return t}const q="http://www.w3.org/1999/xlink";function Y(e,t,n,i,s,a=(0,r.J$)(t)){i&&t.startsWith("xlink:")?null==n?e.removeAttributeNS(q,t.slice(6,t.length)):e.setAttributeNS(q,t,n):null==n||a&&!(0,r.Y2)(n)?e.removeAttribute(t):e.setAttribute(t,a?"":(0,r.Bm)(n)?String(n):n)}function X(e,t,n,i,s){if("innerHTML"===t||"textContent"===t)return void(null!=n&&(e[t]="innerHTML"===t?o(n):n));const a=e.tagName;if("value"===t&&"PROGRESS"!==a&&!a.includes("-")){const i="OPTION"===a?e.getAttribute("value")||"":e.value,r=null==n?"checkbox"===e.type?"on":"":String(n);return i===r&&"_value"in e||(e.value=r),null==n&&e.removeAttribute(t),void(e._value=n)}let u=!1;if(""===n||null==n){const i=typeof e[t];"boolean"===i?n=(0,r.Y2)(n):null==n&&"string"===i?(n="",u=!0):"number"===i&&(n=0,u=!0)}try{e[t]=n}catch(Ce){0}u&&e.removeAttribute(s||t)}function z(e,t,n,i){e.addEventListener(t,n,i)}function Q(e,t,n,i){e.removeEventListener(t,n,i)}const J=Symbol("_vei");function Z(e,t,n,i,r=null){const s=e[J]||(e[J]={}),a=s[t];if(i&&a)a.value=i;else{const[n,o]=te(t);if(i){const a=s[t]=se(i,r);z(e,n,a,o)}else a&&(Q(e,n,a,o),s[t]=void 0)}}const ee=/(?:Once|Passive|Capture)$/;function te(e){let t;if(ee.test(e)){let n;t={};while(n=e.match(ee))e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}const n=":"===e[2]?e.slice(3):(0,r.Tg)(e.slice(2));return[n,t]}let ne=0;const ie=Promise.resolve(),re=()=>ne||(ie.then((()=>ne=0)),ne=Date.now());function se(e,t){const n=e=>{if(e._vts){if(e._vts<=n.attached)return}else e._vts=Date.now();(0,i.qL)(ae(e,n.value),t,5,[e])};return n.value=e,n.attached=re(),n}function ae(e,t){if((0,r.cy)(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}const oe=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,ue=(e,t,n,i,s,a)=>{const o="svg"===s;"class"===t?_(e,i,o):"style"===t?$(e,n,i):(0,r.Mp)(t)?(0,r.CP)(t)||Z(e,t,n,i,a):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):le(e,t,i,o))?(X(e,t,i),e.tagName.includes("-")||"value"!==t&&"checked"!==t&&"selected"!==t||Y(e,t,i,o,a,"value"!==t)):!e._isVueCE||!/[A-Z]/.test(t)&&(0,r.Kg)(i)?("true-value"===t?e._trueValue=i:"false-value"===t&&(e._falseValue=i),Y(e,t,i,o)):X(e,(0,r.PT)(t),i,a,t)};function le(e,t,n,i){if(i)return"innerHTML"===t||"textContent"===t||!!(t in e&&oe(t)&&(0,r.Tn)(n));if("spellcheck"===t||"draggable"===t||"translate"===t||"autocorrect"===t)return!1;if("form"===t)return!1;if("list"===t&&"INPUT"===e.tagName)return!1;if("type"===t&&"TEXTAREA"===e.tagName)return!1;if("width"===t||"height"===t){const t=e.tagName;if("IMG"===t||"VIDEO"===t||"CANVAS"===t||"SOURCE"===t)return!1}return(!oe(t)||!(0,r.Kg)(n))&&t in e}
/*! #__NO_SIDE_EFFECTS__ */
"undefined"!==typeof HTMLElement&&HTMLElement;Symbol("_moveCb"),Symbol("_enterCb");const ce=e=>{const t=e.props["onUpdate:modelValue"]||!1;return(0,r.cy)(t)?e=>(0,r.DY)(t,e):t};function de(e){e.target.composing=!0}function he(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const fe=Symbol("_assign"),pe={created(e,{modifiers:{lazy:t,trim:n,number:i}},s){e[fe]=ce(s);const a=i||s.props&&"number"===s.props.type;z(e,t?"change":"input",(t=>{if(t.target.composing)return;let i=e.value;n&&(i=i.trim()),a&&(i=(0,r.bB)(i)),e[fe](i)})),n&&z(e,"change",(()=>{e.value=e.value.trim()})),t||(z(e,"compositionstart",de),z(e,"compositionend",he),z(e,"change",he))},mounted(e,{value:t}){e.value=null==t?"":t},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:i,trim:s,number:a}},o){if(e[fe]=ce(o),e.composing)return;const u=!a&&"number"!==e.type||/^0\d/.test(e.value)?e.value:(0,r.bB)(e.value),l=null==t?"":t;if(u!==l){if(document.activeElement===e&&"range"!==e.type){if(i&&t===n)return;if(s&&e.value.trim()===l)return}e.value=l}}},ge={deep:!0,created(e,t,n){e[fe]=ce(n),z(e,"change",(()=>{const t=e._modelValue,n=be(e),i=e.checked,s=e[fe];if((0,r.cy)(t)){const e=(0,r.u3)(t,n),a=-1!==e;if(i&&!a)s(t.concat(n));else if(!i&&a){const n=[...t];n.splice(e,1),s(n)}}else if((0,r.vM)(t)){const e=new Set(t);i?e.add(n):e.delete(n),s(e)}else s(Te(e,i))}))},mounted:me,beforeUpdate(e,t,n){e[fe]=ce(n),me(e,t,n)}};function me(e,{value:t,oldValue:n},i){let s;if(e._modelValue=t,(0,r.cy)(t))s=(0,r.u3)(t,i.props.value)>-1;else if((0,r.vM)(t))s=t.has(i.props.value);else{if(t===n)return;s=(0,r.BX)(t,Te(e,!0))}e.checked!==s&&(e.checked=s)}const ve={deep:!0,created(e,{value:t,modifiers:{number:n}},s){const a=(0,r.vM)(t);z(e,"change",(()=>{const t=Array.prototype.filter.call(e.options,(e=>e.selected)).map((e=>n?(0,r.bB)(be(e)):be(e)));e[fe](e.multiple?a?new Set(t):t:t[0]),e._assigning=!0,(0,i.dY)((()=>{e._assigning=!1}))})),e[fe]=ce(s)},mounted(e,{value:t}){ye(e,t)},beforeUpdate(e,t,n){e[fe]=ce(n)},updated(e,{value:t}){e._assigning||ye(e,t)}};function ye(e,t){const n=e.multiple,i=(0,r.cy)(t);if(!n||i||(0,r.vM)(t)){for(let s=0,a=e.options.length;s<a;s++){const a=e.options[s],o=be(a);if(n)if(i){const e=typeof o;a.selected="string"===e||"number"===e?t.some((e=>String(e)===String(o))):(0,r.u3)(t,o)>-1}else a.selected=t.has(o);else if((0,r.BX)(be(a),t))return void(e.selectedIndex!==s&&(e.selectedIndex=s))}n||-1===e.selectedIndex||(e.selectedIndex=-1)}}function be(e){return"_value"in e?e._value:e.value}function Te(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const Se=["ctrl","shift","alt","meta"],Ee={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>Se.some((n=>e[`${n}Key`]&&!t.includes(n)))},we=(e,t)=>{const n=e._withMods||(e._withMods={}),i=t.join(".");return n[i]||(n[i]=(n,...i)=>{for(let e=0;e<t.length;e++){const i=Ee[t[e]];if(i&&i(n,t))return}return e(n,...i)})},Ae=(0,r.X$)({patchProp:ue},h);let xe;function Ie(){return xe||(xe=(0,i.K9)(Ae))}const ke=(...e)=>{const t=Ie().createApp(...e);const{mount:n}=t;return t.mount=e=>{const i=Re(e);if(!i)return;const s=t._component;(0,r.Tn)(s)||s.render||s.template||(s.template=i.innerHTML),1===i.nodeType&&(i.textContent="");const a=n(i,!1,Le(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),a},t};function Le(e){return e instanceof SVGElement?"svg":"function"===typeof MathMLElement&&e instanceof MathMLElement?"mathml":void 0}function Re(e){if((0,r.Kg)(e)){const t=document.querySelector(e);return t}return e}},5170:function(e,t,n){"use strict";var i=n(6706),r=n(4402);e.exports=i(r.proto,"size","get")||function(e){return e.size}},5397:function(e,t,n){"use strict";var i=n(7055),r=n(7750);e.exports=function(e){return i(r(e))}},5610:function(e,t,n){"use strict";var i=n(1291),r=Math.max,s=Math.min;e.exports=function(e,t){var n=i(e);return n<0?r(n+t,0):s(n,t)}},5745:function(e,t,n){"use strict";var i=n(7629);e.exports=function(e,t){return i[e]||(i[e]=t||{})}},5808:function(e,t,n){"use strict";n.d(t,{w:function(){return r}});var i=n(2436);function r(e,t){return"function"===typeof e?e(t):e&&"object"===typeof e&&i._P in e?e[i._P](t):e instanceof Date?new e.constructor(t):new Date(t)}},5876:function(e,t,n){"use strict";var i=n(6518),r=n(3838),s=n(4916),a=!s("isSubsetOf",(function(e){return e}));i({target:"Set",proto:!0,real:!0,forced:a},{isSubsetOf:r})},5917:function(e,t,n){"use strict";var i=n(3724),r=n(9039),s=n(4055);e.exports=!i&&!r((function(){return 7!==Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},5966:function(e,t,n){"use strict";var i=n(9306),r=n(4117);e.exports=function(e,t){var n=e[t];return r(n)?void 0:i(n)}},6080:function(e,t,n){"use strict";var i=n(7476),r=n(9306),s=n(616),a=i(i.bind);e.exports=function(e,t){return r(e),void 0===t?e:s?a(e,t):function(){return e.apply(t,arguments)}}},6119:function(e,t,n){"use strict";var i=n(5745),r=n(3392),s=i("keys");e.exports=function(e){return s[e]||(s[e]=r(e))}},6193:function(e,t,n){"use strict";var i=n(4215);e.exports="NODE"===i},6198:function(e,t,n){"use strict";var i=n(8014);e.exports=function(e){return i(e.length)}},6269:function(e){"use strict";e.exports={}},6279:function(e,t,n){"use strict";var i=n(6840);e.exports=function(e,t,n){for(var r in t)i(e,r,t[r],n);return e}},6319:function(e,t,n){"use strict";var i=n(8551),r=n(9539);e.exports=function(e,t,n,s){try{return s?t(i(n)[0],n[1]):t(n)}catch(a){r(e,"throw",a)}}},6368:function(e,t,n){"use strict";var i=n(6518),r=n(4576),s=n(9225).clear;i({global:!0,bind:!0,enumerable:!0,forced:r.clearImmediate!==s},{clearImmediate:s})},6395:function(e){"use strict";e.exports=!1},6518:function(e,t,n){"use strict";var i=n(4576),r=n(7347).f,s=n(6699),a=n(6840),o=n(9433),u=n(7740),l=n(2796);e.exports=function(e,t){var n,c,d,h,f,p,g=e.target,m=e.global,v=e.stat;if(c=m?i:v?i[g]||o(g,{}):i[g]&&i[g].prototype,c)for(d in t){if(f=t[d],e.dontCallGetSet?(p=r(c,d),h=p&&p.value):h=c[d],n=l(m?d:g+(v?".":"#")+d,e.forced),!n&&void 0!==h){if(typeof f==typeof h)continue;u(f,h)}(e.sham||h&&h.sham)&&s(f,"sham",!0),a(c,d,f,e)}}},6699:function(e,t,n){"use strict";var i=n(3724),r=n(4913),s=n(6980);e.exports=i?function(e,t,n){return r.f(e,t,s(1,n))}:function(e,t,n){return e[t]=n,e}},6706:function(e,t,n){"use strict";var i=n(9504),r=n(9306);e.exports=function(e,t,n){try{return i(r(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(s){}}},6768:function(e,t,n){"use strict";n.d(t,{$u:function(){return de},CE:function(){return en},Df:function(){return q},EW:function(){return Gn},FK:function(){return Vt},Fv:function(){return fn},Gt:function(){return Ye},Gy:function(){return O},K9:function(){return mt},Lk:function(){return on},MZ:function(){return W},OW:function(){return V},Q3:function(){return pn},QP:function(){return U},WQ:function(){return Xe},Wv:function(){return tn},bF:function(){return un},bo:function(){return R},dY:function(){return m},eW:function(){return hn},g2:function(){return be},h:function(){return Vn},hi:function(){return fe},k6:function(){return L},nI:function(){return An},pI:function(){return we},pM:function(){return Y},pR:function(){return $},qL:function(){return a},sV:function(){return le},uX:function(){return Xt},v6:function(){return yn},wB:function(){return kt}});n(4114),n(8111),n(1148),n(2489),n(7588),n(1701),n(8237),n(3579),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698);var i=n(144),r=n(4232);function s(e,t,n,i){try{return i?e(...i):e()}catch(r){o(r,t,n)}}function a(e,t,n,i){if((0,r.Tn)(e)){const a=s(e,t,n,i);return a&&(0,r.yL)(a)&&a.catch((e=>{o(e,t,n)})),a}if((0,r.cy)(e)){const r=[];for(let s=0;s<e.length;s++)r.push(a(e[s],t,n,i));return r}}function o(e,t,n,a=!0){const o=t?t.vnode:null,{errorHandler:l,throwUnhandledErrorInProduction:c}=t&&t.appContext.config||r.MZ;if(t){let r=t.parent;const a=t.proxy,o=`https://vuejs.org/error-reference/#runtime-${n}`;while(r){const t=r.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,a,o))return;r=r.parent}if(l)return(0,i.C4)(),s(l,null,10,[e,a,o]),void(0,i.bl)()}u(e,n,o,a,c)}function u(e,t,n,i=!0,r=!1){if(r)throw e;console.error(e)}const l=[];let c=-1;const d=[];let h=null,f=0;const p=Promise.resolve();let g=null;function m(e){const t=g||p;return e?t.then(this?e.bind(this):e):t}function v(e){let t=c+1,n=l.length;while(t<n){const i=t+n>>>1,r=l[i],s=w(r);s<e||s===e&&2&r.flags?t=i+1:n=i}return t}function y(e){if(!(1&e.flags)){const t=w(e),n=l[l.length-1];!n||!(2&e.flags)&&t>=w(n)?l.push(e):l.splice(v(t),0,e),e.flags|=1,b()}}function b(){g||(g=p.then(A))}function T(e){(0,r.cy)(e)?d.push(...e):h&&-1===e.id?h.splice(f+1,0,e):1&e.flags||(d.push(e),e.flags|=1),b()}function S(e,t,n=c+1){for(0;n<l.length;n++){const t=l[n];if(t&&2&t.flags){if(e&&t.id!==e.uid)continue;0,l.splice(n,1),n--,4&t.flags&&(t.flags&=-2),t(),4&t.flags||(t.flags&=-2)}}}function E(e){if(d.length){const e=[...new Set(d)].sort(((e,t)=>w(e)-w(t)));if(d.length=0,h)return void h.push(...e);for(h=e,f=0;f<h.length;f++){const e=h[f];0,4&e.flags&&(e.flags&=-2),8&e.flags||e(),e.flags&=-2}h=null,f=0}}const w=e=>null==e.id?2&e.flags?-1:1/0:e.id;function A(e){r.tE;try{for(c=0;c<l.length;c++){const e=l[c];!e||8&e.flags||(4&e.flags&&(e.flags&=-2),s(e,e.i,e.i?15:14),4&e.flags||(e.flags&=-2))}}finally{for(;c<l.length;c++){const e=l[c];e&&(e.flags&=-2)}c=-1,l.length=0,E(e),g=null,(l.length||d.length)&&A(e)}}let x=null,I=null;function k(e){const t=x;return x=e,I=e&&e.type.__scopeId||null,t}function L(e,t=x,n){if(!t)return e;if(e._n)return e;const i=(...n)=>{i._d&&Jt(-1);const r=k(t);let s;try{s=e(...n)}finally{k(r),i._d&&Jt(1)}return s};return i._n=!0,i._c=!0,i._d=!0,i}function R(e,t){if(null===x)return e;const n=Bn(x),s=e.dirs||(e.dirs=[]);for(let a=0;a<t.length;a++){let[e,o,u,l=r.MZ]=t[a];e&&((0,r.Tn)(e)&&(e={mounted:e,updated:e}),e.deep&&(0,i.hV)(o),s.push({dir:e,instance:n,value:o,oldValue:void 0,arg:u,modifiers:l}))}return e}function C(e,t,n,r){const s=e.dirs,o=t&&t.dirs;for(let u=0;u<s.length;u++){const l=s[u];o&&(l.oldValue=o[u].value);let c=l.dir[r];c&&((0,i.C4)(),a(c,n,8,[e.el,l,e,t]),(0,i.bl)())}}const D=Symbol("_vte"),M=e=>e.__isTeleport;const P=Symbol("_leaveCb"),_=Symbol("_enterCb");function O(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return le((()=>{e.isMounted=!0})),he((()=>{e.isUnmounting=!0})),e}const N=[Function,Array],U={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:N,onEnter:N,onAfterEnter:N,onEnterCancelled:N,onBeforeLeave:N,onLeave:N,onAfterLeave:N,onLeaveCancelled:N,onBeforeAppear:N,onAppear:N,onAfterAppear:N,onAppearCancelled:N},F=e=>{const t=e.subTree;return t.component?F(t.component):t},B={name:"BaseTransition",props:U,setup(e,{slots:t}){const n=An(),r=O();return()=>{const s=t.default&&q(t.default(),!0);if(!s||!s.length)return;const a=j(s),o=(0,i.ux)(e),{mode:u}=o;if(r.isLeaving)return H(a);const l=K(a);if(!l)return H(a);let c=V(l,o,r,n,(e=>c=e));l.type!==Kt&&W(l,c);let d=n.subTree&&K(n.subTree);if(d&&d.type!==Kt&&!rn(l,d)&&F(n).type!==Kt){let e=V(d,o,r,n);if(W(d,e),"out-in"===u&&l.type!==Kt)return r.isLeaving=!0,e.afterLeave=()=>{r.isLeaving=!1,8&n.job.flags||n.update(),delete e.afterLeave,d=void 0},H(a);"in-out"===u&&l.type!==Kt?e.delayLeave=(e,t,n)=>{const i=G(r,d);i[String(d.key)]=d,e[P]=()=>{t(),e[P]=void 0,delete c.delayedLeave,d=void 0},c.delayedLeave=()=>{n(),delete c.delayedLeave,d=void 0}}:d=void 0}else d&&(d=void 0);return a}}};function j(e){let t=e[0];if(e.length>1){let n=!1;for(const i of e)if(i.type!==Kt){0,t=i,n=!0;break}}return t}const $=B;function G(e,t){const{leavingVNodes:n}=e;let i=n.get(t.type);return i||(i=Object.create(null),n.set(t.type,i)),i}function V(e,t,n,i,s){const{appear:o,mode:u,persisted:l=!1,onBeforeEnter:c,onEnter:d,onAfterEnter:h,onEnterCancelled:f,onBeforeLeave:p,onLeave:g,onAfterLeave:m,onLeaveCancelled:v,onBeforeAppear:y,onAppear:b,onAfterAppear:T,onAppearCancelled:S}=t,E=String(e.key),w=G(n,e),A=(e,t)=>{e&&a(e,i,9,t)},x=(e,t)=>{const n=t[1];A(e,t),(0,r.cy)(e)?e.every((e=>e.length<=1))&&n():e.length<=1&&n()},I={mode:u,persisted:l,beforeEnter(t){let i=c;if(!n.isMounted){if(!o)return;i=y||c}t[P]&&t[P](!0);const r=w[E];r&&rn(e,r)&&r.el[P]&&r.el[P](),A(i,[t])},enter(e){let t=d,i=h,r=f;if(!n.isMounted){if(!o)return;t=b||d,i=T||h,r=S||f}let s=!1;const a=e[_]=t=>{s||(s=!0,A(t?r:i,[e]),I.delayedLeave&&I.delayedLeave(),e[_]=void 0)};t?x(t,[e,a]):a()},leave(t,i){const r=String(e.key);if(t[_]&&t[_](!0),n.isUnmounting)return i();A(p,[t]);let s=!1;const a=t[P]=n=>{s||(s=!0,i(),A(n?v:m,[t]),t[P]=void 0,w[r]===e&&delete w[r])};w[r]=e,g?x(g,[t,a]):a()},clone(e){const r=V(e,t,n,i,s);return s&&s(r),r}};return I}function H(e){if(J(e))return e=dn(e),e.children=null,e}function K(e){if(!J(e))return M(e.type)&&e.children?j(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:n}=e;if(n){if(16&t)return n[0];if(32&t&&(0,r.Tn)(n.default))return n.default()}}function W(e,t){6&e.shapeFlag&&e.component?(e.transition=t,W(e.component.subTree,t)):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function q(e,t=!1,n){let i=[],r=0;for(let s=0;s<e.length;s++){let a=e[s];const o=null==n?a.key:String(n)+String(null!=a.key?a.key:s);a.type===Vt?(128&a.patchFlag&&r++,i=i.concat(q(a.children,t,o))):(t||a.type!==Kt)&&i.push(null!=o?dn(a,{key:o}):a)}if(r>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}
/*! #__NO_SIDE_EFFECTS__ */function Y(e,t){return(0,r.Tn)(e)?(()=>(0,r.X$)({name:e.name},t,{setup:e}))():e}function X(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function z(e,t,n,a,o=!1){if((0,r.cy)(e))return void e.forEach(((e,i)=>z(e,t&&((0,r.cy)(t)?t[i]:t),n,a,o)));if(Q(a)&&!o)return void(512&a.shapeFlag&&a.type.__asyncResolved&&a.component.subTree.component&&z(e,t,n,a.component.subTree));const u=4&a.shapeFlag?Bn(a.component):a.el,l=o?null:u,{i:c,r:d}=e;const h=t&&t.r,f=c.refs===r.MZ?c.refs={}:c.refs,p=c.setupState,g=(0,i.ux)(p),m=p===r.MZ?()=>!1:e=>(0,r.$3)(g,e);if(null!=h&&h!==d&&((0,r.Kg)(h)?(f[h]=null,m(h)&&(p[h]=null)):(0,i.i9)(h)&&(h.value=null)),(0,r.Tn)(d))s(d,c,12,[l,f]);else{const t=(0,r.Kg)(d),s=(0,i.i9)(d);if(t||s){const i=()=>{if(e.f){const n=t?m(d)?p[d]:f[d]:d.value;o?(0,r.cy)(n)&&(0,r.TF)(n,u):(0,r.cy)(n)?n.includes(u)||n.push(u):t?(f[d]=[u],m(d)&&(p[d]=f[d])):(d.value=[u],e.k&&(f[e.k]=d.value))}else t?(f[d]=l,m(d)&&(p[d]=l)):s&&(d.value=l,e.k&&(f[e.k]=l))};l?(i.id=-1,gt(i,n)):i()}else 0}}(0,r.We)().requestIdleCallback,(0,r.We)().cancelIdleCallback;const Q=e=>!!e.type.__asyncLoader
/*! #__NO_SIDE_EFFECTS__ */;const J=e=>e.type.__isKeepAlive;RegExp,RegExp;function Z(e,t){return(0,r.cy)(e)?e.some((e=>Z(e,t))):(0,r.Kg)(e)?e.split(",").includes(t):!!(0,r.gd)(e)&&(e.lastIndex=0,e.test(t))}function ee(e,t){ne(e,"a",t)}function te(e,t){ne(e,"da",t)}function ne(e,t,n=wn){const i=e.__wdc||(e.__wdc=()=>{let t=n;while(t){if(t.isDeactivated)return;t=t.parent}return e()});if(ae(t,i,n),n){let e=n.parent;while(e&&e.parent)J(e.parent.vnode)&&ie(i,t,n,e),e=e.parent}}function ie(e,t,n,i){const s=ae(t,e,i,!0);fe((()=>{(0,r.TF)(i[t],s)}),n)}function re(e){e.shapeFlag&=-257,e.shapeFlag&=-513}function se(e){return 128&e.shapeFlag?e.ssContent:e}function ae(e,t,n=wn,r=!1){if(n){const s=n[e]||(n[e]=[]),o=t.__weh||(t.__weh=(...r)=>{(0,i.C4)();const s=kn(n),o=a(t,n,e,r);return s(),(0,i.bl)(),o});return r?s.unshift(o):s.push(o),o}}const oe=e=>(t,n=wn)=>{Mn&&"sp"!==e||ae(e,((...e)=>t(...e)),n)},ue=oe("bm"),le=oe("m"),ce=oe("bu"),de=oe("u"),he=oe("bum"),fe=oe("um"),pe=oe("sp"),ge=oe("rtg"),me=oe("rtc");function ve(e,t=wn){ae("ec",e,t)}const ye="components";function be(e,t){return Se(ye,e,!0,t)||e}const Te=Symbol.for("v-ndc");function Se(e,t,n=!0,i=!1){const s=x||wn;if(s){const n=s.type;if(e===ye){const e=jn(n,!1);if(e&&(e===t||e===(0,r.PT)(t)||e===(0,r.ZH)((0,r.PT)(t))))return n}const a=Ee(s[e]||n[e],t)||Ee(s.appContext[e],t);return!a&&i?n:a}}function Ee(e,t){return e&&(e[t]||e[(0,r.PT)(t)]||e[(0,r.ZH)((0,r.PT)(t))])}function we(e,t,n,s){let a;const o=n&&n[s],u=(0,r.cy)(e);if(u||(0,r.Kg)(e)){const n=u&&(0,i.g8)(e);let r=!1,s=!1;n&&(r=!(0,i.fE)(e),s=(0,i.Tm)(e),e=(0,i.qA)(e)),a=new Array(e.length);for(let u=0,l=e.length;u<l;u++)a[u]=t(r?s?(0,i.a1)((0,i.lJ)(e[u])):(0,i.lJ)(e[u]):e[u],u,void 0,o&&o[u])}else if("number"===typeof e){0,a=new Array(e);for(let n=0;n<e;n++)a[n]=t(n+1,n,void 0,o&&o[n])}else if((0,r.Gv)(e))if(e[Symbol.iterator])a=Array.from(e,((e,n)=>t(e,n,void 0,o&&o[n])));else{const n=Object.keys(e);a=new Array(n.length);for(let i=0,r=n.length;i<r;i++){const r=n[i];a[i]=t(e[r],r,i,o&&o[i])}}else a=[];return n&&(n[s]=a),a}const Ae=e=>e?Rn(e)?Bn(e):Ae(e.parent):null,xe=(0,r.X$)(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ae(e.parent),$root:e=>Ae(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>_e(e),$forceUpdate:e=>e.f||(e.f=()=>{y(e.update)}),$nextTick:e=>e.n||(e.n=m.bind(e.proxy)),$watch:e=>Rt.bind(e)}),Ie=(e,t)=>e!==r.MZ&&!e.__isScriptSetup&&(0,r.$3)(e,t),ke={get({_:e},t){if("__v_skip"===t)return!0;const{ctx:n,setupState:s,data:a,props:o,accessCache:u,type:l,appContext:c}=e;let d;if("$"!==t[0]){const i=u[t];if(void 0!==i)switch(i){case 1:return s[t];case 2:return a[t];case 4:return n[t];case 3:return o[t]}else{if(Ie(s,t))return u[t]=1,s[t];if(a!==r.MZ&&(0,r.$3)(a,t))return u[t]=2,a[t];if((d=e.propsOptions[0])&&(0,r.$3)(d,t))return u[t]=3,o[t];if(n!==r.MZ&&(0,r.$3)(n,t))return u[t]=4,n[t];Re&&(u[t]=0)}}const h=xe[t];let f,p;return h?("$attrs"===t&&(0,i.u4)(e.attrs,"get",""),h(e)):(f=l.__cssModules)&&(f=f[t])?f:n!==r.MZ&&(0,r.$3)(n,t)?(u[t]=4,n[t]):(p=c.config.globalProperties,(0,r.$3)(p,t)?p[t]:void 0)},set({_:e},t,n){const{data:i,setupState:s,ctx:a}=e;return Ie(s,t)?(s[t]=n,!0):i!==r.MZ&&(0,r.$3)(i,t)?(i[t]=n,!0):!(0,r.$3)(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(a[t]=n,!0))},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:s,propsOptions:a}},o){let u;return!!n[o]||e!==r.MZ&&(0,r.$3)(e,o)||Ie(t,o)||(u=a[0])&&(0,r.$3)(u,o)||(0,r.$3)(i,o)||(0,r.$3)(xe,o)||(0,r.$3)(s.config.globalProperties,o)},defineProperty(e,t,n){return null!=n.get?e._.accessCache[t]=0:(0,r.$3)(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function Le(e){return(0,r.cy)(e)?e.reduce(((e,t)=>(e[t]=null,e)),{}):e}let Re=!0;function Ce(e){const t=_e(e),n=e.proxy,s=e.ctx;Re=!1,t.beforeCreate&&Me(t.beforeCreate,e,"bc");const{data:a,computed:o,methods:u,watch:l,provide:c,inject:d,created:h,beforeMount:f,mounted:p,beforeUpdate:g,updated:m,activated:v,deactivated:y,beforeDestroy:b,beforeUnmount:T,destroyed:S,unmounted:E,render:w,renderTracked:A,renderTriggered:x,errorCaptured:I,serverPrefetch:k,expose:L,inheritAttrs:R,components:C,directives:D,filters:M}=t,P=null;if(d&&De(d,s,P),u)for(const i in u){const e=u[i];(0,r.Tn)(e)&&(s[i]=e.bind(n))}if(a){0;const t=a.call(n,n);0,(0,r.Gv)(t)&&(e.data=(0,i.Kh)(t))}if(Re=!0,o)for(const i in o){const e=o[i],t=(0,r.Tn)(e)?e.bind(n,n):(0,r.Tn)(e.get)?e.get.bind(n,n):r.tE;0;const a=!(0,r.Tn)(e)&&(0,r.Tn)(e.set)?e.set.bind(n):r.tE,u=Gn({get:t,set:a});Object.defineProperty(s,i,{enumerable:!0,configurable:!0,get:()=>u.value,set:e=>u.value=e})}if(l)for(const i in l)Pe(l[i],s,n,i);if(c){const e=(0,r.Tn)(c)?c.call(n):c;Reflect.ownKeys(e).forEach((t=>{Ye(t,e[t])}))}function _(e,t){(0,r.cy)(t)?t.forEach((t=>e(t.bind(n)))):t&&e(t.bind(n))}if(h&&Me(h,e,"c"),_(ue,f),_(le,p),_(ce,g),_(de,m),_(ee,v),_(te,y),_(ve,I),_(me,A),_(ge,x),_(he,T),_(fe,E),_(pe,k),(0,r.cy)(L))if(L.length){const t=e.exposed||(e.exposed={});L.forEach((e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t})}))}else e.exposed||(e.exposed={});w&&e.render===r.tE&&(e.render=w),null!=R&&(e.inheritAttrs=R),C&&(e.components=C),D&&(e.directives=D),k&&X(e)}function De(e,t,n=r.tE){(0,r.cy)(e)&&(e=Be(e));for(const s in e){const n=e[s];let a;a=(0,r.Gv)(n)?"default"in n?Xe(n.from||s,n.default,!0):Xe(n.from||s):Xe(n),(0,i.i9)(a)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>a.value,set:e=>a.value=e}):t[s]=a}}function Me(e,t,n){a((0,r.cy)(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,n)}function Pe(e,t,n,i){let s=i.includes(".")?Ct(n,i):()=>n[i];if((0,r.Kg)(e)){const n=t[e];(0,r.Tn)(n)&&kt(s,n)}else if((0,r.Tn)(e))kt(s,e.bind(n));else if((0,r.Gv)(e))if((0,r.cy)(e))e.forEach((e=>Pe(e,t,n,i)));else{const i=(0,r.Tn)(e.handler)?e.handler.bind(n):t[e.handler];(0,r.Tn)(i)&&kt(s,i,e)}else 0}function _e(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:s,optionsCache:a,config:{optionMergeStrategies:o}}=e.appContext,u=a.get(t);let l;return u?l=u:s.length||n||i?(l={},s.length&&s.forEach((e=>Oe(l,e,o,!0))),Oe(l,t,o)):l=t,(0,r.Gv)(t)&&a.set(t,l),l}function Oe(e,t,n,i=!1){const{mixins:r,extends:s}=t;s&&Oe(e,s,n,!0),r&&r.forEach((t=>Oe(e,t,n,!0)));for(const a in t)if(i&&"expose"===a);else{const i=Ne[a]||n&&n[a];e[a]=i?i(e[a],t[a]):t[a]}return e}const Ne={data:Ue,props:Ge,emits:Ge,methods:$e,computed:$e,beforeCreate:je,created:je,beforeMount:je,mounted:je,beforeUpdate:je,updated:je,beforeDestroy:je,beforeUnmount:je,destroyed:je,unmounted:je,activated:je,deactivated:je,errorCaptured:je,serverPrefetch:je,components:$e,directives:$e,watch:Ve,provide:Ue,inject:Fe};function Ue(e,t){return t?e?function(){return(0,r.X$)((0,r.Tn)(e)?e.call(this,this):e,(0,r.Tn)(t)?t.call(this,this):t)}:t:e}function Fe(e,t){return $e(Be(e),Be(t))}function Be(e){if((0,r.cy)(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function je(e,t){return e?[...new Set([].concat(e,t))]:t}function $e(e,t){return e?(0,r.X$)(Object.create(null),e,t):t}function Ge(e,t){return e?(0,r.cy)(e)&&(0,r.cy)(t)?[...new Set([...e,...t])]:(0,r.X$)(Object.create(null),Le(e),Le(null!=t?t:{})):t}function Ve(e,t){if(!e)return t;if(!t)return e;const n=(0,r.X$)(Object.create(null),e);for(const i in t)n[i]=je(e[i],t[i]);return n}function He(){return{app:null,config:{isNativeTag:r.NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ke=0;function We(e,t){return function(n,i=null){(0,r.Tn)(n)||(n=(0,r.X$)({},n)),null==i||(0,r.Gv)(i)||(i=null);const s=He(),o=new WeakSet,u=[];let l=!1;const c=s.app={_uid:Ke++,_component:n,_props:i,_container:null,_context:s,_instance:null,version:Hn,get config(){return s.config},set config(e){0},use(e,...t){return o.has(e)||(e&&(0,r.Tn)(e.install)?(o.add(e),e.install(c,...t)):(0,r.Tn)(e)&&(o.add(e),e(c,...t))),c},mixin(e){return s.mixins.includes(e)||s.mixins.push(e),c},component(e,t){return t?(s.components[e]=t,c):s.components[e]},directive(e,t){return t?(s.directives[e]=t,c):s.directives[e]},mount(r,a,o){if(!l){0;const u=c._ceVNode||un(n,i);return u.appContext=s,!0===o?o="svg":!1===o&&(o=void 0),a&&t?t(u,r):e(u,r,o),l=!0,c._container=r,r.__vue_app__=c,Bn(u.component)}},onUnmount(e){u.push(e)},unmount(){l&&(a(u,c._instance,16),e(null,c._container),delete c._container.__vue_app__)},provide(e,t){return s.provides[e]=t,c},runWithContext(e){const t=qe;qe=c;try{return e()}finally{qe=t}}};return c}}let qe=null;function Ye(e,t){if(wn){let n=wn.provides;const i=wn.parent&&wn.parent.provides;i===n&&(n=wn.provides=Object.create(i)),n[e]=t}else 0}function Xe(e,t,n=!1){const i=wn||x;if(i||qe){const s=qe?qe._context.provides:i?null==i.parent?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return n&&(0,r.Tn)(t)?t.call(i&&i.proxy):t}else 0}const ze={},Qe=()=>Object.create(ze),Je=e=>Object.getPrototypeOf(e)===ze;function Ze(e,t,n,r=!1){const s={},a=Qe();e.propsDefaults=Object.create(null),tt(e,t,s,a);for(const i in e.propsOptions[0])i in s||(s[i]=void 0);n?e.props=r?s:(0,i.Gc)(s):e.type.props?e.props=s:e.props=a,e.attrs=a}function et(e,t,n,s){const{props:a,attrs:o,vnode:{patchFlag:u}}=e,l=(0,i.ux)(a),[c]=e.propsOptions;let d=!1;if(!(s||u>0)||16&u){let i;tt(e,t,a,o)&&(d=!0);for(const s in l)t&&((0,r.$3)(t,s)||(i=(0,r.Tg)(s))!==s&&(0,r.$3)(t,i))||(c?!n||void 0===n[s]&&void 0===n[i]||(a[s]=nt(c,l,s,void 0,e,!0)):delete a[s]);if(o!==l)for(const e in o)t&&(0,r.$3)(t,e)||(delete o[e],d=!0)}else if(8&u){const n=e.vnode.dynamicProps;for(let i=0;i<n.length;i++){let s=n[i];if(_t(e.emitsOptions,s))continue;const u=t[s];if(c)if((0,r.$3)(o,s))u!==o[s]&&(o[s]=u,d=!0);else{const t=(0,r.PT)(s);a[t]=nt(c,l,t,u,e,!1)}else u!==o[s]&&(o[s]=u,d=!0)}}d&&(0,i.hZ)(e.attrs,"set","")}function tt(e,t,n,s){const[a,o]=e.propsOptions;let u,l=!1;if(t)for(let i in t){if((0,r.SU)(i))continue;const c=t[i];let d;a&&(0,r.$3)(a,d=(0,r.PT)(i))?o&&o.includes(d)?(u||(u={}))[d]=c:n[d]=c:_t(e.emitsOptions,i)||i in s&&c===s[i]||(s[i]=c,l=!0)}if(o){const t=(0,i.ux)(n),s=u||r.MZ;for(let i=0;i<o.length;i++){const u=o[i];n[u]=nt(a,t,u,s[u],e,!(0,r.$3)(s,u))}}return l}function nt(e,t,n,i,s,a){const o=e[n];if(null!=o){const e=(0,r.$3)(o,"default");if(e&&void 0===i){const e=o.default;if(o.type!==Function&&!o.skipFactory&&(0,r.Tn)(e)){const{propsDefaults:r}=s;if(n in r)i=r[n];else{const a=kn(s);i=r[n]=e.call(null,t),a()}}else i=e;s.ce&&s.ce._setProp(n,i)}o[0]&&(a&&!e?i=!1:!o[1]||""!==i&&i!==(0,r.Tg)(n)||(i=!0))}return i}const it=new WeakMap;function rt(e,t,n=!1){const i=n?it:t.propsCache,s=i.get(e);if(s)return s;const a=e.props,o={},u=[];let l=!1;if(!(0,r.Tn)(e)){const i=e=>{l=!0;const[n,i]=rt(e,t,!0);(0,r.X$)(o,n),i&&u.push(...i)};!n&&t.mixins.length&&t.mixins.forEach(i),e.extends&&i(e.extends),e.mixins&&e.mixins.forEach(i)}if(!a&&!l)return(0,r.Gv)(e)&&i.set(e,r.Oj),r.Oj;if((0,r.cy)(a))for(let d=0;d<a.length;d++){0;const e=(0,r.PT)(a[d]);st(e)&&(o[e]=r.MZ)}else if(a){0;for(const e in a){const t=(0,r.PT)(e);if(st(t)){const n=a[e],i=o[t]=(0,r.cy)(n)||(0,r.Tn)(n)?{type:n}:(0,r.X$)({},n),s=i.type;let l=!1,c=!0;if((0,r.cy)(s))for(let e=0;e<s.length;++e){const t=s[e],n=(0,r.Tn)(t)&&t.name;if("Boolean"===n){l=!0;break}"String"===n&&(c=!1)}else l=(0,r.Tn)(s)&&"Boolean"===s.name;i[0]=l,i[1]=c,(l||(0,r.$3)(i,"default"))&&u.push(t)}}}const c=[o,u];return(0,r.Gv)(e)&&i.set(e,c),c}function st(e){return"$"!==e[0]&&!(0,r.SU)(e)}const at=e=>"_"===e[0]||"$stable"===e,ot=e=>(0,r.cy)(e)?e.map(gn):[gn(e)],ut=(e,t,n)=>{if(t._n)return t;const i=L(((...e)=>ot(t(...e))),n);return i._c=!1,i},lt=(e,t,n)=>{const i=e._ctx;for(const s in e){if(at(s))continue;const n=e[s];if((0,r.Tn)(n))t[s]=ut(s,n,i);else if(null!=n){0;const e=ot(n);t[s]=()=>e}}},ct=(e,t)=>{const n=ot(t);e.slots.default=()=>n},dt=(e,t,n)=>{for(const i in t)!n&&at(i)||(e[i]=t[i])},ht=(e,t,n)=>{const i=e.slots=Qe();if(32&e.vnode.shapeFlag){const e=t._;e?(dt(i,t,n),n&&(0,r.yQ)(i,"_",e,!0)):lt(t,i)}else t&&ct(e,t)},ft=(e,t,n)=>{const{vnode:i,slots:s}=e;let a=!0,o=r.MZ;if(32&i.shapeFlag){const e=t._;e?n&&1===e?a=!1:dt(s,t,n):(a=!t.$stable,lt(t,s)),o=t}else t&&(ct(e,t),o={default:1});if(a)for(const r in s)at(r)||null!=o[r]||delete s[r]};function pt(){"boolean"!==typeof __VUE_PROD_HYDRATION_MISMATCH_DETAILS__&&((0,r.We)().__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!1)}const gt=Gt;function mt(e){return vt(e)}function vt(e,t){pt();const n=(0,r.We)();n.__VUE__=!0;const{insert:s,remove:a,patchProp:o,createElement:u,createText:l,createComment:c,setText:d,setElementText:h,parentNode:f,nextSibling:p,setScopeId:g=r.tE,insertStaticContent:m}=e,v=(e,t,n,i=null,r=null,s=null,a=void 0,o=null,u=!!t.dynamicChildren)=>{if(e===t)return;e&&!rn(e,t)&&(i=Z(e),K(e,r,s,!0),e=null),-2===t.patchFlag&&(u=!1,t.dynamicChildren=null);const{type:l,ref:c,shapeFlag:d}=t;switch(l){case Ht:b(e,t,n,i);break;case Kt:T(e,t,n,i);break;case Wt:null==e&&w(t,n,i,a);break;case Vt:O(e,t,n,i,r,s,a,o,u);break;default:1&d?I(e,t,n,i,r,s,a,o,u):6&d?N(e,t,n,i,r,s,a,o,u):(64&d||128&d)&&l.process(e,t,n,i,r,s,a,o,u,ne)}null!=c&&r&&z(c,e&&e.ref,s,t||e,!t)},b=(e,t,n,i)=>{if(null==e)s(t.el=l(t.children),n,i);else{const n=t.el=e.el;t.children!==e.children&&d(n,t.children)}},T=(e,t,n,i)=>{null==e?s(t.el=c(t.children||""),n,i):t.el=e.el},w=(e,t,n,i)=>{[e.el,e.anchor]=m(e.children,t,n,i,e.el,e.anchor)},A=({el:e,anchor:t},n,i)=>{let r;while(e&&e!==t)r=p(e),s(e,n,i),e=r;s(t,n,i)},x=({el:e,anchor:t})=>{let n;while(e&&e!==t)n=p(e),a(e),e=n;a(t)},I=(e,t,n,i,r,s,a,o,u)=>{"svg"===t.type?a="svg":"math"===t.type&&(a="mathml"),null==e?k(t,n,i,r,s,a,o,u):M(e,t,r,s,a,o,u)},k=(e,t,n,i,a,l,c,d)=>{let f,p;const{props:g,shapeFlag:m,transition:v,dirs:y}=e;if(f=e.el=u(e.type,l,g&&g.is,g),8&m?h(f,e.children):16&m&&R(e.children,f,null,i,a,yt(e,l),c,d),y&&C(e,null,i,"created"),L(f,e,e.scopeId,c,i),g){for(const e in g)"value"===e||(0,r.SU)(e)||o(f,e,null,g[e],l,i);"value"in g&&o(f,"value",null,g.value,l),(p=g.onVnodeBeforeMount)&&bn(p,i,e)}y&&C(e,null,i,"beforeMount");const b=Tt(a,v);b&&v.beforeEnter(f),s(f,t,n),((p=g&&g.onVnodeMounted)||b||y)&&gt((()=>{p&&bn(p,i,e),b&&v.enter(f),y&&C(e,null,i,"mounted")}),a)},L=(e,t,n,i,r)=>{if(n&&g(e,n),i)for(let s=0;s<i.length;s++)g(e,i[s]);if(r){let n=r.subTree;if(t===n||$t(n.type)&&(n.ssContent===t||n.ssFallback===t)){const t=r.vnode;L(e,t,t.scopeId,t.slotScopeIds,r.parent)}}},R=(e,t,n,i,r,s,a,o,u=0)=>{for(let l=u;l<e.length;l++){const u=e[l]=o?mn(e[l]):gn(e[l]);v(null,u,t,n,i,r,s,a,o)}},M=(e,t,n,i,s,a,u)=>{const l=t.el=e.el;let{patchFlag:c,dynamicChildren:d,dirs:f}=t;c|=16&e.patchFlag;const p=e.props||r.MZ,g=t.props||r.MZ;let m;if(n&&bt(n,!1),(m=g.onVnodeBeforeUpdate)&&bn(m,n,t,e),f&&C(t,e,n,"beforeUpdate"),n&&bt(n,!0),(p.innerHTML&&null==g.innerHTML||p.textContent&&null==g.textContent)&&h(l,""),d?P(e.dynamicChildren,d,l,n,i,yt(t,s),a):u||$(e,t,l,null,n,i,yt(t,s),a,!1),c>0){if(16&c)_(l,p,g,n,s);else if(2&c&&p.class!==g.class&&o(l,"class",null,g.class,s),4&c&&o(l,"style",p.style,g.style,s),8&c){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const i=e[t],r=p[i],a=g[i];a===r&&"value"!==i||o(l,i,r,a,s,n)}}1&c&&e.children!==t.children&&h(l,t.children)}else u||null!=d||_(l,p,g,n,s);((m=g.onVnodeUpdated)||f)&&gt((()=>{m&&bn(m,n,t,e),f&&C(t,e,n,"updated")}),i)},P=(e,t,n,i,r,s,a)=>{for(let o=0;o<t.length;o++){const u=e[o],l=t[o],c=u.el&&(u.type===Vt||!rn(u,l)||70&u.shapeFlag)?f(u.el):n;v(u,l,c,null,i,r,s,a,!0)}},_=(e,t,n,i,s)=>{if(t!==n){if(t!==r.MZ)for(const a in t)(0,r.SU)(a)||a in n||o(e,a,t[a],null,s,i);for(const a in n){if((0,r.SU)(a))continue;const u=n[a],l=t[a];u!==l&&"value"!==a&&o(e,a,l,u,s,i)}"value"in n&&o(e,"value",t.value,n.value,s)}},O=(e,t,n,i,r,a,o,u,c)=>{const d=t.el=e?e.el:l(""),h=t.anchor=e?e.anchor:l("");let{patchFlag:f,dynamicChildren:p,slotScopeIds:g}=t;g&&(u=u?u.concat(g):g),null==e?(s(d,n,i),s(h,n,i),R(t.children||[],n,h,r,a,o,u,c)):f>0&&64&f&&p&&e.dynamicChildren?(P(e.dynamicChildren,p,n,r,a,o,u),(null!=t.key||r&&t===r.subTree)&&St(e,t,!0)):$(e,t,n,h,r,a,o,u,c)},N=(e,t,n,i,r,s,a,o,u)=>{t.slotScopeIds=o,null==e?512&t.shapeFlag?r.ctx.activate(t,n,i,a,u):U(t,n,i,r,s,a,u):F(e,t,u)},U=(e,t,n,i,r,s,a)=>{const o=e.component=En(e,i,r);if(J(e)&&(o.ctx.renderer=ne),Pn(o,!1,a),o.asyncDep){if(r&&r.registerDep(o,B,a),!e.el){const e=o.subTree=un(Kt);T(null,e,t,n)}}else B(o,e,t,n,r,s,a)},F=(e,t,n)=>{const i=t.component=e.component;if(Ft(e,t,n)){if(i.asyncDep&&!i.asyncResolved)return void j(i,t,n);i.next=t,i.update()}else t.el=e.el,i.vnode=t},B=(e,t,n,s,a,o,u)=>{const l=()=>{if(e.isMounted){let{next:t,bu:n,u:i,parent:s,vnode:c}=e;{const n=wt(e);if(n)return t&&(t.el=c.el,j(e,t,u)),void n.asyncDep.then((()=>{e.isUnmounted||l()}))}let d,h=t;0,bt(e,!1),t?(t.el=c.el,j(e,t,u)):t=c,n&&(0,r.DY)(n),(d=t.props&&t.props.onVnodeBeforeUpdate)&&bn(d,s,t,c),bt(e,!0);const p=Ot(e);0;const g=e.subTree;e.subTree=p,v(g,p,f(g.el),Z(g),e,a,o),t.el=p.el,null===h&&jt(e,p.el),i&&gt(i,a),(d=t.props&&t.props.onVnodeUpdated)&&gt((()=>bn(d,s,t,c)),a)}else{let i;const{el:u,props:l}=t,{bm:c,m:d,parent:h,root:f,type:p}=e,g=Q(t);if(bt(e,!1),c&&(0,r.DY)(c),!g&&(i=l&&l.onVnodeBeforeMount)&&bn(i,h,t),bt(e,!0),u&&re){const t=()=>{e.subTree=Ot(e),re(u,e.subTree,e,a,null)};g&&p.__asyncHydrate?p.__asyncHydrate(u,e,t):t()}else{f.ce&&f.ce._injectChildStyle(p);const i=e.subTree=Ot(e);0,v(null,i,n,s,e,a,o),t.el=i.el}if(d&&gt(d,a),!g&&(i=l&&l.onVnodeMounted)){const e=t;gt((()=>bn(i,h,e)),a)}(256&t.shapeFlag||h&&Q(h.vnode)&&256&h.vnode.shapeFlag)&&e.a&&gt(e.a,a),e.isMounted=!0,t=n=s=null}};e.scope.on();const c=e.effect=new i.X2(l);e.scope.off();const d=e.update=c.run.bind(c),h=e.job=c.runIfDirty.bind(c);h.i=e,h.id=e.uid,c.scheduler=()=>y(h),bt(e,!0),d()},j=(e,t,n)=>{t.component=e;const r=e.vnode.props;e.vnode=t,e.next=null,et(e,t.props,r,n),ft(e,t.children,n),(0,i.C4)(),S(e),(0,i.bl)()},$=(e,t,n,i,r,s,a,o,u=!1)=>{const l=e&&e.children,c=e?e.shapeFlag:0,d=t.children,{patchFlag:f,shapeFlag:p}=t;if(f>0){if(128&f)return void V(l,d,n,i,r,s,a,o,u);if(256&f)return void G(l,d,n,i,r,s,a,o,u)}8&p?(16&c&&X(l,r,s),d!==l&&h(n,d)):16&c?16&p?V(l,d,n,i,r,s,a,o,u):X(l,r,s,!0):(8&c&&h(n,""),16&p&&R(d,n,i,r,s,a,o,u))},G=(e,t,n,i,s,a,o,u,l)=>{e=e||r.Oj,t=t||r.Oj;const c=e.length,d=t.length,h=Math.min(c,d);let f;for(f=0;f<h;f++){const i=t[f]=l?mn(t[f]):gn(t[f]);v(e[f],i,n,null,s,a,o,u,l)}c>d?X(e,s,a,!0,!1,h):R(t,n,i,s,a,o,u,l,h)},V=(e,t,n,i,s,a,o,u,l)=>{let c=0;const d=t.length;let h=e.length-1,f=d-1;while(c<=h&&c<=f){const i=e[c],r=t[c]=l?mn(t[c]):gn(t[c]);if(!rn(i,r))break;v(i,r,n,null,s,a,o,u,l),c++}while(c<=h&&c<=f){const i=e[h],r=t[f]=l?mn(t[f]):gn(t[f]);if(!rn(i,r))break;v(i,r,n,null,s,a,o,u,l),h--,f--}if(c>h){if(c<=f){const e=f+1,r=e<d?t[e].el:i;while(c<=f)v(null,t[c]=l?mn(t[c]):gn(t[c]),n,r,s,a,o,u,l),c++}}else if(c>f)while(c<=h)K(e[c],s,a,!0),c++;else{const p=c,g=c,m=new Map;for(c=g;c<=f;c++){const e=t[c]=l?mn(t[c]):gn(t[c]);null!=e.key&&m.set(e.key,c)}let y,b=0;const T=f-g+1;let S=!1,E=0;const w=new Array(T);for(c=0;c<T;c++)w[c]=0;for(c=p;c<=h;c++){const i=e[c];if(b>=T){K(i,s,a,!0);continue}let r;if(null!=i.key)r=m.get(i.key);else for(y=g;y<=f;y++)if(0===w[y-g]&&rn(i,t[y])){r=y;break}void 0===r?K(i,s,a,!0):(w[r-g]=c+1,r>=E?E=r:S=!0,v(i,t[r],n,null,s,a,o,u,l),b++)}const A=S?Et(w):r.Oj;for(y=A.length-1,c=T-1;c>=0;c--){const e=g+c,r=t[e],h=e+1<d?t[e+1].el:i;0===w[c]?v(null,r,n,h,s,a,o,u,l):S&&(y<0||c!==A[y]?H(r,n,h,2):y--)}}},H=(e,t,n,i,r=null)=>{const{el:o,type:u,transition:l,children:c,shapeFlag:d}=e;if(6&d)return void H(e.component.subTree,t,n,i);if(128&d)return void e.suspense.move(t,n,i);if(64&d)return void u.move(e,t,n,ne);if(u===Vt){s(o,t,n);for(let e=0;e<c.length;e++)H(c[e],t,n,i);return void s(e.anchor,t,n)}if(u===Wt)return void A(e,t,n);const h=2!==i&&1&d&&l;if(h)if(0===i)l.beforeEnter(o),s(o,t,n),gt((()=>l.enter(o)),r);else{const{leave:i,delayLeave:r,afterLeave:u}=l,c=()=>{e.ctx.isUnmounted?a(o):s(o,t,n)},d=()=>{i(o,(()=>{c(),u&&u()}))};r?r(o,c,d):d()}else s(o,t,n)},K=(e,t,n,r=!1,s=!1)=>{const{type:a,props:o,ref:u,children:l,dynamicChildren:c,shapeFlag:d,patchFlag:h,dirs:f,cacheIndex:p}=e;if(-2===h&&(s=!1),null!=u&&((0,i.C4)(),z(u,null,n,e,!0),(0,i.bl)()),null!=p&&(t.renderCache[p]=void 0),256&d)return void t.ctx.deactivate(e);const g=1&d&&f,m=!Q(e);let v;if(m&&(v=o&&o.onVnodeBeforeUnmount)&&bn(v,t,e),6&d)Y(e.component,n,r);else{if(128&d)return void e.suspense.unmount(n,r);g&&C(e,null,t,"beforeUnmount"),64&d?e.type.remove(e,t,n,ne,r):c&&!c.hasOnce&&(a!==Vt||h>0&&64&h)?X(c,t,n,!1,!0):(a===Vt&&384&h||!s&&16&d)&&X(l,t,n),r&&W(e)}(m&&(v=o&&o.onVnodeUnmounted)||g)&&gt((()=>{v&&bn(v,t,e),g&&C(e,null,t,"unmounted")}),n)},W=e=>{const{type:t,el:n,anchor:i,transition:r}=e;if(t===Vt)return void q(n,i);if(t===Wt)return void x(e);const s=()=>{a(n),r&&!r.persisted&&r.afterLeave&&r.afterLeave()};if(1&e.shapeFlag&&r&&!r.persisted){const{leave:t,delayLeave:i}=r,a=()=>t(n,s);i?i(e.el,s,a):a()}else s()},q=(e,t)=>{let n;while(e!==t)n=p(e),a(e),e=n;a(t)},Y=(e,t,n)=>{const{bum:i,scope:s,job:a,subTree:o,um:u,m:l,a:c,parent:d,slots:{__:h}}=e;At(l),At(c),i&&(0,r.DY)(i),d&&(0,r.cy)(h)&&h.forEach((e=>{d.renderCache[e]=void 0})),s.stop(),a&&(a.flags|=8,K(o,e,t,n)),u&&gt(u,t),gt((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},X=(e,t,n,i=!1,r=!1,s=0)=>{for(let a=s;a<e.length;a++)K(e[a],t,n,i,r)},Z=e=>{if(6&e.shapeFlag)return Z(e.component.subTree);if(128&e.shapeFlag)return e.suspense.next();const t=p(e.anchor||e.el),n=t&&t[D];return n?p(n):t};let ee=!1;const te=(e,t,n)=>{null==e?t._vnode&&K(t._vnode,null,null,!0):v(t._vnode||null,e,t,null,null,null,n),t._vnode=e,ee||(ee=!0,S(),E(),ee=!1)},ne={p:v,um:K,m:H,r:W,mt:U,mc:R,pc:$,pbc:P,n:Z,o:e};let ie,re;return t&&([ie,re]=t(ne)),{render:te,hydrate:ie,createApp:We(te,ie)}}function yt({type:e,props:t},n){return"svg"===n&&"foreignObject"===e||"mathml"===n&&"annotation-xml"===e&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function bt({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Tt(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function St(e,t,n=!1){const i=e.children,s=t.children;if((0,r.cy)(i)&&(0,r.cy)(s))for(let r=0;r<i.length;r++){const e=i[r];let t=s[r];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=s[r]=mn(s[r]),t.el=e.el),n||-2===t.patchFlag||St(e,t)),t.type===Ht&&(t.el=e.el),t.type!==Kt||t.el||(t.el=e.el)}}function Et(e){const t=e.slice(),n=[0];let i,r,s,a,o;const u=e.length;for(i=0;i<u;i++){const u=e[i];if(0!==u){if(r=n[n.length-1],e[r]<u){t[i]=r,n.push(i);continue}s=0,a=n.length-1;while(s<a)o=s+a>>1,e[n[o]]<u?s=o+1:a=o;u<e[n[s]]&&(s>0&&(t[i]=n[s-1]),n[s]=i)}}s=n.length,a=n[s-1];while(s-- >0)n[s]=a,a=t[a];return n}function wt(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:wt(t)}function At(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const xt=Symbol.for("v-scx"),It=()=>{{const e=Xe(xt);return e}};function kt(e,t,n){return Lt(e,t,n)}function Lt(e,t,n=r.MZ){const{immediate:s,deep:o,flush:u,once:l}=n;const c=(0,r.X$)({},n);const d=t&&s||!t&&"post"!==u;let h;if(Mn)if("sync"===u){const e=It();h=e.__watcherHandles||(e.__watcherHandles=[])}else if(!d){const e=()=>{};return e.stop=r.tE,e.resume=r.tE,e.pause=r.tE,e}const f=wn;c.call=(e,t,n)=>a(e,f,t,n);let p=!1;"post"===u?c.scheduler=e=>{gt(e,f&&f.suspense)}:"sync"!==u&&(p=!0,c.scheduler=(e,t)=>{t?e():y(e)}),c.augmentJob=e=>{t&&(e.flags|=4),p&&(e.flags|=2,f&&(e.id=f.uid,e.i=f))};const g=(0,i.wB)(e,t,c);return Mn&&(h?h.push(g):d&&g()),g}function Rt(e,t,n){const i=this.proxy,s=(0,r.Kg)(e)?e.includes(".")?Ct(i,e):()=>i[e]:e.bind(i,i);let a;(0,r.Tn)(t)?a=t:(a=t.handler,n=t);const o=kn(this),u=Lt(s,a.bind(i),n);return o(),u}function Ct(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}const Dt=(e,t)=>"modelValue"===t||"model-value"===t?e.modelModifiers:e[`${t}Modifiers`]||e[`${(0,r.PT)(t)}Modifiers`]||e[`${(0,r.Tg)(t)}Modifiers`];function Mt(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||r.MZ;let s=n;const o=t.startsWith("update:"),u=o&&Dt(i,t.slice(7));let l;u&&(u.trim&&(s=n.map((e=>(0,r.Kg)(e)?e.trim():e))),u.number&&(s=n.map(r.bB)));let c=i[l=(0,r.rU)(t)]||i[l=(0,r.rU)((0,r.PT)(t))];!c&&o&&(c=i[l=(0,r.rU)((0,r.Tg)(t))]),c&&a(c,e,6,s);const d=i[l+"Once"];if(d){if(e.emitted){if(e.emitted[l])return}else e.emitted={};e.emitted[l]=!0,a(d,e,6,s)}}function Pt(e,t,n=!1){const i=t.emitsCache,s=i.get(e);if(void 0!==s)return s;const a=e.emits;let o={},u=!1;if(!(0,r.Tn)(e)){const i=e=>{const n=Pt(e,t,!0);n&&(u=!0,(0,r.X$)(o,n))};!n&&t.mixins.length&&t.mixins.forEach(i),e.extends&&i(e.extends),e.mixins&&e.mixins.forEach(i)}return a||u?((0,r.cy)(a)?a.forEach((e=>o[e]=null)):(0,r.X$)(o,a),(0,r.Gv)(e)&&i.set(e,o),o):((0,r.Gv)(e)&&i.set(e,null),null)}function _t(e,t){return!(!e||!(0,r.Mp)(t))&&(t=t.slice(2).replace(/Once$/,""),(0,r.$3)(e,t[0].toLowerCase()+t.slice(1))||(0,r.$3)(e,(0,r.Tg)(t))||(0,r.$3)(e,t))}function Ot(e){const{type:t,vnode:n,proxy:i,withProxy:s,propsOptions:[a],slots:u,attrs:l,emit:c,render:d,renderCache:h,props:f,data:p,setupState:g,ctx:m,inheritAttrs:v}=e,y=k(e);let b,T;try{if(4&n.shapeFlag){const e=s||i,t=e;b=gn(d.call(t,e,h,f,g,p,m)),T=l}else{const e=t;0,b=gn(e.length>1?e(f,{attrs:l,slots:u,emit:c}):e(f,null)),T=t.props?l:Nt(l)}}catch(E){qt.length=0,o(E,e,1),b=un(Kt)}let S=b;if(T&&!1!==v){const e=Object.keys(T),{shapeFlag:t}=S;e.length&&7&t&&(a&&e.some(r.CP)&&(T=Ut(T,a)),S=dn(S,T,!1,!0))}return n.dirs&&(S=dn(S,null,!1,!0),S.dirs=S.dirs?S.dirs.concat(n.dirs):n.dirs),n.transition&&W(S,n.transition),b=S,k(y),b}const Nt=e=>{let t;for(const n in e)("class"===n||"style"===n||(0,r.Mp)(n))&&((t||(t={}))[n]=e[n]);return t},Ut=(e,t)=>{const n={};for(const i in e)(0,r.CP)(i)&&i.slice(9)in t||(n[i]=e[i]);return n};function Ft(e,t,n){const{props:i,children:r,component:s}=e,{props:a,children:o,patchFlag:u}=t,l=s.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&u>=0))return!(!r&&!o||o&&o.$stable)||i!==a&&(i?!a||Bt(i,a,l):!!a);if(1024&u)return!0;if(16&u)return i?Bt(i,a,l):!!a;if(8&u){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(a[n]!==i[n]&&!_t(l,n))return!0}}return!1}function Bt(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(t[s]!==e[s]&&!_t(n,s))return!0}return!1}function jt({vnode:e,parent:t},n){while(t){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i!==e)break;(e=t.vnode).el=n,t=t.parent}}const $t=e=>e.__isSuspense;function Gt(e,t){t&&t.pendingBranch?(0,r.cy)(e)?t.effects.push(...e):t.effects.push(e):T(e)}const Vt=Symbol.for("v-fgt"),Ht=Symbol.for("v-txt"),Kt=Symbol.for("v-cmt"),Wt=Symbol.for("v-stc"),qt=[];let Yt=null;function Xt(e=!1){qt.push(Yt=e?null:[])}function zt(){qt.pop(),Yt=qt[qt.length-1]||null}let Qt=1;function Jt(e,t=!1){Qt+=e,e<0&&Yt&&t&&(Yt.hasOnce=!0)}function Zt(e){return e.dynamicChildren=Qt>0?Yt||r.Oj:null,zt(),Qt>0&&Yt&&Yt.push(e),e}function en(e,t,n,i,r,s){return Zt(on(e,t,n,i,r,s,!0))}function tn(e,t,n,i,r){return Zt(un(e,t,n,i,r,!0))}function nn(e){return!!e&&!0===e.__v_isVNode}function rn(e,t){return e.type===t.type&&e.key===t.key}const sn=({key:e})=>null!=e?e:null,an=({ref:e,ref_key:t,ref_for:n})=>("number"===typeof e&&(e=""+e),null!=e?(0,r.Kg)(e)||(0,i.i9)(e)||(0,r.Tn)(e)?{i:x,r:e,k:t,f:!!n}:e:null);function on(e,t=null,n=null,i=0,s=null,a=(e===Vt?0:1),o=!1,u=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&sn(t),ref:t&&an(t),scopeId:I,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:x};return u?(vn(l,n),128&a&&e.normalize(l)):n&&(l.shapeFlag|=(0,r.Kg)(n)?8:16),Qt>0&&!o&&Yt&&(l.patchFlag>0||6&a)&&32!==l.patchFlag&&Yt.push(l),l}const un=ln;function ln(e,t=null,n=null,s=0,a=null,o=!1){if(e&&e!==Te||(e=Kt),nn(e)){const i=dn(e,t,!0);return n&&vn(i,n),Qt>0&&!o&&Yt&&(6&i.shapeFlag?Yt[Yt.indexOf(e)]=i:Yt.push(i)),i.patchFlag=-2,i}if($n(e)&&(e=e.__vccOpts),t){t=cn(t);let{class:e,style:n}=t;e&&!(0,r.Kg)(e)&&(t.class=(0,r.C4)(e)),(0,r.Gv)(n)&&((0,i.ju)(n)&&!(0,r.cy)(n)&&(n=(0,r.X$)({},n)),t.style=(0,r.Tr)(n))}const u=(0,r.Kg)(e)?1:$t(e)?128:M(e)?64:(0,r.Gv)(e)?4:(0,r.Tn)(e)?2:0;return on(e,t,n,s,a,u,o,!0)}function cn(e){return e?(0,i.ju)(e)||Je(e)?(0,r.X$)({},e):e:null}function dn(e,t,n=!1,i=!1){const{props:s,ref:a,patchFlag:o,children:u,transition:l}=e,c=t?yn(s||{},t):s,d={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&sn(c),ref:t&&t.ref?n&&a?(0,r.cy)(a)?a.concat(an(t)):[a,an(t)]:an(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Vt?-1===o?16:16|o:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&dn(e.ssContent),ssFallback:e.ssFallback&&dn(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&i&&W(d,l.clone(d)),d}function hn(e=" ",t=0){return un(Ht,null,e,t)}function fn(e,t){const n=un(Wt,null,e);return n.staticCount=t,n}function pn(e="",t=!1){return t?(Xt(),tn(Kt,null,e)):un(Kt,null,e)}function gn(e){return null==e||"boolean"===typeof e?un(Kt):(0,r.cy)(e)?un(Vt,null,e.slice()):nn(e)?mn(e):un(Ht,null,String(e))}function mn(e){return null===e.el&&-1!==e.patchFlag||e.memo?e:dn(e)}function vn(e,t){let n=0;const{shapeFlag:i}=e;if(null==t)t=null;else if((0,r.cy)(t))n=16;else if("object"===typeof t){if(65&i){const n=t.default;return void(n&&(n._c&&(n._d=!1),vn(e,n()),n._c&&(n._d=!0)))}{n=32;const i=t._;i||Je(t)?3===i&&x&&(1===x.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=x}}else(0,r.Tn)(t)?(t={default:t,_ctx:x},n=32):(t=String(t),64&i?(n=16,t=[hn(t)]):n=8);e.children=t,e.shapeFlag|=n}function yn(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const e in i)if("class"===e)t.class!==i.class&&(t.class=(0,r.C4)([t.class,i.class]));else if("style"===e)t.style=(0,r.Tr)([t.style,i.style]);else if((0,r.Mp)(e)){const n=t[e],s=i[e];!s||n===s||(0,r.cy)(n)&&n.includes(s)||(t[e]=n?[].concat(n,s):s)}else""!==e&&(t[e]=i[e])}return t}function bn(e,t,n,i=null){a(e,t,7,[n,i])}const Tn=He();let Sn=0;function En(e,t,n){const s=e.type,a=(t?t.appContext:e.appContext)||Tn,o={uid:Sn++,vnode:e,type:s,parent:t,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new i.yC(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(a.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:rt(s,a),emitsOptions:Pt(s,a),emit:null,emitted:null,propsDefaults:r.MZ,inheritAttrs:s.inheritAttrs,ctx:r.MZ,data:r.MZ,props:r.MZ,attrs:r.MZ,slots:r.MZ,refs:r.MZ,setupState:r.MZ,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=t?t.root:o,o.emit=Mt.bind(null,o),e.ce&&e.ce(o),o}let wn=null;const An=()=>wn||x;let xn,In;{const e=(0,r.We)(),t=(t,n)=>{let i;return(i=e[t])||(i=e[t]=[]),i.push(n),e=>{i.length>1?i.forEach((t=>t(e))):i[0](e)}};xn=t("__VUE_INSTANCE_SETTERS__",(e=>wn=e)),In=t("__VUE_SSR_SETTERS__",(e=>Mn=e))}const kn=e=>{const t=wn;return xn(e),e.scope.on(),()=>{e.scope.off(),xn(t)}},Ln=()=>{wn&&wn.scope.off(),xn(null)};function Rn(e){return 4&e.vnode.shapeFlag}let Cn,Dn,Mn=!1;function Pn(e,t=!1,n=!1){t&&In(t);const{props:i,children:r}=e.vnode,s=Rn(e);Ze(e,i,s,t),ht(e,r,n||t);const a=s?_n(e,t):void 0;return t&&In(!1),a}function _n(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,ke);const{setup:a}=n;if(a){(0,i.C4)();const n=e.setupContext=a.length>1?Fn(e):null,u=kn(e),l=s(a,e,0,[e.props,n]),c=(0,r.yL)(l);if((0,i.bl)(),u(),!c&&!e.sp||Q(e)||X(e),c){if(l.then(Ln,Ln),t)return l.then((n=>{On(e,n,t)})).catch((t=>{o(t,e,0)}));e.asyncDep=l}else On(e,l,t)}else Nn(e,t)}function On(e,t,n){(0,r.Tn)(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:(0,r.Gv)(t)&&(e.setupState=(0,i.Pr)(t)),Nn(e,n)}function Nn(e,t,n){const s=e.type;if(!e.render){if(!t&&Cn&&!s.render){const t=s.template||_e(e).template;if(t){0;const{isCustomElement:n,compilerOptions:i}=e.appContext.config,{delimiters:a,compilerOptions:o}=s,u=(0,r.X$)((0,r.X$)({isCustomElement:n,delimiters:a},i),o);s.render=Cn(t,u)}}e.render=s.render||r.tE,Dn&&Dn(e)}{const t=kn(e);(0,i.C4)();try{Ce(e)}finally{(0,i.bl)(),t()}}}const Un={get(e,t){return(0,i.u4)(e,"get",""),e[t]}};function Fn(e){const t=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,Un),slots:e.slots,emit:e.emit,expose:t}}function Bn(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy((0,i.Pr)((0,i.IG)(e.exposed)),{get(t,n){return n in t?t[n]:n in xe?xe[n](e):void 0},has(e,t){return t in e||t in xe}})):e.proxy}function jn(e,t=!0){return(0,r.Tn)(e)?e.displayName||e.name:e.name||t&&e.__name}function $n(e){return(0,r.Tn)(e)&&"__vccOpts"in e}const Gn=(e,t)=>{const n=(0,i.EW)(e,t,Mn);return n};function Vn(e,t,n){const i=arguments.length;return 2===i?(0,r.Gv)(t)&&!(0,r.cy)(t)?nn(t)?un(e,null,[t]):un(e,t):un(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):3===i&&nn(n)&&(n=[n]),un(e,t,n))}const Hn="3.5.14"},6801:function(e,t,n){"use strict";var i=n(3724),r=n(8686),s=n(4913),a=n(8551),o=n(5397),u=n(1072);t.f=i&&!r?Object.defineProperties:function(e,t){a(e);var n,i=o(t),r=u(t),l=r.length,c=0;while(l>c)s.f(e,n=r[c++],i[n]);return e}},6823:function(e){"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(n){return"Object"}}},6837:function(e){"use strict";var t=TypeError,n=9007199254740991;e.exports=function(e){if(e>n)throw t("Maximum allowed index exceeded");return e}},6840:function(e,t,n){"use strict";var i=n(4901),r=n(4913),s=n(283),a=n(9433);e.exports=function(e,t,n,o){o||(o={});var u=o.enumerable,l=void 0!==o.name?o.name:t;if(i(n)&&s(n,l,o),o.global)u?e[t]=n:a(t,n);else{try{o.unsafe?e[t]&&(u=!0):delete e[t]}catch(c){}u?e[t]=n:r.f(e,t,{value:n,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return e}},6955:function(e,t,n){"use strict";var i=n(2140),r=n(4901),s=n(2195),a=n(8227),o=a("toStringTag"),u=Object,l="Arguments"===s(function(){return arguments}()),c=function(e,t){try{return e[t]}catch(n){}};e.exports=i?s:function(e){var t,n,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=c(t=u(e),o))?n:l?s(t):"Object"===(i=s(t))&&r(t.callee)?"Arguments":i}},6969:function(e,t,n){"use strict";var i=n(2777),r=n(757);e.exports=function(e){var t=i(e,"string");return r(t)?t:t+""}},6980:function(e){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},7014:function(e,t,n){"use strict";n.d(t,{c:function(){return s}});var i=n(4156),r=n(1712);function s(e,t,n){const[s,o]=(0,i.x)(n?.in,e,t),u=a(s,o),l=Math.abs((0,r.m)(s,o));s.setDate(s.getDate()-u*l);const c=Number(a(s,o)===-u),d=u*(l-c);return 0===d?0:d}function a(e,t){const n=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return n<0?-1:n>0?1:n}},7040:function(e,t,n){"use strict";var i=n(4495);e.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7055:function(e,t,n){"use strict";var i=n(9504),r=n(9039),s=n(2195),a=Object,o=i("".split);e.exports=r((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"===s(e)?o(e,""):a(e)}:a},7080:function(e,t,n){"use strict";var i=n(4402).has;e.exports=function(e){return i(e),e}},7347:function(e,t,n){"use strict";var i=n(3724),r=n(9565),s=n(8773),a=n(6980),o=n(5397),u=n(6969),l=n(9297),c=n(5917),d=Object.getOwnPropertyDescriptor;t.f=i?d:function(e,t){if(e=o(e),t=u(t),c)try{return d(e,t)}catch(n){}if(l(e,t))return a(!r(s.f,e,t),e[t])}},7476:function(e,t,n){"use strict";var i=n(2195),r=n(9504);e.exports=function(e){if("Function"===i(e))return r(e)}},7588:function(e,t,n){"use strict";var i=n(6518),r=n(9565),s=n(2652),a=n(9306),o=n(8551),u=n(1767),l=n(9539),c=n(4549),d=c("forEach",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:d},{forEach:function(e){o(this);try{a(e)}catch(i){l(this,"throw",i)}if(d)return r(d,this,e);var t=u(this),n=0;s(t,(function(t){e(t,n++)}),{IS_RECORD:!0})}})},7629:function(e,t,n){"use strict";var i=n(6395),r=n(4576),s=n(9433),a="__core-js_shared__",o=e.exports=r[a]||s(a,{});(o.versions||(o.versions=[])).push({version:"3.42.0",mode:i?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"})},7642:function(e,t,n){"use strict";var i=n(6518),r=n(3440),s=n(4916),a=!s("difference",(function(e){return 0===e.size}));i({target:"Set",proto:!0,real:!0,forced:a},{difference:r})},7657:function(e,t,n){"use strict";var i,r,s,a=n(9039),o=n(4901),u=n(34),l=n(2360),c=n(2787),d=n(6840),h=n(8227),f=n(6395),p=h("iterator"),g=!1;[].keys&&(s=[].keys(),"next"in s?(r=c(c(s)),r!==Object.prototype&&(i=r)):g=!0);var m=!u(i)||a((function(){var e={};return i[p].call(e)!==e}));m?i={}:f&&(i=l(i)),o(i[p])||d(i,p,(function(){return this})),e.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:g}},7680:function(e,t,n){"use strict";var i=n(9504);e.exports=i([].slice)},7740:function(e,t,n){"use strict";var i=n(9297),r=n(5031),s=n(7347),a=n(4913);e.exports=function(e,t,n){for(var o=r(t),u=a.f,l=s.f,c=0;c<o.length;c++){var d=o[c];i(e,d)||n&&i(n,d)||u(e,d,l(t,d))}}},7750:function(e,t,n){"use strict";var i=n(4117),r=TypeError;e.exports=function(e){if(i(e))throw new r("Can't call method on "+e);return e}},7751:function(e,t,n){"use strict";var i=n(4576),r=n(4901),s=function(e){return r(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?s(i[e]):i[e]&&i[e][t]}},8004:function(e,t,n){"use strict";var i=n(6518),r=n(9039),s=n(8750),a=n(4916),o=!a("intersection",(function(e){return 2===e.size&&e.has(1)&&e.has(2)}))||r((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}));i({target:"Set",proto:!0,real:!0,forced:o},{intersection:s})},8014:function(e,t,n){"use strict";var i=n(1291),r=Math.min;e.exports=function(e){var t=i(e);return t>0?r(t,9007199254740991):0}},8111:function(e,t,n){"use strict";var i=n(6518),r=n(4576),s=n(679),a=n(8551),o=n(4901),u=n(2787),l=n(2106),c=n(4659),d=n(9039),h=n(9297),f=n(8227),p=n(7657).IteratorPrototype,g=n(3724),m=n(6395),v="constructor",y="Iterator",b=f("toStringTag"),T=TypeError,S=r[y],E=m||!o(S)||S.prototype!==p||!d((function(){S({})})),w=function(){if(s(this,p),u(this)===p)throw new T("Abstract class Iterator not directly constructable")},A=function(e,t){g?l(p,e,{configurable:!0,get:function(){return t},set:function(t){if(a(this),this===p)throw new T("You can't redefine this property");h(this,e)?this[e]=t:c(this,e,t)}}):p[e]=t};h(p,b)||A(b,y),!E&&h(p,v)&&p[v]!==Object||A(v,w),w.prototype=p,i({global:!0,constructor:!0,forced:E},{Iterator:w})},8227:function(e,t,n){"use strict";var i=n(4576),r=n(5745),s=n(9297),a=n(3392),o=n(4495),u=n(7040),l=i.Symbol,c=r("wks"),d=u?l["for"]||l:l&&l.withoutSetter||a;e.exports=function(e){return s(c,e)||(c[e]=o&&s(l,e)?l[e]:d("Symbol."+e)),c[e]}},8237:function(e,t,n){"use strict";var i=n(6518),r=n(2652),s=n(9306),a=n(8551),o=n(1767),u=n(9539),l=n(4549),c=n(8745),d=n(9039),h=TypeError,f=d((function(){[].keys().reduce((function(){}),void 0)})),p=!f&&l("reduce",h);i({target:"Iterator",proto:!0,real:!0,forced:f||p},{reduce:function(e){a(this);try{s(e)}catch(d){u(this,"throw",d)}var t=arguments.length<2,n=t?void 0:arguments[1];if(p)return c(p,this,t?[e]:[e,n]);var i=o(this),l=0;if(r(i,(function(i){t?(t=!1,n=i):n=e(n,i,l),l++}),{IS_RECORD:!0}),t)throw new h("Reduce of empty iterator with no initial value");return n}})},8469:function(e,t,n){"use strict";var i=n(9504),r=n(507),s=n(4402),a=s.Set,o=s.proto,u=i(o.forEach),l=i(o.keys),c=l(new a).next;e.exports=function(e,t,n){return n?r({iterator:l(e),next:c},t):u(e,t)}},8480:function(e,t,n){"use strict";var i=n(1828),r=n(8727),s=r.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,s)}},8527:function(e,t,n){"use strict";var i=n(7080),r=n(4402).has,s=n(5170),a=n(3789),o=n(507),u=n(9539);e.exports=function(e){var t=i(this),n=a(e);if(s(t)<n.size)return!1;var l=n.getIterator();return!1!==o(l,(function(e){if(!r(t,e))return u(l,"normal",!1)}))}},8541:function(e,t,n){"use strict";n.d(t,{c:function(){return F}});const i={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},r=(e,t,n)=>{let r;const s=i[e];return r="string"===typeof s?s:1===t?s.one:s.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function s(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth,i=e.formats[n]||e.formats[e.defaultWidth];return i}}const a={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},o={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},u={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},l={date:s({formats:a,defaultWidth:"full"}),time:s({formats:o,defaultWidth:"full"}),dateTime:s({formats:u,defaultWidth:"full"})},c={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},d=(e,t,n,i)=>c[e];function h(e){return(t,n)=>{const i=n?.context?String(n.context):"standalone";let r;if("formatting"===i&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,i=n?.width?String(n.width):t;r=e.formattingValues[i]||e.formattingValues[t]}else{const t=e.defaultWidth,i=n?.width?String(n.width):e.defaultWidth;r=e.values[i]||e.values[t]}const s=e.argumentCallback?e.argumentCallback(t):t;return r[s]}}const f={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},p={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},g={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},m={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},v={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},y={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},b=(e,t)=>{const n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},T={ordinalNumber:b,era:h({values:f,defaultWidth:"wide"}),quarter:h({values:p,defaultWidth:"wide",argumentCallback:e=>e-1}),month:h({values:g,defaultWidth:"wide"}),day:h({values:m,defaultWidth:"wide"}),dayPeriod:h({values:v,defaultWidth:"wide",formattingValues:y,defaultFormattingWidth:"wide"})};function S(e){return(t,n={})=>{const i=n.width,r=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],s=t.match(r);if(!s)return null;const a=s[0],o=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(o)?w(o,(e=>e.test(a))):E(o,(e=>e.test(a)));let l;l=e.valueCallback?e.valueCallback(u):u,l=n.valueCallback?n.valueCallback(l):l;const c=t.slice(a.length);return{value:l,rest:c}}}function E(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function w(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function A(e){return(t,n={})=>{const i=t.match(e.matchPattern);if(!i)return null;const r=i[0],s=t.match(e.parsePattern);if(!s)return null;let a=e.valueCallback?e.valueCallback(s[0]):s[0];a=n.valueCallback?n.valueCallback(a):a;const o=t.slice(r.length);return{value:a,rest:o}}}const x=/^(\d+)(th|st|nd|rd)?/i,I=/\d+/i,k={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},L={any:[/^b/i,/^(a|c)/i]},R={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},C={any:[/1/i,/2/i,/3/i,/4/i]},D={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},M={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},P={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},_={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},O={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},N={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},U={ordinalNumber:A({matchPattern:x,parsePattern:I,valueCallback:e=>parseInt(e,10)}),era:S({matchPatterns:k,defaultMatchWidth:"wide",parsePatterns:L,defaultParseWidth:"any"}),quarter:S({matchPatterns:R,defaultMatchWidth:"wide",parsePatterns:C,defaultParseWidth:"any",valueCallback:e=>e+1}),month:S({matchPatterns:D,defaultMatchWidth:"wide",parsePatterns:M,defaultParseWidth:"any"}),day:S({matchPatterns:P,defaultMatchWidth:"wide",parsePatterns:_,defaultParseWidth:"any"}),dayPeriod:S({matchPatterns:O,defaultMatchWidth:"any",parsePatterns:N,defaultParseWidth:"any"})},F={code:"en-US",formatDistance:r,formatLong:l,formatRelative:d,localize:T,match:U,options:{weekStartsOn:0,firstWeekContainsDate:1}}},8551:function(e,t,n){"use strict";var i=n(34),r=String,s=TypeError;e.exports=function(e){if(i(e))return e;throw new s(r(e)+" is not an object")}},8574:function(e,t,n){"use strict";var i=n(9504),r=Error,s=i("".replace),a=function(e){return String(new r(e).stack)}("zxcasd"),o=/\n\s*at [^:]*:[^\n]*/,u=o.test(a);e.exports=function(e,t){if(u&&"string"==typeof e&&!r.prepareStackTrace)while(t--)e=s(e,o,"");return e}},8622:function(e,t,n){"use strict";var i=n(4576),r=n(4901),s=i.WeakMap;e.exports=r(s)&&/native code/.test(String(s))},8646:function(e,t,n){"use strict";var i=n(9565),r=n(8551),s=n(1767),a=n(851);e.exports=function(e,t){t&&"string"===typeof e||r(e);var n=a(e);return s(r(void 0!==n?i(n,e):e))}},8686:function(e,t,n){"use strict";var i=n(3724),r=n(9039);e.exports=i&&r((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8727:function(e){"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8745:function(e,t,n){"use strict";var i=n(616),r=Function.prototype,s=r.apply,a=r.call;e.exports="object"==typeof Reflect&&Reflect.apply||(i?a.bind(s):function(){return a.apply(s,arguments)})},8750:function(e,t,n){"use strict";var i=n(7080),r=n(4402),s=n(5170),a=n(3789),o=n(8469),u=n(507),l=r.Set,c=r.add,d=r.has;e.exports=function(e){var t=i(this),n=a(e),r=new l;return s(t)>n.size?u(n.getIterator(),(function(e){d(t,e)&&c(r,e)})):o(t,(function(e){n.includes(e)&&c(r,e)})),r}},8773:function(e,t){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,r=i&&!n.call({1:2},1);t.f=r?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},8981:function(e,t,n){"use strict";var i=n(7750),r=Object;e.exports=function(e){return r(i(e))}},9039:function(e){"use strict";e.exports=function(e){try{return!!e()}catch(t){return!0}}},9225:function(e,t,n){"use strict";var i,r,s,a,o=n(4576),u=n(8745),l=n(6080),c=n(4901),d=n(9297),h=n(9039),f=n(397),p=n(7680),g=n(4055),m=n(2812),v=n(9544),y=n(6193),b=o.setImmediate,T=o.clearImmediate,S=o.process,E=o.Dispatch,w=o.Function,A=o.MessageChannel,x=o.String,I=0,k={},L="onreadystatechange";h((function(){i=o.location}));var R=function(e){if(d(k,e)){var t=k[e];delete k[e],t()}},C=function(e){return function(){R(e)}},D=function(e){R(e.data)},M=function(e){o.postMessage(x(e),i.protocol+"//"+i.host)};b&&T||(b=function(e){m(arguments.length,1);var t=c(e)?e:w(e),n=p(arguments,1);return k[++I]=function(){u(t,void 0,n)},r(I),I},T=function(e){delete k[e]},y?r=function(e){S.nextTick(C(e))}:E&&E.now?r=function(e){E.now(C(e))}:A&&!v?(s=new A,a=s.port2,s.port1.onmessage=D,r=l(a.postMessage,a)):o.addEventListener&&c(o.postMessage)&&!o.importScripts&&i&&"file:"!==i.protocol&&!h(M)?(r=M,o.addEventListener("message",D,!1)):r=L in g("script")?function(e){f.appendChild(g("script"))[L]=function(){f.removeChild(this),R(e)}}:function(e){setTimeout(C(e),0)}),e.exports={set:b,clear:T}},9286:function(e,t,n){"use strict";var i=n(4402),r=n(8469),s=i.Set,a=i.add;e.exports=function(e){var t=new s;return r(e,(function(e){a(t,e)})),t}},9297:function(e,t,n){"use strict";var i=n(9504),r=n(8981),s=i({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(r(e),t)}},9306:function(e,t,n){"use strict";var i=n(4901),r=n(6823),s=TypeError;e.exports=function(e){if(i(e))return e;throw new s(r(e)+" is not a function")}},9309:function(e,t,n){"use strict";var i=n(6518),r=n(4576),s=n(9225).set,a=n(9472),o=r.setImmediate?a(s,!1):s;i({global:!0,bind:!0,enumerable:!0,forced:r.setImmediate!==o},{setImmediate:o})},9369:function(e,t,n){"use strict";n.d(t,{q:function(){return r}});let i={};function r(){return i}},9433:function(e,t,n){"use strict";var i=n(4576),r=Object.defineProperty;e.exports=function(e,t){try{r(i,e,{value:t,configurable:!0,writable:!0})}catch(n){i[e]=t}return t}},9462:function(e,t,n){"use strict";var i=n(9565),r=n(2360),s=n(6699),a=n(6279),o=n(8227),u=n(1181),l=n(5966),c=n(7657).IteratorPrototype,d=n(2529),h=n(9539),f=o("toStringTag"),p="IteratorHelper",g="WrapForValidIterator",m=u.set,v=function(e){var t=u.getterFor(e?g:p);return a(r(c),{next:function(){var n=t(this);if(e)return n.nextHandler();if(n.done)return d(void 0,!0);try{var i=n.nextHandler();return n.returnHandlerResult?i:d(i,n.done)}catch(r){throw n.done=!0,r}},return:function(){var n=t(this),r=n.iterator;if(n.done=!0,e){var s=l(r,"return");return s?i(s,r):d(void 0,!0)}if(n.inner)try{h(n.inner.iterator,"normal")}catch(a){return h(r,"throw",a)}return r&&h(r,"normal"),d(void 0,!0)}})},y=v(!0),b=v(!1);s(b,f,"Iterator Helper"),e.exports=function(e,t,n){var i=function(i,r){r?(r.iterator=i.iterator,r.next=i.next):r=i,r.type=t?g:p,r.returnHandlerResult=!!n,r.nextHandler=e,r.counter=0,r.done=!1,m(this,r)};return i.prototype=t?y:b,i}},9472:function(e,t,n){"use strict";var i=n(4576),r=n(8745),s=n(4901),a=n(4215),o=n(2839),u=n(7680),l=n(2812),c=i.Function,d=/MSIE .\./.test(o)||"BUN"===a&&function(){var e=i.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}();e.exports=function(e,t){var n=t?2:1;return d?function(i,a){var o=l(arguments.length,1)>n,d=s(i)?i:c(i),h=o?u(arguments,n):[],f=o?function(){r(d,this,h)}:d;return t?e(f,a):e(f)}:e}},9504:function(e,t,n){"use strict";var i=n(616),r=Function.prototype,s=r.call,a=i&&r.bind.bind(s,s);e.exports=i?a:function(e){return function(){return s.apply(e,arguments)}}},9519:function(e,t,n){"use strict";var i,r,s=n(4576),a=n(2839),o=s.process,u=s.Deno,l=o&&o.versions||u&&u.version,c=l&&l.v8;c&&(i=c.split("."),r=i[0]>0&&i[0]<4?1:+(i[0]+i[1])),!r&&a&&(i=a.match(/Edge\/(\d+)/),(!i||i[1]>=74)&&(i=a.match(/Chrome\/(\d+)/),i&&(r=+i[1]))),e.exports=r},9539:function(e,t,n){"use strict";var i=n(9565),r=n(8551),s=n(5966);e.exports=function(e,t,n){var a,o;r(e);try{if(a=s(e,"return"),!a){if("throw"===t)throw n;return n}a=i(a,e)}catch(u){o=!0,a=u}if("throw"===t)throw n;if(o)throw a;return r(a),n}},9544:function(e,t,n){"use strict";var i=n(2839);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)},9565:function(e,t,n){"use strict";var i=n(616),r=Function.prototype.call;e.exports=i?r.bind(r):function(){return r.apply(r,arguments)}},9617:function(e,t,n){"use strict";var i=n(5397),r=n(5610),s=n(6198),a=function(e){return function(t,n,a){var o=i(t),u=s(o);if(0===u)return!e&&-1;var l,c=r(a,u);if(e&&n!==n){while(u>c)if(l=o[c++],l!==l)return!0}else for(;u>c;c++)if((e||c in o)&&o[c]===n)return e||c||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},9848:function(e,t,n){"use strict";n(6368),n(9309)}}]);
//# sourceMappingURL=chunk-vendors.53f8d9ad.js.map